{"title": "Apigee - Step 1: Create a GKE cluster", "url": "https://cloud.google.com/apigee/docs/api-platform/get-started/what-apigee", "abstract": "# Apigee - Step 1: Create a GKE cluster\nYou are currently viewing version 1.1 of the Apigee hybrid documentation. **This version is end of life.** You should upgrade to a newer version. For more information, see [Supported versions](/apigee/docs/hybrid/supported-platforms#supported-versions) .\nThis step explains how to set up your shell environment and create a GKE cluster in your Google Cloud Platform (GCP) project.\n", "content": "## \n Set up your terminal shell\nThe `gcloud` tool provides the primary command-line interface for GCP, and `kubectl` provides the primary command-line interface for running commands against Kubernetes clusters.\n- Be sure you have `gcloud` and `kubectl` installed in your local shell. The `gcloud` tool provides the primary command-line interface for GCP, and `kubectl` provides the primary command-line interface for running commands against Kubernetes clusters.```\ngcloud -h\nkubectl -h\n```\n- If you do not have these utilities installed, install them now:- [Install the Cloud SDK](https://cloud.google.com/sdk/install) ,   which includes the`gcloud`command-line tool.\n- After installing Cloud SDK, install the`kubectl`command-line tool by   running the following command:\n- ```\ngcloud components install kubectl\n```\n- Use the`gcloud`tool to configure two default settings: your default [project](https://cloud.google.com/resource-manager/docs/creating-managing-projects) and [compute region](https://cloud.google.com/compute/docs/regions-zones/#available) . Configuring these settings makes it easier to run`gcloud`commands, because`gcloud`requires that you specify the project and compute zone in which you want to work.To list the current settings:```\ngcloud config list\n```If a project and/or compute zone is not listed, then you need to add them with the  commands shown below. If, from the list output, you determine that you need to switch the current settings  to reflect your project and compute region (or zone), you can also use these commands:```\ngcloud config set project project-id\ngcloud config set compute/region compute-region\ngcloud config set compute/zone compute-zone\n```Where is the name of your GCP project, is the name of a GCP compute region, and is the name of a GCP compute zone. For example: `compute/region us-central1` . For a list of compute regions and zones, see [ Available regions and zones](https://cloud.google.com/compute/docs/regions-zones/#available) .## \n Create a GKE cluster\n**Note: ** Apigee does not support [GKE Sandbox](https://cloud.google.com/kubernetes-engine/sandbox) or [gVisor](https://github.com/google/gvisor) .\nIn this step, you will create a Kubernetes cluster in your GCP project (the project you set with the `gcloud config` command).\n**NOTE:** The following command assumes you set the`gcloud`configuration for the compute region and/or zone, as explained in the previous steps. If you did not set the configuration, then you will need to add the`--region \"` `` `\"`and/or`--zone \"` `` `\"`parameter to the command.\nExecute the following command to create the cluster. The machine type, number of nodes, and other settings specified in the command create a minimally configured cluster suitable for a trial Apigee hybrid installation:\n```\ngcloud container clusters create cluster-name \\\n--machine-type \"n1-standard-4\" --num-nodes \"3\" --enable-autoscaling --min-nodes \"3\" --max-nodes \"6\"\n```\nWhere is the name you choose for the cluster.\nCluster creation can take a few minutes. Upon success, you will see output similar to the following with a status of `RUNNING` :\n```\nNAME   LOCATION  MASTER_VERSION MASTER_IP  MACHINE_TYPE NODE_VERSION NUM_NODES STATUS\napigee-hybrid us-central1-a 1.13.11-gke.9 35.222.54.89 n1-standard-4 1.13.11-gke.9 3   RUNNING\n```\n## \n Set the current context\nA is a group of access parameters. Each context contains a Kubernetes cluster, a user and a namespace. The current context is the cluster that is currently the default for `kubectl` : all `kubectl` commands run against that cluster.\nMake sure the current `gcloud` context is set to the cluster you just created.\n- First, list the contexts to determine which is thecontext. In the  following example, the current context is`gke_hybrid-project_us-central1-a_apigee-hybrid`.  The name includes the name of a GCP project (`hybrid-project`), a region or zone  (`us-central1-a`), and a cluster name (`apigee-hybrid`):```\nkubectl config get-contexts\nCURRENT NAME            CLUSTER           AUTHINFO           NAMESPACE\n*   gke_hybrid-project_us-central1-a_apigee-hybrid gke_hybrid-project_us-central1-a_apigee-hybrid gke_hybrid-project_us-central1-a_apigee-hybrid\n   gke_apigee-project_us-west1-a_apigee-cluster  gke_apigee-project_us-west1-a_apigee-cluster  gke_apigee-project_us-west1-a_apigee-cluster\n```\n- If necessary, set the current context to the cluster you just created (the cluster  into which you intend to install Apigee hybrid). Assuming the previous`get-contexts`output,  if the cluster name you created were`apigee-cluster`in the region`us-west1`, you would switch to the`gke_apigee-project_us-west1-a_apigee-cluster`context, as follows:```\nkubectl config use-context gke_apigee-project_us-west1-a_apigee-cluster\n```Where `gke_apigee-project_us-west1-a_apigee-cluster` is the name of the context to switch to.\n- Check the current context to be sure it is set to the intended cluster. For example:```\nkubectl config current-context\n gke_apigee-project_us-west1-a_apigee-cluster\n```## \n Grant cluster credentials\n[ Cluster credentials](https://cloud.google.com/sdk/gcloud/reference/container/clusters/get-credentials) give you access to the containers running in the cluster. Fetch your credentials and grant yourself the **cluster-admin** role:\n- Fetch the credentials:```\ngcloud container clusters get-credentials cluster-name\n```Where is the name is the name of the cluster you created (the   cluster into which you intend to install Apigee hybrid).\n- Set the cluster role binding. Execute this command exactly as shown:```\nkubectl create clusterrolebinding cluster-admin-binding \\\n--clusterrole cluster-admin --user $(gcloud config get-value account)\n```## \n Summary\nYou now have a Kubernetes cluster running in your GCP project. Your shell environment is set up, and you are ready to install the Apigee hybrid runtime plane software on your local machine.\n## Next step\nstepper_buttons is defined in localvars Iterate over all the buttons in the data dictionary If the button's step matches the current step in the process, make the button disabled If the button's step matches the next step [1](/apigee/docs/hybrid/v1.1/install-create-cluster) If the button's step matches the current step in the process, make the button disabled In all other cases (previous buttons or future buttons (after the next one), make them links [(NEXT) Step 2: Install apigeectl](/apigee/docs/hybrid/v1.1/install-download-install) If the button's step matches the current step in the process, make the button disabled [3](/apigee/docs/hybrid/v1.1/install-copy-overrides) If the button's step matches the current step in the process, make the button disabled [4](/apigee/docs/hybrid/v1.1/install-apply-hybrid)", "guide": "Apigee"}