{"title": "Compute Engine - Modify reservations", "url": "https://cloud.google.com/compute/docs/instances", "abstract": "# Compute Engine - Modify reservations\nThis document explains how to modify an existing reservation.\nIf you want to modify a reservation that is attached to a commitment, see [Replace reservations that are attached to commitments](/compute/docs/instances/reservations-with-commitments#modifying_reservations_that_are_attached_to_commitments) instead.\n", "content": "## Before you begin\n- Review the [requirements](/compute/docs/instances/reservations-overview#requirements) and [restrictions](/compute/docs/instances/reservations-overview#restrictions) for reservations.\n- If you haven't already, set up authentication. [Authentication](/compute/docs/authentication) is the process by which your identity is verified for access to Google Cloud services and APIs. To run code or samples from a local development environment, you can authenticate to Compute Engine as follows.Select the tab for how you plan to use the samples on this page:\nWhen you use the Google Cloud console to access Google Cloud services and   APIs, you don't need to set up authentication.- [Install](/sdk/docs/install) the Google Cloud CLI, then [initialize](/sdk/docs/initializing) it by running the following command:```\ngcloud init\n``` **Note:** If you installed the gcloud CLI  previously, make sure you have the latest version by running`gcloud components  update`.\n- [ Set a default region and zone](/compute/docs/gcloud-compute#set_default_zone_and_region_in_your_local_client) .\nTo use the REST API samples on this page in a local development environment, you use the credentials you provide to the gcloud CLI.- [Install](/sdk/docs/install) the Google Cloud CLI, then [initialize](/sdk/docs/initializing) it by running the following command:\n- ```\ngcloud init\n```\n### Required roles\nTo get the permissions that you need to modify reservations,   ask your administrator to grant you the [Compute Admin ](https://cloud.google.com/iam/docs/understanding-roles#compute.admin) ( `roles/compute.admin` ) IAM role on the project.    For more information about granting roles, see [Manage access](/iam/docs/granting-changing-revoking-access) .\nThis predefined role contains     the permissions required to modify reservations. To see the exact permissions that are   required, expand the **Required permissions** section:\nYou might also be able to get   these permissions  with [custom roles](/iam/docs/creating-custom-roles) or  other [predefined roles](/iam/docs/understanding-roles) .\n## Modify reservations\nYou can make the following changes to an existing reservation:\n- [Modify the automatic deletion of a reservation](#modify-auto-delete) .This section explains how to enable the [auto-delete option](/compute/docs/instances/reservations-overview#auto-delete) in a reservation, change the date and time when a reservation is automatically deleted, or disable the automatic deletion of the reservation.\n- [Modify the consumer projects in a shared reservation](#modifying-consumer-projects-shared-reservation) .This section explains how to add or remove the consumer projects that can consume a shared reservation. If you want to add projects that can consume a shared reservation, they must be in the same organization as the project where the reservation was created (the owner project).\n- [Modify the number of reserved VMs in a reservation](#resizing_a_reservation) .This section explains how to increase or decrease the number of reserved virtual machine (VM) instances in a reservation.\nIf you want to modify other properties in a reservation that is not attached to a commitment, see [Change other properties in a reservation](#change-other-properties-reservation) in this document.\n### Modify the automatic deletion of a reservation\nYou can modify when Compute Engine automatically deletes an existing reservation by doing one of the following:\n- Enable the auto-delete option or change when the reservation is automatically deleted.\n- Disable the auto-delete option.\n**    Preview     ** This product or feature is subject to the \"Pre-GA Offerings Terms\" in the General Service Terms section   of the [Service Specific Terms](/terms/service-terms#1) .     Pre-GA products and features are available \"as is\" and might have limited support.    For more information, see the [launch stage descriptions](/products#product-launch-stages) .\nTo modify the automatic deletion of a reservation, use the Google Cloud console, gcloud CLI, or REST.\nTo modify the automatic deletion of a reservation, follow these steps:- In the Google Cloud console, go to the **Reservations** page. [Go to Reservations](https://console.cloud.google.com/compute/reservations) \n- In the **Name** column, click the name of the reservation that you want to modify.The details page of the selected reservation opens.\n- In the **Auto-delete time** row, click edit **Edit auto-delete time** .\n- In the **Update reservation** pane, do one of the following:- To delete the reservation at a specific date and time, do the following:- If the auto-delete option isn't already enabled, click the **Enable auto-delete** toggle to the on position.\n- In the **Auto-delete time** field, enter a date and time when Compute Engine automatically deletes the reservation.\n- Otherwise, click the **Enable auto-delete** toggle to the off position.\n- Click **Submit** .Modifying your reservation might take a few seconds to complete.\nWhen you enable the auto-delete option in a reservation, you can specify a date and time when the reservation should be deleted or specify a duration after which the reservation should be deleted.\nTo enable the auto-delete option or change when the reservation should be deleted, do one of the following:- To delete the reservation at a specific date and time, use the [gcloud beta compute reservations update command](/sdk/gcloud/reference/beta/compute/reservations/update) with the `--delete-at-time` flag.```\ngcloud beta compute reservations update RESERVATION_NAME \\\n --delete-at-time=DELETE_AT_TIME \\\n --project=PROJECT_ID \\\n --zone=ZONE\n```Replace the following:- `` : the name of an existing reservation.\n- `` : a date and time formatted as an [RFC 3339 timestamp](https://tools.ietf.org/html/rfc3339) , which must be as follows:```\nYYYY-MM-DDTHH:MM:SSOFFSET\n```Replace the following:- `` : a date formatted as a 4-digit year, 2-digit month, and a 2-digit day of the month, separated by hyphens ( `-` ).\n- `` : a time formatted as a 2-digit hour using a 24-hour time, 2-digit minutes, and 2-digit seconds, separated by colons ( `:` ).\n- `` : the time zone formatted as an offset of [Coordinated Universal Time (UTC)](https://en.wikipedia.org/wiki/Coordinated_Universal_Time) . For example, to use the Pacific Standard Time (PST), specify `-08:00` . Alternatively, to use no offset, specify `Z` .\n- `` : the ID of the project where the reservation is located.\n- `` : the zone where the reservation is located.\n- To delete the reservation after a specific duration, use the [gcloud beta compute reservations update command](/sdk/gcloud/reference/beta/compute/reservations/update) with the `--delete-after-duration` flag.```\ngcloud beta compute reservations update RESERVATION_NAME \\\n --delete-after-duration=DELETE_AFTER_DURATION \\\n --project=PROJECT_ID \\\n --zone=ZONE\n```Replace the following:- `` : the name of an existing reservation.\n- `` : a duration in days, hours, minutes, or seconds before the reservation is automatically deleted. For example, specify `30m` for 30 minutes, or `1d2h3m4s` for 1 day, 2 hours, 3 minutes, and 4 seconds.\n- `` : the ID of the project where the reservation is located.\n- `` : the zone where the reservation is located.\nTo disable the auto-delete option, use the [gcloud beta compute reservations update command](/sdk/gcloud/reference/beta/compute/reservations/update) with the `--disable-auto-delete` flag.\n```\ngcloud beta compute reservations update RESERVATION_NAME \\\n --disable-auto-delete \\\n --project=PROJECT_ID \\\n --zone=ZONE\n```\nReplace the following:- `` : the name of an existing reservation.\n- `` : the ID of the project where the reservation is located.\n- `` : the zone where the reservation is located.\nWhen you enable the auto-delete option in a reservation, you can specify a date and time when the reservation should be deleted or specify a duration after which the reservation should be deleted.\nTo enable the auto-delete option or change when the reservation should be deleted, do one of the following:- To delete the reservation at a specific date and time, make a `PATCH` request to the [beta.reservations.update method](/compute/docs/reference/rest/beta/reservations/update) with the `paths` query parameter set to `deleteAtTime` .```\nPATCH https://compute.googleapis.com/compute/beta/projects/PROJECT_ID/zones/ZONE/reservations/RESERVATION_NAME?paths=deleteAtTime{\u00a0 \"name\": \"RESERVATION_NAME\",\u00a0 \"deleteAtTime\": \"DELETE_AT_TIME\"}\n```Replace the following:- `` : the ID of the project where the reservation is located.\n- `` : the zone where the reservation is located.\n- `` : the name of an existing reservation.\n- `` : a date and time formatted as an [RFC 3339 timestamp](https://tools.ietf.org/html/rfc3339) , which must be as follows:```\nYYYY-MM-DDTHH:MM:SSOFFSET\n```Replace the following:- `` : a date formatted as a 4-digit year, 2-digit month, and a 2-digit day of the month, separated by hyphens ( `-` ).\n- `` : a time formatted as a 2-digit hour using a 24-hour time, 2-digit minutes, and 2-digit seconds, separated by colons ( `:` ).\n- `` : the time zone formatted as an offset of [Coordinated Universal Time (UTC)](https://en.wikipedia.org/wiki/Coordinated_Universal_Time) . For example, to use the Pacific Standard Time (PST), specify `-08:00` . Alternatively, to use no offset, specify `Z` .\n- To delete the reservation after a specific duration, make a `PATCH` request to the [beta.reservations.update method](/compute/docs/reference/rest/beta/reservations/update) with the `paths` query parameter set to `deleteAfterDuration` .```\nPATCH https://compute.googleapis.com/compute/beta/projects/PROJECT_ID/zones/ZONE/reservations/RESERVATION_NAME?paths=deleteAfterDuration{\u00a0 \"name\": \"RESERVATION_NAME\",\u00a0 \"deleteAfterDuration\": {\u00a0 \u00a0 \"seconds\": \"DELETE_AFTER_DURATION\"\u00a0 }}\n```Replace the following:- `` : the ID of the project where the reservation is located.\n- `` : the zone where the reservation is located.\n- `` : the name of an existing reservation.\n- `` : a duration in seconds before the reservation is automatically deleted. For example, specify `86400` for 86,400 seconds (1 day).\nTo disable the auto-delete option, make a `PATCH` request to the [beta.reservations.update method](/compute/docs/reference/rest/beta/reservations/update) . In the request, specify the `paths=deleteAtTime&paths=deleteAfterDuration` query parameter and omit the request body.\n```\nPATCH https://compute.googleapis.com/compute/beta/projects/PROJECT_ID/zones/ZONE/reservations/RESERVATION_NAME?paths=deleteAtTime&paths=deleteAfterDuration\n```\nReplace the following:- `` : the ID of the project where the reservation is located.\n- `` : the zone where the reservation is located.\n- `` : the name of an existing reservation.\n### Modify the consumer projects in a shared reservation\nYou can modify the consumer projects for an existing shared reservation. Consumer projects are projects that a shared reservation is shared with and that can consume the reservation.\nAfter you modify which consumer projects can consume a shared reservation, the consumption of the reservation might change. For example, any removed consumer project stops consuming resources from the reservation. Additionally, if the reservation was configured to be automatically consumed by any VM that matches the reservation's properties (the default behavior), then any added consumer project might start consuming resources from the reservation. If you want to monitor a reservation's consumption, see how to [verify reservations consumption](/compute/docs/instances/reservations-consume#verify-consumption) .\nTo modify the consumer projects that can consume a shared reservation, use the Google Cloud console, gcloud CLI, or REST.\nTo modify the consumer projects for a shared reservation, follow these steps:- In the Google Cloud console, go to the **Reservations** page. [Go to Reservations](https://console.cloud.google.com/compute/reservations) \n- In the **Name** column, click the name of the reservation you want to describe.The details page for the reservation opens.\n- Click edit **Edit** .\n- In the **Selected projects** section, do one of the following:- To stop sharing the reservation with a specific consumer project, click delete **Delete** .\n- To start sharing the reservation with one or more specific projects, do the following:- Click add **Add projects** .\n- Select the checkbox for each project from the owner project's organization that you want to share the reservation with.\n- Click **Select** .\n- To confirm your changes, click **Save** .Modifying your reservation might take a few seconds to complete.\nWhen you modify the consumer projects for a shared reservation, you must specify a comma-separated list of IDs of projects that you want to allow, or stop allowing, to consume the shared reservation. These projects must be in the same organization as the owner project. Don't specify the owner project in the list. By default, it's already allowed to consume the shared reservation.\nTo modify the consumer projects for a shared reservation, select one of the following methods:- To allow one or more projects to consume a shared reservation, use the [gcloud compute reservations update command](/sdk/gcloud/reference/compute/reservations/update) with the `--add-share-with` flag.```\ngcloud compute reservations update RESERVATION_NAME \\\n --project=PROJECT_ID \\\n --add-share-with=CONSUMER_PROJECT_IDS \\\n --zone=ZONE\n```Replace the following:- `` : the name of an existing shared reservation.\n- `` : the ID of the owner project, which is the project used to create the shared reservation.\n- `` : a comma-separated list of IDs of projects to share the reservation with. For example, specify `project-1,project-2` .\n- `` : the zone where the shared reservation is located.\n- To stop allowing one or more projects to consume a shared reservation, use the [gcloud compute reservations update command](/sdk/gcloud/reference/compute/reservations/update) with the `--remove-share-with` flag.```\ngcloud compute reservations update RESERVATION_NAME \\\n --project=PROJECT_ID \\\n --remove-share-with=CONSUMER_PROJECT_IDS \\\n --zone=ZONE\n```Replace the following:- `` : the name of an existing shared reservation.\n- `` : the ID of the owner project, which is the project used to create the shared reservation.\n- `` : a comma-separated list of IDs of projects that you want to stop sharing the reservation with. For example, specify `project-1,project-2` .\n- `` : the zone where the shared reservation is located.\n- To replace the list of projects that can consume a shared reservation, use the [gcloud compute reservations update command](/sdk/gcloud/reference/compute/reservations/update) with the `--share-with` flag.```\ngcloud compute reservations update RESERVATION_NAME \\\n --project=PROJECT_ID \\\n --share-with=CONSUMER_PROJECT_IDS \\\n --zone=ZONE\n```Replace the following:- `` : the name of an existing shared reservation.\n- `` : the ID of the owner project, which is the project used to create the shared reservation.\n- `` : the zone where the shared reservation is located.\n- `` : a comma-separated list of IDs of projects to share the reservation with. For example, specify `project-1,project-2` .\nWhen you modify the consumer projects for a shared reservation, you must specify the IDs of the projects that you want to allow, or stop allowing, to consume the shared reservation. These projects must be in the same organization as the owner project. Don't specify the owner project. By default, it's already allowed to consume the shared reservation.\nTo modify the consumer projects for a shared reservation, select one of the following methods:- To allow one or more projects to consume a shared reservation, make a `PATCH` request to the [reservations.update method](/compute/docs/reference/rest/v1/reservations/update) . In the request URL, include the `paths=shareSettings.projectMap.` `` query parameter for each project that you want to share the reservation with.For example, to allow two projects to consume a shared reservation, make the following `PATCH` request:```\nPATCH https://compute.googleapis.com/compute/v1/projects/PROJECT_ID/zones/ZONE/reservations/RESERVATION_NAME?paths=shareSettings.projectMap.CONSUMER_PROJECT_ID_1&paths=shareSettings.projectMap.CONSUMER_PROJECT_ID_2{\u00a0 \"name\": \"RESERVATION_NAME\",\u00a0 \"shareSetting\": {\u00a0 \u00a0 \"projectMap\": {\u00a0 \u00a0 \u00a0 \"CONSUMER_PROJECT_ID_1\": {\u00a0 \u00a0 \u00a0 \u00a0 \"projectId\": \"CONSUMER_PROJECT_ID_1\"\u00a0 \u00a0 \u00a0 },\u00a0 \u00a0 \u00a0 \"CONSUMER_PROJECT_ID_2\": {\u00a0 \u00a0 \u00a0 \u00a0 \"projectId\": \"CONSUMER_PROJECT_ID_2\"\u00a0 \u00a0 \u00a0 }\u00a0 \u00a0 }\u00a0 }}\n```Replace the following:- `` : the ID of the owner project, which is the project used to create the shared reservation.\n- `` : the zone where the shared reservation is located.\n- `` : the name of an existing shared reservation.\n- `` and `` : the IDs of two projects that you want to share the reservation with.\n- To stop allowing one or more projects to consume a shared reservation, make a `PATCH` request to the [reservations.update method](/compute/docs/reference/rest/v1/reservations/update) . In the request URL, include the `paths=shareSettings.projectMap.` `` query parameter for each project that you want stop sharing the reservation with. Additionally, you must omit the `shareSetting` field from the request body.For example, to stop allowing two projects to consume a shared reservation, make the following `PATCH` request:```\nPATCH https://compute.googleapis.com/compute/v1/projects/PROJECT_ID/zones/ZONE/reservations/RESERVATION_NAME?paths=shareSettings.projectMap.CONSUMER_PROJECT_ID_1&paths=shareSettings.projectMap.CONSUMER_PROJECT_ID_2{\u00a0 \"name\": \"RESERVATION_NAME\"}\n```Replace the following:- `` : the ID of the owner project, which is the project used to create the shared reservation.\n- `` : the zone where the shared reservation is located.\n- `` : the name of an existing shared reservation.\n- `` and `` : the IDs of two projects that you want to stop sharing the reservation with.\n### Modify the number of reserved VMs in a reservation\nYou can modify an existing reservation to increase or decrease the number of reserved VMs.\nBefore modifying the number of reserved VMs in a reservation, make sure of the following:\n- If you want to increase the number of reserved VMs in a reservation, the following restrictions apply:- There must be sufficient resources in the zone where the reservation is located.\n- You must have sufficient quota for the additional resources that you're reserving.\n- If your reservation's [consumption type](/compute/docs/instances/reservations-overview#consumption-type) is specific and you want to decrease the number of reserved VMs in the reservation, make sure that the number of VMs that are consuming the reservation doesn't exceed the size of the reservation that you want. You can do this by using the following methods:- [Delete VMs](/compute/docs/instances/deleting-instance) .\n- [Update the reservationAffinity property in the VMs](/compute/docs/instances/update-instance-properties) .\nOtherwise, you encounter [errors](/compute/docs/troubleshooting/known-issues#downsizing_or_deleting_specific_reservations_stops_vms_from_consuming_other_reservations) .\nTo modify the number of reserved VMs in a reservation, use the Google Cloud console, gcloud CLI, or REST.\nTo modify the number of reserved VMs in a reservation, follow these steps:- In the Google Cloud console, go to the **Reservations** page. [Go to Reservations](https://console.cloud.google.com/compute/reservations) \n- In the **Name** column, click the name of the reservation that you want to modify.The details page for the reservation opens.\n- Click edit **Edit** .\n- In the **Number of VM instances** field, enter the updated number of VMs to reserve.\n- To confirm, click **Save** .Modifying your reservation might take a few seconds to complete.\nTo modify the number of reserved VMs in a reservation, use the [gcloud compute reservations update command](/sdk/gcloud/reference/compute/reservations/update) .\n```\ngcloud compute reservations update RESERVATION_NAME \\\n --project=PROJECT_ID \\\n --vm-count=NUMBER_OF_VMS \\\n --zone=ZONE\n```\nReplace the following:- `` : the name of an existing reservation.\n- `` : the ID of the project where the reservation is located.\n- `` : the new number of VMs to reserve.\n- `` : the zone where the reservation is located.\nTo modify the number of reserved VMs in a reservation, make a `POST` request to the [reservations.resize method](/compute/docs/reference/rest/v1/reservations/resize) .\n```\nPOST https://compute.googleapis.com/compute/v1/projects/PROJECT_ID/zones/ZONE/reservations/RESERVATION_NAME/resize{\u00a0 \"specificSkuCount\": \"NUMBER_OF_VMS\"}\n```\nReplace the following:- `` : the ID of the project where the reservation is located.\n- `` : the zone where the reservation is located.\n- `` : the name of an existing reservation.\n- `` : the new number of VMs to reserve.\n### Change other properties in a reservation\nTo change any other properties in an existing reservation, do the following:\n- Create a new [single-project](/compute/docs/instances/reservations-single-project#creating_a_reservation) or [shared reservation](/compute/docs/instances/reservations-shared#creating_a_reservation) with updated properties.\n- [Delete the existing reservation](/compute/docs/instances/reservations-delete#deleting_a_reservation) .## Troubleshoot\nLearn how to [troubleshoot issues with reservation updates](/compute/docs/troubleshooting/troubleshooting-reservation-updates) .\n## What's next\n- Learn how to [view your reservations](/compute/docs/instances/reservations-view) .\n- Learn how to [consume reservations](/compute/docs/instances/reservations-consume) .\n- Learn how to [delete reservations](/compute/docs/instances/reservations-delete) .", "guide": "Compute Engine"}