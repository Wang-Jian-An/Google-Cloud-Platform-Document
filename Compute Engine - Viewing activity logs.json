{"title": "Compute Engine - Viewing activity logs", "url": "https://cloud.google.com/compute/docs/instances", "abstract": "# Compute Engine - Viewing activity logs\n**    Beta     ** This product or feature is subject to the \"Pre-GA Offerings Terms\" in the General Service Terms section   of the [Service Specific Terms](/terms/service-terms#1) .     Pre-GA products and features are available \"as is\" and might have limited support.    For more information, see the [launch stage descriptions](/products#product-launch-stages) .\nCompute Engine activity logs aren't the same thing as [audit logs](/logging/docs/audit) . Audit logs contain the same information as legacy activity logs and more. We recommend you use audit logs instead of activity logs. If you are already using activity logs, read [Migrating from activity logs to audit logs](/compute/docs/logging/migrating-from-activity-logs-to-audit-logs) .\nCompute Engine provides activity logs that let you track certain events that affect your project, such as API calls and system events. Specifically, activity logs provide information about:\n- Compute Engine API calls:`GCE_API_CALL`events are [API calls](/compute/docs/reference/latest) that change the state of a resource. For example, API calls to create a disk, update instance metadata, create an instance group, change a machine type, are recorded in activity logs. API calls that do not update a resource, such as`get`and`list`requests aren't recorded.\n- Operation logs:`GCE_OPERATION_DONE`events are logged when an API call changes the state of a resource finishes, Compute Engine returns a completed operation event that is recorded in your activity logs.\n- System logs:`GCE_SYSTEM_EVENT`events are logged when Compute Engine performs a system event, it is recorded in activity logs. For example, a transparent maintenance event would be logged as a system event.\nFor example, with an API event, an activity log provides details such as the start and end time of an API request, the specifics of the request body, the authorized user who made the API request, and the request endpoint. You can download activity logs to search for specific API requests, or to review system events initiated by Compute Engine.\nActivity logs do not provide billing or usage information about a project, such as how long a virtual machine instance has been running or how much it costs. For billing logs, see the [billing export](https://support.google.com/cloud/answer/4524336) feature. For usage logs, see [Viewing usage reports](/compute/docs/usage-export) .\nActivity logs are provided as part of the Cloud Logging service. For more information about Logging in general, read the [Cloud Logging](/logging/docs) documentation.\n", "content": "## Before you begin\n- Familiar with [Cloud Logging](/logging) .\n- If you haven't already, set up authentication. [Authentication](/compute/docs/authentication) is the process by which your identity is verified for access to Google Cloud services and APIs. To run code or samples from a local development environment, you can authenticate to Compute Engine as follows.Select the tab for how you plan to use the samples on this page:\nWhen you use the Google Cloud console to access Google Cloud services and   APIs, you don't need to set up authentication.- [Install](/sdk/docs/install) the Google Cloud CLI, then [initialize](/sdk/docs/initializing) it by running the following command:```\ngcloud init\n``` **Note:** If you installed the gcloud CLI  previously, make sure you have the latest version by running`gcloud components  update`.\n- [ Set a default region and zone](/compute/docs/gcloud-compute#set_default_zone_and_region_in_your_local_client) .\nTo use the REST API samples on this page in a local development environment, you use the credentials you provide to the gcloud CLI.- [Install](/sdk/docs/install) the Google Cloud CLI, then [initialize](/sdk/docs/initializing) it by running the following command:\n- ```\ngcloud init\n```To perform this task, you must have the following [permissions](/iam/docs/overview#permissions) :\n- `logging.logServiceIndexes.list`on the project\n- `logging.logServices.list`on the project## Viewing logs\nActivity logging is enabled by default for all Compute Engine projects.\nYou can see your project's activity logs through the [Logs Explorer](/logging/docs/view/logs-explorer-interface) in the [Google Cloud console](https://console.cloud.google.com/) :\n- In the Google Cloud console, go to the **Logging** page. [Go to the Logging page](https://console.cloud.google.com/logs) \n- When in the Logs Explorer, select and filter your resource type from the first drop-down list.\n- From the **All logs** drop-down list, select **compute.googleapis.com/activity_log** to see Compute Engine activity logs.## Routing logs\nTo learn how to export activity logs, read [Configure and manage sinks](/logging/docs/export/configure_export) in the Cloud Logging documentation.\n## Identifying log files\nWhen you export logs into Cloud Storage, the log files are stored in the structure described by the [Log entry objects](/logging/docs/export/using_exported_logs#the_logentry_type) documentation.\nCompute Engine log files are stored with the following directory structure:\n```\n<bucket>/compute.googleapis.com/activity_log/<year>/<month>/<day>\n```\nThe following is an example log filename stored in a Cloud Storage bucket named `my-bucket` :\n```\nmy-bucket/compute.googleapis.com/activity_log/2014/10/31/20:00:00_20:59:59_S0.json\n```\nIn BigQuery, activity logs are stored in a set of tables, one table for each log type and day, and the tables are named using the following format:\n```\n<dataset>.compute_googleapis_com_activity_log_YYYYMMDD\n```\nFor information about how to query activity logs in BigQuery, see [Log entries in BigQuery](/logging/docs/exported_logs#log_entries_in_google_bigquery) .\n## Reading activity logs\n**Note:** Compute Engine recently updated the format of activity logs to use [protobuf format](https://github.com/google/protobuf) . This changes the format of your logs slightly, but the content remains the same.\nActivity logs are structured as described in the [LogEntry type](/logging/docs/exported_logs#the_logentry_type) documentation.\nCompute Engine activity logs have:\n- `compute.googleapis.com/activity_log`as value of the`log`field\n- [metadata](/logging/docs/api/ref/rest/v1beta3/projects.logs.entries/write#LogEntryMetadata) , which describes common information such as timestamp\n- `structPayload`, which contains the specific contents of the log entry\nYou can get more details about the common fields provided with every log entry from the [LogEntry](/logging/docs/export/using_exported_logs#the_logentry_type) description, but the payload contents of activity log entries are specific to Compute Engine and are described below.\n### Payload contents\nThe contents of a log entry are provided in JSON object format, and are stored in the `structPayload` field. The `structPayload` field contains the following information:\n| Field    | Type  | Description                                                                                                                                                                                                                                                                                                                                                                                   |\n|:-------------------|:----------|:-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|\n| actor    | string | Email of user or service account performing the operation. This is the same as the user_id.                                                                                                                                                                                                                                                                                                                                                               |\n| error    | string | Provides any error details if an error occurred during this event. This is omitted if there were no errors. Errors usually prevent a request from completing successfully. You can use this field to debug a failed request.                                                                                                                                                                                                                                                                                                                               |\n| event_subtype  | string | Describes the specific subtype as an API method. For example, a request to insert a new instance appears as compute.instances.insert, and a request to delete an Address resource appears as compute.addresses.delete. See the API reference for a comprehensive list of API methods.                                                                                                                                                                                                                                                                                                                |\n| event_timestamp_us | timestamp | The timestamp, in microseconds, of the logged event since standard epoch. This is the same as metadata.timestamp.                                                                                                                                                                                                                                                                                                                                                         |\n| event_type   | string | Describes the general event type. This can be one of the following values: GCE_API_CALL. Indicates a REST API call that updated a resource. GCE_OPERATION_DONE. After an API request completes, whether successful or not, this event type is logged. GCE_SYSTEM_EVENT. A system event initiated by Compute Engine.                                                                                                                                                                                                                                                                                                         |\n| info    | string | An optional field with additional information, if applicable. This field is omitted if there is no additional information to show.                                                                                                                                                                                                                                                                                                                                                     |\n| operation   | string | When an API request is made to update or change any resources, a corresponding operation object is created to track the request to completion. This property describes the operation object for this event, providing information such as the operation name, the zone or region of the operation, and the operation ID. Operations can be a zone operation, a region operation, or a global operation, depending on the resource the operation is modifying.                                                                                                                                                                                                                                                                     |\n| request   | JSON  | Contains the original API request body. Show Example Request \"request\": { \"url\": \"https://www.googleapis.com/compute/v1/projects/myproject/zones/us-central1-f/instances\\\", \"body\": \"{ \\\"canIpForward\\\":\"false\", \\\"description\\\":\\\"\\\", \\\"disks\\\":[{ \\\"autoDelete\\\":true, \\\"boot\\\":true, \\\"deviceName\\\":\\\"example-instance\\\", \\\"initializeParams\\\":{ \\\"diskSizeGb\\\":\\\"10\\\", \\\"diskType\\\":\\\"https://www.googleapis.com/compute/v1/projects/myproject/zones/us-central1-f/diskTypes/pd-standard\\\", \\\"sourceImage\\\":\\\"https://www.googleapis.com/compute/v1/projects/debian-cloud/global/images/debian-8-jessie-v20150818\\\" }, \\\"mode\\\":\\\"READ_WRITE\\\", \\\"type\\\":\\\"PERSISTENT\\\" }], \\\"machineType\\\":\\\"https://www.googleapis.com/compute/v1/projects/myproject/zones/us-central1-f/machineTypes/n1-standard-1\\\", \\\"metadata\\\":{ \\\"items\\\":[] }, \\\"name\\\":\\\"example-instance\\\", \\\"networkInterfaces\\\":[{ \\\"accessConfigs\\\":[{ \\\"name\\\":\\\"External NAT\\\", \\\"type\\\":\\\"ONE_TO_ONE_NAT\\\" }], \\\"network\\\":\\\"https://www.googleapis.com/compute/v1/projects/myproject/global/networks/default\\\" }], \\\"scheduling\\\":{ \\\"automaticRestart\\\":true, \\\"onHostMaintenance\\\":\\\"MIGRATE\\\", \\\"preemptible\\\":false }, \\\"serviceAccounts\\\":[{ \\\"email\\\":\\\"default\\\", \\\"scopes\\\":[ \\\"https://www.googleapis.com/auth/devstorage.read_only\\\", \\\"https://www.googleapis.com/auth/logging.write\\\" ] }], \\\"tags\\\":{ \\\"items\\\":[] }, \\\"zone\\\":\\\"https://www.googleapis.com/compute/v1/projects/myproject/zones/us-central1-f\\\" }\" } |\n| resource   | JSON  | Describes the particular resource that is being modified by this event. For example, a virtual machine (VM) instance is considered a resource and an example resource property for a VM looks like the following: \"resource\": { \"type\": \"instance\", \"name\": \"example-instance\", \"id\": \"0\", \"zone\": \"us-central1-f\" } A list of resource types is described in detail in the API reference. Note: If an action affects multiple resources, there may be multiple log entries with the same trace_id.                                                                                                                                                                                                                                                            |\n| trace_id   | string | A system-provided trace ID used to group related logs that are triggered by a single action. For example: trace_id: \"operation-1442436581415-51fe3700bd85a-7fd317e3-f1a3555e\"                                                                                                                                                                                                                                                                                                                                          |\n| user_agent   | string | Describes the client that performed this request. For example, if you used the Cloud Client Libraries for Java to make a request, the user agent would be Google-API-Java-Client.                                                                                                                                                                                                                                                                                                                                         |\n| version   | string | The current log format version indicates the Compute Engine log schema. The current version is 1.2. Note: The Compute Engine API versioning is separate from the log format versioning.                                                                                                                                                                                                                                                                                                                                        |\n| warning   | string | Provides any warning details if any warnings occurred during this event. A warning is informational and does not affect the request, unlike errors.                                                                                                                                                                                                                                                                                                                                                 |\n## Sample log entry\nFor example, a sample log entry describing an API request to create a VM looks like the following:\n```\n{\n \"log\": \"compute.googleapis.com/activity_log\",\n \"insertId\": \"2015-09-16|13:49:42.532185-07|10.106.9.208|335899593\",\n \"metadata\": {\n \"severity\": \"INFO\",\n \"projectId\": \"835469197146\",\n \"serviceName\": \"compute.googleapis.com\",\n \"zone\": \"us-central1-f\",\n \"labels\":{\n  \"compute.googleapis.com/resource_id\":\"0\",\n  \"compute.googleapis.com/resource_name\":\"example-instance\",\n  \"compute.googleapis.com/resource_type\":\"instance\",\n  \"compute.googleapis.com/resource_zone\":\"us-central1-f\"\n },\n \"timestamp\": \"2015-09-16T20:49:42.423637Z\"\n },\n \"structPayload\": {\n \"version\": \"1.2\",\n \"trace_id\": \"operation-1442436581415-51fe3700bd85a-7fd317e3-f1a3555e\",\n \"event_timestamp_us\": \"1442436582423637\",\n \"event_type\": \"GCE_API_CALL\",\n \"event_subtype\": \"compute.instances.insert\",\n \"resource\": {\n  \"type\": \"instance\",\n  \"name\": \"example-instance\",\n  \"id\": \"0\",\n  \"zone\": \"us-central1-f\"\n },\n \"actor\": {\n  \"user\": \"user@example.com\"\n },\n \"ip_address\": \"\",\n \"user_agent\": \"apitools-client/1.0\",\n \"request\": {\n  \"url\": \"https://www.googleapis.com/compute/v1/projects/myproject/zones/us-central1-f/instances\",\n  \"body\": \"{\n  \\\"canIpForward\\\":false,\n  \\\"description\\\":\\\"\\\",\n  \\\"disks\\\":[{\n   \\\"autoDelete\\\":true,\n   \\\"boot\\\":true,\n   \\\"deviceName\\\":\\\"example-instance\\\",\n   \\\"initializeParams\\\":{\n   \\\"diskSizeGb\\\":\\\"10\\\",\n   \\\"diskType\\\":\\\"https://www.googleapis.com/compute/v1/projects/myproject/zones/us-central1-f/diskTypes/pd-standard\\\",\n   \\\"sourceImage\\\":\\\"https://www.googleapis.com/compute/v1/projects/debian-cloud/global/images/debian-8-jessie-v20150818\\\"\n   },\n   \\\"mode\\\":\\\"READ_WRITE\\\",\n   \\\"type\\\":\\\"PERSISTENT\\\"\n  }],\n  \\\"machineType\\\":\\\"https://www.googleapis.com/compute/v1/projects/myproject/zones/us-central1-f/machineTypes/n1-standard-1\\\",\n  \\\"metadata\\\":{\n   \\\"items\\\":[]\n  },\n  \\\"name\\\":\\\"example-instance\\\",\n  \\\"networkInterfaces\\\":[{\n   \\\"accessConfigs\\\":[{\n    \\\"name\\\":\\\"External NAT\\\",\n    \\\"type\\\":\\\"ONE_TO_ONE_NAT\\\"\n   }],\n   \\\"network\\\":\\\"https://www.googleapis.com/compute/v1/projects/myproject/global/networks/default\\\"\n   }],\n  \\\"scheduling\\\":{\n   \\\"automaticRestart\\\":true,\n   \\\"onHostMaintenance\\\":\\\"MIGRATE\\\",\n   \\\"preemptible\\\":false\n  },\n  \\\"serviceAccounts\\\":[{\n   \\\"email\\\":\\\"default\\\",\n   \\\"scopes\\\":[   \\\"https://www.googleapis.com/auth/devstorage.read_only\\\",\n   \\\"https://www.googleapis.com/auth/logging.write\\\"\n   ]\n  }],\n  \\\"tags\\\":{\n   \\\"items\\\":[]\n  },\n  \\\"zone\\\":\\\"https://www.googleapis.com/compute/v1/projects/myproject/zones/us-central1-f\\\"\n  }\"\n },\n \"operation\": {\n  \"type\": \"operation\",\n  \"name\": \"operation-1442436581415-51fe3700bd85a-7fd317e3-f1a3555e\",\n  \"id\": \"291347737657178184\",\n  \"zone\": \"us-central1-f\"\n }\n }\n}\n```\n## Deprecated activity log entries\nThe following activity log entries will be discontinued, with no replacement, on June 1, 2020:\n| Monitored Resource Type | Event SubType          |\n|:--------------------------|:----------------------------------------------------|\n| gce_backend_service  | BackendServiceConfigProgramming      |\n| gce_instance    | RE_ENCRYPT_SSL_CERTIFICATE_FLOW      |\n| gce_instance    | addFirewallRuleToSecurityPolicy      |\n| gce_instance    | attachCloudLink          |\n| gce_instance    | attachFirewallSecurityPolicy      |\n| gce_instance    | compute.instanceGroupManagers.updateHealth   |\n| gce_instance    | compute.instanceGroups.detachHealthCheck   |\n| gce_instance    | compute.instanceNetworkConfig.updateName   |\n| gce_instance    | compute.regionInstanceGroups.attachHealthCheck  |\n| gce_instance    | compute.regionInstanceGroups.detachHealthCheck  |\n| gce_instance    | createFirewallSecurityPolicy      |\n| gce_instance    | deleteFirewallSecurityPolicy      |\n| gce_instance    | detachFirewallSecurityPolicy      |\n| gce_instance    | patchFirewallRuleInSecurityPolicy     |\n| gce_instance    | removeCloudLink          |\n| gce_instance    | removeFirewallRuleFromSecurityPolicy    |\n| gce_instance    | updateFirewallSecurityPolicy      |\n| gce_instance    | updateVpnTunnel          |\n| gce_instance_group  | compute.instanceGroups.attachHealthCheck   |\n| gce_instance_group  | compute.instanceGroups.attachNetworkInterfaces  |\n| gce_instance_group  | compute.instanceGroups.detachHealthCheck   |\n| gce_instance_group  | compute.regionInstanceGroups.attachHealthCheck  |\n| gce_instance_group  | compute.regionInstanceGroups.detachHealthCheck  |\n| gce_instance_template  | compute.zoneInstanceTemplates.insert    |\n| gce_network    | compute.networks.switchLegacyToCustomMode   |\n| gce_project    | compute.projects.moveProjectNetworking    |\n| gce_reserved_address  | compute.addresses.insertDnsForwarding    |\n| gce_reserved_address  | compute.addresses.insertNatAddress     |\n| gce_ssl_certificate  | RE_ENCRYPT_SSL_CERTIFICATE_FLOW      |\n| gce_ssl_certificate  | SslCertificateAddManagedCertificateChallenge  |\n| gce_ssl_certificate  | SslCertificateProvisionManagedCertificate   |\n| gce_ssl_certificate  | SslCertificateRemoveManagedCertificateChallenge  |\n| gce_subnetwork   | compute.subnetworks.createOrUpdateVirtualSubnetwork |\n| vpn_tunnel    | updateVpnTunnel          |", "guide": "Compute Engine"}