{"title": "Vertex AI Search and Conversation - Purge data from a data store", "url": "https://cloud.google.com/generative-ai-app-builder/docs/delete-datastores?hl=zh-cn", "abstract": "# Vertex AI Search and Conversation - Purge data from a data store\nThis page describes how to purge all of the data in a structured or unstructured data store.\nYou must purge the data in a structured or unstructured data store before you can delete the data store. You can also purge a data store if you want to completely delete its contents before re-importing fresh data. Purging a data store deletes only the data in the data store, leaving your app, schema, and configurations intact.\n", "content": "## Website data stores\nPurging is not an option for website data stores. You can remove websites from website data stores as needed, but this is not required before deleting the data store.\n**Note:** It can take from 6 to 24 hours to remove websites from website data stores with [advanced website indexing](/generative-ai-app-builder/docs/about-advanced-features#advanced-website-indexing) .\n## Procedures\nThe following instructions are for the Google Cloud console (Console) and for the command line (REST).\nTo use the Google Cloud console to purge the data from a branch of a structured or unstructured data store, follow these steps:- In the Google Cloud console, go to the **Search and Conversation** page. [Search and Conversation](https://console.cloud.google.com/gen-app-builder/engines) \n- In the navigation menu, click **Data stores** .\n- In the **Name** column, click the data store that you want to purge.\n- In the **Documents** tab, click delete **Purge data** .\n- Read the warning in the **Confirm purge data** dialog. If you want to continue, enter the name of your data store, and then click **Confirm** . Purging data is a long-running operation. For more information, see [Monitorlong-running operations](/generative-ai-app-builder/docs/long-running-operations) .\n- Click the **Activity** tab to monitor the progress of the purge operation.To use the command line to purge the data from a branch of a structured or unstructured data store, follow these steps:- Find your data store ID. If you already have your data store ID, skip to the next step.- In the Google Cloud console, go to the **Search and Conversation** page and in the navigation menu, click **Data stores** . [Go to the Data stores page](https://console.cloud.google.com/gen-app-builder/data-stores) \n- Click the name of your data store.\n- On the **Data** page for your data store, get the data store ID.\n- Call the [documents.purge](/generative-ai-app-builder/docs/reference/rest/v1/projects.locations.dataStores.branches.documents/purge) method.```\ncurl -X POST \\-H \"Authorization: Bearer $(gcloud auth print-access-token)\" \\-H \"Content-Type: application/json\" \\\"https://discoveryengine.googleapis.com/v1/projects/PROJECT_ID/locations/global/collections/default_collection/dataStores/DATA_STORE_ID/branches/0/documents:purge\" \\-d '{\u00a0 \"filter\": \"*\",\u00a0 \"force\": FORCE}'\n```- : The ID of your project.\n- : The ID of your data store.\n- : (Boolean) Specifies whether to delete data from the branch of the data store.- If`true`, deletes all data from the branch\n- If`false`, deletes no data and returns a list of documents in the branch.\n- If`force`is omitted, the default is`false`.\n- Optional: Make note of the `name` value returned by the `documents.purge` method and follow the instructions in [Get detailsabout a long-running operation](/generative-ai-app-builder/docs/long-running-operations#get-details) to see when the purge operation is complete.\nFor more information, see the [Vertex AI Search and Conversation C# API reference documentation](/dotnet/docs/reference/Google.Cloud.DiscoveryEngine.V1Beta/latest) .\nTo authenticate to Vertex AI Search and Conversation, set up Application Default Credentials.  For more information, see [Set up authentication for a local development environment](/docs/authentication/provide-credentials-adc#local-dev) .\n [View on GitHub](https://github.com/googleapis/google-cloud-dotnet/blob/HEAD/apis/Google.Cloud.DiscoveryEngine.V1/Google.Cloud.DiscoveryEngine.V1.GeneratedSnippets/DocumentServiceClient.PurgeDocumentsRequestObjectSnippet.g.cs) \n```\nusing Google.Cloud.DiscoveryEngine.V1;using Google.LongRunning;public sealed partial class GeneratedDocumentServiceClientSnippets{\u00a0 \u00a0 /// <summary>Snippet for PurgeDocuments</summary>\u00a0 \u00a0 /// <remarks>\u00a0 \u00a0 /// This snippet has been automatically generated and should be regarded as a code template only.\u00a0 \u00a0 /// It will require modifications to work:\u00a0 \u00a0 /// - It may require correct/in-range values for request initialization.\u00a0 \u00a0 /// - It may require specifying regional endpoints when creating the service client as shown in\u00a0 \u00a0 /// \u00a0 https://cloud.google.com/dotnet/docs/reference/help/client-configuration#endpoint.\u00a0 \u00a0 /// </remarks>\u00a0 \u00a0 public void PurgeDocumentsRequestObject()\u00a0 \u00a0 {\u00a0 \u00a0 \u00a0 \u00a0 // Create client\u00a0 \u00a0 \u00a0 \u00a0 DocumentServiceClient documentServiceClient = DocumentServiceClient.Create();\u00a0 \u00a0 \u00a0 \u00a0 // Initialize request argument(s)\u00a0 \u00a0 \u00a0 \u00a0 PurgeDocumentsRequest request = new PurgeDocumentsRequest\u00a0 \u00a0 \u00a0 \u00a0 {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 ParentAsBranchName = BranchName.FromProjectLocationDataStoreBranch(\"[PROJECT]\", \"[LOCATION]\", \"[DATA_STORE]\", \"[BRANCH]\"),\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 Filter = \"\",\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 Force = false,\u00a0 \u00a0 \u00a0 \u00a0 };\u00a0 \u00a0 \u00a0 \u00a0 // Make the request\u00a0 \u00a0 \u00a0 \u00a0 Operation<PurgeDocumentsResponse, PurgeDocumentsMetadata> response = documentServiceClient.PurgeDocuments(request);\u00a0 \u00a0 \u00a0 \u00a0 // Poll until the returned long-running operation is complete\u00a0 \u00a0 \u00a0 \u00a0 Operation<PurgeDocumentsResponse, PurgeDocumentsMetadata> completedResponse = response.PollUntilCompleted();\u00a0 \u00a0 \u00a0 \u00a0 // Retrieve the operation result\u00a0 \u00a0 \u00a0 \u00a0 PurgeDocumentsResponse result = completedResponse.Result;\u00a0 \u00a0 \u00a0 \u00a0 // Or get the name of the operation\u00a0 \u00a0 \u00a0 \u00a0 string operationName = response.Name;\u00a0 \u00a0 \u00a0 \u00a0 // This name can be stored, then the long-running operation retrieved later by name\u00a0 \u00a0 \u00a0 \u00a0 Operation<PurgeDocumentsResponse, PurgeDocumentsMetadata> retrievedResponse = documentServiceClient.PollOncePurgeDocuments(operationName);\u00a0 \u00a0 \u00a0 \u00a0 // Check if the retrieved long-running operation has completed\u00a0 \u00a0 \u00a0 \u00a0 if (retrievedResponse.IsCompleted)\u00a0 \u00a0 \u00a0 \u00a0 {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 // If it has completed, then access the result\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 PurgeDocumentsResponse retrievedResult = retrievedResponse.Result;\u00a0 \u00a0 \u00a0 \u00a0 }\u00a0 \u00a0 }}\n```For more information, see the [Vertex AI Search and Conversation Go API reference documentation](/go/docs/reference/cloud.google.com/go/discoveryengine/latest/apiv1beta) .\nTo authenticate to Vertex AI Search and Conversation, set up Application Default Credentials.  For more information, see [Set up authentication for a local development environment](/docs/authentication/provide-credentials-adc#local-dev) .\n [View on GitHub](https://github.com/googleapis/google-cloud-go/blob/HEAD/internal/generated/snippets/discoveryengine/apiv1/DocumentClient/PurgeDocuments/main.go) \n```\npackage mainimport (\u00a0 \u00a0 \u00a0 \u00a0 \"context\"\u00a0 \u00a0 \u00a0 \u00a0 discoveryengine \"cloud.google.com/go/discoveryengine/apiv1\"\u00a0 \u00a0 \u00a0 \u00a0 discoveryenginepb \"cloud.google.com/go/discoveryengine/apiv1/discoveryenginepb\")func main() {\u00a0 \u00a0 \u00a0 \u00a0 ctx := context.Background()\u00a0 \u00a0 \u00a0 \u00a0 // This snippet has been automatically generated and should be regarded as a code template only.\u00a0 \u00a0 \u00a0 \u00a0 // It will require modifications to work:\u00a0 \u00a0 \u00a0 \u00a0 // - It may require correct/in-range values for request initialization.\u00a0 \u00a0 \u00a0 \u00a0 // - It may require specifying regional endpoints when creating the service client as shown in:\u00a0 \u00a0 \u00a0 \u00a0 // \u00a0 https://pkg.go.dev/cloud.google.com/go#hdr-Client_Options\u00a0 \u00a0 \u00a0 \u00a0 c, err := discoveryengine.NewDocumentClient(ctx)\u00a0 \u00a0 \u00a0 \u00a0 if err != nil {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 // TODO: Handle error.\u00a0 \u00a0 \u00a0 \u00a0 }\u00a0 \u00a0 \u00a0 \u00a0 defer c.Close()\u00a0 \u00a0 \u00a0 \u00a0 req := &discoveryenginepb.PurgeDocumentsRequest{\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 // TODO: Fill request struct fields.\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 // See https://pkg.go.dev/cloud.google.com/go/discoveryengine/apiv1/discoveryenginepb#PurgeDocumentsRequest.\u00a0 \u00a0 \u00a0 \u00a0 }\u00a0 \u00a0 \u00a0 \u00a0 op, err := c.PurgeDocuments(ctx, req)\u00a0 \u00a0 \u00a0 \u00a0 if err != nil {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 // TODO: Handle error.\u00a0 \u00a0 \u00a0 \u00a0 }\u00a0 \u00a0 \u00a0 \u00a0 resp, err := op.Wait(ctx)\u00a0 \u00a0 \u00a0 \u00a0 if err != nil {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 // TODO: Handle error.\u00a0 \u00a0 \u00a0 \u00a0 }\u00a0 \u00a0 \u00a0 \u00a0 // TODO: Use resp.\u00a0 \u00a0 \u00a0 \u00a0 _ = resp}\n```For more information, see the [Vertex AI Search and Conversation Java API reference documentation](/java/docs/reference/google-cloud-discoveryengine/latest/overview) .\nTo authenticate to Vertex AI Search and Conversation, set up Application Default Credentials.  For more information, see [Set up authentication for a local development environment](/docs/authentication/provide-credentials-adc#local-dev) .\n [View on GitHub](https://github.com/googleapis/google-cloud-java/blob/HEAD/java-discoveryengine/samples/snippets/generated/com/google/cloud/discoveryengine/v1/documentservice/purgedocuments/SyncPurgeDocuments.java) \n```\nimport com.google.cloud.discoveryengine.v1.BranchName;import com.google.cloud.discoveryengine.v1.DocumentServiceClient;import com.google.cloud.discoveryengine.v1.PurgeDocumentsRequest;import com.google.cloud.discoveryengine.v1.PurgeDocumentsResponse;public class SyncPurgeDocuments {\u00a0 public static void main(String[] args) throws Exception {\u00a0 \u00a0 syncPurgeDocuments();\u00a0 }\u00a0 public static void syncPurgeDocuments() throws Exception {\u00a0 \u00a0 // This snippet has been automatically generated and should be regarded as a code template only.\u00a0 \u00a0 // It will require modifications to work:\u00a0 \u00a0 // - It may require correct/in-range values for request initialization.\u00a0 \u00a0 // - It may require specifying regional endpoints when creating the service client as shown in\u00a0 \u00a0 // https://cloud.google.com/java/docs/setup#configure_endpoints_for_the_client_library\u00a0 \u00a0 try (DocumentServiceClient documentServiceClient = DocumentServiceClient.create()) {\u00a0 \u00a0 \u00a0 PurgeDocumentsRequest request =\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 PurgeDocumentsRequest.newBuilder()\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 .setParent(\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 BranchName.ofProjectLocationDataStoreBranchName(\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"[PROJECT]\", \"[LOCATION]\", \"[DATA_STORE]\", \"[BRANCH]\")\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 .toString())\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 .setFilter(\"filter-1274492040\")\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 .setForce(true)\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 .build();\u00a0 \u00a0 \u00a0 PurgeDocumentsResponse response = documentServiceClient.purgeDocumentsAsync(request).get();\u00a0 \u00a0 }\u00a0 }}\n```For more information, see the [Vertex AI Search and Conversation Node.js API reference documentation](/nodejs/docs/reference/discoveryengine/latest) .\nTo authenticate to Vertex AI Search and Conversation, set up Application Default Credentials.  For more information, see [Set up authentication for a local development environment](/docs/authentication/provide-credentials-adc#local-dev) .\n [View on GitHub](https://github.com/googleapis/google-cloud-node/blob/HEAD/packages/google-cloud-discoveryengine/samples/generated/v1/document_service.purge_documents.js) \n```\n/**\u00a0* This snippet has been automatically generated and should be regarded as a code template only.\u00a0* It will require modifications to work.\u00a0* It may require correct/in-range values for request initialization.\u00a0* TODO(developer): Uncomment these variables before running the sample.\u00a0*//**\u00a0* \u00a0Required. The parent resource name, such as\u00a0* \u00a0`projects/{project}/locations/{location}/collections/{collection}/dataStores/{data_store}/branches/{branch}`.\u00a0*/// const parent = 'abc123'/**\u00a0* \u00a0Required. Filter matching documents to purge. Only currently supported\u00a0* \u00a0value is\u00a0* \u00a0`*` (all items).\u00a0*/// const filter = 'abc123'/**\u00a0* \u00a0Actually performs the purge. If `force` is set to false, return the\u00a0* \u00a0expected purge count without deleting any documents.\u00a0*/// const force = true// Imports the Discoveryengine libraryconst {DocumentServiceClient} = require('@google-cloud/discoveryengine').v1;// Instantiates a clientconst discoveryengineClient = new DocumentServiceClient();async function callPurgeDocuments() {\u00a0 // Construct request\u00a0 const request = {\u00a0 \u00a0 parent,\u00a0 \u00a0 filter,\u00a0 };\u00a0 // Run request\u00a0 const [operation] = await discoveryengineClient.purgeDocuments(request);\u00a0 const [response] = await operation.promise();\u00a0 console.log(response);}callPurgeDocuments();\n```For more information, see the [Vertex AI Search and Conversation Python API reference documentation](/python/docs/reference/discoveryengine/latest) .\nTo authenticate to Vertex AI Search and Conversation, set up Application Default Credentials.  For more information, see [Set up authentication for a local development environment](/docs/authentication/provide-credentials-adc#local-dev) .\n [View on GitHub](https://github.com/googleapis/google-cloud-python/blob/HEAD/packages/google-cloud-discoveryengine/samples/generated_samples/discoveryengine_v1_generated_document_service_purge_documents_sync.py) \n```\n# This snippet has been automatically generated and should be regarded as a# code template only.# It will require modifications to work:# - It may require correct/in-range values for request initialization.# - It may require specifying regional endpoints when creating the service# \u00a0 client as shown in:# \u00a0 https://googleapis.dev/python/google-api-core/latest/client_options.htmlfrom google.cloud import discoveryengine_v1def sample_purge_documents():\u00a0 \u00a0 # Create a client\u00a0 \u00a0 client = discoveryengine_v1.DocumentServiceClient()\u00a0 \u00a0 # Initialize request argument(s)\u00a0 \u00a0 request = discoveryengine_v1.PurgeDocumentsRequest(\u00a0 \u00a0 \u00a0 \u00a0 parent=\"parent_value\",\u00a0 \u00a0 \u00a0 \u00a0 filter=\"filter_value\",\u00a0 \u00a0 )\u00a0 \u00a0 # Make the request\u00a0 \u00a0 operation = client.purge_documents(request=request)\u00a0 \u00a0 print(\"Waiting for operation to complete...\")\u00a0 \u00a0 response = operation.result()\u00a0 \u00a0 # Handle the response\u00a0 \u00a0 print(response)\n```For more information, see the [Vertex AI Search and Conversation Ruby API reference documentation](/ruby/docs/reference/google-cloud-discovery_engine-v1beta/latest) .\nTo authenticate to Vertex AI Search and Conversation, set up Application Default Credentials.  For more information, see [Set up authentication for a local development environment](/docs/authentication/provide-credentials-adc#local-dev) .\n [View on GitHub](https://github.com/googleapis/google-cloud-ruby/blob/HEAD/google-cloud-discovery_engine-v1/snippets/document_service/purge_documents.rb) \n```\nrequire \"google/cloud/discovery_engine/v1\"\n### Snippet for the purge_documents call in the DocumentService service\n## This snippet has been automatically generated and should be regarded as a code# template only. It will require modifications to work:# - It may require correct/in-range values for request initialization.# - It may require specifying regional endpoints when creating the service# client as shown in https://cloud.google.com/ruby/docs/reference.\n## This is an auto-generated example demonstrating basic usage of# Google::Cloud::DiscoveryEngine::V1::DocumentService::Client#purge_documents.#def purge_documents\u00a0 # Create a client object. The client can be reused for multiple calls.\u00a0 client = Google::Cloud::DiscoveryEngine::V1::DocumentService::Client.new\u00a0 # Create a request. To set request fields, pass in keyword arguments.\u00a0 request = Google::Cloud::DiscoveryEngine::V1::PurgeDocumentsRequest.new\u00a0 # Call the purge_documents method.\u00a0 result = client.purge_documents request\u00a0 # The returned object is of type Gapic::Operation. You can use it to\u00a0 # check the status of an operation, cancel it, or wait for results.\u00a0 # Here is how to wait for a response.\u00a0 result.wait_until_done! timeout: 60\u00a0 if result.response?\u00a0 \u00a0 p result.response\u00a0 else\u00a0 \u00a0 puts \"No response received.\"\u00a0 endend\n```", "guide": "Vertex AI Search and Conversation"}