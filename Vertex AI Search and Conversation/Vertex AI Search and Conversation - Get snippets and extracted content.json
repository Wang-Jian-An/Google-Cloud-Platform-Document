{"title": "Vertex AI Search and Conversation - Get snippets and extracted content", "url": "https://cloud.google.com/generative-ai-app-builder/docs/snippets?hl=zh-cn", "abstract": "# Vertex AI Search and Conversation - Get snippets and extracted content\nVertex AI Search can provide search snippets, extractive answers, and extractive segments with each search response to enhance your results.\n- [Snippets](#snippets) : A snippet is a brief extract of text from the search result document that provides a preview of a search result's content. It includes hit highlighting that you can render in your UI. Snippets are typically displayed below each search result to help end users assess the relevance and usefulness of that result. Snippets are available for website and unstructured search.\n- [Extractive answers (Preview)](#extractive-answers) : An extractive answer is verbatim text that is returned with each search result. It is extracted directly from the original document. Extractive answers are typically displayed near the top of web pages to provide an end user with a brief answer that is contextually relevant to their query. Extractive answers are available for website and unstructured search.\n- [Extractive segments (Preview)](#extractive-segments) : An extractive segment is verbatim text that is returned with each search result. An extractive segment is usually more verbose than an extractive answer. Extractive segments can be displayed as an answer to a query, and can be used to perform post-processing tasks and as input for large language models to generate answers or new text. Extractive segments are available for unstructured search.", "content": "## Examples\nThe following examples help illustrate the differences between snippets, extractive answers, and extractive segments.\n**Query:** \"what is vertex ai search and conversation?\"\n- Snippet:\n- Extractive answer:\n- Extractive segment:## Before you begin\nMake sure you satisfy the following prerequisites. Requirements vary depending on the type of app you have.\n- If you have an unstructured search app, make sure the following are turned on:- For [snippets](#snippets) there is no requirement.\n- For [extractive answers](#extractive-answers) and [extractive segments](#extractive-segments) , turn on [Enterprise edition features](/generative-ai-app-builder/docs/about-advanced-features#enterprise-features) .\n- If you have a website app, make sure the following are turned on:- For snippets, turn on:- [Enterprise edition features](/generative-ai-app-builder/docs/about-advanced-features#enterprise-features) .\n- For extractive answers, turn on:- [Enterprise edition features](/generative-ai-app-builder/docs/about-advanced-features#enterprise-features) .\n- [Advanced website indexing](/generative-ai-app-builder/docs/about-advanced-features#advanced-website-indexing) .\n- Extractive segments are not available with website apps.\n## Snippets\nSnippets are short pieces of extracted verbatim from each search result document. They include hit highlighting in bold HTML tags for rendering previews of search results in a UI. Typically, snippets are rendered as preview text underneath a search result to help end users decide if clicking that search result will be useful.\nSnippets are available for website and unstructured search.\n**Note:** As of July 2023, snippets are returned as briefer extracts of text of more uniform length. They no longer provide page numbers. If you previously used snippets as direct answers or inputs for large language models to generate responses and summaries, Google recommends migrating to extractive answers (which provide page numbers where available) or extractive segments.\n### Get snippets\nTo get snippets:\n- Send a search request that includes [ContentSearchSpec.SnippetSpec](/generative-ai-app-builder/docs/reference/rest/v1alpha/projects.locations.collections.dataStores.servingConfigs#snippetspec) and sets `returnSnippet` to true.The following example of `SnippetSpec` specifies that a snippet can be returned for each search result.```\n\"contentSearchSpec\":\u00a0{\u00a0 \u00a0\"snippetSpec\":\u00a0 \u00a0{\u00a0 \u00a0 \u00a0\"returnSnippet\": true\u00a0 \u00a0}\u00a0}\n```- `returnSnippet`: If set to`true`, return a snippet.\n- Get snippets from the search response. Snippets are returned with each search result in `derivedStructData.snippets` .In this example of a document that was returned as one of the results in a search response, a snippet with bold hit highlighting is included with the result:```\n{\u00a0 \u00a0\"id\": \"54321\",\u00a0 \u00a0\"document\": {\u00a0 \u00a0 \u00a0\"name\": \"projects/123/locations/global/collections/default_collection/dataStores/example-datastore/branches/0/documents/54321\",\u00a0 \u00a0 \u00a0\"id\": \"54321\",\u00a0 \u00a0 \u00a0\"derivedStructData\": {\u00a0 \u00a0 \u00a0 \u00a0\"link\": \"gs://cloud-samples-data/gen-app-builder/search/alphabet-investor-pdfs/2008_google_annual_report.pdf\",\u00a0 \u00a0 \u00a0 \u00a0\"snippets\": [\u00a0 \u00a0 \u00a0 \u00a0 \u00a0{\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0\"snippet\": \"Google Chrome. Google Chrome is an open-source <b>browser</b> that combines a minimal design with technologies to make the web faster, safer, and easier to navigate.\"\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0\"snippet_status\": \"SUCCESS\"\u00a0 \u00a0 \u00a0 \u00a0 \u00a0}\u00a0 \u00a0 \u00a0 \u00a0]\u00a0 \u00a0 \u00a0}\u00a0 \u00a0}\u00a0}\n```- `snippet`: Contains a snippet generated for the document search result. Hit highlighting is included in bold HTML tags.\n- `snippet_status`: If a snippet is generated, this field is returned as`SUCCESS`. If no snippet is generated, this field is returned as`NO_SNIPPET_AVAILABLE`.\n## Extractive answers (Preview)\n**Note:** This feature is a Preview offering, subject to the \"Pre-GA Offerings Terms\" of the [GCP Service Specific Terms](https://cloud.google.com/terms/service-terms) . Pre-GA products and features may have limited support, and changes to pre-GA products and features may not be compatible with other pre-GA versions. For more information, see the [launch stage descriptions](https://cloud.google.com/products#product-launch-stages) . Further, by using this feature, you agree to the [Generative AI Preview terms and conditions](https://cloud.google.com/trustedtester/aitos) (\"Preview Terms\"). For this feature, you can process personal data as outlined in the [Cloud Data Processing Addendum](https://cloud.google.com/terms/data-processing-terms) , subject to applicable restrictions and obligations in the Agreement (as defined in the Preview Terms).\nAn extractive answer is a section of text derived verbatim from a document. When a document is returned as a search result in a search response, a relevant extractive answer can be returned with that result.\nAn extractive answer can be text such as a paragraph, table, or bulleted list that is extracted from the search result document. Extractive answers are shorter than [extractive segments](#extractive-segments) .\nExtractive answers can be used as an alternative to summarized responses in cases where precise, verbatim answers are preferable to rephrased summaries.\nExtractive answers are available for website and unstructured search.\n### Get extractive answers\nTo get extractive answers:\n- Send a search request that uses [ContentSearchSpec.extractiveContentSpec](/generative-ai-app-builder/docs/reference/rest/v1alpha/projects.locations.collections.dataStores.servingConfigs#extractivecontentspec) to specify `maxExtractiveAnswerCount` .The following example of `extractiveContentSpec` specifies that an answer can be returned for each search result.```\n\"contentSearchSpec\":\u00a0{\u00a0 \u00a0\"extractiveContentSpec\": {\u00a0 \u00a0 \u00a0\"maxExtractiveAnswerCount\": 1\u00a0 \u00a0}\u00a0}\n```- `maxExtractiveAnswerCount`: The number of extractive answers to return for each search result. The default value is 0 and the maximum is 5.\n- Get extractive answers from the search response. Extractive answers are returned with each search result in `extractive_answers` .In this example of a document that was returned as one of the results in a search response, an extractive answer was included with the result:```\n{\u00a0 \u00a0\"id\": \"54321\",\u00a0 \u00a0\"document\": {\u00a0 \u00a0 \u00a0\"name\": \"projects/123/locations/global/collections/default_collection/dataStores/example-datastore/branches/0/documents/54321\",\u00a0 \u00a0 \u00a0\"id\": \"54321\",\u00a0 \u00a0 \u00a0\"derivedStructData\": {\u00a0 \u00a0 \u00a0 \u00a0\"extractive_answers\": [\u00a0 \u00a0 \u00a0 \u00a0 \u00a0{\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0\"pageNumber\": \"2\",\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0\"content\": \"Google saw growth throughout the year both in our domestic business and internationally, both on Google owned sites and on the Google Network. Specifically, revenues from Google owned sites increased 101% on a year over year basis, from $792 million to $1.6 billion.\"\u00a0 \u00a0 \u00a0 \u00a0 \u00a0}\u00a0 \u00a0 \u00a0 \u00a0],\u00a0 \u00a0 \u00a0 \u00a0\"link\": \"gs://cloud-samples-data/gen-app-builder/search/alphabet-investor-pdfs/2004Q4_earnings_google.pdf\"\u00a0 \u00a0 \u00a0}}\n```- `pageNumber`: If page numbers can be extracted from the document, this field indicates where the answer was extracted from.\n- `content`: The content of the extractive answer.\n## Extractive segments (Preview)\n**Note:** This feature is a Preview offering, subject to the \"Pre-GA Offerings Terms\" of the [GCP Service Specific Terms](https://cloud.google.com/terms/service-terms) . Pre-GA products and features may have limited support, and changes to pre-GA products and features may not be compatible with other pre-GA versions. For more information, see the [launch stage descriptions](https://cloud.google.com/products#product-launch-stages) . Further, by using this feature, you agree to the [Generative AI Preview terms and conditions](https://cloud.google.com/trustedtester/aitos) (\"Preview Terms\"). For this feature, you can process personal data as outlined in the [Cloud Data Processing Addendum](https://cloud.google.com/terms/data-processing-terms) , subject to applicable restrictions and obligations in the Agreement (as defined in the Preview Terms).\nAn extractive segment is a section of text that is extracted verbatim from a search result document. Extractive segments are similar to [extractiveanswers](#extractive-answers) , but extractive segments usually more complete and verbose. Typically, extractive segments are used as input for your own LLMs to generate answers or new text.\nExtractive segments can be multiple paragraphs, including formatted text such as tables and bulleted lists.\nExtractive segments are available for unstructured search.\n### Extractive segment options\nThe following options are available for extractive segments:\n- **Number of segments** : You can specify up to 10 extractive segments to return for each search result.\n- **Adjacent segments** (Preview): You can set `numPreviousSegments` and `numNextSegments` to get up to 3 segments from immediately before and after the relevant segment. Adjacent segments can add context and accuracy to the relevant segment.Turning on adjacent segments can increase latency. Contact your Google account team to try out adjacent segments.\n- **Relevance scores** : (Private Preview): Relevance scores (previously known as confidence scores) are based on the similarity of the query to the extracted segment. You can specify that extractive segments be returned with relevance scores. Scores range from -1.0 (less relevant) to 1.0 (more relevant).Turning on relevance scores can increase latency. Contact your Google account team to try out relevance scores in Private Preview.\n### Get extractive segments\nTo get extractive segments:\n- Send a search request that uses [ContentSearchSpec.extractiveContentSpec](/generative-ai-app-builder/docs/reference/rest/v1alpha/projects.locations.collections.dataStores.servingConfigs#extractivecontentspec) to specify `maxExtractiveSegmentCount` .The following example of `extractiveContentSpec` specifies that one segment can be returned for each search result.```\n\"contentSearchSpec\":\u00a0{\u00a0 \u00a0\"extractiveContentSpec\": {\u00a0 \u00a0 \u00a0\"maxExtractiveSegmentCount\": 1\u00a0 \u00a0}\u00a0}\n```- `maxExtractiveSegmentCount`: The number of extractive segments to return for each search result. The default value is 0 and the maximum is 10. Private Preview options:\nThere are some Private Preview options associated with segments. Contact your Google account team to try them. For more information about these options, see [Extractive segment options](#segment-options) .- `numPreviousSegments`: The number of adjacent segments to return before the relevant segment. The default value is 0 and the maximum is 3. Using adjacent segments can increase latency.\n- `numNextSegments`: The number of adjacent segments to return after the relevant segment. The default value is 0 and the maximum is 3. Using adjacent segments can increase latency.\n- `returnExtractiveSegmentScore`(Private Preview): Set to`true`to return a relevance score with each segment returned. Contact your Google account team to try relevance scores. For more information about this option, see [Extractive segment options](#segment-options) .\n- Get segments from the search response. Segments are returned with each search result in `extractive_segments` .In this example of a document that was returned as one of the results in a search response, a segment was included with the result:```\n{\u00a0 \u00a0\"id\": \"54321\",\u00a0 \u00a0\"document\": {\u00a0 \u00a0 \u00a0\"name\": \"projects/123/locations/global/collections/default_collection/dataStores/example-datastore/branches/0/documents/54321\",\u00a0 \u00a0 \u00a0\"id\": \"54321\",\u00a0 \u00a0 \u00a0\"derivedStructData\": {\u00a0 \u00a0 \u00a0 \u00a0\"extractive_segments\": [\u00a0 \u00a0 \u00a0 \u00a0 \u00a0{\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0\"pageNumber\": \"2\",\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0\"content\": \"Client\\nGoogle Toolbar. Google Toolbar is a free application that adds a Google search box to web browsers (Internet\\nExplorer and Firefox) and improves user web experience through features such as a pop-up blocker that blocks\\npop-up advertising, an autofill feature that completes web forms with information saved on a user's computer, and\\ncustomizable buttons that let users search their favorite web sites and stay updated on their favorite feeds.\\n\\nGoogle Chrome. Google Chrome is an open-source browser that combines a minimal design with\\ntechnologies to make the web faster, safer, and easier to navigate.\\nGoogle Pack. Google Pack is a free collection of safe, useful software programs from Google and other\\ncompanies that improve the user experience online and on the desktop. It includes programs that help users\\nbrowse the web faster, remove spyware and viruses.\\n\\nPicasa. Picasa is a free service that allows users to view, manage and share their photos. Picasa enables users\\nto import, organize and edit their photos, and upload them to Picasa Web Albums where the photos can be shared\\nwith others on the internet.\\n\\nGoogle Desktop. Google Desktop lets people perform a full-text search on the contents of their own\\ncomputer, including email, files, instant messenger chats and web browser history. Users can view web pages they\\nhave visited even when they are not online. Google Desktop also includes a customizable Sidebar that includes\\nmodules for weather, stock tickers and news.\\n\\n5\"\u00a0 \u00a0 \u00a0 \u00a0 \u00a0}\u00a0 \u00a0 \u00a0 \u00a0],\u00a0 \u00a0 \u00a0 \u00a0\"link\": \"gs://cloud-samples-data/gen-app-builder/search/alphabet-investor-pdfs/2004Q4_earnings_google.pdf\"\u00a0 \u00a0 \u00a0}}\n```- `pageNumber`: If page numbers can be extracted from the document, this field indicates where the answer was extracted from.\n- `content`: The content of the extractive segment.\n## What's next\n- [Preview search results](/generative-ai-app-builder/docs/preview-search-results)", "guide": "Vertex AI Search and Conversation"}