{"title": "Vertex AI Search and Conversation - Import data into a media data store", "url": "https://cloud.google.com/generative-ai-app-builder/docs/import-data-media-recommendations?hl=zh-cn", "abstract": "# Vertex AI Search and Conversation - Import data into a media data store\nThis page explains how to add data to a data store that is connected to a media app.\nIdeally, you should update your data store daily, by importing fresh data. Scheduling periodic imports prevents model quality from degrading over time. You can use [Google Cloud Scheduler](https://cloud.google.com/scheduler) to automate imports.\nYou can update only new or changed documents, or you can import the entire data store. If you import documents that are already in your data store, they are not added again. Any document that has changed is updated.\n", "content": "## Before you begin\nMake sure that you do the following:\n- Put your media documents into the predefined JSON schema for media. For more information, see [About media documents and datastores](/generative-ai-app-builder/docs/media-documents) .\n- Create an app and a data store and connect the app to the data store. For more information, see [Create a mediaapp and data store](/generative-ai-app-builder/docs/create-app-data-store-media-recommendations) .\n- Review [About media user events](/generative-ai-app-builder/docs/user-events) and prepare your user events for import. User events are required for media and are recommended for media .## Import documents and user events\nTo import documents and user events, go to the section for the source that you plan to use:\n- [BigQuery](#bigquery) \n- [Cloud Storage](#cloud-storage) \n- [Import documents using the API](#import-documents-using-the-api) ## BigQuery\nTo use the Google Cloud console to import documents and user events from BigQuery, follow these steps:- In the Google Cloud console, go to the **Search and Conversation** page. [Search and Conversation](https://console.cloud.google.com/gen-app-builder/) \n- To import documents, do the following:- In the navigation menu, make sure **Apps** is selected.\n- Click the app that you previously created and connected to an empty data store.\n- In the **Requirements tab** , click **Import documents** .\n- On the **Select a data source** page, select **BigQuery** .\n- In the **BigQuery path** field, click **Browse** , select a documents table that you have [prepared for ingesting](/generative-ai-app-builder/docs/prepare-data) , and then click **Select** . Alternatively, enter the table location directly in the **BigQuery path** field.\n- Click **Import** . In the **Activity** tab, the **Status** column indicates **Import in progress** . **Import complete** displays when all of your documents are imported. This can take hours or days, depending on the amount of data. **Important:** Wait until your document import is complete before importing user events to avoid unjoined user events.\n- To import user events, do the following:- Click **Events** .\n- Click **Import events** .\n- On the **Select a data source** page, select **BigQuery** .\n- In the **BigQuery path** field, click **Browse** , select a user events table that you have [prepared foringesting](/generative-ai-app-builder/docs/prepare-data) , and then click **Select** . Alternatively, enter the table location directly in the **BigQuerypath** field.\n- Click **Import** . In the **Activity** tab, the **Status** column indicates **Import in progress** . **Import complete** displays when all of your user events are imported. This can take hours or days, depending on the amount of data.\n- Click **Requirements** to see if the data requirements are met. It can take up to one hour after completing data imports for the data requirements to refresh. If you still have data requirements that are not met, import documents or user events as required.\n## Cloud Storage\nTo use the Google Cloud console to import documents and user events from Cloud Storage, follow these steps:- In the Google Cloud console, go to the **Search and Conversation** page. [Search and Conversation](https://console.cloud.google.com/gen-app-builder/) \n- To import documents, do the following:- In the navigation menu, make sure **Apps** is selected.\n- Click the app that you previously created and connected to an empty data store.\n- In the **Requirements tab** , click **Import documents** .\n- On the **Select a data source** page, select **Cloud Storage** .\n- In the **Import data from Cloud Storage** pane, select **Folder** or **File** , depending on whether you are importing multiple files or a single file.\n- In the `gs://` field, click **Browse** , select the document(s) that you have [prepared for ingesting](/generative-ai-app-builder/docs/prepare-data) , and then click **Select** . Alternatively, enter the path directly in the **Cloud Storage path** field.\n- Click **Import** . In the **Activity** tab, the **Status** column indicates **Import in progress** . **Import complete** displays when all of your documents are imported. This can take hours or days, depending on the amount of data. **Important:** Wait until your document import is complete before importing user events to avoid unjoined user events.\n- To import user events, do the following:- Click **Events** .\n- Click **Import events** .\n- On the **Select a data source** page, select **Cloud Storage** .\n- In the **Import data from Cloud Storage** pane, select **Folder** or **File** , depending on whether you are importing multiple files or a single file.\n- In the `gs://` field, click **Browse** , select the user events(s) that you have [prepared for ingesting](/generative-ai-app-builder/docs/prepare-data) , and then click **Select** . Alternatively, enter the path directly in the **Cloud Storage path** field.\n- Click **Import** . In the **Activity** tab, the **Status** column indicates **Import in progress** . **Import complete** displays when all of your user events are imported. This can take hours or days, depending on the amount of data.\n- Click **Requirements** to see if the data requirements are met. It can take up to one hour after completing data imports for the data requirements to refresh. If you still have data requirements that are not met, import documents or user events as required.\n## Import documents using the API\nYou import your documents by making a `POST` request to the [Documents:import](/generative-ai-app-builder/docs/reference/rest/v1beta/projects.locations.dataStores.branches.documents/import) REST method, using the [InlineSource](/generative-ai-app-builder/docs/reference/rest/v1beta/projects.locations.dataStores.branches.documents/import#InlineSource) object to specify your data.\nFor an example of the JSON document format, see [JSON document format](#json-format) .\n### Import requirements\nHere are the requirements for importing media documents using the API:\n- Each document must be on its own line.\n- The maximum number of documents in a single import is 100.\n### Procedure\nTo import media documents using the API, do the following:\n- Create the JSON file for your document and call it `./data.json` :```\n{\n\"inlineSource\": {\n\"documents\": [ { DOCUMENT_1 },\n { DOCUMENT_2 }\n]\n}\n}\n```\n- Call the POST method:```\ncurl -X POST \\\u00a0-H \"Authorization: Bearer $(gcloud auth print-access-token)\" \\\u00a0-H \"Content-Type: application/json; charset=utf-8\" \\\u00a0--data @./data.json \\\"https://discoveryengine.googleapis.com/v1beta/projects/PROJECT_ID/locations/global/dataStores/DATA_STORE_ID/branches/0/documents:import\"\n```- : The ID of your project.\n- : The ID of your data store.\n### JSON document format\nThe following examples show `Document` entries in JSON format.\nProvide an entire document on a single line. Each document should be on its own line.\nMinimum required fields:\n```\n{\u00a0 \u00a0\"id\": \"sample-01\",\u00a0 \u00a0\"schemaId\": \"default_schema\",\u00a0 \u00a0\"jsonData\": \"{\\\"title\\\":\\\"Test document title\\\",\\\"categories\\\":[\\\"sports > clip\\\",\\\"sports > highlight\\\"],\\\"uri\\\":\\\"http://www.example.com\\\",\\\"media_type\\\":\\\"sports-game\\\",\\\"available_time\\\":\\\"2022-08-26T23:00:17Z\\\"}\"}\n```\nComplete object:\n```\n{\u00a0 \u00a0\"id\": \"child-sample-0\",\u00a0 \u00a0\"schemaId\": \"default_schema\",\u00a0 \u00a0\"jsonData\": \"{\\\"title\\\":\\\"Test document title\\\",\\\"description\\\":\\\"Test document description\\\",\\\"language_code\\\":\\\"en-US\\\",\\\"categories\\\":[\\\"sports > clip\\\",\\\"sports > highlight\\\"],\\\"uri\\\":\\\"http://www.example.com\\\",\\\"images\\\":[{\\\"uri\\\":\\\"http://example.com/img1\\\",\\\"name\\\":\\\"image_1\\\"}],\\\"media_type\\\":\\\"sports-game\\\",\\\"in_languages\\\":[\\\"en-US\\\"],\\\"country_of_origin\\\":\\\"US\\\",\\\"content_index\\\":0,\\\"persons\\\":[{\\\"name\\\":\\\"sports person\\\",\\\"role\\\":\\\"player\\\",\\\"rank\\\":0,\\\"uri\\\":\\\"http://example.com/person\\\"},],\\\"organizations \\\":[{\\\"name\\\":\\\"sports team\\\",\\\"role\\\":\\\"team\\\",\\\"rank\\\":0,\\\"uri\\\":\\\"http://example.com/team\\\"},],\\\"hash_tags\\\":[\\\"tag1\\\"],\\\"filter_tags\\\":[\\\"filter_tag\\\"],\\\"production_year\\\":1900,\\\"duration\\\":\\\"100s\\\",\\\"content_rating\\\":[\\\"PG-13\\\"],\\\"aggregate_ratings\\\":[{\\\"rating_source\\\":\\\"imdb\\\",\\\"rating_score\\\":4.5,\\\"rating_count\\\":1250}],\\\"available_time\\\":\\\"2022-08-26T23:00:17Z\\\"}\"}\n```", "guide": "Vertex AI Search and Conversation"}