{"title": "Vertex AI Search and Conversation - Search healthcare data", "url": "https://cloud.google.com/generative-ai-app-builder/docs/search-hc-data?hl=zh-cn", "abstract": "# Vertex AI Search and Conversation - Search healthcare data\n**Caution:** - Restrictions for healthcare: As a customer, you will not, and will not allow End Users to, use the Generative AI Services for clinical purposes (for clarity, non-clinical research, scheduling, or other administrative tasks is not restricted), as a substitute for professional medical advice, or in any manner that is overseen by or requires clearance or approval from any applicable regulatory authority. For more information, see [Service Specific Terms](https://cloud.google.com/terms/service-terms) .\n- The generated output may not always be completely reliable. Due to the nature of LLMs and Generative AI, outputs may have incorrect or biased (for example, stereotypes or other harmful content) information and should be reviewed. All summaries or answers should be considered draft and not final.\n- This product's intended usage is not to provide information pertaining to the prevention, diagnosis or treatment of illness or disease. Questions regarding diagnosis or treatment recommendations are not intended to be addressed by the product. This product's intended use is to retrieve and summarize existing medical information provided by users.\n- Due to limited test data, this product may or may not be applicable to age group 0-18 and to age group 85 and above. Therefore, when reviewing the generated output, customers must consider the representativeness of subpopulations within their source data.After importing FHIR R4 data into your healthcare search app, you can query the imported data to get relevant results. You can search using the following types of queries:\n- Keyword query\n- Natural language query\n- Natural language query with a generative AI answer\nAdditionally, you can filter your search using date-filtered queries. For more information, see [Define a resource_datetime filter](/generative-ai-app-builder/docs/filter-hc-search#resource-datetime-filter) .\nWhen you search in the Google Cloud console, you must first provide a patient ID and search over a single patient's data at a time. When you search using the REST API, you can search over your entire data store.\nThis page shows how to search healthcare data using the various types of queries.\n", "content": "## Intended use of Vertex AI Search for searching healthcare data\nThe intended usage of Vertex AI Search is not to provide information pertaining to the prevention, diagnosis, or treatment of illness or disease. Questions regarding diagnosis or treatment recommendations are not intended to be addressed by the product. The intended use of this product is to retrieve and summarize existing medical information provided by users.\nDue to limited test data, this product may or may not be applicable to age groups 0-18, and 85 and above. Therefore, when reviewing the generated output, customers must consider the representativeness of subpopulations within their source data.\nThe following are a few examples of how this product is intended to be used:\n- Exploratory queries to find a patient's information relevant to a topic:- \"Summarize the aspirin uses\"\n- \"blood pressure\"\n- \"diabetes management?\"\n- Navigational queries to find specific resources that could be mapped to a structured query:- \"Show me the most recent a1c\"\n- Extractive questions and answers to answer specific questions where evidence may be spread across resources:- \"Has this patient ever been treated with a cephalsporin\"\n- \"Has the patient ever undergone psychiatry evaluation\"The following are examples of how this product is **not** intended to be used:\n- Diagnosis recommendations and treatment recommendations:- \"What is the differential diagnosis for this patient?\"\n- \"What drugs should I prescribe to the patient?\"\n## Before you begin\nBefore you search, do the following:\n- Create a healthcare search app and a healthcare search data store, and import FHIR R4 data. For more information, see [Create a healthcare search app](/generative-ai-app-builder/docs/create-app-hc) and [Create a healthcare search data store](/generative-ai-app-builder/docs/create-data-store-hc) .\n- [Configure search results for healthcare data](/generative-ai-app-builder/docs/configure-widget-attributes#display-hc) .\n- Review the list of FHIR R4 resources that Vertex AI Search supports. For more information, see [Healthcare FHIR R4 data schema reference](/generative-ai-app-builder/docs/fhir-schema-reference) .## Search using a keyword\nYou can search your healthcare data store using a keyword. For example, you can search using keywords such as \"a1c\", \"insulin\", or \"ulcer\" to get relevant FHIR resources.\nThe following image shows the search results when the keyword is \"lipid\". This example doesn't include a summary or generative AI answer.\nTo search using a keyword, complete the following steps.\n- In the Google Cloud console, go to the **Search and Conversation** page. [Search and Conversation](https://console.cloud.google.com/gen-app-builder/) \n- Select the healthcare search app that you want to query.\n- In the navigation menu, click **Preview** .\n- In the **Patient ID** field, enter the ID of the patient whose data you want to query. Patient IDs are case-sensitive.\n- Press **Enter** or click **Preview** to submit the patient ID.\n- In the **Search here** search bar, type a keyword to search.\n- Press **Enter** to submit the query.The search results are displayed in paginated tables that are categorized based on their FHIR resource type.\n- Optional. Select one or more FHIR resource categories that are under the search bar to filter the results.\nThe following sample shows how to search a single patient's FHIR R4 data in the healthcare search app using a keyword. This sample uses the [servingConfigs.search](/generative-ai-app-builder/docs/reference/rest/v1alpha/projects.locations.collections.dataStores.servingConfigs/search) method.- Search using a keyword.```\ncurl -X POST -H \"Authorization: Bearer $(gcloud auth print-access-token)\" \\\n -H \"Content-Type: application/json\" \\\n \"https://us-discoveryengine.googleapis.com/v1alpha/projects/PROJECT_ID/locations/us/collections/default_collection/dataStores/DATA_STORE_ID/servingConfigs/default_search:search\" \\\n -d '{\n\"query\": \"KEYWORD_QUERY\",\n\"filter\": \"patient_id: ANY(\\\"PATIENT_ID\\\")\",\n\"contentSearchSpec\":{\"snippetSpec\":{\"returnSnippet\":true}}\n}'\n```Replace the following:- ``: the ID of your Google Cloud project\n- ``: the ID of the Vertex AI Search data store\n- ``: the keyword that you want to search across the patient clinical data for the filtered patient, such as \"diabetes\" or \"a1c\"\n- ``: the resource ID of the patient whose data you want to search\n## Search using natural language query\nUsing Vertex AI Search, you can get results for complex natural language queries. For example, the following image shows the results for the the natural language query: \"Lab results related to diabetes\".\nTo search using natural language query, complete the following steps.\n- In the Google Cloud console, go to the **Search and Conversation** page. [Search and Conversation](https://console.cloud.google.com/gen-app-builder/) \n- Select the healthcare search app that you want to query.\n- In the navigation menu, click **Preview** .\n- In the **Patient ID** field, enter the patient ID of the patient whose data you want to query. Patient IDs are case-sensitive.\n- Press **Enter** or click **Preview** to submit the patient ID.\n- In the **Search here** search bar, enter a natural language query, such as \"Lab results related to diabetes\".\n- Press **Enter** to submit the query.The search results are displayed in paginated tables that are categorized based on their FHIR resource type.\n- Optional. Select one or more FHIR resource categories that are under the search bar to filter the results.\nThe following sample shows how to search a single patient's FHIR R4 data in the healthcare search app using a natural language query. This sample uses the [servingConfigs.search](/generative-ai-app-builder/docs/reference/rest/v1alpha/projects.locations.collections.dataStores.servingConfigs/search) method. To search using a natural language query, you must add the `natural_language_query_understanding_spec` field to the request body.- Post a query in natural language.```\ncurl -X POST -H \"Authorization: Bearer $(gcloud auth print-access-token)\" \\\n -H \"Content-Type: application/json\" \\\n \"https://us-discoveryengine.googleapis.com/v1alpha/projects/PROJECT_ID/locations/us/collections/default_collection/dataStores/DATA_STORE_ID/servingConfigs/default_search:search\" \\\n -d '{\n\"query\": \"NATURAL_LANGUAGE_QUERY\",\n\"filter\": \"patient_id: ANY(\\\"PATIENT_ID\\\")\",\n\"contentSearchSpec\":{\"snippetSpec\":{\"returnSnippet\":true}},\n\"natural_language_query_understanding_spec\":{\"filter_extraction_condition\":\"ENABLED\"}\n}'\n```Replace the following:- ``: the ID of your Google Cloud project\n- ``: the ID of the Vertex AI Search data store\n- ``: the query in natural language, such as \"Lab results related to diabetes\" or \"Is the patient currently on any medication\"\n- ``: the resource ID of the patient whose data you want to search\n## Search using natural language query with generative AI answer\n**Note:** This feature is a Preview offering, subject to the \"Pre-GA Offerings Terms\" of the [GCP Service Specific Terms](https://cloud.google.com/terms/service-terms) . Pre-GA products and features may have limited support, and changes to pre-GA products and features may not be compatible with other pre-GA versions. For more information, see the [launch stage descriptions](https://cloud.google.com/products#product-launch-stages) . Further, by using this feature, you agree to the [Generative AI Preview terms and conditions](https://cloud.google.com/trustedtester/aitos) (\"Preview Terms\"). For this feature, you can process personal data as outlined in the [Cloud Data Processing Addendum](https://cloud.google.com/terms/data-processing-terms) , subject to applicable restrictions and obligations in the Agreement (as defined in the Preview Terms).\nWhen you search a patient's FHIR data using a natural language query, you can choose to get a generative AI answer along with the search results. The answer summarizes the search results and also shows the references that are used to generate the answer.\nWhen using the console, you can select the large language model (LLM) for generative AI answers. For more information, see [Configure search results for healthcare data](/generative-ai-app-builder/docs/configure-widget-attributes#display-hc) .\nWhen using the REST API, you can specify one of the following LLM models to give you generative AI answers in the `version` field:\n- `text-bison@001/answer_gen/v1`or`stable`: a stable, generally available model that's based on the`text-bison`model (default). For more information, see [Generally available (GA) models](/generative-ai-app-builder/docs/answer-generation-models#generally_available_ga_models) .\n- `gemini-1.0-pro-001/answer_gen/v1`: a preview model that's based on the`gemini-pro`model. For more information, see [Preview models](/generative-ai-app-builder/docs/answer-generation-models#preview_models) .\n- `preview`: a preview model that's based on the MedLM model. For more information, see [MedLM model](/vertex-ai/generative-ai/docs/medlm/overview) .\nThe following image shows an example of a natural language query with generative AI answer. The search summary provides an answer for the query by summarizing the findings from relevant results. You can expand segments that have citations to see the references that are used to generate the selected segment. Not all generated answers have citations.\nTo search with generative AI answer, do the following:\n- In the Google Cloud console, go to the **Search and Conversation** page. [Search and Conversation](https://console.cloud.google.com/gen-app-builder/) \n- Select the healthcare search app that you want to query.\n- In the navigation menu, click **Configurations** .\n- Customize the search widget:- In the **Search type** field, select **Search with an answer** .\n- Select the model that you want to use to generate the summary. For more information, see [Configure search results for healthcare data](/generative-ai-app-builder/docs/configure-widget-attributes#display-hc) \n- Save and publish your preferences.\n- In the navigation menu, click **Preview** .\n- In the **Patient ID** field, enter the patient ID of the patient whose data you want to query. Patient IDs are case-sensitive.\n- Press **Enter** or click **Preview** to submit the patient ID.\n- In the **Search here** search bar, enter a natural language query, such as \"nsaids\", \"What are the patient's lipid labs\", or \"What is the most recent A1C result\".\n- Press **Enter** to submit the query.The search results are displayed in paginated tables that are categorized based on their FHIR resource type.\n- Optional. Select one or more FHIR resource categories that are under the search bar to filter the results.\n- Optional. Expand a segment of the answer that has citations to see its references from the search results.\nThe following sample shows how to search a single patient's FHIR R4 data in the healthcare search app using a natural language query with generative AI answers. This sample uses the [servingConfigs.search](/generative-ai-app-builder/docs/reference/rest/v1alpha/projects.locations.collections.dataStores.servingConfigs/search) method. To search using a natural language query, you must add the `natural_language_query_understanding_spec` field to the request body.- Post a query in natural language.```\ncurl -X POST -H \"Authorization: Bearer $(gcloud auth print-access-token)\" \\\n -H \"Content-Type: application/json\" \\\n \"https://us-discoveryengine.googleapis.com/v1alpha/projects/PROJECT_ID/locations/us/collections/default_collection/dataStores/DATA_STORE_ID/servingConfigs/default_search:search\" \\\n -d '{\n  \"query\": \"QUERY\",\n  \"filter\": \"patient_id: ANY(\\\"PATIENT_ID\\\")\",\n  \"contentSearchSpec\": {\n   \"snippetSpec\": {\n   \"returnSnippet\": true\n   },\n   \"summary_spec\": {\n   \"summary_result_count\": 1,\n   \"model_spec\": {\n    \"version\": \"MODEL_VERSION\"\n   }\n   }\n  },\n  \"natural_language_query_understanding_spec\": {\n   \"filter_extraction_condition\": \"ENABLED\"\n  }\n  }'\n```Replace the following:- ``: the ID of your Google Cloud project.\n- ``: the ID of the Vertex AI Search data store.\n- ``: the query in natural language, such as \"nsaids\", \"What are the patients lipid labs\", or \"What is the most recent A1C result\". If the query includes an apostrophe`'`, you must replace it with apostrophe's numeric character reference:`&#39;`.\n- ``: the resource ID of the patient whose data you want to search.\n- ``: the model version that you want to use to generate the answer.", "guide": "Vertex AI Search and Conversation"}