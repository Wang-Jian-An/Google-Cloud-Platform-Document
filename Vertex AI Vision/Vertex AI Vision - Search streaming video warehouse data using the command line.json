{"title": "Vertex AI Vision - Search streaming video warehouse data using the command line", "url": "https://cloud.google.com/vision-ai/docs/search-cli-streaming-warehouse?hl=zh-cn", "abstract": "# Vertex AI Vision - Search streaming video warehouse data using the command line\nAfter you have created a Vision Warehouse, added it to an app, and deployed the app, you can search the data stored in the streaming video warehouse.\n", "content": "## Search streaming video metadata\nTo search the data ( [assets](/vision-ai/docs/reference/rest/v1/projects.locations.corpora.assets) ) in your warehouse ( [corpus](/vision-ai/docs/reference/rest/v1/projects.locations.corpora) ), populate the [SearchAssetsRequest](/vision-ai/docs/reference/rpc/google.cloud.visionai.v1#searchassetsrequest) with the content that you would like to find. This content comes in a few different formats:\n- [criteria](/vision-ai/docs/reference/rest/v1/projects.locations.corpora/searchAssets#Criteria) - Text, number, or date content provided by the user.\n- [facet_selections](/vision-ai/docs/reference/rest/v1/projects.locations.corpora/searchAssets#FacetGroup) - Text content returned by the server, and selected by the user.\n- [content_time_ranges](/vision-ai/docs/reference/rest/v1/projects.locations.corpora/searchAssets#DateTimeRangeArray) - Date ranges that all returned content must fall in.\nIn the following example, consider a Warehouse that contains security camera footage from different types of stores across the country. To retrieve all assets for the years 2018 2020 tagged with the annotation `\"state\": \"California\"` , or the annotation `\"state\":\"Pennsylvania\"` , send the following request:\nTo search assets, send a POST request by using the [projects.locations.corpora.searchAssets](/vision-ai/docs/reference/rest/v1/projects.locations.corpora/searchAssets) method.\nIn this sample body the\n [criteria](/vision-ai/docs/reference/rest/v1alpha1/projects.locations.corpora/searchAssets#Criteria) \nfield use\n`textArray`\nvalues to provide two\n`txt_values`\n: \"California\" and \"Pennsylvania\". You can also provide search criteria for other data types. You can only specify one type of search criteria in each request.Before using any of the request data, make the following replacements:- : Endpoint might include a prefix matching the`LOCATION_ID`such as`europe-west4-`. See more about [ regionalized endpoints](/vision-ai/docs/warehouse-supported-regions) .\n- : Your Google Cloud [project number](/resource-manager/docs/creating-managing-projects#identifying_projects) .\n- : The [region](/about/locations) where you are using Vertex AI Vision. For example:`us-central1`,`europe-west4`. See [available regions](/vision-ai/docs/warehouse-supported-regions) .\n- : The ID of your target corpus.\nHTTP method and URL:\n```\nPOST https://warehouse-visionai.googleapis.com/v1/projects/PROJECT_NUMBER/locations/LOCATION_ID/corpora/CORPUS_ID:searchAssets\n```\nRequest JSON body:\n```\n{\n \"page_size\": \"2\",\n \"content_time_ranges\": {\n \"date_time_ranges\": {\n  \"start\": {\n  \"year\":\"2018\",\n  \"month\":\"1\",\n  \"day\":\"1\",\n  },\n  \"end\": {\n  \"year\":\"2019\",\n  \"month\":\"1\",\n  \"day\":\"1\",\n  }\n },\n \"date_time_ranges\": {\n  \"start\": {\n  \"year\":\"2020\",\n  \"month\":\"1\",\n  \"day\":\"1\",\n  },\n  \"end\": {\n  \"year\":\"2021\",\n  \"month\":\"1\",\n  \"day\":\"1\",\n  }\n }\n },\n \"criteria\": {\n \"field\": \"state\",\n \"text_array\": {\n  \"txt_values\": \"California\",\n  \"txt_values\": \"Pennsylvania\"\n }\n }\n}\n```\nTo send your request, choose one of these options:\n **Note:** The following command assumes that you have logged in to  the`gcloud`CLI with your user account by running [gcloud init](/sdk/gcloud/reference/init) or [gcloud auth login](/sdk/gcloud/reference/auth/login) ,  or by using [Cloud Shell](/shell/docs) ,  which automatically logs you into the`gcloud`CLI.  You can check the currently active account by running [gcloud auth list](/sdk/gcloud/reference/auth/list) .\nSave the request body in a file named `request.json` ,  and execute the following command:\n```\ncurl -X POST \\ -H \"Authorization: Bearer $(gcloud auth print-access-token)\" \\ -H \"Content-Type: application/json; charset=utf-8\" \\ -d @request.json \\ \"https://warehouse-visionai.googleapis.com/v1/projects/PROJECT_NUMBER/locations/LOCATION_ID/corpora/CORPUS_ID:searchAssets\"\n``` **Note:** The following command assumes that you have logged in to  the`gcloud`CLI with your user account by running [gcloud init](/sdk/gcloud/reference/init) or [gcloud auth login](/sdk/gcloud/reference/auth/login) ,  or by using [Cloud Shell](/shell/docs) ,  which automatically logs you into the`gcloud`CLI.  You can check the currently active account by running [gcloud auth list](/sdk/gcloud/reference/auth/list) .\nSave the request body in a file named `request.json` ,  and execute the following command:\n```\n$cred = gcloud auth print-access-token$headers = @{ \"Authorization\" = \"Bearer $cred\" }Invoke-WebRequest ` -Method POST ` -Headers $headers ` -ContentType: \"application/json; charset=utf-8\" ` -InFile request.json ` -Uri \"https://warehouse-visionai.googleapis.com/v1/projects/PROJECT_NUMBER/locations/LOCATION_ID/corpora/CORPUS_ID:searchAssets\" | Select-Object -Expand Content\n```\nYou should receive a JSON response similar to the following:To retrieve the next page of results, pass the original request parameters appended with the returned `next_page_token` .\nThe `facet_results` array shows content that matched the original query. The response above indicates that one of the security cameras is stationed at a sporting goods store, while the other one is stationed at a grocery store.\nTo restrict this query to only show the grocery store footage, pass back the same request with a .\n **Request JSON body with facet selection** :\n```\n{\n \"page_size\": \"2\",\n \"content_time_ranges\": {\n \"date_time_ranges\": {\n  \"start\": {\n  \"year\":\"2018\",\n  \"month\":\"1\",\n  \"day\":\"1\",\n  },\n  \"end\": {\n  \"year\":\"2018\",\n  \"month\":\"12\",\n  \"day\":\"31\",\n  }\n },\n \"date_time_ranges\": {\n  \"start\": {\n  \"year\":\"2020\",\n  \"month\":\"1\",\n  \"day\":\"1\",\n  },\n  \"end\": {\n  \"year\":\"2020\",\n  \"month\":\"12\",\n  \"day\":\"31\",\n  }\n }\n },\n \"criteria\": {\n \"field\": \"state\",\n \"text_array\": {\n  \"txt_values\": \"California\",\n  \"txt_values\": \"Pennsylvania\"\n }\n },\n \"facet_selections\": {\n \"facetId\": \"state\",\n \"displayName\": \"State\",\n \"buckets\": {\n  \"value\": {\n   \"stringValue\": \"California\"\n  }\n },\n \"buckets\": {\n  \"value\": {\n  \"stringValue\": \"Pennsylvania\"\n  }\n },\n \"bucketType\": \"FACET_BUCKET_TYPE_VALUE\"\n },\n \"facet_selections\": {\n \"facetId\": \"store-type\",\n \"displayName\": \"StoreType\",\n \"buckets\": {\n  \"value\": {\n  \"stringValue\": \"Sporting Goods\"\n  }\n },\n \"buckets\": {\n  \"value\": {\n  \"stringValue\": \"Grocery\"\n  },\n  \"selected\": \"true\"\n },\n \"bucketType\": \"FACET_BUCKET_TYPE_VALUE\"\n }\n}\n```\nBecause the facet is selected, any response will contain the annotation `\"store-type\":\"Grocery\"` .### Return clip asset metadata when searching\nThe Vertex AI Vision API also allows users to specify extra clip metadata to return with the search result, using `result_annotation_keys` .\nIn this example the user provided annotation key `\"camera-location\"` is specified in the request body, and the key's value ( `\"Sunnyvale\"` ) is provided in the response.Before using any of the request data, make the following replacements:- : Endpoint might include a prefix matching the`LOCATION_ID`such as`europe-west4-`. See more about [ regionalized endpoints](/vision-ai/docs/warehouse-supported-regions) .\n- : Your Google Cloud [project number](/resource-manager/docs/creating-managing-projects#identifying_projects) .\n- : The [region](/about/locations) where you are using Vertex AI Vision. For example:`us-central1`,`europe-west4`. See [available regions](/vision-ai/docs/warehouse-supported-regions) .\n- : The ID of your target corpus.\nHTTP method and URL:\n```\nPOST https://warehouse-visionai.googleapis.com/v1/projects/PROJECT_NUMBER/locations/LOCATION_ID/corpora/CORPUS_ID:searchAssets\n```\nRequest JSON body:\n```\n{\n \"page_size\": \"2\",\n \"criteria\": {\n  \"field\": \"state\",\n  \"text_array\": {\n  \"txt_values\": \"California\",\n  \"txt_values\": \"Pennsylvania\"\n  }\n },\n \"result_annotation_keys\": \"camera-location\"\n}\n```\nTo send your request, choose one of these options:\n **Note:** The following command assumes that you have logged in to  the`gcloud`CLI with your user account by running [gcloud init](/sdk/gcloud/reference/init) or [gcloud auth login](/sdk/gcloud/reference/auth/login) ,  or by using [Cloud Shell](/shell/docs) ,  which automatically logs you into the`gcloud`CLI.  You can check the currently active account by running [gcloud auth list](/sdk/gcloud/reference/auth/list) .\nSave the request body in a file named `request.json` ,  and execute the following command:\n```\ncurl -X POST \\ -H \"Authorization: Bearer $(gcloud auth print-access-token)\" \\ -H \"Content-Type: application/json; charset=utf-8\" \\ -d @request.json \\ \"https://warehouse-visionai.googleapis.com/v1/projects/PROJECT_NUMBER/locations/LOCATION_ID/corpora/CORPUS_ID:searchAssets\"\n``` **Note:** The following command assumes that you have logged in to  the`gcloud`CLI with your user account by running [gcloud init](/sdk/gcloud/reference/init) or [gcloud auth login](/sdk/gcloud/reference/auth/login) ,  or by using [Cloud Shell](/shell/docs) ,  which automatically logs you into the`gcloud`CLI.  You can check the currently active account by running [gcloud auth list](/sdk/gcloud/reference/auth/list) .\nSave the request body in a file named `request.json` ,  and execute the following command:\n```\n$cred = gcloud auth print-access-token$headers = @{ \"Authorization\" = \"Bearer $cred\" }Invoke-WebRequest ` -Method POST ` -Headers $headers ` -ContentType: \"application/json; charset=utf-8\" ` -InFile request.json ` -Uri \"https://warehouse-visionai.googleapis.com/v1/projects/PROJECT_NUMBER/locations/LOCATION_ID/corpora/CORPUS_ID:searchAssets\" | Select-Object -Expand Content\n```\nYou should receive a JSON response similar to the following:### Use criteria to return asset metadata in search\nYou can specify in search criteria whether to return the matched annotations for each search result item. This feature is supported for limited data schema types: `INTEGER` , `FLOAT` , `BOOLEAN` , `STRING` ( `EXACT_SEARCH` only), and the annotation must be on partition-level.\nAssume you create the following data schema in a warehouse corpus:\n```\n{\n \"key\": \"image-classification\",\n \"schema_details\": {\n \"type\":\"STRING\",\n \"granularity\":\"GRANULARITY_PARTITION_LEVEL\",\n \"search_strategy\": {\n  \"search_strategy_type\":\"EXACT_SEARCH\"\n }\n }\n}\n```\nSome annotations for `\"image-classification\"` are ingested to the corpus using streaming video ingestion or a `CreateAnnotation` request.\nAfter there are annotations ingested, you can search for `\"image-classification\"` and get video results and their corresponding annotations:\n<p> In this example the user provided annotation key <code translate=\"no\" dir=\"ltr\">\"camera-location\"</code> is specified in the request body, and the key's value (<code translate=\"no\" dir=\"ltr\">\"Sunnyvale\"</code>) is provided in the response. </p>Before using any of the request data, make the following replacements:- : Endpoint might include a prefix matching the`LOCATION_ID`such as`europe-west4-`. See more about [ regionalized endpoints](/vision-ai/docs/warehouse-supported-regions) .\n- : Your Google Cloud [project number](/resource-manager/docs/creating-managing-projects#identifying_projects) .\n- : The [region](/about/locations) where you are using Vertex AI Vision. For example:`us-central1`,`europe-west4`. See [available regions](/vision-ai/docs/warehouse-supported-regions) .\n- : The ID of your target corpus.\nHTTP method and URL:\n```\nPOST https://warehouse-visionai.googleapis.com/v1/projects/PROJECT_NUMBER/locations/LOCATION_ID/corpora/CORPUS_ID:searchAssets\n```\nRequest JSON body:\n```\n{\n \"page_size\": \"5\",\n \"facet_selections\": {\n \"facet_id\": \"image-classification\",\n \"fetch_matched_annotations\": \"true\",\n \"bucket_type\": \"FACET_BUCKET_TYPE_VALUE\",\n  \"buckets\": {\n  \"value\": {\n   \"string_value\": \"cat\"\n  },\n  \"selected\" : \"true\"\n  },\n }\n}\n```\nTo send your request, choose one of these options:\n **Note:** The following command assumes that you have logged in to  the`gcloud`CLI with your user account by running [gcloud init](/sdk/gcloud/reference/init) or [gcloud auth login](/sdk/gcloud/reference/auth/login) ,  or by using [Cloud Shell](/shell/docs) ,  which automatically logs you into the`gcloud`CLI.  You can check the currently active account by running [gcloud auth list](/sdk/gcloud/reference/auth/list) .\nSave the request body in a file named `request.json` ,  and execute the following command:\n```\ncurl -X POST \\ -H \"Authorization: Bearer $(gcloud auth print-access-token)\" \\ -H \"Content-Type: application/json; charset=utf-8\" \\ -d @request.json \\ \"https://warehouse-visionai.googleapis.com/v1/projects/PROJECT_NUMBER/locations/LOCATION_ID/corpora/CORPUS_ID:searchAssets\"\n``` **Note:** The following command assumes that you have logged in to  the`gcloud`CLI with your user account by running [gcloud init](/sdk/gcloud/reference/init) or [gcloud auth login](/sdk/gcloud/reference/auth/login) ,  or by using [Cloud Shell](/shell/docs) ,  which automatically logs you into the`gcloud`CLI.  You can check the currently active account by running [gcloud auth list](/sdk/gcloud/reference/auth/list) .\nSave the request body in a file named `request.json` ,  and execute the following command:\n```\n$cred = gcloud auth print-access-token$headers = @{ \"Authorization\" = \"Bearer $cred\" }Invoke-WebRequest ` -Method POST ` -Headers $headers ` -ContentType: \"application/json; charset=utf-8\" ` -InFile request.json ` -Uri \"https://warehouse-visionai.googleapis.com/v1/projects/PROJECT_NUMBER/locations/LOCATION_ID/corpora/CORPUS_ID:searchAssets\" | Select-Object -Expand Content\n```\nYou should receive a JSON response similar to the following:### Use global search to return asset metadata in search\nGlobal search provides a place for users to enter search queries, instead of specifying individual criteria. You can search against string-type criteria set to be searchable in its data schema. The matching results are retrieved and returned to you.\nTo use this feature, set the `search_query` field in the [SearchAssetsRequest](/vision-ai/docs/reference/rpc/google.cloud.visionai.v1#searchassetsrequest) :\nBefore using any of the request data, make the following replacements:- : Endpoint might include a prefix matching the`LOCATION_ID`such as`europe-west4-`. See more about [ regionalized endpoints](/vision-ai/docs/warehouse-supported-regions) .\n- : Your Google Cloud [project number](/resource-manager/docs/creating-managing-projects#identifying_projects) .\n- : The [region](/about/locations) where you are using Vertex AI Vision. For example:`us-central1`,`europe-west4`. See [available regions](/vision-ai/docs/warehouse-supported-regions) .\n- : The ID of your target corpus.\nHTTP method and URL:\n```\nPOST https://warehouse-visionai.googleapis.com/v1/projects/PROJECT_NUMBER/locations/LOCATION_ID/corpora/CORPUS_ID:searchAssets\n```\nRequest JSON body:\n```\n{\n \"page_size\": \"2\",\n \"search_query': \"Pennsylvania\"\n}\n```\nTo send your request, choose one of these options:\n **Note:** The following command assumes that you have logged in to  the`gcloud`CLI with your user account by running [gcloud init](/sdk/gcloud/reference/init) or [gcloud auth login](/sdk/gcloud/reference/auth/login) ,  or by using [Cloud Shell](/shell/docs) ,  which automatically logs you into the`gcloud`CLI.  You can check the currently active account by running [gcloud auth list](/sdk/gcloud/reference/auth/list) .\nSave the request body in a file named `request.json` ,  and execute the following command:\n```\ncurl -X POST \\ -H \"Authorization: Bearer $(gcloud auth print-access-token)\" \\ -H \"Content-Type: application/json; charset=utf-8\" \\ -d @request.json \\ \"https://warehouse-visionai.googleapis.com/v1/projects/PROJECT_NUMBER/locations/LOCATION_ID/corpora/CORPUS_ID:searchAssets\"\n``` **Note:** The following command assumes that you have logged in to  the`gcloud`CLI with your user account by running [gcloud init](/sdk/gcloud/reference/init) or [gcloud auth login](/sdk/gcloud/reference/auth/login) ,  or by using [Cloud Shell](/shell/docs) ,  which automatically logs you into the`gcloud`CLI.  You can check the currently active account by running [gcloud auth list](/sdk/gcloud/reference/auth/list) .\nSave the request body in a file named `request.json` ,  and execute the following command:\n```\n$cred = gcloud auth print-access-token$headers = @{ \"Authorization\" = \"Bearer $cred\" }Invoke-WebRequest ` -Method POST ` -Headers $headers ` -ContentType: \"application/json; charset=utf-8\" ` -InFile request.json ` -Uri \"https://warehouse-visionai.googleapis.com/v1/projects/PROJECT_NUMBER/locations/LOCATION_ID/corpora/CORPUS_ID:searchAssets\" | Select-Object -Expand Content\n```\nYou should receive a JSON response similar to the following:### Apply sort spec to order returned-asset metadata in search\nYou can use the sorting feature to sort search results by user provided `annotation` . This can be useful for sorting results with data schema types that can be ordered, such as string and numeric types.\nTo use this feature, specify `schema_key_sorting_strategy` , which requires at least a data schema key and ascending/descending order:\nBefore using any of the request data, make the following replacements:- : Endpoint might include a prefix matching the`LOCATION_ID`such as`europe-west4-`. See more about [ regionalized endpoints](/vision-ai/docs/warehouse-supported-regions) .\n- : Your Google Cloud [project number](/resource-manager/docs/creating-managing-projects#identifying_projects) .\n- : The [region](/about/locations) where you are using Vertex AI Vision. For example:`us-central1`,`europe-west4`. See [available regions](/vision-ai/docs/warehouse-supported-regions) .\n- : The ID of your target corpus.\nHTTP method and URL:\n```\nPOST https://warehouse-visionai.googleapis.com/v1/projects/PROJECT_NUMBER/locations/LOCATION_ID/corpora/CORPUS_ID:searchAssets\n```\nRequest JSON body:\n```\n{\n \"page_size\": \"2\",\n \"schemaKeySortingStrategy\":\n { \"options\": \n  { \n  \"data_schema_key\": \"stream-display-name\", \n  \"sort_decreasing\": true\n  } \n }\n}\n```\nTo send your request, choose one of these options:\n **Note:** The following command assumes that you have logged in to  the`gcloud`CLI with your user account by running [gcloud init](/sdk/gcloud/reference/init) or [gcloud auth login](/sdk/gcloud/reference/auth/login) ,  or by using [Cloud Shell](/shell/docs) ,  which automatically logs you into the`gcloud`CLI.  You can check the currently active account by running [gcloud auth list](/sdk/gcloud/reference/auth/list) .\nSave the request body in a file named `request.json` ,  and execute the following command:\n```\ncurl -X POST \\ -H \"Authorization: Bearer $(gcloud auth print-access-token)\" \\ -H \"Content-Type: application/json; charset=utf-8\" \\ -d @request.json \\ \"https://warehouse-visionai.googleapis.com/v1/projects/PROJECT_NUMBER/locations/LOCATION_ID/corpora/CORPUS_ID:searchAssets\"\n``` **Note:** The following command assumes that you have logged in to  the`gcloud`CLI with your user account by running [gcloud init](/sdk/gcloud/reference/init) or [gcloud auth login](/sdk/gcloud/reference/auth/login) ,  or by using [Cloud Shell](/shell/docs) ,  which automatically logs you into the`gcloud`CLI.  You can check the currently active account by running [gcloud auth list](/sdk/gcloud/reference/auth/list) .\nSave the request body in a file named `request.json` ,  and execute the following command:\n```\n$cred = gcloud auth print-access-token$headers = @{ \"Authorization\" = \"Bearer $cred\" }Invoke-WebRequest ` -Method POST ` -Headers $headers ` -ContentType: \"application/json; charset=utf-8\" ` -InFile request.json ` -Uri \"https://warehouse-visionai.googleapis.com/v1/projects/PROJECT_NUMBER/locations/LOCATION_ID/corpora/CORPUS_ID:searchAssets\" | Select-Object -Expand Content\n```\nYou should receive a successful status code (2xx) and an empty response.\n## Create search configurations\nVision Warehouse allows users to customize their search experience through search configuration. Search Configuration uses video data - such as user-provided annotations and insights generated by Google Cloud video understanding models - to provide additional search options to the user. For example, if you want to target clips with specific color vehicles from car video data in your warehouse, you can use a specific search configuration for your query.\nYou can use a [SearchConfig](/vision-ai/docs/reference/rest/v1/projects.locations.corpora.searchConfigs) to set more granular configuration options.\nThe following example shows you how to create a [SearchConfig](/vision-ai/docs/reference/rest/v1/projects.locations.corpora.searchConfigs) resource.\n### General guidelines\nFor all use cases your request must meet the following conditions to execute successfully:\n- `Request.search_configuration.name`must not already exist.\n- The [mapped_fields](/vision-ai/docs/reference/rest/v1/projects.locations.corpora.searchConfigs#searchcriteriaproperty) array must not be empty, and must map touser-given annotation keys.\n- All`mapped_fields`must be of the same type.\n- All`mapped_fields`must share exact/smart match config.\n- All`mapped_fields`must share the same granularity.\nThere are several use cases for creating a `SearchConfig` , each with distinct guidelines you must follow.\n### Create a search config with custom search criteria\nThis section describes how to map a custom operator to one or more user-given annotation keys. In this case you need to satisfy the general guidelines when building your request.\nYou must specify your new `SearchConfig` ID at the end of the request URL, as a field in the request.\nThe user-given annotation keys in this example are `\"player\"` , `\"coach\"` , and `\"cheerleader\"` .\nBefore using any of the request data, make the following replacements:- : Endpoint might include a prefix matching the`LOCATION_ID`such as`europe-west4-`. See more about [ regionalized endpoints](/vision-ai/docs/warehouse-supported-regions) .\n- : Your Google Cloud [project number](/resource-manager/docs/creating-managing-projects#identifying_projects) .\n- : The [region](/about/locations) where you are using Vertex AI Vision. For example:`us-central1`,`europe-west4`. See [available regions](/vision-ai/docs/warehouse-supported-regions) .\n- : The ID of your target corpus.\n- : The name of your target`SearchConfig`.\n- The`SearchConfig`in this example is`person`.\nHTTP method and URL:\n```\nPOST https://warehouse-visionai.googleapis.com/v1/projects/PROJECT_NUMBER/locations/LOCATION_ID/corpora/CORPUS_ID/searchConfigs?search_config_id=person\n```\nRequest JSON body:\n```\n{\n \"search_criteria_property\": {\n  \"mapped_fields\": \"player\",\n  \"mapped_fields\": \"coach\",\n  \"mapped_fields\": \"cheerleader\",\n }\n}\n```\nTo send your request, choose one of these options:\n **Note:** The following command assumes that you have logged in to  the`gcloud`CLI with your user account by running [gcloud init](/sdk/gcloud/reference/init) or [gcloud auth login](/sdk/gcloud/reference/auth/login) ,  or by using [Cloud Shell](/shell/docs) ,  which automatically logs you into the`gcloud`CLI.  You can check the currently active account by running [gcloud auth list](/sdk/gcloud/reference/auth/list) .\nSave the request body in a file named `request.json` ,  and execute the following command:\n```\ncurl -X POST \\ -H \"Authorization: Bearer $(gcloud auth print-access-token)\" \\ -H \"Content-Type: application/json; charset=utf-8\" \\ -d @request.json \\ \"https://warehouse-visionai.googleapis.com/v1/projects/PROJECT_NUMBER/locations/LOCATION_ID/corpora/CORPUS_ID/searchConfigs?search_config_id=person\"\n``` **Note:** The following command assumes that you have logged in to  the`gcloud`CLI with your user account by running [gcloud init](/sdk/gcloud/reference/init) or [gcloud auth login](/sdk/gcloud/reference/auth/login) ,  or by using [Cloud Shell](/shell/docs) ,  which automatically logs you into the`gcloud`CLI.  You can check the currently active account by running [gcloud auth list](/sdk/gcloud/reference/auth/list) .\nSave the request body in a file named `request.json` ,  and execute the following command:\n```\n$cred = gcloud auth print-access-token$headers = @{ \"Authorization\" = \"Bearer $cred\" }Invoke-WebRequest ` -Method POST ` -Headers $headers ` -ContentType: \"application/json; charset=utf-8\" ` -InFile request.json ` -Uri \"https://warehouse-visionai.googleapis.com/v1/projects/PROJECT_NUMBER/locations/LOCATION_ID/corpora/CORPUS_ID/searchConfigs?search_config_id=person\" | Select-Object -Expand Content\n```\nYou should receive a JSON response similar to the following:\n```\n{\n \"name\": \"projects/PROJECT_NUMBER/locations/LOCATION_ID/corpora/CORPUS_ID/searchConfigs/person\",\n \"searchCriteriaProperty\":\n {\n  \"mappedFields\": [  \"player\",\n  \"coach\",\n  \"cheerleader\"\n  ]\n }\n}\n```### Create a search config with 1:1 facet mapping\nTo create a facet for a single user-given annotation key, you must ensure that `Request.search_configuration.facet_property.mapped_fields` contains a single element. This element's value must be a user-given annotation key name.\n**Note:** If you want the user-given annotation key to display as a facet name, set `search_config_id==facet_property.mapped_fields[0]` .\nThe following example shows you how to create a facet mapping for the user-given annotation key `\"Location\"` .\nYou must specify your new `SearchConfig` ID at the end of the request URL, as a field in the request.\nIn this example, the request succeeds because the `search_config_id` ( `Location` ) in the request URL references an existing user-given annotation key, `mapped_fields` contains exactly one element with a value equal to `search_config_id` ( `Location` ).\nBefore using any of the request data, make the following replacements:- : Endpoint might include a prefix matching the`LOCATION_ID`such as`europe-west4-`. See more about [ regionalized endpoints](/vision-ai/docs/warehouse-supported-regions) .\n- : Your Google Cloud [project number](/resource-manager/docs/creating-managing-projects#identifying_projects) .\n- : The [region](/about/locations) where you are using Vertex AI Vision. For example:`us-central1`,`europe-west4`. See [available regions](/vision-ai/docs/warehouse-supported-regions) .\n- : The ID of your target corpus.\n- : The name of your target`SearchConfig`.\n- The`SearchConfig`in this example is`Location`.\nHTTP method and URL:\n```\nPOST https://warehouse-visionai.googleapis.com/v1/projects/PROJECT_NUMBER/locations/LOCATION_ID/corpora/CORPUS_ID/searchConfigs?search_config_id=Location\n```\nRequest JSON body:\n```\n{\n \"facet_property\": {\n  \"mapped_fields\": \"Location\",\n  \"display_name\": \"Location\",\n  \"result_size\": \"5\",\n  \"bucket_type\":\"FACET_BUCKET_TYPE_VALUE\"\n }\n}\n```\nTo send your request, choose one of these options:\n **Note:** The following command assumes that you have logged in to  the`gcloud`CLI with your user account by running [gcloud init](/sdk/gcloud/reference/init) or [gcloud auth login](/sdk/gcloud/reference/auth/login) ,  or by using [Cloud Shell](/shell/docs) ,  which automatically logs you into the`gcloud`CLI.  You can check the currently active account by running [gcloud auth list](/sdk/gcloud/reference/auth/list) .\nSave the request body in a file named `request.json` ,  and execute the following command:\n```\ncurl -X POST \\ -H \"Authorization: Bearer $(gcloud auth print-access-token)\" \\ -H \"Content-Type: application/json; charset=utf-8\" \\ -d @request.json \\ \"https://warehouse-visionai.googleapis.com/v1/projects/PROJECT_NUMBER/locations/LOCATION_ID/corpora/CORPUS_ID/searchConfigs?search_config_id=Location\"\n``` **Note:** The following command assumes that you have logged in to  the`gcloud`CLI with your user account by running [gcloud init](/sdk/gcloud/reference/init) or [gcloud auth login](/sdk/gcloud/reference/auth/login) ,  or by using [Cloud Shell](/shell/docs) ,  which automatically logs you into the`gcloud`CLI.  You can check the currently active account by running [gcloud auth list](/sdk/gcloud/reference/auth/list) .\nSave the request body in a file named `request.json` ,  and execute the following command:\n```\n$cred = gcloud auth print-access-token$headers = @{ \"Authorization\" = \"Bearer $cred\" }Invoke-WebRequest ` -Method POST ` -Headers $headers ` -ContentType: \"application/json; charset=utf-8\" ` -InFile request.json ` -Uri \"https://warehouse-visionai.googleapis.com/v1/projects/PROJECT_NUMBER/locations/LOCATION_ID/corpora/CORPUS_ID/searchConfigs?search_config_id=Location\" | Select-Object -Expand Content\n``````\n```\nThe following requests fail due to not meeting the necessary requirements.### Create a search config with a custom 1:1 or more facet mapping\nClients that want to create a mapping between a custom facet value and one or more user-given annotation keys must ensure that:\n- `Request.search_configuration`must contain a`SearchCriteriaProperty`such that [Request.search_configuration.search_criteria_property.mapped_fields](/vision-ai/docs/reference/rest/v1/projects.locations.corpora.searchConfigs#searchcriteriaproperty) contains the same elements as [Request.search_configuration.facet_property.mapped_fields](/vision-ai/docs/reference/rest/v1/projects.locations.corpora.searchConfigs#facetproperty) .\nYou must specify your new `SearchConfig` ID at the end of the request URL, as a field in the request.\nThe following example shows you how to create a facet mapping for the user-given annotation keys `\"City\"` and `\"State\"` .\nBefore using any of the request data, make the following replacements:- : Endpoint might include a prefix matching the`LOCATION_ID`such as`europe-west4-`. See more about [ regionalized endpoints](/vision-ai/docs/warehouse-supported-regions) .\n- : Your Google Cloud [project number](/resource-manager/docs/creating-managing-projects#identifying_projects) .\n- : The [region](/about/locations) where you are using Vertex AI Vision. For example:`us-central1`,`europe-west4`. See [available regions](/vision-ai/docs/warehouse-supported-regions) .\n- : The ID of your target corpus.\n- : The name of your target`SearchConfig`.\n- The`SearchConfig`in this example is`Location`.\nHTTP method and URL:\n```\nPOST https://warehouse-visionai.googleapis.com/v1/projects/PROJECT_NUMBER/locations/LOCATION_ID/corpora/CORPUS_ID/searchConfigs?search_config_id=Location\n```\nRequest JSON body:\n```\n{\n \"search_criteria_property\": {\n  \"mapped_fields\": \"City\",\n  \"mapped_fields\": \"State\",\n  \"mapped_fields\": \"Province\",\n }\n \"facet_property\": {\n  \"mapped_fields\": \"City\",\n  \"mapped_fields\": \"State\",\n  \"display_name\": \"Province\",\n  \"result_size\": \"5\",\n  \"bucket_type\":\"FACET_BUCKET_TYPE_VALUE\"\n }\n}\n```\nTo send your request, choose one of these options:\n **Note:** The following command assumes that you have logged in to  the`gcloud`CLI with your user account by running [gcloud init](/sdk/gcloud/reference/init) or [gcloud auth login](/sdk/gcloud/reference/auth/login) ,  or by using [Cloud Shell](/shell/docs) ,  which automatically logs you into the`gcloud`CLI.  You can check the currently active account by running [gcloud auth list](/sdk/gcloud/reference/auth/list) .\nSave the request body in a file named `request.json` ,  and execute the following command:\n```\ncurl -X POST \\ -H \"Authorization: Bearer $(gcloud auth print-access-token)\" \\ -H \"Content-Type: application/json; charset=utf-8\" \\ -d @request.json \\ \"https://warehouse-visionai.googleapis.com/v1/projects/PROJECT_NUMBER/locations/LOCATION_ID/corpora/CORPUS_ID/searchConfigs?search_config_id=Location\"\n``` **Note:** The following command assumes that you have logged in to  the`gcloud`CLI with your user account by running [gcloud init](/sdk/gcloud/reference/init) or [gcloud auth login](/sdk/gcloud/reference/auth/login) ,  or by using [Cloud Shell](/shell/docs) ,  which automatically logs you into the`gcloud`CLI.  You can check the currently active account by running [gcloud auth list](/sdk/gcloud/reference/auth/list) .\nSave the request body in a file named `request.json` ,  and execute the following command:\n```\n$cred = gcloud auth print-access-token$headers = @{ \"Authorization\" = \"Bearer $cred\" }Invoke-WebRequest ` -Method POST ` -Headers $headers ` -ContentType: \"application/json; charset=utf-8\" ` -InFile request.json ` -Uri \"https://warehouse-visionai.googleapis.com/v1/projects/PROJECT_NUMBER/locations/LOCATION_ID/corpora/CORPUS_ID/searchConfigs?search_config_id=Location\" | Select-Object -Expand Content\n``````\n```\nThe following requests fail due to not meeting the necessary requirements.### Create a search config with range based facets\nRange facets are similar to normal facets, but each facet bucket covers some continuous span. An additional configuration ( [range_facet_config](/vision-ai/docs/reference/rest/v1/projects.locations.corpora.searchConfigs#facetproperty) ) gives the system information about these facet bucket ranges.\nRange facets are available for:\n- Integers\n- Dates\nThere are three types of range facets:\n- Fixed range - Each bucket is the same size.\n- Custom range - Programmable bucket sizes. For example, logarithmic.\n- Date range - Fixed bucket granularities of`DAY`,`MONTH`, and`YEAR`. This only applies to date range facets.\nThe same [conditions](#general-guidelines) apply as singular facets, with some additional validation regarding the range specification.\nThe following example creates a fixed range facet spec for the field `inventory-count` , and results in the buckets: `[-inf, 0), [0, 10), [10, 20), [20, 30), [30, inf]` .\nYou must specify your new `SearchConfig` ID at the end of the request URL, as a field in the request.\nThis request uses the [FixedRangeBucketSpec](/vision-ai/docs/reference/rest/v1/projects.locations.corpora.searchConfigs#fixedrangebucketspec) to create multiple buckets with equal granularities.\nBefore using any of the request data, make the following replacements:- : Endpoint might include a prefix matching the`LOCATION_ID`such as`europe-west4-`. See more about [ regionalized endpoints](/vision-ai/docs/warehouse-supported-regions) .\n- : Your Google Cloud [project number](/resource-manager/docs/creating-managing-projects#identifying_projects) .\n- : The [region](/about/locations) where you are using Vertex AI Vision. For example:`us-central1`,`europe-west4`. See [available regions](/vision-ai/docs/warehouse-supported-regions) .\n- : The ID of your target corpus.\n- : The name of your target`SearchConfig`.\n- The`SearchConfig`in this example is`inventory-count`.\nHTTP method and URL:\n```\nPOST https://warehouse-visionai.googleapis.com/v1/projects/PROJECT_NUMBER/locations/LOCATION_ID/corpora/CORPUS_ID/searchConfigs?search_config_id=inventory-count\n```\nRequest JSON body:\n```\n{\n \"facet_property\": {\n \"mapped_fields\": \"inventory-count\",\n \"display_name\": \"Inventory Count\",\n \"result_size\": \"5\",\n \"bucket_type\":\"FACET_BUCKET_TYPE_FIXED_RANGE\",\n \"fixed_range_bucket_spec\": {\n  \"bucket_start\": {\n   \"integer_value\": 0\n  },\n  \"bucket_granularity\": {\n   \"integer_value\": 10\n  },\n  \"bucket_count\": 5\n }\n }\n}\n```\nTo send your request, choose one of these options:\n **Note:** The following command assumes that you have logged in to  the`gcloud`CLI with your user account by running [gcloud init](/sdk/gcloud/reference/init) or [gcloud auth login](/sdk/gcloud/reference/auth/login) ,  or by using [Cloud Shell](/shell/docs) ,  which automatically logs you into the`gcloud`CLI.  You can check the currently active account by running [gcloud auth list](/sdk/gcloud/reference/auth/list) .\nSave the request body in a file named `request.json` ,  and execute the following command:\n```\ncurl -X POST \\ -H \"Authorization: Bearer $(gcloud auth print-access-token)\" \\ -H \"Content-Type: application/json; charset=utf-8\" \\ -d @request.json \\ \"https://warehouse-visionai.googleapis.com/v1/projects/PROJECT_NUMBER/locations/LOCATION_ID/corpora/CORPUS_ID/searchConfigs?search_config_id=inventory-count\"\n``` **Note:** The following command assumes that you have logged in to  the`gcloud`CLI with your user account by running [gcloud init](/sdk/gcloud/reference/init) or [gcloud auth login](/sdk/gcloud/reference/auth/login) ,  or by using [Cloud Shell](/shell/docs) ,  which automatically logs you into the`gcloud`CLI.  You can check the currently active account by running [gcloud auth list](/sdk/gcloud/reference/auth/list) .\nSave the request body in a file named `request.json` ,  and execute the following command:\n```\n$cred = gcloud auth print-access-token$headers = @{ \"Authorization\" = \"Bearer $cred\" }Invoke-WebRequest ` -Method POST ` -Headers $headers ` -ContentType: \"application/json; charset=utf-8\" ` -InFile request.json ` -Uri \"https://warehouse-visionai.googleapis.com/v1/projects/PROJECT_NUMBER/locations/LOCATION_ID/corpora/CORPUS_ID/searchConfigs?search_config_id=inventory-count\" | Select-Object -Expand Content\n``````\n```\nThe following example creates a fixed range facet spec for the field `video-views` , and results in the buckets: `[inf, 0), [0, 10), [10, 100), [100, 1000), [1000, 10000), [10000, inf)` .\nYou must specify your new `SearchConfig` ID at the end of the request URL, as a field in the request.\nThis request uses the [CustomRangeBucketSpec](/vision-ai/docs/reference/rest/v1/projects.locations.corpora.searchConfigs#CustomRangeBucketSpec) to specify how values are bucketized.\nBefore using any of the request data, make the following replacements:- : Endpoint might include a prefix matching the`LOCATION_ID`such as`europe-west4-`. See more about [ regionalized endpoints](/vision-ai/docs/warehouse-supported-regions) .\n- : Your Google Cloud [project number](/resource-manager/docs/creating-managing-projects#identifying_projects) .\n- : The [region](/about/locations) where you are using Vertex AI Vision. For example:`us-central1`,`europe-west4`. See [available regions](/vision-ai/docs/warehouse-supported-regions) .\n- : The ID of your target corpus.\n- : The name of your target`SearchConfig`.\n- The`SearchConfig`in this example is`video-views`.\nHTTP method and URL:\n```\nPOST https://warehouse-visionai.googleapis.com/v1/projects/PROJECT_NUMBER/locations/LOCATION_ID/corpora/CORPUS_ID/searchConfigs?search_config_id=video-views\n```\nRequest JSON body:\n```\n{\n \"facet_property\": {\n \"mapped_fields\": \"video-views\",\n \"display_name\": \"Video Views\",\n \"result_size\": \"6\",\n \"bucket_type\":\"FACET_BUCKET_TYPE_CUSTOM_RANGE\",\n \"custom_range_bucket_spec\": {\n  \"endpoints\": {\n   \"integer_value\": 0\n  },\n  \"endpoints\": {\n   \"integer_value\": 10\n  },\n  \"endpoints\": {\n   \"integer_value\": 100\n  },\n  \"endpoints\": {\n   \"integer_value\": 1000\n  },\n  \"endpoints\": {\n   \"integer_value\": 10000\n  }\n }\n }\n}\n```\nTo send your request, choose one of these options:\n **Note:** The following command assumes that you have logged in to  the`gcloud`CLI with your user account by running [gcloud init](/sdk/gcloud/reference/init) or [gcloud auth login](/sdk/gcloud/reference/auth/login) ,  or by using [Cloud Shell](/shell/docs) ,  which automatically logs you into the`gcloud`CLI.  You can check the currently active account by running [gcloud auth list](/sdk/gcloud/reference/auth/list) .\nSave the request body in a file named `request.json` ,  and execute the following command:\n```\ncurl -X POST \\ -H \"Authorization: Bearer $(gcloud auth print-access-token)\" \\ -H \"Content-Type: application/json; charset=utf-8\" \\ -d @request.json \\ \"https://warehouse-visionai.googleapis.com/v1/projects/PROJECT_NUMBER/locations/LOCATION_ID/corpora/CORPUS_ID/searchConfigs?search_config_id=video-views\"\n``` **Note:** The following command assumes that you have logged in to  the`gcloud`CLI with your user account by running [gcloud init](/sdk/gcloud/reference/init) or [gcloud auth login](/sdk/gcloud/reference/auth/login) ,  or by using [Cloud Shell](/shell/docs) ,  which automatically logs you into the`gcloud`CLI.  You can check the currently active account by running [gcloud auth list](/sdk/gcloud/reference/auth/list) .\nSave the request body in a file named `request.json` ,  and execute the following command:\n```\n$cred = gcloud auth print-access-token$headers = @{ \"Authorization\" = \"Bearer $cred\" }Invoke-WebRequest ` -Method POST ` -Headers $headers ` -ContentType: \"application/json; charset=utf-8\" ` -InFile request.json ` -Uri \"https://warehouse-visionai.googleapis.com/v1/projects/PROJECT_NUMBER/locations/LOCATION_ID/corpora/CORPUS_ID/searchConfigs?search_config_id=video-views\" | Select-Object -Expand Content\n``````\n```\nThe following example creates a date range spec for the field `film-date` with `DAY` granularity.\nYou must specify your new `SearchConfig` ID at the end of the request URL, as a field in the request.\nThis request uses the [DateTimeBucketSpec](/vision-ai/docs/reference/rest/v1/projects.locations.corpora.searchConfigs#DateTimeBucketSpec) to specify how date values are bucketized.\nBefore using any of the request data, make the following replacements:- : Endpoint might include a prefix matching the`LOCATION_ID`such as`europe-west4-`. See more about [ regionalized endpoints](/vision-ai/docs/warehouse-supported-regions) .\n- : Your Google Cloud [project number](/resource-manager/docs/creating-managing-projects#identifying_projects) .\n- : The [region](/about/locations) where you are using Vertex AI Vision. For example:`us-central1`,`europe-west4`. See [available regions](/vision-ai/docs/warehouse-supported-regions) .\n- : The ID of your target corpus.\n- : The name of your target`SearchConfig`.\n- The`SearchConfig`in this example is`film-date`.\nHTTP method and URL:\n```\nPOST https://warehouse-visionai.googleapis.com/v1/projects/PROJECT_NUMBER/locations/LOCATION_ID/corpora/CORPUS_ID/searchConfigs?search_config_id=film-date\n```\nRequest JSON body:\n```\n{\n \"facet_property\": {\n \"mapped_fields\": \"film-date\",\n \"display_name\": \"Film Date\",\n \"result_size\": \"5\",\n \"bucket_type\": \"FACET_BUCKET_TYPE_DATETIME\",\n \"datetime_bucket_spec\": {\n  \"granularity\": \"DAY\"\n }\n }\n}\n```\nTo send your request, choose one of these options:\n **Note:** The following command assumes that you have logged in to  the`gcloud`CLI with your user account by running [gcloud init](/sdk/gcloud/reference/init) or [gcloud auth login](/sdk/gcloud/reference/auth/login) ,  or by using [Cloud Shell](/shell/docs) ,  which automatically logs you into the`gcloud`CLI.  You can check the currently active account by running [gcloud auth list](/sdk/gcloud/reference/auth/list) .\nSave the request body in a file named `request.json` ,  and execute the following command:\n```\ncurl -X POST \\ -H \"Authorization: Bearer $(gcloud auth print-access-token)\" \\ -H \"Content-Type: application/json; charset=utf-8\" \\ -d @request.json \\ \"https://warehouse-visionai.googleapis.com/v1/projects/PROJECT_NUMBER/locations/LOCATION_ID/corpora/CORPUS_ID/searchConfigs?search_config_id=film-date\"\n``` **Note:** The following command assumes that you have logged in to  the`gcloud`CLI with your user account by running [gcloud init](/sdk/gcloud/reference/init) or [gcloud auth login](/sdk/gcloud/reference/auth/login) ,  or by using [Cloud Shell](/shell/docs) ,  which automatically logs you into the`gcloud`CLI.  You can check the currently active account by running [gcloud auth list](/sdk/gcloud/reference/auth/list) .\nSave the request body in a file named `request.json` ,  and execute the following command:\n```\n$cred = gcloud auth print-access-token$headers = @{ \"Authorization\" = \"Bearer $cred\" }Invoke-WebRequest ` -Method POST ` -Headers $headers ` -ContentType: \"application/json; charset=utf-8\" ` -InFile request.json ` -Uri \"https://warehouse-visionai.googleapis.com/v1/projects/PROJECT_NUMBER/locations/LOCATION_ID/corpora/CORPUS_ID/searchConfigs?search_config_id=film-date\" | Select-Object -Expand Content\n``````\n```\nAfter you create these facet buckets you can use them to search the warehouse.\nThis request uses [facetSelections](/vision-ai/docs/reference/rest/v1/projects.locations.corpora/searchAssets#FacetGroup) objects to specify a group of facet buckets.\nBefore using any of the request data, make the following replacements:- : Endpoint might include a prefix matching the`LOCATION_ID`such as`europe-west4-`. See more about [ regionalized endpoints](/vision-ai/docs/warehouse-supported-regions) .\n- : Your Google Cloud [project number](/resource-manager/docs/creating-managing-projects#identifying_projects) .\n- : The [region](/about/locations) where you are using Vertex AI Vision. For example:`us-central1`,`europe-west4`. See [available regions](/vision-ai/docs/warehouse-supported-regions) .\n- : The ID of your target corpus.\nHTTP method and URL:\n```\nPOST https://warehouse-visionai.googleapis.com/v1/projects/PROJECT_NUMBER/locations/LOCATION_ID/corpora/CORPUS_ID:searchAssets\n```\nRequest JSON body:\n```\n{\n \"page_size\": \"10\",\n \"facet_selections\": {\n  \"facet_id\": \"inventory-count\",\n  \"buckets\": {\n  \"range\": {\n   \"end\" : {\n   \"integer_value\": 0\n   }\n  }\n  },\n  \"buckets\": {\n  \"range\": {\n   \"start\" : {\n   \"integer_value\": 20\n   },\n   \"end\" : {\n   \"integer_value\": 30\n   }\n  }\n  }\n },\n \"facet_selections\": {\n  \"facet_id\": \"video-views\",\n  \"buckets\": {\n  \"range\": {\n   \"start\" : {\n   \"integer_value\": 100\n   },\n   \"end\" : {\n   \"integer_value\": 1000\n   }\n  }\n  }\n },\n \"facet_selections\": {\n  \"facet_id\": \"film-date\",\n  \"buckets\": {\n  \"range\": {\n   \"start\" : {\n   \"datetime_value\": {\n    \"year\": 2022,\n    \"month\": 9,\n    \"day\": 10\n   }\n   },\n   \"end\" : {\n   \"datetime_value\": {\n    \"year\": 2022,\n    \"month\": 9,\n    \"day\": 11\n   }\n   }\n  }\n  }\n }\n}\n```\nTo send your request, choose one of these options:\n **Note:** The following command assumes that you have logged in to  the`gcloud`CLI with your user account by running [gcloud init](/sdk/gcloud/reference/init) or [gcloud auth login](/sdk/gcloud/reference/auth/login) ,  or by using [Cloud Shell](/shell/docs) ,  which automatically logs you into the`gcloud`CLI.  You can check the currently active account by running [gcloud auth list](/sdk/gcloud/reference/auth/list) .\nSave the request body in a file named `request.json` ,  and execute the following command:\n```\ncurl -X POST \\ -H \"Authorization: Bearer $(gcloud auth print-access-token)\" \\ -H \"Content-Type: application/json; charset=utf-8\" \\ -d @request.json \\ \"https://warehouse-visionai.googleapis.com/v1/projects/PROJECT_NUMBER/locations/LOCATION_ID/corpora/CORPUS_ID:searchAssets\"\n``` **Note:** The following command assumes that you have logged in to  the`gcloud`CLI with your user account by running [gcloud init](/sdk/gcloud/reference/init) or [gcloud auth login](/sdk/gcloud/reference/auth/login) ,  or by using [Cloud Shell](/shell/docs) ,  which automatically logs you into the`gcloud`CLI.  You can check the currently active account by running [gcloud auth list](/sdk/gcloud/reference/auth/list) .\nSave the request body in a file named `request.json` ,  and execute the following command:\n```\n$cred = gcloud auth print-access-token$headers = @{ \"Authorization\" = \"Bearer $cred\" }Invoke-WebRequest ` -Method POST ` -Headers $headers ` -ContentType: \"application/json; charset=utf-8\" ` -InFile request.json ` -Uri \"https://warehouse-visionai.googleapis.com/v1/projects/PROJECT_NUMBER/locations/LOCATION_ID/corpora/CORPUS_ID:searchAssets\" | Select-Object -Expand Content\n``````\n```\n## Update a search configuration\nTo update the current `SearchConfig` , your request must fulfill the following requirements:\n- [Request.searchConfig.name](/vision-ai/docs/reference/rest/v1/projects.locations.corpora.searchConfigs#resource:-searchconfig) must already exist.\n- Request must contain at least one non-empty [searchCriteriaProperty](/vision-ai/docs/reference/rest/v1/projects.locations.corpora.searchConfigs#searchcriteriaproperty) or [facetProperty](/vision-ai/docs/reference/rest/v1/projects.locations.corpora.searchConfigs#facetproperty) .\n- The`mappedFields`array must not be empty, and must map to existing user-given annotation keys.\n- All`mappedFields`must be of the same type.\n- All`mappedFields`must share the same granularity.\n- All`mappedFields`must share the same semantic`SearchConfig`match options.\nThe following code sample updates a warehouse search configuration resource using the [projects.locations.corpora.searchConfigs.patch](/vision-ai/docs/reference/rest/v1/projects.locations.corpora.searchConfigs/patch) method.\nBefore using any of the request data, make the following replacements:- : Endpoint might include a prefix matching the`LOCATION_ID`such as`europe-west4-`. See more about [ regionalized endpoints](/vision-ai/docs/warehouse-supported-regions) .\n- : Your Google Cloud [project ID or project number](/resource-manager/docs/creating-managing-projects#identifying_projects) .\n- : The [region](/about/locations) where you are using Vertex AI Vision. For example:`us-central1`,`europe-west4`. See [available regions](/vision-ai/docs/warehouse-supported-regions) .\n- : The ID of your target corpus.\n- : The ID of your target`SearchConfig`.\n- `\"mappedFields\"`: One or more existing user-given annotation keys.\nHTTP method and URL:\n```\nPATCH https://warehouse-visionai.googleapis.com/v1/projects/PROJECT_NUMBER/locations/LOCATION_ID/corpora/CORPUS_ID/searchConfigs/SEARCHCONFIG_ID\n```\nRequest JSON body:\n```\n{\n \"name\": \"projects/PROJECT_NUMBER/locations/LOCATION_ID/corpora/CORPUS_ID/searchConfigs/SEARCHCONFIG_ID1\",\n \"searchCriteriaProperty\": {\n \"mappedFields\": \"dataschema2\"\n }\n}\n```\nTo send your request, choose one of these options:\n **Note:** The following command assumes that you have logged in to  the`gcloud`CLI with your user account by running [gcloud init](/sdk/gcloud/reference/init) or [gcloud auth login](/sdk/gcloud/reference/auth/login) ,  or by using [Cloud Shell](/shell/docs) ,  which automatically logs you into the`gcloud`CLI.  You can check the currently active account by running [gcloud auth list](/sdk/gcloud/reference/auth/list) .\nSave the request body in a file named `request.json` ,  and execute the following command:\n```\ncurl -X PATCH \\ -H \"Authorization: Bearer $(gcloud auth print-access-token)\" \\ -H \"Content-Type: application/json; charset=utf-8\" \\ -d @request.json \\ \"https://warehouse-visionai.googleapis.com/v1/projects/PROJECT_NUMBER/locations/LOCATION_ID/corpora/CORPUS_ID/searchConfigs/SEARCHCONFIG_ID\"\n``` **Note:** The following command assumes that you have logged in to  the`gcloud`CLI with your user account by running [gcloud init](/sdk/gcloud/reference/init) or [gcloud auth login](/sdk/gcloud/reference/auth/login) ,  or by using [Cloud Shell](/shell/docs) ,  which automatically logs you into the`gcloud`CLI.  You can check the currently active account by running [gcloud auth list](/sdk/gcloud/reference/auth/list) .\nSave the request body in a file named `request.json` ,  and execute the following command:\n```\n$cred = gcloud auth print-access-token$headers = @{ \"Authorization\" = \"Bearer $cred\" }Invoke-WebRequest ` -Method PATCH ` -Headers $headers ` -ContentType: \"application/json; charset=utf-8\" ` -InFile request.json ` -Uri \"https://warehouse-visionai.googleapis.com/v1/projects/PROJECT_NUMBER/locations/LOCATION_ID/corpora/CORPUS_ID/searchConfigs/SEARCHCONFIG_ID\" | Select-Object -Expand Content\n```\nYou should receive a JSON response similar to the following:\n```\n{\n \"name\": \"projects/PROJECT_NUMBER/locations/LOCATION_ID/corpora/CORPUS_ID/searchConfigs/SEARCHCONFIG_ID1\",\n \"searchCriteriaProperty\": {\n \"mappedFields\": [  \"dataschema2\"\n ]\n }\n}\n```", "guide": "Vertex AI Vision"}