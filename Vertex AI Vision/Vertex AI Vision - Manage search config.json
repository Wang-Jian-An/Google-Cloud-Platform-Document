{"title": "Vertex AI Vision - Manage search config", "url": "https://cloud.google.com/vision-ai/docs/manage-searchconfig-api?hl=zh-cn", "abstract": "# Vertex AI Vision - Manage search config\n", "content": "## Restriction\nIf there is a facet property in search config, its mapped fields should always match those in search criteria property. These fields should be the existing data schema with the same type, granularity, and search strategy.\n## Create a search config\nTo create a `SearchConfig` resource, send a POST request by using the [projects.locations.corpora.searchConfigs.create](/vision-ai/docs/reference/rest/v1/projects.locations.corpora.searchConfigs/create) method.Here is the example of how to create a search config with customized search criteria.\nBefore using any of the request data, make the following replacements:- : Endpoint might include a prefix matching the`LOCATION_ID`such as`europe-west4-`. See more about [ regionalized endpoints](/vision-ai/docs/warehouse-supported-regions) .\n- : Your Google Cloud [project number](/resource-manager/docs/creating-managing-projects#identifying_projects) .\n- : The [region](/about/locations) where you are using Vertex AI Vision. For example:`us-central1`,`europe-west4`. See [available regions](/vision-ai/docs/warehouse-supported-regions) .\n- : The ID of your target corpus.\n- : The name of your target`SearchConfig`.\n- The`SearchConfig`in this example is`person`.\nHTTP method and URL:\n```\nPOST https://warehouse-visionai.googleapis.com/v1/projects/PROJECT_NUMBER/locations/LOCATION_ID/corpora/CORPUS_ID/searchConfigs?search_config_id=person\n```\nRequest JSON body:\n```\n{\n \"search_criteria_property\": {\n  \"mapped_fields\": \"player\",\n  \"mapped_fields\": \"coach\",\n  \"mapped_fields\": \"cheerleader\",\n }\n}\n```\nTo send your request, choose one of these options:\n **Note:** The following command assumes that you have logged in to  the`gcloud`CLI with your user account by running [gcloud init](/sdk/gcloud/reference/init) or [gcloud auth login](/sdk/gcloud/reference/auth/login) ,  or by using [Cloud Shell](/shell/docs) ,  which automatically logs you into the`gcloud`CLI.  You can check the currently active account by running [gcloud auth list](/sdk/gcloud/reference/auth/list) .\nSave the request body in a file named `request.json` ,  and execute the following command:\n```\ncurl -X POST \\ -H \"Authorization: Bearer $(gcloud auth print-access-token)\" \\ -H \"Content-Type: application/json; charset=utf-8\" \\ -d @request.json \\ \"https://warehouse-visionai.googleapis.com/v1/projects/PROJECT_NUMBER/locations/LOCATION_ID/corpora/CORPUS_ID/searchConfigs?search_config_id=person\"\n``` **Note:** The following command assumes that you have logged in to  the`gcloud`CLI with your user account by running [gcloud init](/sdk/gcloud/reference/init) or [gcloud auth login](/sdk/gcloud/reference/auth/login) ,  or by using [Cloud Shell](/shell/docs) ,  which automatically logs you into the`gcloud`CLI.  You can check the currently active account by running [gcloud auth list](/sdk/gcloud/reference/auth/list) .\nSave the request body in a file named `request.json` ,  and execute the following command:\n```\n$cred = gcloud auth print-access-token$headers = @{ \"Authorization\" = \"Bearer $cred\" }Invoke-WebRequest ` -Method POST ` -Headers $headers ` -ContentType: \"application/json; charset=utf-8\" ` -InFile request.json ` -Uri \"https://warehouse-visionai.googleapis.com/v1/projects/PROJECT_NUMBER/locations/LOCATION_ID/corpora/CORPUS_ID/searchConfigs?search_config_id=person\" | Select-Object -Expand Content\n```\nYou should receive a JSON response similar to the following:\n```\n{\n \"name\": \"projects/PROJECT_NUMBER/locations/LOCATION_ID/corpora/CORPUS_ID/searchConfigs/person\",\n \"searchCriteriaProperty\":\n {\n  \"mappedFields\": [  \"player\",\n  \"coach\",\n  \"cheerleader\"\n  ]\n }\n}\n```\n## Update a search config\nTo update a `SearchConfig` resource, send a POST request by using the [projects.locations.corpora.searchConfigs.patch](/vision-ai/docs/reference/rest/v1/projects.locations.corpora.searchConfigs/patch) method.Here is the example of how to create a search config with customized search criteria.\nBefore using any of the request data, make the following replacements:- : Endpoint might include a prefix matching the`LOCATION_ID`such as`europe-west4-`. See more about [ regionalized endpoints](/vision-ai/docs/warehouse-supported-regions) .\n- : Your Google Cloud [project ID or project number](/resource-manager/docs/creating-managing-projects#identifying_projects) .\n- : The [region](/about/locations) where you are using Vertex AI Vision. For example:`us-central1`,`europe-west4`. See [available regions](/vision-ai/docs/warehouse-supported-regions) .\n- : The ID of your target corpus.\n- : The ID of your target`SearchConfig`.\n- `\"mappedFields\"`: One or more existing user-given annotation keys.\nHTTP method and URL:\n```\nPATCH https://warehouse-visionai.googleapis.com/v1/projects/PROJECT_NUMBER/locations/LOCATION_ID/corpora/CORPUS_ID/searchConfigs/SEARCHCONFIG_ID\n```\nRequest JSON body:\n```\n{\n \"name\": \"projects/PROJECT_NUMBER/locations/LOCATION_ID/corpora/CORPUS_ID/searchConfigs/SEARCHCONFIG_ID1\",\n \"searchCriteriaProperty\": {\n \"mappedFields\": \"dataschema2\"\n }\n}\n```\nTo send your request, choose one of these options:\n **Note:** The following command assumes that you have logged in to  the`gcloud`CLI with your user account by running [gcloud init](/sdk/gcloud/reference/init) or [gcloud auth login](/sdk/gcloud/reference/auth/login) ,  or by using [Cloud Shell](/shell/docs) ,  which automatically logs you into the`gcloud`CLI.  You can check the currently active account by running [gcloud auth list](/sdk/gcloud/reference/auth/list) .\nSave the request body in a file named `request.json` ,  and execute the following command:\n```\ncurl -X PATCH \\ -H \"Authorization: Bearer $(gcloud auth print-access-token)\" \\ -H \"Content-Type: application/json; charset=utf-8\" \\ -d @request.json \\ \"https://warehouse-visionai.googleapis.com/v1/projects/PROJECT_NUMBER/locations/LOCATION_ID/corpora/CORPUS_ID/searchConfigs/SEARCHCONFIG_ID\"\n``` **Note:** The following command assumes that you have logged in to  the`gcloud`CLI with your user account by running [gcloud init](/sdk/gcloud/reference/init) or [gcloud auth login](/sdk/gcloud/reference/auth/login) ,  or by using [Cloud Shell](/shell/docs) ,  which automatically logs you into the`gcloud`CLI.  You can check the currently active account by running [gcloud auth list](/sdk/gcloud/reference/auth/list) .\nSave the request body in a file named `request.json` ,  and execute the following command:\n```\n$cred = gcloud auth print-access-token$headers = @{ \"Authorization\" = \"Bearer $cred\" }Invoke-WebRequest ` -Method PATCH ` -Headers $headers ` -ContentType: \"application/json; charset=utf-8\" ` -InFile request.json ` -Uri \"https://warehouse-visionai.googleapis.com/v1/projects/PROJECT_NUMBER/locations/LOCATION_ID/corpora/CORPUS_ID/searchConfigs/SEARCHCONFIG_ID\" | Select-Object -Expand Content\n```\nYou should receive a JSON response similar to the following:\n```\n{\n \"name\": \"projects/PROJECT_NUMBER/locations/LOCATION_ID/corpora/CORPUS_ID/searchConfigs/SEARCHCONFIG_ID1\",\n \"searchCriteriaProperty\": {\n \"mappedFields\": [  \"dataschema2\"\n ]\n }\n}\n```\n## Get a search config\nThe following example shows you how to retrieve an existing `SearchConfig` that makes it easier to search for people in warehouse-stored data.\nTo get details about a `SearchConfig` , send a GET request by using the [projects.locations.corpora.searchConfigs.get](/vision-ai/docs/reference/rest/v1/projects.locations.corpora.searchConfigs/get) method.Before using any of the request data, make the following replacements:- : Endpoint might include a prefix matching the`LOCATION_ID`such as`europe-west4-`. See more about [ regionalized endpoints](/vision-ai/docs/warehouse-supported-regions) .\n- : Your Google Cloud [project number](/resource-manager/docs/creating-managing-projects#identifying_projects) .\n- : The [region](/about/locations) where you are using Vertex AI Vision. For example:`us-central1`,`europe-west4`. See [available regions](/vision-ai/docs/warehouse-supported-regions) .\n- : The ID of your target corpus.\n- : The name of your target`SearchConfig`.\n- The`SearchConfig`in this example is`person`.\nHTTP method and URL:\n```\nGET https://warehouse-visionai.googleapis.com/v1/projects/PROJECT_NUMBER/locations/LOCATION_ID/corpora/CORPUS_ID/searchConfigs/SEARCHCONFIG\n```\nTo send your request, choose one of these options:\n **Note:** The following command assumes that you have logged in to  the`gcloud`CLI with your user account by running [gcloud init](/sdk/gcloud/reference/init) or [gcloud auth login](/sdk/gcloud/reference/auth/login) ,  or by using [Cloud Shell](/shell/docs) ,  which automatically logs you into the`gcloud`CLI.  You can check the currently active account by running [gcloud auth list](/sdk/gcloud/reference/auth/list) .\nExecute the following command:\n```\ncurl -X GET \\ -H \"Authorization: Bearer $(gcloud auth print-access-token)\" \\ \"https://warehouse-visionai.googleapis.com/v1/projects/PROJECT_NUMBER/locations/LOCATION_ID/corpora/CORPUS_ID/searchConfigs/SEARCHCONFIG\"\n``` **Note:** The following command assumes that you have logged in to  the`gcloud`CLI with your user account by running [gcloud init](/sdk/gcloud/reference/init) or [gcloud auth login](/sdk/gcloud/reference/auth/login) ,  or by using [Cloud Shell](/shell/docs) ,  which automatically logs you into the`gcloud`CLI.  You can check the currently active account by running [gcloud auth list](/sdk/gcloud/reference/auth/list) .\nExecute the following command:\n```\n$cred = gcloud auth print-access-token$headers = @{ \"Authorization\" = \"Bearer $cred\" }Invoke-WebRequest ` -Method GET ` -Headers $headers ` -Uri \"https://warehouse-visionai.googleapis.com/v1/projects/PROJECT_NUMBER/locations/LOCATION_ID/corpora/CORPUS_ID/searchConfigs/SEARCHCONFIG\" | Select-Object -Expand Content\n```\nYou should receive a JSON response similar to the following:\n```\n{\n \"name\": \"projects/PROJECT_NUMBER/locations/LOCATION_ID/corpora/CORPUS_ID/searchConfigs/person\"\n \"facet_property\": {\n // Top-level facet group name.\n \"display_name\": \"Person\",\n // Each mapped_field will be displayed in the UI as a selectable value\n // under \"Person\".\n \"mapped_fields\": \"player\",\n // The maximum number of mapped_fields to be displayed.\n \"result_size\": 2,\n // The facet type is a singular value. In this case, type string.\n \"bucket_type\": FACET_BUCKET_TYPE_VALUE\n }\n}\n```\n## List search configs\nThe following example shows you how to list all previously created [SearchConfig](/vision-ai/docs/reference/rest/v1/projects.locations.corpora.searchConfigs) resources.\nYou can specify the number of search configs listed by setting the `page_size` field in your request.\nTo list all search configs, send a GET request by using the [projects.locations.corpora.searchConfigs.list](/vision-ai/docs/reference/rest/v1/projects.locations.corpora.searchConfigs/list) method.In this example, the `page_size` field is set to 2, limiting the response to two search configs. If the page size is not specified, the default value of 25 is used.Before using any of the request data, make the following replacements:- : Endpoint might include a prefix matching the`LOCATION_ID`such as`europe-west4-`. See more about [ regionalized endpoints](/vision-ai/docs/warehouse-supported-regions) .\n- : Your Google Cloud [project number](/resource-manager/docs/creating-managing-projects#identifying_projects) .\n- : The [region](/about/locations) where you are using Vertex AI Vision. For example:`us-central1`,`europe-west4`. See [available regions](/vision-ai/docs/warehouse-supported-regions) .\n- : The ID of your target corpus.\n- : () The number of results to return.\nHTTP method and URL:\n```\nGET https://warehouse-visionai.googleapis.com/v1/projects/PROJECT_NUMBER/locations/LOCATION_ID/corpora/CORPUS_ID/searchConfigs?page_size=2\n```\nTo send your request, choose one of these options:\n **Note:** The following command assumes that you have logged in to  the`gcloud`CLI with your user account by running [gcloud init](/sdk/gcloud/reference/init) or [gcloud auth login](/sdk/gcloud/reference/auth/login) ,  or by using [Cloud Shell](/shell/docs) ,  which automatically logs you into the`gcloud`CLI.  You can check the currently active account by running [gcloud auth list](/sdk/gcloud/reference/auth/list) .\nExecute the following command:\n```\ncurl -X GET \\ -H \"Authorization: Bearer $(gcloud auth print-access-token)\" \\ \"https://warehouse-visionai.googleapis.com/v1/projects/PROJECT_NUMBER/locations/LOCATION_ID/corpora/CORPUS_ID/searchConfigs?page_size=2\"\n``` **Note:** The following command assumes that you have logged in to  the`gcloud`CLI with your user account by running [gcloud init](/sdk/gcloud/reference/init) or [gcloud auth login](/sdk/gcloud/reference/auth/login) ,  or by using [Cloud Shell](/shell/docs) ,  which automatically logs you into the`gcloud`CLI.  You can check the currently active account by running [gcloud auth list](/sdk/gcloud/reference/auth/list) .\nExecute the following command:\n```\n$cred = gcloud auth print-access-token$headers = @{ \"Authorization\" = \"Bearer $cred\" }Invoke-WebRequest ` -Method GET ` -Headers $headers ` -Uri \"https://warehouse-visionai.googleapis.com/v1/projects/PROJECT_NUMBER/locations/LOCATION_ID/corpora/CORPUS_ID/searchConfigs?page_size=2\" | Select-Object -Expand Content\n```\nYou should receive a JSON response similar to the following:\n```\n{\n \"next_page_token\": \"xyz\",\n \"search_configs\": {\n \"name\": \"projects/PROJECT_NUMBER/locations/LOCATION_ID/corpora/CORPUS_ID/searchConfigs/person\",\n \"facet_property\": {\n  // Top-level facet group name.\n  \"display_name\": \"Person\",\n  // Each mapped_field will be displayed in the console as a selectable value\n  // under \"Person\".\n  \"mapped_fields\": \"player\",\n  // The maximum number of mapped_fields to be displayed.\n  \"result_size\": 2,\n  // The facet type is a singular value. In this case, type string.\n  \"bucket_type\": FACET_BUCKET_TYPE_VALUE\n }\n },\n \"search_configs\": {\n \"name\": \"projects/PROJECT_NUMBER/locations/LOCATION_ID/corpora/CORPUS_ID/searchConfigs/location\",\n \"facet_property\": {\n  // Top-level facet group name.\n  \"display_name\": \"location\",\n  // Each mapped_field will be displayed in the console as a selectable value\n  // under \"location\".\n  \"mapped_fields\": \"city\",\n  // The maximum number of mapped_fields to be displayed.\n  \"result_size\": 2,\n  // The facet type is a singular value. In this case, type string.\n  \"bucket_type\": FACET_BUCKET_TYPE_VALUE\n }\n }\n}\n```\nThe response only contains two `SearchConfigs` because in the request, the `page_size=2` field is set. To view the next page of search configs, include the previous response's `next_page_token` setting in your next request:- https://warehouse-visionai.googleapis.com/v1alpha//searchConfigs **?page_size=2&page_token='xyz'** \n## Delete a search config\nThe following code sample uses the [projects.locations.corpora.searchConfigs.delete](/vision-ai/docs/reference/rest/v1/projects.locations.corpora.searchConfigs/delete) method to delete a `SearchConfig` . The `SearchConfig` must exist for this request to succeed.\nBefore using any of the request data, make the following replacements:- : Endpoint might include a prefix matching the`LOCATION_ID`such as`europe-west4-`. See more about [ regionalized endpoints](/vision-ai/docs/warehouse-supported-regions) .\n- : Your Google Cloud [project number](/resource-manager/docs/creating-managing-projects#identifying_projects) .\n- : The [region](/about/locations) where you are using Vertex AI Vision. For example:`us-central1`,`europe-west4`. See [available regions](/vision-ai/docs/warehouse-supported-regions) .\n- : The ID of your target corpus.\n- : The ID of your target`SearchConfig`.\nHTTP method and URL:\n```\nDELETE https://warehouse-visionai.googleapis.com/v1/projects/PROJECT_NUMBER/locations/LOCATION_ID/corpora/CORPUS_ID/searchConfigs/SEARCHCONFIG_ID\n```\nTo send your request, choose one of these options:\n **Note:** The following command assumes that you have logged in to  the`gcloud`CLI with your user account by running [gcloud init](/sdk/gcloud/reference/init) or [gcloud auth login](/sdk/gcloud/reference/auth/login) ,  or by using [Cloud Shell](/shell/docs) ,  which automatically logs you into the`gcloud`CLI.  You can check the currently active account by running [gcloud auth list](/sdk/gcloud/reference/auth/list) .\nExecute the following command:\n```\ncurl -X DELETE \\ -H \"Authorization: Bearer $(gcloud auth print-access-token)\" \\ \"https://warehouse-visionai.googleapis.com/v1/projects/PROJECT_NUMBER/locations/LOCATION_ID/corpora/CORPUS_ID/searchConfigs/SEARCHCONFIG_ID\"\n``` **Note:** The following command assumes that you have logged in to  the`gcloud`CLI with your user account by running [gcloud init](/sdk/gcloud/reference/init) or [gcloud auth login](/sdk/gcloud/reference/auth/login) ,  or by using [Cloud Shell](/shell/docs) ,  which automatically logs you into the`gcloud`CLI.  You can check the currently active account by running [gcloud auth list](/sdk/gcloud/reference/auth/list) .\nExecute the following command:\n```\n$cred = gcloud auth print-access-token$headers = @{ \"Authorization\" = \"Bearer $cred\" }Invoke-WebRequest ` -Method DELETE ` -Headers $headers ` -Uri \"https://warehouse-visionai.googleapis.com/v1/projects/PROJECT_NUMBER/locations/LOCATION_ID/corpora/CORPUS_ID/searchConfigs/SEARCHCONFIG_ID\" | Select-Object -Expand Content\n```\nYou should receive a JSON response similar to the following:\n```\n{}\n```", "guide": "Vertex AI Vision"}