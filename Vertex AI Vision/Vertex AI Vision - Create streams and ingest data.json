{"title": "Vertex AI Vision - Create streams and ingest data", "url": "https://cloud.google.com/vision-ai/docs/create-manage-streams?hl=zh-cn", "abstract": "# Vertex AI Vision - Create streams and ingest data\nThe first step in analyzing your video data with an application is creating a pipeline for the continuous flow of data. Streams offers the ability to ingest real-time video data, which then can be used as input for models or stored in a Warehouse.\n", "content": "## Create a Stream\nTo be able to stream video data you must first create a stream.\nThe first time you create a stream in a new project it can take some time to create the stream. This time is around 30 minutes. This time is due to the system needing to initialize a computation cluster for subsequent computations.\nCreate a stream in the Google Cloud console.- Open the **Streams** tab of the Vertex AI Vision dashboard. [Go to the Streams tab](https://console.cloud.google.com/ai/vision-ai/video-streams) \n- Click add **Register** .\n- Enter the stream name and select a region. You can click **Add Row** to register multiple streams at the same time.\n- Click the **Register** button to create one or more streams.## Ingest videos\nAfter you have created a stream you can begin to ingest data using that stream.\nSome limitations and considerations apply to ingested video:\n- The input video source must have the following specifications:- [H.264 encoding](https://en.wikipedia.org/wiki/Advanced_Video_Coding) \n- <= 1080p resolution\n- ~25\nIf the video doesn't meet these specifications Vertex AI Vision may not  process the input well.\n- Audio is dropped during ingestion.\n- If the stream is part of an app connected to a warehouse, video parameters (such as FPS or resolution) must be the same for the whole stream ; variations in RTSP video data parameters or local video data parameters are not supported.\n- Due to model startup latency, ingested videos may have the first few seconds of content  missing. This amount of time can reach up to fifteen seconds.\n- Ingestion termination can happen after long connection  (~5 hours, on average). There's no reconnection capability from the`vaictl`tool ; users must manually reconnect.\n- While`vaictl`is a useful tool for ingesting video data, the tool does not  automatically handle recovery from network errors. These errors may either come from the  data-source side or the Cloud-ingestion side. It's the user's responsibility to create a  restart script to handle unexpected`vaictl`operation terminations.To send a request to ingest video data using an existing stream you must [install the Vertex AI Vision SDK](/vision-ai/docs/cloud-environment#install_the_streams_sdk) .\n **Note** : You may need to establish user access credentials by running the following command:`gcloud auth application-default login`. For more information about this command, see the [Vertex AI Vision SDK reference documentation](/sdk/gcloud/reference/auth/application-default/login) .Make the following variable substitutions:- : Your Google Cloud project ID.\n- : Your location ID. For example,`us-central1`. [More information](/about/locations) . [Supported regions](/vision-ai/docs/warehouse-supported-regions) .\n- : The filename of a local video file. For example,`my-video.mp4`.\n- : The stream ID that you created in the cluster For example,`input-1`.\n- : The address of your Real Time Streaming Protocol ( [RTSP](https://en.wikipedia.org/wiki/Real_Time_Streaming_Protocol) ) feed. For example,`rtsp://my-ip-camera`.\n **Local video data:** \n```\n# This command streams a video file to a stream. Streaming ends when the video ends.vaictl -p PROJECT_ID \\\u00a0 \u00a0 \u00a0 \u00a0 \u00a0-l LOCATION_ID \\\u00a0 \u00a0 \u00a0 \u00a0 \u00a0-c application-cluster-0 \\\u00a0 \u00a0 \u00a0 \u00a0 \u00a0--service-endpoint visionai.googleapis.com \\send video-file to streams STREAM_ID --file-path LOCAL_FILE.EXT\n```\n **Local video data (looped):** \n```\n# This command streams a video file to a stream. Video is looped into the stream until you stop the command.vaictl -p PROJECT_ID \\\u00a0 \u00a0 \u00a0 \u00a0 \u00a0-l LOCATION_ID \\\u00a0 \u00a0 \u00a0 \u00a0 \u00a0-c application-cluster-0 \\\u00a0 \u00a0 \u00a0 \u00a0 \u00a0--service-endpoint visionai.googleapis.com \\send video-file to streams STREAM_ID --file-path LOCAL_FILE.EXT --loop\n```\n **Real Time Streaming Protocol (RTSP) feed data:** \n```\n# This command will send an RTSP feed into the stream.# This command has to run in the network that has direct access to the RTSP feed.vaictl -p PROJECT_ID \\\u00a0 \u00a0 \u00a0 \u00a0 \u00a0-l LOCATION_ID \\\u00a0 \u00a0 \u00a0 \u00a0 \u00a0-c application-cluster-0 \\\u00a0 \u00a0 \u00a0 \u00a0 \u00a0--service-endpoint visionai.googleapis.com \\send rtsp to streams STREAM_ID --rtsp-uri RTSP_ADDRESS\n```\n## Play ingested videos\nAfter you have created a stream and sent video content to the stream you can play the video content.\nIf you leave the stream view tab open for more than one hour, you must refresh the page to continue to load video contents.\nPlay ingested video in the Google Cloud console.- Open the **Streams** tab of the Vertex AI Vision dashboard. [Go to the Streams tab](https://console.cloud.google.com/ai/vision-ai/video-streams) \n- Click on the stream name from the streams list.\n- In the video stream detail page the ingested video live view automatically loads.", "guide": "Vertex AI Vision"}