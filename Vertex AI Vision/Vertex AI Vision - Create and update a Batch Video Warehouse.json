{"title": "Vertex AI Vision - Create and update a Batch Video Warehouse", "url": "https://cloud.google.com/vision-ai/docs/batch-video-warehouse-creation?hl=zh-cn", "abstract": "# Vertex AI Vision - Create and update a Batch Video Warehouse\nCreate a Batch Video Warehouse that is ready to use for search.\n", "content": "## Setting up a minimal Batch Video Warehouse\nThere are two common ways to set up a minimal Batch Video Warehouse.\n- Option 1: Deploy an empty index first, and then gradually add video assets. The typical API sequence for this approach is as follows:- Set up a corpus:`CreateCorpus`, then`CreateDataSchema`.\n- Set up an empty index:`CreateIndex`,`CreateIndexEndpoint`, and`DeployIndex`.\n- Add video assets:`CreateAsset`,`UploadAsset`,`AnalyzeAsset`, and`IndexAsset`.- (Optional) Add video annotations:`CreateAnnotation`.\n- Option 2: Import video assets first, and then deploy an index. The typical API sequence for this approach is as follows:- Set up a corpus:`CreateCorpus`, then`CreateDataSchema`.\n- Add video assets:`CreateAsset`,`UploadAsset`, and`AnalyzeAsset`.- (Optional) Add video annotations:`CreateAnnotation`.\n- Set up an index with existing assets:`CreateIndex`,`CreateIndexEndpoint`, and`DeployIndex`.**Choosing an approach** : The best approach for you will depend on your specific needs. If you need to start searching videos as soon as possible, you may want to use the first approach. If you have a large number of videos to import, you may want to use the latter option.\n## Create a corpus\nTo begin, you must create a corpus resource. When creating a Batch Video Warehouse corpus, specify `EMBEDDING_SEARCH` as the default value of the `searchCapabilitySetting` property.\nCreates a corpus resource under the given project with the option to specify the corpus's display name and description.\nBefore using any of the request data, make the following replacements:- : Endpoint might include a prefix matching the`LOCATION_ID`such as`europe-west4-`. See more about [ regionalized endpoints](/vision-ai/docs/warehouse-supported-regions) .\n- : Your Google Cloud [project number](/resource-manager/docs/creating-managing-projects#identifying_projects) .\n- : The [region](/about/locations) where you are using Vertex AI Vision. For example:`us-central1`,`europe-west4`. See [available regions](/vision-ai/docs/warehouse-supported-regions) .\n- : Display name for the warehouse.\n- : The description of the warehouse (`corpus`).\nHTTP method and URL:\n```\nPOST https://warehouse-visionai.googleapis.com/v1/projects/PROJECT_NUMBER/locations/LOCATION_ID/corpora\n```\nRequest JSON body:\n```\n{\n \"display_name\": \"DISPLAY_NAME\",\n \"description\": \"WAREHOUSE_DESCRIPTION\",\n \"type\": \"VIDEO_ON_DEMAND\",\n \"search_capability_setting\": {\n \"search_capabilities\": {\n  \"type\": \"EMBEDDING_SEARCH\"\n }\n }\n}\n```\nTo send your request, choose one of these options:\n **Note:** The following command assumes that you have logged in to  the`gcloud`CLI with your user account by running [gcloud init](/sdk/gcloud/reference/init) or [gcloud auth login](/sdk/gcloud/reference/auth/login) ,  or by using [Cloud Shell](/shell/docs) ,  which automatically logs you into the`gcloud`CLI.  You can check the currently active account by running [gcloud auth list](/sdk/gcloud/reference/auth/list) .\nSave the request body in a file named `request.json` ,  and execute the following command:\n```\ncurl -X POST \\ -H \"Authorization: Bearer $(gcloud auth print-access-token)\" \\ -H \"Content-Type: application/json; charset=utf-8\" \\ -d @request.json \\ \"https://warehouse-visionai.googleapis.com/v1/projects/PROJECT_NUMBER/locations/LOCATION_ID/corpora\"\n``` **Note:** The following command assumes that you have logged in to  the`gcloud`CLI with your user account by running [gcloud init](/sdk/gcloud/reference/init) or [gcloud auth login](/sdk/gcloud/reference/auth/login) ,  or by using [Cloud Shell](/shell/docs) ,  which automatically logs you into the`gcloud`CLI.  You can check the currently active account by running [gcloud auth list](/sdk/gcloud/reference/auth/list) .\nSave the request body in a file named `request.json` ,  and execute the following command:\n```\n$cred = gcloud auth print-access-token$headers = @{ \"Authorization\" = \"Bearer $cred\" }Invoke-WebRequest ` -Method POST ` -Headers $headers ` -ContentType: \"application/json; charset=utf-8\" ` -InFile request.json ` -Uri \"https://warehouse-visionai.googleapis.com/v1/projects/PROJECT_NUMBER/locations/LOCATION_ID/corpora\" | Select-Object -Expand Content\n```\nYou should receive a JSON response similar to the following:\n```\n{\n \"name\": \"projects/PROJECT_NUMBER/locations/LOCATION_ID/warehouseoperations/OPERATION_ID\",\n \"metadata\": {\n \"@type\": \"type.googleapis.com/google.cloud.visionai.v1.CreateCorpusMetadata\"\n },\n \"done\": true,\n \"response\": {\n \"@type\": \"type.googleapis.com/google.cloud.visionai.v1.Corpus\",\n \"name\": \"projects/PROJECT_NUMBER/locations/LOCATION_ID/corpora/CORPUS_ID\",\n \"displayName\": \"DISPLAY_NAME\",\n \"description\": \"WAREHOUSE_DESCRIPTION\",\n \"type\": \"VIDEO_ON_DEMAND\",\n \"search_capability_setting\": {\n  \"search_capabilities\": {\n  \"type\": \"EMBEDDING_SEARCH\"\n  }\n }\n }\n}\n```\n## Create, upload, and analyze assets\nTo add a video to Batch Video Warehouse, first create an asset.\nTo create an asset resource, send a `POST` request by using the [projects.locations.corpora.assets.create](/vision-ai/docs/reference/rest/v1/projects.locations.corpora.assets/create) method.\nBefore using any of the request data, make the following replacements:- : Endpoint might include a prefix matching the`LOCATION_ID`such as`europe-west4-`. See more about [ regionalized endpoints](/vision-ai/docs/warehouse-supported-regions) .\n- : Your Google Cloud [project number](/resource-manager/docs/creating-managing-projects#identifying_projects) .\n- : The [region](/about/locations) where you are using Vertex AI Vision. For example:`us-central1`,`europe-west4`. See [available regions](/vision-ai/docs/warehouse-supported-regions) .\n- : The ID of your target corpus.\n- : (Optional) A user-provided value for the asset ID. In this request, the value is added to the request URL in the form:- https:///v1//corpora//assets **?asset_id=ASSET_ID** \n- : The amount of time to live (TTL) for all assets under a corpus, or the TTL of a specific asset. For example, for a corpus with assets with a TTL of 100 days, provide the value`8640000`(seconds).\nHTTP method and URL:\n```\nPOST https://warehouse-visionai.googleapis.com/v1/projects/PROJECT_NUMBER/locations/LOCATION_ID/corpora/CORPUS_ID/assets\n```\nRequest JSON body:\n```\n{\n}\n```\nTo send your request, choose one of these options:\n **Note:** The following command assumes that you have logged in to  the`gcloud`CLI with your user account by running [gcloud init](/sdk/gcloud/reference/init) or [gcloud auth login](/sdk/gcloud/reference/auth/login) ,  or by using [Cloud Shell](/shell/docs) ,  which automatically logs you into the`gcloud`CLI.  You can check the currently active account by running [gcloud auth list](/sdk/gcloud/reference/auth/list) .\nSave the request body in a file named `request.json` ,  and execute the following command:\n```\ncurl -X POST \\ -H \"Authorization: Bearer $(gcloud auth print-access-token)\" \\ -H \"Content-Type: application/json; charset=utf-8\" \\ -d @request.json \\ \"https://warehouse-visionai.googleapis.com/v1/projects/PROJECT_NUMBER/locations/LOCATION_ID/corpora/CORPUS_ID/assets\"\n``` **Note:** The following command assumes that you have logged in to  the`gcloud`CLI with your user account by running [gcloud init](/sdk/gcloud/reference/init) or [gcloud auth login](/sdk/gcloud/reference/auth/login) ,  or by using [Cloud Shell](/shell/docs) ,  which automatically logs you into the`gcloud`CLI.  You can check the currently active account by running [gcloud auth list](/sdk/gcloud/reference/auth/list) .\nSave the request body in a file named `request.json` ,  and execute the following command:\n```\n$cred = gcloud auth print-access-token$headers = @{ \"Authorization\" = \"Bearer $cred\" }Invoke-WebRequest ` -Method POST ` -Headers $headers ` -ContentType: \"application/json; charset=utf-8\" ` -InFile request.json ` -Uri \"https://warehouse-visionai.googleapis.com/v1/projects/PROJECT_NUMBER/locations/LOCATION_ID/corpora/CORPUS_ID/assets\" | Select-Object -Expand Content\n```\nYou should receive a JSON response similar to the following:\n```\n{\n \"name\": \"projects/PROJECT_NUMBER/locations/LOCATION_ID/corpora/CORPUS_ID/assets/ASSET_ID\"\n}\n```\nThe next step is to upload the video from a Cloud Storage URI. Note that Batch Video Warehouse does not store a copy of the video file. The `UploadAsset` API only verifies video metadata to make sure no quotas or limits are violated.\nBefore using any of the request data, make the following replacements:- : Endpoint might include a prefix matching the`LOCATION_ID`such as`europe-west4-`. See more about [ regionalized endpoints](/vision-ai/docs/warehouse-supported-regions) .\n- : Your Google Cloud [project number](/resource-manager/docs/creating-managing-projects#identifying_projects) .\n- : The [region](/about/locations) where you are using Vertex AI Vision. For example:`us-central1`,`europe-west4`. See [available regions](/vision-ai/docs/warehouse-supported-regions) .\n- : The ID of your target corpus.\n- : The ID of your target asset.\nHTTP method and URL:\n```\nPOST https://warehouse-visionai.googleapis.com/v1/projects/PROJECT_NUMBER/locations/LOCATION_ID/corpora/CORPUS_ID/assets/ASSET_ID:upload\n```\nRequest JSON body:\n```\n{\n \"asset_source\": {\n \"asset_gcs_source\": {\n  \"gcs_uri\": \"GCS_URI\"\n }\n }\n}\n```\nTo send your request, choose one of these options:\n **Note:** The following command assumes that you have logged in to  the`gcloud`CLI with your user account by running [gcloud init](/sdk/gcloud/reference/init) or [gcloud auth login](/sdk/gcloud/reference/auth/login) ,  or by using [Cloud Shell](/shell/docs) ,  which automatically logs you into the`gcloud`CLI.  You can check the currently active account by running [gcloud auth list](/sdk/gcloud/reference/auth/list) .\nSave the request body in a file named `request.json` ,  and execute the following command:\n```\ncurl -X POST \\ -H \"Authorization: Bearer $(gcloud auth print-access-token)\" \\ -H \"Content-Type: application/json; charset=utf-8\" \\ -d @request.json \\ \"https://warehouse-visionai.googleapis.com/v1/projects/PROJECT_NUMBER/locations/LOCATION_ID/corpora/CORPUS_ID/assets/ASSET_ID:upload\"\n``` **Note:** The following command assumes that you have logged in to  the`gcloud`CLI with your user account by running [gcloud init](/sdk/gcloud/reference/init) or [gcloud auth login](/sdk/gcloud/reference/auth/login) ,  or by using [Cloud Shell](/shell/docs) ,  which automatically logs you into the`gcloud`CLI.  You can check the currently active account by running [gcloud auth list](/sdk/gcloud/reference/auth/list) .\nSave the request body in a file named `request.json` ,  and execute the following command:\n```\n$cred = gcloud auth print-access-token$headers = @{ \"Authorization\" = \"Bearer $cred\" }Invoke-WebRequest ` -Method POST ` -Headers $headers ` -ContentType: \"application/json; charset=utf-8\" ` -InFile request.json ` -Uri \"https://warehouse-visionai.googleapis.com/v1/projects/PROJECT_NUMBER/locations/LOCATION_ID/corpora/CORPUS_ID/assets/ASSET_ID:upload\" | Select-Object -Expand Content\n```\nYou should receive a JSON response similar to the following:\n```\n{\n \"name\": \"projects/PROJECT_NUMBER/locations/LOCATION_ID/corpora/CORPUS_ID/assets/ASSET_ID/operations/OPERATION_ID\",\n}\n```\nThe uploaded video needs to be analyzed before going into search indexes.\nAnalyze a video asset using the [projects.locations.corpora.assets.analyze](/vision-ai/docs/reference/rest/v1/projects.locations.corpora.assets/analyze) method. By default, Batch Video Warehouse runs embedding analysis on video content.\nBefore using any of the request data, make the following replacements:- : Endpoint might include a prefix matching the`LOCATION_ID`such as`europe-west4-`. See more about [ regionalized endpoints](/vision-ai/docs/warehouse-supported-regions) .\n- : Your Google Cloud [project number](/resource-manager/docs/creating-managing-projects#identifying_projects) .\n- : The [region](/about/locations) where you are using Vertex AI Vision. For example:`us-central1`,`europe-west4`. See [available regions](/vision-ai/docs/warehouse-supported-regions) .\n- : The ID of your target corpus.\n- : The ID of your target asset.\nHTTP method and URL:\n```\nPOST https://warehouse-visionai.googleapis.com/v1/projects/PROJECT_NUMBER/locations/LOCATION_ID/corpora/CORPUS_ID/assets/ASSET_ID:analyze\n```\nRequest JSON body:\n```\n{\n \"name\": \"projects/PROJECT_NUMBER/locations/LOCATION_ID/corpora/CORPUS_ID/assets/ASSET_ID\n}\n```\nTo send your request, choose one of these options:\n **Note:** The following command assumes that you have logged in to  the`gcloud`CLI with your user account by running [gcloud init](/sdk/gcloud/reference/init) or [gcloud auth login](/sdk/gcloud/reference/auth/login) ,  or by using [Cloud Shell](/shell/docs) ,  which automatically logs you into the`gcloud`CLI.  You can check the currently active account by running [gcloud auth list](/sdk/gcloud/reference/auth/list) .\nSave the request body in a file named `request.json` ,  and execute the following command:\n```\ncurl -X POST \\ -H \"Authorization: Bearer $(gcloud auth print-access-token)\" \\ -H \"Content-Type: application/json; charset=utf-8\" \\ -d @request.json \\ \"https://warehouse-visionai.googleapis.com/v1/projects/PROJECT_NUMBER/locations/LOCATION_ID/corpora/CORPUS_ID/assets/ASSET_ID:analyze\"\n``` **Note:** The following command assumes that you have logged in to  the`gcloud`CLI with your user account by running [gcloud init](/sdk/gcloud/reference/init) or [gcloud auth login](/sdk/gcloud/reference/auth/login) ,  or by using [Cloud Shell](/shell/docs) ,  which automatically logs you into the`gcloud`CLI.  You can check the currently active account by running [gcloud auth list](/sdk/gcloud/reference/auth/list) .\nSave the request body in a file named `request.json` ,  and execute the following command:\n```\n$cred = gcloud auth print-access-token$headers = @{ \"Authorization\" = \"Bearer $cred\" }Invoke-WebRequest ` -Method POST ` -Headers $headers ` -ContentType: \"application/json; charset=utf-8\" ` -InFile request.json ` -Uri \"https://warehouse-visionai.googleapis.com/v1/projects/PROJECT_NUMBER/locations/LOCATION_ID/corpora/CORPUS_ID/assets/ASSET_ID:analyze\" | Select-Object -Expand Content\n```\nYou should receive a JSON response similar to the following:\n```\n{\n \"name\": \"projects/PROJECT_NUMBER/locations/LOCATION_ID/corpora/CORPUS_ID/assets/ASSET_ID/operations/OPERATION_ID\",\n}\n```\n**Note:** Both video upload and analysis are long-running operations. You can use the [projects.locations.corpora.assets.operations.get](/vision-ai/docs/reference/rest/v1/projects.locations.corpora.assets.operations/get) method to poll operation status.\n## Create data schemas\nA data schema is mandatory if you want to annotate the videos with custom metadata and search for the metadata. Each data schema has a unique key, which is to be associated with annotations and used as filter criteria in search.\nBefore using any of the request data, make the following replacements:- : Endpoint might include a prefix matching the`LOCATION_ID`such as`europe-west4-`. See more about [ regionalized endpoints](/vision-ai/docs/warehouse-supported-regions) .\n- : Your Google Cloud [project number](/resource-manager/docs/creating-managing-projects#identifying_projects) .\n- : The [region](/about/locations) where you are using Vertex AI Vision. For example:`us-central1`,`europe-west4`. See [available regions](/vision-ai/docs/warehouse-supported-regions) .\n- : The ID of your target corpus.\n- : This key must match the key of a user-specified annotation and  unique inside a`corpus`. For example,`data-key`.\n- : The data type of the annotation. Available values are:- `DATA_TYPE_UNSPECIFIED`\n- `INTEGER`\n- `FLOAT`\n- `STRING`\n- `DATETIME`\n- `GEO_COORDINATE`\n- `PROTO_ANY`\n- `BOOLEAN`\nFor more information, see the [API  reference documentation](/vision-ai/docs/reference/rest/v1/projects.locations.corpora.dataSchemas#datatype) .\n- : The granularity of the annotations under this`dataSchema`. Available values are:- `GRANULARITY_UNSPECIFIED`- Unspecified granularity.\n- `GRANULARITY_ASSET_LEVEL`- Asset-level granularity (annotations must not  contain temporal partition information for the media asset).\n- `GRANULARITY_PARTITION_LEVEL`- Partition-level granularity (annotations must  contain temportal partition information for the media asset).\n- : One of the available enum values. The types of search strategies to be applied on the annotation key. Available values are:- `NO_SEARCH`\n- `EXACT_SEARCH`\n- `SMART_SEARCH`\nHTTP method and URL:\n```\nPOST https://warehouse-visionai.googleapis.com/v1/projects/PROJECT_NUMBER/locations/LOCATION_ID/corpora/CORPUS_ID/dataSchemas\n```\nRequest JSON body:\n```\n{\n \"key\": \"DATASCHEMA_KEY\",\n \"schema_details\": {\n \"type\": \"ANNOTATION_DATA_TYPE\",\n \"granularity\": \"ANNOTATION_GRANULARITY\",\n \"search_strategy\": {\n  \"search_strategy_type\": \"SEARCH_STRATEGY\"\n }\n }\n}\n```\nTo send your request, choose one of these options:\n **Note:** The following command assumes that you have logged in to  the`gcloud`CLI with your user account by running [gcloud init](/sdk/gcloud/reference/init) or [gcloud auth login](/sdk/gcloud/reference/auth/login) ,  or by using [Cloud Shell](/shell/docs) ,  which automatically logs you into the`gcloud`CLI.  You can check the currently active account by running [gcloud auth list](/sdk/gcloud/reference/auth/list) .\nSave the request body in a file named `request.json` ,  and execute the following command:\n```\ncurl -X POST \\ -H \"Authorization: Bearer $(gcloud auth print-access-token)\" \\ -H \"Content-Type: application/json; charset=utf-8\" \\ -d @request.json \\ \"https://warehouse-visionai.googleapis.com/v1/projects/PROJECT_NUMBER/locations/LOCATION_ID/corpora/CORPUS_ID/dataSchemas\"\n``` **Note:** The following command assumes that you have logged in to  the`gcloud`CLI with your user account by running [gcloud init](/sdk/gcloud/reference/init) or [gcloud auth login](/sdk/gcloud/reference/auth/login) ,  or by using [Cloud Shell](/shell/docs) ,  which automatically logs you into the`gcloud`CLI.  You can check the currently active account by running [gcloud auth list](/sdk/gcloud/reference/auth/list) .\nSave the request body in a file named `request.json` ,  and execute the following command:\n```\n$cred = gcloud auth print-access-token$headers = @{ \"Authorization\" = \"Bearer $cred\" }Invoke-WebRequest ` -Method POST ` -Headers $headers ` -ContentType: \"application/json; charset=utf-8\" ` -InFile request.json ` -Uri \"https://warehouse-visionai.googleapis.com/v1/projects/PROJECT_NUMBER/locations/LOCATION_ID/corpora/CORPUS_ID/dataSchemas\" | Select-Object -Expand Content\n```\nYou should receive a JSON response similar to the following:\n```\n{\n \"name\": \"projects/PROJECT_NUMBER/locations/LOCATION_ID/corpora/CORPUS_ID/dataSchemas/DATASCHEMA_ID\",\n \"key\": \"data-key\",\n \"schemaDetails\": {\n \"type\": \"BOOLEAN\",\n \"granularity\": \"GRANULARITY_ASSET_LEVEL\",\n \"searchStrategy\": {\n  \"search_strategy_type\": \"EXACT_SEARCH\"\n }\n }\n}\n```\n## Create annotations\nYou can annotate a video with either asset-level annotations or annotations with relative temporal partitions. Each annotation must be specified with an existing data schema key.\nBefore using any of the request data, make the following replacements:- : Endpoint might include a prefix matching the`LOCATION_ID`such as`europe-west4-`. See more about [ regionalized endpoints](/vision-ai/docs/warehouse-supported-regions) .\n- : Your Google Cloud [project number](/resource-manager/docs/creating-managing-projects#identifying_projects) .\n- : The [region](/about/locations) where you are using Vertex AI Vision. For example:`us-central1`,`europe-west4`. See [available regions](/vision-ai/docs/warehouse-supported-regions) .\n- : The ID of your target corpus.\n- : The ID of your target asset.\n- : (Optional) A user-provided value for the annotation ID. In this request, the value is added to the request URL in the form:- https:///v1//corpora//assets//annotations **?annotation_id=ANNOTATION_ID** \nHTTP method and URL:\n```\nPOST https://warehouse-visionai.googleapis.com/v1/projects/PROJECT_NUMBER/locations/LOCATION_ID/corpora/CORPUS_ID/assets/ASSET_ID/annotations\n```\nRequest JSON body:\n```\n{\n \"user_specified_annotation\": {\n \"key\": \"object-detected\",\n \"value\": {\n  \"str_value\": \"cat\"\n },\n \"partition\": {\n  \"relative_temporal_partition\": {\n  \"start_offset\": {\n   \"seconds\": \"60\"\n  },\n  \"end_offset\": {\n   \"seconds\": \"300\"\n  }\n  }\n }\n }\n}\n```\nTo send your request, choose one of these options:\n **Note:** The following command assumes that you have logged in to  the`gcloud`CLI with your user account by running [gcloud init](/sdk/gcloud/reference/init) or [gcloud auth login](/sdk/gcloud/reference/auth/login) ,  or by using [Cloud Shell](/shell/docs) ,  which automatically logs you into the`gcloud`CLI.  You can check the currently active account by running [gcloud auth list](/sdk/gcloud/reference/auth/list) .\nSave the request body in a file named `request.json` ,  and execute the following command:\n```\ncurl -X POST \\ -H \"Authorization: Bearer $(gcloud auth print-access-token)\" \\ -H \"Content-Type: application/json; charset=utf-8\" \\ -d @request.json \\ \"https://warehouse-visionai.googleapis.com/v1/projects/PROJECT_NUMBER/locations/LOCATION_ID/corpora/CORPUS_ID/assets/ASSET_ID/annotations\"\n``` **Note:** The following command assumes that you have logged in to  the`gcloud`CLI with your user account by running [gcloud init](/sdk/gcloud/reference/init) or [gcloud auth login](/sdk/gcloud/reference/auth/login) ,  or by using [Cloud Shell](/shell/docs) ,  which automatically logs you into the`gcloud`CLI.  You can check the currently active account by running [gcloud auth list](/sdk/gcloud/reference/auth/list) .\nSave the request body in a file named `request.json` ,  and execute the following command:\n```\n$cred = gcloud auth print-access-token$headers = @{ \"Authorization\" = \"Bearer $cred\" }Invoke-WebRequest ` -Method POST ` -Headers $headers ` -ContentType: \"application/json; charset=utf-8\" ` -InFile request.json ` -Uri \"https://warehouse-visionai.googleapis.com/v1/projects/PROJECT_NUMBER/locations/LOCATION_ID/corpora/CORPUS_ID/assets/ASSET_ID/annotations\" | Select-Object -Expand Content\n```\nYou should receive a JSON response similar to the following:\n```\n{\n \"name\": \"projects/PROJECT_NUMBER/locations/LOCATION_ID/corpora/CORPUS_ID/assets/ASSET_ID/annotations/ANNOTATION_ID\",\n \"userSpecifiedAnnotation\": {\n \"key\": \"object-detected\",\n \"value\": {\n  \"strValue\": \"cat\"\n },\n \"partition\": {\n  \"relative_temporal_partition\": {\n  \"start_offset\": \"60s\",\n  \"end_offset\": \"300s\"\n  }\n }\n }\n}\n```\n## Create an index\nAfter you have added video assets and annotations, you can proceed to create an index on a corpus. An index captures the state of the corpus at the creation time, which includes all analyzed assets and annotations.\nThis sample shows you how to create an index resource.\nBefore using any of the request data, make the following replacements:- : Endpoint might include a prefix matching the`LOCATION_ID`such as`europe-west4-`. See more about [ regionalized endpoints](/vision-ai/docs/warehouse-supported-regions) .\n- : Your Google Cloud [project number](/resource-manager/docs/creating-managing-projects#identifying_projects) .\n- : The [region](/about/locations) where you are using Vertex AI Vision. For example:`us-central1`,`europe-west4`. See [available regions](/vision-ai/docs/warehouse-supported-regions) .\n- : The ID of your target corpus.\n- : () A user-provided value for the index ID. In this request, the value is added to the request URL in the form:- https:///v1//corpora//indexes **?index_id=INDEX_ID** \nHTTP method and URL:\n```\nPOST https://warehouse-visionai.googleapis.com/v1/projects/PROJECT_NUMBER/locations/LOCATION_ID/corpora/CORPUS_ID/indexes\n```\nRequest JSON body:\n```\n{\n \"display_name\": \"DISPLAY_NAME\",\n \"description\": \"INDEX_DESCRIPTION\",\n}\n```\nTo send your request, choose one of these options:\n **Note:** The following command assumes that you have logged in to  the`gcloud`CLI with your user account by running [gcloud init](/sdk/gcloud/reference/init) or [gcloud auth login](/sdk/gcloud/reference/auth/login) ,  or by using [Cloud Shell](/shell/docs) ,  which automatically logs you into the`gcloud`CLI.  You can check the currently active account by running [gcloud auth list](/sdk/gcloud/reference/auth/list) .\nSave the request body in a file named `request.json` ,  and execute the following command:\n```\ncurl -X POST \\ -H \"Authorization: Bearer $(gcloud auth print-access-token)\" \\ -H \"Content-Type: application/json; charset=utf-8\" \\ -d @request.json \\ \"https://warehouse-visionai.googleapis.com/v1/projects/PROJECT_NUMBER/locations/LOCATION_ID/corpora/CORPUS_ID/indexes\"\n``` **Note:** The following command assumes that you have logged in to  the`gcloud`CLI with your user account by running [gcloud init](/sdk/gcloud/reference/init) or [gcloud auth login](/sdk/gcloud/reference/auth/login) ,  or by using [Cloud Shell](/shell/docs) ,  which automatically logs you into the`gcloud`CLI.  You can check the currently active account by running [gcloud auth list](/sdk/gcloud/reference/auth/list) .\nSave the request body in a file named `request.json` ,  and execute the following command:\n```\n$cred = gcloud auth print-access-token$headers = @{ \"Authorization\" = \"Bearer $cred\" }Invoke-WebRequest ` -Method POST ` -Headers $headers ` -ContentType: \"application/json; charset=utf-8\" ` -InFile request.json ` -Uri \"https://warehouse-visionai.googleapis.com/v1/projects/PROJECT_NUMBER/locations/LOCATION_ID/corpora/CORPUS_ID/indexes\" | Select-Object -Expand Content\n```\nYou should receive a JSON response similar to the following:\n```\n{\n \"name\": \"projects/PROJECT_NUMBER/locations/LOCATION_ID/corpora/CORPUS_ID/indexes/INDEX_ID/operations/OPERATION_ID\",\n \"metadata\": {\n \"@type\": \"type.googleapis.com/google.cloud.visionai.v1.CreateIndexMetadata\"\n }\n}\n```\n**Note:** Index creation is a long-running operation. You can use [projects.locations.corpora.indexes.operations.get](/vision-ai/docs/reference/rest/v1/projects.locations.corpora.indexes.operations/get) to poll operation status.\n## Deploy index to index endpoint\nAn index has to be deployed to an index endpoint before it can be used for search. An index endpoint provides the access point to sending search request.\nThis example shows you how to create an index endpoint.\nBefore using any of the request data, make the following replacements:- : Endpoint might include a prefix matching the`LOCATION_ID`such as`europe-west4-`. See more about [ regionalized endpoints](/vision-ai/docs/warehouse-supported-regions) .\n- : Your Google Cloud [project number](/resource-manager/docs/creating-managing-projects#identifying_projects) .\n- : The [region](/about/locations) where you are using Vertex AI Vision. For example:`us-central1`,`europe-west4`. See [available regions](/vision-ai/docs/warehouse-supported-regions) .\n- : () A user-provided value for the index endpoint ID. In this request, the value is added to the request URL in the form:- https:///v1/projects//locations//indexEndpoints **?index_endpoint_id=INDEX_ENDPOINT_ID** \nHTTP method and URL:\n```\nPOST https://warehouse-visionai.googleapis.com/v1/projects/PROJECT_NUMBER/locations/LOCATION_ID/indexEndpoints\n```\nRequest JSON body:\n```\n{\n \"display_name\": \"DISPLAY_NAME\",\n \"description\": \"DESCRIPTION\",\n}\n```\nTo send your request, choose one of these options:\n **Note:** The following command assumes that you have logged in to  the`gcloud`CLI with your user account by running [gcloud init](/sdk/gcloud/reference/init) or [gcloud auth login](/sdk/gcloud/reference/auth/login) ,  or by using [Cloud Shell](/shell/docs) ,  which automatically logs you into the`gcloud`CLI.  You can check the currently active account by running [gcloud auth list](/sdk/gcloud/reference/auth/list) .\nSave the request body in a file named `request.json` ,  and execute the following command:\n```\ncurl -X POST \\ -H \"Authorization: Bearer $(gcloud auth print-access-token)\" \\ -H \"Content-Type: application/json; charset=utf-8\" \\ -d @request.json \\ \"https://warehouse-visionai.googleapis.com/v1/projects/PROJECT_NUMBER/locations/LOCATION_ID/indexEndpoints\"\n``` **Note:** The following command assumes that you have logged in to  the`gcloud`CLI with your user account by running [gcloud init](/sdk/gcloud/reference/init) or [gcloud auth login](/sdk/gcloud/reference/auth/login) ,  or by using [Cloud Shell](/shell/docs) ,  which automatically logs you into the`gcloud`CLI.  You can check the currently active account by running [gcloud auth list](/sdk/gcloud/reference/auth/list) .\nSave the request body in a file named `request.json` ,  and execute the following command:\n```\n$cred = gcloud auth print-access-token$headers = @{ \"Authorization\" = \"Bearer $cred\" }Invoke-WebRequest ` -Method POST ` -Headers $headers ` -ContentType: \"application/json; charset=utf-8\" ` -InFile request.json ` -Uri \"https://warehouse-visionai.googleapis.com/v1/projects/PROJECT_NUMBER/locations/LOCATION_ID/indexEndpoints\" | Select-Object -Expand Content\n```\nYou should receive a JSON response similar to the following:\n```\n{\n \"name\": \"projects/PROJECT_NUMBER/locations/LOCATION_ID/indexEndpoints/INDEX_ENDPOINT_ID/operations/OPERATION_ID\",\n \"metadata\": {\n \"@type\": \"type.googleapis.com/google.cloud.visionai.v1.CreateIndexEndpointMetadata\"\n }\n}\n```\nThis example shows you how to deploy an index to an index endpoint.\nBefore using any of the request data, make the following replacements:- : Endpoint might include a prefix matching the`LOCATION_ID`such as`europe-west4-`. See more about [ regionalized endpoints](/vision-ai/docs/warehouse-supported-regions) .\n- : Your Google Cloud [project number](/resource-manager/docs/creating-managing-projects#identifying_projects) .\n- : The [region](/about/locations) where you are using Vertex AI Vision. For example:`us-central1`,`europe-west4`. See [available regions](/vision-ai/docs/warehouse-supported-regions) .\n- : The ID of your target index endpoint.\n- : The ID of your target corpus.\n- : The ID of your target index.\nHTTP method and URL:\n```\nPOST https://warehouse-visionai.googleapis.com/v1/projects/PROJECT_NUMBER/locations/LOCATION_ID/indexEndpoints/INDEX_ENDPOINT_ID:deployIndex\n```\nRequest JSON body:\n```\n{\n \"deployedIndex\": {\n \"index\": \"projects/PROJECT_NUMBER/locations/LOCATION_ID/corpora/CORPUS_ID/indexes/INDEX_ID\"\n }\n}\n```\nTo send your request, choose one of these options:\n **Note:** The following command assumes that you have logged in to  the`gcloud`CLI with your user account by running [gcloud init](/sdk/gcloud/reference/init) or [gcloud auth login](/sdk/gcloud/reference/auth/login) ,  or by using [Cloud Shell](/shell/docs) ,  which automatically logs you into the`gcloud`CLI.  You can check the currently active account by running [gcloud auth list](/sdk/gcloud/reference/auth/list) .\nSave the request body in a file named `request.json` ,  and execute the following command:\n```\ncurl -X POST \\ -H \"Authorization: Bearer $(gcloud auth print-access-token)\" \\ -H \"Content-Type: application/json; charset=utf-8\" \\ -d @request.json \\ \"https://warehouse-visionai.googleapis.com/v1/projects/PROJECT_NUMBER/locations/LOCATION_ID/indexEndpoints/INDEX_ENDPOINT_ID:deployIndex\"\n``` **Note:** The following command assumes that you have logged in to  the`gcloud`CLI with your user account by running [gcloud init](/sdk/gcloud/reference/init) or [gcloud auth login](/sdk/gcloud/reference/auth/login) ,  or by using [Cloud Shell](/shell/docs) ,  which automatically logs you into the`gcloud`CLI.  You can check the currently active account by running [gcloud auth list](/sdk/gcloud/reference/auth/list) .\nSave the request body in a file named `request.json` ,  and execute the following command:\n```\n$cred = gcloud auth print-access-token$headers = @{ \"Authorization\" = \"Bearer $cred\" }Invoke-WebRequest ` -Method POST ` -Headers $headers ` -ContentType: \"application/json; charset=utf-8\" ` -InFile request.json ` -Uri \"https://warehouse-visionai.googleapis.com/v1/projects/PROJECT_NUMBER/locations/LOCATION_ID/indexEndpoints/INDEX_ENDPOINT_ID:deployIndex\" | Select-Object -Expand Content\n```\nYou should receive a JSON response similar to the following:\n```\n{\n \"name\": \"projects/PROJECT_NUMBER/locations/LOCATION_ID/indexEndpoints/INDEX_ENDPOINT_ID/operations/OPERATION_ID\",\n \"metadata\": {\n \"@type\": \"type.googleapis.com/google.cloud.visionai.v1.DeployIndexMetadata\",\n \"deployedIndex\": \"projects/PROJECT_NUMBER/locations/LOCATION_ID/corpora/CORPUS_ID/indexes/INDEX_ID\"\n }\n}\n```\n**Note:** Creating an index endpoint or deploying an index are long-running operations. You can use the [projects.locations.indexEndpoints.operations.get](/vision-ai/docs/reference/rest/v1/projects.locations.indexEndpoints.operations/get) method to poll operation status.\n## Streaming update assets in index\nYou can use the `IndexAsset` or `RemoveIndexAsset` methods to update or remove a single asset in a deployed index. Streaming update lets you update and search the index in a short time.\nThis example shows you how to update an asset in index.\nBefore using any of the request data, make the following replacements:- : Endpoint might include a prefix matching the`LOCATION_ID`such as`europe-west4-`. See more about [ regionalized endpoints](/vision-ai/docs/warehouse-supported-regions) .\n- : Your Google Cloud [project number](/resource-manager/docs/creating-managing-projects#identifying_projects) .\n- : The [region](/about/locations) where you are using Vertex AI Vision. For example:`us-central1`,`europe-west4`. See [available regions](/vision-ai/docs/warehouse-supported-regions) .\n- : The ID of your target corpus.\n- : The ID of your target asset.\nHTTP method and URL:\n```\nPOST https://warehouse-visionai.googleapis.com/v1/projects/PROJECT_NUMBER/locations/LOCATION_ID/corpora/CORPUS_ID/assets/ASSET_ID:index\n```\nRequest JSON body:\n```\n{\n \"index\": \"projects/PROJECT_NUMBER/locations/LOCATION_ID/corpora/CORPUS_ID/indexes/INDEX_ID\"\n}\n```\nTo send your request, choose one of these options:\n **Note:** The following command assumes that you have logged in to  the`gcloud`CLI with your user account by running [gcloud init](/sdk/gcloud/reference/init) or [gcloud auth login](/sdk/gcloud/reference/auth/login) ,  or by using [Cloud Shell](/shell/docs) ,  which automatically logs you into the`gcloud`CLI.  You can check the currently active account by running [gcloud auth list](/sdk/gcloud/reference/auth/list) .\nSave the request body in a file named `request.json` ,  and execute the following command:\n```\ncurl -X POST \\ -H \"Authorization: Bearer $(gcloud auth print-access-token)\" \\ -H \"Content-Type: application/json; charset=utf-8\" \\ -d @request.json \\ \"https://warehouse-visionai.googleapis.com/v1/projects/PROJECT_NUMBER/locations/LOCATION_ID/corpora/CORPUS_ID/assets/ASSET_ID:index\"\n``` **Note:** The following command assumes that you have logged in to  the`gcloud`CLI with your user account by running [gcloud init](/sdk/gcloud/reference/init) or [gcloud auth login](/sdk/gcloud/reference/auth/login) ,  or by using [Cloud Shell](/shell/docs) ,  which automatically logs you into the`gcloud`CLI.  You can check the currently active account by running [gcloud auth list](/sdk/gcloud/reference/auth/list) .\nSave the request body in a file named `request.json` ,  and execute the following command:\n```\n$cred = gcloud auth print-access-token$headers = @{ \"Authorization\" = \"Bearer $cred\" }Invoke-WebRequest ` -Method POST ` -Headers $headers ` -ContentType: \"application/json; charset=utf-8\" ` -InFile request.json ` -Uri \"https://warehouse-visionai.googleapis.com/v1/projects/PROJECT_NUMBER/locations/LOCATION_ID/corpora/CORPUS_ID/assets/ASSET_ID:index\" | Select-Object -Expand Content\n```\nYou should receive a JSON response similar to the following:\n```\n{\n \"name\": \"projects/PROJECT_NUMBER/locations/LOCATION_ID/corpora/CORPUS_ID/assets/ASSET_ID/operations/OPERATION_ID\",\n}\n```\nThis example shows you how to remove an asset from index.\nBefore using any of the request data, make the following replacements:- : Endpoint might include a prefix matching the`LOCATION_ID`such as`europe-west4-`. See more about [ regionalized endpoints](/vision-ai/docs/warehouse-supported-regions) .\n- : Your Google Cloud [project number](/resource-manager/docs/creating-managing-projects#identifying_projects) .\n- : The [region](/about/locations) where you are using Vertex AI Vision. For example:`us-central1`,`europe-west4`. See [available regions](/vision-ai/docs/warehouse-supported-regions) .\n- : The ID of your target corpus.\n- : The ID of your target asset.\nHTTP method and URL:\n```\nPOST https://warehouse-visionai.googleapis.com/v1/projects/PROJECT_NUMBER/locations/LOCATION_ID/corpora/CORPUS_ID/assets/ASSET_ID:removeIndex\n```\nRequest JSON body:\n```\n{\n \"index\": \"projects/PROJECT_NUMBER/locations/LOCATION_ID/corpora/CORPUS_ID/indexes/INDEX_ID\"\n}\n```\nTo send your request, choose one of these options:\n **Note:** The following command assumes that you have logged in to  the`gcloud`CLI with your user account by running [gcloud init](/sdk/gcloud/reference/init) or [gcloud auth login](/sdk/gcloud/reference/auth/login) ,  or by using [Cloud Shell](/shell/docs) ,  which automatically logs you into the`gcloud`CLI.  You can check the currently active account by running [gcloud auth list](/sdk/gcloud/reference/auth/list) .\nSave the request body in a file named `request.json` ,  and execute the following command:\n```\ncurl -X POST \\ -H \"Authorization: Bearer $(gcloud auth print-access-token)\" \\ -H \"Content-Type: application/json; charset=utf-8\" \\ -d @request.json \\ \"https://warehouse-visionai.googleapis.com/v1/projects/PROJECT_NUMBER/locations/LOCATION_ID/corpora/CORPUS_ID/assets/ASSET_ID:removeIndex\"\n``` **Note:** The following command assumes that you have logged in to  the`gcloud`CLI with your user account by running [gcloud init](/sdk/gcloud/reference/init) or [gcloud auth login](/sdk/gcloud/reference/auth/login) ,  or by using [Cloud Shell](/shell/docs) ,  which automatically logs you into the`gcloud`CLI.  You can check the currently active account by running [gcloud auth list](/sdk/gcloud/reference/auth/list) .\nSave the request body in a file named `request.json` ,  and execute the following command:\n```\n$cred = gcloud auth print-access-token$headers = @{ \"Authorization\" = \"Bearer $cred\" }Invoke-WebRequest ` -Method POST ` -Headers $headers ` -ContentType: \"application/json; charset=utf-8\" ` -InFile request.json ` -Uri \"https://warehouse-visionai.googleapis.com/v1/projects/PROJECT_NUMBER/locations/LOCATION_ID/corpora/CORPUS_ID/assets/ASSET_ID:removeIndex\" | Select-Object -Expand Content\n```\nYou should receive a JSON response similar to the following:\n```\n{\n \"name\": \"projects/PROJECT_NUMBER/locations/LOCATION_ID/corpora/CORPUS_ID/assets/ASSET_ID/operations/OPERATION_ID\",\n}\n```\n## What's next\n- Learn how to [search](/vision-ai/docs/batch-video-warehouse-search) in Batch Video Warehouse.", "guide": "Vertex AI Vision"}