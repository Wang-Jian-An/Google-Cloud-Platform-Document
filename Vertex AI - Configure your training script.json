{"title": "Vertex AI - Configure your training script", "url": "https://cloud.google.com/vertex-ai/docs/start/introduction-unified-platform", "abstract": "# Vertex AI - Configure your training script\nYour training script must be configured to write TensorBoard logs. For existing TensorBoard users, this requires no change to your model training code.\nTo configure your training script in TensorFlow 2.x, create a TensorBoard callback and set the `log_dir` variable to any location which can connect to Google Cloud.\nThe TensorBoard callback is then included in the TensorFlow `model.fit` callbacks list.\n```\nimport tensorflow as tfdef train_tensorflow_model_with_tensorboard(log_dir):\u00a0 \u00a0 (x_train, y_train), (x_test, y_test) = tf.keras.datasets.mnist.load_data()\u00a0 \u00a0 x_train, x_test = x_train / 255.0, x_test / 255.0\u00a0 \u00a0 def create_model():\u00a0 \u00a0 \u00a0 \u00a0 return tf.keras.models.Sequential(\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 [\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 tf.keras.layers.Flatten(input_shape=(28, 28)),\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 tf.keras.layers.Dense(512, activation=\"relu\"),\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 ]\u00a0 \u00a0 \u00a0 \u00a0 )\u00a0 \u00a0 model = create_model()\u00a0 \u00a0 model.compile(\u00a0 \u00a0 \u00a0 \u00a0 optimizer=\"adam\",\u00a0 \u00a0 \u00a0 \u00a0 loss=\"sparse_categorical_crossentropy\",\u00a0 \u00a0 \u00a0 \u00a0 metrics=[\"accuracy\"]\u00a0 \u00a0 )\u00a0 \u00a0 tensorboard_callback = tf.keras.callbacks.TensorBoard(\u00a0 \u00a0 \u00a0 \u00a0 log_dir=log_dir,\u00a0 \u00a0 \u00a0 \u00a0 histogram_freq=1\u00a0 \u00a0 )\u00a0 \u00a0 model.fit(\u00a0 \u00a0 \u00a0 \u00a0 x=x_train,\u00a0 \u00a0 \u00a0 \u00a0 y=y_train,\u00a0 \u00a0 \u00a0 \u00a0 epochs=5,\u00a0 \u00a0 \u00a0 \u00a0 validation_data=(x_test, y_test),\u00a0 \u00a0 \u00a0 \u00a0 callbacks=[tensorboard_callback],\u00a0 \u00a0 )\n```\nThe TensorBoard logs are created in the specified directory and can be uploaded to a Vertex AI TensorBoard experiment by following the [Upload TensorBoard Logs](/vertex-ai/docs/experiments/tensorboard-upload-existing-logs#one-time-logging) instructions for uploading.\nFor more examples, see the [TensorBoard open source docs](https://www.tensorflow.org/tensorboard/get_started)\n", "content": "## What's next\n- Check out automatic log streaming- [Train using a custom training job](/vertex-ai/docs/experiments/tensorboard-training) \n- [Train using Vertex AI Pipelines](/vertex-ai/docs/experiments/tensorboard-with-pipelines)", "guide": "Vertex AI"}