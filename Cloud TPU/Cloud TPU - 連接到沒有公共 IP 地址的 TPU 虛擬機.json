{"title": "Cloud TPU - \u9023\u63a5\u5230\u6c92\u6709\u516c\u5171 IP \u5730\u5740\u7684 TPU \u865b\u64ec\u6a5f", "url": "https://cloud.google.com/tpu/docs/tpu-iap?hl=zh-cn", "abstract": "# Cloud TPU - \u9023\u63a5\u5230\u6c92\u6709\u516c\u5171 IP \u5730\u5740\u7684 TPU \u865b\u64ec\u6a5f\n# \u9023\u63a5\u5230\u6c92\u6709\u516c\u5171 IP \u5730\u5740\u7684 TPU \u865b\u64ec\u6a5f\n\u5982\u679c\u60a8\u7684\u7d44\u7e54\u5177\u6709 `constraints/compute.vmExternalIpAccess` \u7d44\u7e54\u653f\u7b56\u9650\u5236\u689d\u4ef6\uff0c\u60a8\u9700\u8981\u5275\u5efa\u6c92\u6709\u5916\u90e8 IP \u5730\u5740\u7684 TPU \u865b\u64ec\u6a5f\u3002\u5982\u9700\u9023\u63a5\u5230\u6c92\u6709\u5916\u90e8 IP \u5730\u5740\u7684 TPU \u865b\u64ec\u6a5f\uff0c\u60a8\u9700\u8981\u57f7\u884c\u4ee5\u4e0b\u64cd\u4f5c\uff1a\n- \u7232\u5c07\u5728\u5176\u4e2d\u5275\u5efa TPU \u865b\u64ec\u6a5f\u7684\u5b50\u7db2\u5553\u7528 [\u5c08\u7528 Google \u8a2a\u554f\u901a\u9053](https://cloud.google.com/vpc/docs/private-google-access?hl=zh-cn) \u3002\n- \u5c07`roles/iap.tunnelResourceAccessor`\u548c`roles/tpu.admin`\u6388\u4e88\u5c07\u8981\u9023\u63a5\u5230 TPU \u865b\u64ec\u6a5f\u7684\u7528\u6236\u3002\n- \u5275\u5efa\u6c92\u6709\u516c\u5171 IP \u5730\u5740\u7684 TPU \u865b\u64ec\u6a5f\u3002\n- \u4f7f\u7528`--tunnel-through-iap`\u901a\u904e SSH \u9023\u63a5\u5230\u60a8\u7684 TPU \u865b\u64ec\u6a5f\u3002", "content": "## \u5553\u7528\u5c08\u7528\u670d\u52d9\u8a2a\u554f\u901a\u9053\n\u5982\u9700\u4f7f\u7528 IAP\uff0c\u60a8\u5fc5\u9808\u5553\u7528\u5c08\u7528 Google \u8a2a\u554f\u901a\u9053\uff0c\u624d\u80fd\u9023\u63a5\u5230\u6c92\u6709\u5916\u90e8 IP \u5730\u5740\u7684\u865b\u64ec\u6a5f\u3002\u5728\u4ee5\u4e0b\u547d\u4ee4\u4e2d\uff0c\u5c07 \u66ff\u63db\u7232\u60a8\u5c07\u5728\u5176\u4e2d\u5275\u5efa TPU \u865b\u64ec\u6a5f\u7684\u5b50\u7db2\u7684\u540d\u7a31\uff0c\u4e26\u5c07 \u66ff\u63db\u7232 TPU \u865b\u64ec\u6a5f\u6240\u5728\u7684\u5340\u57df\u3002\n```\ngcloud compute networks subnets update your-subnet \\--region=your-region \\--enable-private-ip-google-access\n```\n## \u6388\u4e88\u6b0a\u9650\n\u5982\u679c\u7528\u6236\u9700\u8981\u901a\u904e SSH \u9023\u63a5\u5230\u6c92\u6709\u516c\u5171 IP \u5730\u5740\u7684 TPU \u865b\u64ec\u6a5f\uff0c\u5247\u5fc5\u9808\u7372\u5f97 iap.tunnelResourceAccessor \u89d2\u8272\u3002\u5982\u9700\u8a73\u7d30\u77ad\u89e3\u5982\u4f55\u6388\u4e88\u89d2\u8272\uff0c\u8acb\u53c3\u95b1 [\u6388\u4e88 IAM \u89d2\u8272](https://cloud.google.com/iam/docs/granting-changing-revoking-access?hl=zh-cn#grant-single-role) \u3002\n## \u5275\u5efa\u6c92\u6709\u516c\u5171 IP \u5730\u5740\u7684 TPU \u865b\u64ec\u6a5f\n\u4ee5\u4e0b\u547d\u4ee4\u5c55\u793a\u77ad\u5982\u4f55\u5275\u5efa\u6c92\u6709\u516c\u5171 IP \u5730\u5740\u7684 TPU \u865b\u64ec\u6a5f\u3002\n```\ngcloud compute tpus tpu-vm create tpu-vm-name \\\u00a0 --zone $ZONE \\\u00a0 --project your-project \\\u00a0 --internal-ips \\\u00a0 --version tpu-vm-tf-2.16.1-pjrt \\\u00a0 --accelerator-type v2-8 \\\u00a0 --subnetwork your-subnet \\\n```\n## \u4f7f\u7528 IAP \u96a7\u9053\u901a\u904e SSH \u9023\u63a5\u5230\u60a8\u7684 TPU \u865b\u64ec\u6a5f\n\u4ee5\u4e0b\u547d\u4ee4\u5c55\u793a\u77ad\u5982\u4f55\u4f7f\u7528 IAP \u96a7\u9053\u901a\u904e SSH \u9023\u63a5\u5230 TPU \u865b\u64ec\u6a5f\u3002\n```\ngcloud alpha compute tpus tpu-vm ssh tpu-vm-name --tunnel-through-iap\n```", "guide": "Cloud TPU"}