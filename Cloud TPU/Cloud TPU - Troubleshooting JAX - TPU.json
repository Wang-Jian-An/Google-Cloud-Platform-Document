{"title": "Cloud TPU - Troubleshooting JAX - TPU", "url": "https://cloud.google.com/tpu/docs/troubleshooting/trouble-jax", "abstract": "# Cloud TPU - Troubleshooting JAX - TPU\n# Troubleshooting JAX - TPU\nThis guide provides pointers to JAX troubleshooting information to help you identify and resolve problems you might encounter while training JAX models on Cloud TPU.\nFor a more general guide to getting started with Cloud TPU, see the [JAX quickstart](/tpu/docs/run-calculation-jax) .\n**Note:** If you aren't able to resolve your issue using this guide, see [Getting Support](/tpu/docs/getting-support) for further assistance.\n", "content": "## General JAX issues\nIf you run into issues while developing your training model or training with JAX, see the [JAX FAQ.](https://jax.readthedocs.io/en/latest/faq.html)\nFor more general programming errors you might encounter when writing a training application with JAX, see [JAX Errors.](https://jax.readthedocs.io/en/latest/errors.html)\n## Profiling JAX performance\nYou can understand how your TPU resources are being utilized using the tools described in [Profiling JAX performance.](https://jax.readthedocs.io/en/latest/profiling.html)\n## Troubleshooting memory issues\n**Note:** TPU memory ( [high bandwidth memory](/tpu/docs/system-architecture-tpu-vm#versions) is shared across each TPU chip. This enables efficient coordination between the two on-chip TensorCores.\nYou can monitor how the memory is used with the [JAX Device Memory Profiler](https://jax.readthedocs.io/en/latest/device_memory_profiling.html) , but you cannot directly manage how it is used.\nThe Device Memory Profiler can be used to:\n- Figure out [which arrays and executables are in TPU memory](https://jax.readthedocs.io/en/latest/device_memory_profiling.html#understanding-how-a-jax-program-is-using-gpu-or-tpu-memory) at a given time, or\n- [Track down memory leaks.](https://jax.readthedocs.io/en/latest/device_memory_profiling.html#debugging-memory-leaks) \nYou cannot specify how TPU memory is allocated for specific operations. For more information on JAX-specific TPU performance issues, see [Performance Notes for using TPUs with JAX](/tpu/docs/run-calculation-jax#performance_notes) .\n## Troubleshooting TPU issues\n### How can I verify that the TPU is running?\n**Details**\nEverything will be run on the TPU as long as JAX doesn't print \"No GPU/TPU found, falling back to CPU.\"\nYou can verify the TPU is active by either looking at `jax.devices()` , where you should see several TPU devices displayed, or verify programmatically with: `assert jax.devices()[0].platform == 'tpu'` .\n### RuntimeError: Unable to initialize backend 'tpu': UNAVAILABLE: No TPU Platform available.\n**Details**\nThis runtime error message and/or finding the following in `/tmp/tpu_logs/tpu_driver.WARNING` on the TPU VM: `W1118 17:40:20.985243 23901 tpu_version_flag.cc:57] No hardware is found. Using default TPU version:xxxxxx` can indicate that you are running the wrong TPU VM version.\nVerify that you are running the [current JAX runtime version](/tpu/docs/supported-tpu-versions#jax) and retry.", "guide": "Cloud TPU"}