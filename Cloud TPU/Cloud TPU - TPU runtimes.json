{"title": "Cloud TPU - TPU runtimes", "url": "https://cloud.google.com/tpu/docs/runtimes?hl=zh-cn", "abstract": "# Cloud TPU - TPU runtimes\n# TPU runtimes\nThis document provides guidance on selecting the appropriate runtime version for your Cloud TPU, depending on the framework and TPU architecture (VM or Node) you use.\n", "content": "## TPU VM runtime versions\nThis section describes the TPU software versions you should use for a TPU with the [TPU VM](/tpu/docs/system-architecture-tpu-vm#tpu-vm-arch) architecture. For the [TPUNode](/tpu/docs/system-architecture-tpu-vm#tpu-node-arch) architecture, see [TPU Node software versions](#tpu-node-versions) .\nTPU software versions are available for TensorFlow, PyTorch, and JAX frameworks.\n### TensorFlow\nUse the TPU software version that matches the version of TensorFlow with which your model was written.\nBeginning with TensorFlow 2.15.0, you must also specify either the stream executor (SE) runtime or the PJRT runtime. For example, if you are using TensorFlow 2.16.1 with the PJRT runtime, use the `tpu-vm-tf-2.16.1-pjrt` TPU software version. Versions prior to TensorFlow 2.15.0 only support stream executor. For more information about PJRT, see [TensorFlow PJRT support](#tf-pjrt-support) .\nThe current supported TensorFlow TPU VM software versions are:\n- tpu-vm-tf-2.16.1-pjrt\n- tpu-vm-tf-2.16.1-se\n- tpu-vm-tf-2.15.0-pjrt\n- tpu-vm-tf-2.15.0-se\n- tpu-vm-tf-2.14.1\n- tpu-vm-tf-2.14.0\n- tpu-vm-tf-2.13.1\n- tpu-vm-tf-2.13.0\n- tpu-vm-tf-2.12.1\n- tpu-vm-tf-2.12.0\n- tpu-vm-tf-2.11.1\n- tpu-vm-tf-2.11.0\n- tpu-vm-tf-2.10.1\n- tpu-vm-tf-2.10.0\n- tpu-vm-tf-2.9.3\n- tpu-vm-tf-2.9.1\n- tpu-vm-tf-2.8.4\n- tpu-vm-tf-2.8.3\n- tpu-vm-tf-2.8.0\n- tpu-vm-tf-2.7.4\n- tpu-vm-tf-2.7.3\n**Note:** If you're using TensorFlow 2.10.0 or earlier on TPU v4, you must use [v4-specific TensorFlow versions](#tf-2-10-0-and-earlier-v4) .\n**Note:** If you are using a Pod slice, append `-pod` after the TensorFlow version number. For example, `tpu-vm-tf-2.16.1-pod-pjrt` .\nFor more information on TensorFlow patch versions, see [SupportedTensorFlow patch versions](/tpu/docs/supported-versions) .\nBeginning with TensorFlow 2.15.0, you can use the PJRT interface for TensorFlow on TPU. PJRT features automatic device memory defragmentation and simplifies the integration of hardware with frameworks. For more information about PJRT, see [PJRT: Simplifying ML Hardware and FrameworkIntegration](https://opensource.googleblog.com/2023/05/pjrt-simplifying-ml-hardware-and-framework-integration.html) on the Google Open Source Blog.\n**Important:** TPU v5e and future TPU generations only support PJRT. PJRT is only supported on the TPU VM architecture.\nNot all features of TPU v2, v3, and v4 have been migrated to the PJRT runtime. The following table describes which features are supported on PJRT or steam executor.\n| Accelerator | Feature          | Supported on PJRT        | Supported on stream executor |\n|:--------------|:-----------------------------------------------|:------------------------------------------------|:-------------------------------|\n| TPU v2-v4  | Dense compute (no TPU embedding API)   | Yes            | Yes       |\n| TPU v2-v4  | Dense compute API + TPU embedding API   | No            | Yes       |\n| TPU v2-v4  | tf.summary/tf.print with soft device placement | No            | Yes       |\n| TPU v5e  | Dense compute (no TPU embedding API)   | Yes            | No        |\n| TPU v5e  | TPU embedding API        | N/A - TPU v5e doesn't support TPU embedding API | nan       |\n| TPU v5p  | Dense compute (no TPU embedding API)   | Yes            | No        |\n| TPU v5p  | TPU embedding API        | Yes            | No        |\nIf you are training a model on TPU v4 with TensorFlow, TensorFlow versions 2.10.0 and earlier use `v4` -specific versions shown in the following table. If the TensorFlow version you're using is not shown in the table, follow the guidance in the [TensorFlow](#tensorflow-vm) section.\n| TensorFlow version | TPU software version       |\n|:---------------------|:---------------------------------------------|\n| 2.10.0    | tpu-vm-tf-2.10.0-v4, tpu-vm-tf-2.10.0-pod-v4 |\n| 2.9.3    | tpu-vm-tf-2.9.3-v4, tpu-vm-tf-2.9.3-pod-v4 |\n| 2.9.2    | tpu-vm-tf-2.9.2-v4, tpu-vm-tf-2.9.2-pod-v4 |\n| 2.9.1    | tpu-vm-tf-2.9.1-v4, tpu-vm-tf-2.9.1-pod-v4 |\nTPU VMs are created with TensorFlow and the corresponding Libtpu library preinstalled. If you are creating your own VM image, specify the following TensorFlow TPU software versions and corresponding `libtpu` versions:\n| TensorFlow version | libtpu.so version |\n|:---------------------|:--------------------|\n| 2.16.1    | 1.10.1    |\n| 2.15.0    | 1.9.0    |\n| 2.14.1    | 1.8.1    |\n| 2.14.0    | 1.8.0    |\n| 2.13.1    | 1.7.1    |\n| 2.13.0    | 1.7.0    |\n| 2.12.1    | 1.6.1    |\n| 2.12.0    | 1.6.0    |\n| 2.11.1    | 1.5.1    |\n| 2.11.0    | 1.5.0    |\n| 2.10.1    | 1.4.1    |\n| 2.10.0    | 1.4.0    |\n| 2.9.3    | 1.3.2    |\n| 2.9.1    | 1.3.0    |\n| 2.8.3    | 1.2.3    |\n| 2.8.*    | 1.2.0    |\n| 2.7.3    | 1.1.2    |\n### PyTorch\nUse the TPU software version that matches the version of PyTorch with which your model was written. For example, if you are using PyTorch 1.13 and TPU v2 or v3, use the `tpu-vm-pt-1.13` TPU software version. If you are using TPU v4 use the `tpu-vm-v4-pt-1.13` TPU software version. The same TPU software version is used for TPU Pods (for example, `v2-32` , `v3-128` , `v4-32` ). The current supported TPU software versions are:- tpu-vm-pt-2.0 (pytorch-2.0)\n- tpu-vm-pt-1.13 (pytorch-1.13)\n- tpu-vm-pt-1.12 (pytorch-1.12)\n- tpu-vm-pt-1.11 (pytorch-1.11)\n- tpu-vm-pt-1.10 (pytorch-1.10)\n- v2-alpha (pytorch-1.8.1)- tpu-vm-v4-pt-2.0 (pytorch-2.0)\n- tpu-vm-v4-pt-1.13 (pytorch-1.13)- v2-alpha-tpuv5 (pytorch-2.0)\nWhen you create a TPU VM, the latest version of PyTorch is preinstalled on the TPU VM. The correct version of libtpu.so is automatically installed when you install PyTorch.\nTo change the current PyTorch software version, see [Changing PyTorch version](/tpu/docs/pytorch-xla-ug-tpu-vm#changing_pytorch_version) .\n### JAX\nYou must manually install JAX on your TPU VM. There is no JAX-specific TPU software (runtime) version for TPU v2 and v3. For later TPU versions, use the following software versions:\n- TPU v4: tpu-vm-v4-base\n- TPU v5e: v2-alpha-tpuv5\n- TPU v5p: v2-alpha-tpuv5\nThe correct version of libtpu.so is automatically installed when you install JAX.\n## TPU Node runtime versions\nThis section describes the TPU software versions you should use for a TPU with the [TPU Node](/tpu/docs/system-architecture-tpu-vm#tpu-node-arch) architecture. For the [TPUVM](/tpu/docs/system-architecture-tpu-vm#tpu-vm-arch) architecture, see [TPU VM softwareversions](#tpu-vm-versions) .\nTPU software versions are available for TensorFlow, PyTorch, and JAX frameworks.\n### TensorFlow\nUse the TPU software version that matches the version of TensorFlow with which your model was written. For example, if you are using TensorFlow 2.12.0, use the `2.12.0` TPU software version. The TensorFlow specific TPU software versions are:\n- 2.12.1\n- 2.12.0\n- 2.11.1\n- 2.11.0\n- 2.10.1\n- 2.10.0\n- 2.9.3\n- 2.9.1\n- 2.8.4\n- 2.8.2\n- 2.7.3\nFor more information on TensorFlow patch versions, see [SupportedTensorFlow patch versions](/tpu/docs/supported-patches) .\nWhen you create a TPU Node, the latest version of TensorFlow is preinstalled on the TPU Node.\n### PyTorch\nUse the TPU software version that matches the version of PyTorch with which your model was written. For example, if you are using PyTorch 1.9, use the `pytorch-1.9` software version.\nThe PyTorch specific TPU software versions are:\n- pytorch-2.0\n- pytorch-1.13\n- pytorch-1.12\n- pytorch-1.11\n- pytorch-1.10\n- pytorch-1.9\n- pytorch-1.8\n- pytorch-1.7\n- pytorch-1.6\n- pytorch-nightly\nWhen you create a TPU Node, the latest version of PyTorch is preinstalled on the TPU Node.\n### JAX\nYou must manually install JAX on your TPU VM, so there is no pre-installed JAX-specific TPU software version. You can use any of the software versions listed for TensorFlow.\n## What's next\n- Learn more about TPU architecture in the [SystemArchitecture](/tpu/docs/system-architecture-tpu-vm) page.\n- See [When to use TPUs](/tpu/docs/tpus#when_to_use_tpus) to learn about the types of models that are well suited to Cloud TPU.", "guide": "Cloud TPU"}