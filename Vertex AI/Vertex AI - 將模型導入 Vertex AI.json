{"title": "Vertex AI - \u5c07\u6a21\u578b\u5c0e\u5165 Vertex AI", "url": "https://cloud.google.com/vertex-ai/docs/model-registry/import-model?hl=zh-cn", "abstract": "# Vertex AI - \u5c07\u6a21\u578b\u5c0e\u5165 Vertex AI\n\u672c\u6307\u5357\u4ecb\u7d39\u5982\u4f55\u5c07\u6a21\u578b\u5c0e\u5165 Model Registry\u3002\u5c0e\u5165\u6a21\u578b\u5f8c\uff0c\u5b83\u5011\u4fbf\u6703\u986f\u793a\u5728 Model Registry \u4e2d\u3002\u5f9e Model Registry \u4e2d\uff0c\u60a8\u53ef\u4ee5\u5c07\u5c0e\u5165\u7684\u6a21\u578b\u90e8\u7f72\u5230\u7aef\u9ede\u4e26\u904b\u884c\u9810\u6e2c\u3002\n", "content": "## \u6240\u9700\u7684\u89d2\u8272\n\u5982\u9700\u7372\u5f97\u5c0e\u5165\u6a21\u578b\u6240\u9700\u7684\u6b0a\u9650\uff0c\u8acb\u8b93\u7ba1\u7406\u54e1\u5411\u60a8\u6388\u4e88\u9805\u76ee\u7684 [Vertex AI User](https://cloud.google.com/iam/docs/understanding-roles?hl=zh-cn#aiplatform.user) ( `roles/aiplatform.user` ) IAM \u89d2\u8272\u3002\u5982\u9700\u8a73\u7d30\u77ad\u89e3\u5982\u4f55\u6388\u4e88\u89d2\u8272\uff0c\u8acb\u53c3\u95b1 [\u7ba1\u7406\u8a2a\u554f\u6b0a\u9650](https://cloud.google.com/iam/docs/granting-changing-revoking-access?hl=zh-cn) \u3002\n\u60a8\u4e5f\u53ef\u4ee5\u901a\u904e [\u81ea\u5b9a\u7fa9\u89d2\u8272](https://cloud.google.com/iam/docs/creating-custom-roles?hl=zh-cn) \u6216\u5176\u4ed6 [\u9810\u5b9a\u7fa9\u89d2\u8272](https://cloud.google.com/iam/docs/understanding-roles?hl=zh-cn) \u4f86\u7372\u53d6\u6240\u9700\u7684\u6b0a\u9650\u3002\n## \u9810\u69cb\u5efa\u6216\u81ea\u5b9a\u7fa9\u5bb9\u5668\n\u5c0e\u5165\u6a21\u578b\u6642\uff0c\u60a8\u53ef\u4ee5\u5c07\u5176\u8207 Vertex AI \u76f8\u95dc\u806f\u4ee5\u904b\u884c\u9810\u6e2c\u8acb\u6c42\u3002\u60a8\u53ef\u4ee5\u4f7f\u7528 Vertex AI \u63d0\u4f9b\u7684 [\u9810\u69cb\u5efa\u5bb9\u5668](https://cloud.google.com/vertex-ai/docs/predictions/pre-built-containers?hl=zh-cn) \uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528\u60a8\u81ea\u5df1\u69cb\u5efa\u4e26\u63a8\u9001\u5230 Artifact Registry \u7684 [\u81ea\u5b9a\u7fa9\u5bb9\u5668](https://cloud.google.com/vertex-ai/docs/predictions/use-custom-container?hl=zh-cn) \u3002\n\u5982\u679c\u60a8\u7684\u6a21\u578b\u7b26\u5408\u4ee5\u4e0b\u8981\u6c42\uff0c\u5247\u53ef\u4ee5\u4f7f\u7528\u9810\u69cb\u5efa\u5bb9\u5668\uff1a\n- \u5728 Python 3.7 \u6216\u66f4\u9ad8\u7248\u672c\u4e2d\u8a13\u7df4\n- \u4f7f\u7528 TensorFlow\u3001PyTorch\u3001scikit-learn \u6216 XGBoost \u8a13\u7df4\n- \u5c0e\u51fa\u4ee5\u6eff\u8db3 [\u67d0\u500b\u9810\u69cb\u5efa\u9810\u6e2c\u5bb9\u5668\u7684\u7279\u5b9a\u65bc\u6846\u67b6\u7684\u8981\u6c42](https://cloud.google.com/vertex-ai/docs/training/exporting-model-artifacts?hl=zh-cn#framework-specific_requirements) \n\u5982\u679c\u8981\u5c0e\u5165\u60a8\u4e4b\u524d [\u5c0e\u51fa](https://cloud.google.com/vertex-ai/docs/export/export-model-tabular?hl=zh-cn) \u7684\u8868\u683c AutoML \u6a21\u578b\uff0c\u5247\u5fc5\u9808\u4f7f\u7528 Vertex AI \u63d0\u4f9b\u7684\u7279\u5b9a\u81ea\u5b9a\u7fa9\u5bb9\u5668\u3002\n\u5426\u5247\uff0c\u8acb\u5275\u5efa\u65b0\u7684 [\u81ea\u5b9a\u7fa9\u5bb9\u5668](https://cloud.google.com/vertex-ai/docs/predictions/use-custom-container?hl=zh-cn) \uff0c\u6216\u4f7f\u7528 Artifact Registry \u4e2d\u7684\u73fe\u6709\u81ea\u5b9a\u7fa9\u5bb9\u5668\u3002\n## \u5c07\u6a21\u578b\u5de5\u4ef6\u4e0a\u50b3\u5230 Cloud Storage\n\u60a8\u5fc5\u9808\u5c07\u6a21\u578b\u5de5\u4ef6\u5b58\u5132\u5728 Cloud Storage \u5b58\u5132\u5206\u5340\u4e2d\uff0c\u5b58\u5132\u5206\u5340\u6240\u5728\u5340\u57df\u8207\u60a8\u4f7f\u7528\u7684\u5340\u57df\u7aef\u9ede\u4e00\u81f4\u3002\n\u5982\u679c\u60a8\u7684 Cloud Storage \u5b58\u5132\u6876\u4f4d\u65bc\u5176\u4ed6 Google Cloud \u9805\u76ee\u4e2d\uff0c\u5247\u9700\u8981 [\u6388\u4e88 Vertex AI \u8a2a\u554f\u6b0a\u9650](https://cloud.google.com/vertex-ai/docs/general/access-control?hl=zh-cn#different-project) \u4ee5\u8b80\u53d6\u6a21\u578b\u5de5\u4ef6\u3002\n\u5982\u679c\u60a8\u4f7f\u7528\u7684\u662f\u9810\u69cb\u5efa\u5bb9\u5668\uff0c\u8acb\u78ba\u4fdd\u6a21\u578b\u5de5\u4ef6\u7684\u6587\u4ef6\u540d\u8207\u4ee5\u4e0b\u793a\u4f8b\u5b8c\u5168\u5339\u914d\uff1a\n- TensorFlow SavedModel\uff1a`saved_model.pb`\n- PyTorch\uff1a`model.mar`\n- scikit-learn\uff1a`model.joblib`\u6216`model.pkl`\n- XGBoost\uff1a`model.bst`\u3001`model.joblib`\u6216`model.pkl`\n\u8a73\u7d30\u77ad\u89e3\u5982\u4f55 [\u5c0e\u51fa\u6a21\u578b\u5de5\u4ef6\u4ee5\u9032\u884c\u9810\u6e2c](https://cloud.google.com/vertex-ai/docs/training/exporting-model-artifacts?hl=zh-cn) \u3002\n## \u4f7f\u7528 Google Cloud \u63a7\u5236\u6aaf\u5c0e\u5165\u6a21\u578b\n\u5982\u9700\u4f7f\u7528 Google Cloud \u63a7\u5236\u6aaf\u5c0e\u5165\u6a21\u578b\uff0c\u8acb\u57f7\u884c\u4ee5\u4e0b\u64cd\u4f5c\uff1a\n- \u5728 Google Cloud \u63a7\u5236\u6aaf\u4e2d\uff0c\u8f49\u5230 Vertex AI **\u6a21\u578b** \u9801\u9762\u3002 [\u8f49\u5230\u201c\u6a21\u578b\u201d\u9801\u9762](https://console.cloud.google.com/vertex-ai/models?hl=zh-cn) \n- \u9ede\u64ca **\u5c0e\u5165** \u3002\n- \u9078\u64c7 **\u4f5c\u7232\u65b0\u6a21\u578b\u5c0e\u5165** \uff0c\u4ee5\u5c0e\u5165\u65b0\u6a21\u578b\u3002\n- \u9078\u64c7 **\u4f5c\u7232\u65b0\u7248\u672c\u5c0e\u5165** \uff0c\u4ee5\u5c07\u6a21\u578b\u4f5c\u7232\u73fe\u6709\u6a21\u578b\u7684\u4e00\u500b\u7248\u672c\u5c0e\u5165\u3002\u5982\u9700\u8a73\u7d30\u77ad\u89e3\u6a21\u578b\u7248\u672c\u63a7\u5236\uff0c\u8acb\u53c3\u95b1 [\u6a21\u578b\u7248\u672c\u63a7\u5236](https://cloud.google.com/vertex-ai/docs/model-registry/versioning?hl=zh-cn) \u3002\n- **\u540d\u7a31\u548c\u5340\u57df** \uff1a\u8f38\u5165\u6a21\u578b\u7684\u540d\u7a31\u3002\u9078\u64c7\u540c\u6642\u5339\u914d\u60a8\u7684\u5b58\u5132\u6876\u6240\u5728\u5340\u57df\u548c\u60a8\u4f7f\u7528\u7684 Vertex AI \u5340\u57df\u7aef\u9ede\u7684\u5340\u57df\u3002\u9ede\u64ca **\u7e7c\u7e8c** \u3002\n- \u5982\u679c\u60a8\u5c55\u958b **\u9ad8\u7d1a\u9078\u9805** \uff0c\u5247\u53ef\u4ee5\u9078\u64c7\u6dfb\u52a0 [\u5ba2\u6236\u7ba1\u7406\u7684\u52a0\u5bc6\u5bc6\u9470](https://cloud.google.com/vertex-ai/docs/general/cmek?hl=zh-cn) \u3002\n\u6839\u64da\u60a8\u4f7f\u7528\u7684\u5bb9\u5668\u985e\u578b\uff0c\u5728\u4e0b\u9762\u9078\u64c7\u76f8\u61c9\u7684\u6a19\u7c64\u3002\n- \u9078\u64c7 **\u5c07\u6a21\u578b\u5de5\u4ef6\u5c0e\u5165\u5230\u65b0\u7684\u9810\u69cb\u5efa\u5bb9\u5668\u4e2d** \u3002\n- \u9078\u64c7\u60a8\u7528\u65bc\u8a13\u7df4\u6a21\u578b\u7684 **\u6a21\u578b\u6846\u67b6** \u548c **\u6a21\u578b\u6846\u67b6\u7248\u672c** \u3002\n- \u5982\u679c\u8981\u4f7f\u7528 GPU \u57f7\u884c\u9810\u6e2c\uff0c\u8acb\u5c07 **\u52a0\u901f\u5668\u985e\u578b** \u8a2d\u7f6e\u7232 **GPU** \u3002\u7a0d\u5f8c\uff0c\u60a8\u5c07\u5728 [\u5c07\u6a21\u578b\u90e8\u7f72\u5230\u7aef\u9ede](https://cloud.google.com/vertex-ai/docs/predictions/deploy-model-console?hl=zh-cn) \u6642\u9078\u64c7 GPU \u985e\u578b\u3002\n- \u6307\u5b9a\u5305\u542b\u6a21\u578b\u5de5\u4ef6\u7684\u76ee\u9304\u7684 Cloud Storage \u8def\u5f91\u3002\u4f8b\u5982\uff1a `gs://` `` `/models/` \u3002\n- \u5c07 **\u9810\u6e2c\u67b6\u69cb** \u7559\u7a7a\u3002\n- \u82e5\u8981\u5c0e\u5165\u6c92\u6709 Vertex Explainable AI \u8a2d\u7f6e\u7684\u6a21\u578b\uff0c\u8acb\u9ede\u64ca **\u5c0e\u5165** \u3002\u5c0e\u5165\u5b8c\u6210\u5f8c\uff0c\u60a8\u7684\u6a21\u578b\u5c07\u986f\u793a\u5728 **\u6a21\u578b** \u9801\u9762\u4e0a\u3002\u5426\u5247\uff0c\u8acb\u5728 **\u53ef\u89e3\u91cb\u6027** \u6a19\u7c64\u9801\u4e2d\u8f38\u5165\u53ef\u89e3\u91cb\u6027\u8a2d\u7f6e\uff0c\u4ee5\u7e7c\u7e8c\u914d\u7f6e\u6a21\u578b\u3002\u8a73\u7d30\u77ad\u89e3 [\u53ef\u89e3\u91cb\u6027\u8a2d\u7f6e](https://cloud.google.com/vertex-ai/docs/explainable-ai/configuring-explanations?hl=zh-cn#import-model-example) \u3002\n- \u9078\u64c7 **\u5c0e\u5165\u73fe\u6709\u7684\u81ea\u5b9a\u7fa9\u5bb9\u5668** \u3002\n- \u8a2d\u7f6e\u5bb9\u5668\u6620\u50cf URI\u3002\n- \u5982\u679c [\u9664\u4e86\u5bb9\u5668\u6620\u50cf\u4e4b\u5916\uff0c\u60a8\u9084\u63d0\u4f9b\u6a21\u578b\u5de5\u4ef6](https://cloud.google.com/vertex-ai/docs/predictions/custom-container-requirements?hl=zh-cn#artifacts) \uff0c\u8acb\u6307\u5b9a\u5305\u542b\u6a21\u578b\u5de5\u4ef6\u7684\u76ee\u9304\u7684 Cloud Storage \u8def\u5f91\u3002\u4f8b\u5982 `gs://` `` `/models/` \u3002\n- \u7232\u4efb\u4f55\u5176\u4ed6\u5b57\u6bb5\u6307\u5b9a\u503c\u3002\u8a73\u7d30\u77ad\u89e3\u9019\u4e9b [\u53ef\u9078\u5b57\u6bb5](https://cloud.google.com/vertex-ai/docs/predictions/use-custom-container?hl=zh-cn#create-model) \u3002\n- \u82e5\u8981\u5c0e\u5165\u6c92\u6709 Vertex Explainable AI \u8a2d\u7f6e\u7684\u6a21\u578b\uff0c\u8acb\u9ede\u64ca **\u5c0e\u5165** \u3002\u5c0e\u5165\u5b8c\u6210\u5f8c\uff0c\u60a8\u7684\u6a21\u578b\u5c07\u986f\u793a\u5728 **\u6a21\u578b** \u9801\u9762\u4e0a\u3002\u5426\u5247\uff0c\u8acb\u5728 **\u53ef\u89e3\u91cb\u6027** \u6a19\u7c64\u9801\u4e2d\u8f38\u5165\u53ef\u89e3\u91cb\u6027\u8a2d\u7f6e\uff0c\u4ee5\u7e7c\u7e8c\u914d\u7f6e\u6a21\u578b\u3002\u8a73\u7d30\u77ad\u89e3 [\u53ef\u89e3\u91cb\u6027\u8a2d\u7f6e](https://cloud.google.com/vertex-ai/docs/explainable-ai/configuring-explanations?hl=zh-cn#import-model-example) \u3002\n- \u9078\u64c7 **\u5c0e\u5165\u73fe\u6709\u7684\u81ea\u5b9a\u7fa9\u5bb9\u5668** \u3002\n- \u5728 **\u5bb9\u5668\u6620\u50cf** \u5b57\u6bb5\u4e2d\uff0c\u8f38\u5165 `` `-docker.pkg.dev/vertex-ai/automl-tabular/prediction-server-v1:latest` \u3002\u5c07 `` \u66ff\u63db\u7232 `us` \u3001 `europe` \u6216 `asia` \uff0c\u7136\u5f8c\u9078\u64c7\u8981\u5f9e\u54ea\u500b Docker \u4ee3\u78bc\u5eab\u62c9\u53d6 Docker \u6620\u50cf\u3002\u6bcf\u500b\u4ee3\u78bc\u5eab\u90fd\u63d0\u4f9b\u76f8\u540c\u7684 Docker \u6620\u50cf\uff0c\u4f46\u9078\u64c7\u6700\u9760\u8fd1\u904b\u884c Docker \u7684\u6a5f\u5668\u7684 [Artifact Registry \u591a\u5340\u57df](https://cloud.google.com/artifact-registry/docs/repo-locations?hl=zh-cn#location-mr) \u53ef\u80fd\u6703\u7e2e\u77ed\u5ef6\u9072\u6642\u9593\u3002\n- \u5728 **\u8edf\u4ef6\u5305\u4f4d\u7f6e** \u5b57\u6bb5\u4e2d\uff0c\u6307\u5b9a\u5305\u542b\u6a21\u578b\u5de5\u4ef6\u7684\u76ee\u9304\u7684 Cloud Storage \u8def\u5f91\u3002\u8def\u5f91\u985e\u4f3c\u65bc\u4ee5\u4e0b\u793a\u4f8b\uff1a`gs://` `` `/models-` `` `/tf-saved-model/` `` `/`\n- \u5c07\u5176\u4ed6\u6240\u6709\u5b57\u6bb5\u7559\u7a7a\u3002\n- \u9ede\u64ca **\u5c0e\u5165** \u3002\u5c0e\u5165\u5b8c\u6210\u5f8c\uff0c\u60a8\u7684\u6a21\u578b\u5c07\u986f\u793a\u5728 **\u6a21\u578b** \u9801\u9762\u4e0a\u3002\u60a8\u53ef\u4ee5\u50cf\u4f7f\u7528\u5176\u4ed6 AutoML \u8868\u683c\u6a21\u578b\u90a3\u6a23\u4f7f\u7528\u6b64\u6a21\u578b\uff0c\u4f46\u5c0e\u5165\u7684 AutoML \u8868\u683c\u6a21\u578b\u4e0d\u652f\u6301 Vertex Explainable AI\u3002## \u4ee5\u7de8\u7a0b\u65b9\u5f0f\u5c0e\u5165\u6a21\u578b\n\u4ee5\u4e0b\u793a\u4f8b\u5c55\u793a\u77ad\u5982\u4f55\u4f7f\u7528\u5404\u7a2e\u5de5\u5177\u5c0e\u5165\u6a21\u578b\uff1a\n**\u8b66\u544a** \uff1a\u6bcf 2 \u79d2\u8abf\u7528 [UploadModel](https://cloud.google.com/vertex-ai/docs/reference/rest/v1/projects.locations.models/upload?hl=zh-cn) \u6216 [DeployModel](https://cloud.google.com/vertex-ai/docs/reference/rest/v1/projects.locations.endpoints/deployModel?hl=zh-cn) \u7684\u6b21\u6578\u4e0d\u80fd\u8d85\u904e\u4e00\u6b21\u3002\n\u4ee5\u4e0b\u793a\u4f8b\u4f7f\u7528 [gcloud ai models upload \u547d\u4ee4](https://cloud.google.com/sdk/gcloud/reference/ai/models/upload?hl=zh-cn) \uff1a\n```\ngcloud ai models upload \\\u00a0 --region=LOCATION \\\u00a0 --display-name=MODEL_NAME \\\u00a0 --container-image-uri=IMAGE_URI \\\u00a0 --artifact-uri=PATH_TO_MODEL_ARTIFACT_DIRECTORY\n```\n\u66ff\u63db\u4ee5\u4e0b\u5167\u5bb9\uff1a- \uff1a\u60a8\u5728\u5176\u4e2d\u4f7f\u7528 Vertex AI \u7684\u5340\u57df\u3002\n- \uff1a`Model`\u7684\u986f\u793a\u540d\u3002\n- \uff1a\u7528\u65bc\u57f7\u884c\u9810\u6e2c\u7684\u5bb9\u5668\u6620\u50cf\u7684 URI\u3002\u4f8b\u5982`us-docker.pkg.dev/vertex-ai/prediction/tf2-cpu.2-1:latest`\u3002\u4f7f\u7528 [\u9810\u69cb\u5efa\u5bb9\u5668](https://cloud.google.com/vertex-ai/docs/predictions/pre-built-containers?hl=zh-cn) \u6216 [\u81ea\u5b9a\u7fa9\u5bb9\u5668](https://cloud.google.com/vertex-ai/docs/predictions/use-custom-container?hl=zh-cn) \u3002\n- \uff1aCloud Storage \u4e2d\u5305\u542b [\u6a21\u578b\u5de5\u4ef6](https://cloud.google.com/vertex-ai/docs/training/exporting-model-artifacts?hl=zh-cn) \u7684\u76ee\u9304\u7684 Cloud Storage URI\uff08\u4ee5`gs://`\u958b\u982d\uff09\u3002\n\u4e0a\u8ff0\u793a\u4f8b\u5c55\u793a\u4e86\u5c0e\u5165\u5927\u591a\u6578\u6a21\u578b\u9700\u8981\u7684\u6240\u6709\u6a19\u8a8c\u3002\u5982\u679c\u60a8\u4e0d\u4f7f\u7528\u9810\u69cb\u5efa\u5bb9\u5668\u9032\u884c\u9810\u6e2c\uff0c\u5247\u53ef\u80fd\u9700\u8981\u6307\u5b9a\u5176\u4ed6\u4e00\u4e9b [\u53ef\u9078\u6a19\u8a8c](https://cloud.google.com/sdk/gcloud/reference/ai/models/upload?hl=zh-cn#OPTIONAL-FLAGS) \uff0c\u4ee5\u4fbf Vertex AI \u80fd\u5920\u4f7f\u7528\u5bb9\u5668\u6620\u50cf\u3002\u9019\u4e9b\u6a19\u8a8c\u4ee5 `--container-` \u958b\u982d\uff0c\u5c0d\u61c9\u65bc `Model` \u7684 [containerSpec](https://cloud.google.com/vertex-ai/docs/reference/rest/v1/projects.locations.models?hl=zh-cn#modelcontainerspec) \u7684\u5b57\u6bb5\u3002\u4f7f\u7528\u4ee5\u4e0b\u4ee3\u78bc\u793a\u4f8b\uff0c\u901a\u904e [model \u8cc7\u6e90\u7684 upload \u65b9\u6cd5](https://cloud.google.com/vertex-ai/docs/reference/rest/v1/projects.locations.models/upload?hl=zh-cn) \u4e0a\u50b3\u6a21\u578b\u3002\n\u5728\u4f7f\u7528\u4efb\u4f55\u8acb\u6c42\u6578\u64da\u4e4b\u524d\uff0c\u8acb\u5148\u9032\u884c\u4ee5\u4e0b\u66ff\u63db\uff1a- \uff1a\u60a8\u5728\u5176\u4e2d\u4f7f\u7528 Vertex AI \u7684\u5340\u57df\u3002\n- \uff1a\u60a8\u7684 [\u9805\u76ee ID](https://cloud.google.com/resource-manager/docs/creating-managing-projects?hl=zh-cn#identifiers) \u3002\n- \uff1a`Model`\u7684\u986f\u793a\u540d\u3002\n- \uff1a\u53ef\u9078\u3002\u6a21\u578b\u8aaa\u660e\u3002\n- \uff1a\u7528\u65bc\u57f7\u884c\u9810\u6e2c\u7684\u5bb9\u5668\u6620\u50cf\u7684 URI\u3002\u4f8b\u5982`us-docker.pkg.dev/vertex-ai/prediction/tf2-cpu.2-1:latest`\u3002\u4f7f\u7528 [\u9810\u69cb\u5efa\u5bb9\u5668](https://cloud.google.com/vertex-ai/docs/predictions/pre-built-containers?hl=zh-cn) \u6216 [\u81ea\u5b9a\u7fa9\u5bb9\u5668](https://cloud.google.com/vertex-ai/docs/predictions/use-custom-container?hl=zh-cn) \u3002\n- \uff1aCloud Storage \u4e2d\u5305\u542b [\u6a21\u578b\u5de5\u4ef6](https://cloud.google.com/vertex-ai/docs/training/exporting-model-artifacts?hl=zh-cn) \u7684\u76ee\u9304\u7684 Cloud Storage URI\uff08\u4ee5`gs://`\u958b\u982d\uff09\u3002\u5982\u679c\u60a8\u4f7f\u7528\u7684\u662f\u81ea\u5b9a\u7fa9\u5bb9\u5668\uff0c\u6b64\u8b8a\u91cf\u548c`artifactUri`\u5b57\u6bb5\u7232\u53ef\u9078\u5b57\u6bb5\u3002\n- `labels`\uff1a\u53ef\u9078\u3002\u7528\u65bc\u7d44\u7e54\u6a21\u578b\u7684\u4efb\u4f55\u9375\u503c\u5c0d\u3002\u4f8b\u5982\uff1a- \"env\": \"prod\"\n- \"tier\": \"backend\"\n- \u6307\u5b9a\u8981\u61c9\u7528\u65bc\u6b64\u8a13\u7df4\u6d41\u6c34\u7dda\u7684\u4efb\u4f55\u6a19\u7c64\u7684\u548c\u3002\nHTTP \u65b9\u6cd5\u548c\u7db2\u5740\uff1a\n```\nPOST https://LOCATION_ID-aiplatform.googleapis.com/v1/projects/PROJECT_ID/locations/LOCATION_ID/models:upload\n```\n\u8acb\u6c42 JSON \u6b63\u6587\uff1a\n```\n{\n \"model\": {\n \"displayName\": \"MODEL_NAME\",\n \"predictSchemata\": {},\n \"containerSpec\": {\n  \"imageUri\": \"IMAGE_URI\"\n },\n \"artifactUri\": \"PATH_TO_MODEL_ARTIFACT_DIRECTORY\",\n \"labels\": {\n  \"LABEL_NAME_1\": \"LABEL_VALUE_1\",\n  \"LABEL_NAME_2\": \"LABEL_VALUE_2\"\n }\n }\n}\n```\n\u5982\u9700\u767c\u9001\u8acb\u6c42\uff0c\u8acb\u9078\u64c7\u4ee5\u4e0b\u65b9\u5f0f\u4e4b\u4e00\uff1a\n **\u6ce8\u610f** \uff1a\u4ee5\u4e0b\u547d\u4ee4\u5047\u5b9a\u60a8\u5df2\u4f7f\u7528\u60a8\u7684\u7528\u6236\u8cec\u865f\u901a\u904e\u904b\u884c [gcloud init](https://cloud.google.com/sdk/gcloud/reference/init?hl=zh-cn) \u6216 [gcloud auth login](https://cloud.google.com/sdk/gcloud/reference/auth/login?hl=zh-cn) \u767b\u9304`gcloud`CLI\uff0c\u6216\u8005\u4f7f\u7528\u4e86 [Cloud Shell](https://cloud.google.com/shell/docs?hl=zh-cn) \uff0c\u9019\u6703\u4f7f\u60a8\u81ea\u52d5\u767b\u9304`gcloud`CLI\u3002\u60a8\u53ef\u4ee5\u904b\u884c [gcloud auth list](https://cloud.google.com/sdk/gcloud/reference/auth/list?hl=zh-cn) \u4f86\u6aa2\u67e5\u7576\u524d\u6d3b\u8e8d\u7684\u8cec\u865f\u3002\n\u5c07\u8acb\u6c42\u6b63\u6587\u4fdd\u5b58\u5728\u540d\u7232 `request.json` \u7684\u6587\u4ef6\u4e2d\uff0c\u7136\u5f8c\u57f7\u884c\u4ee5\u4e0b\u547d\u4ee4\uff1a\n```\ncurl -X POST \\ -H \"Authorization: Bearer $(gcloud auth print-access-token)\" \\ -H \"Content-Type: application/json; charset=utf-8\" \\ -d @request.json \\ \"https://LOCATION_ID-aiplatform.googleapis.com/v1/projects/PROJECT_ID/locations/LOCATION_ID/models:upload\"\n``` **\u6ce8\u610f** \uff1a\u4ee5\u4e0b\u547d\u4ee4\u5047\u5b9a\u60a8\u5df2\u4f7f\u7528\u60a8\u7684\u7528\u6236\u8cec\u865f\u901a\u904e\u904b\u884c [gcloud init](https://cloud.google.com/sdk/gcloud/reference/init?hl=zh-cn) \u6216 [gcloud auth login](https://cloud.google.com/sdk/gcloud/reference/auth/login?hl=zh-cn) \u767b\u9304`gcloud`CLI\uff0c\u6216\u8005\u4f7f\u7528\u4e86 [Cloud Shell](https://cloud.google.com/shell/docs?hl=zh-cn) \uff0c\u9019\u6703\u4f7f\u60a8\u81ea\u52d5\u767b\u9304`gcloud`CLI\u3002\u60a8\u53ef\u4ee5\u904b\u884c [gcloud auth list](https://cloud.google.com/sdk/gcloud/reference/auth/list?hl=zh-cn) \u4f86\u6aa2\u67e5\u7576\u524d\u6d3b\u8e8d\u7684\u8cec\u865f\u3002\n\u5c07\u8acb\u6c42\u6b63\u6587\u4fdd\u5b58\u5728\u540d\u7232 `request.json` \u7684\u6587\u4ef6\u4e2d\uff0c\u7136\u5f8c\u57f7\u884c\u4ee5\u4e0b\u547d\u4ee4\uff1a\n```\n$cred = gcloud auth print-access-token$headers = @{ \"Authorization\" = \"Bearer $cred\" }Invoke-WebRequest ` -Method POST ` -Headers $headers ` -ContentType: \"application/json; charset=utf-8\" ` -InFile request.json ` -Uri \"https://LOCATION_ID-aiplatform.googleapis.com/v1/projects/PROJECT_ID/locations/LOCATION_ID/models:upload\" | Select-Object -Expand Content\n```\n\u5728\u5617\u8a66\u6b64\u793a\u4f8b\u4e4b\u524d\uff0c\u8acb\u6309\u7167 [\u300aVertex AI \u5feb\u901f\u5165\u9580\uff1a\u4f7f\u7528\u5ba2\u6236\u7aef\u5eab\u300b](https://cloud.google.com/vertex-ai/docs/start/client-libraries?hl=zh-cn) \u4e2d\u7684 Java \u8a2d\u7f6e\u8aaa\u660e\u57f7\u884c\u64cd\u4f5c\u3002\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [Vertex AI Java API \u53c3\u8003\u6587\u6a94](https://cloud.google.com/java/docs/reference/google-cloud-aiplatform/latest/com.google.cloud.aiplatform.v1?hl=zh-cn) \u3002\n\u5982\u9700\u5411 Vertex AI \u9032\u884c\u8eab\u4efd\u9a57\u8b49\uff0c\u8acb\u8a2d\u7f6e\u61c9\u7528\u9ed8\u8a8d\u6191\u64da\u3002  \u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [\u7232\u672c\u5730\u958b\u767c\u74b0\u5883\u8a2d\u7f6e\u8eab\u4efd\u9a57\u8b49](https://cloud.google.com/docs/authentication/provide-credentials-adc?hl=zh-cn#local-dev) \u3002\n [\u5728 GitHub \u4e0a\u67e5\u770b](https://github.com/GoogleCloudPlatform/java-docs-samples/blob/HEAD/aiplatform/src/main/java/aiplatform/UploadModelSample.java) \n```\nimport com.google.api.gax.longrunning.OperationFuture;import com.google.cloud.aiplatform.v1.LocationName;import com.google.cloud.aiplatform.v1.Model;import com.google.cloud.aiplatform.v1.ModelContainerSpec;import com.google.cloud.aiplatform.v1.ModelServiceClient;import com.google.cloud.aiplatform.v1.ModelServiceSettings;import com.google.cloud.aiplatform.v1.UploadModelOperationMetadata;import com.google.cloud.aiplatform.v1.UploadModelResponse;import java.io.IOException;import java.util.concurrent.ExecutionException;import java.util.concurrent.TimeUnit;import java.util.concurrent.TimeoutException;public class UploadModelSample {\u00a0 public static void main(String[] args)\u00a0 \u00a0 \u00a0 throws InterruptedException, ExecutionException, TimeoutException, IOException {\u00a0 \u00a0 // TODO(developer): Replace these variables before running the sample.\u00a0 \u00a0 String project = \"YOUR_PROJECT_ID\";\u00a0 \u00a0 String modelDisplayName = \"YOUR_MODEL_DISPLAY_NAME\";\u00a0 \u00a0 String metadataSchemaUri =\u00a0 \u00a0 \u00a0 \u00a0 \"gs://google-cloud-aiplatform/schema/trainingjob/definition/custom_task_1.0.0.yaml\";\u00a0 \u00a0 String imageUri = \"YOUR_IMAGE_URI\";\u00a0 \u00a0 String artifactUri = \"gs://your-gcs-bucket/artifact_path\";\u00a0 \u00a0 uploadModel(project, modelDisplayName, metadataSchemaUri, imageUri, artifactUri);\u00a0 }\u00a0 static void uploadModel(\u00a0 \u00a0 \u00a0 String project,\u00a0 \u00a0 \u00a0 String modelDisplayName,\u00a0 \u00a0 \u00a0 String metadataSchemaUri,\u00a0 \u00a0 \u00a0 String imageUri,\u00a0 \u00a0 \u00a0 String artifactUri)\u00a0 \u00a0 \u00a0 throws IOException, InterruptedException, ExecutionException, TimeoutException {\u00a0 \u00a0 ModelServiceSettings modelServiceSettings =\u00a0 \u00a0 \u00a0 \u00a0 ModelServiceSettings.newBuilder()\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 .setEndpoint(\"us-central1-aiplatform.googleapis.com:443\")\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 .build();\u00a0 \u00a0 // Initialize client that will be used to send requests. This client only needs to be created\u00a0 \u00a0 // once, and can be reused for multiple requests. After completing all of your requests, call\u00a0 \u00a0 // the \"close\" method on the client to safely clean up any remaining background resources.\u00a0 \u00a0 try (ModelServiceClient modelServiceClient = ModelServiceClient.create(modelServiceSettings)) {\u00a0 \u00a0 \u00a0 String location = \"us-central1\";\u00a0 \u00a0 \u00a0 LocationName locationName = LocationName.of(project, location);\u00a0 \u00a0 \u00a0 ModelContainerSpec modelContainerSpec =\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 ModelContainerSpec.newBuilder().setImageUri(imageUri).build();\u00a0 \u00a0 \u00a0 Model model =\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 Model.newBuilder()\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 .setDisplayName(modelDisplayName)\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 .setMetadataSchemaUri(metadataSchemaUri)\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 .setArtifactUri(artifactUri)\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 .setContainerSpec(modelContainerSpec)\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 .build();\u00a0 \u00a0 \u00a0 OperationFuture<UploadModelResponse, UploadModelOperationMetadata> uploadModelResponseFuture =\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 modelServiceClient.uploadModelAsync(locationName, model);\u00a0 \u00a0 \u00a0 System.out.format(\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"Operation name: %s\\n\", uploadModelResponseFuture.getInitialFuture().get().getName());\u00a0 \u00a0 \u00a0 System.out.println(\"Waiting for operation to finish...\");\u00a0 \u00a0 \u00a0 UploadModelResponse uploadModelResponse = uploadModelResponseFuture.get(5, TimeUnit.MINUTES);\u00a0 \u00a0 \u00a0 System.out.println(\"Upload Model Response\");\u00a0 \u00a0 \u00a0 System.out.format(\"Model: %s\\n\", uploadModelResponse.getModel());\u00a0 \u00a0 }\u00a0 }}\n```\u5728\u5617\u8a66\u6b64\u793a\u4f8b\u4e4b\u524d\uff0c\u8acb\u6309\u7167 [\u300aVertex AI \u5feb\u901f\u5165\u9580\uff1a\u4f7f\u7528\u5ba2\u6236\u7aef\u5eab\u300b](https://cloud.google.com/vertex-ai/docs/start/client-libraries?hl=zh-cn) \u4e2d\u7684 Node.js \u8a2d\u7f6e\u8aaa\u660e\u57f7\u884c\u64cd\u4f5c\u3002\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [Vertex AI Node.js API \u53c3\u8003\u6587\u6a94](https://cloud.google.com/nodejs/docs/reference/aiplatform/latest?hl=zh-cn) \u3002\n\u5982\u9700\u5411 Vertex AI \u9032\u884c\u8eab\u4efd\u9a57\u8b49\uff0c\u8acb\u8a2d\u7f6e\u61c9\u7528\u9ed8\u8a8d\u6191\u64da\u3002  \u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [\u7232\u672c\u5730\u958b\u767c\u74b0\u5883\u8a2d\u7f6e\u8eab\u4efd\u9a57\u8b49](https://cloud.google.com/docs/authentication/provide-credentials-adc?hl=zh-cn#local-dev) \u3002\n [\u5728 GitHub \u4e0a\u67e5\u770b](https://github.com/GoogleCloudPlatform/nodejs-docs-samples/blob/HEAD/ai-platform/snippets/upload-model.js) \n```\n/**\u00a0* TODO(developer): Uncomment these variables before running the sample.\\\u00a0*/// const modelDisplayName = 'YOUR_MODEL_DISPLAY_NAME';// const metadataSchemaUri = 'YOUR_METADATA_SCHEMA_URI';// const imageUri = 'YOUR_IMAGE_URI';// const artifactUri = 'YOUR_ARTIFACT_URI';// const project = 'YOUR_PROJECT_ID';// const location = 'YOUR_PROJECT_LOCATION';// Imports the Google Cloud Model Service Client libraryconst {ModelServiceClient} = require('@google-cloud/aiplatform');// Specifies the location of the api endpointconst clientOptions = {\u00a0 apiEndpoint: 'us-central1-aiplatform.googleapis.com',};// Instantiates a clientconst modelServiceClient = new ModelServiceClient(clientOptions);async function uploadModel() {\u00a0 // Configure the parent resources\u00a0 const parent = `projects/${project}/locations/${location}`;\u00a0 // Configure the model resources\u00a0 const model = {\u00a0 \u00a0 displayName: modelDisplayName,\u00a0 \u00a0 metadataSchemaUri: '',\u00a0 \u00a0 artifactUri: artifactUri,\u00a0 \u00a0 containerSpec: {\u00a0 \u00a0 \u00a0 imageUri: imageUri,\u00a0 \u00a0 \u00a0 command: [],\u00a0 \u00a0 \u00a0 args: [],\u00a0 \u00a0 \u00a0 env: [],\u00a0 \u00a0 \u00a0 ports: [],\u00a0 \u00a0 \u00a0 predictRoute: '',\u00a0 \u00a0 \u00a0 healthRoute: '',\u00a0 \u00a0 },\u00a0 };\u00a0 const request = {\u00a0 \u00a0 parent,\u00a0 \u00a0 model,\u00a0 };\u00a0 console.log('PARENT AND MODEL');\u00a0 console.log(parent, model);\u00a0 // Upload Model request\u00a0 const [response] = await modelServiceClient.uploadModel(request);\u00a0 console.log(`Long running operation : ${response.name}`);\u00a0 // Wait for operation to complete\u00a0 await response.promise();\u00a0 const result = response.result;\u00a0 console.log('Upload model response ');\u00a0 console.log(`\\tModel : ${result.model}`);}uploadModel();\n```\u5982\u9700\u77ad\u89e3\u5982\u4f55\u5b89\u88dd\u6216\u66f4\u65b0 Python\uff0c\u8acb\u53c3\u95b1 [\u5b89\u88dd Python \u7248 Vertex AI SDK](https://cloud.google.com/vertex-ai/docs/start/use-vertex-ai-python-sdk?hl=zh-cn) \u3002  \u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [   Python API \u53c3\u8003\u6587\u6a94](https://cloud.google.com/python/docs/reference/aiplatform/latest?hl=zh-cn) \u3002\n [\u5728 GitHub \u4e0a\u67e5\u770b](https://github.com/googleapis/python-aiplatform/blob/HEAD/samples/model-builder/upload_model_sample.py) \n```\ndef upload_model_sample(\u00a0 \u00a0 project: str,\u00a0 \u00a0 location: str,\u00a0 \u00a0 display_name: str,\u00a0 \u00a0 serving_container_image_uri: str,\u00a0 \u00a0 artifact_uri: Optional[str] = None,\u00a0 \u00a0 serving_container_predict_route: Optional[str] = None,\u00a0 \u00a0 serving_container_health_route: Optional[str] = None,\u00a0 \u00a0 description: Optional[str] = None,\u00a0 \u00a0 serving_container_command: Optional[Sequence[str]] = None,\u00a0 \u00a0 serving_container_args: Optional[Sequence[str]] = None,\u00a0 \u00a0 serving_container_environment_variables: Optional[Dict[str, str]] = None,\u00a0 \u00a0 serving_container_ports: Optional[Sequence[int]] = None,\u00a0 \u00a0 instance_schema_uri: Optional[str] = None,\u00a0 \u00a0 parameters_schema_uri: Optional[str] = None,\u00a0 \u00a0 prediction_schema_uri: Optional[str] = None,\u00a0 \u00a0 explanation_metadata: Optional[explain.ExplanationMetadata] = None,\u00a0 \u00a0 explanation_parameters: Optional[explain.ExplanationParameters] = None,\u00a0 \u00a0 sync: bool = True,):\u00a0 \u00a0 aiplatform.init(project=project, location=location)\u00a0 \u00a0 model = aiplatform.Model.upload(\u00a0 \u00a0 \u00a0 \u00a0 display_name=display_name,\u00a0 \u00a0 \u00a0 \u00a0 artifact_uri=artifact_uri,\u00a0 \u00a0 \u00a0 \u00a0 serving_container_image_uri=serving_container_image_uri,\u00a0 \u00a0 \u00a0 \u00a0 serving_container_predict_route=serving_container_predict_route,\u00a0 \u00a0 \u00a0 \u00a0 serving_container_health_route=serving_container_health_route,\u00a0 \u00a0 \u00a0 \u00a0 instance_schema_uri=instance_schema_uri,\u00a0 \u00a0 \u00a0 \u00a0 parameters_schema_uri=parameters_schema_uri,\u00a0 \u00a0 \u00a0 \u00a0 prediction_schema_uri=prediction_schema_uri,\u00a0 \u00a0 \u00a0 \u00a0 description=description,\u00a0 \u00a0 \u00a0 \u00a0 serving_container_command=serving_container_command,\u00a0 \u00a0 \u00a0 \u00a0 serving_container_args=serving_container_args,\u00a0 \u00a0 \u00a0 \u00a0 serving_container_environment_variables=serving_container_environment_variables,\u00a0 \u00a0 \u00a0 \u00a0 serving_container_ports=serving_container_ports,\u00a0 \u00a0 \u00a0 \u00a0 explanation_metadata=explanation_metadata,\u00a0 \u00a0 \u00a0 \u00a0 explanation_parameters=explanation_parameters,\u00a0 \u00a0 \u00a0 \u00a0 sync=sync,\u00a0 \u00a0 )\u00a0 \u00a0 model.wait()\u00a0 \u00a0 print(model.display_name)\u00a0 \u00a0 print(model.resource_name)\u00a0 \u00a0 return model\n```\n\u5982\u9700\u5c0e\u5165\u5553\u7528\u4e86 Vertex Explainable AI \u8a2d\u7f6e\u7684\u6a21\u578b\uff0c\u8acb\u53c3\u95b1 [Vertex Explainable AI \u6a21\u578b\u5c0e\u5165\u793a\u4f8b](https://cloud.google.com/vertex-ai/docs/explainable-ai/configuring-explanations?hl=zh-cn#import-model-example) \u3002\n### \u7372\u53d6\u64cd\u4f5c\u72c0\u614b\n\u67d0\u4e9b\u8acb\u6c42\u6703\u5553\u52d5\u9700\u8981\u4e00\u4e9b\u6642\u9593\u624d\u80fd\u5b8c\u6210\u7684\u9577\u6642\u9593\u904b\u884c\u7684\u64cd\u4f5c\u3002\u9019\u4e9b\u8acb\u6c42\u6703\u8fd4\u56de\u64cd\u4f5c\u540d\u7a31\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528\u8a72\u540d\u7a31\u67e5\u770b\u64cd\u4f5c\u72c0\u614b\u6216\u53d6\u6d88\u64cd\u4f5c\u3002Vertex AI \u63d0\u4f9b\u8f14\u52a9\u65b9\u6cd5\u4f86\u8abf\u7528\u9577\u6642\u9593\u904b\u884c\u7684\u64cd\u4f5c\u3002\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [\u4f7f\u7528\u9577\u6642\u9593\u904b\u884c\u7684\u64cd\u4f5c](https://cloud.google.com/vertex-ai/docs/general/long-running-operations?hl=zh-cn) \u3002\n## \u9650\u5236\n- \u652f\u6301\u7684\u6a21\u578b\u5927\u5c0f\u4e0a\u9650\u7232 10 GiB\u3002## \u5f8c\u7e8c\u6b65\u9a5f\n- [\u4ee5\u7de8\u7a0b\u65b9\u5f0f](https://cloud.google.com/vertex-ai/docs/predictions/deploy-model-api?hl=zh-cn) \u6216 [\u4f7f\u7528 Google Cloud \u63a7\u5236\u6aaf](https://cloud.google.com/vertex-ai/docs/predictions/deploy-model-console?hl=zh-cn) \u5c07\u6a21\u578b\u90e8\u7f72\u5230\u7aef\u9ede\u3002", "guide": "Vertex AI"}