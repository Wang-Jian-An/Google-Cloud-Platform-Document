{"title": "Vertex AI - Use reservations with Vertex AI Workbench instances", "url": "https://cloud.google.com/vertex-ai/docs/workbench/instances/reservations?hl=zh-cn", "abstract": "# Vertex AI - Use reservations with Vertex AI Workbench instances\n# Use reservations with Vertex AI Workbench instances\n**    Private preview     ** This feature is subject to the \"Pre-GA Offerings Terms\" in the General Service Terms section   of the [Service Specific Terms](/terms/service-terms#1) .     Pre-GA features are available \"as is\" and might have limited support.    For more information, see the [launch stage descriptions](/products#product-launch-stages) .For information about access to this  release, see the [  access request page](https://docs.google.com/forms/d/178hgvQAX-w3CQoieHQnaue5r2ibGcmCoqV5o3qBKXqE/viewform) .\nTo ensure that VM resources are available when your Vertex AI Workbench instances need them, you can use Compute Engine reservations. Reservations provide a high level of assurance in obtaining capacity for Compute Engine zonal resources.\n", "content": "## Limitations and requirements\nAll limitations of Compute Engine reservations apply when Vertex AI Workbench instances consume reservations. See [How reservationswork](/compute/docs/instances/reservations-overview#how-reservations-work) .\nIn addition, when using reservations with Vertex AI Workbench instances, the following limitations and requirements apply:\n- Reservations for Vertex AI Workbench instances is in [private preview](/products#product-launch-stages) . To request access, see the [access request page](https://docs.google.com/forms/d/178hgvQAX-w3CQoieHQnaue5r2ibGcmCoqV5o3qBKXqE/viewform) .\n- [Committed use discounts](/docs/cuds) don't apply.\n- Using reservations with Vertex AI Workbench is only available through the Notebooks API. Using reservations with Vertex AI Workbench by using the Google Cloud console isn't supported.## Before you begin\n### Required roles\nTo ensure that your user account has the necessary  permissions to use reservations with Vertex AI Workbench instances,   ask your administrator to grant your user account the  following IAM roles on the project:\n- [Compute Admin ](https://cloud.google.com/iam/docs/understanding-roles#compute.admin) (`roles/compute.admin`)\n- [Notebooks Admin ](https://cloud.google.com/iam/docs/understanding-roles#notebooks.admin) (`roles/notebooks.admin`)\nFor more information about granting roles, see [Manage access](/iam/docs/granting-changing-revoking-access) .\nYour administrator might also be able to give your user account  the required permissions through [custom  roles](/iam/docs/creating-custom-roles) or other [predefined  roles](/iam/docs/understanding-roles) .\n## Create a reservation\n- Create a Compute Engine reservation. It can be a single-project reservation or a shared reservation. For more information, see the following documents:- [Create a reservation for a singleproject](/compute/docs/instances/reservations-single-project) \n- [Create a shared reservation](/compute/docs/instances/reservations-shared) \nThe reservation can include GPU accelerators.## Use your reservation with an existing instance\nYou can add your reservation to a Vertex AI Workbench instance by using the REST API.\nBefore using any of the request data, make the following replacements:\n- ``: your project ID\n- ``: the zone where your instance is located\n- ``: the name of your instance\n- ``: the machine type of your instance\n- ``: the type of reservation\n- ``: the name of your reservation\nHTTP method and URL:\n```\nPOST https://notebooks.googleapis.com/v2/projects/PROJECT_ID/locations/LOCATION/instances?instanceId=INSTANCE_NAME\n```\nRequest JSON body:\n```\n{\n \"gce_setup\": {\n \"machine_type\": \"MACHINE_TYPE\",\n \"reservation_affinity\": {\n  \"consume_reservation_type\": \"RESERVATION_TYPE\",\n  \"key\": \"compute.googleapis.com/reservation-name\",\n  \"values\": [\"RESERVATION_NAME\"]\n }\n }\n}\n```\nTo send your request, choose one of these options:\n**Note:** The following command assumes that you have logged in to  the`gcloud`CLI with your user account by running [gcloud init](/sdk/gcloud/reference/init) or [gcloud auth login](/sdk/gcloud/reference/auth/login) ,  or by using [Cloud Shell](/shell/docs) ,  which automatically logs you into the`gcloud`CLI.  You can check the currently active account by running [gcloud auth list](/sdk/gcloud/reference/auth/list) .\nSave the request body in a file named `request.json` ,  and execute the following command:\n```\ncurl -X POST \\ -H \"Authorization: Bearer $(gcloud auth print-access-token)\" \\ -H \"Content-Type: application/json; charset=utf-8\" \\ -d @request.json \\ \"https://notebooks.googleapis.com/v2/projects/PROJECT_ID/locations/LOCATION/instances?instanceId=INSTANCE_NAME\"\n``` **Note:** The following command assumes that you have logged in to  the`gcloud`CLI with your user account by running [gcloud init](/sdk/gcloud/reference/init) or [gcloud auth login](/sdk/gcloud/reference/auth/login) ,  or by using [Cloud Shell](/shell/docs) ,  which automatically logs you into the`gcloud`CLI.  You can check the currently active account by running [gcloud auth list](/sdk/gcloud/reference/auth/list) .\nSave the request body in a file named `request.json` ,  and execute the following command:\n```\n$cred = gcloud auth print-access-token$headers = @{ \"Authorization\" = \"Bearer $cred\" }Invoke-WebRequest ` -Method POST ` -Headers $headers ` -ContentType: \"application/json; charset=utf-8\" ` -InFile request.json ` -Uri \"https://notebooks.googleapis.com/v2/projects/PROJECT_ID/locations/LOCATION/instances?instanceId=INSTANCE_NAME\" | Select-Object -Expand Content\n```\n[Operation](/vertex-ai/docs/workbench/reference/rest/Shared.Types/ListOperationsResponse#Operation)\n## Stop using your reservation\nTo stop using your reservation, you can [delete your reservation](/compute/docs/instances/reservations-delete) .\nIf you want to continue using your reservation with other resources, but don't want your existing Vertex AI Workbench instance to use it, you must delete the instance.\n## Billing\nReserved Compute Engine VM resources are billed by Vertex AI Workbench while the Vertex AI Workbench instance is running, and are billed by Compute Engine when the VM resources aren't being used by Vertex AI Workbench.\n## What's next\n- To learn more about Compute Engine reservations, see [Reservations of Compute Engine zonalresources](/compute/docs/instances/reservations-overview) .", "guide": "Vertex AI"}