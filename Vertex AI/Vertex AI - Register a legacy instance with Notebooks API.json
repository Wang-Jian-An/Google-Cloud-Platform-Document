{"title": "Vertex AI - Register a legacy instance with Notebooks API", "url": "https://cloud.google.com/vertex-ai/docs/start/introduction-unified-platform", "abstract": "# Vertex AI - Register a legacy instance with Notebooks API\n# Register a legacy instance with Notebooks API\nVertex AI Workbench user-managed notebooks is [deprecated](/vertex-ai/docs/deprecations) . On January 30, 2025, support for  user-managed notebooks will end and the ability to create user-managed notebooks instances  will be removed. Existing instances will continue to function  but patches, updates, and upgrades won't be available. To continue using  Vertex AI Workbench, we recommend that you [migrate your user-managed notebooks instances to Vertex AI Workbench instances](/vertex-ai/docs/workbench/user-managed/migrate-to-instances) .\nThis page shows how to migrate and register a legacy user-managed notebooks instance with the Notebooks API. Instances created by using the Compute Engine API are called legacy instances. Legacy instances don't have the latest updates to functionality and features.\nTo use the new functionality and features that are available with the Notebooks API, you must [register](#register) your legacy instances with the Notebooks API. Before registering your legacy instances, check whether they meet the [requirements](#requirements) . You can [migrate](#migrate-to-new-instance) instances that don't meet the requirements.\nIf you enable the Notebooks API before registering your legacy instances, the Notebooks API activation process attempts to register your existing legacy instances automatically.\n", "content": "## Requirements and limitations\nBefore registering your legacy instances with the Notebooks API, consider the following requirements and limitations.\n- Source and destination zones must match and be a valid zone for the Notebooks API.For example, a legacy user-managed notebooks instance in `us-west1-a` remains in `us-west1-a` when it is registered with the Notebooks API. However, a legacy user-managed notebooks instance in `us-central1-f` won't register with the Notebooks API because `us-central1-f` isn't a valid zone for the Notebooks API.To get a list of the valid zones for the Notebooks API notebooks instances, run the following command by using the [Google Cloud CLI](/sdk/gcloud) in your preferred terminal or in [Cloud Shell](https://console.cloud.google.com?cloudshell=true) :```\ngcloud notebooks locations list\n```If your legacy instance's zone is not a valid zone for the Notebooks API, you can contact [support](/vertex-ai/docs/support/getting-support) or your account manager, or you can [migrate the legacy instance to anew user-managed notebooksinstance](#migrate-to-new-instance) .\n- Only dual-disk instances can use all user-managed notebooks features.Single-disk legacy instances cannot use some user-managed notebooks features, such as auto upgrade, even after they are registered with the Notebooks API. To enable your single-disk legacy instance to use all available features, you must [migrate your single-disk instance to a dual-diskinstance](#migrate-to-new-instance) .You can migrate your single-disk instance to a dual-disk instance as part of your migration from a legacy instance to an instance registered with the Notebooks API. If you've already registered the legacy instance with the Notebooks API, you can still migrate the instance to a dual-disk instance to resolve the issue.To verify the number of disks, complete the following steps.\n- In the Google Cloud console, go to the **VM instances** page. [Go to VM instances](https://console.cloud.google.com/compute/instances) \n- Find your current legacy user-managed notebooks instance.\n- Click the instance name to open the **VM instance details** page.\n- In the **boot disk** and **additional disks** sections, verify how many disks are attached to the VM.\n- In [Cloud Shell](https://console.cloud.google.com?cloudshell=true) or any environment where the [Google Cloud CLI](/sdk/docs) is installed, enter the following [Google Cloud CLI](/sdk/gcloud) command:```\ngcloud compute instances describe MY_INSTANCE_NAME\n --zone=MY_ZONE\n```Replace the following:- ``: the name of your instance\n- ``: the zone of your instance\n- Review the information that follows **disks:** , and verify how many disks are attached to the VM.\n## Migrate a legacy instance to a new user-managed notebooks instance\nIf your legacy user-managed notebooks instance is in a zone that isn't a valid zone for the Notebooks API, or if you want to migrate from a single-disk instance to a dual-disk instance, you must create a user-managed notebooks instance and copy your user data from your legacy instance to the new instance.\nTo create a user-managed notebooks instance and copy your user data from your legacy instance to the new instance, complete the following steps:\n- To use `ssh` to connect to your legacy instance, in [Cloud Shell](https://console.cloud.google.com?cloudshell=true) or any environment where the [Google Cloud CLI](/sdk/docs) is installed, enter the following [Google Cloud CLI](/sdk/gcloud) command:```\nexport PROJECT_ID=\"MY_PROJECT_ID\"\nexport ZONE=\"MY_ZONE\"\nexport INSTANCE_NAME=\"MY_INSTANCE\"\ngcloud compute ssh\n --project $PROJECT_ID\n --zone $ZONE $INSTANCE_NAME\n -- -L 8080:localhost:8080\n```Replace the following:- ``: the ID of your Google Cloud project\n- ``: the zone of your instance\n- ``: the name of your instance with the relevant information.\n- To copy the contents of the legacy instance to a Cloud Storage bucket, use `gsutil` . The following example command copies all of the notebook ( `.ipynb` ) files from the default directory `/home/jupyter/` to a Cloud Storage directory named `my-bucket/legacy-notebooks` .```\ngsutil cp -R /home/jupyter/*.ipynb gs://my-bucket/legacy-notebooks/\n```\n- Create a user-managed notebooks instance with the same hardware specifications as the legacy instance. You can [create the instanceby using theGoogle Cloud console](/vertex-ai/docs/workbench/user-managed/create-new) or the [Google Cloud CLI](/sdk/gcloud) .In this example, Vertex AI Workbench creates a user-managed notebooks instance named `new-notebook` in the `example` project using the latest TensorFlow 2 image, with an `n1-standard-1` machine type, in the `us-west1-a` zone.In either [Cloud Shell](https://console.cloud.google.com?cloudshell=true) or any environment where the [Google Cloud CLI](/sdk/docs) is installed, enter the following [Google Cloud CLI](/sdk/gcloud) command:```\ngcloud notebooks instances create new-notebook \\\n --vm-image-project=example \\\n --vm-image-family=tf-latest-cpu \\\n --machine-type=n1-standard-1 \\\n --location=us-west1-a\n```The new user-managed notebooks instance is dual-disk. It has a boot disk and a data disk.\n- Use `ssh` to connect to the user-managed notebooks instance that you just created.\n- To copy the contents of the legacy instance from the Cloud Storage bucket to the new instance, use `gsutil` . The following example command copies all of the notebook ( `.ipynb` ) files from the Cloud Storage directory to the new instance's `/home/jupyter/` directory.```\ngsutil cp -R gs://my-bucket/legacy-notebooks/*.ipynb /home/jupyter/\n```\n- In the new user-managed notebooks instance, open JupyterLab and confirm that the user data and assets have been successfully copied.\n- Optional: delete the legacy instance.## Register a legacy instance with the Notebooks API\nTo use the Notebooks API to manage your legacy instances, you must register your legacy instances with the Notebooks API.\nIf you enable the Notebooks API before registering your legacy instances, the Notebooks API activation process attempts to register your existing legacy instances automatically. If you create legacy instances after the Notebooks API is enabled, you must register them manually by using one of the following methods.\nTo register your legacy instance with the Notebooks API, you can use the Google Cloud console or the Notebooks API.\nTo use the **Register all** option in the Google Cloud console, complete the following steps:- In the Google Cloud console, go to the **User-managed notebooks** page. [Go to User-managed notebooks](https://console.cloud.google.com/vertex-ai/workbench/user-managed) \n- If you have one or more legacy user-managed notebooks instances, a message appears indicating that you need to register them with the Notebooks API. Next to this message, click **Register all** .\n- If you do not have any legacy user-managed notebooks instances, but have not yet enabled the Notebooks API, click **EnableNotebooks API** to ensure that new user-managed notebooks instances are created by using the Notebooks API.\nTo use the [register](/vertex-ai/docs/workbench/reference/rest/v1/projects.locations.instances/register) method provided by the Notebooks API, in [Cloud Shell](https://console.cloud.google.com?cloudshell=true) or any environment where the [Google Cloud CLI](/sdk/docs) is installed, enter the following [Google Cloud CLI](/sdk/gcloud) command:\n```\ngcloud notebooks instances register MY_INSTANCE_NAME\n --location=MY_ZONE\n```\nReplace the following:- ``: the name of your instance\n- ``: the zone of your instance## What's next\n- [Create a user-managed notebooks instance by using a custom container](/vertex-ai/docs/workbench/user-managed/custom-container)", "guide": "Vertex AI"}