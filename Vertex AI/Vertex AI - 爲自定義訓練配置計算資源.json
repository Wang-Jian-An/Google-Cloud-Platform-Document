{"title": "Vertex AI - \u7232\u81ea\u5b9a\u7fa9\u8a13\u7df4\u914d\u7f6e\u8a08\u7b97\u8cc7\u6e90", "url": "https://cloud.google.com/vertex-ai/docs/training/configure-compute?hl=zh-cn", "abstract": "# Vertex AI - \u7232\u81ea\u5b9a\u7fa9\u8a13\u7df4\u914d\u7f6e\u8a08\u7b97\u8cc7\u6e90\n\u57f7\u884c\u81ea\u5b9a\u7fa9\u8a13\u7df4\u6642\uff0c\u60a8\u7684\u8a13\u7df4\u4ee3\u78bc\u6703\u5728\u4e00\u500b\u6216\u591a\u500b\u865b\u64ec\u6a5f (VM) \u5be6\u4f8b\u4e0a\u904b\u884c\u3002\u60a8\u53ef\u4ee5\u914d\u7f6e\u7528\u65bc\u8a13\u7df4\u7684\u865b\u64ec\u6a5f\u985e\u578b\uff1a\u4f7f\u7528\u8a08\u7b97\u8cc7\u6e90\u8f03\u591a\u7684\u865b\u64ec\u6a5f\u53ef\u52a0\u5feb\u8a13\u7df4\u901f\u5ea6\uff0c\u4e26\u5141\u8a31\u60a8\u4f7f\u7528\u66f4\u5927\u7684\u6578\u64da\u96c6\uff0c\u4e0d\u904e\uff0c\u5b83\u5011\u4e5f\u53ef\u80fd\u6703\u7522\u751f\u66f4\u591a [\u8a13\u7df4\u8cbb\u7528](https://cloud.google.com/vertex-ai/pricing?hl=zh-cn) \u3002\n\u5728\u67d0\u4e9b\u60c5\u6cc1\u4e0b\uff0c\u60a8\u9084\u53ef\u4ee5\u4f7f\u7528 GPU \u52a0\u901f\u8a13\u7df4\u3002GPU \u6703\u7522\u751f\u984d\u5916\u8cbb\u7528\u3002\n\u60a8\u4e5f\u53ef\u4ee5\u9078\u64c7\u81ea\u5b9a\u7fa9\u8a13\u7df4\u4f5c\u696d\u7684\u5553\u52d5\u78c1\u76e4\u7684\u985e\u578b\u548c\u5927\u5c0f\u3002\n\u672c\u6587\u6a94\u4ecb\u7d39\u4e86\u53ef\u7528\u65bc\u81ea\u5b9a\u7fa9\u8a13\u7df4\u7684\u4e0d\u540c\u8a08\u7b97\u8cc7\u6e90\u53ca\u5176\u914d\u7f6e\u65b9\u6cd5\u3002\n", "content": "## \u6307\u5b9a\u8a08\u7b97\u8cc7\u6e90\u7684\u4f4d\u7f6e\n\u5728 [WorkerPoolSpec](https://cloud.google.com/vertex-ai/docs/reference/rest/v1/CustomJobSpec?hl=zh-cn#workerpoolspec) \u4e2d\u6307\u5b9a\u914d\u7f6e\u8a73\u7d30\u4fe1\u606f\u3002\u6839\u64da\u60a8\u57f7\u884c\u81ea\u5b9a\u7fa9\u8a13\u7df4\u7684\u65b9\u5f0f\uff0c\u8acb\u5c07\u6b64 `WorkerPoolSpec` \u653e\u5165\u4ee5\u4e0b\u67d0\u500b API \u5b57\u6bb5\u4e2d\uff1a\n- **\u5982\u679c\u60a8\u8981\u5275\u5efa\u4e00\u500bCustomJob\u8cc7\u6e90** \uff0c\u5728 `CustomJob.jobSpec.workerPoolSpecs` \u4e2d\u6307\u5b9a `WorkerPoolSpec` \u3002\u5982\u679c\u60a8\u4f7f\u7528\u7684\u662f Google Cloud CLI\uff0c\u5247\u53ef\u4ee5\u5728 [gcloud ai custom-jobs create \u547d\u4ee4](https://cloud.google.com/sdk/gcloud/reference/ai/custom-jobs/create?hl=zh-cn) \u4e0a\u4f7f\u7528 `--worker-pool-spec` \u6a19\u8a8c\u6216 `--config` \u6a19\u8a8c\u4f86\u6307\u5b9a\u5de5\u4f5c\u5668\u6c60\u9078\u9805\u3002\u8a73\u7d30\u77ad\u89e3\u5982\u4f55 [\u5275\u5efa CustomJob](https://cloud.google.com/vertex-ai/docs/training/create-custom-job?hl=zh-cn) \u3002\n- **\u5982\u679c\u60a8\u8981\u5275\u5efa\u4e00\u500bHyperparameterTuningJob\u8cc7\u6e90** \uff0c\u5728 `HyperparameterTuningJob.trialJobSpec.workerPoolSpecs` \u4e2d\u6307\u5b9a `WorkerPoolSpec` \u3002\u5982\u679c\u60a8\u4f7f\u7528\u7684\u662f gcloud CLI\uff0c\u5247\u53ef\u4ee5\u4f7f\u7528 [gcloud ai hpt-tuning-jobs create \u547d\u4ee4](https://cloud.google.com/sdk/gcloud/reference/ai/hp-tuning-jobs/create?hl=zh-cn) \u4e0a\u7684 `--config` \u6a19\u8a8c\u4f86\u6307\u5b9a\u5de5\u4f5c\u5668\u6c60\u9078\u9805\u3002\u8a73\u7d30\u77ad\u89e3\u5982\u4f55 [\u5275\u5efa HyperparameterTuningJob](https://cloud.google.com/vertex-ai/docs/training/using-hyperparameter-tuning?hl=zh-cn) \u3002\n- **\u5982\u679c\u60a8\u8981\u5275\u5efa\u4e00\u500b\u672a\u9032\u884c\u8d85\u53c3\u6578\u8abf\u7bc0\u7684TrainingPipeline\u8cc7\u6e90\uff0c** \u5728 `TrainingPipeline.trainingTaskInputs.workerPoolSpecs` \u4e2d\u6307\u5b9a `WorkerPoolSpec` \u3002\u8a73\u7d30\u77ad\u89e3\u5982\u4f55 [\u5275\u5efa\u81ea\u5b9a\u7fa9TrainingPipeline](https://cloud.google.com/vertex-ai/docs/training/create-training-pipeline?hl=zh-cn) \u3002\n- **\u5982\u679c\u8981\u4f7f\u7528\u8d85\u53c3\u6578\u8abf\u7bc0\u5275\u5efa TrainingPipeline** \uff0c\u8acb\u5728 `TrainingPipeline.trainingTaskInputs.trialJobSpec.workerPoolSpecs` \u4e2d\u6307\u5b9a `WorkerPoolSpec` \u3002\n\u5982\u679c\u60a8\u57f7\u884c [\u5206\u4f48\u5f0f\u8a13\u7df4](https://cloud.google.com/vertex-ai/docs/training/code-requirements?hl=zh-cn#distributed) \uff0c\u5247\u53ef\u4ee5\u5c0d\u6bcf\u500b\u5de5\u4f5c\u5668\u6c60\u4f7f\u7528\u4e0d\u540c\u7684\u8a2d\u7f6e\u3002\n## \u6a5f\u5668\u985e\u578b\n\u5728 `WorkerPoolSpec` \u4e2d\uff0c\u60a8\u5fc5\u9808\u5728 [machineSpec.machineType \u5b57\u6bb5](https://cloud.google.com/vertex-ai/docs/reference/rest/v1/MachineSpec?hl=zh-cn) \u4e2d\u6307\u5b9a\u4ee5\u4e0b\u6a5f\u5668\u985e\u578b\u4e4b\u4e00\u3002\u5de5\u4f5c\u5668\u6c60\u4e2d\u7684\u6bcf\u500b\u526f\u672c\u90fd\u5728\u5177\u6709\u6307\u5b9a\u6a5f\u5668\u985e\u578b\u7684\u4e0d\u540c\u865b\u64ec\u6a5f\u4e0a\u904b\u884c\u3002\n* \u4e0a\u8ff0\u5217\u8868\u4e2d\u6a19\u6709\u661f\u865f\u7684\u6a5f\u5668\u985e\u578b\u5fc5\u9808\u8207\u7279\u5b9a GPU \u6216 TPU \u642d\u914d\u4f7f\u7528\u3002\u8acb\u53c3\u95b1\u672c\u6307\u5357\u7684\u4ee5\u4e0b\u90e8\u5206\u3002\n\u5982\u9700\u77ad\u89e3\u6bcf\u7a2e\u6a5f\u5668\u985e\u578b\u7684\u6280\u8853\u898f\u7bc4\uff0c\u8acb\u53c3\u95b1 [\u6709\u95dc\u6a5f\u5668\u985e\u578b\u7684 Compute Engine \u6587\u6a94](https://cloud.google.com/compute/docs/machine-types?hl=zh-cn) \u3002\u5982\u9700\u77ad\u89e3\u6bcf\u7a2e\u6a5f\u5668\u985e\u578b\u9032\u884c\u81ea\u5b9a\u7fa9\u8a13\u7df4\u7684\u8cbb\u7528\uff0c\u8acb\u53c3\u95b1 [\u50f9\u683c](https://cloud.google.com/vertex-ai/pricing?hl=zh-cn) \u3002\n\u4ee5\u4e0b\u793a\u4f8b\u6f14\u793a\u4e86\u5275\u5efa `CustomJob` \u6642\u6307\u5b9a\u6a5f\u5668\u985e\u578b\u7684\u4f4d\u7f6e\uff1a\n\u5728 Google Cloud \u63a7\u5236\u6aaf\u4e2d\uff0c\u60a8\u7121\u6cd5\u76f4\u63a5\u5275\u5efa `CustomJob` \u3002\u4f46\u662f\uff0c\u60a8\u53ef\u4ee5 [\u5275\u5efa\u4e00\u500b\u5275\u5efa CustomJob \u7684 TrainingPipeline](https://cloud.google.com/vertex-ai/docs/training/create-custom-job?hl=zh-cn#create) \u3002\u5728 Google Cloud \u63a7\u5236\u6aaf\u4e2d\u5275\u5efa `TrainingPipeline` \u6642\uff0c\u8acb\u5728 **\u8a08\u7b97\u548c\u50f9\u683c** \u6b65\u9a5f\u7684 **\u6a5f\u5668\u985e\u578b** \u5b57\u6bb5\u4e2d\u7232\u6bcf\u500b\u5de5\u4f5c\u5668\u6c60\u6307\u5b9a\u6a5f\u5668\u985e\u578b\u3002```\ngcloud ai custom-jobs create \\\u00a0 --region=LOCATION \\\u00a0 --display-name=JOB_NAME \\\u00a0 --worker-pool-spec=machine-type=MACHINE_TYPE,replica-count=REPLICA_COUNT,container-image-uri=CUSTOM_CONTAINER_IMAGE_URI\n```\u5728\u5617\u8a66\u6b64\u793a\u4f8b\u4e4b\u524d\uff0c\u8acb\u6309\u7167 [\u300aVertex AI \u5feb\u901f\u5165\u9580\uff1a\u4f7f\u7528\u5ba2\u6236\u7aef\u5eab\u300b](https://cloud.google.com/vertex-ai/docs/start/client-libraries?hl=zh-cn) \u4e2d\u7684 Java \u8a2d\u7f6e\u8aaa\u660e\u57f7\u884c\u64cd\u4f5c\u3002\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [Vertex AI Java API \u53c3\u8003\u6587\u6a94](https://cloud.google.com/java/docs/reference/google-cloud-aiplatform/latest/com.google.cloud.aiplatform.v1?hl=zh-cn) \u3002\n\u5982\u9700\u5411 Vertex AI \u9032\u884c\u8eab\u4efd\u9a57\u8b49\uff0c\u8acb\u8a2d\u7f6e\u61c9\u7528\u9ed8\u8a8d\u6191\u64da\u3002  \u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [\u7232\u672c\u5730\u958b\u767c\u74b0\u5883\u8a2d\u7f6e\u8eab\u4efd\u9a57\u8b49](https://cloud.google.com/docs/authentication/provide-credentials-adc?hl=zh-cn#local-dev) \u3002\n [\u5728 GitHub \u4e0a\u67e5\u770b](https://github.com/GoogleCloudPlatform/java-docs-samples/blob/HEAD/aiplatform/src/main/java/aiplatform/CreateCustomJobSample.java) \n```\nimport com.google.cloud.aiplatform.v1.AcceleratorType;import com.google.cloud.aiplatform.v1.ContainerSpec;import com.google.cloud.aiplatform.v1.CustomJob;import com.google.cloud.aiplatform.v1.CustomJobSpec;import com.google.cloud.aiplatform.v1.JobServiceClient;import com.google.cloud.aiplatform.v1.JobServiceSettings;import com.google.cloud.aiplatform.v1.LocationName;import com.google.cloud.aiplatform.v1.MachineSpec;import com.google.cloud.aiplatform.v1.WorkerPoolSpec;import java.io.IOException;// Create a custom job to run machine learning training code in Vertex AIpublic class CreateCustomJobSample {\u00a0 public static void main(String[] args) throws IOException {\u00a0 \u00a0 // TODO(developer): Replace these variables before running the sample.\u00a0 \u00a0 String project = \"PROJECT\";\u00a0 \u00a0 String displayName = \"DISPLAY_NAME\";\u00a0 \u00a0 // Vertex AI runs your training application in a Docker container image. A Docker container\u00a0 \u00a0 // image is a self-contained software package that includes code and all dependencies. Learn\u00a0 \u00a0 // more about preparing your training application at\u00a0 \u00a0 // https://cloud.google.com/vertex-ai/docs/training/overview#prepare_your_training_application\u00a0 \u00a0 String containerImageUri = \"CONTAINER_IMAGE_URI\";\u00a0 \u00a0 createCustomJobSample(project, displayName, containerImageUri);\u00a0 }\u00a0 static void createCustomJobSample(String project, String displayName, String containerImageUri)\u00a0 \u00a0 \u00a0 throws IOException {\u00a0 \u00a0 JobServiceSettings settings =\u00a0 \u00a0 \u00a0 \u00a0 JobServiceSettings.newBuilder()\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 .setEndpoint(\"us-central1-aiplatform.googleapis.com:443\")\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 .build();\u00a0 \u00a0 String location = \"us-central1\";\u00a0 \u00a0 // Initialize client that will be used to send requests. This client only needs to be created\u00a0 \u00a0 // once, and can be reused for multiple requests.\u00a0 \u00a0 try (JobServiceClient client = JobServiceClient.create(settings)) {\u00a0 \u00a0 \u00a0 MachineSpec machineSpec =\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 MachineSpec.newBuilder()\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 .setMachineType(\"n1-standard-4\")\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 .setAcceleratorType(AcceleratorType.NVIDIA_TESLA_K80)\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 .setAcceleratorCount(1)\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 .build();\u00a0 \u00a0 \u00a0 ContainerSpec containerSpec =\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 ContainerSpec.newBuilder().setImageUri(containerImageUri).build();\u00a0 \u00a0 \u00a0 WorkerPoolSpec workerPoolSpec =\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 WorkerPoolSpec.newBuilder()\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 .setMachineSpec(machineSpec)\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 .setReplicaCount(1)\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 .setContainerSpec(containerSpec)\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 .build();\u00a0 \u00a0 \u00a0 CustomJobSpec customJobSpecJobSpec =\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 CustomJobSpec.newBuilder().addWorkerPoolSpecs(workerPoolSpec).build();\u00a0 \u00a0 \u00a0 CustomJob customJob =\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 CustomJob.newBuilder()\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 .setDisplayName(displayName)\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 .setJobSpec(customJobSpecJobSpec)\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 .build();\u00a0 \u00a0 \u00a0 LocationName parent = LocationName.of(project, location);\u00a0 \u00a0 \u00a0 CustomJob response = client.createCustomJob(parent, customJob);\u00a0 \u00a0 \u00a0 System.out.format(\"response: %s\\n\", response);\u00a0 \u00a0 \u00a0 System.out.format(\"Name: %s\\n\", response.getName());\u00a0 \u00a0 }\u00a0 }}\n```\u5728\u5617\u8a66\u6b64\u793a\u4f8b\u4e4b\u524d\uff0c\u8acb\u6309\u7167 [\u300aVertex AI \u5feb\u901f\u5165\u9580\uff1a\u4f7f\u7528\u5ba2\u6236\u7aef\u5eab\u300b](https://cloud.google.com/vertex-ai/docs/start/client-libraries?hl=zh-cn) \u4e2d\u7684 Node.js \u8a2d\u7f6e\u8aaa\u660e\u57f7\u884c\u64cd\u4f5c\u3002\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [Vertex AI Node.js API \u53c3\u8003\u6587\u6a94](https://cloud.google.com/nodejs/docs/reference/aiplatform/latest?hl=zh-cn) \u3002\n\u5982\u9700\u5411 Vertex AI \u9032\u884c\u8eab\u4efd\u9a57\u8b49\uff0c\u8acb\u8a2d\u7f6e\u61c9\u7528\u9ed8\u8a8d\u6191\u64da\u3002  \u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [\u7232\u672c\u5730\u958b\u767c\u74b0\u5883\u8a2d\u7f6e\u8eab\u4efd\u9a57\u8b49](https://cloud.google.com/docs/authentication/provide-credentials-adc?hl=zh-cn#local-dev) \u3002\n [\u5728 GitHub \u4e0a\u67e5\u770b](https://github.com/GoogleCloudPlatform/nodejs-docs-samples/blob/HEAD/ai-platform/snippets/create-custom-job.js) \n```\n/**\u00a0* TODO(developer): Uncomment these variables before running the sample.\\\u00a0* (Not necessary if passing values as arguments)\u00a0*/// const customJobDisplayName = 'YOUR_CUSTOM_JOB_DISPLAY_NAME';// const containerImageUri = 'YOUR_CONTAINER_IMAGE_URI';// const project = 'YOUR_PROJECT_ID';// const location = 'YOUR_PROJECT_LOCATION';// Imports the Google Cloud Job Service Client libraryconst {JobServiceClient} = require('@google-cloud/aiplatform');// Specifies the location of the api endpointconst clientOptions = {\u00a0 apiEndpoint: 'us-central1-aiplatform.googleapis.com',};// Instantiates a clientconst jobServiceClient = new JobServiceClient(clientOptions);async function createCustomJob() {\u00a0 // Configure the parent resource\u00a0 const parent = `projects/${project}/locations/${location}`;\u00a0 const customJob = {\u00a0 \u00a0 displayName: customJobDisplayName,\u00a0 \u00a0 jobSpec: {\u00a0 \u00a0 \u00a0 workerPoolSpecs: [\u00a0 \u00a0 \u00a0 \u00a0 {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 machineSpec: {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 machineType: 'n1-standard-4',\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 acceleratorType: 'NVIDIA_TESLA_K80',\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 acceleratorCount: 1,\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 },\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 replicaCount: 1,\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 containerSpec: {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 imageUri: containerImageUri,\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 command: [],\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 args: [],\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 },\u00a0 \u00a0 \u00a0 \u00a0 },\u00a0 \u00a0 \u00a0 ],\u00a0 \u00a0 },\u00a0 };\u00a0 const request = {parent, customJob};\u00a0 // Create custom job request\u00a0 const [response] = await jobServiceClient.createCustomJob(request);\u00a0 console.log('Create custom job response:\\n', JSON.stringify(response));}createCustomJob();\n```\u5982\u9700\u77ad\u89e3\u5982\u4f55\u5b89\u88dd\u6216\u66f4\u65b0 Python\uff0c\u8acb\u53c3\u95b1 [\u5b89\u88dd Python \u7248 Vertex AI SDK](https://cloud.google.com/vertex-ai/docs/start/use-vertex-ai-python-sdk?hl=zh-cn) \u3002  \u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [   Python API \u53c3\u8003\u6587\u6a94](https://cloud.google.com/python/docs/reference/aiplatform/latest?hl=zh-cn) \u3002\n [\u5728 GitHub \u4e0a\u67e5\u770b](https://github.com/googleapis/python-aiplatform/blob/HEAD/samples/snippets/job_service/create_custom_job_sample.py) \n```\nfrom google.cloud import aiplatformdef create_custom_job_sample(\u00a0 \u00a0 project: str,\u00a0 \u00a0 display_name: str,\u00a0 \u00a0 container_image_uri: str,\u00a0 \u00a0 location: str = \"us-central1\",\u00a0 \u00a0 api_endpoint: str = \"us-central1-aiplatform.googleapis.com\",):\u00a0 \u00a0 # The AI Platform services require regional API endpoints.\u00a0 \u00a0 client_options = {\"api_endpoint\": api_endpoint}\u00a0 \u00a0 # Initialize client that will be used to create and send requests.\u00a0 \u00a0 # This client only needs to be created once, and can be reused for multiple requests.\u00a0 \u00a0 client = aiplatform.gapic.JobServiceClient(client_options=client_options)\u00a0 \u00a0 custom_job = {\u00a0 \u00a0 \u00a0 \u00a0 \"display_name\": display_name,\u00a0 \u00a0 \u00a0 \u00a0 \"job_spec\": {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"worker_pool_specs\": [\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"machine_spec\": {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"machine_type\": \"n1-standard-4\",\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"accelerator_type\": aiplatform.gapic.AcceleratorType.NVIDIA_TESLA_K80,\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"accelerator_count\": 1,\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 },\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"replica_count\": 1,\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"container_spec\": {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"image_uri\": container_image_uri,\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"command\": [],\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"args\": [],\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 },\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 }\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 ]\u00a0 \u00a0 \u00a0 \u00a0 },\u00a0 \u00a0 }\u00a0 \u00a0 parent = f\"projects/{project}/locations/{location}\"\u00a0 \u00a0 response = client.create_custom_job(parent=parent, custom_job=custom_job)\u00a0 \u00a0 print(\"response:\", response)\n```\n\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [\u5275\u5efa CustomJob \u6307\u5357](https://cloud.google.com/vertex-ai/docs/training/create-custom-job?hl=zh-cn) \u3002\n## GPU\n\u5982\u679c\u60a8\u5df2 [\u7de8\u5beb\u8a13\u7df4\u4ee3\u78bc\u4ee5\u4f7f\u7528 GPU](https://cloud.google.com/vertex-ai/docs/training/code-requirements?hl=zh-cn#gpus) \uff0c\u5247\u53ef\u4ee5\u5c07\u5de5\u4f5c\u5668\u6c60\u914d\u7f6e\u7232\u5728\u6bcf\u500b\u865b\u64ec\u6a5f\u4e0a\u4f7f\u7528\u4e00\u500b\u6216\u591a\u500b GPU\u3002\u7232\u4e86\u4f7f\u7528 GPU\uff0c\u60a8\u5fc5\u9808\u4f7f\u7528 A2\u3001N1 \u6216 G2 \u6a5f\u5668\u985e\u578b\u3002\u6b64\u5916\uff0c\u5c07 `n1-highmem-2` \u7b49\u8f03\u5c0f\u7684\u6a5f\u5668\u985e\u578b\u8207 GPU \u642d\u914d\u4f7f\u7528\u53ef\u80fd\u6703\u5c0e\u81f4\u67d0\u4e9b\u5de5\u4f5c\u8ca0\u8f09\u7684\u65e5\u8a8c\u8a18\u9304\u5931\u6557\uff0c\u9019\u662f\u56e0\u7232 CPU \u5b58\u5728\u9650\u5236\u3002\u5982\u679c\u8a13\u7df4\u4f5c\u696d\u505c\u6b62\u8fd4\u56de\u65e5\u8a8c\uff0c\u8acb\u8003\u616e\u9078\u64c7\u66f4\u5927\u7684\u6a5f\u5668\u985e\u578b\u3002\nVertex AI \u652f\u6301\u4ee5\u4e0b\u985e\u578b\u7684\u53ef\u7528\u65bc\u81ea\u5b9a\u7fa9\u8a13\u7df4\u7684 GPU\uff1a\n**\u6ce8\u610f** \uff1a2022 \u5e74 6 \u6708\uff0cNVIDIA \u5ba3\u4f48 NVIDIA K80 GPU \u578b\u865f\u5373\u5c07\u652f\u6301\u7d42\u6b62 (EOS)\u3002\u5c0d\u65bc Google Cloud\uff0cNVIDIA K80 GPU \u5c07\u65bc 2024 \u5e74 5 \u6708 1 \u65e5\u9054\u5230\u652f\u6301\u7d42\u6b62 (EOS) \u671f\u9650\u3002\n- `NVIDIA_A100_80GB`\n- `NVIDIA_TESLA_A100`(NVIDIA A100 40 GB)\n- `NVIDIA_TESLA_K80`\n- `NVIDIA_TESLA_P4`\n- `NVIDIA_TESLA_P100`\n- `NVIDIA_TESLA_T4`\n- `NVIDIA_TESLA_V100`\n- `NVIDIA_L4`\n\u5982\u9700\u8a73\u7d30\u77ad\u89e3\u5404\u7a2e GPU \u7684\u6280\u8853\u898f\u7bc4\uff0c\u8acb\u53c3\u95b1 [\u6709\u95dc\u8a08\u7b97\u5de5\u4f5c\u8ca0\u8f09 GPU \u7684 Compute Engine \u7c21\u77ed\u6587\u6a94](https://cloud.google.com/compute/docs/gpus?hl=zh-cn#gpus-list) \u3002\u5982\u9700\u77ad\u89e3\u6bcf\u7a2e\u6a5f\u5668\u985e\u578b\u9032\u884c\u81ea\u5b9a\u7fa9\u8a13\u7df4\u7684\u8cbb\u7528\uff0c\u8acb\u53c3\u95b1 [\u50f9\u683c](https://cloud.google.com/vertex-ai/pricing?hl=zh-cn) \u3002\n\u5728 `WorkerPoolSpec` \u4e2d\uff0c\u5728 [machineSpec.acceleratorType \u5b57\u6bb5](https://cloud.google.com/vertex-ai/docs/reference/rest/v1/MachineSpec?hl=zh-cn) \u4e2d\u6307\u5b9a\u8981\u4f7f\u7528\u7684 GPU \u985e\u578b\uff0c\u4ee5\u53ca\u5de5\u4f5c\u5668\u6c60\u4e2d\u6bcf\u500b\u865b\u64ec\u6a5f\u7684 GPU \u6578\u91cf\u4ee5\u5728 [machineSpec.acceleratorCount \u5b57\u6bb5](https://cloud.google.com/vertex-ai/docs/reference/rest/v1/MachineSpec?hl=zh-cn) \u4e2d\u4f7f\u7528\u3002\u4f46\u662f\uff0c\u60a8\u5c0d\u9019\u4e9b\u5b57\u6bb5\u7684\u9078\u64c7\u5fc5\u9808\u7b26\u5408\u4ee5\u4e0b\u8981\u6c42\uff1a\n- \u60a8\u9078\u64c7\u7684 GPU \u985e\u578b\u5fc5\u9808\u5728\u57f7\u884c\u81ea\u5b9a\u7fa9\u8a13\u7df4\u7684\u4f4d\u7f6e\u53ef\u7528\u3002\u4e26\u975e\u6240\u6709\u5340\u57df\u90fd\u63d0\u4f9b\u6240\u6709\u985e\u578b\u7684 GPU\u3002 [\u77ad\u89e3\u5340\u57df\u53ef\u7528\u6027](https://cloud.google.com/vertex-ai/docs/general/locations?hl=zh-cn#accelerators) \u3002\n- \u60a8\u7684\u914d\u7f6e\u53ea\u80fd\u4f7f\u7528\u7279\u5b9a\u6578\u91cf\u7684 GPU\u3002\u4f8b\u5982\uff0c\u60a8\u53ef\u4ee5\u5728\u865b\u64ec\u6a5f\u4e0a\u4f7f\u7528 2 \u6216 4 \u500b `NVIDIA_TESLA_T4` GPU\uff0c\u4f46\u4e0d\u80fd\u4f7f\u7528 3 \u500b GPU\u3002\u5982\u9700\u77ad\u89e3\u6bcf\u7a2e GPU \u6709\u6548\u7684 `acceleratorCount` \u503c\uff0c\u8acb\u53c3\u95b1 [\u4ee5\u4e0b\u517c\u5bb9\u6027\u8868](#gpu-compatibility-table) \u3002\n- \u60a8\u5fc5\u9808\u78ba\u4fdd GPU \u914d\u7f6e\u80fd\u5920\u7232\u8981\u4f7f\u7528\u7684 GPU \u6a5f\u5668\u985e\u578b\u63d0\u4f9b\u8db3\u5920\u7684\u865b\u64ec CPU \u548c\u5167\u5b58\u3002\u4f8b\u5982\uff0c\u5982\u679c\u60a8\u5728\u5de5\u4f5c\u5668\u6c60\u4e2d\u4f7f\u7528 `n1-standard-32` \u6a5f\u5668\u985e\u578b\uff0c\u5247\u6bcf\u500b\u865b\u64ec\u6a5f\u90fd\u6709 32 \u500b\u865b\u64ec CPU \u548c 120 GB \u5167\u5b58\u3002\u7531\u65bc\u6bcf\u500b `NVIDIA_TESLA_V100` GPU \u6700\u591a\u53ef\u63d0\u4f9b 12 \u500b\u865b\u64ec CPU \u548c 76 GB \u5167\u5b58\uff0c\u56e0\u6b64\u6bcf\u500b `n1-standard-32` \u865b\u64ec\u6a5f\u5fc5\u9808\u81f3\u5c11\u4f7f\u7528 4 \u500b GPU \u624d\u80fd\u6eff\u8db3\u5176\u9700\u6c42\u3002\uff082 \u500b GPU \u63d0\u4f9b\u7684\u8cc7\u6e90\u5c31\u5df2\u8db3\u5920\uff0c\u60a8\u4e0d\u80fd\u6307\u5b9a 3 \u500b GPU\u3002\uff09 [\u4ee5\u4e0b\u517c\u5bb9\u6027\u8868](#gpu-compatibility-table) \u8003\u616e\u5230\u4e86\u6b64\u8981\u6c42\u3002\u8acb\u6ce8\u610f\uff0c\u5c0d\u4f7f\u7528 GPU \u9032\u884c\u81ea\u5b9a\u7fa9\u8a13\u7df4\u8207\u5728 Compute Engine \u4e2d\u4f7f\u7528 GPU \u7684\u5340\u5225\uff0c\u9084\u5177\u6709\u4ee5\u4e0b\u984d\u5916\u9650\u5236\uff1a- \u5305\u542b 8 \u7684\u914d\u7f6e`NVIDIA_TESLA_K80`GPU \u5728\u5340\u57df\u548c\u5730\u5340\u6700\u591a\u50c5\u80fd\u63d0\u4f9b 208 GB \u7684\u5167\u5b58\u3002\n- \u914d\u5099\u4e86 4 \u500b`NVIDIA_TESLA_P100`GPU \u7684\u914d\u7f6e\u5728\u6240\u6709\u5340\u57df\u548c\u5730\u5340\u6700\u591a\u96bb\u63d0\u4f9b 64 \u500b\u865b\u64ec CPU \u548c 208 GB \u7684\u5167\u5b58\u3002\u4ee5\u4e0b\u517c\u5bb9\u6027\u8868\u5217\u51fa\u4e86 `machineSpec.acceleratorCount` \u7684\u6709\u6548\u503c\uff0c\u5177\u9ad4\u53d6\u6c7a\u65bc\u60a8\u5c0d `machineSpec.machineType` \u548c `machineSpec.acceleratorType` \u7684\u9078\u64c7\uff1a\n| ('\u6bcf\u7a2e\u6a5f\u5668\u985e\u578b\u7684\u6709\u6548 GPU \u6578\u91cf', '\u6a5f\u5668\u985e\u578b') | ('\u6bcf\u7a2e\u6a5f\u5668\u985e\u578b\u7684\u6709\u6548 GPU \u6578\u91cf', 'NVIDIA_A100_80GB') | ('\u6bcf\u7a2e\u6a5f\u5668\u985e\u578b\u7684\u6709\u6548 GPU \u6578\u91cf', 'NVIDIA_TESLA_A100') | ('\u6bcf\u7a2e\u6a5f\u5668\u985e\u578b\u7684\u6709\u6548 GPU \u6578\u91cf', 'NVIDIA_TESLA_K80') | ('\u6bcf\u7a2e\u6a5f\u5668\u985e\u578b\u7684\u6709\u6548 GPU \u6578\u91cf', 'NVIDIA_TESLA_P4') | ('\u6bcf\u7a2e\u6a5f\u5668\u985e\u578b\u7684\u6709\u6548 GPU \u6578\u91cf', 'NVIDIA_TESLA_P100') | ('\u6bcf\u7a2e\u6a5f\u5668\u985e\u578b\u7684\u6709\u6548 GPU \u6578\u91cf', 'NVIDIA_TESLA_T4') | ('\u6bcf\u7a2e\u6a5f\u5668\u985e\u578b\u7684\u6709\u6548 GPU \u6578\u91cf', 'NVIDIA_TESLA_V100') | ('\u6bcf\u7a2e\u6a5f\u5668\u985e\u578b\u7684\u6709\u6548 GPU \u6578\u91cf', 'NVIDIA_L4') |\n|:----------------------------------------------|------------------------------------------------------:|-------------------------------------------------------:|:------------------------------------------------------|:-----------------------------------------------------|:-------------------------------------------------------|:-----------------------------------------------------|:-------------------------------------------------------|-----------------------------------------------:|\n| a2-ultragpu-1g        |              1 |             nan | nan             | nan             | nan             | nan             | nan             |           nan |\n| a2-ultragpu-2g        |              2 |             nan | nan             | nan             | nan             | nan             | nan             |           nan |\n| a2-ultragpu-4g        |              4 |             nan | nan             | nan             | nan             | nan             | nan             |           nan |\n| a2-ultragpu-8g        |              8 |             nan | nan             | nan             | nan             | nan             | nan             |           nan |\n| a2-highgpu-1g         |             nan |              1 | nan             | nan             | nan             | nan             | nan             |           nan |\n| a2-highgpu-2g         |             nan |              2 | nan             | nan             | nan             | nan             | nan             |           nan |\n| a2-highgpu-4g         |             nan |              4 | nan             | nan             | nan             | nan             | nan             |           nan |\n| a2-highgpu-8g         |             nan |              8 | nan             | nan             | nan             | nan             | nan             |           nan |\n| a2-megagpu-16g        |             nan |              16 | nan             | nan             | nan             | nan             | nan             |           nan |\n| n1-standard-4         |             nan |             nan | 1\u30012\u30014\u30018           | 1\u30012\u30014            | 1\u30012\u30014            | 1\u30012\u30014            | 1\u30012\u30014\u30018            |           nan |\n| n1-standard-8         |             nan |             nan | 1\u30012\u30014\u30018           | 1\u30012\u30014            | 1\u30012\u30014            | 1\u30012\u30014            | 1\u30012\u30014\u30018            |           nan |\n| n1-standard-16        |             nan |             nan | 2\u30014\u30018            | 1\u30012\u30014            | 1\u30012\u30014            | 1\u30012\u30014            | 2\u30014\u30018            |           nan |\n| n1-standard-32        |             nan |             nan | 4\u30018             | 2\u30014             | 2\u30014             | 2\u30014             | 4\u30018             |           nan |\n| n1-standard-64        |             nan |             nan | nan             | 4             | nan             | 4             | 8              |           nan |\n| n1-standard-96        |             nan |             nan | nan             | 4             | nan             | 4             | 8              |           nan |\n| n1-highmem-2         |             nan |             nan | 1\u30012\u30014\u30018           | 1\u30012\u30014            | 1\u30012\u30014            | 1\u30012\u30014            | 1\u30012\u30014\u30018            |           nan |\n| n1-highmem-4         |             nan |             nan | 1\u30012\u30014\u30018           | 1\u30012\u30014            | 1\u30012\u30014            | 1\u30012\u30014            | 1\u30012\u30014\u30018            |           nan |\n| n1-highmem-8         |             nan |             nan | 1\u30012\u30014\u30018           | 1\u30012\u30014            | 1\u30012\u30014            | 1\u30012\u30014            | 1\u30012\u30014\u30018            |           nan |\n| n1-highmem-16         |             nan |             nan | 2\u30014\u30018            | 1\u30012\u30014            | 1\u30012\u30014            | 1\u30012\u30014            | 2\u30014\u30018            |           nan |\n| n1-highmem-32         |             nan |             nan | 4\u30018             | 2\u30014             | 2\u30014             | 2\u30014             | 4\u30018             |           nan |\n| n1-highmem-64         |             nan |             nan | nan             | 4             | nan             | 4             | 8              |           nan |\n| n1-highmem-96         |             nan |             nan | nan             | 4             | nan             | 4             | 8              |           nan |\n| n1-highcpu-16         |             nan |             nan | 2\u30014\u30018            | 1\u30012\u30014            | 1\u30012\u30014            | 1\u30012\u30014            | 2\u30014\u30018            |           nan |\n| n1-highcpu-32         |             nan |             nan | 4\u30018             | 2\u30014             | 2\u30014             | 2\u30014             | 4\u30018             |           nan |\n| n1-highcpu-64         |             nan |             nan | 8              | 4             | 4              | 4             | 8              |           nan |\n| n1-highcpu-96         |             nan |             nan | nan             | 4             | nan             | 4             | 8              |           nan |\n| g2-standard-4         |             nan |             nan | nan             | nan             | nan             | nan             | nan             |            1 |\n| g2-standard-8         |             nan |             nan | nan             | nan             | nan             | nan             | nan             |            1 |\n| g2-standard-12        |             nan |             nan | nan             | nan             | nan             | nan             | nan             |            1 |\n| g2-standard-16        |             nan |             nan | nan             | nan             | nan             | nan             | nan             |            1 |\n| g2-standard-24        |             nan |             nan | nan             | nan             | nan             | nan             | nan             |            2 |\n| g2-standard-32        |             nan |             nan | nan             | nan             | nan             | nan             | nan             |            1 |\n| g2-standard-48        |             nan |             nan | nan             | nan             | nan             | nan             | nan             |            4 |\n| g2-standard-96        |             nan |             nan | nan             | nan             | nan             | nan             | nan             |            8 |\n\u4ee5\u4e0b\u793a\u4f8b\u6f14\u793a\u4e86\u5275\u5efa `CustomJob` \u6642\u5728\u4f55\u8655\u6307\u5b9a GPU\uff1a\n\u5728 Google Cloud \u63a7\u5236\u6aaf\u4e2d\uff0c\u60a8\u7121\u6cd5\u76f4\u63a5\u5275\u5efa `CustomJob` \u3002\u4f46\u662f\uff0c\u60a8\u53ef\u4ee5 [\u5275\u5efa\u4e00\u500b\u5275\u5efa CustomJob \u7684 TrainingPipeline](https://cloud.google.com/vertex-ai/docs/training/create-custom-job?hl=zh-cn#create) \u3002\u5728 Google Cloud \u63a7\u5236\u6aaf\u4e2d\u5275\u5efa `TrainingPipeline` \u6642\uff0c\u60a8\u53ef\u4ee5\u5728 **\u8a08\u7b97\u548c\u50f9\u683c** \u6b65\u9a5f\u4e2d\u7232\u6bcf\u500b\u5de5\u4f5c\u5668\u6c60\u6307\u5b9a GPU\u3002\u9996\u5148\u6307\u5b9a **\u6a5f\u5668\u985e\u578b** \u3002\u7136\u5f8c\uff0c\u60a8\u53ef\u4ee5\u5728 **\u52a0\u901f\u5668\u985e\u578b** \u548c **\u52a0\u901f\u5668\u6578\u91cf** \u5b57\u6bb5\u4e2d\u6307\u5b9a GPU \u8a73\u7d30\u4fe1\u606f\u3002\u5982\u9700\u4f7f\u7528 Google Cloud CLI \u5de5\u5177\u6307\u5b9a GPU\uff0c\u60a8\u5fc5\u9808\u4f7f\u7528 [config.yaml \u6587\u4ef6](https://cloud.google.com/sdk/gcloud/reference/ai/custom-jobs/create?hl=zh-cn#--config) \u3002\u4f8b\u5982\uff1a```\nworkerPoolSpecs:\u00a0 machineSpec:\u00a0 \u00a0 machineType: MACHINE_TYPE\u00a0 \u00a0 acceleratorType: ACCELERATOR_TYPE\u00a0 \u00a0 acceleratorCount: ACCELERATOR_COUNT\u00a0 replicaCount: REPLICA_COUNT\u00a0 containerSpec:\u00a0 \u00a0 imageUri: CUSTOM_CONTAINER_IMAGE_URI\n```\n\u7136\u5f8c\uff0c\u904b\u884c\u5982\u4e0b\u547d\u4ee4\uff1a\n```\ngcloud ai custom-jobs create \\\u00a0 --region=LOCATION \\\u00a0 --display-name=JOB_NAME \\\u00a0 --config=config.yaml\n```\u5728\u5617\u8a66\u6b64\u793a\u4f8b\u4e4b\u524d\uff0c\u8acb\u6309\u7167 [\u300aVertex AI \u5feb\u901f\u5165\u9580\uff1a\u4f7f\u7528\u5ba2\u6236\u7aef\u5eab\u300b](https://cloud.google.com/vertex-ai/docs/start/client-libraries?hl=zh-cn) \u4e2d\u7684 Node.js \u8a2d\u7f6e\u8aaa\u660e\u57f7\u884c\u64cd\u4f5c\u3002\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [Vertex AI Node.js API \u53c3\u8003\u6587\u6a94](https://cloud.google.com/nodejs/docs/reference/aiplatform/latest?hl=zh-cn) \u3002\n\u5982\u9700\u5411 Vertex AI \u9032\u884c\u8eab\u4efd\u9a57\u8b49\uff0c\u8acb\u8a2d\u7f6e\u61c9\u7528\u9ed8\u8a8d\u6191\u64da\u3002  \u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [\u7232\u672c\u5730\u958b\u767c\u74b0\u5883\u8a2d\u7f6e\u8eab\u4efd\u9a57\u8b49](https://cloud.google.com/docs/authentication/provide-credentials-adc?hl=zh-cn#local-dev) \u3002\n [\u5728 GitHub \u4e0a\u67e5\u770b](https://github.com/GoogleCloudPlatform/nodejs-docs-samples/blob/HEAD/ai-platform/snippets/create-custom-job.js) \n```\n/**\u00a0* TODO(developer): Uncomment these variables before running the sample.\\\u00a0* (Not necessary if passing values as arguments)\u00a0*/// const customJobDisplayName = 'YOUR_CUSTOM_JOB_DISPLAY_NAME';// const containerImageUri = 'YOUR_CONTAINER_IMAGE_URI';// const project = 'YOUR_PROJECT_ID';// const location = 'YOUR_PROJECT_LOCATION';// Imports the Google Cloud Job Service Client libraryconst {JobServiceClient} = require('@google-cloud/aiplatform');// Specifies the location of the api endpointconst clientOptions = {\u00a0 apiEndpoint: 'us-central1-aiplatform.googleapis.com',};// Instantiates a clientconst jobServiceClient = new JobServiceClient(clientOptions);async function createCustomJob() {\u00a0 // Configure the parent resource\u00a0 const parent = `projects/${project}/locations/${location}`;\u00a0 const customJob = {\u00a0 \u00a0 displayName: customJobDisplayName,\u00a0 \u00a0 jobSpec: {\u00a0 \u00a0 \u00a0 workerPoolSpecs: [\u00a0 \u00a0 \u00a0 \u00a0 {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 machineSpec: {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 machineType: 'n1-standard-4',\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 acceleratorType: 'NVIDIA_TESLA_K80',\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 acceleratorCount: 1,\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 },\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 replicaCount: 1,\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 containerSpec: {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 imageUri: containerImageUri,\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 command: [],\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 args: [],\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 },\u00a0 \u00a0 \u00a0 \u00a0 },\u00a0 \u00a0 \u00a0 ],\u00a0 \u00a0 },\u00a0 };\u00a0 const request = {parent, customJob};\u00a0 // Create custom job request\u00a0 const [response] = await jobServiceClient.createCustomJob(request);\u00a0 console.log('Create custom job response:\\n', JSON.stringify(response));}createCustomJob();\n```\u5982\u9700\u77ad\u89e3\u5982\u4f55\u5b89\u88dd\u6216\u66f4\u65b0 Python\uff0c\u8acb\u53c3\u95b1 [\u5b89\u88dd Python \u7248 Vertex AI SDK](https://cloud.google.com/vertex-ai/docs/start/use-vertex-ai-python-sdk?hl=zh-cn) \u3002  \u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [   Python API \u53c3\u8003\u6587\u6a94](https://cloud.google.com/python/docs/reference/aiplatform/latest?hl=zh-cn) \u3002\n [\u5728 GitHub \u4e0a\u67e5\u770b](https://github.com/googleapis/python-aiplatform/blob/HEAD/samples/snippets/job_service/create_custom_job_sample.py) \n```\nfrom google.cloud import aiplatformdef create_custom_job_sample(\u00a0 \u00a0 project: str,\u00a0 \u00a0 display_name: str,\u00a0 \u00a0 container_image_uri: str,\u00a0 \u00a0 location: str = \"us-central1\",\u00a0 \u00a0 api_endpoint: str = \"us-central1-aiplatform.googleapis.com\",):\u00a0 \u00a0 # The AI Platform services require regional API endpoints.\u00a0 \u00a0 client_options = {\"api_endpoint\": api_endpoint}\u00a0 \u00a0 # Initialize client that will be used to create and send requests.\u00a0 \u00a0 # This client only needs to be created once, and can be reused for multiple requests.\u00a0 \u00a0 client = aiplatform.gapic.JobServiceClient(client_options=client_options)\u00a0 \u00a0 custom_job = {\u00a0 \u00a0 \u00a0 \u00a0 \"display_name\": display_name,\u00a0 \u00a0 \u00a0 \u00a0 \"job_spec\": {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"worker_pool_specs\": [\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"machine_spec\": {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"machine_type\": \"n1-standard-4\",\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"accelerator_type\": aiplatform.gapic.AcceleratorType.NVIDIA_TESLA_K80,\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"accelerator_count\": 1,\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 },\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"replica_count\": 1,\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"container_spec\": {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"image_uri\": container_image_uri,\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"command\": [],\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"args\": [],\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 },\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 }\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 ]\u00a0 \u00a0 \u00a0 \u00a0 },\u00a0 \u00a0 }\u00a0 \u00a0 parent = f\"projects/{project}/locations/{location}\"\u00a0 \u00a0 response = client.create_custom_job(parent=parent, custom_job=custom_job)\u00a0 \u00a0 print(\"response:\", response)\n```\n\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [\u5275\u5efa CustomJob \u6307\u5357](https://cloud.google.com/vertex-ai/docs/training/create-custom-job?hl=zh-cn) \u3002\n## TPU\n\u5982\u9700\u4f7f\u7528 [\u5f35\u91cf\u8655\u7406\u55ae\u5143 (TPU)](https://cloud.google.com/tpu/docs/tpus?hl=zh-cn) \u5728 Vertex AI \u4e0a\u9032\u884c\u81ea\u5b9a\u7fa9\u8a13\u7df4\uff0c\u60a8\u53ef\u4ee5\u5c07\u5de5\u4f5c\u5668\u6c60\u914d\u7f6e\u7232\u4f7f\u7528 [TPU \u865b\u64ec\u6a5f](https://cloud.google.com/tpu/docs/system-architecture-tpu-vm?hl=zh-cn#tpu-vm) \u3002\n\u5728 Vertex AI \u4e2d\u4f7f\u7528 TPU \u865b\u64ec\u6a5f\u6642\uff0c\u60a8\u53ea\u80fd\u4f7f\u7528\u4e00\u500b\u5de5\u4f5c\u5668\u6c60\u9032\u884c\u81ea\u5b9a\u7fa9\u8a13\u7df4\uff0c\u4e26\u4e14\u5fc5\u9808\u5c07\u6b64\u5de5\u4f5c\u5668\u6c60\u914d\u7f6e\u7232\u50c5\u4f7f\u7528\u4e00\u500b\u526f\u672c\u3002\n\u5982\u9700\u5728\u5de5\u4f5c\u5668\u6c60\u4e2d\u4f7f\u7528 TPU \u865b\u64ec\u6a5f\uff0c\u60a8\u5fc5\u9808\u4f7f\u7528\u4ee5\u4e0b\u914d\u7f6e\u4e4b\u4e00\uff1a\n- \u5982\u9700\u4f7f\u7528 [TPU V2](https://cloud.google.com/tpu/docs/system-architecture-tpu-vm?hl=zh-cn#tpu_v2) \u914d\u7f6e TPU \u865b\u64ec\u6a5f\uff0c\u8acb\u5728 `WorkerPoolSpec` \u4e2d\u6307\u5b9a\u4ee5\u4e0b\u5b57\u6bb5\uff1a- \u5c07`machineSpec.machineType`\u8a2d\u7f6e\u7232`cloud-tpu`\u3002\n- \u5c07`machineSpec.acceleratorType`\u8a2d\u7f6e\u7232`TPU_V2`\u3002\n- \u5c0d\u65bc\u55ae\u500b TPU\uff0c\u5c07`machineSpec.acceleratorCount`\u8a2d\u7f6e\u7232`8`\uff1b\u5c0d\u65bc TPU Pod\uff0c\u5247\u8a2d\u7f6e\u7232`32 or multiple of 32`\u3002\n- \u5c07`replicaCount`\u8a2d\u7f6e\u7232`1`\u3002\n- \u5982\u9700\u4f7f\u7528 [TPU V3](https://cloud.google.com/tpu/docs/system-architecture-tpu-vm?hl=zh-cn#tpu_v3) \u914d\u7f6e TPU \u865b\u64ec\u6a5f\uff0c\u8acb\u5728 `WorkerPoolSpec` \u4e2d\u6307\u5b9a\u4ee5\u4e0b\u5b57\u6bb5\uff1a- \u5c07`machineSpec.machineType`\u8a2d\u7f6e\u7232`cloud-tpu`\u3002\n- \u5c07`machineSpec.acceleratorType`\u8a2d\u7f6e\u7232`TPU_V3`\u3002\n- \u5c0d\u65bc\u55ae\u500b TPU\uff0c\u5c07`machineSpec.acceleratorCount`\u8a2d\u7f6e\u7232`8`\uff1b\u5c0d\u65bc TPU Pod\uff0c\u5247\u8a2d\u7f6e\u7232`32+`\u3002\n- \u5c07`replicaCount`\u8a2d\u7f6e\u7232`1`\u3002\u4ee5\u4e0b\u793a\u4f8b\u7a81\u51fa\u5c55\u793a\u77ad\u5982\u4f55\u5728\u5275\u5efa `CustomJob` \u6642\u6307\u5b9a TPU \u865b\u64ec\u6a5f\uff1a\n\u5982\u9700\u4f7f\u7528 gcloud CLI \u5de5\u5177\u6307\u5b9a TPU \u865b\u64ec\u6a5f\uff0c\u60a8\u5fc5\u9808\u4f7f\u7528 [config.yaml \u6587\u4ef6](https://cloud.google.com/sdk/gcloud/reference/ai/custom-jobs/create?hl=zh-cn#--config) \u3002\u4f8b\u5982\uff1a```\nworkerPoolSpecs:\u00a0 machineSpec:\u00a0 \u00a0 machineType: cloud-tpu\u00a0 \u00a0 acceleratorType: TPU_V2\u00a0 \u00a0 acceleratorCount: 8\u00a0 replicaCount: 1\u00a0 containerSpec:\u00a0 \u00a0 imageUri: CUSTOM_CONTAINER_IMAGE_URI\n```\n\u7136\u5f8c\uff0c\u904b\u884c\u5982\u4e0b\u547d\u4ee4\uff1a\n```\ngcloud ai custom-jobs create \\\u00a0 --region=LOCATION \\\u00a0 --display-name=JOB_NAME \\\u00a0 --config=config.yaml\n```\n\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [CustomJob \u5275\u5efa\u6307\u5357](https://cloud.google.com/vertex-ai/docs/training/create-custom-job?hl=zh-cn) \u3002\n## \u5553\u52d5\u78c1\u76e4\u9078\u9805\n\u60a8\u53ef\u4ee5\u9078\u64c7\u7232\u8a13\u7df4\u865b\u64ec\u6a5f\u81ea\u5b9a\u7fa9\u5553\u52d5\u78c1\u76e4\u3002\u5de5\u4f5c\u5668\u6c60\u4e2d\u7684\u6240\u6709\u865b\u64ec\u6a5f\u5747\u4f7f\u7528\u76f8\u540c\u985e\u578b\u548c\u5927\u5c0f\u7684\u5553\u52d5\u78c1\u76e4\u3002\n- **\u5982\u9700\u81ea\u5b9a\u7fa9\u6bcf\u500b\u8a13\u7df4\u865b\u64ec\u6a5f\u4f7f\u7528\u7684\u5553\u52d5\u78c1\u76e4\u985e\u578b** \uff0c\u8acb\u5728 `WorkerPoolSpec` \u4e2d\u6307\u5b9a [diskSpec.bootDiskType \u5b57\u6bb5](https://cloud.google.com/vertex-ai/docs/reference/rest/v1/CustomJobSpec?hl=zh-cn#diskspec) \u3002\u60a8\u53ef\u4ee5\u5c07\u6b64\u5b57\u6bb5\u8a2d\u7f6e\u7232 `pd-standard` \u4ee5\u4f7f\u7528\u6a19\u6e96\u786c\u76e4\u652f\u6301\u7684\u6a19\u6e96\u6c38\u4e45\u6027\u78c1\u76e4\uff0c\u4e5f\u53ef\u4ee5\u5c07\u5176\u8a2d\u7f6e\u7232 `pd-ssd` \u4ee5\u4f7f\u7528\u7531\u56fa\u614b\u786c\u76e4\u652f\u6301\u7684 SSD \u6c38\u4e45\u6027\u78c1\u76e4\u3002\u9ed8\u8a8d\u503c\u7232 `pd-ssd` \u3002\u5982\u679c\u8a13\u7df4\u4ee3\u78bc\u5c0d\u78c1\u76e4\u57f7\u884c\u8b80\u5beb\u64cd\u4f5c\uff0c\u5247\u4f7f\u7528 `pd-ssd` \u53ef\u80fd\u6703\u589e\u52a0\u6027\u80fd\u3002\u77ad\u89e3 [\u78c1\u76e4\u985e\u578b](https://cloud.google.com/compute/docs/disks?hl=zh-cn#disk-types) \u3002\n- **\u5982\u9700\u81ea\u5b9a\u7fa9\u6bcf\u500b\u8a13\u7df4\u865b\u64ec\u6a5f\u4f7f\u7528\u7684\u5553\u52d5\u78c1\u76e4\u7684\u5927\u5c0f\uff08\u4ee5 GB \u7232\u55ae\u4f4d\uff09** \uff0c\u5728 `WorkerPoolSpec` \u4e2d\u6307\u5b9a [diskSpec.bootDiskSizeGb \u5b57\u6bb5](https://cloud.google.com/vertex-ai/docs/reference/rest/v1/CustomJobSpec?hl=zh-cn#diskspec) \u3002\u60a8\u53ef\u5c07\u6b64\u5b57\u6bb5\u8a2d\u7232\u4e00\u500b\u4ecb\u65bc 100 \u5230 64000\uff08\u542b\uff09\u4e4b\u9593\u7684\u6574\u6578\u3002\u9ed8\u8a8d\u503c\u7232 `100` \u3002\u5982\u679c\u60a8\u7684\u8a13\u7df4\u4ee3\u78bc\u5c07\u5927\u91cf\u81e8\u6642\u6578\u64da\u5beb\u5165\u78c1\u76e4\uff0c\u5247\u53ef\u80fd\u9700\u8981\u589e\u52a0\u5553\u52d5\u78c1\u76e4\u5927\u5c0f\u3002\u8acb\u6ce8\u610f\uff0c\u60a8\u5beb\u5165\u5553\u52d5\u78c1\u76e4\u7684\u4efb\u4f55\u6578\u64da\u90fd\u662f\u81e8\u6642\u7684\uff0c\u5728\u8a13\u7df4\u5b8c\u6210\u5f8c\uff0c\u60a8\u4fbf\u7121\u6cd5\u6aa2\u7d22\u9019\u4e9b\u6578\u64da\u3002\n\u66f4\u6539\u5553\u52d5\u78c1\u76e4\u7684\u985e\u578b\u548c\u5927\u5c0f\u6703\u5f71\u97ff [\u81ea\u5b9a\u7fa9\u8a13\u7df4\u50f9\u683c](https://cloud.google.com/vertex-ai/pricing?hl=zh-cn#training) \u3002\n\u4ee5\u4e0b\u793a\u4f8b\u7a81\u51fa\u986f\u793a\u60a8\u5728\u5275\u5efa `CustomJob` \u6642\u6307\u5b9a\u5553\u52d5\u78c1\u76e4\u9078\u9805\u7684\u4f4d\u7f6e\uff1a\n\u5728 Google Cloud \u63a7\u5236\u6aaf\u4e2d\uff0c\u60a8\u7121\u6cd5\u76f4\u63a5\u5275\u5efa `CustomJob` \u3002\u4f46\u662f\uff0c\u60a8\u53ef\u4ee5 [\u5275\u5efa\u4e00\u500b\u5275\u5efa CustomJob \u7684 TrainingPipeline](https://cloud.google.com/vertex-ai/docs/training/create-custom-job?hl=zh-cn#create) \u3002\u5728 Google Cloud \u63a7\u5236\u6aaf\u4e2d\u5275\u5efa `TrainingPipeline` \u6642\uff0c\u60a8\u53ef\u4ee5\u5728 **\u8a08\u7b97\u548c\u50f9\u683c** \u6b65\u9a5f\u7684 **\u78c1\u76e4\u985e\u578b** \u4e0b\u62c9\u5217\u8868\u548c **\u78c1\u76e4\u5927\u5c0f (GB)** \u5b57\u6bb5\u4e2d\u7232\u6bcf\u500b\u5de5\u4f5c\u5668\u6c60\u6307\u5b9a\u5553\u52d5\u78c1\u76e4\u9078\u9805\u3002\u5982\u9700\u4f7f\u7528 Google Cloud CLI \u5de5\u5177\u6307\u5b9a\u5553\u52d5\u78c1\u76e4\u9078\u9805\uff0c\u60a8\u5fc5\u9808\u4f7f\u7528 [config.yaml \u6587\u4ef6](https://cloud.google.com/sdk/gcloud/reference/ai/custom-jobs/create?hl=zh-cn#--config) \u3002\u4f8b\u5982\uff1a```\nworkerPoolSpecs:\u00a0 machineSpec:\u00a0 \u00a0 machineType: MACHINE_TYPE\u00a0 diskSpec:\u00a0 \u00a0 bootDiskType: DISK_TYPE\u00a0 \u00a0 bootDiskSizeGb: DISK_SIZE\u00a0 replicaCount: REPLICA_COUNT\u00a0 containerSpec:\u00a0 \u00a0 imageUri: CUSTOM_CONTAINER_IMAGE_URI\n```\n\u7136\u5f8c\uff0c\u904b\u884c\u5982\u4e0b\u547d\u4ee4\uff1a\n```\ngcloud ai custom-jobs create \\\u00a0 --region=LOCATION \\\u00a0 --display-name=JOB_NAME \\\u00a0 --config=config.yaml\n```\n\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [\u5275\u5efa CustomJob \u6307\u5357](https://cloud.google.com/vertex-ai/docs/training/create-custom-job?hl=zh-cn) \u3002\n## \u5f8c\u7e8c\u6b65\u9a5f\n- \u77ad\u89e3\u5982\u4f55 [\u5275\u5efa\u6c38\u4e45\u6027\u8cc7\u6e90](https://cloud.google.com/vertex-ai/docs/training/persistent-resource-overview?hl=zh-cn) \u4ee5\u904b\u884c\u81ea\u5b9a\u7fa9\u8a13\u7df4\u4f5c\u696d\u3002\n- \u77ad\u89e3\u5982\u4f55\u901a\u904e [\u5275\u5efa CustomJob](https://cloud.google.com/vertex-ai/docs/training/create-custom-job?hl=zh-cn) \u57f7\u884c\u81ea\u5b9a\u7fa9\u8a13\u7df4\u3002", "guide": "Vertex AI"}