{"title": "Vertex AI - Export metadata and annotations from a dataset", "url": "https://cloud.google.com/vertex-ai/docs/start/introduction-unified-platform", "abstract": "# Vertex AI - Export metadata and annotations from a dataset\nVertex AI lets you export the metadata and annotation sets from a `Dataset` resource. This functionality can be useful if you wish to maintain a record of a specific collection of annotation changes, additions, or deletions.\nWhen you export a `Dataset` , Vertex AI creates one or more [JSON Lines](https://jsonlines.org/) files that contain your `Dataset` 's metadata and annotations, and saves these JSON Lines files to a Cloud Storage directory of your choice.\nYou can export image, text, and video `Dataset` resources. You cannot export tabular `Dataset` resources.\nExporting a `Dataset` doesn't create additional copies of the image, text, or video data that your `Dataset` is based on. The JSON Lines files created by the export processes include the original Cloud Storage URIs for your data that you specified when you [imported that data into theDataset](/vertex-ai/docs/datasets/create-dataset-api#import-data) .\n", "content": "## Export a Dataset using the Google Cloud console or the API\nYou can use the Google Cloud console or the Vertex AI API to export a `Dataset` . Follow the steps in the corresponding tab:\n- In the Google Cloud console, in the Vertex AI section, go to the **Datasets** page. [Go to the Datasets page](https://console.cloud.google.com/vertex-ai/datasets) \n- In the **Region** drop-down list, select the location where the `Dataset` is stored.\n- Find the row of the `Dataset` . You can export metadata and annotations for all [annotation sets](/vertex-ai/docs/datasets/create-annotation-set) or for a specific annotation set:- **If you want to export metadata and annotations for all of theDataset's annotation sets,** then click **Viewmore more_vert** and then click **Export dataset** .This tells Vertex AI to create a set of JSON Lines files for each annotation set.\n- **If you want to export metadata and annotations for a specific annotationset,** then do the following:- Click **Expand node arrow_drop_down** to show rows for each of the `Dataset` 's annotation sets.\n- In the row of the annotation set that you want to export, click **Viewmore more_vert** and then click **Export annotation set** .\nThis tells Vertex AI to create a set of JSON Lines files for the annotation set that you specified.\n- In the **Export data** dialog, enter a Cloud Storage directory where you want Vertex AI to save the exported JSON Lines files. Click **Export** .### Get the Dataset's IDTo export a `Dataset` , you must know the numerical ID of the `Dataset` . If you know the display name of the `Dataset` but not the ID, expand the following section to learn how to get the ID using the API:Alternatively, you can get the `Dataset` 's ID from the Google Cloud console: Go to the Vertex AI **Datasets** page and find the number in the **ID** column.\n [Go to the Datasets page](https://console.cloud.google.com/vertex-ai/datasets) \n### Export one or more annotation setsBefore using any of the request data, make the following replacements:- : The region where the `Dataset` is stored. For example, `us-central` .\n- : Your [project ID](/resource-manager/docs/creating-managing-projects#identifiers) .\n- : The numerical ID of the `Dataset` .\n- : Cloud Storage URI (beginning with `gs://` ) of a directory where you want Vertex AI to save the exported JSON Lines files. This must be in a Cloud Storage bucket that you have access to, but the directory does not need to exist yet.\n- : A filter string that determines which [annotationsets](/vertex-ai/docs/datasets/create-annotation-set) get exported.- **If you want to export metadata and annotations for all of theDataset's annotation sets,** replace with an empty string (or omit the `annotationsFilter` field from the request body entirely). This tells Vertex AI to create a set of JSON Lines files for each annotation set.\n- **If you want to export metadata and annotations for a specific annotationset,** replace with the following:```\nlabels.aiplatform.googleapis.com/annotation_set_name=ANNOTATION_SET_ID\n```This tells Vertex AI to create a set of JSON Lines files for the annotation set with the numerical ID .To find the numerical ID of the annotation set that you want to specify, view the annotation set in the Google Cloud console and look for the value following `annotationSetId` in the URL.\nHTTP method and URL:\n```\nPOST https://LOCATION-aiplatform.googleapis.com/v1/projects/PROJECT_ID/locations/LOCATION/datasets/DATASET_ID:export\n```\nRequest JSON body:\n```\n{\n \"exportConfig\": {\n \"gcsDestination\": {\n  \"outputUriPrefix\": \"EXPORT_DIRECTORY\"\n },\n \"annotationsFilter\": \"FILTER\"\n }\n}\n```\nTo send your request, choose one of these options:\n **Note:** Ensure you have set the [GOOGLE_APPLICATION_CREDENTIALS](/docs/authentication/provide-credentials-adc#local-key) environment variable to the path for your service account private key file.\nSave the request body in a file named `request.json` ,  and execute the following command:\n```\ncurl -X POST \\ -H \"Authorization: Bearer $(gcloud auth application-default print-access-token)\" \\ -H \"Content-Type: application/json; charset=utf-8\" \\ -d @request.json \\ \"https://LOCATION-aiplatform.googleapis.com/v1/projects/PROJECT_ID/locations/LOCATION/datasets/DATASET_ID:export\"\n``` **Note:** Ensure you have set the [GOOGLE_APPLICATION_CREDENTIALS](/docs/authentication/provide-credentials-adc#local-key) environment variable to the path for your service account private key file.\nSave the request body in a file named `request.json` ,  and execute the following command:\n```\n$cred = gcloud auth application-default print-access-token$headers = @{ \"Authorization\" = \"Bearer $cred\" }Invoke-WebRequest ` -Method POST ` -Headers $headers ` -ContentType: \"application/json; charset=utf-8\" ` -InFile request.json ` -Uri \"https://LOCATION-aiplatform.googleapis.com/v1/projects/PROJECT_ID/locations/LOCATION/datasets/DATASET_ID:export\" | Select-Object -Expand Content\n```\nYou should receive a JSON response similar to the following:\n```\n{\n \"name\": \"projects/PROJECT_NUMBER/locations/LOCATION/datasets/DATASET_ID/operations/OPERATION_ID\",\n \"metadata\": {\n \"@type\": \"type.googleapis.com/google.cloud.aiplatform.v1.ExportDataOperationMetadata\",\n \"genericMetadata\": {\n  \"createTime\": \"2021-02-17T00:54:58.827429Z\",\n  \"updateTime\": \"2021-02-17T00:54:58.827429Z\"\n },\n \"gcsOutputDirectory\": \"EXPORT_DIRECTORY/export-data-DATASET_DISPLAY_NAME-2021-02-17T00:54:58.734772Z\"\n }\n}\n```Some requests start long-running operations that require time to complete. These requests return an operation name, which you can use to view the operation's status or cancel the operation. Vertex AI provides helper methods to make calls against long-running operations. For more information, see [Working with long-runningoperations](/vertex-ai/docs/general/long-running-operations) .\n## Exported files explained\nWithin the export directory that you specified in the previous section, Vertex AI creates a new directory labeled with the `Dataset` 's display name and a timestamp; for example, `export-data-` `` `-2021-02-17T00:54:58.734772Z` . Within this directory, you can find a subdirectory for each annotation set that you exported.\nFor each annotation set, you can find one or more JSON Lines files. Each row of each JSON Lines file represents a data item from the annotation set. Each data item may contain metadata and annotations that you specified when you imported the data to Vertex AI, as well as metadata and annotations that you added after importing the data. For example, if you [requested datalabeling](/vertex-ai/docs/datasets/data-labeling-job) for your `Dataset` or if you manually added labels or annotations to the `Dataset` in the Google Cloud console, then this information is included in the exported files.\nIf you export multiple annotation sets, the same data items might appear in multiple JSON Lines files. For example, if you export an image `Dataset` with multiple annotation sets, one JSON Lines file might contain a data item with a single-label classification annotation; another JSON Lines file for a different annotation set might contain the same data item, but with an object detection annotation instead.\nThe format of the exported files matches the format of the JSON Lines import files that you can use to [import data intoVertex AI](/vertex-ai/docs/datasets/create-dataset-api#import-data) . This format depends on the data type (image, tabular, text, video) and objective (such as object tracking, entity extraction, or classification). For example, if you export an annotation set for single-label image classification, then each line of each JSON Lines file is formatted according to the [gs://google-cloud-aiplatform/schema/dataset/ioformat/image_classification_single_label_io_format_1.0.0.yamlschemafile](https://storage.cloud.google.com/google-cloud-aiplatform/schema/dataset/ioformat/image_classification_single_label_io_format_1.0.0.yaml) , as described in [Preparing image data](/vertex-ai/docs/training-overview#image_data) .\n**Note:** If you export a dataset with annotations, verify the fields established by the export before attempting to import the data for a specific objective. For example, if you export an image dataset with no annotations, the exported JSON lines file contains an empty `classificationAnnotations` array. This field is only applicable to specific objectives and their corresponding YAML schema files. See the [prepare training data page](/vertex-ai/docs/training-overview) for your data type for more information.\nTo learn more about the different JSON lines formats for different types of annotation sets, view the following guides:\n- [Preparing text data](/vertex-ai/docs/training-overview#text_data) \n- [Preparing video data](/vertex-ai/docs/training-overview#video_data) ## What's next\n- Learn how to [request data labeling](/vertex-ai/docs/datasets/data-labeling-job) .\n- Read more about [working with datasets inVertex AI](/vertex-ai/docs/training-overview) .", "guide": "Vertex AI"}