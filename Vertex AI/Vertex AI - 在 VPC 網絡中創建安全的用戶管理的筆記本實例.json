{"title": "Vertex AI - \u5728 VPC \u7db2\u7d61\u4e2d\u5275\u5efa\u5b89\u5168\u7684\u7528\u6236\u7ba1\u7406\u7684\u7b46\u8a18\u672c\u5be6\u4f8b", "url": "https://cloud.google.com/vertex-ai/docs/general/vpc-standalone?hl=zh-cn", "abstract": "# Vertex AI - \u5728 VPC \u7db2\u7d61\u4e2d\u5275\u5efa\u5b89\u5168\u7684\u7528\u6236\u7ba1\u7406\u7684\u7b46\u8a18\u672c\u5be6\u4f8b\nVertex AI Workbench \u7528\u6236\u7ba1\u7406\u7684\u7b46\u8a18\u672c [\u5df2\u68c4\u7528](https://cloud.google.com/vertex-ai/docs/deprecations?hl=zh-cn) \u3002\u81ea 2025 \u5e74 1 \u6708 30 \u65e5\u8d77\uff0c\u6211\u5011\u5c07\u7d42\u6b62\u5c0d\u7528\u6236\u7ba1\u7406\u7684\u7b46\u8a18\u672c\u7684\u652f\u6301\uff0c\u4e26\u4e14\u5c07\u4e0d\u518d\u652f\u6301\u5275\u5efa\u7528\u6236\u7ba1\u7406\u7684\u7b46\u8a18\u672c\u5be6\u4f8b\u3002\u73fe\u6709\u5be6\u4f8b\u4ecd\u7136\u53ef\u4ee5\u6b63\u5e38\u4f7f\u7528\uff0c\u4f46\u6211\u5011\u5c07\u4e0d\u518d\u63d0\u4f9b\u88dc\u4e01\u3001\u66f4\u65b0\u548c\u5347\u7d1a\u3002\u5982\u9700\u7e7c\u7e8c\u4f7f\u7528 Vertex AI Workbench\uff0c\u6211\u5011\u5efa\u8b70\u60a8 [\u5c07\u7528\u6236\u7ba1\u7406\u7684\u7b46\u8a18\u672c\u5be6\u4f8b\u9077\u79fb\u5230 Vertex AI Workbench \u5be6\u4f8b](https://cloud.google.com/vertex-ai/docs/workbench/user-managed/migrate-to-instances?hl=zh-cn) \u3002\u672c\u6559\u7a0b\u9069\u7528\u65bc\u4f01\u696d\u6578\u64da\u79d1\u5b78\u5bb6\u3001\u7814\u7a76\u4eba\u54e1\u548c\u7db2\u7d61\u7ba1\u7406\u54e1\u3002\u5b83\u5c55\u793a\u77ad\u5982\u4f55\u5728 Virtual Private Cloud (VPC) \u7db2\u7d61\u4e2d\u5275\u5efa\u7528\u6236\u7ba1\u7406\u7684\u7b46\u8a18\u672c\u5be6\u4f8b\u4f86\u4fdd\u8b77\u5be6\u4f8b\u3002\n [VPC \u7db2\u7d61](https://cloud.google.com/vpc/docs/overview?hl=zh-cn) \u662f\u7269\u7406\u7db2\u7d61\u7684\u865b\u64ec\u7248\u672c\uff0c\u5728 Google \u7684\u751f\u7522\u7db2\u7d61\u5167\u5be6\u73fe\u5b83\u662f\u5c08\u7528\u7db2\u7d61\uff0c\u5177\u6709\u81ea\u5df1\u7684\u5c08\u7528 IP \u5730\u5740\u3001\u5b50\u7db2\u548c\u7db2\u7d61\u7db2\u95dc\u3002\u5728\u4f01\u696d\u4e2d\uff0c\u4f7f\u7528 VPC \u7db2\u7d61\u901a\u904e\u63a7\u5236\u5f9e\u5176\u4ed6\u7db2\u7d61\u548c\u4e92\u806f\u7db2\u8a2a\u554f\u6578\u64da\u548c\u5be6\u4f8b\u4f86\u4fdd\u8b77\u6578\u64da\u548c\u5be6\u4f8b\u3002\n\u672c\u6559\u7a0b\u4e2d\u7684 VPC \u7db2\u7d61\u662f\u4e00\u500b\u7368\u7acb\u7684\u7db2\u7d61\u3002\u4f46\u662f\uff0c\u60a8\u53ef\u4ee5\u5c07 VPC \u7db2\u7d61\u5f9e\u4e00\u500b\u9805\u76ee\uff08\u7a31\u7232\u5bbf\u4e3b\u9805\u76ee\uff09\u5171\u4eab\u5230\u60a8\u7684 Google Cloud \u7d44\u7e54\u4e2d\u7684\u5176\u4ed6\u9805\u76ee\u3002\u5982\u9700\u8a73\u7d30\u77ad\u89e3\u8981\u4f7f\u7528\u7684 VPC \u7db2\u7d61\u985e\u578b\uff0c\u8acb\u53c3\u95b1 [\u55ae\u500b VPC \u7db2\u7d61\u548c\u5171\u4eab VPC](https://cloud.google.com/architecture/best-practices-vpc-design?hl=zh-cn#single_vpc_network_and) \u3002\n\u9075\u5faa\u7db2\u7d61\u5b89\u5168\u6700\u4f73\u5be6\u8e10\uff0c\u672c\u6559\u7a0b\u4e2d\u7684 VPC \u7db2\u7d61\u4f7f\u7528 [Cloud Router \u8def\u7531\u5668](https://cloud.google.com/network-connectivity/docs/router/concepts/overview?hl=zh-cn) \u3001 [Cloud NAT](https://cloud.google.com/nat/docs/overview?hl=zh-cn) \u548c [\u5c08\u7528 Google \u8a2a\u554f\u901a\u9053](https://cloud.google.com/vpc/docs/private-google-access?hl=zh-cn) \u901a\u904e\u4ee5\u4e0b\u65b9\u5f0f\u4fdd\u8b77\u5be6\u4f8b\uff1a- \u7528\u6236\u7ba1\u7406\u7684\u7b46\u8a18\u672c\u5be6\u4f8b\u6c92\u6709\u5916\u90e8 IP \u5730\u5740\u3002\n- \u8a72\u5be6\u4f8b\u5177\u6709\u901a\u904e\u5340\u57df Cloud Router \u548c Cloud NAT \u7db2\u95dc\u9032\u884c\u7684\u51fa\u7ad9\u4e92\u806f\u7db2\u8a2a\u554f\u6b0a\u9650\uff0c\u56e0\u6b64\u60a8\u53ef\u4ee5\u5b89\u88dd\u8edf\u4ef6\u5305\u6216\u5176\u4ed6\u4f9d\u8cf4\u9805\u3002Cloud NAT \u5141\u8a31\u51fa\u7ad9\u9023\u63a5\u548c\u5c0d\u9019\u4e9b\u9023\u63a5\u7684\u5165\u7ad9\u97ff\u61c9\u3002\u5b83\u4e0d\u5141\u8a31\u4f86\u81ea\u4e92\u806f\u7db2\u7684\u672a\u7d93\u8acb\u6c42\u7684\u5165\u7ad9\u8acb\u6c42\u3002\n- \u8a72\u5be6\u4f8b\u4f7f\u7528\u5c08\u7528 Google \u8a2a\u554f\u901a\u9053\u8a2a\u554f Google API \u548c\u670d\u52d9\u7684\u5916\u90e8 IP \u5730\u5740\u3002\n\u672c\u6559\u7a0b\u9084\u4ecb\u7d39\u77ad\u5982\u4f55\u57f7\u884c\u4ee5\u4e0b\u64cd\u4f5c\uff1a- \u5275\u5efa\u5553\u52d5\u5f8c\u8173\u672c\uff0c\u4ee5\u5c07 GitHub \u4ee3\u78bc\u5eab\u81ea\u52d5\u514b\u9686\u5230\u65b0\u5275\u5efa\u7684\u7528\u6236\u7ba1\u7406\u7684\u7b46\u8a18\u672c\u5be6\u4f8b\u4e2d\u3002\n- \u4f7f\u7528 [Cloud Monitoring](https://cloud.google.com/vertex-ai/docs/general/monitoring-metrics?hl=zh-cn) \u76e3\u63a7\u7528\u6236\u7ba1\u7406\u7684\u7b46\u8a18\u672c\u5be6\u4f8b\u3002\n- \u4f7f\u7528 [Compute Engine](https://cloud.google.com/compute/docs/instances/schedule-instance-start-stop?hl=zh-cn) API \u81ea\u52d5\u5553\u52d5\u548c\u505c\u6b62\u5be6\u4f8b\u4ee5\u512a\u5316\u8cbb\u7528\u3002\n", "content": "## \u76ee\u6a19\n- \u5275\u5efa VPC \u7db2\u7d61\u4e26\u6dfb\u52a0\u5553\u7528\u4e86\u5c08\u7528 Google \u8a2a\u554f\u901a\u9053\u7684\u5b50\u7db2\u3002\n- \u7232 VPC \u7db2\u7d61\u5275\u5efa Cloud Router \u8def\u7531\u5668\u548c Cloud NAT\u3002\n- \u4f7f\u7528\u514b\u9686 [Google Cloud Generative AI](https://github.com/GoogleCloudPlatform/generative-ai/) GitHub \u4ee3\u78bc\u5eab\u7684\u5553\u52d5\u5f8c\u8173\u672c\uff0c\u5728\u5b50\u7db2\u4e2d\u5275\u5efa\u4e00\u500b\u7528\u6236\u7ba1\u7406\u7684\u7b46\u8a18\u672c\u5be6\u4f8b\u3002\n- \u7232\u5be6\u4f8b\u5553\u7528 Cloud Monitoring\u3002\n- \u5275\u5efa\u865b\u64ec\u6a5f\u5be6\u4f8b\u6642\u9593\u8868\u4e26\u5c07\u5176\u8207\u5be6\u4f8b\u76f8\u95dc\u806f\u3002\n## \u8cbb\u7528\nTitles in dynamic includes are not used anywhere, and we should avoid paying to translate them\u5728\u672c\u6587\u6a94\u4e2d\uff0c\u60a8\u5c07\u4f7f\u7528 Google Cloud \u7684\u4ee5\u4e0b\u6536\u8cbb\u7d44\u4ef6\uff1a- [Cloud NAT](https://cloud.google.com/nat/pricing?hl=zh-cn) \n- [Compute Engine](https://cloud.google.com/compute/all-pricing?hl=zh-cn) \n- [Cloud Storage](https://cloud.google.com/storage/pricing?hl=zh-cn) \n- [Vertex AI](https://cloud.google.com/vertex-ai/pricing?hl=zh-cn) \n- [Virtual Private Cloud](https://cloud.google.com/vpc/pricing?hl=zh-cn) \n\u60a8\u53ef\u4f7f\u7528 [\u50f9\u683c\u8a08\u7b97\u5668](https://cloud.google.com/products/calculator?hl=zh-cn) \u6839\u64da\u60a8\u7684\u9810\u8a08\u4f7f\u7528\u60c5\u6cc1\u4f86\u4f30\u7b97\u8cbb\u7528\u3002 \nTitles in dynamic includes are not used anywhere, and we should avoid paying to translate them\u5b8c\u6210\u672c\u6587\u6a94\u4e2d\u63cf\u8ff0\u7684\u4efb\u52d9\u5f8c\uff0c\u60a8\u53ef\u4ee5\u901a\u904e\u522a\u9664\u6240\u5275\u5efa\u7684\u8cc7\u6e90\u4f86\u907f\u514d\u7e7c\u7e8c\u8a08\u8cbb\u3002\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [\u6e05\u7406](#clean-up) \u3002## \u9808\u77e5\u4e8b\u9805\n- Titles in dynamic includes are not used anywhere, and we should avoid paying to translate them\n- \u5728 Google Cloud Console \u4e2d\uff0c\u8f49\u5230\u9805\u76ee\u9078\u64c7\u5668\u9801\u9762\u3002 [\u8f49\u5230\u201c\u9805\u76ee\u9078\u64c7\u5668\u201d](https://console.cloud.google.com/projectselector2/home/dashboard?hl=zh-cn) \n- \u9078\u64c7\u6216\u5275\u5efa Google Cloud \u9805\u76ee\u3002\n- Titles in dynamic includes are not used anywhere, and we should avoid paying to translate them\n- [\u78ba\u4fdd\u60a8\u7684 Google Cloud \u9805\u76ee\u5df2\u5553\u7528\u7d50\u7b97\u529f\u80fd](https://cloud.google.com/billing/docs/how-to/verify-billing-enabled?hl=zh-cn#console) \u3002\n- \u6253\u958b [Cloud Shell](https://cloud.google.com/shell/docs/launching-cloud-shell-editor?hl=zh-cn) \u4ee5\u57f7\u884c\u672c\u6559\u7a0b\u4e2d\u5217\u51fa\u7684\u547d\u4ee4\u3002Cloud Shell \u662f Google Cloud \u7684\u4ea4\u4e92\u5f0f Shell \u74b0\u5883\uff0c\u53ef\u8b93\u60a8\u901a\u904e\u7db2\u7d61\u700f\u89bd\u5668\u7ba1\u7406\u9805\u76ee\u548c\u8cc7\u6e90\u3002\n- [\u8f49\u5230 Cloud Shell](https://ssh.cloud.google.com/cloudshell/editor?hl=zh-cn) \n- \u5728 Cloud Shell \u4e2d\uff0c\u5c07\u7576\u524d\u9805\u76ee\u8a2d\u7f6e\u7232\u60a8\u7684 Google Cloud \u9805\u76ee ID\uff0c\u4e26\u5c07\u540c\u4e00\u9805\u76ee ID \u5b58\u5132\u5728`projectid`shell \u8b8a\u91cf\u4e2d\uff1a```\n projectid=\"PROJECT_ID\"\n gcloud config set project ${projectid}\n```\u5c07\u66ff\u63db\u7232\u60a8\u7684\u9805\u76ee ID\u3002\u5982\u6709\u5fc5\u8981\uff0c\u60a8\u53ef\u4ee5\u5728 Google Cloud \u63a7\u5236\u6aaf\u4e2d\u67e5\u627e\u9805\u76ee ID\u3002\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [\u67e5\u627e\u9805\u76ee ID](https://cloud.google.com/vertex-ai/docs/tutorials/tabular-bq-prediction/prerequisites?hl=zh-cn#find-project-id) \n- Titles in dynamic includes are not used anywhere, and we should avoid paying to translate them\n- Enable the IAM, Compute Engine, Notebooks, Cloud Storage, and Vertex AI APIs:```\ngcloud services enable iam.googleapis.com \u00a0compute.googleapis.com notebooks.googleapis.com storage.googleapis.com aiplatform.googleapis.com\n```\n- Titles in dynamic includes are not used anywhere, and we should avoid paying to translate them\n- \u5411\u60a8\u7684 Google \u8cec\u865f\u6388\u4e88\u89d2\u8272\u3002\u5c0d\u4ee5\u4e0b\u6bcf\u500b IAM \u89d2\u8272\u904b\u884c\u4ee5\u4e0b\u547d\u4ee4\u4e00\u6b21\uff1a `roles/compute.networkAdmin, roles/compute.securityAdmin, roles/compute.instanceAdmin, roles/notebooks.admin, roles/resourcemanager.projectIamAdmin, roles/iam.serviceAccountAdmin, roles/iam.serviceAccountUser, roles/storage.Admin````\ngcloud projects add-iam-policy-binding PROJECT_ID --member=\"user:EMAIL_ADDRESS\" --role=ROLE\n```- \u5c07``\u66ff\u63db\u7232\u60a8\u7684\u9805\u76ee ID\u3002\n- \u5c07``\u66ff\u63db\u7232\u60a8\u7684\u96fb\u5b50\u90f5\u4ef6\u5730\u5740\u3002\n- \u5c07``\u66ff\u63db\u7232\u6bcf\u500b\u89d2\u8272\u3002## \u5275\u5efa\u548c\u914d\u7f6e\u7368\u7acb VPC\n- \u5275\u5efa\u540d\u7232 `securevertex-vpc` \u7684 VPC \u7db2\u7d61\uff1a```\ngcloud compute networks create securevertex-vpc --subnet-mode=custom\n```\n- \u5275\u5efa\u4e00\u500b\u540d\u7232 `securevertex-subnet-a` \u7684\u5b50\u7db2\uff0c\u5176\u4e3b\u8981 IPv4 \u7bc4\u570d\u7232 `10.10.10.0/29` \uff1a```\ngcloud compute networks subnets create securevertex-subnet-a --range=10.10.10.0/29 --network=securevertex-vpc --region=us-central1 --enable-private-ip-google-access\n```\u5982\u679c\u9700\u8981\uff0c\u60a8\u53ef\u4ee5\u7232 `--range` \u53c3\u6578\u63d0\u4f9b\u4e0d\u540c\u503c\u3002\u4f46\u662f\uff0c\u55ae\u500b\u7b46\u8a18\u672c\u7684\u6700\u5c0f\u524d\u7db4\u9577\u5ea6\u7232 29\u3002\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [IPv4 \u5b50\u7db2\u7bc4\u570d](https://cloud.google.com/vpc/docs/subnets?hl=zh-cn#ipv4-ranges) \u3002\n- \u5275\u5efa\u540d\u7232 `cloud-router-us-central1` \u7684\u5340\u57df\u7d1a Cloud Router \u8def\u7531\u5668\uff1a```\ngcloud compute routers create cloud-router-us-central1 --network securevertex-vpc --region us-central1\n```\n- \u5275\u5efa\u540d\u7232 `cloud-nat-us-central1` \u7684\u5340\u57df\u7d1a Cloud NAT \u7db2\u95dc\uff1a```\ngcloud compute routers nats create cloud-nat-us-central1 --router=cloud-router-us-central1 --auto-allocate-nat-external-ips --nat-all-subnet-ip-ranges --region us-central1\n```\n## \u5275\u5efa Cloud Storage \u5b58\u5132\u6876\n- \u5275\u5efa Cloud Storage \u5b58\u5132\u6876\uff1a```\ngcloud storage buckets create --location=us-central1 --uniform-bucket-level-access gs://BUCKET_NAME\n```\u5c07 \u66ff\u63db\u7232\u552f\u4e00\u7684\u5b58\u5132\u6876\u540d\u7a31\u3002\n- \u8a2d\u7f6e `BUCKET_NAME` Shell \u8b8a\u91cf\u4e26\u9a57\u8b49\u5176\u8f38\u5165\u662f\u5426\u6b63\u78ba\uff1a```\nBUCKET_NAME=BUCKET_NAMEecho $BUCKET_NAME\n```\u5c07 \u66ff\u63db\u7232\u5b58\u5132\u6876\u540d\u7a31\u3002\n## \u5275\u5efa\u4e26\u4e0a\u50b3\u5553\u52d5\u5f8c\u8173\u672c\n- \u5982\u9700\u5275\u5efa\u8173\u672c\uff0c\u8acb\u4f7f\u7528\u6587\u672c\u7de8\u8f2f\u5668\uff08\u5982 `vi` \u6216 `nano` \uff09\u5275\u5efa\u540d\u7232 `poststartup.sh` \u7684\u6587\u4ef6\u3002\n- \u5c07\u4ee5\u4e0b Shell \u8173\u672c\u7c98\u8cbc\u5230\u6b64\u6587\u4ef6\u4e2d\uff1a```\n#! /bin/bashecho \"Current user: id\" >> /tmp/notebook_config.log 2>&1echo \"Changing dir to /home/jupyter\" >> /tmp/notebook_config.log 2>&1cd /home/jupyterecho \"Cloning generative-ai from github\" >> /tmp/notebook_config.log 2>&1su - jupyter -c \"git clone https://github.com/GoogleCloudPlatform/generative-ai.git\" >> /tmp/notebook_config.log 2>&1echo \"Current user: id\" >> /tmp/notebook_config.log 2>&1echo \"Installing python packages\" >> /tmp/notebook_config.log 2&1su - jupyter -c \"pip install --upgrade --no-warn-conflicts --no-warn-script-location --user \\\u00a0 \u00a0 \u00a0google-cloud-bigquery \\\u00a0 \u00a0 \u00a0google-cloud-pipeline-components \\\u00a0 \u00a0 \u00a0google-cloud-aiplatform \\\u00a0 \u00a0 \u00a0seaborn \\\u00a0 \u00a0 \u00a0kfp\" >> /tmp/notebook_config.log 2>&1\n```\n- \u4fdd\u5b58\u6587\u4ef6\u3002\n- \u5c07\u8a72\u6587\u4ef6\u4e0a\u50b3\u5230 Cloud Storage \u5b58\u5132\u6876\uff1a```\ngcloud storage cp poststartup.sh gs://$BUCKET_NAME\n```\n## \u5275\u5efa\u81ea\u5b9a\u7fa9\u670d\u52d9\u8cec\u865f\u5275\u5efa\u7528\u6236\u7ba1\u7406\u7684\u7b46\u8a18\u672c\u5be6\u4f8b\u6642\uff0c\u6211\u5011\u5f37\u70c8\u5efa\u8b70\u60a8\u6e05\u9664 **\u4f7f\u7528 Compute Engine \u9ed8\u8a8d\u670d\u52d9\u8cec\u865f** \u8907\u9078\u6846\u4e26\u6307\u5b9a\u81ea\u5b9a\u7fa9\u670d\u52d9\u8cec\u865f\u3002Compute Engine \u9ed8\u8a8d\u670d\u52d9\u8cec\u865f\uff08\u4ee5\u53ca\u60a8\u6307\u5b9a\u7232\u5be6\u4f8b\u7528\u6236\u7684\u4efb\u4f55\u4eba\uff09\u5c07\u88ab\u6388\u4e88\u9805\u76ee\u7684 Editor \u89d2\u8272 ( `roles/editor` )\u3002\u60a8\u53ef\u4ee5\u901a\u904e [\u7232\u9ed8\u8a8d\u670d\u52d9\u8cec\u865f\u505c\u7528\u81ea\u52d5\u89d2\u8272\u6388\u4e88](https://cloud.google.com/resource-manager/docs/organization-policy/restricting-service-accounts?hl=zh-cn#disable_service_account_default_grants) \u4f86\u505c\u7528\u6b64\u884c\u7232\u3002- \u5275\u5efa\u540d\u7232 `user-managed-notebook-sa` \u7684\u81ea\u5b9a\u7fa9\u670d\u52d9\u8cec\u865f\uff1a```\ngcloud iam service-accounts create user-managed-notebook-sa \\--display-name=\"user-managed-notebook-sa\"\n```\n- \u5c07 Storage Object Viewer IAM \u89d2\u8272\u5206\u914d\u7d66\u670d\u52d9\u8cec\u865f\uff1a```\ngcloud projects add-iam-policy-binding $projectid --member=\"serviceAccount:user-managed-notebook-sa@$projectid.iam.gserviceaccount.com\" --role=\"roles/storage.objectViewer\"\n```\n- \u5c07 Vertex AI User IAM \u89d2\u8272\u5206\u914d\u7d66\u670d\u52d9\u8cec\u865f\uff1a```\ngcloud projects add-iam-policy-binding $projectid --member=\"serviceAccount:user-managed-notebook-sa@$projectid.iam.gserviceaccount.com\" --role=\"roles/aiplatform.user\"\n```\n## \u5275\u5efa\u7528\u6236\u7ba1\u7406\u7684\u7b46\u8a18\u672c\u5be6\u4f8b\n- \u5728 Google Cloud \u63a7\u5236\u6aaf\u4e2d\uff0c\u8f49\u5230 **\u7528\u6236\u7ba1\u7406\u7684\u7b46\u8a18\u672c** \u9801\u9762\u3002 [\u9032\u5165\u201c\u7528\u6236\u7ba1\u7406\u7684\u7b46\u8a18\u672c\u201d](https://console.cloud.google.com/vertex-ai/workbench/user-managed?hl=zh-cn) \n- \u9ede\u64ca add_box **\u65b0\u5efa** \uff0c\u7136\u5f8c\u9078\u64c7 **\u9ad8\u7d1a\u9078\u9805** \u3002\u6b64\u6642\u6703\u6253\u958b **\u5275\u5efa\u5be6\u4f8b** \u9801\u9762\u3002\n- \u5728 **\u5275\u5efa\u5be6\u4f8b** \u9801\u9762\u7684 **\u8a73\u7d30\u4fe1\u606f** \u90e8\u5206\u4e2d\uff0c\u7232\u65b0\u5be6\u4f8b\u63d0\u4f9b\u4ee5\u4e0b\u4fe1\u606f\uff0c\u7136\u5f8c\u9ede\u64ca **\u7e7c\u7e8c** \uff1a- **\u540d\u7a31** \uff1a\u7232\u65b0\u5be6\u4f8b\u63d0\u4f9b\u540d\u7a31\uff0c\u6216\u63a5\u53d7\u9ed8\u8a8d\u503c\u3002\n- **\u5340\u57df** \uff1a\u9078\u64c7 **us-central1** \u3002\n- **\u53ef\u7528\u5340** \uff1a\u9078\u64c7 **us-central1-a** \u3002\n- \u5728 **\u74b0\u5883** \u90e8\u5206\u4e2d\uff0c\u63d0\u4f9b\u4ee5\u4e0b\u5167\u5bb9\uff0c\u7136\u5f8c\u9ede\u64ca **\u7e7c\u7e8c** \uff1a- **\u5553\u52d5\u8173\u672c\u5f8c** \uff1a\u9ede\u64ca **\u700f\u89bd** \uff0c\u96d9\u64ca`poststartup.sh`\u6587\u4ef6\uff0c\u518d\u6b21\u9ede\u64ca\u5b83\uff0c\u7136\u5f8c\u9ede\u64ca **\u9078\u64c7** \u3002\n- \u5728 **\u6a5f\u5668\u985e\u578b** \u90e8\u5206\u4e2d\uff0c\u63d0\u4f9b\u4ee5\u4e0b\u5167\u5bb9\uff0c\u7136\u5f8c\u9ede\u64ca **\u7e7c\u7e8c** \uff1a- **\u5b89\u5168\u5f37\u5316\u578b\u865b\u64ec\u6a5f** \uff1a\u9078\u4e2d\u4ee5\u4e0b\u8907\u9078\u6846\uff1a- **\u5b89\u5168\u5553\u52d5** \n- **\u865b\u64ec\u53ef\u4fe1\u5e73\u81fa\u6a21\u584a (vTPM)** \n- **\u5b8c\u6574\u6027\u76e3\u63a7** \n- \u5728 **\u78c1\u76e4** \u90e8\u5206\u4e2d\uff0c\u78ba\u4fdd\u9078\u4e2d **Google \u7ba1\u7406\u7684\u52a0\u5bc6\u5bc6\u9470** \uff0c\u7136\u5f8c\u9ede\u64ca **\u7e7c\u7e8c** \uff1a\n- \u5728 **\u7db2\u7d61** \u90e8\u5206\u4e2d\uff0c\u63d0\u4f9b\u4ee5\u4e0b\u5167\u5bb9\uff0c\u7136\u5f8c\u9ede\u64ca **\u7e7c\u7e8c** \uff1a- **\u7db2\u7d61** \uff1a\u9078\u64c7 **\u6b64\u9805\u76ee\u4e2d\u7684\u7db2\u7d61** \u4e26\u5b8c\u6210\u4ee5\u4e0b\u6b65\u9a5f\uff1a- \u5728 **\u7db2\u7d61** \u5b57\u6bb5\u4e2d\uff0c\u9078\u64c7 **securevertex-vpc** \u3002\n- \u5728 **\u5b50\u7db2** \u5b57\u6bb5\u4e2d\uff0c\u9078\u64c7 **securevertex-subnet-a** \u3002\n- \u6e05\u9664 **\u5206\u914d\u5916\u90e8 IP \u5730\u5740** \u8907\u9078\u6846\u3002\u4e0d\u5206\u914d\u5916\u90e8 IP \u5730\u5740\u53ef\u9632\u6b62\u5be6\u4f8b\u63a5\u6536\u4f86\u81ea\u4e92\u806f\u7db2\u6216\u5176\u4ed6 VPC \u7db2\u7d61\u7684\u672a\u7d93\u8acb\u6c42\u7684\u901a\u4fe1\u3002\n- \u9078\u4e2d **\u5141\u8a31\u4ee3\u7406\u8a2a\u554f** \u8907\u9078\u6846\u3002\n- \u5728 **IAM \u548c\u5b89\u5168** \u90e8\u5206\uff0c\u63d0\u4f9b\u4ee5\u4e0b\u5167\u5bb9\uff0c\u7136\u5f8c\u9ede\u64ca **\u7e7c\u7e8c** \uff1a- **IAM \u548c\u5b89\u5168** \uff1a\u8981\u5411\u55ae\u500b\u7528\u6236\u6388\u4e88\u5c0d\u5be6\u4f8b\u7684 JupyterLab \u754c\u9762\u7684\u8a2a\u554f\u6b0a\u9650\uff0c\u8acb\u5b8c\u6210\u4ee5\u4e0b\u6b65\u9a5f\uff1a- \u9078\u64c7 **\u55ae\u500b\u7528\u6236** \u3002\n- \u5728 **\u7528\u6236\u96fb\u5b50\u90f5\u4ef6** \u5b57\u6bb5\u4e2d\uff0c\u8f38\u5165\u55ae\u500b\u7528\u6236\u8cec\u865f\u7684\u96fb\u5b50\u90f5\u4ef6\u5730\u5740\u3002\u5982\u679c\u60a8\u8981\u7232\u5176\u4ed6\u4eba\u5275\u5efa\u5be6\u4f8b\uff0c\u5247\u9069\u7528\u4ee5\u4e0b\u689d\u4ef6\uff1a\n- \u60a8\uff08\u5be6\u4f8b\u5275\u5efa\u8005\uff09\u7121\u6b0a\u8a2a\u554f\u5be6\u4f8b\u7684 JupyterLab \u754c\u9762\u3002\u4f46\u60a8\u4ecd\u7136\u53ef\u4ee5\u63a7\u5236\u5be6\u4f8b\uff0c\u4e26\u4e14\u53ef\u4ee5\u5553\u52d5\u3001\u505c\u6b62\u6216\u522a\u9664\u5be6\u4f8b\u3002\n- \u5275\u5efa\u5be6\u4f8b\u5f8c\uff0c\u60a8\u9700\u8981\u5411\u7528\u6236\u6388\u4e88\u5be6\u4f8b\u670d\u52d9\u8cec\u865f\u4e0a\u7684 Service Account User \u89d2\u8272 (`roles/iam.serviceAccountUser`)\u3002\u8acb\u53c3\u95b1 [\u53ef\u9078\uff1a\u5411\u5be6\u4f8b\u7528\u6236\u6388\u4e88 Service Account User \u89d2\u8272](#grant-sa-user-role) \u3002\n- \u6e05\u9664 **\u4f7f\u7528 Compute Engine \u9ed8\u8a8d\u670d\u52d9\u8cec\u865f** \u8907\u9078\u6846\u3002\u6b64\u6b65\u9a5f\u975e\u5e38\u91cd\u8981\uff0c\u56e0\u7232 Compute Engine \u9ed8\u8a8d\u670d\u52d9\u8cec\u865f\uff08\u4ee5\u53ca\u60a8\u525b\u525b\u6307\u5b9a\u7684\u55ae\u500b\u7528\u6236\uff09\u88ab\u6388\u4e88\u9805\u76ee\u7684 Editor \u89d2\u8272 (`roles/editor`)\u3002\n- \u5728 **\u670d\u52d9\u8cec\u865f\u96fb\u5b50\u90f5\u4ef6\u5730\u5740** \u5b57\u6bb5\u4e2d\uff0c\u8f38\u5165 `user-managed-notebook-sa@$projectid.iam.gserviceaccount.com` \u3002\uff08\u9019\u662f\u60a8\u5148\u524d\u5275\u5efa\u7684\u81ea\u5b9a\u7fa9\u670d\u52d9\u8cec\u865f\u96fb\u5b50\u90f5\u4ef6\u5730\u5740\u3002\uff09\u6b64\u670d\u52d9\u8cec\u865f\u7684\u6b0a\u9650\u6709\u9650\u3002\u5982\u9700\u8a73\u7d30\u77ad\u89e3\u5982\u4f55\u6388\u4e88\u8a2a\u554f\u6b0a\u9650\uff0c\u8acb\u53c3\u95b1 [\u7ba1\u7406\u5c0d\u7528\u6236\u7ba1\u7406\u7684\u7b46\u8a18\u672c\u5be6\u4f8b\u7684 JupyterLab \u754c\u9762\u7684\u8a2a\u554f\u6b0a\u9650](https://cloud.google.com/vertex-ai/docs/workbench/user-managed/manage-access-jupyterlab?hl=zh-cn) \u3002\n- **\u5b89\u5168\u9078\u9805** \uff1a\u6e05\u9664\u4ee5\u4e0b\u8907\u9078\u6846\uff1a- **\u5c0d\u5be6\u4f8b\u7684\u6839\u8a2a\u554f\u6b0a\u9650** \n\u9078\u4e2d\u4ee5\u4e0b\u8907\u9078\u6846\uff1a- **nbconvert** [nbconvert](https://nbconvert.readthedocs.io/en/latest/) \u53ef\u8b93\u7528\u6236\u4ee5\u5176\u4ed6\u6587\u4ef6\u985e\u578b\uff08\u5982 HTML\u3001PDF \u6216 LaTeX\uff09\u5c0e\u51fa\u548c\u4e0b\u8f09\u7b46\u8a18\u6587\u6587\u4ef6\u3002 [Google Cloud Generative AI](https://github.com/GoogleCloudPlatform/generative-ai/) GitHub \u4ee3\u78bc\u5eab\u4e2d\u7684\u67d0\u4e9b\u7b46\u8a18\u672c\u9700\u8981\u6b64\u8a2d\u7f6e\u3002\n\u6e05\u9664\u4ee5\u4e0b\u8907\u9078\u6846\uff1a- **\u6587\u4ef6\u4e0b\u8f09** \n\u9664\u975e\u60a8\u8655\u65bc\u751f\u7522\u74b0\u5883\uff0c\u5426\u5247\u8acb\u9078\u64c7\u4ee5\u4e0b\u8907\u9078\u6846\uff1a- **\u7d42\u7aef\u8a2a\u554f\u6b0a\u9650** \u9019\u5c07\u5f9e JupyterLab \u754c\u9762\u5c0d\u7d42\u7aef\u9032\u884c\u7d42\u7aef\u8a2a\u554f\u3002\n- \u5728 **\u7cfb\u7d71\u5065\u5eb7\u72c0\u6cc1** \u90e8\u5206\u4e2d\uff0c\u9078\u64c7 **\u74b0\u5883\u81ea\u52d5\u5347\u7d1a** \u4e26\u63d0\u4f9b\u4ee5\u4e0b\u4fe1\u606f\uff1a- \u5728 **\u5831\u544a** \u4e2d\uff0c\u9078\u4e2d\u4ee5\u4e0b\u8907\u9078\u6846\uff1a- **\u5831\u544a\u7cfb\u7d71\u5065\u5eb7\u72c0\u6cc1** \n- **\u5411 Cloud Monitoring \u5831\u544a\u81ea\u5b9a\u7fa9\u6307\u6a19** \n- **\u5b89\u88dd Cloud Monitoring** \n- **\u5831\u544a\u6240\u9700 Google \u7db2\u57df\u7684 DNS \u72c0\u614b** \n- \u9ede\u64ca **\u5275\u5efa** \u3002\n## \u53ef\u9078\uff1a\u5411\u5be6\u4f8b\u7528\u6236\u6388\u4e88 Service Account User \u89d2\u8272\u5982\u679c\u60a8\u8981\u7232\u5176\u4ed6\u7528\u6236\u5275\u5efa\u7528\u6236\u7ba1\u7406\u7684\u7b46\u8a18\u672c\u5be6\u4f8b\uff0c\u5247\u5fc5\u9808\u5411\u5176\u6388\u4e88 [Service Account User \u89d2\u8272](https://cloud.google.com/iam/docs/service-accounts?hl=zh-cn#user-role) ( `roles/iam.serviceAccountUser` ) `user-managed-notebook-sa` \u81ea\u5b9a\u7fa9\u670d\u52d9\u8cec\u865f\uff0c\u5982\u4e0b\u6240\u793a\uff1a\n```\ngcloud iam service-accounts add-iam-policy-binding \\\u00a0 \u00a0 user-managed-notebook-sa@PROJECT_ID.iam.gserviceaccount.com \\\u00a0 \u00a0 --member=\"user:USER_EMAIL\" \\\u00a0 \u00a0 --role=\"roles/iam.serviceAccountUser\"\n```\n\u66ff\u63db\u4ee5\u4e0b\u503c\uff1a- \uff1a\u9805\u76ee ID\n- \uff1a\u7528\u6236\u7684\u96fb\u5b50\u90f5\u4ef6\u5730\u5740\n## \u9a57\u8b49\u7528\u6236\u7ba1\u7406\u7684\u7b46\u8a18\u672c\u5be6\u4f8b\u662f\u5426\u5df2\u5275\u5efaVertex AI Workbench \u6703\u6839\u64da\u60a8\u6307\u5b9a\u7684\u5c6c\u6027\u5275\u5efa\u7528\u6236\u7ba1\u7406\u7684\u7b46\u8a18\u672c\u5be6\u4f8b\uff0c\u4e26\u81ea\u52d5\u5553\u52d5\u8a72\u5be6\u4f8b\u3002\n\u7576\u5be6\u4f8b\u53ef\u4f9b\u4f7f\u7528\u6642\uff0cVertex AI Workbench \u6703\u6fc0\u6d3b\u4e00\u500b **\u6253\u958b JupyterLab** \u93c8\u63a5\u3002 \u53ea\u6709\u60a8\u5728\u5275\u5efa\u5be6\u4f8b\u6642\u6307\u5b9a\u7684\u55ae\u500b\u7528\u6236\u624d\u80fd\u8a2a\u554f\u6b64\u93c8\u63a5\u3002\n\u5728 JupyterLab \u4e2d\u6253\u958b\u5be6\u4f8b\uff0c\u4e26\u9a57\u8b49\u514b\u9686\u7684 [Google Cloud Generative AI](https://github.com/GoogleCloudPlatform/generative-ai/) GitHub \u4ee3\u78bc\u5eab\u662f\u5426\u5b58\u5728\u3002- \u5728 Google Cloud \u63a7\u5236\u6aaf\u4e2d\uff0c\u8f49\u5230 **\u7528\u6236\u7ba1\u7406\u7684\u7b46\u8a18\u672c** \u9801\u9762\u3002 [\u9032\u5165\u201c\u7528\u6236\u7ba1\u7406\u7684\u7b46\u8a18\u672c\u201d](https://console.cloud.google.com/vertex-ai/workbench/user-managed?hl=zh-cn) \n- \u5728\u7528\u6236\u7ba1\u7406\u7684\u7b46\u8a18\u672c\u5be6\u4f8b\u5217\u8868\u4e2d\uff0c\u9ede\u64ca\u60a8\u5275\u5efa\u7684\u5be6\u4f8b\u7684 **\u6253\u958b JupyterLab** \u93c8\u63a5\u3002\u5728\u6587\u4ef6\u593e\u5217\u8868\u4e2d\uff0c\u60a8\u6703\u770b\u5230\u4e00\u500b `generative-ai` \u6587\u4ef6\u593e\u3002\u6b64\u6587\u4ef6\u593e\u5305\u542b\u514b\u9686\u7684 GitHub \u4ee3\u78bc\u5eab\u3002\n## \u901a\u904e Monitoring \u76e3\u63a7\u5065\u5eb7\u72c0\u6cc1\u60a8\u53ef\u4ee5\u4f7f\u7528 Google Cloud \u63a7\u5236\u6aaf\u76e3\u63a7\u7528\u6236\u7ba1\u7406\u7684\u7b46\u8a18\u672c\u5be6\u4f8b\u7684\u7cfb\u7d71\u548c\u61c9\u7528\u6307\u6a19\u3002\u5982\u9700\u8a73\u7d30\u77ad\u89e3\u5be6\u4f8b\u76e3\u63a7\u4ee5\u53ca\u5982\u4f55\u5275\u5efa\u81ea\u5b9a\u7fa9\u6307\u6a19\uff0c\u8acb\u53c3\u95b1 [\u76e3\u63a7\u904b\u884c\u72c0\u6cc1](https://cloud.google.com/vertex-ai/docs/workbench/user-managed/monitor-health?hl=zh-cn) \u3002- \u5728 Google Cloud \u63a7\u5236\u6aaf\u4e2d\uff0c\u8f49\u5230 **\u7528\u6236\u7ba1\u7406\u7684\u7b46\u8a18\u672c** \u9801\u9762\u3002 [\u9032\u5165\u201c\u7528\u6236\u7ba1\u7406\u7684\u7b46\u8a18\u672c\u201d](https://console.cloud.google.com/vertex-ai/workbench/user-managed?hl=zh-cn) \n- \u9ede\u64ca\u8981\u67e5\u770b\u5176\u6307\u6a19\u7684\u7528\u6236\u7ba1\u7406\u7684\u7b46\u8a18\u672c\u5be6\u4f8b\u7684\u540d\u7a31\u3002\n- \u5728 **\u7b46\u8a18\u672c\u8a73\u60c5** \u9801\u9762\u4e0a\uff0c\u9ede\u64ca **Monitoring** \u6a19\u7c64\u9801\u3002\u67e5\u770b\u7b46\u8a18\u672c\u5be6\u4f8b\u7684 **CPU \u5229\u7528\u7387** \u548c **\u7db2\u7d61\u5b57\u7bc0** \u3002\u5982\u9700\u77ad\u89e3\u5982\u4f55\u89e3\u8b80\u9019\u4e9b\u6307\u6a19\uff0c\u8acb\u53c3\u95b1 [\u67e5\u770b\u8cc7\u6e90\u6307\u6a19](https://cloud.google.com/compute/docs/instances/observe-monitor-vms?hl=zh-cn#review_resource_metrics) \u3002\u5982\u679c\u60a8\u525b\u525b\u5275\u5efa\u4e86\u5be6\u4f8b\uff0c\u5247\u4e0d\u6703\u770b\u5230\u4efb\u4f55\u6578\u64da\u3002\u7b49\u5f85\u5e7e\u5206\u9418\uff0c\u7136\u5f8c\u5237\u65b0\u63a7\u5236\u6aaf\u6a19\u7c64\u9801\u3002\n## \u7232\u7528\u6236\u7ba1\u7406\u7684\u7b46\u8a18\u672c\u5be6\u4f8b\u5275\u5efa\u865b\u64ec\u6a5f\u5be6\u4f8b\u6642\u9593\u8868\u7531\u65bc\u7528\u6236\u7ba1\u7406\u7684\u7b46\u8a18\u672c\u5be6\u4f8b\u662f Compute Engine \u865b\u64ec\u6a5f\u5be6\u4f8b\uff0c\u56e0\u6b64\u60a8\u53ef\u4ee5\u4f7f\u7528 Compute Engine API \u7232\u5176\u5275\u5efa\u865b\u64ec\u6a5f\u5be6\u4f8b\u6642\u9593\u8868\u3002\n\u4f7f\u7528\u865b\u64ec\u6a5f\u5be6\u4f8b\u6642\u9593\u8868\u5553\u52d5\u548c\u505c\u6b62\u7528\u6236\u7ba1\u7406\u7684\u7b46\u8a18\u672c\u5be6\u4f8b\u3002\u5728\u5be6\u4f8b\u505c\u6b62\u671f\u9593\uff0c\u60a8\u53ea\u9700\u652f\u4ed8 Cloud Storage \u8cbb\u7528\u3002\n\u60a8\u53ef\u4ee5\u5c07\u5be6\u4f8b\u6642\u9593\u8868\u639b\u63a5\u5230\u540c\u4e00\u5340\u57df\u4e2d\u7684\u4efb\u4f55\u865b\u64ec\u6a5f\u5be6\u4f8b\uff0c\u4ee5\u4fbf\u4f7f\u7528\u540c\u4e00\u5be6\u4f8b\u6642\u9593\u8868\u4f86\u63a7\u5236\u5340\u57df\u4e2d\u6240\u6709\u7528\u6236\u7ba1\u7406\u7684\u7b46\u8a18\u672c\u5be6\u4f8b\u3002\n\u5982\u9700\u8a73\u7d30\u77ad\u89e3\u865b\u64ec\u6a5f\u5be6\u4f8b\u6642\u9593\u8868\uff0c\u8acb\u53c3\u95b1 [\u5b89\u6392\u865b\u64ec\u6a5f\u5be6\u4f8b\u5553\u52d5\u548c\u505c\u6b62](https://cloud.google.com/compute/docs/instances/schedule-instance-start-stop?hl=zh-cn) \u3002\n### \u5275\u5efa\u81ea\u5b9a\u7fa9 IAM \u89d2\u8272\u7232\u4fdd\u8b49\u5b89\u5168\u6027\uff0c\u6211\u5011\u5efa\u8b70\u5275\u5efa\u50c5\u5177\u6709\u4ee5\u4e0b\u6b0a\u9650\u7684\u81ea\u5b9a\u7fa9 IAM \u89d2\u8272\uff0c\u4e26\u5c07\u5176\u5206\u914d\u7d66 Compute Engine \u9ed8\u8a8d\u670d\u52d9\u8cec\u865f\uff1a- `compute.instances.start`\n- `compute.instances.stop`\n- \u5728 Cloud Shell \u4e2d\uff0c\u5275\u5efa\u4e00\u500b\u540d\u7232 `Vm_Scheduler` \u7684\u81ea\u5b9a\u7fa9\u89d2\u8272\u5e77\u5305\u542b\u5fc5\u8981\u7684\u6b0a\u9650\uff1a [\u6253\u958b Cloud Shell](https://ssh.cloud.google.com/cloudshell/editor?hl=zh-cn) ```\ngcloud iam roles create Vm_Scheduler --project=$projectid \\--title=vm-scheduler-notebooks \\--permissions=\"compute.instances.start,compute.instances.stop\" --stage=ga\n```\n- \u63cf\u8ff0\u81ea\u5b9a\u7fa9\u89d2\u8272\uff1a```\ngcloud iam roles describe Vm_Scheduler --project=$projectid\n```\n### \u5c07\u89d2\u8272\u5206\u914d\u7d66 Compute Engine \u9ed8\u8a8d\u670d\u52d9\u8cec\u865f\u5982\u9700\u6388\u4e88 Compute Engine \u9ed8\u8a8d\u670d\u52d9\u8cec\u865f\u5553\u52d5\u548c\u505c\u6b62\u7528\u6236\u7ba1\u7406\u7684\u7b46\u8a18\u672c\u5be6\u4f8b\u7684\u6b0a\u9650\uff0c\u60a8\u9700\u8981\u7232\u5176\u5206\u914d `Vm_Scheduler` \u81ea\u5b9a\u7fa9\u89d2\u8272\u3002\n\u9805\u76ee\u7684 Compute Engine \u9ed8\u8a8d\u670d\u52d9\u8cec\u865f\u5177\u6709\u4ee5\u4e0b\u96fb\u5b50\u90f5\u4ef6\u5730\u5740\uff1a `PROJECT_NUMBER-compute@developer.gserviceaccount.com` \uff0c\u5176\u4e2d `PROJECT_NUMBER` \u662f\u60a8\u7684\u9805\u76ee\u7de8\u865f\u3002- \u8b58\u5225\u60a8\u7684\u9805\u76ee\u7de8\u865f\u4e26\u5c07\u5176\u5b58\u5132\u5728 `project_number` Shell \u8b8a\u91cf\u4e2d\uff1a```\nproject_number=$(gcloud projects describe $projectid --format 'get(projectNumber)')echo $project_number\n```\n- \u5c07\u81ea\u5b9a\u7fa9\u89d2\u8272\u5206\u914d\u7d66\u9ed8\u8a8d\u670d\u52d9\u8cec\u865f\uff1a```\ngcloud projects add-iam-policy-binding $projectid --member=\"serviceAccount:$project_number-compute@developer.gserviceaccount.com\" --role=\"projects/$projectid/roles/Vm_Scheduler\"\n```\n### \u5275\u5efa\u4e26\u9644\u52a0\u6642\u9593\u8868\u5982\u9700\u5275\u5efa\u5be6\u4f8b\u6642\u9593\u8868\u4ee5\u5728\u4e0a\u5348 7 \u9ede\u5553\u52d5\u7528\u6236\u7ba1\u7406\u7684\u7b46\u8a18\u672c\u5be6\u4f8b\uff0c\u4e26\u5728\u4e0b\u5348 6 \u9ede\u505c\u6b62\u9019\u4e9b\u5be6\u4f8b\uff0c\u8acb\u57f7\u884c\u4ee5\u4e0b\u64cd\u4f5c\uff1a- \u5275\u5efa\u540d\u7232 `optimize-notebooks` \u7684\u958b\u59cb\u548c\u505c\u6b62\u6642\u9593\u8868\uff1a```\ngcloud compute resource-policies create instance-schedule optimize-notebooks \\--region=us-central1 \\--vm-start-schedule='0 7 * * *' \\--vm-stop-schedule='0 18 * * *' \\--timezone=TIME_ZONE\n```\u5c07 \u66ff\u63db\u7232\u6b64\u5be6\u4f8b\u6642\u9593\u8868\u57fa\u65bc\u4f4d\u7f6e\u7684 IANA \u6642\u5340\uff0c\u4f8b\u5982 `America/Chicago` \u3002\u5982\u679c\u7701\u7565\uff0c\u5247\u4f7f\u7528\u9ed8\u8a8d\u503c `UTC` \u3002\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [\u6642\u5340](https://cloud.google.com/compute/docs/instances/schedule-instance-start-stop?hl=zh-cn#time_zone) \u3002\n- \u901a\u904e\u904b\u884c\u4ee5\u4e0b\u547d\u4ee4\u4e26\u8a18\u4e0b\u5176\u8fd4\u56de\u7684 `NAME` \u503c\uff0c\u78ba\u5b9a\u7528\u6236\u7ba1\u7406\u7684\u7b46\u8a18\u672c\u5be6\u4f8b\u7684\u540d\u7a31\uff1a```\ngcloud compute instances list\n```\n- \u5c07\u540d\u7a31\u5b58\u5132\u5728 `notebook_vm` shell \u8b8a\u91cf\u4e2d\uff1a```\nnotebook_vm=NOTEBOOK_VM_NAMEecho $notebook_vm\n```\u5c07 \u66ff\u63db\u7232\u7528\u6236\u7ba1\u7406\u7684\u7b46\u8a18\u672c\u5be6\u4f8b\u540d\u7a31\u3002\n- \u5c07\u5be6\u4f8b\u6642\u9593\u8868\u8207\u7528\u6236\u7ba1\u7406\u7684\u7b46\u8a18\u672c\u5be6\u4f8b\u76f8\u95dc\u806f\uff1a```\ngcloud compute instances add-resource-policies $notebook_vm \\\u00a0 --resource-policies=optimize-notebooks \\\u00a0 --zone=us-central1-a\n```\n- \u63cf\u8ff0\u5be6\u4f8b\u6642\u9593\u8868\uff1a```\ngcloud compute resource-policies describe optimize-notebooks \\\u00a0 --region=us-central1\n```\n\u5982\u9700\u9a57\u8b49\u5be6\u4f8b\u6642\u9593\u8868\u662f\u5426\u6210\u529f\u904b\u884c\uff0c\u60a8\u53ef\u4ee5\u67e5\u770b\u5be6\u4f8b\u6642\u9593\u8868\u8cc7\u6e90\u653f\u7b56\u548c\u9644\u52a0\u7684\u865b\u64ec\u6a5f\u5be6\u4f8b\u7684 [Compute Engine \u5be9\u8988\u65e5\u8a8c](https://cloud.google.com/compute/docs/logging/audit-logging?hl=zh-cn) \u3002\u6bcf\u9805\u64cd\u4f5c\u7684\u9810\u5b9a\u6642\u9593\u6700\u9577\u53ef\u9054 15 \u5206\u9418\u3002## \u6e05\u7406\u7232\u907f\u514d\u56e0\u672c\u6559\u7a0b\u4e2d\u4f7f\u7528\u7684\u8cc7\u6e90\u5c0e\u81f4\u60a8\u7684 Google Cloud \u8cec\u865f\u7522\u751f\u8cbb\u7528\uff0c\u8acb [\u522a\u9664\u5305\u542b\u9019\u4e9b\u8cc7\u6e90\u7684\u9805\u76ee](https://cloud.google.com/resource-manager/docs/creating-managing-projects?hl=zh-cn#shutting_down_projects) \uff0c\u6216\u8005\u4fdd\u7559\u9805\u76ee\u4f46\u522a\u9664\u5404\u500b\u8cc7\u6e90\u3002\n\u60a8\u53ef\u4ee5\u6309\u5982\u4e0b\u65b9\u5f0f\u522a\u9664\u9805\u76ee\u4e2d\u7684\u5404\u500b\u8cc7\u6e90\uff1a- \u5728 Google Cloud \u63a7\u5236\u6aaf\u4e2d\uff0c\u8f49\u5230 **\u7528\u6236\u7ba1\u7406\u7684\u7b46\u8a18\u672c** \u9801\u9762\u3002 [\u9032\u5165\u201c\u7528\u6236\u7ba1\u7406\u7684\u7b46\u8a18\u672c\u201d](https://console.cloud.google.com/vertex-ai/workbench/user-managed?hl=zh-cn) \n- \u9078\u64c7\u7528\u6236\u7ba1\u7406\u7684\u7b46\u8a18\u672c\u5be6\u4f8b\u3002\n- \u9ede\u64ca **\u522a\u9664** \u3002\n- \u5728 Cloud Shell \u4e2d\uff0c\u901a\u904e\u57f7\u884c\u4ee5\u4e0b\u547d\u4ee4\u522a\u9664\u5176\u9918\u5404\u500b\u8cc7\u6e90\u3002 [\u6253\u958b Cloud Shell](https://ssh.cloud.google.com/cloudshell/editor?hl=zh-cn) ```\ngcloud compute routers delete cloud-router-us-central1 --region=us-central1 --quietgcloud compute routers nats delete cloud-nat-us-central1 --region=us-central1 --router=cloud-router-us-central1 --quietgcloud compute instances remove-resource-policies $notebook_vm \\\u00a0 --resource-policies=optimize-notebooks \\\u00a0 --zone=us-central1-a --quietgcloud compute resource-policies delete optimize-notebooks --region=us-central1 --quietgcloud compute instances delete $notebook_vm --zone=us-central1-a --quietgcloud compute networks subnets delete securevertex-subnet-a --region=us-central1 --quietgcloud iam service-accounts delete user-managed-notebook-sa@$projectid.iam.gserviceaccount.com --quietgcloud projects remove-iam-policy-binding $projectid --member=\"serviceAccount:$project_number-compute@developer.gserviceaccount.com\" --role=\"projects/$projectid/roles/Vm_Scheduler\"gcloud iam roles delete Vm_Scheduler --project=$projectidgcloud compute networks delete securevertex-vpc --quiet\n```\n## \u5f8c\u7e8c\u6b65\u9a5f\n- \u5b8c\u6210 [Vertex AI \u5275\u5efa\u5b89\u5168\u7684\u7528\u6236\u7ba1\u7406\u7684\u7b46\u8a18\u672c](https://codelabs.developers.google.com/codelabs/vertex-notebook?hl=zh-cn) Codelab\u3002\n- \u77ad\u89e3\u5982\u4f55 [\u4f7f\u7528 VPC Service Controls \u5728\u670d\u52d9\u908a\u754c\u5167\u8a2d\u7f6e\u7528\u6236\u7ba1\u7406\u7684\u7b46\u8a18\u672c\u5be6\u4f8b](https://cloud.google.com/vertex-ai/docs/workbench/user-managed/service-perimeter?hl=zh-cn) \u3002\n- \u77ad\u89e3 [VPC \u8a2d\u8a08\u7684\u6700\u4f73\u505a\u6cd5\u548c\u53c3\u8003\u67b6\u69cb](https://cloud.google.com/architecture/best-practices-vpc-design?hl=zh-cn) \u3002\n- \u8a73\u7d30\u77ad\u89e3 [\u4fdd\u8b77 Vertex AI Workbench \u7528\u6236\u7ba1\u7406\u7684\u7b46\u8a18\u672c\u4e2d\u7684\u6a5f\u5bc6\u6578\u64da](https://cloud.google.com/architecture/protecting-confidential-data-in-ai-platform-notebooks?hl=zh-cn) \u3002", "guide": "Vertex AI"}