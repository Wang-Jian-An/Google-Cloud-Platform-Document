{"title": "Vertex AI - \u76e3\u63a7\u5065\u5eb7\u72c0\u6cc1", "url": "https://cloud.google.com/vertex-ai/docs/workbench/user-managed/monitor-health?hl=zh-cn", "abstract": "# Vertex AI - \u76e3\u63a7\u5065\u5eb7\u72c0\u6cc1\n# \u76e3\u63a7\u5065\u5eb7\u72c0\u6cc1\nVertex AI Workbench \u7528\u6236\u7ba1\u7406\u7684\u7b46\u8a18\u672c [\u5df2\u68c4\u7528](https://cloud.google.com/vertex-ai/docs/deprecations?hl=zh-cn) \u3002\u81ea 2025 \u5e74 1 \u6708 30 \u65e5\u8d77\uff0c\u6211\u5011\u5c07\u7d42\u6b62\u5c0d\u7528\u6236\u7ba1\u7406\u7684\u7b46\u8a18\u672c\u7684\u652f\u6301\uff0c\u4e26\u4e14\u5c07\u4e0d\u518d\u652f\u6301\u5275\u5efa\u7528\u6236\u7ba1\u7406\u7684\u7b46\u8a18\u672c\u5be6\u4f8b\u3002\u73fe\u6709\u5be6\u4f8b\u4ecd\u7136\u53ef\u4ee5\u6b63\u5e38\u4f7f\u7528\uff0c\u4f46\u6211\u5011\u5c07\u4e0d\u518d\u63d0\u4f9b\u88dc\u4e01\u3001\u66f4\u65b0\u548c\u5347\u7d1a\u3002\u5982\u9700\u7e7c\u7e8c\u4f7f\u7528 Vertex AI Workbench\uff0c\u6211\u5011\u5efa\u8b70\u60a8 [\u5c07\u7528\u6236\u7ba1\u7406\u7684\u7b46\u8a18\u672c\u5be6\u4f8b\u9077\u79fb\u5230 Vertex AI Workbench \u5be6\u4f8b](https://cloud.google.com/vertex-ai/docs/workbench/user-managed/migrate-to-instances?hl=zh-cn) \u3002\n\u7528\u6236\u7ba1\u7406\u7684\u7b46\u8a18\u672c\u5be6\u4f8b\u63d0\u4f9b\u4e86\u591a\u7a2e\u65b9\u6cd5\u4f86\u76e3\u63a7\u7b46\u8a18\u672c\u7684\u5065\u5eb7\u72c0\u6cc1\u3002\u672c\u9801\u9762\u4ecb\u7d39\u5982\u4f55\u4f7f\u7528\u9019\u4e9b\u65b9\u6cd5\u3002\n", "content": "## \u76e3\u63a7\u5065\u5eb7\u72c0\u6cc1\u7684\u65b9\u6cd5\n\u60a8\u53ef\u4ee5\u901a\u904e\u5e7e\u7a2e\u4e0d\u540c\u7684\u65b9\u6cd5\u76e3\u63a7\u7528\u6236\u7ba1\u7406\u7684\u7b46\u8a18\u672c\u5be6\u4f8b\u7684\u5065\u5eb7\u72c0\u6cc1\u3002\u672c\u9801\u9762\u4ecb\u7d39\u5982\u4f55\u4f7f\u7528\u4ee5\u4e0b\u65b9\u6cd5\uff1a\n- [\u4f7f\u7528\u5ba2\u6a5f\u7279\u6027\u5831\u544a\u7cfb\u7d71\u5065\u5eb7\u72c0\u6cc1](#guest-attributes) \n- [\u5411 Cloud Monitoring \u5831\u544a\u81ea\u5b9a\u7fa9\u6307\u6a19](#report-custom-metrics) \n- [\u901a\u904e\u5728\u7528\u6236\u7ba1\u7406\u7684\u7b46\u8a18\u672c\u5be6\u4f8b\u4e0a\u5b89\u88dd Monitoring \u4f86\u5411 Monitoring \u5831\u544a\u7cfb\u7d71\u548c\u61c9\u7528\u6307\u6a19](#install-monitoring) \n- [\u4f7f\u7528\u8a3a\u65b7\u5de5\u5177](#diagnostic-tool) ## \u8a2d\u7f6e gcloud CLI\n[\u5b89\u88dd](https://cloud.google.com/sdk/docs/install?hl=zh-cn) Google Cloud CLI\uff0c\u7136\u5f8c\u901a\u904e\u904b\u884c\u4ee5\u4e0b\u547d\u4ee4 [\u521d\u59cb\u5316](https://cloud.google.com/sdk/docs/initializing?hl=zh-cn) Google Cloud CLI\uff1a\n```\ngcloud init\n```\n**\u6ce8\u610f** \uff1a\u60a8\u53ef\u4ee5\u5728 Google Cloud \u63a7\u5236\u6aaf\u4e2d\u904b\u884c gcloud CLI\uff0c\u800c\u7121\u9700\u5b89\u88dd Google Cloud CLI\u3002\u5982\u9700\u5728 Google Cloud \u63a7\u5236\u6aaf\u4e2d\u904b\u884c gcloud CLI\uff0c\u8acb [\u4f7f\u7528 Cloud Shell](https://console.cloud.google.com/?cloudshell=true&hl=zh-cn) \u3002## \u4f7f\u7528\u5ba2\u6a5f\u7279\u6027\u5831\u544a\u7cfb\u7d71\u5065\u5eb7\u72c0\u6cc1\n\u60a8\u53ef\u4ee5\u4f7f\u7528\u5ba2\u6a5f\u7279\u6027\u4f86\u5831\u544a\u4ee5\u4e0b\u6838\u5fc3\u670d\u52d9\u7684\u7cfb\u7d71\u5065\u5eb7\u72c0\u6cc1\uff1a\n- Docker \u670d\u52d9\n- Docker \u53cd\u5411\u4ee3\u7406\u4ee3\u7406\n- Jupyter \u670d\u52d9\n- Jupyter API\n\u5ba2\u6a5f\u5c6c\u6027\u662f\u6307\u61c9\u7528\u5728\u7528\u6236\u7ba1\u7406\u7684\u7b46\u8a18\u672c\u5be6\u4f8b\u4e0a\u904b\u884c\u6642\u53ef\u5beb\u5165\u7684\u7279\u5b9a\u985e\u578b\u7684\u81ea\u5b9a\u7fa9\u5143\u6578\u64da\u3002\u5982\u9700\u8a73\u7d30\u77ad\u89e3\u5ba2\u6a5f\u5c6c\u6027\uff0c\u8acb\u53c3\u95b1 [\u865b\u64ec\u6a5f\u5143\u6578\u64da\u7c21\u4ecb](https://cloud.google.com/compute/docs/metadata/overview?hl=zh-cn#guest_attributes) \u3002\n### \u5be6\u4f8b\u5982\u4f55\u4f7f\u7528\u5ba2\u6a5f\u5c6c\u6027\u5831\u544a\u7cfb\u7d71\u5065\u5eb7\u72c0\u6cc1\n`notebooks-collection-agent` \u670d\u52d9\u5728\u5f8c\u81fa\u904b\u884c Python \u9032\u7a0b\uff0c\u4ee5\u9a57\u8b49\u7528\u6236\u7ba1\u7406\u7684\u7b46\u8a18\u672c\u5be6\u4f8b\u7684\u6838\u5fc3\u670d\u52d9\u7684\u72c0\u614b\uff0c\u4e26\u5c07\u5ba2\u6a5f\u7279\u6027\u66f4\u65b0\u7232 `1` \uff08\u5982\u679c\u672a\u6aa2\u6e2c\u5230\u4efb\u4f55\u554f\u984c\uff09\u6216 `-1` \uff08\u5982\u679c\u6aa2\u6e2c\u5230\u6545\u969c\uff09\u3002\n\u8981\u4f7f\u7528 `notebooks-collection-agent` \u670d\u52d9\u5831\u544a\u7528\u6236\u7ba1\u7406\u7684\u7b46\u8a18\u672c\u5be6\u4f8b\u7684\u5065\u5eb7\u72c0\u6cc1\uff0c\u60a8\u5fc5\u9808\u5728\u5275\u5efa\u7528\u6236\u7ba1\u7406\u7684\u7b46\u8a18\u672c\u5be6\u4f8b\u6642\u5553\u7528\u4ee5\u4e0b\u5ba2\u6a5f\u7279\u6027 \uff1a\n- `enable-guest-attributes=TRUE`\uff1a\u9019\u6703\u5553\u7528\u7528\u6236\u7ba1\u7406\u7684\u7b46\u8a18\u672c\u5be6\u4f8b\u4e0a\u7684\u5ba2\u6a5f\u7279\u6027\u3002\u9ed8\u8a8d\u60c5\u6cc1\u4e0b\uff0c\u6240\u6709\u65b0\u5be6\u4f8b\u90fd\u6703\u5553\u7528\u6b64\u7279\u6027\u3002\n- `report-system-health=TRUE`\uff1a\u9019\u6703\u5c07\u7cfb\u7d71\u5065\u5eb7\u72c0\u6cc1\u6aa2\u67e5\u7d50\u679c\u8a18\u9304\u5230\u5ba2\u6a5f\u7279\u6027\u3002\n`notebooks-collection-agent` \u670d\u52d9\u4e0d\u9700\u8981\u4efb\u4f55\u7279\u6b8a\u6b0a\u9650\u5373\u53ef\u5beb\u5165\u5be6\u4f8b\u7684\u5ba2\u6a5f\u7279\u6027\u3002\n**\u6ce8\u610f** \uff1a `notebooks-collection-agent` \u670d\u52d9\u4f7f\u7528\u5927\u7d04 50 MB \u7684\u5167\u5b58\u5728\u5f8c\u81fa\u904b\u884c\u3002\n### \u5275\u5efa\u5553\u7528\u4e86\u7cfb\u7d71\u5065\u5eb7\u72c0\u6cc1\u5ba2\u6a5f\u7279\u6027\u7684\u7528\u6236\u7ba1\u7406\u7684\u7b46\u8a18\u672c\u5be6\u4f8b\n\u5982\u9700\u4f7f\u7528\u7cfb\u7d71\u904b\u884c\u72c0\u6cc1\u5ba2\u6a5f\u7279\u6027\u5831\u544a\u7528\u6236\u7ba1\u7406\u7684\u7b46\u8a18\u672c\u5be6\u4f8b\u7684\u904b\u884c\u72c0\u6cc1\uff0c\u60a8\u5fc5\u9808\u5728\u5275\u5efa\u7528\u6236\u7ba1\u7406\u7684\u7b46\u8a18\u672c\u5be6\u4f8b\u6642\u9078\u4e2d **\u5553\u7528\u7cfb\u7d71\u904b\u884c\u72c0\u6cc1\u5831\u544a** \u8907\u9078\u6846\u3002\n\u60a8\u53ef\u4ee5\u4f7f\u7528 Google Cloud \u63a7\u5236\u6aaf\u6216 Google Cloud CLI \u5553\u7528\u7cfb\u7d71\u5065\u5eb7\u72c0\u6cc1\u5831\u544a\u3002\n- Titles in dynamic includes are not used anywhere, and we should avoid paying to translate them\n- \u5982\u679c\u60a8\u8a08\u5283\u5728\u7528\u6236\u7ba1\u7406\u7684\u7b46\u8a18\u672c\u5be6\u4f8b\u4e2d\u4f7f\u7528 GPU\uff0c\u8acb [\u67e5\u770b Google Cloud \u63a7\u5236\u6aaf\u4e2d\u7684\u914d\u984d\u9801\u9762](https://console.cloud.google.com/quotas?hl=zh-cn) \uff0c\u78ba\u4fdd\u60a8\u7684\u9805\u76ee\u4e2d\u6709\u8db3\u5920\u7684 GPU \u53ef\u7528\u3002\u5982\u679c\u914d\u984d\u9801\u9762\u4e0a\u672a\u5217\u51fa GPU\uff0c\u6216\u8005\u60a8\u9700\u8981\u984d\u5916\u7684 GPU \u914d\u984d\uff0c\u60a8\u53ef\u4ee5\u7533\u8acb\u589e\u52a0\u914d\u984d\u3002\u8acb\u53c3\u95b1 Compute Engine [\u8cc7\u6e90\u914d\u984d](https://cloud.google.com/compute/quotas?hl=zh-cn) \u9801\u9762\u7684 [\u7533\u8acb\u589e\u52a0\u914d\u984d](https://cloud.google.com/compute/quotas?hl=zh-cn#requesting_additional_quota) \u3002### \u6240\u9700\u7684\u89d2\u8272\n\u5982\u679c\u60a8\u5df2\u5275\u5efa\u9805\u76ee\uff0c\u5247\u9700\u8981\u5177\u6709\u9805\u76ee\u7684 Owner ( `roles/owner` ) IAM \u89d2\u8272\uff0c\u8a72\u89d2\u8272\u53ef\u63d0\u4f9b\u6240\u6709\u5fc5\u9700\u7684\u6b0a\u9650\u3002\u8df3\u904e\u6b64\u90e8\u5206\u4e26\u958b\u59cb\u5275\u5efa\u7528\u6236\u7ba1\u7406\u7684\u7b46\u8a18\u672c\u5be6\u4f8b\u3002\u5982\u679c\u60a8\u672a\u81ea\u884c\u5275\u5efa\u9805\u76ee\uff0c\u8acb\u7e7c\u7e8c\u95b1\u8b80\u672c\u90e8\u5206\u3002\n\u5982\u9700\u78ba\u4fdd\u60a8\u7684\u7528\u6236\u8cec\u865f\u5177\u6709\u5275\u5efa Vertex AI Workbench \u7528\u6236\u7ba1\u7406\u7684\u7b46\u8a18\u672c\u5be6\u4f8b\u6240\u9700\u7684\u6b0a\u9650\uff0c\u8acb\u8b93\u60a8\u7684\u7ba1\u7406\u54e1\u5411\u60a8\u7684\u7528\u6236\u8cec\u865f\u6388\u4e88\u9805\u76ee\u7684\u4ee5\u4e0b IAM \u89d2\u8272\uff1a\n- Notebooks Admin ( [roles/notebooks.admin](https://cloud.google.com/vertex-ai/docs/workbench/user-managed/iam?hl=zh-cn#notebooks.admin) )\n- Service Account User ( [roles/iam.serviceAccountUser](https://cloud.google.com/iam/docs/understanding-roles?hl=zh-cn#iam.serviceAccountUser) )\n\u5982\u9700\u8a73\u7d30\u77ad\u89e3\u5982\u4f55\u6388\u4e88\u89d2\u8272\uff0c\u8acb\u53c3\u95b1 [\u7ba1\u7406\u8a2a\u554f\u6b0a\u9650](https://cloud.google.com/iam/docs/granting-changing-revoking-access?hl=zh-cn) \u3002\n\u60a8\u7684\u7ba1\u7406\u54e1\u9084\u53ef\u4ee5\u901a\u904e [\u81ea\u5b9a\u7fa9\u89d2\u8272](https://cloud.google.com/iam/docs/creating-custom-roles?hl=zh-cn) \u6216\u5176\u4ed6 [\u9810\u5b9a\u7fa9\u89d2\u8272](https://cloud.google.com/iam/docs/understanding-roles?hl=zh-cn) \u5411\u60a8\u7684\u7528\u6236\u8cec\u865f\u6388\u4e88\u6240\u9700\u7684\u6b0a\u9650\u3002- \u5728 Google Cloud \u63a7\u5236\u6aaf\u4e2d\uff0c\u8f49\u5230 **\u7528\u6236\u7ba1\u7406\u7684\u7b46\u8a18\u672c** \u9801\u9762\u3002 \u6216\u8005\u8f49\u5230 [notebook.new](https://notebook.new) (https://notebook.new) \u4e26\u8df3\u904e\u4e0b\u4e00\u6b65\u3002 [\u8f49\u5230\u201c\u7528\u6236\u7ba1\u7406\u7684\u7b46\u8a18\u672c\u201d](https://console.cloud.google.com/vertex-ai/workbench/user-managed?hl=zh-cn) \n- \u9ede\u64ca add_box **\u65b0\u5efa\u7b46\u8a18\u672c** \uff0c\u7136\u5f8c\u9078\u64c7 **\u81ea\u5b9a\u7fa9** \u3002\n- \u5728 **\u5275\u5efa\u7528\u6236\u7ba1\u7406\u7684\u7b46\u8a18\u672c** \u9801\u9762\u7684 **\u8a73\u7d30\u4fe1\u606f** \u90e8\u5206\u4e2d\uff0c\u7232\u65b0\u5be6\u4f8b\u63d0\u4f9b\u4ee5\u4e0b\u4fe1\u606f\uff1a- **\u540d\u7a31** \uff1a\u65b0\u5be6\u4f8b\u7684\u540d\u7a31\u3002\n- **\u5340\u57df** \u548c **\u53ef\u7528\u5340** \uff1a\u7232\u65b0\u5be6\u4f8b\u9078\u64c7\u5340\u57df\u548c\u53ef\u7528\u5340\u3002\u7232\u7372\u5f97\u6700\u4f73\u7db2\u7d61\u6027\u80fd\uff0c\u8acb\u9078\u64c7\u8207\u60a8\u7684\u5730\u7406\u4f4d\u7f6e\u6700\u8fd1\u7684\u5340\u57df\u3002 \u67e5\u770b\u53ef\u7528\u7684 [\u7528\u6236\u7ba1\u7406\u7684\u7b46\u8a18\u672c\u4f4d\u7f6e](https://cloud.google.com/vertex-ai/docs/general/locations?hl=zh-cn#user-managed-notebooks-locations) \u3002\n- \u9078\u64c7 **\u7cfb\u7d71\u5065\u5eb7\u72c0\u6cc1** \u90e8\u5206\u3002\n- \u5728 **\u7cfb\u7d71\u5065\u5eb7\u72c0\u6cc1\u548c\u5831\u544a** \u90e8\u5206\u4e2d\uff0c\u9078\u4e2d **\u5553\u7528\u7cfb\u7d71\u5065\u5eb7\u72c0\u6cc1\u5831\u544a** \u8907\u9078\u6846\u3002\n- \u5b8c\u6210\u5be6\u4f8b\u5275\u5efa\u5c0d\u8a71\u6846\u7684\u5176\u9918\u90e8\u5206\uff0c\u7136\u5f8c\u9ede\u64ca **\u5275\u5efa** \u3002\n- \u5728 [Cloud Shell](https://cloud.google.com/shell/docs/starting-cloud-shell?hl=zh-cn) \u4e2d\u6216\u5b89\u88dd\u4e86 [Google Cloud CLI](https://cloud.google.com/sdk/docs?hl=zh-cn) \u7684\u4efb\u4f55\u74b0\u5883\u4e2d\uff0c\u8f38\u5165\u4ee5\u4e0b [Google Cloud CLI](https://cloud.google.com/sdk/gcloud?hl=zh-cn) \u547d\u4ee4\uff1a```\ngcloud notebooks instances create INSTANCE_NAME \\\u00a0 \u00a0 --vm-image-project=deeplearning-platform-release \\\u00a0 \u00a0 --vm-image-family=IMAGE_FAMILY \\\u00a0 \u00a0 --machine-type=MACHINE_TYPE \\\u00a0 \u00a0 --location=ZONE \\\u00a0 \u00a0 --metadata=enable-guest-attributes=TRUE,report-system-health=TRUE\n```\u8acb\u66ff\u63db\u4ee5\u4e0b\u5167\u5bb9\uff1a- ``\uff1a\u65b0\u5be6\u4f8b\u7684\u540d\u7a31\n- ``\uff1a\u8981\u7528\u65bc\u5275\u5efa\u5be6\u4f8b\u7684 [\u6620\u50cf\u7cfb\u5217\u540d\u7a31](https://cloud.google.com/vertex-ai/docs/workbench/user-managed/images?hl=zh-cn#deciding) \n- ``\uff1a\u5be6\u4f8b\u865b\u64ec\u6a5f\u7684 [\u6a5f\u5668\u985e\u578b](https://cloud.google.com/compute/docs/machine-types?hl=zh-cn) \uff1b\u4f8b\u5982`n1-standard-4`\n- ``\uff1a\u60a8\u5e0c\u671b\u65b0\u5be6\u4f8b\u6240\u5728\u7684\u53ef\u7528\u5340\uff0c\u4f8b\u5982`us-west1-a`\n- \u901a\u904e [Google Cloud \u63a7\u5236\u6aaf](https://console.cloud.google.com/vertex-ai/workbench/user-managed?hl=zh-cn) \u8a2a\u554f\u5be6\u4f8b\u3002\n### \u901a\u904e\u5ba2\u6a5f\u7279\u6027\u76e3\u63a7\u7cfb\u7d71\u5065\u5eb7\u72c0\u6cc1\n\u5c0d\u65bc [\u5df2\u5553\u7528\u76f8\u95dc\u5ba2\u6a5f\u5c6c\u6027](#enable-guest-attributes) \u7684\u7528\u6236\u7ba1\u7406\u7b46\u8a18\u672c\u5be6\u4f8b\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528 Google Cloud \u63a7\u5236\u6aaf\u3001Google Cloud CLI \u548c Compute Engine \u547d\u4ee4\uff0c\u6216Google Cloud CLI \u548c Vertex AI Workbench \u547d\u4ee4\u4f86\u6aa2\u7d22\u7cfb\u7d71\u5065\u5eb7\u72c0\u6cc1\u5ba2\u6a5f\u5c6c\u6027\u7684\u503c\u3002\n- \u5728 Google Cloud \u63a7\u5236\u6aaf\u4e2d\uff0c\u6253\u958b **\u7528\u6236\u7ba1\u7406\u7684\u7b46\u8a18\u672c** \u9801\u9762\u3002 [\u9032\u5165\u201c\u7528\u6236\u7ba1\u7406\u7684\u7b46\u8a18\u672c\u201d](https://console.cloud.google.com/vertex-ai/workbench/user-managed?hl=zh-cn) \n- \u9ede\u64ca\u8981\u67e5\u770b\u5176\u7cfb\u7d71\u904b\u884c\u72c0\u6cc1\u7684\u5be6\u4f8b\u540d\u7a31\u3002\n- \u5728 **\u7b46\u8a18\u672c\u8a73\u60c5** \u9801\u9762\u4e0a\uff0c\u9ede\u64ca **\u5065\u5eb7\u72c0\u6cc1** \u6a19\u7c64\u9801\u3002\u67e5\u770b\u5be6\u4f8b\u53ca\u5176\u6838\u5fc3\u670d\u52d9\u7684\u72c0\u614b\u3002\n```\ngcloud compute instances get-guest-attributes INSTANCE_NAME \\\u00a0 \u00a0 --zone ZONE\n```\n\u8acb\u66ff\u63db\u4ee5\u4e0b\u5167\u5bb9\uff1a- ``\uff1a\u5be6\u4f8b\u7684\u540d\u7a31\n- ``\uff1a\u5be6\u4f8b\u6240\u5728\u7684\u53ef\u7528\u5340\n\u5982\u679c\u60a8\u7684\u6838\u5fc3\u670d\u52d9\u5065\u5eb7\u72c0\u6cc1\u826f\u597d\uff0c\u7d50\u679c\u5c07\u5982\u4e0b\u6240\u793a\u3002 \u503c `1` \u8868\u793a\u672a\u6aa2\u6e2c\u5230\u6545\u969c\u3002\n```\n NAMESPACE KEY       VALUE\n notebooks docker_proxy_agent_status 1\n notebooks docker_status    1\n notebooks jupyterlab_api_status  1\n notebooks jupyterlab_status   1\n notebooks system-health    1\n notebooks updated      2020-10-01 17:00:00.12345\n```\n\u5982\u679c\u56db\u500b\u6838\u5fc3\u670d\u52d9\u4e2d\u7684\u4efb\u4f55\u4e00\u500b\u767c\u751f\u6545\u969c\uff0c\u7cfb\u7d71\u5065\u5eb7\u72c0\u6cc1\u5c07\u5831\u544a\u7232\u503c `-1` \uff0c\u8868\u793a\u7cfb\u7d71\u6545\u969c\u3002\u5728\u5927\u591a\u6578\u60c5\u6cc1\u4e0b\uff0c\u7cfb\u7d71\u6545\u969c\u610f\u5473\u7740\u7121\u6cd5\u8a2a\u554f JupyterLab\u3002\n\u6545\u969c\u7d50\u679c\u7684\u793a\u4f8b\u53ef\u80fd\u5982\u4e0b\u6240\u793a\u3002\n```\n NAMESPACE KEY       VALUE\n notebooks docker_proxy_agent_status -1\n notebooks docker_status    -1\n notebooks jupyterlab_api_status  1\n notebooks jupyterlab_status   1\n notebooks system-health    -1\n notebooks updated      2020-10-01 17:00:00.12345\n```\n\u5982\u9700\u76e3\u63a7\u7cfb\u7d71\u5065\u5eb7\u72c0\u6cc1\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528 [getInstanceHealth](https://cloud.google.com/vertex-ai/docs/workbench/reference/rest/v1/projects.locations.instances/getInstanceHealth?hl=zh-cn) \u65b9\u6cd5\u6aa2\u7d22\u5ba2\u6a5f\u7279\u6027\u7684\u503c\u3002\n\u4ee5\u4e0b\u793a\u4f8b\u5c55\u793a\u77ad\u5982\u4f55\u4f7f\u7528 gcloud CLI \u57f7\u884c\u6b64\u64cd\u4f5c\u3002\n```\ngcloud notebooks instances is-healthy example-instance \\\n --location=ZONE\n```\n\u5c07 `` \u66ff\u63db\u7232\u60a8\u7684\u5be6\u4f8b\u6240\u5728\u7684\u53ef\u7528\u5340\uff0c\u4f8b\u5982 `us-west1-a` \u3002\n\u5982\u679c\u60a8\u7684\u6838\u5fc3\u670d\u52d9\u5065\u5eb7\u72c0\u6cc1\u826f\u597d\uff0c\u7d50\u679c\u5c07\u5982\u4e0b\u6240\u793a\u3002 \u503c `1` \u8868\u793a\u672a\u6aa2\u6e2c\u5230\u6545\u969c\u3002\n```\n {\n   \"health_state\": HEALTHY,\n   \"docker-proxy-agent\": 1,\n   \"docker-service\": 1,\n   \"jupyter-service\": 1,\n   \"jupyter-api\": 1,\n   \"last-updated\": \"2020-10-01 17:00:30.12345\"\n }\n```\n\u6545\u969c\u7d50\u679c\u7684\u793a\u4f8b\u53ef\u80fd\u5982\u4e0b\u6240\u793a\u3002\n```\n {\n   \"healthy\": UNHEALTHY,\n   \"docker-proxy-agent\": 1,\n   \"docker-service\": 1,\n   \"jupyter-service\": -1,\n   \"jupyter-api\": -1,\n   \"last-updated\": \"2020-10-01 17:00:30.12345\"\n }\n```\n## \u5411 Monitoring \u5831\u544a\u81ea\u5b9a\u7fa9\u6307\u6a19\n\u7528\u6236\u7ba1\u7406\u7684\u7b46\u8a18\u672c\u5be6\u4f8b\u53ef\u8b93\u60a8\u6536\u96c6\u7cfb\u7d71\u72c0\u614b\u548c JupyterLab \u6307\u6a19\uff0c\u4e26\u5c07\u5b83\u5011\u5831\u544a\u7d66 Cloud Monitoring\u3002\u9019\u4e9b\u81ea\u5b9a\u7fa9\u6307\u6a19\u8207 [\u5728\u7528\u6236\u7ba1\u7406\u7684\u7b46\u8a18\u672c\u5be6\u4f8b\u4e0a\u5b89\u88dd Monitoring](#install-monitoring) \u6642\u5831\u544a\u7684\u6a19\u6e96\u6307\u6a19\u4e0d\u540c\u3002\n\u5831\u544a\u7d66 Monitoring \u7684\u81ea\u5b9a\u7fa9\u6307\u6a19\u5305\u62ec\uff1a\n- \u4ee5\u4e0b\u7528\u6236\u7ba1\u7406\u7684\u7b46\u8a18\u672c\u6838\u5fc3\u670d\u52d9\u7684\u7cfb\u7d71\u5065\u5eb7\u72c0\u6cc1\uff1a- Docker \u670d\u52d9\n- Docker \u53cd\u5411\u4ee3\u7406\u4ee3\u7406\n- Jupyter \u670d\u52d9\n- Jupyter API\n- \u4ee5\u4e0b JupyterLab \u6307\u6a19\uff1a- \u5167\u6838\u6578\u91cf\n- \u7d42\u7aef\u6578\u91cf\n- \u9023\u63a5\u6578\u91cf\n- \u6703\u8a71\u6578\u91cf\n- \u6700\u9ad8\u5167\u5b58\u4f7f\u7528\u91cf\n- \u9ad8\u5167\u5b58\n- \u7576\u524d\u5167\u5b58\u91cf\n### \u5be6\u4f8b\u5982\u4f55\u5411 Monitoring \u5831\u544a\u81ea\u5b9a\u7fa9\u6307\u6a19\n\u8981\u5411 Monitoring \u5831\u544a\u81ea\u5b9a\u7fa9\u6307\u6a19\uff0c\u60a8\u5fc5\u9808\u5728\u5275\u5efa \u7528\u6236\u7ba1\u7406\u7684\u7b46\u8a18\u672c\u5be6\u4f8b\u6642\u5553\u7528 `report-notebook-metrics` \u5143\u6578\u64da\u8a2d\u7f6e\u3002\n\u60a8\u9084\u5fc5\u9808\u78ba\u4fdd\u7528\u6236\u7ba1\u7406\u7684\u7b46\u8a18\u672c\u5be6\u4f8b\u7684\u670d\u52d9\u8cec\u865f\u5177\u6709 Monitoring Metric Writer ( `roles/monitoring.metricWriter` ) \u6b0a\u9650\u3002\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [\u7ba1\u7406\u5c0d\u9805\u76ee\u3001\u6587\u4ef6\u593e\u548c\u7d44\u7e54\u7684\u8a2a\u554f\u6b0a\u9650](https://cloud.google.com/iam/docs/granting-changing-revoking-access?hl=zh-cn) \u3002\n### \u5275\u5efa\u7528\u6236\u7ba1\u7406\u7684\u7b46\u8a18\u672c\u5be6\u4f8b\uff0c\u7528\u65bc\u5411 Monitoring \u5831\u544a\u81ea\u5b9a\u7fa9\u6307\u6a19\n\u5982\u9700\u5411 Monitoring \u5831\u544a\u81ea\u5b9a\u7fa9\u6307\u6a19\uff0c\u60a8\u5fc5\u9808\u5728\u5275\u5efa\u7528\u6236\u7ba1\u7406\u7684\u7b46\u8a18\u672c\u5be6\u4f8b\u6642\u9078\u4e2d **\u5411 Cloud Monitoring \u5831\u544a\u81ea\u5b9a\u7fa9\u6307\u6a19** \u8907\u9078\u6846\u3002\n\u60a8\u53ef\u4ee5\u4f7f\u7528 Google Cloud \u63a7\u5236\u6aaf\u6216 Google Cloud CLI \u5553\u7528\u5411 Cloud Monitoring \u5831\u544a\u81ea\u5b9a\u7fa9\u6307\u6a19\u7684\u529f\u80fd\u3002\n- Titles in dynamic includes are not used anywhere, and we should avoid paying to translate them\n- \u5982\u679c\u60a8\u8a08\u5283\u5728\u7528\u6236\u7ba1\u7406\u7684\u7b46\u8a18\u672c\u5be6\u4f8b\u4e2d\u4f7f\u7528 GPU\uff0c\u8acb [\u67e5\u770b Google Cloud \u63a7\u5236\u6aaf\u4e2d\u7684\u914d\u984d\u9801\u9762](https://console.cloud.google.com/quotas?hl=zh-cn) \uff0c\u78ba\u4fdd\u60a8\u7684\u9805\u76ee\u4e2d\u6709\u8db3\u5920\u7684 GPU \u53ef\u7528\u3002\u5982\u679c\u914d\u984d\u9801\u9762\u4e0a\u672a\u5217\u51fa GPU\uff0c\u6216\u8005\u60a8\u9700\u8981\u984d\u5916\u7684 GPU \u914d\u984d\uff0c\u60a8\u53ef\u4ee5\u7533\u8acb\u589e\u52a0\u914d\u984d\u3002\u8acb\u53c3\u95b1 Compute Engine [\u8cc7\u6e90\u914d\u984d](https://cloud.google.com/compute/quotas?hl=zh-cn) \u9801\u9762\u7684 [\u7533\u8acb\u589e\u52a0\u914d\u984d](https://cloud.google.com/compute/quotas?hl=zh-cn#requesting_additional_quota) \u3002### \u6240\u9700\u7684\u89d2\u8272\n\u5982\u679c\u60a8\u5df2\u5275\u5efa\u9805\u76ee\uff0c\u5247\u9700\u8981\u5177\u6709\u9805\u76ee\u7684 Owner ( `roles/owner` ) IAM \u89d2\u8272\uff0c\u8a72\u89d2\u8272\u53ef\u63d0\u4f9b\u6240\u6709\u5fc5\u9700\u7684\u6b0a\u9650\u3002\u8df3\u904e\u6b64\u90e8\u5206\u4e26\u958b\u59cb\u5275\u5efa\u7528\u6236\u7ba1\u7406\u7684\u7b46\u8a18\u672c\u5be6\u4f8b\u3002\u5982\u679c\u60a8\u672a\u81ea\u884c\u5275\u5efa\u9805\u76ee\uff0c\u8acb\u7e7c\u7e8c\u95b1\u8b80\u672c\u90e8\u5206\u3002\n\u5982\u9700\u78ba\u4fdd\u60a8\u7684\u7528\u6236\u8cec\u865f\u5177\u6709\u5275\u5efa Vertex AI Workbench \u7528\u6236\u7ba1\u7406\u7684\u7b46\u8a18\u672c\u5be6\u4f8b\u6240\u9700\u7684\u6b0a\u9650\uff0c\u8acb\u8b93\u60a8\u7684\u7ba1\u7406\u54e1\u5411\u60a8\u7684\u7528\u6236\u8cec\u865f\u6388\u4e88\u9805\u76ee\u7684\u4ee5\u4e0b IAM \u89d2\u8272\uff1a\n- Notebooks Admin ( [roles/notebooks.admin](https://cloud.google.com/vertex-ai/docs/workbench/user-managed/iam?hl=zh-cn#notebooks.admin) )\n- Service Account User ( [roles/iam.serviceAccountUser](https://cloud.google.com/iam/docs/understanding-roles?hl=zh-cn#iam.serviceAccountUser) )\n\u5982\u9700\u8a73\u7d30\u77ad\u89e3\u5982\u4f55\u6388\u4e88\u89d2\u8272\uff0c\u8acb\u53c3\u95b1 [\u7ba1\u7406\u8a2a\u554f\u6b0a\u9650](https://cloud.google.com/iam/docs/granting-changing-revoking-access?hl=zh-cn) \u3002\n\u60a8\u7684\u7ba1\u7406\u54e1\u9084\u53ef\u4ee5\u901a\u904e [\u81ea\u5b9a\u7fa9\u89d2\u8272](https://cloud.google.com/iam/docs/creating-custom-roles?hl=zh-cn) \u6216\u5176\u4ed6 [\u9810\u5b9a\u7fa9\u89d2\u8272](https://cloud.google.com/iam/docs/understanding-roles?hl=zh-cn) \u5411\u60a8\u7684\u7528\u6236\u8cec\u865f\u6388\u4e88\u6240\u9700\u7684\u6b0a\u9650\u3002- \u5728 Google Cloud \u63a7\u5236\u6aaf\u4e2d\uff0c\u8f49\u5230 **\u7528\u6236\u7ba1\u7406\u7684\u7b46\u8a18\u672c** \u9801\u9762\u3002 \u6216\u8005\u8f49\u5230 [notebook.new](https://notebook.new) (https://notebook.new) \u4e26\u8df3\u904e\u4e0b\u4e00\u6b65\u3002 [\u8f49\u5230\u201c\u7528\u6236\u7ba1\u7406\u7684\u7b46\u8a18\u672c\u201d](https://console.cloud.google.com/vertex-ai/workbench/user-managed?hl=zh-cn) \n- \u9ede\u64ca add_box **\u65b0\u5efa\u7b46\u8a18\u672c** \uff0c\u7136\u5f8c\u9078\u64c7 **\u81ea\u5b9a\u7fa9** \u3002\n- \u5728 **\u5275\u5efa\u7528\u6236\u7ba1\u7406\u7684\u7b46\u8a18\u672c** \u9801\u9762\u7684 **\u8a73\u7d30\u4fe1\u606f** \u90e8\u5206\u4e2d\uff0c\u7232\u65b0\u5be6\u4f8b\u63d0\u4f9b\u4ee5\u4e0b\u4fe1\u606f\uff1a- **\u540d\u7a31** \uff1a\u65b0\u5be6\u4f8b\u7684\u540d\u7a31\u3002\n- **\u5340\u57df** \u548c **\u53ef\u7528\u5340** \uff1a\u7232\u65b0\u5be6\u4f8b\u9078\u64c7\u5340\u57df\u548c\u53ef\u7528\u5340\u3002\u7232\u7372\u5f97\u6700\u4f73\u7db2\u7d61\u6027\u80fd\uff0c\u8acb\u9078\u64c7\u8207\u60a8\u7684\u5730\u7406\u4f4d\u7f6e\u6700\u8fd1\u7684\u5340\u57df\u3002 \u67e5\u770b\u53ef\u7528\u7684 [\u7528\u6236\u7ba1\u7406\u7684\u7b46\u8a18\u672c\u4f4d\u7f6e](https://cloud.google.com/vertex-ai/docs/general/locations?hl=zh-cn#user-managed-notebooks-locations) \u3002\n- \u9078\u64c7 **\u7cfb\u7d71\u5065\u5eb7\u72c0\u6cc1** \u90e8\u5206\u3002\n- \u5728 **\u7cfb\u7d71\u5065\u5eb7\u72c0\u6cc1\u548c\u5831\u544a** \u90e8\u5206\u4e2d\uff0c\u9078\u4e2d **\u5411 Cloud Monitoring \u5831\u544a\u81ea\u5b9a\u7fa9\u6307\u6a19** \u8907\u9078\u6846\u3002\n- \u5b8c\u6210\u5be6\u4f8b\u5275\u5efa\u5c0d\u8a71\u6846\u7684\u5176\u9918\u90e8\u5206\uff0c\u7136\u5f8c\u9ede\u64ca **\u5275\u5efa** \u3002\n- \u5728 [Cloud Shell](https://cloud.google.com/shell/docs/starting-cloud-shell?hl=zh-cn) \u4e2d\u6216\u5b89\u88dd\u4e86 [Google Cloud CLI](https://cloud.google.com/sdk/docs?hl=zh-cn) \u7684\u4efb\u4f55\u74b0\u5883\u4e2d\uff0c\u8f38\u5165\u4ee5\u4e0b [Google Cloud CLI](https://cloud.google.com/sdk/gcloud?hl=zh-cn) \u547d\u4ee4\uff1a```\ngcloud notebooks instances create INSTANCE_NAME \\\u00a0 \u00a0 --vm-image-project=deeplearning-platform-release \\\u00a0 \u00a0 --vm-image-family=IMAGE_FAMILY \\\u00a0 \u00a0 --machine-type=MACHINE_TYPE \\\u00a0 \u00a0 --location=ZONE \\\u00a0 \u00a0 --metadata=report-notebook-metrics=TRUE\n```\u8acb\u66ff\u63db\u4ee5\u4e0b\u5167\u5bb9\uff1a- ``\uff1a\u65b0\u5be6\u4f8b\u7684\u540d\u7a31\n- ``\uff1a\u8981\u7528\u65bc\u5275\u5efa\u5be6\u4f8b\u7684 [\u6620\u50cf\u7cfb\u5217\u540d\u7a31](https://cloud.google.com/vertex-ai/docs/workbench/user-managed/images?hl=zh-cn#deciding) \n- ``\uff1a\u5be6\u4f8b\u865b\u64ec\u6a5f\u7684 [\u6a5f\u5668\u985e\u578b](https://cloud.google.com/compute/docs/machine-types?hl=zh-cn) \uff0c\u4f8b\u5982`n1-standard-4`\n- ``\uff1a\u60a8\u5e0c\u671b\u65b0\u5be6\u4f8b\u6240\u5728\u7684\u53ef\u7528\u5340\uff0c\u4f8b\u5982`us-west1-a`\n- \u901a\u904e [Google Cloud \u63a7\u5236\u6aaf](https://console.cloud.google.com/vertex-ai/workbench/user-managed?hl=zh-cn) \u8a2a\u554f\u5be6\u4f8b\u3002\n### \u5411\u670d\u52d9\u8cec\u865f\u6388\u4e88 Monitoring Metric Writer \u6b0a\u9650\n\u5275\u5efa\u65b0\u7684\u7528\u6236\u7ba1\u7406\u7684\u7b46\u8a18\u672c\u5be6\u4f8b\u5f8c\uff0c\u5411\u8a72\u7b46\u8a18\u672c\u5be6\u4f8b\u7684\u670d\u52d9\u8cec\u865f\u6388\u4e88 Monitoring Metric Writer \u6b0a\u9650 ( `roles/monitoring.metricWriter` )\u3002\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [\u7ba1\u7406\u5c0d\u9805\u76ee\u3001\u6587\u4ef6\u593e\u548c\u7d44\u7e54\u7684\u8a2a\u554f\u6b0a\u9650](https://cloud.google.com/iam/docs/granting-changing-revoking-access?hl=zh-cn) \u3002\n### \u901a\u904e Monitoring \u76e3\u63a7\u81ea\u5b9a\u7fa9\u6307\u6a19\n\u5c0d\u65bc [\u5553\u7528\u4e86\u5831\u544a\u81ea\u5b9a\u7fa9\u6307\u6a19\u529f\u80fd](#report-custom-metrics) \u7684\u7528\u6236\u7ba1\u7406\u7b46\u8a18\u672c\u5be6\u4f8b\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528 Google Cloud Console \u76e3\u63a7\u81ea\u5b9a\u7fa9\u6307\u6a19\u3002\n- \u5728 Google Cloud \u63a7\u5236\u6aaf\u4e2d\uff0c\u6253\u958b **\u7528\u6236\u7ba1\u7406\u7684\u7b46\u8a18\u672c** \u9801\u9762\u3002 [\u8f49\u5230\u201c\u7528\u6236\u7ba1\u7406\u7684\u7b46\u8a18\u672c\u201d](https://console.cloud.google.com/vertex-ai/workbench/user-managed?hl=zh-cn) \n- \u9ede\u64ca\u8981\u67e5\u770b\u5176\u81ea\u5b9a\u7fa9\u6307\u6a19\u7684\u5be6\u4f8b\u540d\u7a31\u3002\n- \u5728 **\u7b46\u8a18\u672c\u8a73\u60c5** \u9801\u9762\u4e0a\uff0c\u9ede\u64ca **Monitoring** \u6a19\u7c64\u9801\u3002\u67e5\u770b\u5be6\u4f8b\u7684\u81ea\u5b9a\u7fa9\u6307\u6a19\u3002## \u5728\u5be6\u4f8b\u4e0a\u5b89\u88dd Monitoring\n\u6b64\u9078\u9805\u6703\u81ea\u52d5\u5b89\u88dd Monitoring\u3002\u5b89\u88dd\u9700\u8981\u4f7f\u7528 256 MB \u78c1\u76e4\u7a7a\u9593\u3002\u9700\u8981\u9023\u63a5\u5230\u4e92\u806f\u7db2\u624d\u80fd\u5411 Monitoring \u5831\u544a\u6307\u6a19\u3002\n### \u5be6\u4f8b\u5982\u4f55\u5831\u544a\u7cfb\u7d71\u548c\u61c9\u7528\u6307\u6a19\n\u5982\u9700\u901a\u904e\u5728\u7528\u6236\u7ba1\u7406\u7684\u7b46\u8a18\u672c\u5be6\u4f8b\u4e0a\u5b89\u88dd Cloud Monitoring \u4f86\u5831\u544a\u7cfb\u7d71\u548c\u61c9\u7528\u6307\u6a19\uff0c\u60a8\u5fc5\u9808\u5728\u5275\u5efa\u7528\u6236\u7ba1\u7406\u7684\u7b46\u8a18\u672c\u5be6\u4f8b\u6642\u9078\u4e2d **\u5b89\u88dd Cloud Monitoring \u4ee3\u7406** \u8907\u9078\u6846\u3002 \u9019\u4e9b\u6307\u6a19\u4e0d\u540c\u65bc\u60a8 [\u5553\u7528 report-notebook-metrics \u5143\u6578\u64da\u8a2d\u7f6e](#report-custom-metrics) \u6642\u5831\u544a\u7684\u81ea\u5b9a\u7fa9\u6307\u6a19\u3002\n### \u5275\u5efa\u7528\u6236\u7ba1\u7406\u7684\u7b46\u8a18\u672c\u5be6\u4f8b\uff0c\u7528\u65bc\u5411 Monitoring \u5831\u544a\u7cfb\u7d71\u548c\u61c9\u7528\u6307\u6a19\n\u5982\u9700\u5728\u7528\u6236\u7ba1\u7406\u7684\u7b46\u8a18\u672c\u5be6\u4f8b\u4e0a\u5b89\u88dd Monitoring\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528 Google Cloud \u63a7\u5236\u6aaf\u6216 Google Cloud CLI\u3002\n- Titles in dynamic includes are not used anywhere, and we should avoid paying to translate them\n- \u5982\u679c\u60a8\u8a08\u5283\u5728\u7528\u6236\u7ba1\u7406\u7684\u7b46\u8a18\u672c\u5be6\u4f8b\u4e2d\u4f7f\u7528 GPU\uff0c\u8acb [\u67e5\u770b Google Cloud \u63a7\u5236\u6aaf\u4e2d\u7684\u914d\u984d\u9801\u9762](https://console.cloud.google.com/quotas?hl=zh-cn) \uff0c\u78ba\u4fdd\u60a8\u7684\u9805\u76ee\u4e2d\u6709\u8db3\u5920\u7684 GPU \u53ef\u7528\u3002\u5982\u679c\u914d\u984d\u9801\u9762\u4e0a\u672a\u5217\u51fa GPU\uff0c\u6216\u8005\u60a8\u9700\u8981\u984d\u5916\u7684 GPU \u914d\u984d\uff0c\u60a8\u53ef\u4ee5\u7533\u8acb\u589e\u52a0\u914d\u984d\u3002\u8acb\u53c3\u95b1 Compute Engine [\u8cc7\u6e90\u914d\u984d](https://cloud.google.com/compute/quotas?hl=zh-cn) \u9801\u9762\u7684 [\u7533\u8acb\u589e\u52a0\u914d\u984d](https://cloud.google.com/compute/quotas?hl=zh-cn#requesting_additional_quota) \u3002### \u6240\u9700\u7684\u89d2\u8272\n\u5982\u679c\u60a8\u5df2\u5275\u5efa\u9805\u76ee\uff0c\u5247\u9700\u8981\u5177\u6709\u9805\u76ee\u7684 Owner ( `roles/owner` ) IAM \u89d2\u8272\uff0c\u8a72\u89d2\u8272\u53ef\u63d0\u4f9b\u6240\u6709\u5fc5\u9700\u7684\u6b0a\u9650\u3002\u8df3\u904e\u6b64\u90e8\u5206\u4e26\u958b\u59cb\u5275\u5efa\u7528\u6236\u7ba1\u7406\u7684\u7b46\u8a18\u672c\u5be6\u4f8b\u3002\u5982\u679c\u60a8\u672a\u81ea\u884c\u5275\u5efa\u9805\u76ee\uff0c\u8acb\u7e7c\u7e8c\u95b1\u8b80\u672c\u90e8\u5206\u3002\n\u5982\u9700\u78ba\u4fdd\u60a8\u7684\u7528\u6236\u8cec\u865f\u5177\u6709\u5275\u5efa Vertex AI Workbench \u7528\u6236\u7ba1\u7406\u7684\u7b46\u8a18\u672c\u5be6\u4f8b\u6240\u9700\u7684\u6b0a\u9650\uff0c\u8acb\u8b93\u60a8\u7684\u7ba1\u7406\u54e1\u5411\u60a8\u7684\u7528\u6236\u8cec\u865f\u6388\u4e88\u9805\u76ee\u7684\u4ee5\u4e0b IAM \u89d2\u8272\uff1a\n- Notebooks Admin ( [roles/notebooks.admin](https://cloud.google.com/vertex-ai/docs/workbench/user-managed/iam?hl=zh-cn#notebooks.admin) )\n- Service Account User ( [roles/iam.serviceAccountUser](https://cloud.google.com/iam/docs/understanding-roles?hl=zh-cn#iam.serviceAccountUser) )\n\u5982\u9700\u8a73\u7d30\u77ad\u89e3\u5982\u4f55\u6388\u4e88\u89d2\u8272\uff0c\u8acb\u53c3\u95b1 [\u7ba1\u7406\u8a2a\u554f\u6b0a\u9650](https://cloud.google.com/iam/docs/granting-changing-revoking-access?hl=zh-cn) \u3002\n\u60a8\u7684\u7ba1\u7406\u54e1\u9084\u53ef\u4ee5\u901a\u904e [\u81ea\u5b9a\u7fa9\u89d2\u8272](https://cloud.google.com/iam/docs/creating-custom-roles?hl=zh-cn) \u6216\u5176\u4ed6 [\u9810\u5b9a\u7fa9\u89d2\u8272](https://cloud.google.com/iam/docs/understanding-roles?hl=zh-cn) \u5411\u60a8\u7684\u7528\u6236\u8cec\u865f\u6388\u4e88\u6240\u9700\u7684\u6b0a\u9650\u3002- \u5728 Google Cloud \u63a7\u5236\u6aaf\u4e2d\uff0c\u8f49\u5230 **\u7528\u6236\u7ba1\u7406\u7684\u7b46\u8a18\u672c** \u9801\u9762\u3002 \u6216\u8005\u8f49\u5230 [notebook.new](https://notebook.new) (https://notebook.new) \u4e26\u8df3\u904e\u4e0b\u4e00\u6b65\u3002 [\u8f49\u5230\u201c\u7528\u6236\u7ba1\u7406\u7684\u7b46\u8a18\u672c\u201d](https://console.cloud.google.com/vertex-ai/workbench/user-managed?hl=zh-cn) \n- \u9ede\u64ca add_box **\u65b0\u5efa\u7b46\u8a18\u672c** \uff0c\u7136\u5f8c\u9078\u64c7 **\u81ea\u5b9a\u7fa9** \u3002\n- \u5728 **\u5275\u5efa\u7528\u6236\u7ba1\u7406\u7684\u7b46\u8a18\u672c** \u9801\u9762\u7684 **\u8a73\u7d30\u4fe1\u606f** \u90e8\u5206\u4e2d\uff0c\u7232\u65b0\u5be6\u4f8b\u63d0\u4f9b\u4ee5\u4e0b\u4fe1\u606f\uff1a- **\u540d\u7a31** \uff1a\u65b0\u5be6\u4f8b\u7684\u540d\u7a31\u3002\n- **\u5340\u57df** \u548c **\u53ef\u7528\u5340** \uff1a\u7232\u65b0\u5be6\u4f8b\u9078\u64c7\u5340\u57df\u548c\u53ef\u7528\u5340\u3002\u7232\u7372\u5f97\u6700\u4f73\u7db2\u7d61\u6027\u80fd\uff0c\u8acb\u9078\u64c7\u8207\u60a8\u7684\u5730\u7406\u4f4d\u7f6e\u6700\u8fd1\u7684\u5340\u57df\u3002 \u67e5\u770b\u53ef\u7528\u7684 [\u7528\u6236\u7ba1\u7406\u7684\u7b46\u8a18\u672c\u4f4d\u7f6e](https://cloud.google.com/vertex-ai/docs/general/locations?hl=zh-cn#user-managed-notebooks-locations) \u3002\n- \u9078\u64c7 **\u7cfb\u7d71\u5065\u5eb7\u72c0\u6cc1** \u90e8\u5206\u3002\n- \u5728 **\u7cfb\u7d71\u5065\u5eb7\u72c0\u6cc1\u548c\u5831\u544a** \u90e8\u5206\u4e2d\uff0c\u9078\u4e2d **\u5b89\u88dd Cloud Monitoring \u4ee3\u7406** \u8907\u9078\u6846\u3002\n- \u5b8c\u6210\u5be6\u4f8b\u5275\u5efa\u5c0d\u8a71\u6846\u7684\u5176\u9918\u90e8\u5206\uff0c\u7136\u5f8c\u9ede\u64ca **\u5275\u5efa** \u3002\n- \u5728 [Cloud Shell](https://cloud.google.com/shell/docs/starting-cloud-shell?hl=zh-cn) \u4e2d\u6216\u5b89\u88dd\u4e86 [Google Cloud CLI](https://cloud.google.com/sdk/docs?hl=zh-cn) \u7684\u4efb\u4f55\u74b0\u5883\u4e2d\uff0c\u8f38\u5165\u4ee5\u4e0b [Google Cloud CLI](https://cloud.google.com/sdk/gcloud?hl=zh-cn) \u547d\u4ee4\uff1a```\ngcloud notebooks instances create INSTANCE_NAME \\\u00a0 \u00a0 --vm-image-project=deeplearning-platform-release \\\u00a0 \u00a0 --vm-image-family=IMAGE_FAMILY \\\u00a0 \u00a0 --machine-type=MACHINE_TYPE \\\u00a0 \u00a0 --location=ZONE \\\u00a0 \u00a0 --metadata=install-monitoring-agent=TRUE\n```\u8acb\u66ff\u63db\u4ee5\u4e0b\u5167\u5bb9\uff1a- ``\uff1a\u65b0\u5be6\u4f8b\u7684\u540d\u7a31\n- ``\uff1a\u8981\u7528\u65bc\u5275\u5efa\u5be6\u4f8b\u7684 [\u6620\u50cf\u7cfb\u5217\u540d\u7a31](https://cloud.google.com/vertex-ai/docs/workbench/user-managed/images?hl=zh-cn#deciding) \n- ``\uff1a\u5be6\u4f8b\u865b\u64ec\u6a5f\u7684 [\u6a5f\u5668\u985e\u578b](https://cloud.google.com/compute/docs/machine-types?hl=zh-cn) \uff1b\u4f8b\u5982`n1-standard-4`\n- ``\uff1a\u60a8\u5e0c\u671b\u65b0\u5be6\u4f8b\u6240\u5728\u7684\u53ef\u7528\u5340\uff0c\u4f8b\u5982`us-west1-a`\n- \u901a\u904e [Google Cloud \u63a7\u5236\u6aaf](https://console.cloud.google.com/vertex-ai/workbench/user-managed?hl=zh-cn) \u8a2a\u554f\u5be6\u4f8b\u3002\n### \u901a\u904e Monitoring \u76e3\u63a7\u7cfb\u7d71\u548c\u61c9\u7528\u6307\u6a19\n\u5c0d\u65bc [\u5df2\u5b89\u88dd Monitoring](#install-monitoring) \u7684\u7528\u6236\u7ba1\u7406\u7b46\u8a18\u672c\u5be6\u4f8b\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528 Google Cloud Console \u76e3\u63a7\u7cfb\u7d71\u548c\u61c9\u7528\u6307\u6a19\uff1a\n- \u5728 Google Cloud \u63a7\u5236\u6aaf\u4e2d\uff0c\u6253\u958b **\u7528\u6236\u7ba1\u7406\u7684\u7b46\u8a18\u672c** \u9801\u9762\u3002 [\u8f49\u5230\u201c\u7528\u6236\u7ba1\u7406\u7684\u7b46\u8a18\u672c\u201d](https://console.cloud.google.com/vertex-ai/workbench/user-managed?hl=zh-cn) \n- \u9ede\u64ca\u8981\u67e5\u770b\u5176\u7cfb\u7d71\u548c\u61c9\u7528\u6307\u6a19\u7684\u5be6\u4f8b\u540d\u7a31\u3002\n- \u5728 **\u7b46\u8a18\u672c\u8a73\u60c5** \u9801\u9762\u4e0a\uff0c\u9ede\u64ca **Monitoring** \u6a19\u7c64\u9801\u3002\u67e5\u770b\u5be6\u4f8b\u7684\u7cfb\u7d71\u548c\u61c9\u7528\u6307\u6a19\u3002 \u5982\u9700\u77ad\u89e3\u5982\u4f55\u89e3\u8b80\u9019\u4e9b\u6307\u6a19\uff0c\u8acb\u53c3\u95b1 [\u67e5\u770b\u8cc7\u6e90\u6307\u6a19](https://cloud.google.com/compute/docs/instances/observe-monitor-vms?hl=zh-cn#review_resource_metrics) \u3002## \u4f7f\u7528\u8a3a\u65b7\u5de5\u5177\u76e3\u63a7\u7cfb\u7d71\u5065\u5eb7\u72c0\u6cc1\n\u7528\u6236\u7ba1\u7406\u7684\u7b46\u8a18\u672c\u5be6\u4f8b\u5305\u542b\u4e00\u500b\u5167\u7f6e\u7684\u8a3a\u65b7\u5de5\u5177\uff0c\u53ef\u5e6b\u52a9\u60a8\u76e3\u63a7\u5be6\u4f8b\u7684\u7cfb\u7d71\u5065\u5eb7\u72c0\u6cc1\u3002\n### \u8a3a\u65b7\u5de5\u5177\u57f7\u884c\u7684\u4efb\u52d9\n\u8a72\u8a3a\u65b7\u5de5\u5177\u6703\u57f7\u884c\u4ee5\u4e0b\u4efb\u52d9\uff1a\n- \u9a57\u8b49\u4ee5\u4e0b\u7528\u6236\u7ba1\u7406\u7684\u7b46\u8a18\u672c\u6838\u5fc3\u670d\u52d9\u7684\u72c0\u614b\uff1a- Docker \u670d\u52d9\n- Docker \u53cd\u5411\u4ee3\u7406\u4ee3\u7406\n- Jupyter \u670d\u52d9\n- Jupyter API\n- \u6aa2\u67e5\u5553\u52d5\u78c1\u76e4\u548c\u6578\u64da\u78c1\u76e4\u7684\u78c1\u76e4\u4f54\u7528\u7a7a\u9593\u662f\u5426\u8d85\u904e 85% \u7684\u95be\u503c\u3002\n- \u5b89\u88dd [lsof](https://github.com/lsof-org/lsof) \uff08\u9700\u8981\u4e92\u806f\u7db2\u9023\u63a5\uff09\u3002\n- \u6536\u96c6\u4ee5\u4e0b\u5be6\u4f8b\u65e5\u8a8c\uff1a- \u7db2\u7d61\u4fe1\u606f\uff08`ifconfig`\u3001`netstat`\uff09\n- `/var/log/`\u6587\u4ef6\u593e\u4e2d\u7684\u65e5\u8a8c\n- Docker \u72c0\u614b\u4fe1\u606f\n- `lsof`\uff08\u6253\u958b\u6587\u4ef6\uff09\u6578\u64da\n- Docker \u670d\u52d9\u72c0\u614b\n- \u201c\u53cd\u5411\u4ee3\u7406\u201d\u4ee3\u7406\u7684\u72c0\u614b\n- Jupyter \u670d\u52d9\u72c0\u614b\n- Jupyter API \u72c0\u614b\n- \u4ee3\u7406\u7684\u4ee3\u7406\u914d\u7f6e\u6587\u4ef6\n- Python \u9032\u7a0b\n- \u904b\u884c\u4ee5\u4e0b\u547d\u4ee4\u4e26\u6536\u96c6\u7d50\u679c\uff1a- pip freeze\n- conda list\n- gcloud compute instances describe``\n- gcloud config list\n### \u904b\u884c\u8a3a\u65b7\u5de5\u5177\n\u8981\u904b\u884c\u8a3a\u65b7\u5de5\u5177\uff0c\u8acb\u5b8c\u6210\u4ee5\u4e0b\u6b65\u9a5f\uff1a\n- [\u4f7f\u7528 ssh \u9023\u63a5\u5230\u7528\u6236\u7ba1\u7406\u7684\u7b46\u8a18\u672c\u5be6\u4f8b](https://cloud.google.com/vertex-ai/docs/workbench/user-managed/ssh-access?hl=zh-cn) \u3002\n- \u5728 SSH \u7d42\u7aef\u4e2d\uff0c\u904b\u884c\u4ee5\u4e0b\u547d\u4ee4\uff1a```\nsudo -i\ncd /opt/deeplearning/bin/\n./diagnostic_tool.sh\n```\u8a3a\u65b7\u5de5\u5177\u6703\u6536\u96c6\u65e5\u8a8c\uff0c\u5c07\u5b83\u5011\u58d3\u7e2e\u5230 `.tar.gz` \u6587\u4ef6\u4e2d\uff0c\u4e26\u5c07\u8a72\u6587\u4ef6\u653e\u5230 `/tmp/` \u6587\u4ef6\u593e\u4e2d\u3002\n- \u63d0\u53d6\u8a72\u6587\u4ef6\uff0c\u7136\u5f8c\u8a55\u4f30\u5167\u5bb9\u3002 \u5167\u5bb9\u5305\u62ec\uff1a- **log \u6587\u4ef6\u593e** \uff1a`var/log/`\u6587\u4ef6\u593e\u4e2d\u7684\u65e5\u8a8c\n- **report.log** \uff1a\u6536\u96c6\u7684\u6240\u6709\u547d\u4ee4\u7684\u8f38\u51fa\n- **proxy-agent-config.json** \uff1a\u4ee3\u7406\u914d\u7f6e\u4fe1\u606f\n- **Docker \u65e5\u8a8c** \uff1a\u5305\u542b Docker \u5bb9\u5668\u65e5\u8a8c\u7684`-json.log`\u6587\u4ef6\u60a8\u53ef\u4ee5\u5c07\u4ee5\u4e0b\u9078\u9805\u8207\u8a3a\u65b7\u5de5\u5177\u7d50\u5408\u4f7f\u7528\u3002\n| \u9078\u9805 | \u8aaa\u660e               |\n|:-------|:-------------------------------------------------------------|\n| -r  | \u5617\u8a66\u6062\u5fa9\u5931\u6557\u7684\u7528\u6236\u7ba1\u7406\u7684\u7b46\u8a18\u672c\u6838\u5fc3\u670d\u52d9\u72c0\u614b\u7684\u4fee\u5fa9\u9078\u9805   |\n| -s  | \u5728\u672a\u78ba\u8a8d\u7684\u60c5\u6cc1\u4e0b\u904b\u884c           |\n| -b  | \u5c07 .tar.gz \u6587\u4ef6\u4e0a\u50b3\u5230 Cloud Storage \u5b58\u5132\u6876\u3002     |\n| -v  | \u5728\u5931\u6557\u6642\u6392\u67e5\u76f8\u61c9\u5de5\u5177\u7684\u8abf\u8a66\u9078\u9805        |\n| -c  | \u5c07 30 \u79d2\u7684\u6578\u64da\u5305\u6d41\u91cf\u6355\u7372\u5230\u7528\u6236\u7ba1\u7406\u7684\u7b46\u8a18\u672c\u5be6\u4f8b\u4e2d\uff0c\u4e26\u904e\u6ffe SSH |\n| -d  | \u7528\u65bc\u4fdd\u5b58\u65e5\u8a8c\u7684\u76ee\u6a19\u6587\u4ef6\u593e          |\n| -h  | \u5e6b\u52a9               |\n## \u5f8c\u7e8c\u6b65\u9a5f\n- [\u8a73\u7d30\u77ad\u89e3\u865b\u64ec\u6a5f\u5143\u6578\u64da](https://cloud.google.com/compute/docs/metadata/overview?hl=zh-cn) \u3002\n- [\u8a73\u7d30\u77ad\u89e3 Monitoring](https://cloud.google.com/monitoring/docs/monitoring-overview?hl=zh-cn) \u3002", "guide": "Vertex AI"}