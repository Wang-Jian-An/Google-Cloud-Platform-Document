{"title": "Vertex AI - Query VPC index to get nearest neighbors", "url": "https://cloud.google.com/vertex-ai/docs/vector-search/query-index-vpc", "abstract": "# Vertex AI - Query VPC index to get nearest neighbors\nOnce you've created the index, you can run queries to get its nearest neighbors.\nEach `DeployedIndex` has a `DEPLOYED_INDEX_SERVER_IP` , which you can retrieve by listing `IndexEndpoints` . To query a `DeployedIndex` , connect to its `DEPLOYED_INDEX_SERVER_IP` at port `10000` and call the `Match` or `BatchMatch` method. Additionally, you can query using `DOC_ID` .\nThe following examples use the open source tool `grpc_cli` to send grpc requests to the deployed index server.\nIn the first example, you send a single query using the `Match` method.\n```\n./grpc_cli call ${DEPLOYED_INDEX_SERVER_IP}:10000 google.cloud.aiplatform.container.v1.MatchService.Match '{deployed_index_id: \"${DEPLOYED_INDEX_ID}\", float_val: [-0.1,..]}'\n```\nIn the second example, you combine two separate queries into the same `BatchMatch` request.\n```\n./grpc_cli call ${DEPLOYED_INDEX_SERVER_IP}:10000 google.cloud.aiplatform.container.v1.MatchService.BatchMatch 'requests: [{deployed_index_id: \"${DEPLOYED_INDEX_ID}\", requests: [{deployed_index_id: \"${DEPLOYED_INDEX_ID}\", float_val: [-0.1,..]}, {deployed_index_id: \"${DEPLOYED_INDEX_ID}\", float_val: [-0.2,..]}]}]'\n```\nYou must make calls to these APIs from a client running in the same [VPC that the service was peered with](#vpc-network-peering-setup).\nTo run a query using a `DOC_ID` , use the following example.\n```\n./grpc_cli call ${DEPLOYED_INDEX_SERVER_IP}:10000 google.cloud.aiplatform.container.v1.MatchService.Match \"deployed_index_id:'\"test_index1\"',embedding_id: '\"606431\"'\"\n```\nTo learn more, see [Client libraries explained](https://cloud.google.com/apis/docs/client-libraries-explained) .\nUse these instructions to query a VPC index from the console.- In the Vertex AI section of the Google Cloud console, go to the **Deploy and Use** section. Select **Vector Search** [Go to Vector Search](https://console.cloud.google.com/vertex-ai/matching-engine/indexes) \n- Select the VPC index you want to query. The **Index info** page opens.\n- Scroll down to the **Deployed indexes** section and select the deployed index you want to query. The **Deployed index info** page opens.\n- From the **Query index** section, select your query parameters. You can choose to query by a vector, or a specific data point.\n- Execute the query using the open source tool grpc_cli, or by using the Vertex AI SDK for Python.", "content": "## What's next\n- Learn how to [Update and rebuild your index](/vertex-ai/docs/vector-search/update-rebuild-index) \n- Learn how to [Filter vector matches](/vertex-ai/docs/vector-search/filtering) \n- Learn how to [Monitor an index](/vertex-ai/docs/vector-search/monitor)", "guide": "Vertex AI"}