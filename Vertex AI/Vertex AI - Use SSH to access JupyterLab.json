{"title": "Vertex AI - Use SSH to access JupyterLab", "url": "https://cloud.google.com/vertex-ai/docs/workbench/user-managed/ssh-access", "abstract": "# Vertex AI - Use SSH to access JupyterLab\n# Use SSH to access JupyterLab\nVertex AI Workbench user-managed notebooks is [deprecated](/vertex-ai/docs/deprecations) . On January 30, 2025, support for  user-managed notebooks will end and the ability to create user-managed notebooks instances  will be removed. Existing instances will continue to function  but patches, updates, and upgrades won't be available. To continue using  Vertex AI Workbench, we recommend that you [migrate your user-managed notebooks instances to Vertex AI Workbench instances](/vertex-ai/docs/workbench/user-managed/migrate-to-instances) .\nWhenever you don't have HTTPS access to your JupyterLab instance, you must use SSH to establish a connection.\nTo set up [SSH port forwarding](/solutions/connecting-securely#port-forwarding-over-ssh) , complete the following steps, and then access your JupyterLab session through a local browser:\n- Run the following command by using the [Google Cloud CLI](/sdk/gcloud) in your preferred terminal or in [Cloud Shell](https://console.cloud.google.com?cloudshell=true) :```\ngcloud compute ssh \\\n --project PROJECT_ID \\\n --zone ZONE \\\n INSTANCE_NAME \\\n -- -L 8080:localhost:8080\n```Replace the following:- ``: your [Google Cloud project ID](/resource-manager/docs/creating-managing-projects#identifying_projects) \n- ``: the [zone](/compute/docs/regions-zones) where your instance is located\n- ``: the name of your instance**Note:** If using Cloud Shell to run the command, add a `-4` to the  SSH flags to use IPv4 to connect. Example: `-- -4 -L` `` `:localhost:` ``\n- Access your JupyterLab session through a local browser:- If you ran the command on your local machine, visit `https://localhost:8080` to access JupyterLab.\n- If you ran the command using [Cloud Shell](https://console.cloud.google.com?cloudshell=true) , access JupyterLab through the Web Preview on port 8080.\n", "content": "## Reasons why you might not have HTTPS access\nTo get HTTPS access to JupyterLab, your user-managed notebooks instance must have access to a Google Cloud proxy service. When the instance starts, it attempts to register itself with the proxy service. If it fails to get proxy access, your user-managed notebooks instance prompts you to access JupyterLab through SSH.\nThe following are common reasons why you might not have HTTPS access to JupyterLab:\n- Your JupyterLab instance's proxy-mode metadata setting is incorrect.\n- Your network is configured to block internet access for the virtual machines (VMs) running JupyterLab notebooks.\n- Your user-managed notebooks instance doesn't have an external IP address.\n- Your [VPC Service Controls](/vpc-service-controls/docs/overview) settings block access to [Container Registry](/container-registry/docs) .\nThe following sections show how to resolve these issues.\nFor changes to take effect, you might need to restart the notebook's VM when attempting to resolve these issues.\n## Your JupyterLab instance's proxy-mode metadata setting is incorrect\nBy default, when you use user-managed notebooks to create a JupyterLab instance, Vertex AI Workbench adds the proxy-mode metadata setting. If you change or remove the proxy-mode metadata setting, then the user-managed notebooks instance can't connect to the proxy service.\nTo make sure your proxy-mode metadata setting is valid, complete the following steps:\n- In the Google Cloud console, go to the **User-managed notebooks** page. [Go to User-managed notebooks](https://console.cloud.google.com/vertex-ai/workbench/user-managed) \n- Select the instance that you need to modify.\n- Next to **View VM details** , click **View in Compute Engine** .\n- On the VM details page, click **Edit** .\n- In the **Metadata** section, add or modify the metadata to ensure there is a `proxy-mode entry` `set to the correct value, for example:` project_editors`. [Learn more about the possible values of the proxy-mode metadataentry](/vertex-ai/docs/general/troubleshooting-workbench#opening_a_notebook_results_in_a_403_forbidden_error) .\n- Click **Save** .## The network is blocking internet access\nYour JupyterLab instance accesses the proxy service through a public URL. If your Virtual Private Cloud network settings block access to the public internet or your firewall rules block egress traffic, you must use SSH to access your user-managed notebooks instance. If possible, you might want to work with your network and firewall administrators to allow access to your user-managed notebooks instance through the public internet.\n## Your user-managed notebooks instance doesn't have an external IP address\nYou might have created your user-managed notebooks instance without an external IP address. If you need to change this, complete the following steps.\n- In the Google Cloud console, go to the **User-managed notebooks** page. [Go to User-managed notebooks](https://console.cloud.google.com/vertex-ai/workbench/user-managed) \n- Click the name of the instance that you need to modify.\n- Click **View VM details** .\n- Click **Edit** .\n- In the **Network interfaces** section, expand the network that you want to have an external IP address.\n- Click the **External IP address** drop-down menu, and select the option that you want. To resolve this issue, you must not choose **None** .\n- In the **Network interfaces** section, click **Done** .\n- Click **Save** .## VPC Service Controls settings are blocking access to Container Registry\nTo connect to the proxy service, your user-managed notebooks instance runs an agent that it downloads from Container Registry. Without this agent your instance cannot connect to the proxy service.\nIf your VPC Service Controls settings are blocking access to Container Registry, you must add the Container Registry service to the service perimeter of your VPC Service Controls. [Learn more about how service perimeterswork and what services VPC Service Controls can be usedto secure](/vpc-service-controls/docs/overview#capabilities) .\n## Further troubleshooting\nIf you are still having trouble connecting, try reviewing the console logs for your virtual machine. These logs might help you discover why the user-managed notebooks instance is unable to register with the proxy service.\nTo access these logs, complete the following steps:\n- In the Google Cloud console, go to the **User-managed notebooks** page. [Go to User-managed notebooks](https://console.cloud.google.com/vertex-ai/workbench/user-managed) \n- Select the instance that you want to troubleshoot.\n- In **Logs** , click **Serial port 1 (console)** .## What's next\nFor tips on resolving other issues, see the [troubleshooting section on user-managednotebooks](/vertex-ai/docs/general/troubleshooting-workbench#user-managed-notebooks) .", "guide": "Vertex AI"}