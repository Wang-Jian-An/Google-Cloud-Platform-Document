{"title": "Vertex AI - \u5f9e\u81ea\u5b9a\u7fa9\u8a13\u7df4\u6a21\u578b\u7372\u53d6\u6279\u91cf\u9810\u6e2c\u7d50\u679c", "url": "https://cloud.google.com/vertex-ai/docs/predictions/get-batch-predictions?hl=zh-cn", "abstract": "# Vertex AI - \u5f9e\u81ea\u5b9a\u7fa9\u8a13\u7df4\u6a21\u578b\u7372\u53d6\u6279\u91cf\u9810\u6e2c\u7d50\u679c\n\u672c\u9801\u9762\u4ecb\u7d39\u5982\u4f55\u4f7f\u7528 Google Cloud \u63a7\u5236\u6aaf\u6216 Vertex AI API \u5f9e\u81ea\u5b9a\u7fa9\u8a13\u7df4\u7684\u6a21\u578b\u7372\u53d6 \u3002\n\u5982\u9700\u767c\u51fa\u6279\u91cf\u9810\u6e2c\u8acb\u6c42\uff0c\u8acb\u6307\u5b9a [\u8f38\u5165\u6e90](#input_data_requirements) \u548c Vertex AI \u5b58\u5132\u9810\u6e2c\u7d50\u679c\u7684\u8f38\u51fa\u4f4d\u7f6e\uff08Cloud Storage \u6216 BigQuery\uff09\u3002\n\u7232\u4e86\u5118\u91cf\u6e1b\u5c11\u8655\u7406\u6642\u9593\uff0c\u60a8\u7684\u8f38\u5165\u548c\u8f38\u51fa\u4f4d\u7f6e\u5fc5\u9808\u4f4d\u65bc\u76f8\u540c\u7684\u55ae\u5340\u57df\u6216\u591a\u5340\u57df\u3002\u4f8b\u5982\uff0c\u5982\u679c\u8f38\u5165\u4f4d\u65bc `us-central1` \uff0c\u5247\u8f38\u51fa\u53ef\u4ee5\u4f4d\u65bc `us-central1` \u6216 `US` \uff0c\u4f46\u4e0d\u80fd\u4f4d\u65bc `europe-west4` \u3002\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [Cloud Storage \u4f4d\u7f6e](https://cloud.google.com/storage/docs/locations?hl=zh-cn) \u548c [BigQuery \u4f4d\u7f6e](https://cloud.google.com/bigquery/docs/locations?hl=zh-cn) \u3002\n\u60a8\u7684\u8f38\u5165\u548c\u8f38\u51fa\u9084\u5fc5\u9808\u8207\u6a21\u578b\u4f4d\u65bc\u76f8\u540c\u7684\u55ae\u5340\u57df\u6216\u591a\u5340\u57df\u3002\n", "content": "## \u8f38\u5165\u6578\u64da\u8981\u6c42\n\u6279\u91cf\u8acb\u6c42\u7684\u8f38\u5165\u6307\u5b9a\u8981\u767c\u9001\u5230\u6a21\u578b\u9032\u884c\u9810\u6e2c\u7684\u5167\u5bb9\u3002\u6211\u5011\u652f\u6301\u4ee5\u4e0b\u8f38\u5165\u683c\u5f0f\uff1a\n**\u6ce8\u610f** \uff1aVertex AI \u6703\u5148\u5c07\u8f38\u5165\u8f49\u63db\u7232 JSON \u5be6\u4f8b\uff0c\u7136\u5f8c\u518d\u5c07\u5176\u767c\u9001\u5230\u9810\u6e2c\u5bb9\u5668\u3002\u8acb\u78ba\u4fdd\u60a8\u7684\u9810\u6e2c\u5bb9\u5668\u63a5\u53d7\u5be6\u4f8b\uff08\u5982 [\u81ea\u5b9a\u7fa9\u5bb9\u5668\u8981\u6c42](https://cloud.google.com/vertex-ai/docs/predictions/custom-container-requirements?hl=zh-cn#prediction) \u4e2d\u6240\u8ff0\uff09\u3002\n**\u6ce8\u610f** \uff1a\u5c0d\u65bc [PyTorch \u9810\u69cb\u5efa\u5bb9\u5668](https://cloud.google.com/vertex-ai/docs/predictions/pre-built-containers?hl=zh-cn#pytorch) \uff0cVertex AI \u6703\u5c07\u6bcf\u500b\u5be6\u4f8b\u5c01\u88dd\u5728 `data` \u5b57\u6bb5\u4e2d\uff0c\u7136\u5f8c\u518d\u5c07\u5176\u767c\u9001\u5230\u9810\u6e2c\u5bb9\u5668\u3002\u9019\u662f\u56e0\u7232 TorchServe \u7684\u9ed8\u8a8d\u8655\u7406\u7a0b\u5e8f\u9810\u671f\u6bcf\u500b\u5be6\u4f8b\u90fd\u5c01\u88dd\u5728 `data` \u5b57\u6bb5\u4e2d\u3002\n\u4f7f\u7528 JSON \u884c\u6587\u4ef6\u6307\u5b9a\u7528\u65bc\u9032\u884c\u9810\u6e2c\u7684\u8f38\u5165\u5be6\u4f8b\u5217\u8868\u3002\u5c07 JSON \u884c\u6587\u4ef6\u5b58\u5132\u5728 Cloud Storage \u5b58\u5132\u6876\u4e2d\u3002\n **\u793a\u4f8b 1** \n\u4ee5\u4e0b\u793a\u4f8b\u986f\u793a\u4e86\u4e00\u500b JSON \u884c\u6587\u4ef6\uff0c\u5176\u4e2d\u6bcf\u884c\u5305\u542b\u4e00\u500b\u6578\u7d44\uff1a\n```\n[1, 2, 3, 4]\n[5, 6, 7, 8]\n```\n\u4ee5\u4e0b\u662f HTTP \u8acb\u6c42\u6b63\u6587\u4e2d\u767c\u9001\u5230\u9810\u6e2c\u5bb9\u5668\u7684\u5167\u5bb9\uff1a```\n{\"instances\": [ [1, 2, 3, 4], [5, 6, 7, 8] ]}\n``````\n{\"instances\": [{ \"data\": [1, 2, 3, 4] },\n{ \"data\": [5, 6, 7, 8] } ]}\n```\n **\u793a\u4f8b 2** \n\u4ee5\u4e0b\u793a\u4f8b\u986f\u793a JSON \u884c\u6587\u4ef6\uff0c\u5176\u4e2d\u6bcf\u884c\u5305\u542b\u4e00\u500b\u5c0d\u8c61\u3002\n```\n{ \"values\": [1, 2, 3, 4], \"key\": 1 }\n{ \"values\": [5, 6, 7, 8], \"key\": 2 }\n```\n\u4ee5\u4e0b\u662f HTTP \u8acb\u6c42\u6b63\u6587\u4e2d\u767c\u9001\u5230\u9810\u6e2c\u5bb9\u5668\u7684\u5167\u5bb9\u3002\u8acb\u6ce8\u610f\uff0c\u7cfb\u7d71\u6703\u5c07\u540c\u4e00\u8acb\u6c42\u6b63\u6587\u767c\u9001\u5230\u6240\u6709\u5bb9\u5668\u3002\n```\n{\"instances\": [ { \"values\": [1, 2, 3, 4], \"key\": 1 },\n { \"values\": [5, 6, 7, 8], \"key\": 2 }\n]}\n```\n **\u793a\u4f8b 3** \n\u5c0d\u65bc PyTorch \u9810\u69cb\u5efa\u5bb9\u5668\uff0c\u8acb\u78ba\u4fdd\u6309\u7167 TorchServe \u9ed8\u8a8d\u8655\u7406\u7a0b\u5e8f\u7684\u8981\u6c42\u5c07\u6bcf\u500b\u5be6\u4f8b\u5c01\u88dd\u5728 `data` \u5b57\u6bb5\u4e2d\uff1aVertex AI \u4e0d\u6703\u7232\u60a8\u5c01\u88dd\u5be6\u4f8b\u3002\u4f8b\u5982\uff1a\n```\n{ \"data\": { \"values\": [1, 2, 3, 4], \"key\": 1 } }\n{ \"data\": { \"values\": [5, 6, 7, 8], \"key\": 2 } }\n```\n\u4ee5\u4e0b\u662f HTTP \u8acb\u6c42\u6b63\u6587\u4e2d\u767c\u9001\u5230\u9810\u6e2c\u5bb9\u5668\u7684\u5167\u5bb9\uff1a\n```\n{\"instances\": [ { \"data\": { \"values\": [1, 2, 3, 4], \"key\": 1 } },\n { \"data\": { \"values\": [5, 6, 7, 8], \"key\": 2 } }\n]}\n```\n\u4ee5 [TFRecord \u683c\u5f0f](https://www.tensorflow.org/guide/data?hl=zh-cn#consuming_tfrecord_data) \u4fdd\u5b58\u8f38\u5165\u5be6\u4f8b\u3002\u60a8\u53ef\u4ee5\u9078\u64c7\u4f7f\u7528 Gzip \u58d3\u7e2e TFRecord \u6587\u4ef6\u3002\u5c07 TFRecord \u6587\u4ef6\u5b58\u5132\u5728 Cloud Storage \u5b58\u5132\u6876\u4e2d\u3002\nVertex AI \u5c07 TFRecord \u6587\u4ef6\u4e2d\u7684\u6bcf\u500b\u5be6\u4f8b\u8b80\u53d6\u7232\u4e8c\u9032\u5236\u6587\u4ef6\uff0c\u7136\u5f8c\u4f7f\u7528\u540d\u7232 `b64` \u7684\u55ae\u500b\u9375\u5c0d\u5be6\u4f8b\u9032\u884c base64 \u7de8\u78bc\uff0c\u4f7f\u5176\u6210\u7232 JSON \u5c0d\u8c61\u3002\n\u4ee5\u4e0b\u662f HTTP \u8acb\u6c42\u6b63\u6587\u4e2d\u767c\u9001\u5230\u9810\u6e2c\u5bb9\u5668\u7684\u5167\u5bb9\uff1a```\n{\"instances\": [{ \"b64\": \"b64EncodedASCIIString\" },\n{ \"b64\": \"b64EncodedASCIIString\" } ]}\n``````\n{\"instances\": [ { \"data\": {\"b64\": \"b64EncodedASCIIString\" } }, { \"data\": {\"b64\": \"b64EncodedASCIIString\" } }\n]}\n```\n\u78ba\u4fdd\u60a8\u7684\u9810\u6e2c\u5bb9\u5668\u77e5\u9053\u5982\u4f55\u89e3\u78bc\u5be6\u4f8b\u3002\n\u5728 CSV \u6587\u4ef6\u4e2d\u6bcf\u884c\u6307\u5b9a\u4e00\u500b\u8f38\u5165\u5be6\u4f8b\u3002\u7b2c\u4e00\u884c\u5fc5\u9808\u662f\u6a19\u984c\u884c\u3002\u60a8\u5fc5\u9808\u5c07\u6240\u6709\u5b57\u7b26\u4e32\u7528\u82f1\u6587\u96d9\u5f15\u865f (\") \u62ec\u8d77\u4f86\u3002\u6211\u5011\u4e0d\u63a5\u53d7\u5305\u542b\u63db\u884c\u7b26\u7684\u55ae\u5143\u503c\u3002\u4e0d\u5e36\u82f1\u6587\u5f15\u865f\u7684\u503c\u6703\u88ab\u8b80\u53d6\u7232\u6d6e\u9ede\u6578\u3002\n\u4ee5\u4e0b\u793a\u4f8b\u5c55\u793a\u4e86\u5305\u542b\u5169\u500b\u8f38\u5165\u5be6\u4f8b\u7684 CSV \u6587\u4ef6\uff1a\n```\n\"input1\",\"input2\",\"input3\"\n0.1,1.2,\"cat1\"\n4.0,5.0,\"cat2\"\n```\n\u4ee5\u4e0b\u662f HTTP \u8acb\u6c42\u6b63\u6587\u4e2d\u767c\u9001\u5230\u9810\u6e2c\u5bb9\u5668\u7684\u5167\u5bb9\uff1a```\n{\"instances\": [ [0.1,1.2,\"cat1\"], [4.0,5.0,\"cat2\"] ]}\n``````\n{\"instances\": [{ \"data\": [0.1,1.2,\"cat1\"] },\n{ \"data\": [4.0,5.0,\"cat2\"] } ]}\n```\n\u5275\u5efa\u4e00\u500b\u6587\u672c\u6587\u4ef6\uff0c\u5176\u4e2d\u6bcf\u4e00\u884c\u662f\u4e00\u500b\u6587\u4ef6\u7684 Cloud Storage URI\u3002Vertex AI \u5c07\u6bcf\u500b\u6587\u4ef6\u7684\u5167\u5bb9\u8b80\u53d6\u7232\u4e8c\u9032\u5236\u6587\u4ef6\uff0c\u7136\u5f8c\u4f7f\u7528\u540d\u7232 `b64` \u7684\u55ae\u500b\u9375\u5c0d\u5be6\u4f8b\u9032\u884c base64 \u7de8\u78bc\uff0c\u4f7f\u5176\u6210\u7232 JSON \u5c0d\u8c61\u3002\n\u5982\u679c\u60a8\u8a08\u5283\u4f7f\u7528 Google Cloud \u63a7\u5236\u6aaf\u7372\u53d6\u6279\u91cf\u9810\u6e2c\u7d50\u679c\uff0c\u8acb\u5c07\u6587\u4ef6\u5217\u8868\u76f4\u63a5\u7c98\u8cbc\u5230 Google Cloud \u63a7\u5236\u6aaf\u4e2d\u3002\u5426\u5247\uff0c\u8acb\u5c07\u6587\u4ef6\u5217\u8868\u4fdd\u5b58\u5728 Cloud Storage \u5b58\u5132\u6876\u4e2d\u3002\n\u4ee5\u4e0b\u793a\u4f8b\u5c55\u793a\u4e86\u5305\u542b\u5169\u500b\u8f38\u5165\u5be6\u4f8b\u7684\u6587\u4ef6\u5217\u8868\uff1a\n```\ngs://path/to/image/image1.jpg\ngs://path/to/image/image2.jpg\n```\n\u4ee5\u4e0b\u662f HTTP \u8acb\u6c42\u6b63\u6587\u4e2d\u767c\u9001\u5230\u9810\u6e2c\u5bb9\u5668\u7684\u5167\u5bb9\uff1a```\n{ \"instances\": [{ \"b64\": \"b64EncodedASCIIString\" },\n{ \"b64\": \"b64EncodedASCIIString\" } ]}\n``````\n{ \"instances\": [ { \"data\": { \"b64\": \"b64EncodedASCIIString\" } }, { \"data\": { \"b64\": \"b64EncodedASCIIString\" } }\n]}\n```\n\u78ba\u4fdd\u60a8\u7684\u9810\u6e2c\u5bb9\u5668\u77e5\u9053\u5982\u4f55\u89e3\u78bc\u5be6\u4f8b\u3002\n\u5c07 BigQuery \u8868\u6307\u5b9a\u7232 `projectId.datasetId.tableId` \u3002 Vertex AI \u5c07\u8868\u4e2d\u7684\u6bcf\u4e00\u884c\u8f49\u63db\u7232 JSON \u5be6\u4f8b\u3002\n\u4f8b\u5982\uff0c\u5982\u679c\u60a8\u7684\u8868\u5305\u542b\u4ee5\u4e0b\u5167\u5bb9\uff1a\n| \u7b2c 1 \u5217 | \u7b2c 2 \u5217 | \u7b2c 3 \u5217 |\n|----------:|----------:|:----------|\n|   1 |   3 | \"Cat1\" |\n|   2 |   4 | \"Cat2\" |\n\u4ee5\u4e0b\u662f HTTP \u8acb\u6c42\u6b63\u6587\u4e2d\u767c\u9001\u5230\u9810\u6e2c\u5bb9\u5668\u7684\u5167\u5bb9\uff1a```\n{\"instances\": [ [1.0,3.0,\"cat1\"], [2.0,4.0,\"cat2\"] ]}\n``````\n{\"instances\": [{ \"data\": [1.0,3.0,\"cat1\"] },\n{ \"data\": [2.0,4.0,\"cat2\"] } ]}\n```\n\u4ee5\u4e0b\u662f\u5c07 BigQuery \u6578\u64da\u985e\u578b\u8f49\u63db\u7232 JSON \u7684\u65b9\u5f0f\uff1a\n| BigQuery \u985e\u578b | JSON \u985e\u578b | \u793a\u4f8b\u503c        |\n|:----------------|:------------|:-----------------------------------|\n| \u5b57\u7b26\u4e32   | \u5b57\u7b26\u4e32  | \"abc\"        |\n| \u6574\u6578   | \u6574\u6578  | 1         |\n| \u6d6e\u9ede\u6578   | \u6d6e\u9ede\u6578  | 1.2        |\n| \u6578\u5b57   | \u6d6e\u9ede\u6578  | 4925.000000000      |\n| \u5e03\u723e\u503c   | \u5e03\u723e\u503c  | \u662f         |\n| TimeStamp  | \u5b57\u7b26\u4e32  | \"2019-01-01 23:59:59.999999+00:00\" |\n| \u65e5\u671f   | \u5b57\u7b26\u4e32  | \"2018-12-31\"      |\n| \u6642\u9593   | \u5b57\u7b26\u4e32  | \"23:59:59.999999\"     |\n| DateTime  | \u5b57\u7b26\u4e32  | \"2019-01-01T00:00:00\"    |\n| Record   | \u5c0d\u8c61  | { \"A\": 1,\"B\": 2}     |\n| \u91cd\u8907\u985e\u578b  | \u6578\u7d44\u985e\u578b | [1, 2]        |\n| \u5d4c\u5957\u8a18\u9304  | \u5c0d\u8c61  | {\"A\": {\"a\": 0}, \"B\": 1}   |\n## \u5206\u5340\u6578\u64da\n\u6279\u91cf\u9810\u6e2c\u4f7f\u7528 MapReduce \u5c07\u8f38\u5165\u5206\u7247\u5230\u6bcf\u500b\u526f\u672c\u3002\u7232\u4e86\u4f7f\u7528 MapReduce \u529f\u80fd\uff0c\u8f38\u5165\u61c9\u8a72\u662f\u53ef\u5206\u5340\u7684\u3002\nVertex AI \u6703\u81ea\u52d5\u5c0d **BigQuery** \u3001 **\u6587\u4ef6\u5217\u8868** \u548c **JSON \u884c** \u8f38\u5165\u9032\u884c\u5206\u5340\u3002\nVertex AI \u4e0d\u6703\u81ea\u52d5\u5c0d **CSV** \u6587\u4ef6\u9032\u884c\u5206\u5340\uff0c\u56e0\u7232\u5b83\u5011\u672c\u8eab\u4e0d\u9069\u5408\u5206\u5340\u3002CSV \u6587\u4ef6\u4e2d\u7684\u884c\u4e0d\u662f\u81ea\u63cf\u8ff0\u7684\uff0c\u4e0d\u662f\u985e\u578b\u5316\u7684\uff0c\u800c\u4e14\u53ef\u80fd\u5305\u542b\u65b0\u884c\u3002\u6211\u5011\u5efa\u8b70\u4e0d\u8981\u5c07 CSV \u8f38\u5165\u7528\u65bc\u5c0d\u541e\u5410\u91cf\u654f\u611f\u7684\u61c9\u7528\u3002\n\u5c0d\u65bc **TFRecord** \u8f38\u5165\uff0c\u8acb\u52d9\u5fc5\u5c07\u5be6\u4f8b\u62c6\u5206\u7232\u8f03\u5c0f\u7684\u6587\u4ef6\uff0c\u4e26\u4f7f\u7528\u901a\u914d\u7b26\uff08\u4f8b\u5982 `gs://my-bucket/*.tfrecord` \uff09\u5c07\u6587\u4ef6\u50b3\u905e\u7d66\u4f5c\u696d\uff0c\u5f9e\u800c\u624b\u52d5\u5c0d\u6578\u64da\u9032\u884c\u5206\u5340\u3002\u6587\u4ef6\u6578\u91cf\u61c9\u81f3\u5c11\u7232\u6307\u5b9a\u7684\u526f\u672c\u6578\u91cf\u3002\n## \u904e\u6ffe\u548c\u8f49\u63db\u8f38\u5165\u6578\u64da\n\u60a8\u53ef\u4ee5\u901a\u904e\u5728 [BatchPredictionJob](https://cloud.google.com/vertex-ai/docs/reference/rest/v1/projects.locations.batchPredictionJobs?hl=zh-cn) \u8acb\u6c42\u4e2d\u6307\u5b9a [instanceConfig](https://cloud.google.com/vertex-ai/docs/reference/rest/v1/projects.locations.batchPredictionJobs?hl=zh-cn#instanceconfig) \u4f86\u904e\u6ffe\u548c/\u6216\u8f49\u63db\u6279\u91cf\u8f38\u5165\u3002\n\u85c9\u52a9 **\u904e\u6ffe** \u529f\u80fd\uff0c\u60a8\u53ef\u4ee5\u5f9e\u9810\u6e2c\u8acb\u6c42\u4e2d\u6392\u9664\u8f38\u5165\u6578\u64da\u4e2d\u7684\u67d0\u4e9b\u5b57\u6bb5\uff0c\u4e5f\u53ef\u4ee5\u50c5\u5c07\u8f38\u5165\u6578\u64da\u4e2d\u7684\u90e8\u5206\u5b57\u6bb5\u6dfb\u52a0\u5230\u9810\u6e2c\u8acb\u6c42\u4e2d\uff0c\u800c\u7121\u9700\u5728\u9810\u6e2c\u5bb9\u5668\u4e2d\u57f7\u884c\u4efb\u4f55\u81ea\u5b9a\u7fa9\u9810\u8655\u7406/\u5f8c\u8655\u7406\u3002\u5982\u679c\u8f38\u5165\u6578\u64da\u6587\u4ef6\u5177\u6709\u6a21\u578b\u4e0d\u9700\u8981\u7684\u984d\u5916\u5217\uff08\u4f8b\u5982\u9375\u6216\u5176\u4ed6\u6578\u64da\uff09\uff0c\u5247\u6b64\u529f\u80fd\u975e\u5e38\u6709\u7528\u3002\n\u85c9\u52a9 **\u8f49\u63db** \u529f\u80fd\uff0c\u60a8\u53ef\u4ee5\u4ee5 JSON `array` \u6216 `object` \u683c\u5f0f\u5c07\u5be6\u4f8b\u767c\u9001\u5230\u9810\u6e2c\u5bb9\u5668\u3002\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [instanceType](https://cloud.google.com/vertex-ai/docs/reference/rest/v1/projects.locations.batchPredictionJobs?hl=zh-cn#instanceconfig) \u3002\n\u4f8b\u5982\uff0c\u5982\u679c\u60a8\u7684\u8f38\u5165\u8868\u5305\u542b\u4ee5\u4e0b\u5167\u5bb9\uff1a\n| customerId | col1 | col2 |\n|-------------:|-------:|-------:|\n|   1001 |  1 |  2 |\n|   1002 |  5 |  6 |\n\u4e26\u4e14\u60a8\u6307\u5b9a\u4e86\u4ee5\u4e0b `instanceConfig` \uff1a\n```\n{\u00a0 \"name\": \"batchJob1\",\u00a0 ...\u00a0 \"instanceConfig\": {\u00a0 \u00a0 \"excludedFields\":\"customerId\"\u00a0 \u00a0 \"instanceType\":\"object\"\u00a0 }}\n```\n\u7136\u5f8c\uff0c\u9810\u6e2c\u8acb\u6c42\u4e2d\u7684\u5be6\u4f8b\u5c07\u4f5c\u7232 JSON \u5c0d\u8c61\u767c\u9001\uff0c\u4e26\u4e14\u4e0d\u5305\u542b `customerId` \u5217\uff1a\n```\n{\"col1\":1,\"col2\":2}{\"col1\":5,\"col2\":6}\n```\n\u8acb\u6ce8\u610f\uff0c\u6307\u5b9a\u4ee5\u4e0b `instanceConfig` \u6703\u7522\u751f\u76f8\u540c\u7684\u7d50\u679c\uff1a\n```\n{\u00a0 \"name\": \"batchJob1\",\u00a0 ...\u00a0 \"instanceConfig\": {\u00a0 \u00a0 \"includedFields\": [\"col1\",\"col2\"]\u00a0 \u00a0 \"instanceType\":\"object\"\u00a0 }}\n```\n\u6709\u95dc\u5982\u4f55\u4f7f\u7528\u7279\u5fb5\u904e\u6ffe\u689d\u4ef6\u7684\u6f14\u793a\uff0c\u8acb\u53c3\u95b1 [\u4f7f\u7528\u7279\u5fb5\u904e\u6ffe\u7684\u81ea\u5b9a\u7fa9\u6a21\u578b\u6279\u91cf\u9810\u6e2c](https://github.com/GoogleCloudPlatform/vertex-ai-samples/blob/main/notebooks/official/prediction/custom_batch_prediction_feature_filter.ipynb) \u7b46\u8a18\u672c\u3002\n## \u8acb\u6c42\u6279\u91cf\u9810\u6e2c\n\u5c0d\u65bc\u6279\u91cf\u9810\u6e2c\u8acb\u6c42\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528 Google Cloud \u63a7\u5236\u6aaf\u6216 Vertex AI API\u3002\u6279\u91cf\u9810\u6e2c\u4efb\u52d9\u53ef\u80fd\u9700\u8981\u4e00\u4e9b\u6642\u9593\u624d\u80fd\u5b8c\u6210\uff0c\u5177\u9ad4\u53d6\u6c7a\u65bc\u63d0\u4ea4\u7684\u8f38\u5165\u6578\u64da\u9805\u6578\u91cf\u3002\n\u7576\u60a8\u8acb\u6c42\u6279\u91cf\u9810\u6e2c\u6642\uff0c\u9810\u6e2c\u5bb9\u5668\u5c07\u4ee5\u7528\u6236\u63d0\u4f9b\u7684 [\u81ea\u5b9a\u7fa9\u670d\u52d9\u8cec\u865f](https://cloud.google.com/vertex-ai/docs/general/custom-service-account?hl=zh-cn) \u8eab\u4efd\u904b\u884c\u3002\u8b80\u53d6/\u5beb\u5165\u64cd\u4f5c\uff08\u4f8b\u5982\u5f9e\u6578\u64da\u6e90\u8b80\u53d6\u9810\u6e2c\u5be6\u4f8b\u6216\u5beb\u5165\u9810\u6e2c\u7d50\u679c\uff09\u5747\u4f7f\u7528 [Vertex AI \u670d\u52d9\u4ee3\u7406](https://cloud.google.com/vertex-ai/docs/general/access-control?hl=zh-cn#service-agents) \u5b8c\u6210\uff0c\u9ed8\u8a8d\u60c5\u6cc1\u4e0b\u6709\u6b0a\u8a2a\u554f BigQuery \u548c Cloud Storage\u3002\n\u4f7f\u7528 Google Cloud \u63a7\u5236\u6aaf\u8acb\u6c42\u6279\u91cf\u9810\u6e2c\u3002- \u5728 Google Cloud \u63a7\u5236\u6aaf\u7684 Vertex AI \u90e8\u5206\u4e2d\uff0c\u524d\u5f80 **\u6279\u91cf\u9810\u6e2c** \u9801\u9762\u3002\n [\u524d\u5f80\u201c\u6279\u91cf\u9810\u6e2c\u201d\u9801\u9762](https://console.cloud.google.com/vertex-ai/batch-predictions?hl=zh-cn) - \u9ede\u64ca **\u5275\u5efa** \u4ee5\u6253\u958b **\u65b0\u5efa\u6279\u91cf\u9810\u6e2c** \u7a97\u53e3\u3002\n- \u5728 **\u5b9a\u7fa9\u6279\u91cf\u9810\u6e2c** \u90e8\u5206\uff0c\u5b8c\u6210\u4ee5\u4e0b\u6b65\u9a5f\uff1a- \u8f38\u5165\u6279\u91cf\u9810\u6e2c\u7684\u540d\u7a31\u3002\n- \u5c0d\u65bc **\u6a21\u578b\u540d\u7a31** \uff0c\u9078\u64c7\u8981\u7528\u65bc\u6b64\u6279\u91cf\u9810\u6e2c\u7684\u6a21\u578b\u7684\u540d\u7a31\u3002\n- \u5728 **\u9078\u64c7\u4f86\u6e90** \u90e8\u5206\uff0c\u9078\u64c7\u9069\u7528\u65bc\u60a8\u7684 [\u8f38\u5165\u6578\u64da](#input_data_requirements) \u7684\u4f86\u6e90\uff1a- \u5982\u679c\u60a8\u5df2\u5c07\u8f38\u5165\u8a2d\u7f6e\u7232 JSON \u884c\u3001CSV \u6216 TFRecord \u683c\u5f0f\uff0c\u8acb\u9078\u64c7 **Cloud Storage \u4e0a\u7684\u6587\u4ef6\uff08JSON \u884c\u3001CSV\u3001TFRecord\u3001TFRecord\u3001Gzip\uff09** \u3002\u7136\u5f8c\u5728 **\u6e90\u8def\u5f91** \u5b57\u6bb5\u4e2d\u6307\u5b9a\u8f38\u5165\u6587\u4ef6\u3002\n- \u5982\u679c\u60a8\u4f7f\u7528\u6587\u4ef6\u5217\u8868\u4f5c\u7232\u8f38\u5165\uff0c\u8acb\u9078\u64c7 **Cloud Storage \u4e0a\u7684\u6587\u4ef6\uff08\u5176\u4ed6\uff09** \uff0c\u7136\u5f8c\u5c07\u6587\u4ef6\u5217\u8868\u7c98\u8cbc\u5230\u4e0b\u9762\u7684\u6587\u672c\u6846\u4e2d\u3002\n- \u5c0d\u65bc BigQuery \u8f38\u5165\uff0c\u9078\u64c7 **BigQuery \u8def\u5f91** \u3002\u5982\u679c\u60a8\u9078\u64c7 BigQuery \u4f5c\u7232\u8f38\u5165\uff0c\u5247\u9084\u5fc5\u9808\u9078\u64c7 BigQuery \u4f5c\u7232\u8f38\u51fa\u4ee5\u53ca\u9078\u64c7 Google \u7ba1\u7406\u7684\u52a0\u5bc6\u5bc6\u9470\u3002BigQuery \u4e0d\u652f\u6301\u5c07\u5ba2\u6236\u7ba1\u7406\u7684\u52a0\u5bc6\u5bc6\u9470 (CMEK) \u7528\u4f5c\u8f38\u5165/\u8f38\u51fa\u3002\n- \u5728 **\u76ee\u6a19\u8def\u5f91** \u5b57\u6bb5\u4e2d\uff0c\u6307\u5b9a\u60a8\u5e0c\u671b Vertex AI \u5b58\u5132\u6279\u91cf\u9810\u6e2c\u8f38\u51fa\u7684 Cloud Storage \u76ee\u9304\u3002\n- \uff08\u53ef\u9078\uff09\u60a8\u53ef\u4ee5\u9078\u4e2d **\u7232\u6b64\u6a21\u578b\u5553\u7528\u7279\u5fb5\u6b78\u56e0** \uff0c\u4ee5\u4fbf\u5728\u6279\u91cf\u9810\u6e2c\u97ff\u61c9\u4e2d\u7372\u53d6 [\u7279\u5fb5\u6b78\u56e0](https://cloud.google.com/vertex-ai/docs/explainable-ai/overview?hl=zh-cn) \u3002\u7136\u5f8c\u9ede\u64ca **\u4fee\u6539** \u4ee5 [\u914d\u7f6e\u8aaa\u660e\u8a2d\u7f6e](https://cloud.google.com/vertex-ai/docs/explainable-ai/configuring-explanations?hl=zh-cn) \u3002\uff08\u5982\u679c\u60a8\u4e4b\u524d\u7232\u6a21\u578b\u914d\u7f6e\u4e86\u8aaa\u660e\u8a2d\u7f6e\uff0c\u5247\u4fee\u6539\u8aaa\u660e\u8a2d\u7f6e\u662f\u53ef\u9078\u7684\uff0c\u5426\u5247\u9700\u8981\u9019\u6a23\u505a\u3002\uff09\n- \u7232\u6279\u91cf\u9810\u6e2c\u4f5c\u696d\u6307\u5b9a\u8a08\u7b97\u9078\u9805\uff1a **\u8a08\u7b97\u7bc0\u9ede\u6578\u91cf** \u3001 [\u6a5f\u5668\u985e\u578b](https://cloud.google.com/vertex-ai/docs/predictions/configure-compute?hl=zh-cn) \uff0c\u4ee5\u53ca\uff08\u53ef\u9078\uff09 [\u52a0\u901f\u5668\u985e\u578b](https://cloud.google.com/vertex-ai/docs/predictions/configure-compute?hl=zh-cn#gpus) \u548c **\u52a0\u901f\u5668\u6578\u91cf** \n- \u53ef\u9078\uff1a\u9069\u7528\u65bc\u6279\u91cf\u9810\u6e2c\u7684 [\u6a21\u578b\u76e3\u63a7](https://cloud.google.com/vertex-ai/docs/model-monitoring/overview?hl=zh-cn) \u5206\u6790\u529f\u80fd\u5df2\u63a8\u51fa [\u9810\u89bd\u7248](https://cloud.google.com/products?hl=zh-cn#product-launch-stages) \u3002\u8acb\u53c3\u95b1\u5c07\u504f\u5dee\u6aa2\u6e2c\u914d\u7f6e\u6dfb\u52a0\u5230\u6279\u91cf\u9810\u6e2c\u4f5c\u696d\u7684 [\u524d\u63d0\u689d\u4ef6](https://cloud.google.com/vertex-ai/docs/model-monitoring/model-monitoring-batch-predictions?hl=zh-cn#prerequisites) \u3002- \u9ede\u64ca\u4ee5 **\u7232\u6b64\u6279\u91cf\u9810\u6e2c\u5553\u7528\u6a21\u578b\u76e3\u63a7** \u3002\n- \u9078\u64c7 **\u8a13\u7df4\u6578\u64da\u6e90** \u3002\u8f38\u5165\u60a8\u9078\u64c7\u7684\u8a13\u7df4\u6578\u64da\u6e90\u7684\u6578\u64da\u8def\u5f91\u6216\u4f4d\u7f6e\u3002\n- \u53ef\u9078\uff1a\u5728 **\u63d0\u9192\u95be\u503c** \u4e0b\uff0c\u6307\u5b9a\u89f8\u767c\u63d0\u9192\u7684\u95be\u503c\u3002\n- \u5728 **\u901a\u77e5\u96fb\u5b50\u90f5\u4ef6\u5730\u5740** \u90e8\u5206\uff0c\u8f38\u5165\u4e00\u500b\u6216\u591a\u500b\u4ee5\u9017\u865f\u5206\u9694\u7684\u96fb\u5b50\u90f5\u4ef6\u5730\u5740\uff0c\u4ee5\u4fbf\u5728\u6a21\u578b\u8d85\u51fa\u63d0\u9192\u95be\u503c\u6642\u63a5\u6536\u63d0\u9192\u3002\n- \u53ef\u9078\uff1a\u5728 **\u901a\u77e5\u6e20\u9053** \u90e8\u5206\uff0c\u6dfb\u52a0 [Cloud Monitoring](https://cloud.google.com/monitoring/support/notification-options?hl=zh-cn) \u6e20\u9053\uff0c\u4ee5\u4fbf\u5728\u6a21\u578b\u8d85\u51fa\u63d0\u9192\u95be\u503c\u6642\u63a5\u6536\u63d0\u9192\u3002\u60a8\u53ef\u4ee5\u9078\u64c7\u73fe\u6709\u7684 Cloud Monitoring \u6e20\u9053\uff0c\u4e5f\u53ef\u4ee5\u901a\u904e\u9ede\u64ca **\u7ba1\u7406\u901a\u77e5\u6e20\u9053** \u4f86\u5275\u5efa\u4e00\u500b\u65b0\u7684 Cloud Monitoring \u6e20\u9053\u3002\u63a7\u5236\u6aaf\u652f\u6301 PagerDuty\u3001Slack \u548c Pub/Sub \u901a\u77e5\u6e20\u9053\u3002\n- \u9ede\u64ca **\u5275\u5efa** \u3002\u4f7f\u7528 Vertex AI API \u767c\u9001\u6279\u91cf\u9810\u6e2c\u8acb\u6c42\u3002\u6839\u64da\u60a8\u7528\u65bc\u7372\u53d6\u6279\u91cf\u9810\u6e2c\u7d50\u679c\u7684\u5de5\u5177\u9078\u64c7\u76f8\u61c9\u7684\u6a19\u7c64\u9801\uff1a\n\u5728\u4f7f\u7528\u4efb\u4f55\u8acb\u6c42\u6578\u64da\u4e4b\u524d\uff0c\u8acb\u5148\u9032\u884c\u4ee5\u4e0b\u66ff\u63db\uff1a- \uff1a\u5b58\u5132\u6a21\u578b\u548c\u57f7\u884c\u6279\u91cf\u9810\u6e2c\u4f5c\u696d\u7684\u5340\u57df\u3002\u4f8b\u5982 `us-central1` \u3002\n- \uff1a\u60a8\u7684 [\u9805\u76ee ID](https://cloud.google.com/resource-manager/docs/creating-managing-projects?hl=zh-cn#identifiers) \u3002\n- \uff1a\u6279\u91cf\u9810\u6e2c\u4f5c\u696d\u7684\u986f\u793a\u540d\u3002\n- \uff1a\u7528\u65bc\u57f7\u884c\u9810\u6e2c\u7684\u6a21\u578b\u7684 ID\u3002\n- \uff1a [\u8f38\u5165\u6578\u64da\u683c\u5f0f](#input_data_requirements) \uff1a `jsonl` \u3001 `csv` \u3001 `tf-record` \u3001 `tf-record-gzip` \u6216 `file-list` \u3002\n- \uff1a\u8f38\u5165\u6578\u64da\u7684 Cloud Storage URI\u3002\u53ef\u80fd\u5305\u542b\u901a\u914d\u7b26\u3002\n- \uff1a\u60a8\u5e0c\u671b Vertex AI \u7528\u65bc\u4fdd\u5b58\u8f38\u51fa\u7684\u76ee\u9304\u7684 Cloud Storage URI\u3002\n- \uff1a\u8981\u7528\u65bc\u6b64\u6279\u91cf\u9810\u6e2c\u4f5c\u696d\u7684 [\u6a5f\u5668\u8cc7\u6e90](https://cloud.google.com/vertex-ai/docs/predictions/configure-compute?hl=zh-cn) \u3002\u60a8\u53ef\u4ee5\u9078\u64c7 [\u914d\u7f6e machineSpec \u5b57\u6bb5](https://cloud.google.com/vertex-ai/docs/reference/rest/v1/MachineSpec?hl=zh-cn) \u4ee5 [\u4f7f\u7528\u52a0\u901f\u5668](https://cloud.google.com/vertex-ai/docs/predictions/configure-compute?hl=zh-cn#gpus) \uff0c\u4f46\u4ee5\u4e0b\u793a\u4f8b\u672a\u5c55\u793a\u9019\u4e00\u8a2d\u7f6e\u3002\n- \uff1a\u6bcf\u500b\u9810\u6e2c\u8acb\u6c42\u4e2d\u767c\u9001\u7684\u5be6\u4f8b\u6578\uff1b\u9ed8\u8a8d\u503c\u7232 64\u3002\u589e\u52a0\u6279\u6b21\u5927\u5c0f\u53ef\u4ee5\u7522\u751f\u66f4\u9ad8\u7684\u541e\u5410\u91cf\uff0c\u4f46\u4e5f\u53ef\u80fd\u6703\u5c0e\u81f4\u8acb\u6c42\u8d85\u6642\u3002\n- \uff1a\u6b64\u6279\u91cf\u9810\u6e2c\u4f5c\u696d\u7684\u7bc0\u9ede\u6578\u3002\nHTTP \u65b9\u6cd5\u548c\u7db2\u5740\uff1a\n```\nPOST https://LOCATION_ID-aiplatform.googleapis.com/v1/projects/PROJECT_ID/locations/LOCATION_ID/batchPredictionJobs\n```\n\u8acb\u6c42 JSON \u6b63\u6587\uff1a\n```\n{\n \"displayName\": \"BATCH_JOB_NAME\",\n \"model\": \"projects/PROJECT_ID/locations/LOCATION_ID/models/MODEL_ID\",\n \"inputConfig\": {\n \"instancesFormat\": \"INPUT_FORMAT\",\n \"gcsSource\": {\n  \"uris\": [\"INPUT_URI\"],\n },\n },\n \"outputConfig\": {\n \"predictionsFormat\": \"jsonl\",\n \"gcsDestination\": {\n  \"outputUriPrefix\": \"OUTPUT_DIRECTORY\",\n },\n },\n \"dedicatedResources\" : {\n \"machineSpec\" : {\n  \"machineType\": MACHINE_TYPE\n },\n \"startingReplicaCount\": STARTING_REPLICA_COUNT\n },\n \"manualBatchTuningParameters\": {\n \"batch_size\": BATCH_SIZE,\n }\n}\n```\n\u5982\u9700\u767c\u9001\u8acb\u6c42\uff0c\u8acb\u9078\u64c7\u4ee5\u4e0b\u65b9\u5f0f\u4e4b\u4e00\uff1a\n **\u6ce8\u610f** \uff1a\u4ee5\u4e0b\u547d\u4ee4\u5047\u5b9a\u60a8\u5df2\u4f7f\u7528\u60a8\u7684\u7528\u6236\u8cec\u865f\u901a\u904e\u904b\u884c [gcloud init](https://cloud.google.com/sdk/gcloud/reference/init?hl=zh-cn) \u6216 [gcloud auth login](https://cloud.google.com/sdk/gcloud/reference/auth/login?hl=zh-cn) \u767b\u9304`gcloud`CLI\uff0c\u6216\u8005\u4f7f\u7528\u4e86 [Cloud Shell](https://cloud.google.com/shell/docs?hl=zh-cn) \uff0c\u9019\u6703\u4f7f\u60a8\u81ea\u52d5\u767b\u9304`gcloud`CLI\u3002\u60a8\u53ef\u4ee5\u904b\u884c [gcloud auth list](https://cloud.google.com/sdk/gcloud/reference/auth/list?hl=zh-cn) \u4f86\u6aa2\u67e5\u7576\u524d\u6d3b\u8e8d\u7684\u8cec\u865f\u3002\n\u5c07\u8acb\u6c42\u6b63\u6587\u4fdd\u5b58\u5728\u540d\u7232 `request.json` \u7684\u6587\u4ef6\u4e2d\uff0c\u7136\u5f8c\u57f7\u884c\u4ee5\u4e0b\u547d\u4ee4\uff1a\n```\ncurl -X POST \\ -H \"Authorization: Bearer $(gcloud auth print-access-token)\" \\ -H \"Content-Type: application/json; charset=utf-8\" \\ -d @request.json \\ \"https://LOCATION_ID-aiplatform.googleapis.com/v1/projects/PROJECT_ID/locations/LOCATION_ID/batchPredictionJobs\"\n``` **\u6ce8\u610f** \uff1a\u4ee5\u4e0b\u547d\u4ee4\u5047\u5b9a\u60a8\u5df2\u4f7f\u7528\u60a8\u7684\u7528\u6236\u8cec\u865f\u901a\u904e\u904b\u884c [gcloud init](https://cloud.google.com/sdk/gcloud/reference/init?hl=zh-cn) \u6216 [gcloud auth login](https://cloud.google.com/sdk/gcloud/reference/auth/login?hl=zh-cn) \u767b\u9304`gcloud`CLI\uff0c\u6216\u8005\u4f7f\u7528\u4e86 [Cloud Shell](https://cloud.google.com/shell/docs?hl=zh-cn) \uff0c\u9019\u6703\u4f7f\u60a8\u81ea\u52d5\u767b\u9304`gcloud`CLI\u3002\u60a8\u53ef\u4ee5\u904b\u884c [gcloud auth list](https://cloud.google.com/sdk/gcloud/reference/auth/list?hl=zh-cn) \u4f86\u6aa2\u67e5\u7576\u524d\u6d3b\u8e8d\u7684\u8cec\u865f\u3002\n\u5c07\u8acb\u6c42\u6b63\u6587\u4fdd\u5b58\u5728\u540d\u7232 `request.json` \u7684\u6587\u4ef6\u4e2d\uff0c\u7136\u5f8c\u57f7\u884c\u4ee5\u4e0b\u547d\u4ee4\uff1a\n```\n$cred = gcloud auth print-access-token$headers = @{ \"Authorization\" = \"Bearer $cred\" }Invoke-WebRequest ` -Method POST ` -Headers $headers ` -ContentType: \"application/json; charset=utf-8\" ` -InFile request.json ` -Uri \"https://LOCATION_ID-aiplatform.googleapis.com/v1/projects/PROJECT_ID/locations/LOCATION_ID/batchPredictionJobs\" | Select-Object -Expand Content\n```\n\u60a8\u61c9\u8a72\u6536\u5230\u985e\u4f3c\u4ee5\u4e0b\u5167\u5bb9\u7684 JSON \u97ff\u61c9\uff1a\n```\n{\n \"name\": \"projects/PROJECT_NUMBER/locations/LOCATION_ID/batchPredictionJobs/BATCH_JOB_ID\",\n \"displayName\": \"BATCH_JOB_NAME 202005291958\",\n \"model\": \"projects/PROJECT_ID/locations/LOCATION_ID/models/MODEL_ID\",\n \"inputConfig\": {\n \"instancesFormat\": \"jsonl\",\n \"gcsSource\": {\n  \"uris\": [  \"INPUT_URI\"\n  ]\n }\n },\n \"outputConfig\": {\n \"predictionsFormat\": \"jsonl\",\n \"gcsDestination\": {\n  \"outputUriPrefix\": \"OUTPUT_DIRECTORY\"\n }\n },\n \"state\": \"JOB_STATE_PENDING\",\n \"createTime\": \"2020-05-30T02:58:44.341643Z\",\n \"updateTime\": \"2020-05-30T02:58:44.341643Z\",\n}\n```\n\u5728\u5617\u8a66\u6b64\u793a\u4f8b\u4e4b\u524d\uff0c\u8acb\u6309\u7167 [\u300aVertex AI \u5feb\u901f\u5165\u9580\uff1a\u4f7f\u7528\u5ba2\u6236\u7aef\u5eab\u300b](https://cloud.google.com/vertex-ai/docs/start/client-libraries?hl=zh-cn) \u4e2d\u7684 Java \u8a2d\u7f6e\u8aaa\u660e\u57f7\u884c\u64cd\u4f5c\u3002\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [Vertex AI Java API \u53c3\u8003\u6587\u6a94](https://cloud.google.com/java/docs/reference/google-cloud-aiplatform/latest/com.google.cloud.aiplatform.v1?hl=zh-cn) \u3002\n\u5982\u9700\u5411 Vertex AI \u9032\u884c\u8eab\u4efd\u9a57\u8b49\uff0c\u8acb\u8a2d\u7f6e\u61c9\u7528\u9ed8\u8a8d\u6191\u64da\u3002  \u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [\u7232\u672c\u5730\u958b\u767c\u74b0\u5883\u8a2d\u7f6e\u8eab\u4efd\u9a57\u8b49](https://cloud.google.com/docs/authentication/provide-credentials-adc?hl=zh-cn#local-dev) \u3002\n\u5728\u4ee5\u4e0b\u793a\u4f8b\u4e2d\uff0c\u5c07 \u66ff\u63db\u7232 `jsonl` \u3002 \u5982\u9700\u77ad\u89e3\u5982\u4f55\u66ff\u63db\u5176\u4ed6\u4f54\u4f4d\u7b26\uff0c\u8acb\u53c3\u95b1\u672c\u90e8\u5206\u7684 `REST & CMD LINE` \u6a19\u7c64\u9801\u3002\n [\u5728 GitHub \u4e0a\u67e5\u770b](https://github.com/GoogleCloudPlatform/java-docs-samples/blob/HEAD/aiplatform/src/main/java/aiplatform/CreateBatchPredictionJobSample.java) \n```\nimport com.google.cloud.aiplatform.util.ValueConverter;import com.google.cloud.aiplatform.v1.AcceleratorType;import com.google.cloud.aiplatform.v1.BatchDedicatedResources;import com.google.cloud.aiplatform.v1.BatchPredictionJob;import com.google.cloud.aiplatform.v1.GcsDestination;import com.google.cloud.aiplatform.v1.GcsSource;import com.google.cloud.aiplatform.v1.JobServiceClient;import com.google.cloud.aiplatform.v1.JobServiceSettings;import com.google.cloud.aiplatform.v1.LocationName;import com.google.cloud.aiplatform.v1.MachineSpec;import com.google.cloud.aiplatform.v1.ModelName;import com.google.protobuf.Value;import java.io.IOException;public class CreateBatchPredictionJobSample {\u00a0 public static void main(String[] args) throws IOException {\u00a0 \u00a0 // TODO(developer): Replace these variables before running the sample.\u00a0 \u00a0 String project = \"PROJECT\";\u00a0 \u00a0 String displayName = \"DISPLAY_NAME\";\u00a0 \u00a0 String modelName = \"MODEL_NAME\";\u00a0 \u00a0 String instancesFormat = \"INSTANCES_FORMAT\";\u00a0 \u00a0 String gcsSourceUri = \"GCS_SOURCE_URI\";\u00a0 \u00a0 String predictionsFormat = \"PREDICTIONS_FORMAT\";\u00a0 \u00a0 String gcsDestinationOutputUriPrefix = \"GCS_DESTINATION_OUTPUT_URI_PREFIX\";\u00a0 \u00a0 createBatchPredictionJobSample(\u00a0 \u00a0 \u00a0 \u00a0 project,\u00a0 \u00a0 \u00a0 \u00a0 displayName,\u00a0 \u00a0 \u00a0 \u00a0 modelName,\u00a0 \u00a0 \u00a0 \u00a0 instancesFormat,\u00a0 \u00a0 \u00a0 \u00a0 gcsSourceUri,\u00a0 \u00a0 \u00a0 \u00a0 predictionsFormat,\u00a0 \u00a0 \u00a0 \u00a0 gcsDestinationOutputUriPrefix);\u00a0 }\u00a0 static void createBatchPredictionJobSample(\u00a0 \u00a0 \u00a0 String project,\u00a0 \u00a0 \u00a0 String displayName,\u00a0 \u00a0 \u00a0 String model,\u00a0 \u00a0 \u00a0 String instancesFormat,\u00a0 \u00a0 \u00a0 String gcsSourceUri,\u00a0 \u00a0 \u00a0 String predictionsFormat,\u00a0 \u00a0 \u00a0 String gcsDestinationOutputUriPrefix)\u00a0 \u00a0 \u00a0 throws IOException {\u00a0 \u00a0 JobServiceSettings settings =\u00a0 \u00a0 \u00a0 \u00a0 JobServiceSettings.newBuilder()\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 .setEndpoint(\"us-central1-aiplatform.googleapis.com:443\")\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 .build();\u00a0 \u00a0 String location = \"us-central1\";\u00a0 \u00a0 // Initialize client that will be used to send requests. This client only needs to be created\u00a0 \u00a0 // once, and can be reused for multiple requests. After completing all of your requests, call\u00a0 \u00a0 // the \"close\" method on the client to safely clean up any remaining background resources.\u00a0 \u00a0 try (JobServiceClient client = JobServiceClient.create(settings)) {\u00a0 \u00a0 \u00a0 // Passing in an empty Value object for model parameters\u00a0 \u00a0 \u00a0 Value modelParameters = ValueConverter.EMPTY_VALUE;\u00a0 \u00a0 \u00a0 GcsSource gcsSource = GcsSource.newBuilder().addUris(gcsSourceUri).build();\u00a0 \u00a0 \u00a0 BatchPredictionJob.InputConfig inputConfig =\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 BatchPredictionJob.InputConfig.newBuilder()\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 .setInstancesFormat(instancesFormat)\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 .setGcsSource(gcsSource)\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 .build();\u00a0 \u00a0 \u00a0 GcsDestination gcsDestination =\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 GcsDestination.newBuilder().setOutputUriPrefix(gcsDestinationOutputUriPrefix).build();\u00a0 \u00a0 \u00a0 BatchPredictionJob.OutputConfig outputConfig =\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 BatchPredictionJob.OutputConfig.newBuilder()\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 .setPredictionsFormat(predictionsFormat)\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 .setGcsDestination(gcsDestination)\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 .build();\u00a0 \u00a0 \u00a0 MachineSpec machineSpec =\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 MachineSpec.newBuilder()\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 .setMachineType(\"n1-standard-2\")\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 .setAcceleratorType(AcceleratorType.NVIDIA_TESLA_K80)\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 .setAcceleratorCount(1)\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 .build();\u00a0 \u00a0 \u00a0 BatchDedicatedResources dedicatedResources =\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 BatchDedicatedResources.newBuilder()\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 .setMachineSpec(machineSpec)\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 .setStartingReplicaCount(1)\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 .setMaxReplicaCount(1)\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 .build();\u00a0 \u00a0 \u00a0 String modelName = ModelName.of(project, location, model).toString();\u00a0 \u00a0 \u00a0 BatchPredictionJob batchPredictionJob =\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 BatchPredictionJob.newBuilder()\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 .setDisplayName(displayName)\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 .setModel(modelName)\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 .setModelParameters(modelParameters)\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 .setInputConfig(inputConfig)\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 .setOutputConfig(outputConfig)\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 .setDedicatedResources(dedicatedResources)\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 .build();\u00a0 \u00a0 \u00a0 LocationName parent = LocationName.of(project, location);\u00a0 \u00a0 \u00a0 BatchPredictionJob response = client.createBatchPredictionJob(parent, batchPredictionJob);\u00a0 \u00a0 \u00a0 System.out.format(\"response: %s\\n\", response);\u00a0 \u00a0 \u00a0 System.out.format(\"\\tName: %s\\n\", response.getName());\u00a0 \u00a0 }\u00a0 }}\n```\u5982\u9700\u77ad\u89e3\u5982\u4f55\u5b89\u88dd\u6216\u66f4\u65b0 Python\uff0c\u8acb\u53c3\u95b1 [\u5b89\u88dd Python \u7248 Vertex AI SDK](https://cloud.google.com/vertex-ai/docs/start/use-vertex-ai-python-sdk?hl=zh-cn) \u3002   \u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [   Python API \u53c3\u8003\u6587\u6a94](https://cloud.google.com/python/docs/reference/aiplatform/latest?hl=zh-cn) \u3002\n [\u5728 GitHub \u4e0a\u67e5\u770b](https://github.com/googleapis/python-aiplatform/blob/HEAD/samples/model-builder/create_batch_prediction_job_dedicated_resources_sample.py) \n```\ndef create_batch_prediction_job_dedicated_resources_sample(\u00a0 \u00a0 project: str,\u00a0 \u00a0 location: str,\u00a0 \u00a0 model_resource_name: str,\u00a0 \u00a0 job_display_name: str,\u00a0 \u00a0 gcs_source: Union[str, Sequence[str]],\u00a0 \u00a0 gcs_destination: str,\u00a0 \u00a0 instances_format: str = \"jsonl\",\u00a0 \u00a0 machine_type: str = \"n1-standard-2\",\u00a0 \u00a0 accelerator_count: int = 1,\u00a0 \u00a0 accelerator_type: Union[str, aiplatform_v1.AcceleratorType] = \"NVIDIA_TESLA_K80\",\u00a0 \u00a0 starting_replica_count: int = 1,\u00a0 \u00a0 max_replica_count: int = 1,\u00a0 \u00a0 sync: bool = True,):\u00a0 \u00a0 aiplatform.init(project=project, location=location)\u00a0 \u00a0 my_model = aiplatform.Model(model_resource_name)\u00a0 \u00a0 batch_prediction_job = my_model.batch_predict(\u00a0 \u00a0 \u00a0 \u00a0 job_display_name=job_display_name,\u00a0 \u00a0 \u00a0 \u00a0 gcs_source=gcs_source,\u00a0 \u00a0 \u00a0 \u00a0 gcs_destination_prefix=gcs_destination,\u00a0 \u00a0 \u00a0 \u00a0 instances_format=instances_format,\u00a0 \u00a0 \u00a0 \u00a0 machine_type=machine_type,\u00a0 \u00a0 \u00a0 \u00a0 accelerator_count=accelerator_count,\u00a0 \u00a0 \u00a0 \u00a0 accelerator_type=accelerator_type,\u00a0 \u00a0 \u00a0 \u00a0 starting_replica_count=starting_replica_count,\u00a0 \u00a0 \u00a0 \u00a0 max_replica_count=max_replica_count,\u00a0 \u00a0 \u00a0 \u00a0 sync=sync,\u00a0 \u00a0 )\u00a0 \u00a0 batch_prediction_job.wait()\u00a0 \u00a0 print(batch_prediction_job.display_name)\u00a0 \u00a0 print(batch_prediction_job.resource_name)\u00a0 \u00a0 print(batch_prediction_job.state)\u00a0 \u00a0 return batch_prediction_job\n```\n\u5982\u679c\u60a8\u5e0c\u671b\u8fd4\u56de\u9810\u6e2c\u7d50\u679c\u7684\u7279\u5fb5\u91cd\u8981\u6027\u503c\uff0c\u8acb\u5c07 `generateExplanation` \u5c6c\u6027\u8a2d\u7f6e\u7232 `true` \u3002\u8acb\u6ce8\u610f\uff0c\u9810\u6e2c \u6a21\u578b\u4e0d\u652f\u6301\u7279\u5fb5\u91cd\u8981\u6027\uff0c\u56e0\u6b64\u60a8\u7121\u6cd5\u5728\u6279\u91cf\u9810\u6e2c\u8acb\u6c42\u4e2d\u5305\u542b\u7279\u5fb5\u91cd\u8981\u6027\u3002\n\u7279\u5fb5\u91cd\u8981\u6027\uff08\u6709\u6642\u7a31\u7232\u7279\u5fb5\u6b78\u56e0\uff09\u662f [Vertex Explainable AI](https://cloud.google.com/vertex-ai/docs/explainable-ai/overview?hl=zh-cn) \u7684\u4e00\u90e8\u5206 \u3002\u53ea\u6709\u5728 [\u7232\u8aaa\u660e\u914d\u7f6e\u4e86 Model](https://cloud.google.com/vertex-ai/docs/explainable-ai/configuring-explanations?hl=zh-cn) \u6216\u6307\u5b9a\u4e86 `BatchPredictionJob` \u7684 [explanationSpec \u5b57\u6bb5](https://cloud.google.com/vertex-ai/docs/reference/rest/v1/projects.locations.batchPredictionJobs?hl=zh-cn#BatchPredictionJob.FIELDS.explanation_spec) \u6642\uff0c\u624d\u80fd\u5c07 `generateExplanation` \u8a2d\u7f6e\u7232 `true` \u3002\n### \u9078\u64c7\u6a5f\u5668\u985e\u578b\u548c\u526f\u672c\u6578\u91cf\n\u8207\u4f7f\u7528\u8f03\u5927\u7684\u6a5f\u5668\u985e\u578b\u76f8\u6bd4\uff0c\u901a\u904e\u589e\u52a0\u526f\u672c\u6578\u91cf\u9032\u884c\u6a6b\u5411\u64f4\u7e2e\u80fd\u5920\u4ee5\u66f4\u7dda\u6027\u4e14\u53ef\u9810\u6e2c\u7684\u65b9\u5f0f\u63d0\u9ad8\u541e\u5410\u91cf\u3002\n\u901a\u5e38\uff0c\u6211\u5011\u5efa\u8b70\u60a8\u5118\u53ef\u80fd\u7232\u4f5c\u696d\u6307\u5b9a\u6700\u5c0f\u7684\u6a5f\u5668\u985e\u578b\u4e26\u589e\u52a0\u526f\u672c\u7684\u6578\u91cf\u3002\n\u7232\u4e86\u7372\u5f97\u6210\u672c\u6548\u76ca\uff0c\u6211\u5011\u5efa\u8b70\u60a8\u9078\u64c7\u526f\u672c\u6578\u91cf\uff0c\u4ee5\u4f7f\u6279\u91cf\u9810\u6e2c\u4f5c\u696d\u81f3\u5c11\u904b\u884c 10 \u5206\u9418\u3002\u9019\u662f\u56e0\u7232\u60a8\u9700\u8981\u6309\u6bcf\u500b\u526f\u672c\u7bc0\u9ede\u6642\u4ed8\u8cbb\uff0c\u5176\u4e2d\u5305\u62ec\u6bcf\u500b\u526f\u672c\u5553\u52d5\u6240\u9700\u7684\u5927\u7d04 5 \u5206\u9418\u3002\u50c5\u8655\u7406\u5e7e\u79d2\u9418\u7136\u5f8c\u95dc\u505c\u4e26\u4e0d\u7d93\u6fdf\u5be6\u60e0\u3002\n\u4f5c\u7232\u4e00\u822c\u6e96\u5247\uff0c\u5c0d\u65bc\u6578\u5343\u500b\u5be6\u4f8b\uff0c\u6211\u5011\u5efa\u8b70\u5728\u6578\u5341\u500b\u5be6\u4f8b\u4e2d\u4f7f\u7528 `starting_replica_count` \u3002\u5c0d\u65bc\u6578\u767e\u842c\u500b\u5be6\u4f8b\uff0c\u6211\u5011\u5efa\u8b70\u5728\u6578\u767e\u500b\u5be6\u4f8b\u4e2d\u4f7f\u7528 `starting_replica_count` \u3002\u60a8\u9084\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u8ad6\u58c7\u4f86\u4f30\u7b97\u526f\u672c\u6578\u91cf\uff1a\n`N / (T * (60 / Tb))`\n\u5176\u4e2d\uff1a\n- **N\uff1a** \u4f5c\u696d\u4e2d\u7684\u6279\u6b21\u6578\u91cf\u3002\u4f8b\u5982\uff0c100 \u842c\u500b\u5be6\u4f8b / 100 \u6279\u6b21\u5927\u5c0f = 10,000 \u500b\u6279\u6b21\u3002\n- **T** \uff1a\u6279\u91cf\u9810\u6e2c\u4f5c\u696d\u7684\u6240\u9700\u6642\u9593\u3002\u4f8b\u5982\uff0c10 \u5206\u9418\u3002\n- **Tb** \uff1a\u526f\u672c\u8655\u7406\u55ae\u500b\u6279\u6b21\u6240\u9700\u7684\u6642\u9593\uff08\u4ee5\u79d2\u7232\u55ae\u4f4d\uff09\u3002\u4f8b\u5982\uff0c\u5728 2 \u6838\u6a5f\u5668\u985e\u578b\u4e0a\uff0c\u8655\u7406\u6bcf\u500b\u6279\u6b21\u9700\u8981 1 \u79d2\u3002\n\u5728\u6211\u5011\u7684\u793a\u4f8b\u4e2d\uff0c10,000 \u500b\u6279\u6b21 /\uff0810 \u5206\u9418 * [60 / 1 \u79d2]\uff09\u7684\u7d50\u679c\u5411\u4e0a\u53d6\u6574\u5f97\u5230 17 \u500b\u526f\u672c\u3002\n\u8207\u5728\u7dda\u9810\u6e2c\u4e0d\u540c\uff0c\u6279\u91cf\u9810\u6e2c\u4f5c\u696d\u4e0d\u6703 [\u81ea\u52d5\u64f4\u7e2e](https://cloud.google.com/vertex-ai/docs/general/deployment?hl=zh-cn#scaling) \u3002\u7531\u65bc\u9810\u5148\u77e5\u9053\u6240\u6709\u8f38\u5165\u6578\u64da\uff0c\u56e0\u6b64\u4fc2\u7d71\u6703\u5728\u4f5c\u696d\u958b\u59cb\u6642\u5c07\u6578\u64da\u5283\u5206\u5230\u6bcf\u500b\u526f\u672c\u3002\u7cfb\u7d71\u4f7f\u7528 `starting_replica_count` \u53c3\u6578\uff1b\u6703\u5ffd\u7565 `max_replica_count` \u53c3\u6578\u3002\n\u9019\u4e9b\u5efa\u8b70\u5747\u7232\u8fd1\u4f3c\u6307\u5c0e\u5efa\u8b70\u3002\u5b83\u5011\u7121\u6cd5\u4fdd\u8b49\u7232\u6bcf\u500b\u6a21\u578b\u63d0\u4f9b\u6700\u4f73\u541e\u5410\u91cf\u3002\u5b83\u5011\u4e0d\u6703\u63d0\u4f9b\u5c0d\u8655\u7406\u6642\u9593\u548c\u8cbb\u7528\u7684\u6e96\u78ba\u9810\u6e2c\u3002\u4e26\u4e14\u5b83\u5011\u4e0d\u4e00\u5b9a\u80fd\u91dd\u5c0d\u6bcf\u7a2e\u5834\u666f\u5be6\u73fe\u6700\u4f73\u8cbb\u7528/\u541e\u5410\u91cf\u6b0a\u8861\u3002\u60a8\u53ef\u5c07\u5efa\u8b70\u7528\u4f5c\u5408\u7406\u7684\u8d77\u9ede\uff0c\u4e26\u6839\u64da\u9700\u8981\u9032\u884c\u8abf\u6574\u3002\u5982\u9700\u8861\u91cf\u6a21\u578b\u7684\u541e\u5410\u91cf\u7b49\u7279\u5fb5\uff0c\u8acb\u904b\u884c [\u627e\u5230\u7406\u60f3\u7684\u6a5f\u5668\u985e\u578b](https://github.com/GoogleCloudPlatform/vertex-ai-samples/blob/main/notebooks/community/vertex_endpoints/find_ideal_machine_type/find_ideal_machine_type.ipynb) \u7b46\u8a18\u672c\u3002\n\u9075\u5faa [\u50c5\u9069\u7528\u65bc CPU \u7684\u6a21\u578b](#for_cpu-only_models) \u6e96\u5247\uff0c\u4e26\u6ce8\u610f\u4ee5\u4e0b\u5176\u4ed6\u4e8b\u9805\uff1a\n- \u60a8\u53ef\u80fd\u9700\u8981\u66f4\u591a\u7684 CPU \u548c GPU\uff08\u4f8b\u5982\uff0c\u7528\u65bc\u6578\u64da\u9810\u8655\u7406\uff09\u3002\n- GPU \u6a5f\u5668\u985e\u578b\u7684\u5553\u52d5\u9700\u8981\u66f4\u591a\u6642\u9593\uff0810 \u5206\u9418\uff09\uff0c\u56e0\u6b64\u60a8\u53ef\u80fd\u5e0c\u671b\u6279\u91cf\u9810\u6e2c\u4f5c\u696d\u5b9a\u4f4d\u66f4\u9577\u7684\u6642\u9593\uff08\u4f8b\u5982\uff0c\u81f3\u5c11 20 \u5206\u9418\uff0c\u800c\u4e0d\u662f 10 \u5206\u9418\uff09\uff0c\u4ee5\u4fbf\u5c07\u5408\u7406\u6bd4\u4f8b\u7684\u6642\u9593\u548c\u8cbb\u7528\u82b1\u5728\u751f\u6210\u9810\u6e2c\u7d50\u679c\u4e0a\u3002\n### \u6aa2\u7d22\u6279\u91cf\u9810\u6e2c\u7d50\u679c\n\u6279\u91cf\u9810\u6e2c\u4efb\u52d9\u5b8c\u6210\u5f8c\uff0c\u9810\u6e2c\u7684\u8f38\u51fa\u5b58\u5132\u5728\u60a8\u5728\u8acb\u6c42\u4e2d\u6307\u5b9a\u7684 Cloud Storage \u5b58\u5132\u6876\u6216 BigQuery \u4f4d\u7f6e\u4e2d\u3002\n### \u6279\u91cf\u9810\u6e2c\u7d50\u679c\u793a\u4f8b\n\u8f38\u51fa\u6587\u4ef6\u593e\u5305\u542b\u4e00\u7d44 JSON \u884c\u6587\u4ef6\u3002\n\u9019\u4e9b\u6587\u4ef6\u7684\u540d\u7a31\u7232 `{gcs_path}/prediction.results-{file_number}-of-{number_of_files_generated}` \u3002\u7531\u65bc\u6279\u91cf\u9810\u6e2c\u7684\u5206\u4f48\u5f0f\u7279\u6027\u800c\u5c0e\u81f4\u6587\u4ef6\u6578\u91cf\u4e0d\u78ba\u5b9a\u3002\n\u6587\u4ef6\u4e2d\u7684\u6bcf\u4e00\u884c\u5c0d\u61c9\u8f38\u5165\u4e2d\u7684\u4e00\u500b\u5be6\u4f8b\uff0c\u4e26\u5177\u6709\u4ee5\u4e0b\u9375\u503c\u5c0d\uff1a\n- `prediction`\uff1a\u5305\u542b\u9810\u6e2c\u5bb9\u5668\u8fd4\u56de\u7684\u503c\u3002\n- `instance`\uff1a\u5c0d\u65bc FileList\uff0c\u5b83\u5305\u542b Cloud Storage URI\u3002\u5c0d\u65bc\u6240\u6709\u5176\u4ed6\u8f38\u5165\u683c\u5f0f\uff0c\u5b83\u5305\u542b HTTP \u8acb\u6c42\u6b63\u6587\u4e2d\u767c\u9001\u5230\u9810\u6e2c\u5bb9\u5668\u7684\u503c\u3002\u5982\u679c HTTP \u8acb\u6c42\u5305\u542b\uff1a\n```\n{\u00a0 \"instances\": [\u00a0 \u00a0 [1, 2, 3, 4],\u00a0 \u00a0 [5, 6, 7, 8]]}\n```\n\u4e26\u4e14\u9810\u6e2c\u5bb9\u5668\u8fd4\u56de\uff1a\n```\n{\u00a0 \"predictions\": [\u00a0 \u00a0 [0.1,0.9],\u00a0 \u00a0 [0.7,0.3]\u00a0 ],}\n```\n\u7136\u5f8c\uff0cjsonl \u8f38\u51fa\u6587\u4ef6\u7232\uff1a\n```\n{ \"instance\": [1, 2, 3, 4], \"prediction\": [0.1,0.9]}{ \"instance\": [5, 6, 7, 8], \"prediction\": [0.7,0.3]}\n```\n\u5982\u679c HTTP \u8acb\u6c42\u5305\u542b\uff1a\n```\n{\u00a0 \"instances\": [\u00a0 \u00a0 {\"values\": [1, 2, 3, 4], \"key\": 1},\u00a0 \u00a0 {\"values\": [5, 6, 7, 8], \"key\": 2}]}\n```\n\u4e26\u4e14\u9810\u6e2c\u5bb9\u5668\u8fd4\u56de\uff1a\n```\n{\u00a0 \"predictions\": [\u00a0 \u00a0 {\"result\":1},\u00a0 \u00a0 {\"result\":0}\u00a0 ],}\n```\n\u7136\u5f8c\uff0cjsonl \u8f38\u51fa\u6587\u4ef6\u7232\uff1a\n```\n{ \"instance\": {\"values\": [1, 2, 3, 4], \"key\": 1}, \"prediction\": {\"result\":1}}{ \"instance\": {\"values\": [5, 6, 7, 8], \"key\": 2}, \"prediction\": {\"result\":0}}\n```\n## \u4f7f\u7528 Explainable AI\n\u6211\u5011\u4e0d\u5efa\u8b70\u5c0d\u5927\u91cf\u6578\u64da\u904b\u884c [\u57fa\u65bc\u7279\u5fb5\u7684\u8aaa\u660e](https://cloud.google.com/vertex-ai/docs/explainable-ai/overview?hl=zh-cn#feature-based) \u3002\u9019\u662f\u56e0\u7232\u6bcf\u500b\u8f38\u5165\u90fd\u53ef\u80fd\u6703\u6839\u64da\u4e00\u7d44\u53ef\u80fd\u7684\u7279\u5fb5\u503c\u6247\u51fa\u5230\u6578\u5343\u500b\u8acb\u6c42\uff0c\u9019\u53ef\u80fd\u6703\u5c0e\u81f4\u8655\u7406\u6642\u9593\u548c\u8cbb\u7528\u5927\u5e45\u589e\u52a0\u3002\u901a\u5e38\uff0c\u901a\u904e\u5c0f\u578b\u6578\u64da\u96c6\u8db3\u4ee5\u77ad\u89e3\u7279\u5fb5\u91cd\u8981\u6027\u3002\n\u6279\u91cf\u9810\u6e2c\u4e0d\u652f\u6301 [\u57fa\u65bc\u6a23\u672c\u7684\u8aaa\u660e](https://cloud.google.com/vertex-ai/docs/explainable-ai/overview?hl=zh-cn#example-based) \u3002\n## \u5f8c\u7e8c\u6b65\u9a5f\n- \u77ad\u89e3 [\u7528\u65bc\u9810\u6e2c\u7684\u8a08\u7b97\u8cc7\u6e90](https://cloud.google.com/vertex-ai/docs/predictions/configure-compute?hl=zh-cn) \u3002", "guide": "Vertex AI"}