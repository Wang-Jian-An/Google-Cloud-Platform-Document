{"title": "Vertex AI - \u5f9e\u81ea\u5b9a\u7fa9\u8a13\u7df4\u6a21\u578b\u7372\u53d6\u5728\u7dda\u9810\u6e2c\u7d50\u679c", "url": "https://cloud.google.com/vertex-ai/docs/predictions/get-online-predictions?hl=zh-cn", "abstract": "# Vertex AI - \u5f9e\u81ea\u5b9a\u7fa9\u8a13\u7df4\u6a21\u578b\u7372\u53d6\u5728\u7dda\u9810\u6e2c\u7d50\u679c\n\u672c\u9801\u9762\u4ecb\u7d39\u77ad\u5982\u4f55\u4f7f\u7528 Google Cloud \u63a7\u5236\u6aaf\u6216 Vertex AI API \u5f9e\u81ea\u5b9a\u7fa9\u8a13\u7df4\u6a21\u578b\u7372\u53d6\u5728\u7dda\uff08\u5be6\u6642\uff09\u9810\u6e2c\u7d50\u679c\u3002\n", "content": "## \u683c\u5f0f\u5316\u8f38\u5165\u4ee5\u9032\u884c\u5728\u7dda\u9810\u6e2c\n\u672c\u90e8\u5206\u4ecb\u7d39\u77ad\u5982\u4f55\u8a2d\u7f6e\u9810\u6e2c\u8f38\u5165\u5be6\u4f8b\u7684\u683c\u5f0f\u4e26\u7de8\u78bc\u7232 JSON\uff0c\u5982\u679c\u60a8\u4f7f\u7528\u7684\u662f [predict](https://cloud.google.com/vertex-ai/docs/reference/rest/v1/projects.locations.endpoints/predict?hl=zh-cn) \u6216 [explain](https://cloud.google.com/vertex-ai/docs/reference/rest/v1/projects.locations.endpoints/explain?hl=zh-cn) \u65b9\u6cd5\uff0c\u5247\u9700\u8981\u57f7\u884c\u6b64\u64cd\u4f5c\u3002\u5982\u679c\u60a8\u4f7f\u7528\u7684\u662f [rawPredict](https://cloud.google.com/vertex-ai/docs/reference/rest/v1/projects.locations.endpoints/rawPredict?hl=zh-cn) \u65b9\u6cd5\uff0c\u5247\u4e0d\u9700\u8981\u57f7\u884c\u6b64\u64cd\u4f5c\u3002\u5982\u9700\u77ad\u89e3\u9078\u64c7\u54ea\u7a2e\u65b9\u6cd5\uff0c\u8acb\u53c3\u95b1 [\u5411\u7aef\u9ede\u767c\u9001\u8acb\u6c42](#send-request) \u3002\n\u5982\u679c\u60a8\u4f7f\u7528 Python \u7248 Vertex AI SDK \u767c\u9001\u9810\u6e2c\u8acb\u6c42\uff0c\u8acb\u6307\u5b9a\u4e0d\u5e36 `instances` \u5b57\u6bb5\u7684\u5be6\u4f8b\u5217\u8868\u3002\u4f8b\u5982\uff0c\u6307\u5b9a `[ [\"the\",\"quick\",\"brown\"], ... ]` \u800c\u4e0d\u662f `{ \"instances\": [ [\"the\",\"quick\",\"brown\"], ... ] }` \u3002\n\u5982\u679c\u60a8\u7684\u6a21\u578b\u4f7f\u7528 [\u81ea\u5b9a\u7fa9\u5bb9\u5668](https://cloud.google.com/vertex-ai/docs/predictions/use-custom-container?hl=zh-cn) \uff0c\u5247\u8f38\u5165\u5fc5\u9808\u63a1\u7528 JSON \u683c\u5f0f\uff0c\u4e26\u4e14\u9084\u6709\u4e00\u500b\u53ef\u7528\u65bc\u5bb9\u5668\u7684\u984d\u5916 `parameters` \u5b57\u6bb5\u3002\u8a73\u7d30\u77ad\u89e3\u5982\u4f55 [\u4f7f\u7528\u81ea\u5b9a\u7fa9\u5bb9\u5668\u8a2d\u7f6e\u9810\u6e2c\u8f38\u5165\u7684\u683c\u5f0f](https://cloud.google.com/vertex-ai/docs/predictions/custom-container-requirements?hl=zh-cn#prediction) \u3002\n### \u5c07\u5be6\u4f8b\u683c\u5f0f\u8a2d\u7f6e\u7232 JSON \u5b57\u7b26\u4e32\n\u5728\u7dda\u9810\u6e2c\u7684\u57fa\u672c\u683c\u5f0f\u662f\u6578\u64da\u5be6\u4f8b\u5217\u8868\u3002\u9019\u4e9b\u5217\u8868\u53ef\u4ee5\u662f\u666e\u901a\u7684\u503c\u5217\u8868\uff0c\u4e5f\u53ef\u4ee5\u662f JSON \u5c0d\u8c61\u7684\u6210\u54e1\uff0c\u5177\u9ad4\u53d6\u6c7a\u65bc\u60a8\u5728\u8a13\u7df4\u61c9\u7528\u4e2d\u914d\u7f6e\u8f38\u5165\u7684\u65b9\u5f0f\u3002TensorFlow \u6a21\u578b\u53ef\u4ee5\u63a5\u53d7\u66f4\u5fa9\u96dc\u7684\u8f38\u5165\uff0c\u5927\u591a\u6578 scikit-learn \u548c XGBoost \u6a21\u578b\u5247\u63a5\u53d7\u6578\u5b57\u5217\u8868\u5f62\u5f0f\u7684\u8f38\u5165\u3002\n\u4ee5\u4e0b\u793a\u4f8b\u986f\u793a\u4e86 TensorFlow \u6a21\u578b\u7684\u8f38\u5165\u5f35\u91cf\u548c\u5be6\u4f8b\u9375\uff1a\n```\n\u00a0{\"values\": [1, 2, 3, 4], \"key\": 1}\n```\nJSON \u5b57\u7b26\u4e32\u7684\u69cb\u6210\u53ef\u4ee5\u5f88\u8907\u96dc\uff0c\u4f46\u53ea\u8981\u9075\u5faa\u4ee5\u4e0b\u898f\u5247\u5373\u53ef\uff1a\n- \u9802\u7d1a\u5be6\u4f8b\u6578\u64da\u5fc5\u9808\u662f JSON \u5c0d\u8c61\uff0c\u5373\u9375\u503c\u5c0d\u7684\u5b57\u5178\u3002\n- \u5be6\u4f8b\u5c0d\u8c61\u4e2d\u7684\u5404\u500b\u503c\u53ef\u4ee5\u662f\u5b57\u7b26\u4e32\u3001\u6578\u5b57\u6216\u5217\u8868\u3002 \u60a8\u7121\u6cd5\u5d4c\u5165 JSON \u5c0d\u8c61\u3002\n- \u5217\u8868\u5fc5\u9808\u50c5\u5305\u542b\u76f8\u540c\u985e\u578b\u7684\u5167\u5bb9\uff08\u5305\u62ec\u5176\u4ed6\u5217\u8868\uff09\u3002\u60a8\u4e0d\u80fd\u6df7\u5408\u4f7f\u7528\u5b57\u7b26\u4e32\u548c\u6578\u503c\u3002\n\u60a8\u5c07\u5728\u7dda\u9810\u6e2c\u7684\u8f38\u5165\u5be6\u4f8b\u4f5c\u7232 `projects.locations.endpoints.predict` \u8abf\u7528\u7684\u6d88\u606f\u6b63\u6587\u9032\u884c\u50b3\u905e\u3002\u8a73\u7d30\u77ad\u89e3 [\u8acb\u6c42\u6b63\u6587\u7684\u683c\u5f0f\u8981\u6c42](#request-response-examples) \u3002\n\u4f7f\u6bcf\u500b\u5be6\u4f8b\u6210\u7232 JSON \u6578\u7d44\u4e2d\u7684\u4e00\u9805\uff0c\u4e26\u5c07\u8a72\u6578\u7d44\u4f5c\u7232 JSON \u5c0d\u8c61\u7684 `instances` \u5b57\u6bb5\u63d0\u4f9b\u3002\u4f8b\u5982\uff1a\n```\n{\"instances\": [\u00a0 {\"values\": [1, 2, 3, 4], \"key\": 1},\u00a0 {\"values\": [5, 6, 7, 8], \"key\": 2}]}\n```\n### \u5c0d\u4e8c\u9032\u5236\u6578\u64da\u9032\u884c\u7de8\u78bc\u4ee5\u9032\u884c\u9810\u6e2c\u9810\u6e2c\n**\u6ce8\u610f** \uff1a\u4ee5\u4e0b\u90e8\u5206\u50c5\u9069\u7528\u65bc\u4f7f\u7528 TensorFlow \u9032\u884c\u7684\u9810\u6e2c\u3002\n\u4e8c\u9032\u5236\u6578\u64da\u4e0d\u80fd\u683c\u5f0f\u5316\u7232 JSON \u652f\u6301\u7684 UTF-8 \u7de8\u78bc\u5b57\u7b26\u4e32\u3002\u5982\u679c\u8f38\u5165\u4e2d\u5305\u542b\u4e8c\u9032\u5236\u6578\u64da\uff0c\u5247\u5fc5\u9808\u4f7f\u7528 base64 \u7de8\u78bc\u8868\u793a\u3002\u6b64\u6642\u9700\u8981\u7528\u5230\u4ee5\u4e0b\u7279\u6b8a\u683c\u5f0f\uff1a\n- \u7de8\u78bc\u7684\u5b57\u7b26\u4e32\u5fc5\u9808\u8a2d\u7f6e\u7232 JSON \u5c0d\u8c61\u683c\u5f0f\uff0c\u5e77\u5305\u542b\u540d\u7232 `b64` \u7684\u55ae\u500b\u9375\u3002\u5728 Python 3 \u4e2d\uff0cbase64 \u7de8\u78bc\u6703\u8f38\u51fa\u4e00\u500b\u5b57\u7bc0\u5e8f\u5217\u3002\u60a8\u5fc5\u9808\u5c07\u6b64\u5b57\u7bc0\u5e8f\u5217\u8f49\u63db\u7232\u5b57\u7b26\u4e32\uff0c\u4f7f\u5176\u80fd\u5920\u9032\u884c JSON \u5e8f\u5217\u5316\uff1a```\n{'image_bytes': {'b64': base64.b64encode(jpeg_data).decode()}}\n```\n- \u5728 TensorFlow \u6a21\u578b\u4ee3\u78bc\u4e2d\uff0c\u60a8\u5fc5\u9808\u7232\u4e8c\u9032\u5236\u8f38\u5165\u548c\u8f38\u51fa\u5f35\u91cf\u63d0\u4f9b\u5225\u540d\uff0c\u4ee5\u4fbf\u5b83\u5011\u4ee5\u201c_bytes\u201d\u7d50\u5c3e\u3002## \u8acb\u6c42\u548c\u97ff\u61c9\u793a\u4f8b\n\u672c\u90e8\u5206\u4ecb\u7d39\u9810\u6e2c\u8acb\u6c42\u6b63\u6587\u548c\u97ff\u61c9\u6b63\u6587\u7684\u683c\u5f0f\uff0c\u4ee5\u53ca TensorFlow\u3001scikit-learn\u3001XGBoost \u7684\u793a\u4f8b\u3002\n### \u8acb\u6c42\u6b63\u6587\u8a73\u60c5\n\u8acb\u6c42\u6b63\u6587\u5305\u542b\u7684\u6578\u64da\u63a1\u7528\u4ee5\u4e0b\u7d50\u69cb\uff08JSON \u8868\u793a\u6cd5\uff09\uff1a\n```\n{\u00a0 \"instances\": [\u00a0 \u00a0 <value>|<simple/nested list>|<object>,\u00a0 \u00a0 ...\u00a0 ]}\n```\n`instances[]` \u662f\u5fc5\u9700\u5c0d\u8c61\uff0c\u800c\u4e14\u5fc5\u9808\u5305\u542b\u5f85\u9810\u6e2c\u5be6\u4f8b\u7684\u5217\u8868\u3002\n\u5be6\u4f8b\u5217\u8868\u4e2d\u6bcf\u500b\u5143\u7d20\u7684\u7d50\u69cb\u7531\u6a21\u578b\u7684\u8f38\u5165\u5b9a\u7fa9\u6c7a\u5b9a\u3002\u5be6\u4f8b\u53ef\u5305\u542b\u547d\u540d\u8f38\u5165\uff08\u4f5c\u7232\u5c0d\u8c61\uff09\uff0c\u6216\u8005\u50c5\u5305\u542b\u672a\u52a0\u6a19\u7c64\u7684\u503c\u3002\n\u4e26\u975e\u6240\u6709\u6578\u64da\u90fd\u5305\u542b\u547d\u540d\u8f38\u5165\u3002\u6709\u4e9b\u5be6\u4f8b\u662f\u7c21\u55ae\u7684 JSON \u503c\uff08\u5e03\u723e\u503c\u3001\u6578\u5b57\u6216\u5b57\u7b26\u4e32\uff09\u3002\u4f46\u662f\uff0c\u5be6\u4f8b\u901a\u5e38\u662f\u7c21\u55ae\u503c\u5217\u8868\u6216\u8907\u96dc\u7684\u5d4c\u5957\u5217\u8868\u3002\n\u4ee5\u4e0b\u662f\u8acb\u6c42\u6b63\u6587\u7684\u4e00\u4e9b\u793a\u4f8b\u3002\nCSV \u6578\u64da\uff0c\u5176\u4e2d\u6bcf\u884c\u7de8\u78bc\u7232\u5b57\u7b26\u4e32\u503c\uff1a\n```\n{\"instances\": [\"1.0,true,\\\\\"x\\\\\"\", \"-2.0,false,\\\\\"y\\\\\"\"]}\n```\n\u7d14\u6587\u672c\uff1a\n```\n{\"instances\": [\"the quick brown fox\", \"the lazy dog\"]}\n```\n\u7de8\u78bc\u7232\u5b57\u8a5e\u5217\u8868\u7684\u53e5\u5b50\uff08\u5b57\u7b26\u4e32\u77e2\u91cf\uff09\uff1a\n```\n{\n \"instances\": [ [\"the\",\"quick\",\"brown\"],\n [\"the\",\"lazy\",\"dog\"],\n ...\n ]\n}\n```\n\u6d6e\u9ede\u6a19\u91cf\u503c\uff1a\n```\n{\"instances\": [0.0, 1.1, 2.2]}\n```\n\u6574\u6578\u77e2\u91cf\uff1a\n```\n{\n \"instances\": [ [0, 1, 2],\n [3, 4, 5],\n ...\n ]\n}\n```\n\u5f35\u91cf\uff08\u5728\u672c\u793a\u4f8b\u4e2d\u7232\u4e8c\u7dad\u5f35\u91cf\uff09\uff1a\n```\n{\n \"instances\": [ [  [0, 1, 2],\n  [3, 4, 5]\n ],\n ...\n ]\n}\n```\n\u5716\u7247\uff0c\u53ef\u901a\u904e\u4e0d\u540c\u65b9\u5f0f\u4f86\u8868\u793a\u3002\u5728\u672c\u7de8\u78bc\u65b9\u6848\u4e2d\uff0c\u524d\u5169\u500b\u7dad\u5ea6\u8868\u793a\u5716\u7247\u7684\u884c\u548c\u5217\uff0c\u7b2c\u4e09\u500b\u7dad\u5ea6\u5305\u542b\u6bcf\u500b\u50cf\u7d20\u7684 R\u3001G \u548c B \u503c\u7684\u5217\u8868\uff08\u77e2\u91cf\uff09\uff1a\n```\n{\n \"instances\": [ [  [  [138, 30, 66],\n  [130, 20, 56],\n  ...\n  ],\n  [  [126, 38, 61],\n  [122, 24, 57],\n  ...\n  ],\n  ...\n ],\n ...\n ]\n}\n```\n### \u6578\u64da\u7de8\u78bcJSON \u5b57\u7b26\u4e32\u5fc5\u9808\u63a1\u7528 UTF-8 \u7de8\u78bc\u3002\u5982\u8981\u767c\u9001\u4e8c\u9032\u5236\u6578\u64da\uff0c\u60a8\u5fc5\u9808\u5c0d\u6578\u64da\u9032\u884c base64 \u7de8\u78bc\u4e26\u5c07\u6578\u64da\u6a19\u8a18\u7232\u4e8c\u9032\u5236\u3002\u5982\u8981\u5c07 JSON \u5b57\u7b26\u4e32\u6a19\u8a18\u7232\u4e8c\u9032\u5236\uff0c\u8acb\u5c07\u5176\u66ff\u63db\u7232\u5177\u6709\u55ae\u4e00 `b64` \u7279\u6027\u7684 JSON \u5c0d\u8c61\uff1a\n```\n{\"b64\": \"...\"} \n```\n\u4ee5\u4e0b\u793a\u4f8b\u5c55\u793a\u4e86\u5169\u500b\u9700\u8981 base64 \u7de8\u78bc\u7684\u5e8f\u5217\u5316 `tf.Examples` \u5be6\u4f8b\uff08\u865b\u69cb\u7684\u6578\u64da\uff0c\u50c5\u4f5c\u8aaa\u660e\u4e4b\u7528\uff09\uff1a\n```\n{\"instances\": [{\"b64\": \"X5ad6u\"}, {\"b64\": \"IA9j4nx\"}]}\n```\n\u4ee5\u4e0b\u793a\u4f8b\u986f\u793a\u5169\u500b\u9700\u8981 base64 \u7de8\u78bc\u7684 JPEG \u5716\u7247\u5b57\u7bc0\u5b57\u7b26\u4e32\uff08\u865b\u69cb\u7684\u6578\u64da\uff0c\u50c5\u4f5c\u8aaa\u660e\u4e4b\u7528\uff09\uff1a\n```\n{\"instances\": [{\"b64\": \"ASa8asdf\"}, {\"b64\": \"JLK7ljk3\"}]}\n```\n### \u591a\u500b\u8f38\u5165\u5f35\u91cf\u4e00\u4e9b\u6a21\u578b\u5177\u6709\u53ef\u63a5\u53d7\u591a\u500b\u8f38\u5165\u5f35\u91cf\u7684\u5e95\u5c64 TensorFlow \u5716\u3002\u5728\u9019\u7a2e\u60c5\u6cc1\u4e0b\uff0c\u8acb\u4f7f\u7528 JSON \u540d\u7a31/\u503c\u5c0d\u7684\u540d\u7a31\u4f86\u8b58\u5225\u8f38\u5165\u5f35\u91cf\u3002\n\u5c0d\u65bc\u5e36\u6709\u8f38\u5165\u5f35\u91cf\u5225\u540d\u201ctag\u201d\uff08\u5b57\u7b26\u4e32\uff09\u548c\u201cimage\u201d\uff08base64 \u7de8\u78bc\u7684\u5b57\u7b26\u4e32\uff09\u7684\u5716\uff0c\u8acb\u4f7f\u7528\u4ee5\u4e0b\u4ee3\u78bc\uff1a\n```\n{\n \"instances\": [ {\n  \"tag\": \"beach\",\n  \"image\": {\"b64\": \"ASa8asdf\"}\n },\n {\n  \"tag\": \"car\",\n  \"image\": {\"b64\": \"JLK7ljk3\"}\n }\n ]\n}\n```\n\u5c0d\u65bc\u5e36\u6709\u8f38\u5165\u5f35\u91cf\u5225\u540d\u201ctag\u201d\uff08\u5b57\u7b26\u4e32\uff09\u548c\u201cimage\u201d\uff088 \u4f4d\u6574\u6578\u7684\u4e09\u7dad\u6578\u7d44\uff09\u7684\u5716\uff0c\u8acb\u4f7f\u7528\u4ee5\u4e0b\u4ee3\u78bc\uff1a\n```\n{\n \"instances\": [ {\n  \"tag\": \"beach\",\n  \"image\": [  [   [138, 30, 66],\n   [130, 20, 56],\n   ...\n  ],\n  [   [126, 38, 61],\n   [122, 24, 57],\n   ...\n  ],\n  ...\n  ]\n },\n {\n  \"tag\": \"car\",\n  \"image\": [  [   [255, 0, 102],\n   [255, 0, 97],\n   ...\n  ],\n  [   [254, 1, 101],\n   [254, 2, 93],\n   ...\n  ],\n  ...\n  ]\n },\n ...\n ]\n}\n```\n\u8acb\u6c42\u6b63\u6587\u5305\u542b\u7684\u6578\u64da\u63a1\u7528\u4ee5\u4e0b\u7d50\u69cb\uff08JSON \u8868\u793a\u6cd5\uff09\uff1a\n```\n{\u00a0 \"instances\": [\u00a0 \u00a0 <simple list>,\u00a0 \u00a0 ...\u00a0 ]}\n```\n`instances[]` \u662f\u5fc5\u9700\u5c0d\u8c61\uff0c\u800c\u4e14\u5fc5\u9808\u5305\u542b\u5f85\u9810\u6e2c\u5be6\u4f8b\u7684\u5217\u8868\u3002\u5728\u4ee5\u4e0b\u793a\u4f8b\u4e2d\uff0c\u6bcf\u500b\u8f38\u5165\u5be6\u4f8b\u90fd\u662f\u4e00\u500b\u6d6e\u9ede\u6578\u5217\u8868\uff1a\n```\n{\u00a0 \"instances\": [\u00a0 \u00a0 [0.0, 1.1, 2.2],\u00a0 \u00a0 [3.3, 4.4, 5.5],\u00a0 \u00a0 ...\u00a0 ]}\n```\n\u8f38\u5165\u5be6\u4f8b\u7684\u7dad\u5ea6\u5fc5\u9808\u8207\u6a21\u578b\u6240\u671f\u671b\u7684\u7dad\u5ea6\u4e00\u81f4\u3002\u4f8b\u5982\uff0c\u5982\u679c\u6a21\u578b\u9700\u8981\u4e09\u500b\u7279\u5fb5\uff0c\u5247\u6bcf\u500b\u8f38\u5165\u5be6\u4f8b\u7684\u9577\u5ea6\u5fc5\u9808\u7232 3\u3002\n\u8acb\u6c42\u6b63\u6587\u5305\u542b\u7684\u6578\u64da\u63a1\u7528\u4ee5\u4e0b\u7d50\u69cb\uff08JSON \u8868\u793a\u6cd5\uff09\uff1a\n```\n{\u00a0 \"instances\": [\u00a0 \u00a0 <simple list>,\u00a0 \u00a0 ...\u00a0 ]}\n```\n`instances[]` \u662f\u5fc5\u9700\u5c0d\u8c61\uff0c\u800c\u4e14\u5fc5\u9808\u5305\u542b\u5f85\u9810\u6e2c\u5be6\u4f8b\u7684\u5217\u8868\u3002\u5728\u4ee5\u4e0b\u793a\u4f8b\u4e2d\uff0c\u6bcf\u500b\u8f38\u5165\u5be6\u4f8b\u90fd\u662f\u4e00\u500b\u6d6e\u9ede\u6578\u5217\u8868\uff1a\n```\n{\u00a0 \"instances\": [\u00a0 \u00a0 [0.0, 1.1, 2.2],\u00a0 \u00a0 [3.3, 4.4, 5.5],\u00a0 \u00a0 ...\u00a0 ]}\n```\n\u8f38\u5165\u5be6\u4f8b\u7684\u7dad\u5ea6\u5fc5\u9808\u8207\u6a21\u578b\u6240\u671f\u671b\u7684\u7dad\u5ea6\u4e00\u81f4\u3002\u4f8b\u5982\uff0c\u5982\u679c\u6a21\u578b\u9700\u8981\u4e09\u500b\u7279\u5fb5\uff0c\u5247\u6bcf\u500b\u8f38\u5165\u5be6\u4f8b\u7684\u9577\u5ea6\u5fc5\u9808\u7232 3\u3002\n\u5c0d\u65bc XGBoost \u7684\u8f38\u5165\u5be6\u4f8b\uff0cVertex AI \u4e0d\u652f\u6301\u7a00\u758f\u8868\u793a\u6cd5\u3002\n\u5728\u7dda\u9810\u6e2c\u670d\u52d9\u4ee5\u4e0d\u540c\u65b9\u5f0f\u89e3\u6790\u96f6\u548c `NaN` \u3002\u5982\u679c\u7279\u5fb5\u503c\u7232\u96f6\uff0c\u8acb\u4f7f\u7528 `0.0` \u4f5c\u7232\u76f8\u61c9\u7684\u8f38\u5165\u3002\u5982\u679c\u7f3a\u5c11\u7279\u5fb5\u503c\uff0c\u8acb\u4f7f\u7528 `\"NaN\"` \u4f5c\u7232\u76f8\u61c9\u7684\u8f38\u5165\u3002\n\u4ee5\u4e0b\u793a\u4f8b\u8868\u793a\u5177\u6709\u55ae\u500b\u8f38\u5165\u5be6\u4f8b\u7684\u9810\u6e2c\u8acb\u6c42\uff0c\u5176\u4e2d\u7b2c\u4e00\u500b\u7279\u5fb5\u7684\u503c\u662f 0.0\uff0c\u7b2c\u4e8c\u500b\u7279\u5fb5\u7684\u503c\u662f 1.1\uff0c\u7b2c\u4e09\u500b\u7279\u5fb5\u7684\u503c\u7f3a\u5931\uff1a\n```\n{\"instances\": [[0.0, 1.1, \"NaN\"]]}\n```\n\u5982\u679c\u60a8\u7684\u6a21\u578b\u4f7f\u7528 [PyTorch \u9810\u69cb\u5efa\u5bb9\u5668](https://cloud.google.com/vertex-ai/docs/predictions/pre-built-containers?hl=zh-cn#pytorch) \uff0c\u5247 TorchServe \u7684\u9ed8\u8a8d\u8655\u7406\u7a0b\u5e8f\u9810\u671f\u5c07\u6bcf\u500b\u5be6\u4f8b\u5c01\u88dd\u5728 `data` \u5b57\u6bb5\u4e2d\u3002\u4f8b\u5982\uff1a\n```\n{\u00a0 \"instances\": [\u00a0 \u00a0 { \"data\": , <value> },\u00a0 \u00a0 { \"data\": , <value> }\u00a0 ]}\n```\n### \u97ff\u61c9\u6b63\u6587\u8a73\u60c5\n\u5982\u679c\u8abf\u7528\u6210\u529f\uff0c\u5247\u5c0d\u65bc\u8acb\u6c42\u6b63\u6587\u4e2d\u7684\u6bcf\u500b\u5be6\u4f8b\uff0c\u97ff\u61c9\u6b63\u6587\u90fd\u5305\u542b\u4e00\u500b\u9810\u6e2c\u689d\u76ee\uff0c\u4e26\u6309\u76f8\u540c\u9806\u5e8f\u5217\u51fa\uff1a\n```\n{\u00a0 \"predictions\": [\u00a0 \u00a0 {\u00a0 \u00a0 \u00a0 object\u00a0 \u00a0 }\u00a0 ],\u00a0 \"deployedModelId\": string}\n```\n\u5982\u6709\u4efb\u4f55\u5be6\u4f8b\u7684\u9810\u6e2c\u5931\u6557\uff0c\u5247\u97ff\u61c9\u6b63\u6587\u4e0d\u6703\u5305\u542b\u4efb\u4f55\u9810\u6e2c\u689d\u76ee\uff0c \u800c\u662f\u5305\u542b\u4e00\u500b\u932f\u8aa4\u689d\u76ee\uff1a\n```\n{\u00a0 \"error\": string}\n```\n`predictions[]` \u5c0d\u8c61\u5305\u542b\u9810\u6e2c\u7d50\u679c\u5217\u8868\uff0c\u5176\u4e2d\u6bcf\u500b\u9810\u6e2c\u7d50\u679c\u5c0d\u61c9\u8acb\u6c42\u4e2d\u7684\u4e00\u500b\u5be6\u4f8b\u3002\n\u5982\u679c\u767c\u751f\u932f\u8aa4\uff0c `error` \u5b57\u7b26\u4e32\u6703\u5305\u542b\u4e00\u689d\u63cf\u8ff0\u554f\u984c\u7684\u6d88\u606f\u3002\u5982\u679c\u5728\u8655\u7406\u4efb\u4f55\u5be6\u4f8b\u6642\u767c\u751f\u932f\u8aa4\uff0c\u5247\u7cfb\u7d71\u6703\u8fd4\u56de\u932f\u8aa4\uff0c\u800c\u975e\u9810\u6e2c\u7d50\u679c\u5217\u8868\u3002\n\u5373\u4f7f\u6bcf\u500b\u5be6\u4f8b\u53ea\u6709\u4e00\u500b\u9810\u6e2c\u7d50\u679c\uff0c\u9810\u6e2c\u7d50\u679c\u7684\u683c\u5f0f\u4e5f\u8207\u5be6\u4f8b\u7684\u683c\u5f0f\u6c92\u6709\u76f4\u63a5\u95dc\u806f\u3002\u9810\u6e2c\u7d50\u679c\u7684\u683c\u5f0f\u662f\u7531\u6a21\u578b\u4e2d\u5b9a\u7fa9\u7684\u8f38\u51fa\u96c6\u5408\u6240\u6307\u5b9a\u3002\u9810\u6e2c\u7d50\u679c\u96c6\u5408\u6703\u4ee5 JSON \u5217\u8868\u7684\u5f62\u5f0f\u8fd4\u56de\u3002\u5217\u8868\u7684\u6bcf\u500b\u6210\u54e1\u53ef\u4ee5\u662f\u7c21\u55ae\u503c\u3001\u5217\u8868\u6216\u4efb\u4f55\u8907\u96dc\u5ea6\u7684 JSON \u5c0d\u8c61\u3002\u5982\u679c\u6a21\u578b\u5177\u6709\u591a\u500b\u8f38\u51fa\u5f35\u91cf\uff0c\u5247\u6bcf\u500b\u9810\u6e2c\u7d50\u679c\u5c07\u7232 JSON \u5c0d\u8c61\uff0c\u5176\u4e2d\u5305\u542b\u6bcf\u500b\u8f38\u51fa\u7684\u540d\u7a31/\u503c\u5c0d\u3002\u9019\u4e9b\u540d\u7a31\u53ef\u6a19\u8b58\u5716\u4e2d\u7684\u8f38\u51fa\u5225\u540d\u3002\n### \u97ff\u61c9\u6b63\u6587\u793a\u4f8b\n\u4ee5\u4e0b\u793a\u4f8b\u5c55\u793a\u4e86\u4e00\u4e9b\u53ef\u80fd\u7684\u97ff\u61c9\uff1a- \u4e09\u500b\u8f38\u5165\u5be6\u4f8b\u7684\u4e00\u7d44\u7c21\u55ae\u9810\u6e2c\u7d50\u679c\uff0c\u5176\u4e2d\u6bcf\u500b\u9810\u6e2c\u7d50\u679c\u5747\u7232\u4e00\u500b\u6574\u6578\u503c\uff1a```\n{\"predictions\":\n [5, 4, 3],\n \"deployedModelId\": 123456789012345678\n}\n```\n- \u4e00\u7d44\u8f03\u8907\u96dc\u7684\u9810\u6e2c\u7d50\u679c\uff0c\u5404\u5305\u542b\u5169\u500b\u8207\u8f38\u51fa\u5f35\u91cf\u76f8\u5c0d\u61c9\u7684\u547d\u540d\u503c\uff0c\u5206\u5225\u540d\u7232 `label` \u548c `scores` \u3002 `label` \u7684\u503c\u662f\u9810\u6e2c\u7684\u985e\u5225\uff08\u201ccar\u201d\u6216\u201cbeach\u201d\uff09\uff0c `scores` \u5305\u542b\u8a72\u5be6\u4f8b\u5728\u5404\u53ef\u80fd\u985e\u5225\u4e4b\u9593\u7684\u6982\u7387\u5217\u8868\u3002```\n{\n \"predictions\": [ {\n  \"label\": \"beach\",\n  \"scores\": [0.1, 0.9]\n },\n {\n  \"label\": \"car\",\n  \"scores\": [0.75, 0.25]\n }\n ],\n \"deployedModelId\": 123456789012345678\n}\n```\n- \u8655\u7406\u8f38\u5165\u5be6\u4f8b\u51fa\u932f\u6642\u7684\u97ff\u61c9\uff1a```\n{\"error\": \"Divide by zero\"}\n```\n\u4ee5\u4e0b\u793a\u4f8b\u5c55\u793a\u4e86\u4e00\u4e9b\u53ef\u80fd\u7684\u97ff\u61c9\uff1a- \u4e09\u500b\u8f38\u5165\u5be6\u4f8b\u7684\u4e00\u7d44\u7c21\u55ae\u9810\u6e2c\u7d50\u679c\uff0c\u5176\u4e2d\u6bcf\u500b\u9810\u6e2c\u7d50\u679c\u5747\u7232\u4e00\u500b\u6574\u6578\u503c\uff1a```\n{\"predictions\":\n [5, 4, 3],\n \"deployedModelId\": 123456789012345678\n}\n```\n- \u8655\u7406\u8f38\u5165\u5be6\u4f8b\u51fa\u932f\u6642\u7684\u97ff\u61c9\uff1a```\n{\"error\": \"Divide by zero\"}\n```\n\u4ee5\u4e0b\u793a\u4f8b\u5c55\u793a\u4e86\u4e00\u4e9b\u53ef\u80fd\u7684\u97ff\u61c9\uff1a- \u4e09\u500b\u8f38\u5165\u5be6\u4f8b\u7684\u4e00\u7d44\u7c21\u55ae\u9810\u6e2c\u7d50\u679c\uff0c\u5176\u4e2d\u6bcf\u500b\u9810\u6e2c\u7d50\u679c\u5747\u7232\u4e00\u500b\u6574\u6578\u503c\uff1a```\n{\"predictions\":\n [5, 4, 3],\n \"deployedModelId\": 123456789012345678\n}\n```\n- \u8655\u7406\u8f38\u5165\u5be6\u4f8b\u51fa\u932f\u6642\u7684\u97ff\u61c9\uff1a```\n{\"error\": \"Divide by zero\"}\n```## \u5411\u7aef\u9ede\u767c\u9001\u8acb\u6c42\n\u53ef\u901a\u904e\u4e09\u7a2e\u65b9\u5f0f\u4f86\u767c\u9001\u8acb\u6c42\uff1a\n- [\u9810\u6e2c\u7d50\u679c\u8acb\u6c42](#predict-request) \uff1a\u5411 [predict](https://cloud.google.com/vertex-ai/docs/reference/rest/v1/projects.locations.endpoints/predict?hl=zh-cn) \u767c\u9001\u8acb\u6c42\u4ee5\u7372\u53d6\u5728\u7dda\u9810\u6e2c\u7d50\u679c\u3002\n- [\u539f\u59cb\u9810\u6e2c\u7d50\u679c\u8acb\u6c42](#raw-predict-request) \uff1a\u5411 [rawPredict](https://cloud.google.com/vertex-ai/docs/reference/rest/v1/projects.locations.endpoints/rawPredict?hl=zh-cn) \u767c\u9001\u8acb\u6c42\uff0c\u4ee5\u4fbf\u4f7f\u7528\u4efb\u610f HTTP \u8f09\u8377\uff0c\u800c\u4e0d\u662f\u9075\u5faa\u672c\u9801\u9762\u7684 [\u8a2d\u7f6e\u8f38\u5165\u683c\u5f0f](#formatting-prediction-input) \u90e8\u5206\u4e2d\u6240\u8ff0\u7684\u6e96\u5247\u3002\u5728\u4ee5\u4e0b\u60c5\u6cc1\u4e0b\uff0c\u60a8\u53ef\u80fd\u9700\u8981\u7372\u53d6\u539f\u59cb\u9810\u6e2c\u7d50\u679c\uff1a- \u60a8 [\u4f7f\u7528\u7684\u662f\u81ea\u5b9a\u7fa9\u5bb9\u5668](https://cloud.google.com/vertex-ai/docs/predictions/use-custom-container?hl=zh-cn) \uff0c\u8a72\u5bb9\u5668\u63a5\u6536\u8acb\u6c42\u4f75\u767c\u9001\u8207\u6e96\u5247\u4e0d\u540c\u7684\u97ff\u61c9\u3002\n- \u9700\u8981\u66f4\u4f4e\u5ef6\u9072\u3002`rawPredict`\u6703\u8df3\u904e\u5e8f\u5217\u5316\u6b65\u9a5f\u4e26\u76f4\u63a5\u5c07\u8acb\u6c42\u8f49\u767c\u5230\u9810\u6e2c\u5bb9\u5668\u3002\n- \u60a8\u6b63\u5728\u4f7f\u7528 [NVIDIA Triton](https://cloud.google.com/vertex-ai/docs/predictions/using-nvidia-triton?hl=zh-cn) \u57f7\u884c\u9810\u6e2c\u3002\n- [\u8aaa\u660e\u8acb\u6c42](#explain-request) \uff1a\u5411 [explain](https://cloud.google.com/vertex-ai/docs/reference/rest/v1/projects.locations.endpoints/explain?hl=zh-cn) \u767c\u9001\u8acb\u6c42\u3002\u5982\u679c\u60a8\u5df2 [\u91dd\u5c0d Vertex Explainable AI \u914d\u7f6e Model](https://cloud.google.com/vertex-ai/docs/explainable-ai/configuring-explanations-feature-based?hl=zh-cn) \uff0c\u5247\u53ef\u4ee5 [\u7372\u53d6\u5728\u7dda\u8aaa\u660e](https://cloud.google.com/vertex-ai/docs/explainable-ai/getting-explanations?hl=zh-cn) \u3002 \u5728\u7dda\u8aaa\u660e\u8acb\u6c42\u7684\u683c\u5f0f\u8207\u5728\u7dda\u9810\u6e2c\u8acb\u6c42\u7684\u683c\u5f0f\u76f8\u540c\uff0c\u5b83\u5011\u8fd4\u56de\u985e\u4f3c\u7684\u97ff\u61c9\uff0c\u552f\u4e00\u7684\u5340\u5225\u5728\u65bc\u5728\u7dda\u8aaa\u660e\u97ff\u61c9\u5305\u542b\u7279\u5fb5\u6b78\u56e0\u548c\u9810\u6e2c\u7d50\u679c\u3002\n**\u6ce8\u610f** \uff1a\u516c\u5171\u7aef\u9ede\u548c\u5c08\u7528\u7aef\u9ede\u7684\u8acb\u6c42\u5728 60 \u79d2\u5f8c\u8d85\u6642\u3002 \u5982\u679c\u60a8\u9700\u8981\u8d85\u904e 60 \u79d2\u7684\u8d85\u6642\u6642\u9593\uff0c\u8acb\u63d0\u4ea4\u652f\u6301\u670d\u52d9\u5de5\u55ae\u6216\u806f\u7e6b\u60a8\u7684 Google Cloud \u4ee3\u8868\u3002\n**\u6ce8\u610f** \uff1a\u5982\u679c\u5c07\u6a21\u578b\u90e8\u7f72\u5230\u516c\u5171\u7aef\u9ede\uff0c\u5247\u6bcf\u500b\u9810\u6e2c\u8acb\u6c42\u4e0d\u5f97\u8d85\u904e 1.5 MB\u3002\u5982\u679c\u60a8\u7684\u8acb\u6c42\u8f03\u5927\uff0c\u53ef\u4ee5\u5617\u8a66\u4ee5\u4e0b\u64cd\u4f5c\uff1a- \u4f7f\u7528 [\u5c08\u7528\u7aef\u9ede](https://cloud.google.com/vertex-ai/docs/predictions/using-private-endpoints?hl=zh-cn) \uff0c\u8a72\u7aef\u9ede\u4e0d\u6703\u65bd\u52a0 1.5 MB \u7684\u9650\u5236\u4e26\u4e14\u63d0\u4f9b\u66f4\u4f4e\u7684\u5ef6\u9072\u3002\n- \u5728\u5c07\u8acb\u6c42\u767c\u9001\u5230\u9810\u6e2c\u670d\u52d9\u5668\u4e4b\u524d\uff0c\u5728\u5ba2\u6236\u7aef\u4e0a\u5c07\u6578\u64da\u7de8\u78bc\u3001\u8abf\u6574\u548c/\u6216\u58d3\u7e2e\u7232\u8f03\u5c0f\u7684\u683c\u5f0f\u3002\u7136\u5f8c\uff0c\u4f7f\u7528 [\u9810\u8655\u7406\u51fd\u6578](https://cloud.google.com/blog/topics/developers-practitioners/add-preprocessing-functions-tensorflow-models-and-deploy-vertex-ai?hl=zh-cn) \u6216 [\u81ea\u5b9a\u7fa9\u9810\u6e2c\u4f8b\u7a0b](https://cloud.google.com/vertex-ai/docs/predictions/custom-prediction-routines?hl=zh-cn#write_custom_predictor) \u89e3\u78bc\u9810\u6e2c\u670d\u52d9\u5668\u4e0a\u7684\u6578\u64da\u3002   \u4f8b\u5982\uff0c\u60a8\u53ef\u4ee5\u57f7\u884c\u4ee5\u4e0b\u64cd\u4f5c\uff1a\n- \u5c07\u6d6e\u9ede\u6578\u8f49\u63db\u7232 base64 \u7de8\u78bc\u7684\u5b57\u7bc0\u6578\u7d44\uff0c\u800c\u4e0d\u662f\u4f5c\u7232\u5b57\u7b26\u4e32\u767c\u9001\u3002\n- \u5c07\u5716\u7247\u58d3\u7e2e\u7232 JPEG \u6216 PNG \u683c\u5f0f\uff0c\u800c\u4e0d\u662f\u767c\u9001\u672a\u58d3\u7e2e\u7684\u5716\u7247\u3002\n- \u5c07\u5927\u5716\u7247\u8abf\u6574\u5927\u5c0f\u5f8c\u518d\u767c\u9001\u5230\u9810\u6e2c\u670d\u52d9\u5668\u3002\n### \u767c\u9001\u5728\u7dda\u9810\u6e2c\u8acb\u6c42\n\u4ee5\u4e0b\u793a\u4f8b\u4f7f\u7528 [gcloud ai endpoints predict \u547d\u4ee4](https://cloud.google.com/sdk/gcloud/reference/ai/endpoints/predict?hl=zh-cn) \uff1a- \u5c07\u4ee5\u4e0b JSON \u5c0d\u8c61\u5beb\u5165\u672c\u5730\u74b0\u5883\u4e2d\u7684\u6587\u4ef6\u3002\u6587\u4ef6\u540d\u7121\u95dc\u7dca\u8981\uff0c\u4f46\u5728\u672c\u793a\u4f8b\u4e2d\uff0c\u8acb\u5c07\u6587\u4ef6\u547d\u540d\u7232 `request.json` \u3002```\n{\u00a0\"instances\": INSTANCES}\n```\u8acb\u66ff\u63db\u4ee5\u4e0b\u5167\u5bb9\uff1a- \uff1a\u8981\u7232\u5176\u7372\u53d6\u9810\u6e2c\u7684\u5be6\u4f8b\u7684 JSON \u6578\u7d44\u3002\u6bcf\u500b\u5be6\u4f8b\u7684\u683c\u5f0f\u53d6\u6c7a\u65bc\u7d93\u904e\u8a13\u7df4\u7684\u6a5f\u5668\u5b78\u7fd2\u6a21\u578b\u9700\u8981\u7684\u8f38\u5165\u3002\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [\u683c\u5f0f\u5316\u8f38\u5165\u4ee5\u9032\u884c\u5728\u7dda\u9810\u6e2c](#formatting-prediction-input) \u3002\n- \u904b\u884c\u4ee5\u4e0b\u547d\u4ee4\uff1a```\ngcloud ai endpoints predict ENDPOINT_ID \\\u00a0 --region=LOCATION_ID \\\u00a0 --json-request=request.json\n```\u66ff\u63db\u4ee5\u4e0b\u5167\u5bb9\uff1a- \uff1a\u7aef\u9ede\u7684 ID\u3002\n- \uff1a\u60a8\u5728\u5176\u4e2d\u4f7f\u7528 Vertex AI \u7684\u5340\u57df\u3002\u5728\u4f7f\u7528\u4efb\u4f55\u8acb\u6c42\u6578\u64da\u4e4b\u524d\uff0c\u8acb\u5148\u9032\u884c\u4ee5\u4e0b\u66ff\u63db\uff1a- \uff1a\u60a8\u5728\u5176\u4e2d\u4f7f\u7528 Vertex AI \u7684\u5340\u57df\u3002\n- \uff1a\u60a8\u7684 [\u9805\u76ee ID](https://cloud.google.com/resource-manager/docs/creating-managing-projects?hl=zh-cn#identifiers) \n- \uff1a\u7aef\u9ede\u7684 ID\u3002\n- \uff1a\u8981\u7232\u5176\u7372\u53d6\u9810\u6e2c\u7684\u5be6\u4f8b\u7684 JSON \u6578\u7d44\u3002\u6bcf\u500b\u5be6\u4f8b\u7684\u683c\u5f0f\u53d6\u6c7a\u65bc\u7d93\u904e\u8a13\u7df4\u7684\u6a5f\u5668\u5b78\u7fd2\u6a21\u578b\u9700\u8981\u7684\u8f38\u5165\u3002\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [\u683c\u5f0f\u5316\u8f38\u5165\u4ee5\u9032\u884c\u5728\u7dda\u9810\u6e2c](#formatting-prediction-input) \u3002\nHTTP \u65b9\u6cd5\u548c\u7db2\u5740\uff1a\n```\nPOST https://LOCATION_ID-aiplatform.googleapis.com/v1/projects/PROJECT_ID/locations/LOCATION_ID/endpoints/ENDPOINT_ID:predict\n```\n\u8acb\u6c42 JSON \u6b63\u6587\uff1a\n```\n{\n \"instances\": INSTANCES\n}\n```\n\u5982\u9700\u767c\u9001\u8acb\u6c42\uff0c\u8acb\u9078\u64c7\u4ee5\u4e0b\u65b9\u5f0f\u4e4b\u4e00\uff1a\n **\u6ce8\u610f** \uff1a\u4ee5\u4e0b\u547d\u4ee4\u5047\u5b9a\u60a8\u5df2\u4f7f\u7528\u60a8\u7684\u7528\u6236\u8cec\u865f\u901a\u904e\u904b\u884c [gcloud init](https://cloud.google.com/sdk/gcloud/reference/init?hl=zh-cn) \u6216 [gcloud auth login](https://cloud.google.com/sdk/gcloud/reference/auth/login?hl=zh-cn) \u767b\u9304`gcloud`CLI\uff0c\u6216\u8005\u4f7f\u7528\u4e86 [Cloud Shell](https://cloud.google.com/shell/docs?hl=zh-cn) \uff0c\u9019\u6703\u4f7f\u60a8\u81ea\u52d5\u767b\u9304`gcloud`CLI\u3002\u60a8\u53ef\u4ee5\u904b\u884c [gcloud auth list](https://cloud.google.com/sdk/gcloud/reference/auth/list?hl=zh-cn) \u4f86\u6aa2\u67e5\u7576\u524d\u6d3b\u8e8d\u7684\u8cec\u865f\u3002\n\u5c07\u8acb\u6c42\u6b63\u6587\u4fdd\u5b58\u5728\u540d\u7232 `request.json` \u7684\u6587\u4ef6\u4e2d\uff0c\u7136\u5f8c\u57f7\u884c\u4ee5\u4e0b\u547d\u4ee4\uff1a\n```\ncurl -X POST \\ -H \"Authorization: Bearer $(gcloud auth print-access-token)\" \\ -H \"Content-Type: application/json; charset=utf-8\" \\ -d @request.json \\ \"https://LOCATION_ID-aiplatform.googleapis.com/v1/projects/PROJECT_ID/locations/LOCATION_ID/endpoints/ENDPOINT_ID:predict\"\n``` **\u6ce8\u610f** \uff1a\u4ee5\u4e0b\u547d\u4ee4\u5047\u5b9a\u60a8\u5df2\u4f7f\u7528\u60a8\u7684\u7528\u6236\u8cec\u865f\u901a\u904e\u904b\u884c [gcloud init](https://cloud.google.com/sdk/gcloud/reference/init?hl=zh-cn) \u6216 [gcloud auth login](https://cloud.google.com/sdk/gcloud/reference/auth/login?hl=zh-cn) \u767b\u9304`gcloud`CLI\uff0c\u6216\u8005\u4f7f\u7528\u4e86 [Cloud Shell](https://cloud.google.com/shell/docs?hl=zh-cn) \uff0c\u9019\u6703\u4f7f\u60a8\u81ea\u52d5\u767b\u9304`gcloud`CLI\u3002\u60a8\u53ef\u4ee5\u904b\u884c [gcloud auth list](https://cloud.google.com/sdk/gcloud/reference/auth/list?hl=zh-cn) \u4f86\u6aa2\u67e5\u7576\u524d\u6d3b\u8e8d\u7684\u8cec\u865f\u3002\n\u5c07\u8acb\u6c42\u6b63\u6587\u4fdd\u5b58\u5728\u540d\u7232 `request.json` \u7684\u6587\u4ef6\u4e2d\uff0c\u7136\u5f8c\u57f7\u884c\u4ee5\u4e0b\u547d\u4ee4\uff1a\n```\n$cred = gcloud auth print-access-token$headers = @{ \"Authorization\" = \"Bearer $cred\" }Invoke-WebRequest ` -Method POST ` -Headers $headers ` -ContentType: \"application/json; charset=utf-8\" ` -InFile request.json ` -Uri \"https://LOCATION_ID-aiplatform.googleapis.com/v1/projects/PROJECT_ID/locations/LOCATION_ID/endpoints/ENDPOINT_ID:predict\" | Select-Object -Expand Content\n```\u5982\u679c\u6210\u529f\uff0c\u60a8\u6703\u6536\u5230\u5982\u4e0b\u6240\u793a\u7684 JSON \u97ff\u61c9\u3002\u5728\u97ff\u61c9\u4e2d\uff0c\u60a8\u6703\u770b\u5230\u4ee5\u4e0b\u66ff\u63db\uff1a\n- \uff1a\u9810\u6e2c\u7d50\u679c\u7684 JSON \u6578\u7d44\uff0c\u5176\u4e2d\u6bcf\u500b\u9810\u6e2c\u7d50\u679c\u5c0d\u61c9\u8acb\u6c42\u6b63\u6587\u4e2d\u5305\u542b\u7684\u4e00\u500b\u5be6\u4f8b\u3002\n- \uff1a\u57f7\u884c\u9810\u6e2c\u7684 [DeployedModel](https://cloud.google.com/vertex-ai/docs/reference/rest/v1/projects.locations.endpoints?hl=zh-cn#DeployedModel) \u7684 ID\u3002```\n{\n \"predictions\": PREDICTIONS,\n \"deployedModelId\": \"DEPLOYED_MODEL_ID\"\n}\n```\n\u5728\u5617\u8a66\u6b64\u793a\u4f8b\u4e4b\u524d\uff0c\u8acb\u6309\u7167 [\u300aVertex AI \u5feb\u901f\u5165\u9580\uff1a\u4f7f\u7528\u5ba2\u6236\u7aef\u5eab\u300b](https://cloud.google.com/vertex-ai/docs/start/client-libraries?hl=zh-cn) \u4e2d\u7684 Java \u8a2d\u7f6e\u8aaa\u660e\u57f7\u884c\u64cd\u4f5c\u3002\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [Vertex AI Java API \u53c3\u8003\u6587\u6a94](https://cloud.google.com/java/docs/reference/google-cloud-aiplatform/latest/com.google.cloud.aiplatform.v1?hl=zh-cn) \u3002\n\u5982\u9700\u5411 Vertex AI \u9032\u884c\u8eab\u4efd\u9a57\u8b49\uff0c\u8acb\u8a2d\u7f6e\u61c9\u7528\u9ed8\u8a8d\u6191\u64da\u3002  \u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [\u7232\u672c\u5730\u958b\u767c\u74b0\u5883\u8a2d\u7f6e\u8eab\u4efd\u9a57\u8b49](https://cloud.google.com/docs/authentication/provide-credentials-adc?hl=zh-cn#local-dev) \u3002\n [\u5728 GitHub \u4e0a\u67e5\u770b](https://github.com/GoogleCloudPlatform/java-docs-samples/blob/HEAD/aiplatform/src/main/java/aiplatform/PredictCustomTrainedModelSample.java) \n```\nimport com.google.cloud.aiplatform.v1.EndpointName;import com.google.cloud.aiplatform.v1.PredictRequest;import com.google.cloud.aiplatform.v1.PredictResponse;import com.google.cloud.aiplatform.v1.PredictionServiceClient;import com.google.cloud.aiplatform.v1.PredictionServiceSettings;import com.google.protobuf.ListValue;import com.google.protobuf.Value;import com.google.protobuf.util.JsonFormat;import java.io.IOException;import java.util.List;public class PredictCustomTrainedModelSample {\u00a0 public static void main(String[] args) throws IOException {\u00a0 \u00a0 // TODO(developer): Replace these variables before running the sample.\u00a0 \u00a0 String instance = \"[{ \u201cfeature_column_a\u201d: \u201cvalue\u201d, \u201cfeature_column_b\u201d: \u201cvalue\u201d}]\";\u00a0 \u00a0 String project = \"YOUR_PROJECT_ID\";\u00a0 \u00a0 String endpointId = \"YOUR_ENDPOINT_ID\";\u00a0 \u00a0 predictCustomTrainedModel(project, endpointId, instance);\u00a0 }\u00a0 static void predictCustomTrainedModel(String project, String endpointId, String instance)\u00a0 \u00a0 \u00a0 throws IOException {\u00a0 \u00a0 PredictionServiceSettings predictionServiceSettings =\u00a0 \u00a0 \u00a0 \u00a0 PredictionServiceSettings.newBuilder()\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 .setEndpoint(\"us-central1-aiplatform.googleapis.com:443\")\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 .build();\u00a0 \u00a0 // Initialize client that will be used to send requests. This client only needs to be created\u00a0 \u00a0 // once, and can be reused for multiple requests. After completing all of your requests, call\u00a0 \u00a0 // the \"close\" method on the client to safely clean up any remaining background resources.\u00a0 \u00a0 try (PredictionServiceClient predictionServiceClient =\u00a0 \u00a0 \u00a0 \u00a0 PredictionServiceClient.create(predictionServiceSettings)) {\u00a0 \u00a0 \u00a0 String location = \"us-central1\";\u00a0 \u00a0 \u00a0 EndpointName endpointName = EndpointName.of(project, location, endpointId);\u00a0 \u00a0 \u00a0 ListValue.Builder listValue = ListValue.newBuilder();\u00a0 \u00a0 \u00a0 JsonFormat.parser().merge(instance, listValue);\u00a0 \u00a0 \u00a0 List<Value> instanceList = listValue.getValuesList();\u00a0 \u00a0 \u00a0 PredictRequest predictRequest =\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 PredictRequest.newBuilder()\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 .setEndpoint(endpointName.toString())\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 .addAllInstances(instanceList)\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 .build();\u00a0 \u00a0 \u00a0 PredictResponse predictResponse = predictionServiceClient.predict(predictRequest);\u00a0 \u00a0 \u00a0 System.out.println(\"Predict Custom Trained model Response\");\u00a0 \u00a0 \u00a0 System.out.format(\"\\tDeployed Model Id: %s\\n\", predictResponse.getDeployedModelId());\u00a0 \u00a0 \u00a0 System.out.println(\"Predictions\");\u00a0 \u00a0 \u00a0 for (Value prediction : predictResponse.getPredictionsList()) {\u00a0 \u00a0 \u00a0 \u00a0 System.out.format(\"\\tPrediction: %s\\n\", prediction);\u00a0 \u00a0 \u00a0 }\u00a0 \u00a0 }\u00a0 }}\n```\u5728\u5617\u8a66\u6b64\u793a\u4f8b\u4e4b\u524d\uff0c\u8acb\u6309\u7167 [\u300aVertex AI \u5feb\u901f\u5165\u9580\uff1a\u4f7f\u7528\u5ba2\u6236\u7aef\u5eab\u300b](https://cloud.google.com/vertex-ai/docs/start/client-libraries?hl=zh-cn) \u4e2d\u7684 Node.js \u8a2d\u7f6e\u8aaa\u660e\u57f7\u884c\u64cd\u4f5c\u3002\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [Vertex AI Node.js API \u53c3\u8003\u6587\u6a94](https://cloud.google.com/nodejs/docs/reference/aiplatform/latest?hl=zh-cn) \u3002\n\u5982\u9700\u5411 Vertex AI \u9032\u884c\u8eab\u4efd\u9a57\u8b49\uff0c\u8acb\u8a2d\u7f6e\u61c9\u7528\u9ed8\u8a8d\u6191\u64da\u3002  \u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [\u7232\u672c\u5730\u958b\u767c\u74b0\u5883\u8a2d\u7f6e\u8eab\u4efd\u9a57\u8b49](https://cloud.google.com/docs/authentication/provide-credentials-adc?hl=zh-cn#local-dev) \u3002\n [\u5728 GitHub \u4e0a\u67e5\u770b](https://github.com/GoogleCloudPlatform/nodejs-docs-samples/blob/HEAD/ai-platform/snippets/predict-custom-trained-model.js) \n```\n/**\u00a0* TODO(developer): Uncomment these variables before running the sample.\\\u00a0* (Not necessary if passing values as arguments)\u00a0*/// const filename = \"YOUR_PREDICTION_FILE_NAME\";// const endpointId = \"YOUR_ENDPOINT_ID\";// const project = 'YOUR_PROJECT_ID';// const location = 'YOUR_PROJECT_LOCATION';const util = require('util');const {readFile} = require('fs');const readFileAsync = util.promisify(readFile);// Imports the Google Cloud Prediction Service Client libraryconst {PredictionServiceClient} = require('@google-cloud/aiplatform');// Specifies the location of the api endpointconst clientOptions = {\u00a0 apiEndpoint: 'us-central1-aiplatform.googleapis.com',};// Instantiates a clientconst predictionServiceClient = new PredictionServiceClient(clientOptions);async function predictCustomTrainedModel() {\u00a0 // Configure the parent resource\u00a0 const endpoint = `projects/${project}/locations/${location}/endpoints/${endpointId}`;\u00a0 const parameters = {\u00a0 \u00a0 structValue: {\u00a0 \u00a0 \u00a0 fields: {},\u00a0 \u00a0 },\u00a0 };\u00a0 const instanceDict = await readFileAsync(filename, 'utf8');\u00a0 const instanceValue = JSON.parse(instanceDict);\u00a0 const instance = {\u00a0 \u00a0 structValue: {\u00a0 \u00a0 \u00a0 fields: {\u00a0 \u00a0 \u00a0 \u00a0 Age: {stringValue: instanceValue['Age']},\u00a0 \u00a0 \u00a0 \u00a0 Balance: {stringValue: instanceValue['Balance']},\u00a0 \u00a0 \u00a0 \u00a0 Campaign: {stringValue: instanceValue['Campaign']},\u00a0 \u00a0 \u00a0 \u00a0 Contact: {stringValue: instanceValue['Contact']},\u00a0 \u00a0 \u00a0 \u00a0 Day: {stringValue: instanceValue['Day']},\u00a0 \u00a0 \u00a0 \u00a0 Default: {stringValue: instanceValue['Default']},\u00a0 \u00a0 \u00a0 \u00a0 Deposit: {stringValue: instanceValue['Deposit']},\u00a0 \u00a0 \u00a0 \u00a0 Duration: {stringValue: instanceValue['Duration']},\u00a0 \u00a0 \u00a0 \u00a0 Housing: {stringValue: instanceValue['Housing']},\u00a0 \u00a0 \u00a0 \u00a0 Job: {stringValue: instanceValue['Job']},\u00a0 \u00a0 \u00a0 \u00a0 Loan: {stringValue: instanceValue['Loan']},\u00a0 \u00a0 \u00a0 \u00a0 MaritalStatus: {stringValue: instanceValue['MaritalStatus']},\u00a0 \u00a0 \u00a0 \u00a0 Month: {stringValue: instanceValue['Month']},\u00a0 \u00a0 \u00a0 \u00a0 PDays: {stringValue: instanceValue['PDays']},\u00a0 \u00a0 \u00a0 \u00a0 POutcome: {stringValue: instanceValue['POutcome']},\u00a0 \u00a0 \u00a0 \u00a0 Previous: {stringValue: instanceValue['Previous']},\u00a0 \u00a0 \u00a0 },\u00a0 \u00a0 },\u00a0 };\u00a0 const instances = [instance];\u00a0 const request = {\u00a0 \u00a0 endpoint,\u00a0 \u00a0 instances,\u00a0 \u00a0 parameters,\u00a0 };\u00a0 // Predict request\u00a0 const [response] = await predictionServiceClient.predict(request);\u00a0 console.log('Predict custom trained model response');\u00a0 console.log(`\\tDeployed model id : ${response.deployedModelId}`);\u00a0 const predictions = response.predictions;\u00a0 console.log('\\tPredictions :');\u00a0 for (const prediction of predictions) {\u00a0 \u00a0 console.log(`\\t\\tPrediction : ${JSON.stringify(prediction)}`);\u00a0 }}predictCustomTrainedModel();\n```\u5982\u9700\u77ad\u89e3\u5982\u4f55\u5b89\u88dd\u6216\u66f4\u65b0 Python\uff0c\u8acb\u53c3\u95b1 [\u5b89\u88dd Python \u7248 Vertex AI SDK](https://cloud.google.com/vertex-ai/docs/start/use-vertex-ai-python-sdk?hl=zh-cn) \u3002  \u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [   Python API \u53c3\u8003\u6587\u6a94](https://cloud.google.com/python/docs/reference/aiplatform/latest?hl=zh-cn) \u3002\n [\u5728 GitHub \u4e0a\u67e5\u770b](https://github.com/googleapis/python-aiplatform/blob/HEAD/samples/model-builder/endpoint_predict_sample.py) \n```\ndef endpoint_predict_sample(\u00a0 \u00a0 project: str, location: str, instances: list, endpoint: str):\u00a0 \u00a0 aiplatform.init(project=project, location=location)\u00a0 \u00a0 endpoint = aiplatform.Endpoint(endpoint)\u00a0 \u00a0 prediction = endpoint.predict(instances=instances)\u00a0 \u00a0 print(prediction)\u00a0 \u00a0 return prediction\n```\n### \u767c\u9001\u5728\u7dda\u539f\u59cb\u9810\u6e2c\u7d50\u679c\u8acb\u6c42\n\u4ee5\u4e0b\u793a\u4f8b\u4f7f\u7528 [gcloud ai endpoints raw-predict \u547d\u4ee4](https://cloud.google.com/sdk/gcloud/reference/ai/endpoints/raw-predict?hl=zh-cn) \uff1a- \u5982\u9700\u4f7f\u7528\u547d\u4ee4\u884c\u4e2d\u6307\u5b9a\u7684\u4e2d\u7684 JSON \u5c0d\u8c61\u8acb\u6c42\u9810\u6e2c\uff0c\u8acb\u57f7\u884c\u4ee5\u4e0b\u64cd\u4f5c\uff1a```\n\u00a0gcloud ai endpoints raw-predict ENDPOINT_ID \u00a0--region=LOCATION \u00a0--request REQUEST\u00a0\n```\n- \u5982\u9700\u8acb\u6c42\u4f7f\u7528\u5b58\u5132\u5728\u6587\u4ef6 \u548c\u76f8\u61c9 `Content-Type` \u6a19\u982d\u4e2d\u7684\u5716\u7247\u9032\u884c\u9810\u6e2c\uff0c\u8acb\u57f7\u884c\u4ee5\u4e0b\u64cd\u4f5c\uff1a```\n\u00a0gcloud ai endpoints raw-predict ENDPOINT_ID \u00a0--region=LOCATION \u00a0--http-headers=Content-Type=image/jpeg \u00a0--request @image.jpeg\u00a0\n```\u66ff\u63db\u4ee5\u4e0b\u5167\u5bb9\uff1a- \uff1a\u7aef\u9ede\u7684 ID\u3002\n- \uff1a\u60a8\u5728\u5176\u4e2d\u4f7f\u7528 Vertex AI \u7684\u5340\u57df\u3002\n- \uff1a\u8981\u7372\u53d6\u9810\u6e2c\u7d50\u679c\u7684\u8acb\u6c42\u7684\u5167\u5bb9\u3002\u8acb\u6c42\u7684\u683c\u5f0f\u53d6\u6c7a\u65bc\u60a8\u7684\u81ea\u5b9a\u7fa9\u5bb9\u5668\u7684\u9810\u671f\uff0c\u9019\u4e0d\u4e00\u5b9a\u662f JSON \u5c0d\u8c61\u3002\n\u5982\u9700\u77ad\u89e3\u5982\u4f55\u5b89\u88dd\u6216\u66f4\u65b0 Python\uff0c\u8acb\u53c3\u95b1 [\u5b89\u88dd Python \u7248 Vertex AI SDK](https://cloud.google.com/vertex-ai/docs/start/use-vertex-ai-python-sdk?hl=zh-cn) \u3002  \u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [   Python API \u53c3\u8003\u6587\u6a94](https://cloud.google.com/python/docs/reference/aiplatform/latest?hl=zh-cn) \u3002\n [\u5728 GitHub \u4e0a\u67e5\u770b](https://github.com/googleapis/python-aiplatform/blob/HEAD/samples/generated_samples/aiplatform_generated_aiplatform_v1_prediction_service_raw_predict_sync.py) \n```\n# -*- coding: utf-8 -*-# Copyright 2020 Google LLC\n## Licensed under the Apache License, Version 2.0 (the \"License\");# you may not use this file except in compliance with the License.# You may obtain a copy of the License at\n## \u00a0 \u00a0 http://www.apache.org/licenses/LICENSE-2.0\n## Unless required by applicable law or agreed to in writing, software# distributed under the License is distributed on an \"AS IS\" BASIS,# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.# See the License for the specific language governing permissions and# limitations under the License.\n## Generated code. DO NOT EDIT!\n## Snippet for RawPredict# NOTE: This snippet has been automatically generated for illustrative purposes only.# It may require modifications to work in your environment.# To install the latest published package dependency, execute the following:# \u00a0 python3 -m pip install google-cloud-aiplatformfrom google.cloud import aiplatform_v1def sample_raw_predict():\u00a0 \u00a0 # Create a client\u00a0 \u00a0 client = aiplatform_v1.PredictionServiceClient()\u00a0 \u00a0 # Initialize request argument(s)\u00a0 \u00a0 request = aiplatform_v1.RawPredictRequest(\u00a0 \u00a0 \u00a0 \u00a0 endpoint=\"endpoint_value\",\u00a0 \u00a0 )\u00a0 \u00a0 # Make the request\u00a0 \u00a0 response = client.raw_predict(request=request)\u00a0 \u00a0 # Handle the response\u00a0 \u00a0 print(response)\n```\n\u97ff\u61c9\u5305\u62ec\u4ee5\u4e0b HTTP \u6a19\u982d\uff1a\n- `X-Vertex-AI-Endpoint-Id` \uff1a\u63d0\u4f9b\u6b64\u9810\u6e2c\u7684 `Endpoint` \u7684 ID\u3002\n- `X-Vertex-AI-Deployed-Model-Id` \uff1a\u63d0\u4f9b\u6b64\u9810\u6e2c\u7684\u7aef\u9ede\u7684 `DeployedModel` \u7684 ID\u3002\n**\u6ce8\u610f** \uff1a\u5982\u679c\u60a8\u7684\u5bb9\u5668\u6536\u5230\u8acb\u6c42\u6216\u767c\u9001\u8207\u8a72\u6307\u5357\u4e0d\u540c\u7684\u97ff\u61c9\uff0c\u5247\u8a72\u5bb9\u5668\u8207 [Vertex Explainable AI](https://cloud.google.com/vertex-ai/docs/explainable-ai/overview?hl=zh-cn) \u6216 [Vertex AI Model Monitoring](https://cloud.google.com/vertex-ai/docs/model-monitoring/overview?hl=zh-cn) \u4e0d\u517c\u5bb9\u3002\n### \u767c\u9001\u5728\u7dda\u8aaa\u660e\u8acb\u6c42\n\u4ee5\u4e0b\u793a\u4f8b\u4f7f\u7528 [gcloud ai endpoints explain \u547d\u4ee4](https://cloud.google.com/sdk/gcloud/reference/ai/endpoints/explain?hl=zh-cn) \uff1a- \u5c07\u4ee5\u4e0b JSON \u5c0d\u8c61\u5beb\u5165\u672c\u5730\u74b0\u5883\u4e2d\u7684\u6587\u4ef6\u3002\u6587\u4ef6\u540d\u7121\u95dc\u7dca\u8981\uff0c\u4f46\u5728\u672c\u793a\u4f8b\u4e2d\uff0c\u8acb\u5c07\u6587\u4ef6\u547d\u540d\u7232 `request.json` \u3002```\n{\u00a0\"instances\": INSTANCES}\n```\u8acb\u66ff\u63db\u4ee5\u4e0b\u5167\u5bb9\uff1a- \uff1a\u8981\u7232\u5176\u7372\u53d6\u9810\u6e2c\u7684\u5be6\u4f8b\u7684 JSON \u6578\u7d44\u3002\u6bcf\u500b\u5be6\u4f8b\u7684\u683c\u5f0f\u53d6\u6c7a\u65bc\u7d93\u904e\u8a13\u7df4\u7684\u6a5f\u5668\u5b78\u7fd2\u6a21\u578b\u9700\u8981\u7684\u8f38\u5165\u3002\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [\u683c\u5f0f\u5316\u8f38\u5165\u4ee5\u9032\u884c\u5728\u7dda\u9810\u6e2c](#formatting-prediction-input) \u3002\n- \u904b\u884c\u4ee5\u4e0b\u547d\u4ee4\uff1a```\ngcloud ai endpoints explain ENDPOINT_ID \\\u00a0 --region=LOCATION_ID \\\u00a0 --json-request=request.json\n```\u66ff\u63db\u4ee5\u4e0b\u5167\u5bb9\uff1a- \uff1a\u7aef\u9ede\u7684 ID\u3002\n- \uff1a\u60a8\u5728\u5176\u4e2d\u4f7f\u7528 Vertex AI \u7684\u5340\u57df\u3002\n\uff08\u53ef\u9078\uff09\u5982\u679c\u60a8\u60f3\u8981\u5411 `Endpoint` \u4e2d\u7684\u7279\u5b9a `DeployedModel` \u767c\u9001\u8aaa\u660e\u8acb\u6c42\uff0c\u5247\u53ef\u4ee5\u6307\u5b9a `--deployed-model-id` \u6a19\u8a8c\uff1a```\ngcloud ai endpoints explain ENDPOINT_ID \\\u00a0 --region=LOCATION \\\u00a0 --deployed-model-id=DEPLOYED_MODEL_ID \\\u00a0 --json-request=request.json\n```\u9664\u4e86\u4e0a\u8ff0\u4f54\u4f4d\u7b26\u4e4b\u5916\uff0c\u9084\u66ff\u63db\u4ee5\u4e0b\u5167\u5bb9\uff1a- \uff08\u53ef\u9078\uff09\uff1a\u60a8\u60f3\u8981\u7232\u5176\u7372\u53d6\u8aaa\u660e\u7684\u5df2\u90e8\u7f72\u6a21\u578b\u7684 ID\u3002\u6b64 ID \u5305\u542b\u5728`predict`\u65b9\u6cd5\u7684\u97ff\u61c9\u4e2d\u3002\u5982\u679c\u60a8\u9700\u8981\u7232\u7279\u5b9a\u6a21\u578b\u8acb\u6c42\u8aaa\u660e\uff0c\u4e26\u4e14\u60a8\u5728\u540c\u4e00\u500b\u7aef\u9ede\u4e0a\u90e8\u7f72\u4e86\u591a\u500b\u6a21\u578b\uff0c\u5247\u53ef\u4ee5\u4f7f\u7528\u6b64 ID \u4f86\u78ba\u4fdd\u7232\u8a72\u7279\u5b9a\u6a21\u578b\u8fd4\u56de\u8aaa\u660e\u3002\u5728\u4f7f\u7528\u4efb\u4f55\u8acb\u6c42\u6578\u64da\u4e4b\u524d\uff0c\u8acb\u5148\u9032\u884c\u4ee5\u4e0b\u66ff\u63db\uff1a- \uff1a\u60a8\u5728\u5176\u4e2d\u4f7f\u7528 Vertex AI \u7684\u5340\u57df\u3002\n- \uff1a\u60a8\u7684 [\u9805\u76ee ID](https://cloud.google.com/resource-manager/docs/creating-managing-projects?hl=zh-cn#identifiers) \n- \uff1a\u7aef\u9ede\u7684 ID\u3002\n- \uff1a\u8981\u7232\u5176\u7372\u53d6\u9810\u6e2c\u7684\u5be6\u4f8b\u7684 JSON \u6578\u7d44\u3002\u6bcf\u500b\u5be6\u4f8b\u7684\u683c\u5f0f\u53d6\u6c7a\u65bc\u7d93\u904e\u8a13\u7df4\u7684\u6a5f\u5668\u5b78\u7fd2\u6a21\u578b\u9700\u8981\u7684\u8f38\u5165\u3002\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [\u683c\u5f0f\u5316\u8f38\u5165\u4ee5\u9032\u884c\u5728\u7dda\u9810\u6e2c](#formatting-prediction-input) \u3002\nHTTP \u65b9\u6cd5\u548c\u7db2\u5740\uff1a\n```\nPOST https://LOCATION_ID-aiplatform.googleapis.com/v1/projects/PROJECT_ID/locations/LOCATION_ID/endpoints/ENDPOINT_ID:explain\n```\n\u8acb\u6c42 JSON \u6b63\u6587\uff1a\n```\n{\n \"instances\": INSTANCES\n}\n```\n\u5982\u9700\u767c\u9001\u8acb\u6c42\uff0c\u8acb\u9078\u64c7\u4ee5\u4e0b\u65b9\u5f0f\u4e4b\u4e00\uff1a\n **\u6ce8\u610f** \uff1a\u4ee5\u4e0b\u547d\u4ee4\u5047\u5b9a\u60a8\u5df2\u4f7f\u7528\u60a8\u7684\u7528\u6236\u8cec\u865f\u901a\u904e\u904b\u884c [gcloud init](https://cloud.google.com/sdk/gcloud/reference/init?hl=zh-cn) \u6216 [gcloud auth login](https://cloud.google.com/sdk/gcloud/reference/auth/login?hl=zh-cn) \u767b\u9304`gcloud`CLI\uff0c\u6216\u8005\u4f7f\u7528\u4e86 [Cloud Shell](https://cloud.google.com/shell/docs?hl=zh-cn) \uff0c\u9019\u6703\u4f7f\u60a8\u81ea\u52d5\u767b\u9304`gcloud`CLI\u3002\u60a8\u53ef\u4ee5\u904b\u884c [gcloud auth list](https://cloud.google.com/sdk/gcloud/reference/auth/list?hl=zh-cn) \u4f86\u6aa2\u67e5\u7576\u524d\u6d3b\u8e8d\u7684\u8cec\u865f\u3002\n\u5c07\u8acb\u6c42\u6b63\u6587\u4fdd\u5b58\u5728\u540d\u7232 `request.json` \u7684\u6587\u4ef6\u4e2d\uff0c\u7136\u5f8c\u57f7\u884c\u4ee5\u4e0b\u547d\u4ee4\uff1a\n```\ncurl -X POST \\ -H \"Authorization: Bearer $(gcloud auth print-access-token)\" \\ -H \"Content-Type: application/json; charset=utf-8\" \\ -d @request.json \\ \"https://LOCATION_ID-aiplatform.googleapis.com/v1/projects/PROJECT_ID/locations/LOCATION_ID/endpoints/ENDPOINT_ID:explain\"\n``` **\u6ce8\u610f** \uff1a\u4ee5\u4e0b\u547d\u4ee4\u5047\u5b9a\u60a8\u5df2\u4f7f\u7528\u60a8\u7684\u7528\u6236\u8cec\u865f\u901a\u904e\u904b\u884c [gcloud init](https://cloud.google.com/sdk/gcloud/reference/init?hl=zh-cn) \u6216 [gcloud auth login](https://cloud.google.com/sdk/gcloud/reference/auth/login?hl=zh-cn) \u767b\u9304`gcloud`CLI\uff0c\u6216\u8005\u4f7f\u7528\u4e86 [Cloud Shell](https://cloud.google.com/shell/docs?hl=zh-cn) \uff0c\u9019\u6703\u4f7f\u60a8\u81ea\u52d5\u767b\u9304`gcloud`CLI\u3002\u60a8\u53ef\u4ee5\u904b\u884c [gcloud auth list](https://cloud.google.com/sdk/gcloud/reference/auth/list?hl=zh-cn) \u4f86\u6aa2\u67e5\u7576\u524d\u6d3b\u8e8d\u7684\u8cec\u865f\u3002\n\u5c07\u8acb\u6c42\u6b63\u6587\u4fdd\u5b58\u5728\u540d\u7232 `request.json` \u7684\u6587\u4ef6\u4e2d\uff0c\u7136\u5f8c\u57f7\u884c\u4ee5\u4e0b\u547d\u4ee4\uff1a\n```\n$cred = gcloud auth print-access-token$headers = @{ \"Authorization\" = \"Bearer $cred\" }Invoke-WebRequest ` -Method POST ` -Headers $headers ` -ContentType: \"application/json; charset=utf-8\" ` -InFile request.json ` -Uri \"https://LOCATION_ID-aiplatform.googleapis.com/v1/projects/PROJECT_ID/locations/LOCATION_ID/endpoints/ENDPOINT_ID:explain\" | Select-Object -Expand Content\n```\u5982\u679c\u6210\u529f\uff0c\u60a8\u6703\u6536\u5230\u5982\u4e0b\u6240\u793a\u7684 JSON \u97ff\u61c9\u3002\u5728\u97ff\u61c9\u4e2d\uff0c\u60a8\u6703\u770b\u5230\u4ee5\u4e0b\u66ff\u63db\uff1a\n- \uff1a\u9810\u6e2c\u7d50\u679c\u7684 JSON \u6578\u7d44\uff0c\u5176\u4e2d\u6bcf\u500b\u9810\u6e2c\u7d50\u679c\u5c0d\u61c9\u8acb\u6c42\u6b63\u6587\u4e2d\u5305\u542b\u7684\u4e00\u500b\u5be6\u4f8b\u3002\n- \uff1a [\u8aaa\u660e](https://cloud.google.com/vertex-ai/docs/reference/rest/v1/projects.locations.endpoints/explain?hl=zh-cn#Explanation) \u7684 JSON \u6578\u7d44\uff0c\u5176\u4e2d\u6bcf\u500b\u8aaa\u660e\u5c0d\u61c9\u4e00\u500b\u9810\u6e2c\u7d50\u679c\u3002\n- \uff1a\u57f7\u884c\u9810\u6e2c\u7684 [DeployedModel](https://cloud.google.com/vertex-ai/docs/reference/rest/v1/projects.locations.endpoints?hl=zh-cn#DeployedModel) \u7684 ID\u3002```\n{\n \"predictions\": PREDICTIONS,\n \"explanations\": EXPLANATIONS,\n \"deployedModelId\": \"DEPLOYED_MODEL_ID\"\n}\n```\n\u5982\u9700\u77ad\u89e3\u5982\u4f55\u5b89\u88dd\u6216\u66f4\u65b0 Python\uff0c\u8acb\u53c3\u95b1 [\u5b89\u88dd Python \u7248 Vertex AI SDK](https://cloud.google.com/vertex-ai/docs/start/use-vertex-ai-python-sdk?hl=zh-cn) \u3002  \u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [   Python API \u53c3\u8003\u6587\u6a94](https://cloud.google.com/python/docs/reference/aiplatform/latest?hl=zh-cn) \u3002\n [\u5728 GitHub \u4e0a\u67e5\u770b](https://github.com/googleapis/python-aiplatform/blob/HEAD/samples/model-builder/explain_tabular_sample.py) \n```\ndef explain_tabular_sample(\u00a0 \u00a0 project: str, location: str, endpoint_id: str, instance_dict: Dict):\u00a0 \u00a0 aiplatform.init(project=project, location=location)\u00a0 \u00a0 endpoint = aiplatform.Endpoint(endpoint_id)\u00a0 \u00a0 response = endpoint.explain(instances=[instance_dict], parameters={})\u00a0 \u00a0 for explanation in response.explanations:\u00a0 \u00a0 \u00a0 \u00a0 print(\" explanation\")\u00a0 \u00a0 \u00a0 \u00a0 # Feature attributions.\u00a0 \u00a0 \u00a0 \u00a0 attributions = explanation.attributions\u00a0 \u00a0 \u00a0 \u00a0 for attribution in attributions:\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 print(\" \u00a0attribution\")\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 print(\" \u00a0 baseline_output_value:\", attribution.baseline_output_value)\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 print(\" \u00a0 instance_output_value:\", attribution.instance_output_value)\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 print(\" \u00a0 output_display_name:\", attribution.output_display_name)\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 print(\" \u00a0 approximation_error:\", attribution.approximation_error)\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 print(\" \u00a0 output_name:\", attribution.output_name)\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 output_index = attribution.output_index\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 for output_index in output_index:\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 print(\" \u00a0 output_index:\", output_index)\u00a0 \u00a0 for prediction in response.predictions:\u00a0 \u00a0 \u00a0 \u00a0 print(prediction)\n```\n## \u5f8c\u7e8c\u6b65\u9a5f\n- \u77ad\u89e3 [\u5728\u7dda\u9810\u6e2c\u65e5\u8a8c\u8a18\u9304](https://cloud.google.com/vertex-ai/docs/predictions/online-prediction-logging?hl=zh-cn) \u3002", "guide": "Vertex AI"}