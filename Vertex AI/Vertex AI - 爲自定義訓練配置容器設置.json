{"title": "Vertex AI - \u7232\u81ea\u5b9a\u7fa9\u8a13\u7df4\u914d\u7f6e\u5bb9\u5668\u8a2d\u7f6e", "url": "https://cloud.google.com/vertex-ai/docs/training/configure-container-settings?hl=zh-cn", "abstract": "# Vertex AI - \u7232\u81ea\u5b9a\u7fa9\u8a13\u7df4\u914d\u7f6e\u5bb9\u5668\u8a2d\u7f6e\n\u57f7\u884c\u81ea\u5b9a\u7fa9\u8a13\u7df4\u6642\uff0c\u60a8\u5fc5\u9808\u6307\u5b9a\u5e0c\u671b Vertex AI \u904b\u884c\u7684\u6a5f\u5668\u5b78\u7fd2 (ML) \u4ee3\u78bc\u3002\u7232\u6b64\uff0c\u8acb\u7232 [\u81ea\u5b9a\u7fa9\u5bb9\u5668](https://cloud.google.com/vertex-ai/docs/training/create-custom-container?hl=zh-cn) \u6216 [\u5728\u9810\u69cb\u5efa\u5bb9\u5668\u4e0a\u904b\u884c\u7684 Python \u8a13\u7df4\u61c9\u7528](https://cloud.google.com/vertex-ai/docs/training/create-python-pre-built-container?hl=zh-cn) \u914d\u7f6e\u8a13\u7df4\u5bb9\u5668\u8a2d\u7f6e\u3002\n\u5982\u9700\u78ba\u5b9a\u8981\u4f7f\u7528\u81ea\u5b9a\u7fa9\u5bb9\u5668\u9084\u662f\u9810\u69cb\u5efa\u5bb9\u5668\uff0c\u8acb\u53c3\u95b1 [\u8a13\u7df4\u4ee3\u78bc\u8981\u6c42](https://cloud.google.com/vertex-ai/docs/training/code-requirements?hl=zh-cn) \u3002\n\u672c\u6587\u6a94\u4ecb\u7d39\u4e0a\u8ff0\u5169\u7a2e\u60c5\u6cc1\u4e2d\u5fc5\u9808\u6307\u5b9a\u7684 Vertex AI API \u5b57\u6bb5\u3002\n", "content": "## \u5728\u4f55\u8655\u6307\u5b9a\u5bb9\u5668\u8a2d\u7f6e\n\u5728 [WorkerPoolSpec](https://cloud.google.com/vertex-ai/docs/reference/rest/v1/CustomJobSpec?hl=zh-cn#workerpoolspec) \u4e2d\u6307\u5b9a\u914d\u7f6e\u8a73\u7d30\u4fe1\u606f\u3002\u6839\u64da\u60a8\u57f7\u884c\u81ea\u5b9a\u7fa9\u8a13\u7df4\u7684\u65b9\u5f0f\uff0c\u8acb\u5c07\u6b64 `WorkerPoolSpec` \u653e\u5165\u4ee5\u4e0b\u67d0\u500b API \u5b57\u6bb5\u4e2d\uff1a\n- **\u5982\u679c\u60a8\u8981\u5275\u5efa\u4e00\u500bCustomJob\u8cc7\u6e90** \uff0c\u5728 `CustomJob.jobSpec.workerPoolSpecs` \u4e2d\u6307\u5b9a `WorkerPoolSpec` \u3002\u5982\u679c\u60a8\u4f7f\u7528\u7684\u662f Google Cloud CLI\uff0c\u5247\u53ef\u4ee5\u5728 [gcloud ai custom-jobs create \u547d\u4ee4](https://cloud.google.com/sdk/gcloud/reference/ai/custom-jobs/create?hl=zh-cn) \u4e0a\u4f7f\u7528 `--worker-pool-spec` \u6a19\u8a8c\u6216 `--config` \u6a19\u8a8c\u4f86\u6307\u5b9a\u5de5\u4f5c\u5668\u6c60\u9078\u9805\u3002\u8a73\u7d30\u77ad\u89e3\u5982\u4f55 [\u5275\u5efa CustomJob](https://cloud.google.com/vertex-ai/docs/training/create-custom-job?hl=zh-cn) \u3002\n- **\u5982\u679c\u60a8\u8981\u5275\u5efa\u4e00\u500bHyperparameterTuningJob\u8cc7\u6e90** \uff0c\u5728 `HyperparameterTuningJob.trialJobSpec.workerPoolSpecs` \u4e2d\u6307\u5b9a `WorkerPoolSpec` \u3002\u5982\u679c\u60a8\u4f7f\u7528\u7684\u662f gcloud CLI\uff0c\u5247\u53ef\u4ee5\u4f7f\u7528 [gcloud ai hpt-tuning-jobs create \u547d\u4ee4](https://cloud.google.com/sdk/gcloud/reference/ai/hp-tuning-jobs/create?hl=zh-cn) \u4e0a\u7684 `--config` \u6a19\u8a8c\u4f86\u6307\u5b9a\u5de5\u4f5c\u5668\u6c60\u9078\u9805\u3002\u8a73\u7d30\u77ad\u89e3\u5982\u4f55 [\u5275\u5efa HyperparameterTuningJob](https://cloud.google.com/vertex-ai/docs/training/using-hyperparameter-tuning?hl=zh-cn) \u3002\n- **\u5982\u679c\u60a8\u8981\u5275\u5efa\u4e00\u500b\u672a\u9032\u884c\u8d85\u53c3\u6578\u8abf\u7bc0\u7684TrainingPipeline\u8cc7\u6e90\uff0c** \u5728 `TrainingPipeline.trainingTaskInputs.workerPoolSpecs` \u4e2d\u6307\u5b9a `WorkerPoolSpec` \u3002\u8a73\u7d30\u77ad\u89e3\u5982\u4f55 [\u5275\u5efa\u81ea\u5b9a\u7fa9TrainingPipeline](https://cloud.google.com/vertex-ai/docs/training/create-training-pipeline?hl=zh-cn) \u3002\n- **\u5982\u679c\u8981\u4f7f\u7528\u8d85\u53c3\u6578\u8abf\u7bc0\u5275\u5efa TrainingPipeline** \uff0c\u8acb\u5728 `TrainingPipeline.trainingTaskInputs.trialJobSpec.workerPoolSpecs` \u4e2d\u6307\u5b9a `WorkerPoolSpec` \u3002\n\u5982\u679c\u60a8\u57f7\u884c [\u5206\u4f48\u5f0f\u8a13\u7df4](https://cloud.google.com/vertex-ai/docs/training/code-requirements?hl=zh-cn#distributed) \uff0c\u5247\u53ef\u4ee5\u5c0d\u6bcf\u500b\u5de5\u4f5c\u5668\u6c60\u4f7f\u7528\u4e0d\u540c\u7684\u8a2d\u7f6e\u3002\n## \u914d\u7f6e\u5bb9\u5668\u8a2d\u7f6e\n\u6839\u64da\u60a8\u4f7f\u7528\u7684\u662f\u9810\u5efa\u5bb9\u5668\u9084\u662f\u81ea\u5b9a\u7fa9\u5bb9\u5668\uff0c\u60a8\u5fc5\u9808\u6307\u5b9a `WorkerPoolSpec` \u4e2d\u7684\u4e0d\u540c\u5b57\u6bb5\u3002\u8acb\u6839\u64da\u5177\u9ad4\u60c5\u6cc1\u9078\u64c7\u6a19\u7c64\u9801\uff1a\n- \u9078\u64c7\u652f\u6301\u4f60\u8a08\u5283\u7528\u65bc\u8a13\u7df4\u7684\u6a5f\u5668\u5b78\u7fd2\u6846\u67b6\u7684 [\u9810\u69cb\u5efa\u5bb9\u5668](https://cloud.google.com/vertex-ai/docs/training/pre-built-containers?hl=zh-cn) \u3002\u5728 [pythonPackageSpec.executorImageUri \u5b57\u6bb5](https://cloud.google.com/vertex-ai/docs/reference/rest/v1/CustomJobSpec?hl=zh-cn#PythonPackageSpec.FIELDS.executor_image_uri) \u4e2d\u6307\u5b9a\u5bb9\u5668\u6620\u50cf\u7684\u4e00\u500b URI\u3002\n- \u5728 [pythonPackageSpec.packageUris \u5b57\u6bb5](https://cloud.google.com/vertex-ai/docs/reference/rest/v1/CustomJobSpec?hl=zh-cn#PythonPackageSpec.FIELDS.package_uris) \u4e2d\u6307\u5b9a [Python \u8a13\u7df4\u61c9\u7528](https://cloud.google.com/vertex-ai/docs/training/create-python-pre-built-container?hl=zh-cn) \u7684 Cloud Storage URI\u3002\n- \u5728 [pythonPackageSpec.pythonModule \u5b57\u6bb5](https://cloud.google.com/vertex-ai/docs/reference/rest/v1/CustomJobSpec?hl=zh-cn#PythonPackageSpec.FIELDS.python_module) \u4e2d\u6307\u5b9a\u8a13\u7df4\u61c9\u7528\u7684\u5165\u53e3\u9ede\u6a21\u584a\u3002\n- \uff08\u53ef\u9078\uff09\u5728 [pythonPackageSpec.args \u5b57\u6bb5](https://cloud.google.com/vertex-ai/docs/reference/rest/v1/CustomJobSpec?hl=zh-cn#PythonPackageSpec.FIELDS.args) \u4e2d\u6307\u5b9a\u8981\u50b3\u905e\u7d66\u8a13\u7df4\u61c9\u7528\u5165\u53e3\u9ede\u6a21\u584a\u7684\u547d\u4ee4\u884c\u53c3\u6578\u5217\u8868\u3002\n\u4ee5\u4e0b\u793a\u4f8b\u7a81\u51fa\u986f\u793a\u4e86\u5275\u5efa `CustomJob` \u6642\u6307\u5b9a\u9019\u4e9b\u5bb9\u5668\u8a2d\u7f6e\u7684\u4f4d\u7f6e\uff1a\u5728 Google Cloud \u63a7\u5236\u6aaf\u4e2d\uff0c\u60a8\u7121\u6cd5\u76f4\u63a5\u5275\u5efa `CustomJob` \u3002\u4f46\u662f\uff0c\u60a8\u53ef\u4ee5 [\u5275\u5efa\u4e00\u500b\u5275\u5efa CustomJob \u7684 TrainingPipeline](https://cloud.google.com/vertex-ai/docs/training/create-custom-job?hl=zh-cn#create) \u3002\u5728 Google Cloud \u63a7\u5236\u6aaf\u4e2d\u5275\u5efa `TrainingPipeline` \u6642\uff0c\u60a8\u53ef\u4ee5\u5728 **\u8a13\u7df4\u5bb9\u5668** \u6b65\u9a5f\u7684\u67d0\u4e9b\u5b57\u6bb5\u4e2d\u6307\u5b9a\u9810\u69cb\u5efa\u5bb9\u5668\u8a2d\u7f6e\uff1a- `pythonPackageSpec.executorImageUri` \uff1a\u4f7f\u7528 **\u6a21\u578b\u6846\u67b6** \u548c **\u6a21\u578b\u6846\u67b6\u7248\u672c** \u4e0b\u62c9\u5217\u8868\u3002\n- `pythonPackageSpec.packageUris` \uff1a\u4f7f\u7528 **\u8edf\u4ef6\u5305\u4f4d\u7f6e** \u5b57\u6bb5\u3002\n- `pythonPackageSpec.pythonModule` \uff1a\u4f7f\u7528 **Python \u6a21\u584a** \u5b57\u6bb5\u3002\n- `pythonPackageSpec.args` \uff1a\u4f7f\u7528 **\u53c3\u6578** \u5b57\u6bb5\u3002\n```\ngcloud ai custom-jobs create \\\u00a0 --region=LOCATION \\\u00a0 --display-name=JOB_NAME \\\u00a0 --python-package-uris=PYTHON_PACKAGE_URIS \\\u00a0 --worker-pool-spec=machine-type=MACHINE_TYPE,replica-count=REPLICA_COUNT,executor-image-uri=PYTHON_PACKAGE_EXECUTOR_IMAGE_URI,python-module=PYTHON_MODULE\n```\n\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [\u5275\u5efa CustomJob \u6307\u5357](https://cloud.google.com/vertex-ai/docs/training/create-custom-job?hl=zh-cn) \u3002- \u5728 [containerSpec.imageUri \u5b57\u6bb5](https://cloud.google.com/vertex-ai/docs/reference/rest/v1/CustomJobSpec?hl=zh-cn#ContainerSpec.FIELDS.image_uri) \u4e2d\u6307\u5b9a [\u81ea\u5b9a\u7fa9\u5bb9\u5668](https://cloud.google.com/vertex-ai/docs/training/create-custom-container?hl=zh-cn) \u7684 Artifact Registry \u6216 Docker Hub URI\u3002\n- \uff08\u53ef\u9078\uff09\u5982\u679c\u60a8\u8981\u66ff\u63db\u5bb9\u5668\u4e2d\u7684 [ENTRYPOINT](https://docs.docker.com/engine/reference/builder/#entrypoint) \u6216 [CMD](https://docs.docker.com/engine/reference/builder/#cmd) \u8aaa\u660e\uff0c\u8acb\u6307\u5b9a [containerSpec.command \u6216 containerSpec.args \u5b57\u6bb5](https://cloud.google.com/vertex-ai/docs/reference/rest/v1/CustomJobSpec?hl=zh-cn#containerspec) \u3002\u9019\u4e9b\u5b57\u6bb5\u6309\u4ee5\u4e0b\u898f\u5247\u5f71\u97ff\u5bb9\u5668\u7684\u904b\u884c\u65b9\u5f0f\uff1a- **\u672a\u6307\u5b9a\u4efb\u4f55\u4e00\u500b\u5b57\u6bb5** \uff1a\u5bb9\u5668\u6839\u64da\u5176 `ENTRYPOINT` \u6307\u4ee4\u548c `CMD` \u6307\u4ee4\uff08\u5982\u679c\u5b58\u5728\uff09\u904b\u884c\u3002\u8acb\u53c3\u95b1\u95dc\u65bc [CMD \u548c ENTRYPOINT \u5982\u4f55\u4ea4\u4e92](https://docs.docker.com/engine/reference/builder/#understand-how-cmd-and-entrypoint-interact) \u7684 Docker \u6587\u6a94\u3002\n- **\u50c5\u6307\u5b9a containerSpec.command** \uff1a `containerSpec.command` \u7684\u503c\u66ff\u63db\u5bb9\u5668\u7684 `ENTRYPOINT` \u6307\u4ee4\uff0c\u7136\u5f8c\u5bb9\u5668\u5c07\u64da\u6b64\u904b\u884c\u3002\u5982\u679c\u5bb9\u5668\u5177\u6709 `CMD` \u6307\u4ee4\uff0c\u5247\u6703\u88ab\u5ffd\u7565\u3002\n- **\u50c5\u6307\u5b9a containerSpec.args** \uff1a `containerSpec.args` \u7684\u503c\u66ff\u63db\u5bb9\u5668\u7684 `CMD` \u6307\u4ee4\uff0c\u5bb9\u5668\u6839\u64da\u5176 `ENTRYPOINT` \u6307\u4ee4\u904b\u884c\u3002\n- **\u540c\u6642\u6307\u5b9a\u5169\u500b\u5b57\u6bb5** \uff1a `containerSpec.command` \u66ff\u63db\u5bb9\u5668 `ENTRYPOINT` \u6307\u4ee4\u4e26\u4e14 `containerSpec.args` \u66ff\u63db `CMD` \u6307\u4ee4\uff0c\u7136\u5f8c\u5bb9\u5668\u64da\u6b64\u904b\u884c\u3002\n\u4ee5\u4e0b\u793a\u4f8b\u7a81\u51fa\u986f\u793a\u4e86\u5728\u5275\u5efa `CustomJob` \u6642\u6307\u5b9a\u5176\u4e2d\u67d0\u4e9b\u5bb9\u5668\u8a2d\u7f6e\u7684\u4f4d\u7f6e\uff1a\u5728 Google Cloud \u63a7\u5236\u6aaf\u4e2d\uff0c\u60a8\u7121\u6cd5\u76f4\u63a5\u5275\u5efa `CustomJob` \u3002\u4f46\u662f\uff0c\u60a8\u53ef\u4ee5 [\u5275\u5efa\u4e00\u500b\u5275\u5efa CustomJob \u7684 TrainingPipeline](https://cloud.google.com/vertex-ai/docs/training/create-custom-job?hl=zh-cn#create) \u3002\u5728 Google Cloud \u63a7\u5236\u6aaf\u4e2d\u5275\u5efa `TrainingPipeline` \u6642\uff0c\u60a8\u53ef\u4ee5\u5728 **\u8a13\u7df4\u5bb9\u5668** \u6b65\u9a5f\u7684\u67d0\u4e9b\u5b57\u6bb5\u4e2d\u6307\u5b9a\u81ea\u5b9a\u7fa9\u5bb9\u5668\u8a2d\u7f6e\uff1a- `containerSpec.imageUri` \uff1a\u4f7f\u7528 **\u5bb9\u5668\u6620\u50cf** \u5b57\u6bb5\u3002\n- `containerSpec.command` \uff1a\u6b64 API \u5b57\u6bb5\u7121\u6cd5\u5728 Google Cloud \u63a7\u5236\u6aaf\u4e2d\u914d\u7f6e\u3002\n- `containerSpec.args` \uff1a\u4f7f\u7528 **\u53c3\u6578** \u5b57\u6bb5\u3002\n```\ngcloud ai custom-jobs create \\\u00a0 --region=LOCATION \\\u00a0 --display-name=JOB_NAME \\\u00a0 --worker-pool-spec=machine-type=MACHINE_TYPE,replica-count=REPLICA_COUNT,container-image-uri=CUSTOM_CONTAINER_IMAGE_URI\n```\u5728\u5617\u8a66\u6b64\u793a\u4f8b\u4e4b\u524d\uff0c\u8acb\u6309\u7167 [\u300aVertex AI \u5feb\u901f\u5165\u9580\uff1a\u4f7f\u7528\u5ba2\u6236\u7aef\u5eab\u300b](https://cloud.google.com/vertex-ai/docs/start/client-libraries?hl=zh-cn) \u4e2d\u7684 Java \u8a2d\u7f6e\u8aaa\u660e\u57f7\u884c\u64cd\u4f5c\u3002\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [Vertex AI Java API \u53c3\u8003\u6587\u6a94](https://cloud.google.com/java/docs/reference/google-cloud-aiplatform/latest/com.google.cloud.aiplatform.v1?hl=zh-cn) \u3002\n\u5982\u9700\u5411 Vertex AI \u9032\u884c\u8eab\u4efd\u9a57\u8b49\uff0c\u8acb\u8a2d\u7f6e\u61c9\u7528\u9ed8\u8a8d\u6191\u64da\u3002  \u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [\u7232\u672c\u5730\u958b\u767c\u74b0\u5883\u8a2d\u7f6e\u8eab\u4efd\u9a57\u8b49](https://cloud.google.com/docs/authentication/provide-credentials-adc?hl=zh-cn#local-dev) \u3002\n [\u5728 GitHub \u4e0a\u67e5\u770b](https://github.com/GoogleCloudPlatform/java-docs-samples/blob/HEAD/aiplatform/src/main/java/aiplatform/CreateCustomJobSample.java) \n```\nimport com.google.cloud.aiplatform.v1.AcceleratorType;import com.google.cloud.aiplatform.v1.ContainerSpec;import com.google.cloud.aiplatform.v1.CustomJob;import com.google.cloud.aiplatform.v1.CustomJobSpec;import com.google.cloud.aiplatform.v1.JobServiceClient;import com.google.cloud.aiplatform.v1.JobServiceSettings;import com.google.cloud.aiplatform.v1.LocationName;import com.google.cloud.aiplatform.v1.MachineSpec;import com.google.cloud.aiplatform.v1.WorkerPoolSpec;import java.io.IOException;// Create a custom job to run machine learning training code in Vertex AIpublic class CreateCustomJobSample {\u00a0 public static void main(String[] args) throws IOException {\u00a0 \u00a0 // TODO(developer): Replace these variables before running the sample.\u00a0 \u00a0 String project = \"PROJECT\";\u00a0 \u00a0 String displayName = \"DISPLAY_NAME\";\u00a0 \u00a0 // Vertex AI runs your training application in a Docker container image. A Docker container\u00a0 \u00a0 // image is a self-contained software package that includes code and all dependencies. Learn\u00a0 \u00a0 // more about preparing your training application at\u00a0 \u00a0 // https://cloud.google.com/vertex-ai/docs/training/overview#prepare_your_training_application\u00a0 \u00a0 String containerImageUri = \"CONTAINER_IMAGE_URI\";\u00a0 \u00a0 createCustomJobSample(project, displayName, containerImageUri);\u00a0 }\u00a0 static void createCustomJobSample(String project, String displayName, String containerImageUri)\u00a0 \u00a0 \u00a0 throws IOException {\u00a0 \u00a0 JobServiceSettings settings =\u00a0 \u00a0 \u00a0 \u00a0 JobServiceSettings.newBuilder()\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 .setEndpoint(\"us-central1-aiplatform.googleapis.com:443\")\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 .build();\u00a0 \u00a0 String location = \"us-central1\";\u00a0 \u00a0 // Initialize client that will be used to send requests. This client only needs to be created\u00a0 \u00a0 // once, and can be reused for multiple requests.\u00a0 \u00a0 try (JobServiceClient client = JobServiceClient.create(settings)) {\u00a0 \u00a0 \u00a0 MachineSpec machineSpec =\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 MachineSpec.newBuilder()\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 .setMachineType(\"n1-standard-4\")\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 .setAcceleratorType(AcceleratorType.NVIDIA_TESLA_K80)\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 .setAcceleratorCount(1)\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 .build();\u00a0 \u00a0 \u00a0 ContainerSpec containerSpec =\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 ContainerSpec.newBuilder().setImageUri(containerImageUri).build();\u00a0 \u00a0 \u00a0 WorkerPoolSpec workerPoolSpec =\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 WorkerPoolSpec.newBuilder()\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 .setMachineSpec(machineSpec)\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 .setReplicaCount(1)\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 .setContainerSpec(containerSpec)\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 .build();\u00a0 \u00a0 \u00a0 CustomJobSpec customJobSpecJobSpec =\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 CustomJobSpec.newBuilder().addWorkerPoolSpecs(workerPoolSpec).build();\u00a0 \u00a0 \u00a0 CustomJob customJob =\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 CustomJob.newBuilder()\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 .setDisplayName(displayName)\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 .setJobSpec(customJobSpecJobSpec)\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 .build();\u00a0 \u00a0 \u00a0 LocationName parent = LocationName.of(project, location);\u00a0 \u00a0 \u00a0 CustomJob response = client.createCustomJob(parent, customJob);\u00a0 \u00a0 \u00a0 System.out.format(\"response: %s\\n\", response);\u00a0 \u00a0 \u00a0 System.out.format(\"Name: %s\\n\", response.getName());\u00a0 \u00a0 }\u00a0 }}\n```\u5728\u5617\u8a66\u6b64\u793a\u4f8b\u4e4b\u524d\uff0c\u8acb\u6309\u7167 [\u300aVertex AI \u5feb\u901f\u5165\u9580\uff1a\u4f7f\u7528\u5ba2\u6236\u7aef\u5eab\u300b](https://cloud.google.com/vertex-ai/docs/start/client-libraries?hl=zh-cn) \u4e2d\u7684 Node.js \u8a2d\u7f6e\u8aaa\u660e\u57f7\u884c\u64cd\u4f5c\u3002\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [Vertex AI Node.js API \u53c3\u8003\u6587\u6a94](https://cloud.google.com/nodejs/docs/reference/aiplatform/latest?hl=zh-cn) \u3002\n\u5982\u9700\u5411 Vertex AI \u9032\u884c\u8eab\u4efd\u9a57\u8b49\uff0c\u8acb\u8a2d\u7f6e\u61c9\u7528\u9ed8\u8a8d\u6191\u64da\u3002  \u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [\u7232\u672c\u5730\u958b\u767c\u74b0\u5883\u8a2d\u7f6e\u8eab\u4efd\u9a57\u8b49](https://cloud.google.com/docs/authentication/provide-credentials-adc?hl=zh-cn#local-dev) \u3002\n [\u5728 GitHub \u4e0a\u67e5\u770b](https://github.com/GoogleCloudPlatform/nodejs-docs-samples/blob/HEAD/ai-platform/snippets/create-custom-job.js) \n```\n/**\u00a0* TODO(developer): Uncomment these variables before running the sample.\\\u00a0* (Not necessary if passing values as arguments)\u00a0*/// const customJobDisplayName = 'YOUR_CUSTOM_JOB_DISPLAY_NAME';// const containerImageUri = 'YOUR_CONTAINER_IMAGE_URI';// const project = 'YOUR_PROJECT_ID';// const location = 'YOUR_PROJECT_LOCATION';// Imports the Google Cloud Job Service Client libraryconst {JobServiceClient} = require('@google-cloud/aiplatform');// Specifies the location of the api endpointconst clientOptions = {\u00a0 apiEndpoint: 'us-central1-aiplatform.googleapis.com',};// Instantiates a clientconst jobServiceClient = new JobServiceClient(clientOptions);async function createCustomJob() {\u00a0 // Configure the parent resource\u00a0 const parent = `projects/${project}/locations/${location}`;\u00a0 const customJob = {\u00a0 \u00a0 displayName: customJobDisplayName,\u00a0 \u00a0 jobSpec: {\u00a0 \u00a0 \u00a0 workerPoolSpecs: [\u00a0 \u00a0 \u00a0 \u00a0 {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 machineSpec: {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 machineType: 'n1-standard-4',\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 acceleratorType: 'NVIDIA_TESLA_K80',\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 acceleratorCount: 1,\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 },\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 replicaCount: 1,\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 containerSpec: {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 imageUri: containerImageUri,\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 command: [],\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 args: [],\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 },\u00a0 \u00a0 \u00a0 \u00a0 },\u00a0 \u00a0 \u00a0 ],\u00a0 \u00a0 },\u00a0 };\u00a0 const request = {parent, customJob};\u00a0 // Create custom job request\u00a0 const [response] = await jobServiceClient.createCustomJob(request);\u00a0 console.log('Create custom job response:\\n', JSON.stringify(response));}createCustomJob();\n```\u5982\u9700\u77ad\u89e3\u5982\u4f55\u5b89\u88dd\u6216\u66f4\u65b0 Python\uff0c\u8acb\u53c3\u95b1 [\u5b89\u88dd Python \u7248 Vertex AI SDK](https://cloud.google.com/vertex-ai/docs/start/use-vertex-ai-python-sdk?hl=zh-cn) \u3002  \u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [   Python API \u53c3\u8003\u6587\u6a94](https://cloud.google.com/python/docs/reference/aiplatform/latest?hl=zh-cn) \u3002\n [\u5728 GitHub \u4e0a\u67e5\u770b](https://github.com/googleapis/python-aiplatform/blob/HEAD/samples/snippets/job_service/create_custom_job_sample.py) \n```\nfrom google.cloud import aiplatformdef create_custom_job_sample(\u00a0 \u00a0 project: str,\u00a0 \u00a0 display_name: str,\u00a0 \u00a0 container_image_uri: str,\u00a0 \u00a0 location: str = \"us-central1\",\u00a0 \u00a0 api_endpoint: str = \"us-central1-aiplatform.googleapis.com\",):\u00a0 \u00a0 # The AI Platform services require regional API endpoints.\u00a0 \u00a0 client_options = {\"api_endpoint\": api_endpoint}\u00a0 \u00a0 # Initialize client that will be used to create and send requests.\u00a0 \u00a0 # This client only needs to be created once, and can be reused for multiple requests.\u00a0 \u00a0 client = aiplatform.gapic.JobServiceClient(client_options=client_options)\u00a0 \u00a0 custom_job = {\u00a0 \u00a0 \u00a0 \u00a0 \"display_name\": display_name,\u00a0 \u00a0 \u00a0 \u00a0 \"job_spec\": {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"worker_pool_specs\": [\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"machine_spec\": {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"machine_type\": \"n1-standard-4\",\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"accelerator_type\": aiplatform.gapic.AcceleratorType.NVIDIA_TESLA_K80,\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"accelerator_count\": 1,\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 },\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"replica_count\": 1,\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"container_spec\": {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"image_uri\": container_image_uri,\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"command\": [],\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"args\": [],\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 },\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 }\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 ]\u00a0 \u00a0 \u00a0 \u00a0 },\u00a0 \u00a0 }\u00a0 \u00a0 parent = f\"projects/{project}/locations/{location}\"\u00a0 \u00a0 response = client.create_custom_job(parent=parent, custom_job=custom_job)\u00a0 \u00a0 print(\"response:\", response)\n```\n\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [\u5275\u5efa CustomJob \u6307\u5357](https://cloud.google.com/vertex-ai/docs/training/create-custom-job?hl=zh-cn) \u3002\n## \u5f8c\u7e8c\u6b65\u9a5f\n- \u77ad\u89e3\u5982\u4f55\u901a\u904e [\u5275\u5efa CustomJob](https://cloud.google.com/vertex-ai/docs/training/create-custom-job?hl=zh-cn) \u57f7\u884c\u81ea\u5b9a\u7fa9\u8a13\u7df4\u3002", "guide": "Vertex AI"}