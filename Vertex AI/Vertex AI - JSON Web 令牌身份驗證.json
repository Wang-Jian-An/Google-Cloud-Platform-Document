{"title": "Vertex AI - JSON Web \u4ee4\u724c\u8eab\u4efd\u9a57\u8b49", "url": "https://cloud.google.com/vertex-ai/docs/vector-search/jwt-auth?hl=zh-cn", "abstract": "# Vertex AI - JSON Web \u4ee4\u724c\u8eab\u4efd\u9a57\u8b49\nVector Search \u652f\u6301\u4f7f\u7528 [\u81ea\u7c3d\u540d JSON Web \u4ee4\u724c (JWT)](https://cloud.google.com/docs/authentication/token-types?hl=zh-cn#self-signed) \u9032\u884c\u8eab\u4efd\u9a57\u8b49\u7684\u7d22\u5f15\u7aef\u9ede\u3002 \u7232\u4e86\u63a7\u5236\u5c0d\u7d22\u5f15\u7aef\u9ede\u7684\u8a2a\u554f\uff0c\u5b83\u914d\u7f6e\u7232\u50c5\u63a5\u53d7\u7531\u660e\u78ba\u6388\u6b0a\u7684 Google \u670d\u52d9\u8cec\u865f\u9812\u767c\u7684\u5df2\u7c3d\u540d JWT\u3002 \u9019\u610f\u5473\u7740\u53ea\u6709\u4f7f\u7528\u9019\u4e9b\u6307\u5b9a\u8cec\u865f\u7684\u5ba2\u6236\u7aef\u624d\u80fd\u8207\u7aef\u9ede\u9032\u884c\u4ea4\u4e92\u3002\n\u672c\u9801\u9762\u6982\u8ff0\u4e86\u4f7f\u7528 JSON Web \u4ee4\u724c (JWT) \u8eab\u4efd\u9a57\u8b49\u8a2d\u7f6e\u7d22\u5f15\u7aef\u9ede\u4e26\u5c0d\u5176\u904b\u884c\u67e5\u8a62\u6240\u9700\u7684\u6b65\u9a5f\u3002\n", "content": "## \u9650\u5236\n- \u53ea\u6709\u5177\u5099 [VPC \u5c0d\u7b49\u4e92\u9023](https://cloud.google.com/vertex-ai/docs/vector-search/setup/vpc?hl=zh-cn) \u6216 [Private Service Connect (PSC)](https://cloud.google.com/vertex-ai/docs/vector-search/setup/private-service-connect?hl=zh-cn) \u7684\u5c08\u7528\u7aef\u9ede\u624d\u652f\u6301 JWT \u8eab\u4efd\u9a57\u8b49\u3002\n- \u53ea\u6709\u4f7f\u7528 gRPC \u8abf\u7528\u7684\u6578\u64da\u5e73\u9762 RPC API\uff08\u4f8b\u5982 MatchService\uff09\u624d\u652f\u6301 JWT \u8eab\u4efd\u9a57\u8b49\u3002\u672c\u9801\u9762\u4e2d\u7684 RPC \u793a\u4f8b\u4f7f\u7528\u958b\u6e90 [grpc_cli](https://github.com/grpc/grpc/blob/master/doc/command_line_tool.md) \u5de5\u5177\u5c07 gRPC \u8acb\u6c42\u767c\u9001\u5230\u6240\u90e8\u7f72\u7684\u7d22\u5f15\u670d\u52d9\u5668\u3002\n- \u7528\u65bc\u5275\u5efa\u3001\u90e8\u7f72\u548c\u7ba1\u7406\u7d22\u5f15\u7684 Admin API \u4f7f\u7528 [\u9810\u5b9a\u7fa9 IAM \u89d2\u8272](https://cloud.google.com/iam/docs/understanding-roles?hl=zh-cn) \u9032\u884c\u4fdd\u8b77\u3002## \u5275\u5efa\u7d22\u5f15\u4e26\u4f7f\u7528 JWT \u9032\u884c\u67e5\u8a62\n\u8acb\u6309\u7167\u4ee5\u4e0b\u6b65\u9a5f\u5275\u5efa\u7d22\u5f15\u7aef\u9ede\uff0c\u4e26\u4f7f\u7528\u81ea\u7c3d\u540d JWT \u67e5\u8a62\u8a72\u7aef\u9ede\u3002\n### \u5275\u5efa\u7d22\u5f15\n\u6309\u7167 [\u5275\u5efa\u7d22\u5f15](https://cloud.google.com/vertex-ai/docs/vector-search/create-manage-index?hl=zh-cn) \u4e2d\u7684\u8aaa\u660e\u5275\u5efa Vector Search \u7d22\u5f15\u3002\n### \u5275\u5efa\u5c08\u7528\u7aef\u9ede\n\u6309\u7167\u4ee5\u4e0b\u67d0\u500b\u6587\u6a94\u9801\u9762\u4e2d\u7684\u8aaa\u660e\u5275\u5efa\u5c08\u7528\u7aef\u9ede\uff1a\n- [\u8a2d\u7f6e VPC \u7db2\u7d61\u5c0d\u7b49\u4e92\u9023\u9023\u63a5](https://cloud.google.com/vertex-ai/docs/vector-search/setup/vpc?hl=zh-cn) \n- [Vector Search Private Service Connect](https://cloud.google.com/vertex-ai/docs/vector-search/setup/private-service-connect?hl=zh-cn) \n### \u5275\u5efa\u670d\u52d9\u8cec\u865f\n\u5275\u5efa\u670d\u52d9\u8cec\u865f\u4e26\u5411\u5176\u6388\u4e88 [Service Account Token Creator](https://cloud.google.com/iam/docs/understanding-roles?hl=zh-cn#iam.serviceAccountTokenCreator) IAM \u89d2\u8272\u3002\n- \u5553\u7528 IAM Service Account Credentials API \u4e26\u5275\u5efa\u670d\u52d9\u8cec\u865f\uff1a```\ngcloud services enable iamcredentials.googleapis.com --project=\"PROJECT_ID\"gcloud iam service-accounts create SERVICE_ACCOUNT_ID --project=\"PROJECT_ID\"\n```\u66ff\u63db\u4ee5\u4e0b\u503c\uff1a- \uff1a\u8981\u5728\u5176\u4e2d\u5275\u5efa\u670d\u52d9\u8cec\u865f\u7684\u9805\u76ee\u3002\n- \uff1a\u670d\u52d9\u8cec\u865f\u7684 ID\u3002\n\u8a73\u7d30\u77ad\u89e3\u5982\u4f55 [\u5275\u5efa\u670d\u52d9\u8cec\u865f](https://cloud.google.com/iam/docs/service-accounts-create?hl=zh-cn) \u3002\n- \u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u4e4b\u4e00\u5411\u60a8\u7684\u670d\u52d9\u8cec\u865f\u6388\u4e88 `iam.serviceAccountTokenCreator` IAM \u89d2\u8272\uff1a- \u4ee5\u4e0b\u547d\u4ee4\u6388\u6b0a\u60a8\u4f7f\u7528\u4f86\u81ea\u95dc\u806f\u4e86\u670d\u52d9\u8cec\u865f\u7684 Compute Engine \u865b\u64ec\u6a5f\u7684\u670d\u52d9\u8cec\u865f\u5275\u5efa JWT\uff1a```\ngcloud iam service-accounts add-iam-policy-binding \\\u00a0 \u00a0\"SERVICE_ACCOUNT_ID@PROJECT_ID.iam.gserviceaccount.com\" \\\u00a0 \u00a0--role \"roles/iam.serviceAccountTokenCreator\" \\\u00a0 \u00a0--member \"serviceAccount:SERVICE_ACCOUNT_ID@PROJECT_ID.iam.gserviceaccount.com\" \\\u00a0 \u00a0--project \"PROJECT_ID\"\n```\u66ff\u63db\u4ee5\u4e0b\u503c\uff1a- \uff1a\u670d\u52d9\u8cec\u865f\u7684 ID\u3002\n- \uff1a\u8981\u5728\u5176\u4e2d\u5275\u5efa\u670d\u52d9\u8cec\u865f\u7684\u9805\u76ee\u3002\n- \u4ee5\u4e0b\u547d\u4ee4\u6388\u6b0a\u60a8\u4f7f\u7528\u4f86\u81ea\u60a8\u81ea\u5df1\u7684 Google \u8cec\u865f\uff08\u5728\u60a8\u7684\u5de5\u4f5c\u7ad9\u4e0a\uff09\u7684\u670d\u52d9\u8cec\u865f\u5275\u5efa JWT\uff1a```\ngcloud iam service-accounts add-iam-policy-binding \\\u00a0 \u00a0\"SERVICE_ACCOUNT_ID@PROJECT_ID.iam.gserviceaccount.com\" \\\u00a0 \u00a0--role \"roles/iam.serviceAccountTokenCreator\" \\\u00a0 \u00a0--member \"user:EMAIL_ADDRESS\" \\\u00a0 \u00a0--project PROJECT_ID\n```\u66ff\u63db\u4ee5\u4e0b\u503c\uff1a- \uff1a\u670d\u52d9\u8cec\u865f\u7684 ID\u3002\n- \uff1a\u8981\u5728\u5176\u4e2d\u5275\u5efa\u670d\u52d9\u8cec\u865f\u7684\u9805\u76ee\u3002\n- \uff1a\u60a8\u7684\u96fb\u5b50\u90f5\u4ef6\u5730\u5740\u3002\n### \u4f7f\u7528 JWT \u8eab\u4efd\u9a57\u8b49\u914d\u7f6e\u5c07\u7d22\u5f15\u90e8\u7f72\u5230\u7aef\u9ede\n- \u5c07\u7d22\u5f15\u90e8\u7f72\u5230\u5c08\u7528\u7aef\u9ede\uff0c\u5982\u4ee5\u4e0b\u793a\u4f8b\u6240\u793a\uff1a```\ngcloud ai index-endpoints deploy-index INDEX_ENDPOINT_ID \\\u00a0 \u00a0--index=INDEX_ID \\\u00a0 \u00a0--deployed-index-id=DEPLOYED_INDEX_ID \\\u00a0 \u00a0--display-name=DEPLOYED_INDEX_NAME \\\u00a0 \u00a0--audiences=AUDIENCES \\\u00a0 \u00a0--allowed-issuers=\"SERVICE_ACCOUNT_ID@PROJECT_ID.iam.gserviceaccount.com\" \\\u00a0 \u00a0--project=PROJECT_ID \\\u00a0 \u00a0--region=LOCATION\n```\u66ff\u63db\u4ee5\u4e0b\u503c\uff1a- \uff1a\u7d22\u5f15\u7aef\u9ede\u7684 ID\u3002\n- \uff1a\u7d22\u5f15\u7684 ID\u3002\n- \uff1a\u7528\u6236\u6307\u5b9a\u7684\u5b57\u7b26\u4e32\uff0c\u7528\u65bc\u552f\u4e00\u6a19\u8b58\u5df2\u90e8\u7f72\u7684\u7d22\u5f15\u3002\u5fc5\u9808\u4ee5\u5b57\u6bcd\u958b\u982d\uff0c\u4e26\u4e14\u53ea\u5305\u542b\u5b57\u6bcd\u3001\u6578\u5b57\u6216\u4e0b\u5283\u7dda\u3002\u5982\u9700\u77ad\u89e3\u683c\u5f0f\u6e96\u5247\uff0c\u8acb\u53c3\u95b1 [DeployedIndex.id](https://cloud.google.com/vertex-ai/docs/reference/rpc/google.cloud.aiplatform.v1?hl=zh-cn#google.cloud.aiplatform.v1.DeployedIndex) \u3002\n- \uff1a\u5df2\u90e8\u7f72\u7d22\u5f15\u7684\u986f\u793a\u540d\u7a31\u3002\n- \uff1a\u7528\u65bc\u6a19\u8b58\u670d\u52d9\u3001\u5de5\u4f5c\u8ca0\u8f09\u6216\u61c9\u7528\u7684\u9810\u671f\u76ee\u6a19\u5c0d\u8c61\u7684\u63cf\u8ff0\u6027\u5b57\u7b26\u4e32\uff0c\u4f8b\u5982`\"123456-my-app\"`\u3002\n- \uff1a\u670d\u52d9\u8cec\u865f\u7684 ID\u3002\n- \uff1a\u60a8\u7684 Google Cloud [\u9805\u76ee ID](https://cloud.google.com/resource-manager/docs/creating-managing-projects?hl=zh-cn#identifiers) \u3002\n- \uff1a\u60a8\u5728\u5176\u4e2d\u4f7f\u7528 Vertex AI \u7684\u5340\u57df\u3002\n### \u4f7f\u7528\u81ea\u7c3d\u540d JWT \u67e5\u8a62\u7d22\u5f15\n\u6982\u62ec\u4f86\u8b1b\uff0c\u6240\u9700\u6b65\u9a5f\u5982\u4e0b\uff1a\n- \u5275\u5efa JWT \u8f09\u8377\u3002\n- \u4f7f\u7528\u5148\u524d\u5275\u5efa\u7684\u670d\u52d9\u8cec\u865f\u5c0d\u4ee4\u724c\u7c3d\u540d\u3002\n- \u4f7f\u7528 gRPC \u8abf\u7528\u67e5\u8a62\u7d22\u5f15\uff08\u5728\u6388\u6b0a\u6a19\u982d\u4e2d\u50b3\u905e\u4ee4\u724c\uff09\u3002Vector Search \u8eab\u4efd\u9a57\u8b49\u63a5\u53d7\u4f7f\u7528\u9810\u5148\u6388\u6b0a\u7684\u670d\u52d9\u8cec\u865f\u7c3d\u540d\u7684 JWT \u4ee5\u7528\u65bc\u9810\u5b9a\u7fa9\u7684\u76ee\u6a19\u5c0d\u8c61\u3002\u670d\u52d9\u8cec\u865f\u548c\u76ee\u6a19\u5c0d\u8c61\u5fc5\u9808\u5728\u7d22\u5f15\u90e8\u7f72\u5230\u5c08\u7528\u7aef\u9ede\u6642\uff0c\u7531\u8abf\u7528\u8005\u6307\u5b9a\u3002 \u4f7f\u7528\u9019\u4e9b\u8a2d\u7f6e\u90e8\u7f72\u7d22\u5f15\u5f8c\uff0c\u767c\u9001\u5230\u8a72\u7aef\u9ede\u7684\u6240\u6709 gRPC API \u8acb\u6c42\u90fd\u9700\u8981\u5305\u542b\u4e00\u500b\u6388\u6b0a\u6a19\u982d\uff0c\u5176\u4e2d\u5305\u542b\u7531\u9812\u767c\u8005\uff08\u670d\u52d9\u8cec\u865f\uff09\u7c3d\u540d\u4e26\u91dd\u5c0d\u6240\u63d0\u4f9b\u7684\u76ee\u6a19\u5c0d\u8c61\u7684 JWT\u3002\u5df2\u7c3d\u540d\u7684 JWT \u5728 gRPC \u8acb\u6c42\u7684 `authorization` \u6a19\u982d\u4e2d\u4ee5\u4e0d\u8a18\u540d\u4ee4\u724c\u5f62\u5f0f\u9032\u884c\u50b3\u905e\u3002\u9664\u4e86\u7531\u670d\u52d9\u8cec\u865f\u7c3d\u540d\u4e4b\u5916\uff0cJWT \u9084\u5fc5\u9808\u5305\u542b\u4ee5\u4e0b\u8072\u660e\uff1a\n- `iss` \uff08\u5141\u8a31\u7684\u9812\u767c\u8005\uff09\u8072\u660e\u61c9\u8a72\u662f\u670d\u52d9\u8cec\u865f\u96fb\u5b50\u90f5\u4ef6\u5730\u5740\uff0c\u4f8b\u5982\uff1a```\n\"iss\": \"SERVICE_ACCOUNT_ID@PROJECT_ID.iam.gserviceaccount.com\"\n```\n- `aud` \uff08\u76ee\u6a19\u5c0d\u8c61\uff09\u548c `sub` \uff08\u4e3b\u984c\uff09\u8072\u660e\u61c9\u8a2d\u7f6e\u7232\u76f8\u540c\u7684\u503c\u3002\u9019\u662f\u7528\u65bc\u6a19\u8b58\u670d\u52d9\u3001\u5de5\u4f5c\u8ca0\u8f09\u6216\u61c9\u7528\u7684\u9810\u671f\u76ee\u6a19\u5c0d\u8c61\u7684\u63cf\u8ff0\u6027\u5b57\u7b26\u4e32\uff0c\u4f8b\u5982\uff1a```\n\"aud\": \"123456-my-app\",\"sub\": \"123456-my-app\"\n```\u6b64\u503c\u5fc5\u9808\u8207\u5728\u7d22\u5f15\u90e8\u7f72\u6642\u50b3\u905e\u7684 `--audiences` \u53c3\u6578\u5339\u914d\u3002\n- `iat` \uff08\u9812\u767c\u6642\u9593\uff09\u8072\u660e\u61c9\u8a2d\u7f6e\u7232\u9812\u767c\u4ee4\u724c\u7684\u6642\u9593\u3002 `exp` \uff08\u5230\u671f\u6642\u9593\uff09\u8072\u660e\u61c9\u8a2d\u7f6e\u7232\u96a8\u5f8c\u7684\u8f03\u77ed\u6642\u9593\uff08\u5927\u7d04\u4e00\u5c0f\u6642\uff09\u3002\u9019\u4e9b\u503c\u4ee5 Unix \u7d00\u5143\u6642\u9593\u8868\u793a\uff0c\u4f8b\u5982\uff1a```\n\"iat\": 1698966927, // unix time since epoch eg via date +%s\"exp\": 1698967527 // iat + a few mins (eg 600 seconds)\n```\n\u4ee5\u4e0b\u793a\u4f8b\u986f\u793a\u55ae\u500b JWT \u8f09\u8377\u4e2d\u7684\u9019\u4e9b\u8072\u660e\uff1a\n```\n{\u00a0 \u00a0\"iss\": \"SERVICE_ACCOUNT_ID@PROJECT_ID.iam.gserviceaccount.com\",\u00a0 \u00a0\"aud\": \"123456-my-app\",\u00a0 \u00a0\"sub\": \"123456-my-app\",\u00a0 \u00a0\"iat\": 1698956084,\u00a0 \u00a0\"exp\": 1698960084}\n```\nJWT \u8f09\u8377\u4f7f\u7528 `iss` \u8072\u660e\u4e2d\u6307\u5b9a\u7684\u670d\u52d9\u8cec\u865f\u9032\u884c\u7c3d\u540d\u3002\u5b83\u63a1\u7528 base64 \u7de8\u78bc\uff0c\u4f7f\u7528 gRPC \u5143\u6578\u64da\u4ee5\u4e0d\u8a18\u540d\u4ee4\u724c\u5f62\u5f0f\u50b3\u8f38\uff0c\u5982\u4ee5\u4e0b\u793a\u4f8b\u6240\u793a\uff0c\u5176\u4e2d `signedJwt` \u662f\u5305\u542b\u5df2\u7c3d\u540d JWT \u7684\u74b0\u5883\u8b8a\u91cf\uff1a\n```\n./grpc_cli call ... --metadata \"authorization: Bearer $signedJwt\"\n```- \u78ba\u4fdd\u60a8\uff08\u8abf\u7528\u8005\uff09\u53ef\u4ee5\u5c0d\u670d\u52d9\u8cec\u865f\u4f7f\u7528 `roles/iam.serviceAccountTokenCreator` \u89d2\u8272\u3002\n- \u5275\u5efa\u540d\u7232 `jwt_in.json` \u4e14\u5305\u542b\u539f\u59cb JWT \u7684 JSON \u6587\u4ef6\uff1a```\nSA=\"serviceAccount:SERVICE_ACCOUNT_ID@PROJECT_ID.iam.gserviceaccount.com\"cat << EOF > jwt_in.json{\u00a0 \"aud\": \"AUDIENCES\",\u00a0 \"sub\": \"AUDIENCES\",\u00a0 \"iss\": \"${SA}\",\u00a0 \"iat\": $(date +%s),\u00a0 \"exp\": $(expr $(date +%s) + 600)}EOF\n```\u66ff\u63db\u4ee5\u4e0b\u503c\uff1a- \uff1a\u670d\u52d9\u8cec\u865f\u7684 ID\u3002\n- \uff1a\u60a8\u7684 Google Cloud [\u9805\u76ee ID](https://cloud.google.com/resource-manager/docs/creating-managing-projects?hl=zh-cn#identifiers) \u3002\n- \uff1a\u7528\u65bc\u6a19\u8b58\u670d\u52d9\u3001\u5de5\u4f5c\u8ca0\u8f09\u6216\u61c9\u7528\u7684\u9810\u671f\u76ee\u6a19\u5c0d\u8c61\u7684\u63cf\u8ff0\u6027\u5b57\u7b26\u4e32\uff0c\u4f8b\u5982`\"123456-my-app\"`\u3002\n- \u4f7f\u7528 [jq \u5de5\u5177](https://jqlang.github.io/jq/) \uff0c\u901a\u904e\u5c07 JWT \u7de8\u78bc\u7232\u5b57\u7b26\u4e32\u4f86\u5275\u5efa `curl` \u8acb\u6c42\u8f09\u8377\uff1a```\ncat jwt_in.json | jq -Rsa >request.json\n```\n- \u901a\u904e\u5c07\u8acb\u6c42\u8f09\u8377\u50b3\u905e\u7d66 [signJwt](https://cloud.google.com/iam/docs/reference/credentials/rest/v1/projects.serviceAccounts/signJwt?hl=zh-cn) REST API \u65b9\u6cd5\u4f86\u5c0d\u4ee4\u724c\u7c3d\u540d\u3002```\nSA=\"serviceAccount:SERVICE_ACCOUNT_ID@PROJECT_ID.iam.gserviceaccount.com\"curl -X POST \\\u00a0 \u00a0-H \"Authorization: Bearer $(gcloud auth print-access-token)\" \\\u00a0 \u00a0-H \"Content-Type: application/json; charset=utf-8\" \\\u00a0 \u00a0-d @request.json \\\u00a0 \u00a0\"https://iamcredentials.googleapis.com/v1/projects/-/serviceAccounts/$SA:signJwt\"\n```\u66ff\u63db\u4ee5\u4e0b\u503c\uff1a- \uff1a\u670d\u52d9\u8cec\u865f\u7684 ID\u3002\n- \uff1a\u60a8\u7684 Google Cloud [\u9805\u76ee ID](https://cloud.google.com/resource-manager/docs/creating-managing-projects?hl=zh-cn#identifiers) \u3002\n\u5c07\u8fd4\u56de\u7684 `signedJwt` \u503c\u5b58\u5132\u5230\u540d\u7232 `signedJwt` \u7684\u74b0\u5883\u8b8a\u91cf\u4e2d\u3002\u6216\u8005\uff0c\u60a8\u53ef\u4ee5\u901a\u904e\u5c07 `jwt_in.json` \u6587\u4ef6\u76f4\u63a5\u50b3\u905e\u7d66 gcloud CLI [sign-jwt](https://cloud.google.com/sdk/gcloud/reference/iam/service-accounts/sign-jwt?hl=zh-cn) \u65b9\u6cd5\u4f86\u5c0d JWT \u7c3d\u540d\u3002\n```\ngcloud iam service-accounts sign-jwt jwt_in.json jwt_out \\\u00a0 \u00a0--iam-account=SERVICE_ACCOUNT_ID@PROJECT_ID.iam.gserviceaccount.com\n```\n\u66ff\u63db\u4ee5\u4e0b\u503c\uff1a\n- \uff1a\u670d\u52d9\u8cec\u865f\u7684 ID\u3002\n- \uff1a\u60a8\u7684 Google Cloud [\u9805\u76ee ID](https://cloud.google.com/resource-manager/docs/creating-managing-projects?hl=zh-cn#identifiers) \u3002\n\u5df2\u7c3d\u540d\u7684 JWT \u6703\u5728 `jwt_out` \u8f38\u51fa\u6587\u4ef6\u4e2d\u8fd4\u56de\u3002\u5c07\u5176\u5b58\u5132\u5230\u540d\u7232 `signedJwt` \u7684\u74b0\u5883\u8b8a\u91cf\u4e2d\u3002\n\u5f9e\u540c\u4e00 VPC \u7db2\u7d61\u4e2d\u7684 Compute Engine \u865b\u64ec\u6a5f\u8abf\u7528 `MatchService` `gRPC` \u7aef\u9ede\uff08\u5728 `authorization` \u6a19\u982d\u4e2d\u50b3\u905e `signedJwt` \u4ee4\u724c\uff09\uff0c\u5982\u4ee5\u4e0b\u793a\u4f8b\u6240\u793a\uff1a\n```\n./grpc_cli call ${DEPLOYED_INDEX_SERVER_IP}:10000 google.cloud.aiplatform.container.v1.MatchService.Match \\\u00a0 \u00a0'{deployed_index_id: \"${DEPLOYED_INDEX_ID}\", float_val: [-0.1,..]}' \\\u00a0 \u00a0--metadata \"authorization: Bearer $signedJwt\"\n```\n\u5982\u9700\u904b\u884c\u6b64\u547d\u4ee4\uff0c\u60a8\u9700\u8981\u8a2d\u7f6e\u4ee5\u4e0b\u74b0\u5883\u8b8a\u91cf\uff1a\n- \u662f\u6240\u90e8\u7f72\u7684\u7d22\u5f15\u670d\u52d9\u5668\u7684 IP \u5730\u5740\u3002\u5982\u9700\u77ad\u89e3\u5982\u4f55\u6aa2\u7d22\u6b64\u503c\uff0c\u8acb\u53c3\u95b1 [\u67e5\u8a62\u7d22\u5f15\u4ee5\u7372\u53d6\u6700\u8fd1\u9130](https://cloud.google.com/vertex-ai/docs/vector-search/query-index-vpc?hl=zh-cn) \u3002\n- \uff1a\u7528\u6236\u6307\u5b9a\u7684\u5b57\u7b26\u4e32\uff0c\u7528\u65bc\u552f\u4e00\u6a19\u8b58\u5df2\u90e8\u7f72\u7684\u7d22\u5f15\u3002\u5fc5\u9808\u4ee5\u5b57\u6bcd\u958b\u982d\uff0c\u4e26\u4e14\u53ea\u5305\u542b\u5b57\u6bcd\u3001\u6578\u5b57\u6216\u4e0b\u5283\u7dda\u3002\u5982\u9700\u77ad\u89e3\u683c\u5f0f\u6e96\u5247\uff0c\u8acb\u53c3\u95b1 [DeployedIndex.id](https://cloud.google.com/vertex-ai/docs/reference/rpc/google.cloud.aiplatform.v1?hl=zh-cn#google.cloud.aiplatform.v1.DeployedIndex) \u3002\n`signedJwt` \u662f\u5305\u542b\u5df2\u7c3d\u540d JWT \u7684\u74b0\u5883\u8b8a\u91cf\u3002\n## \u554f\u984c\u6392\u67e5\n\u4e0b\u8868\u5217\u51fa\u4e86\u4e00\u4e9b\u5e38\u898b `gRPC` \u932f\u8aa4\u6d88\u606f\u3002\n| gRPC \u932f\u8aa4\u6d88\u606f      | \u539f\u56e0           |\n|:-----------------------------------|:------------------------------------------------|\n| \u627e\u4e0d\u5230\u7528\u65bc\u7d22\u5f15\u201cINDEX_ID\u201d\u7684\u6388\u6b0a\u6a19\u982d | gRPC \u5143\u6578\u64da\u4e0d\u5305\u542b\u6388\u6b0a\u6a19\u982d      |\n| JWT \u683c\u5f0f\u7121\u6548      | \u4ee4\u724c\u683c\u5f0f\u4e0d\u6b63\u78ba\uff0c\u7121\u6cd5\u6b63\u78ba\u89e3\u6790     |\n| JWT \u8eab\u4efd\u9a57\u8b49\u5931\u6557     | \u4ee4\u724c\u5df2\u904e\u671f\u6216\u8005\u4e26\u975e\u7531\u6b63\u78ba\u7684\u670d\u52d9\u8cec\u865f\u7c3d\u540d   |\n| JWT \u9812\u767c\u8005\u61c9\u8655\u65bc\u5141\u8a31\u7684\u9812\u767c\u8005\u5217\u8868\u4e2d | \u4ee4\u724c iss \u4e0d\u5728 auth_config \u5141\u8a31\u7684\u9812\u767c\u8005\u4e2d  |\n| \u91dd\u5c0d\u7d22\u5f15\u201cINDEX_ID\u201d\u7684\u6b0a\u9650\u6aa2\u67e5\u5931\u6557 | \u4ee4\u724c aud \u6216 sub \u8072\u660e\u4e0d\u5728 auth_config \u76ee\u6a19\u5c0d\u8c61\u4e2d |\n## \u5f8c\u7e8c\u6b65\u9a5f\n- \u5982\u9700\u8a73\u7d30\u77ad\u89e3 JWT \u548c\u4ee4\u724c\u8072\u660e\u7d50\u69cb\uff0c\u8acb\u53c3\u95b1 [RFC 7519](https://datatracker.ietf.org/doc/html/rfc7519) \u3002\n- \u8a73\u7d30\u77ad\u89e3\u5982\u4f55 [\u5275\u5efa\u81ea\u7c3d\u540d JSON Web \u4ee4\u724c (JWT)](https://cloud.google.com/iam/docs/create-short-lived-credentials-direct?hl=zh-cn#sa-credentials-jwt) \n- \u77ad\u89e3\u5982\u4f55 [\u66f4\u65b0\u548c\u91cd\u5efa\u7d22\u5f15](https://cloud.google.com/vertex-ai/docs/vector-search/update-rebuild-index?hl=zh-cn) \n- \u77ad\u89e3\u5982\u4f55 [\u76e3\u63a7\u7d22\u5f15](https://cloud.google.com/vertex-ai/docs/vector-search/monitor?hl=zh-cn)", "guide": "Vertex AI"}