{"title": "Document AI - Managing long-running operations (LROs)", "url": "https://cloud.google.com/document-ai/docs/long-running-operations?hl=zh-cn", "abstract": "# Document AI - Managing long-running operations (LROs)\n# Managing long-running operations (LROs)\nThis page describes how to manage the lifecycle of a Document AI API Long-Running Operation (LRO).\n[Long-Running Operations](https://google.aip.dev/151) are returned when method calls might take a long time to complete. The Document AI API creates an LRO every time you call [projects.locations.processors.batchProcess](/document-ai/docs/reference/rest/v1/projects.locations.processors/batchProcess) through the API or Client Libraries. The LRO tracks the status of the processing job.\nYou can use the [operations methods](/document-ai/docs/reference/rest/v1/projects.locations.operations) that the Document AI API provides to check the [status](#getting_details_about_a_long-running_operation) of LROs. You can also [list](#listing_long-running_operations) , [poll](#polling_a_long-running_operation) , or [cancel](#cancelling_a_long-running_operation) LROs.\nLROs are managed at the Google Cloud project and location level. When making a request to the API, include the Google Cloud project and the location in which the LRO is running.\nThe record of an LRO is kept for approximately 30 days after the LRO finishes, meaning that you cannot view or list an LRO after that point.\n", "content": "## Getting details about a long-running operation\nThe following samples show how to get details about an LRO.\nTo get the status of and view details about an LRO, call the [projects.locations.operations.get](/document-ai/docs/reference/rest/v1/projects.locations.operations/get) method.\nSuppose that you receive the following response after calling [projects.locations.processors.batchProcess](/document-ai/docs/reference/rest/v1/projects.locations.processors/batchProcess) :\n```\n{\n \"name\": \"projects/PROJECT_NUMBER/locations/LOCATION/operations/OPERATION_ID\"\n}\n```\nThe `name` value in the response shows that the Document AI API created an LRO named `projects/` `` `/locations/` `` `/operations/` `` .\nYou can also retrieve the LRO name by [listing long-running operations](#listing_long-running_operations) .\nBefore using any of the request data, make the following replacements:- : Your Google Cloud project ID.\n- : the [location](/document-ai/docs/regions) where the LRO is running, for example:- `us`- United States\n- `eu`- European Union\n- : The ID of your operation. The ID is the last element of the name of your operation. For example:- Operation name:`projects/` `` `/locations/` `` `/operations/` ` **bc4e1d412863e626** `\n- Operation id:` **bc4e1d412863e626** `\nHTTP method and URL:\n```\nGET https://LOCATION-documentai.googleapis.com/v1/projects/PROJECT_ID/locations/LOCATION/operations/OPERATION_ID\n```\nTo send your request, choose one of these options:\n **Note:** The following command assumes that you have logged in to  the`gcloud`CLI with your user account by running [gcloud init](/sdk/gcloud/reference/init) or [gcloud auth login](/sdk/gcloud/reference/auth/login) ,  or by using [Cloud Shell](/shell/docs) ,  which automatically logs you into the`gcloud`CLI.  You can check the currently active account by running [gcloud auth list](/sdk/gcloud/reference/auth/list) .\nExecute the following command:\n```\ncurl -X GET \\ -H \"Authorization: Bearer $(gcloud auth print-access-token)\" \\ \"https://LOCATION-documentai.googleapis.com/v1/projects/PROJECT_ID/locations/LOCATION/operations/OPERATION_ID\"\n``` **Note:** The following command assumes that you have logged in to  the`gcloud`CLI with your user account by running [gcloud init](/sdk/gcloud/reference/init) or [gcloud auth login](/sdk/gcloud/reference/auth/login) ,  or by using [Cloud Shell](/shell/docs) ,  which automatically logs you into the`gcloud`CLI.  You can check the currently active account by running [gcloud auth list](/sdk/gcloud/reference/auth/list) .\nExecute the following command:\n```\n$cred = gcloud auth print-access-token$headers = @{ \"Authorization\" = \"Bearer $cred\" }Invoke-WebRequest ` -Method GET ` -Headers $headers ` -Uri \"https://LOCATION-documentai.googleapis.com/v1/projects/PROJECT_ID/locations/LOCATION/operations/OPERATION_ID\" | Select-Object -Expand Content\n```\nYou should receive a JSON response similar to the following:\n```\n{\n \"name\": \"projects/PROJECT_ID/locations/LOCATION/operations/OPERATION_ID\",\n \"metadata\": {\n \"@type\": \"type.googleapis.com/google.cloud.documentai.v1.BatchProcessMetadata\",\n \"state\": \"SUCCEEDED\",\n \"stateMessage\": \"Processed 1 document(s) successfully\",\n \"createTime\": \"TIMESTAMP\",\n \"updateTime\": \"TIMESTAMP\",\n \"individualProcessStatuses\": [  {\n  \"inputGcsSource\": \"INPUT_BUCKET_FOLDER/DOCUMENT1.ext\",\n  \"status\": {},\n  \"outputGcsDestination\": \"OUTPUT_BUCKET_FOLDER/OPERATION_ID/0\",\n  \"humanReviewStatus\": {\n   \"state\": \"ERROR\",\n   \"stateMessage\": \"Sharded document protos are not supported for human review.\"\n  }\n  }\n ]\n },\n \"done\": true,\n \"response\": {\n \"@type\": \"type.googleapis.com/google.cloud.documentai.v1.BatchProcessResponse\"\n }\n}\n```\nFor more information, see the [Document AI Go API reference documentation](/go/docs/reference/cloud.google.com/go/documentai/latest/apiv1) .\nTo authenticate to Document AI, set up Application Default Credentials.  For more information, see [Set up authentication for a local development environment](/docs/authentication/provide-credentials-adc#local-dev) .\n [View on GitHub](https://github.com/googleapis/google-cloud-go/blob/HEAD/internal/generated/snippets/documentai/apiv1/DocumentProcessorClient/GetOperation/main.go) \n```\npackage mainimport (\u00a0 \u00a0 \u00a0 \u00a0 \"context\"\u00a0 \u00a0 \u00a0 \u00a0 documentai \"cloud.google.com/go/documentai/apiv1\"\u00a0 \u00a0 \u00a0 \u00a0 longrunningpb \"cloud.google.com/go/longrunning/autogen/longrunningpb\")func main() {\u00a0 \u00a0 \u00a0 \u00a0 ctx := context.Background()\u00a0 \u00a0 \u00a0 \u00a0 // This snippet has been automatically generated and should be regarded as a code template only.\u00a0 \u00a0 \u00a0 \u00a0 // It will require modifications to work:\u00a0 \u00a0 \u00a0 \u00a0 // - It may require correct/in-range values for request initialization.\u00a0 \u00a0 \u00a0 \u00a0 // - It may require specifying regional endpoints when creating the service client as shown in:\u00a0 \u00a0 \u00a0 \u00a0 // \u00a0 https://pkg.go.dev/cloud.google.com/go#hdr-Client_Options\u00a0 \u00a0 \u00a0 \u00a0 c, err := documentai.NewDocumentProcessorClient(ctx)\u00a0 \u00a0 \u00a0 \u00a0 if err != nil {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 // TODO: Handle error.\u00a0 \u00a0 \u00a0 \u00a0 }\u00a0 \u00a0 \u00a0 \u00a0 defer c.Close()\u00a0 \u00a0 \u00a0 \u00a0 req := &longrunningpb.GetOperationRequest{\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 // TODO: Fill request struct fields.\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 // See https://pkg.go.dev/cloud.google.com/go/longrunning/autogen/longrunningpb#GetOperationRequest.\u00a0 \u00a0 \u00a0 \u00a0 }\u00a0 \u00a0 \u00a0 \u00a0 resp, err := c.GetOperation(ctx, req)\u00a0 \u00a0 \u00a0 \u00a0 if err != nil {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 // TODO: Handle error.\u00a0 \u00a0 \u00a0 \u00a0 }\u00a0 \u00a0 \u00a0 \u00a0 // TODO: Use resp.\u00a0 \u00a0 \u00a0 \u00a0 _ = resp}\n```For more information, see the [Document AI Python API reference documentation](/python/docs/reference/documentai/latest) .\nTo authenticate to Document AI, set up Application Default Credentials.  For more information, see [Set up authentication for a local development environment](/docs/authentication/provide-credentials-adc#local-dev) .\n [View on GitHub](https://github.com/GoogleCloudPlatform/python-docs-samples/blob/HEAD/documentai/snippets/get_operation_sample.py) \n```\nfrom google.api_core.client_options import ClientOptionsfrom google.cloud import documentai \u00a0# type: ignorefrom google.longrunning.operations_pb2 import GetOperationRequest \u00a0# type: ignore# TODO(developer): Uncomment these variables before running the sample.# location = \"YOUR_PROCESSOR_LOCATION\" \u00a0# Format is \"us\" or \"eu\"# operation_name = \"YOUR_OPERATION_NAME\" \u00a0# Format is \"projects/{project_id}/locations/{location}/operations/{operation_id}\"def get_operation_sample(location: str, operation_name: str) -> None:\u00a0 \u00a0 # You must set the `api_endpoint` if you use a location other than \"us\".\u00a0 \u00a0 opts = ClientOptions(api_endpoint=f\"{location}-documentai.googleapis.com\")\u00a0 \u00a0 client = documentai.DocumentProcessorServiceClient(client_options=opts)\u00a0 \u00a0 request = GetOperationRequest(name=operation_name)\u00a0 \u00a0 # Make GetOperation request\u00a0 \u00a0 operation = client.get_operation(request=request)\u00a0 \u00a0 # Print the Operation Information\u00a0 \u00a0 print(operation)\n```\n## Listing long-running operations\nThe following samples show how to list the LROs in a Google Cloud project and location.\nTo list the LROs in a Google Cloud project and location, call the [projects.locations.operations.list](/document-ai/docs/reference/rest/v1/projects.locations.operations/list) method.\nBefore using any of the request data, make the following replacements:- : Your Google Cloud project ID.\n- : the [location](/document-ai/docs/regions) where one or more LROs are running, for example:- `us`- United States\n- `eu`- European Union\n- : (Required) Query for LROs to return. Options:- : (Required) LRO type to list. Options:\n- `BATCH_PROCESS_DOCUMENTS`\n- `CREATE_PROCESSOR_VERSION`\n- `DELETE_PROCESSOR`\n- `ENABLE_PROCESSOR`\n- `DISABLE_PROCESSOR`\n- `UPDATE_HUMAN_REVIEW_CONFIG`\n- `HUMAN_REVIEW_EVENT`\n- `CREATE_LABELER_POOL`\n- `UPDATE_LABELER_POOL`\n- `DELETE_LABELER_POOL`\n- `DEPLOY_PROCESSOR_VERSION`\n- `UNDEPLOY_PROCESSOR_VERSION`\n- `DELETE_PROCESSOR_VERSION`\n- `SET_DEFAULT_PROCESSOR_VERSION`\n- `EVALUATE_PROCESSOR_VERSION`\n- `EXPORT_PROCESSOR_VERSION`\n- `UPDATE_DATASET`\n- `IMPORT_DOCUMENTS`\n- `ANALYZE_HITL_DATA`\n- `BATCH_MOVE_DOCUMENTS`\n- `RESYNC_DATASET`\n- `BATCH_DELETE_DOCUMENTS`\n- `DELETE_DATA_LABELING_JOB`\n- `EXPORT_DOCUMENTS`\nHTTP method and URL:\n```\nGET https://LOCATION-documentai.googleapis.com/v1/projects/PROJECT_ID/locations/LOCATION/operations?filter=TYPE=TYPE\n```\nTo send your request, choose one of these options:\n **Note:** The following command assumes that you have logged in to  the`gcloud`CLI with your user account by running [gcloud init](/sdk/gcloud/reference/init) or [gcloud auth login](/sdk/gcloud/reference/auth/login) ,  or by using [Cloud Shell](/shell/docs) ,  which automatically logs you into the`gcloud`CLI.  You can check the currently active account by running [gcloud auth list](/sdk/gcloud/reference/auth/list) .\nExecute the following command:\n```\ncurl -X GET \\ -H \"Authorization: Bearer $(gcloud auth print-access-token)\" \\ \"https://LOCATION-documentai.googleapis.com/v1/projects/PROJECT_ID/locations/LOCATION/operations?filter=TYPE=TYPE\"\n``` **Note:** The following command assumes that you have logged in to  the`gcloud`CLI with your user account by running [gcloud init](/sdk/gcloud/reference/init) or [gcloud auth login](/sdk/gcloud/reference/auth/login) ,  or by using [Cloud Shell](/shell/docs) ,  which automatically logs you into the`gcloud`CLI.  You can check the currently active account by running [gcloud auth list](/sdk/gcloud/reference/auth/list) .\nExecute the following command:\n```\n$cred = gcloud auth print-access-token$headers = @{ \"Authorization\" = \"Bearer $cred\" }Invoke-WebRequest ` -Method GET ` -Headers $headers ` -Uri \"https://LOCATION-documentai.googleapis.com/v1/projects/PROJECT_ID/locations/LOCATION/operations?filter=TYPE=TYPE\" | Select-Object -Expand Content\n```\nYou should receive a JSON response similar to the following:\n```\n{\n \"operations\": [ {\n  \"name\": \"projects/PROJECT_ID/locations/LOCATION/operations/OPERATION_ID\",\n  \"metadata\": {\n  \"@type\": \"type.googleapis.com/google.cloud.documentai.v1.BatchProcessMetadata\",\n  \"state\": \"SUCCEEDED\",\n  \"stateMessage\": \"Processed 1 document(s) successfully\",\n  \"createTime\": \"TIMESTAMP\",\n  \"updateTime\": \"TIMESTAMP\",\n  \"individualProcessStatuses\": [   {\n   \"inputGcsSource\": \"INPUT_BUCKET_FOLDER/DOCUMENT1.ext\",\n   \"status\": {},\n   \"outputGcsDestination\": \"OUTPUT_BUCKET_FOLDER/OPERATION_ID/0\",\n   \"humanReviewStatus\": {\n    \"state\": \"ERROR\",\n    \"stateMessage\": \"Sharded document protos are not supported for human review.\"\n   }\n   }\n  ]\n  },\n  \"done\": true,\n  \"response\": {\n  \"@type\": \"type.googleapis.com/google.cloud.documentai.v1.BatchProcessResponse\"\n  }\n },\n ...\n ]\n}\n```\nFor more information, see the [Document AI Go API reference documentation](/go/docs/reference/cloud.google.com/go/documentai/latest/apiv1) .\nTo authenticate to Document AI, set up Application Default Credentials.  For more information, see [Set up authentication for a local development environment](/docs/authentication/provide-credentials-adc#local-dev) .\n [View on GitHub](https://github.com/googleapis/google-cloud-go/blob/HEAD/internal/generated/snippets/documentai/apiv1/DocumentProcessorClient/ListOperations/main.go) \n```\npackage mainimport (\u00a0 \u00a0 \u00a0 \u00a0 \"context\"\u00a0 \u00a0 \u00a0 \u00a0 documentai \"cloud.google.com/go/documentai/apiv1\"\u00a0 \u00a0 \u00a0 \u00a0 longrunningpb \"cloud.google.com/go/longrunning/autogen/longrunningpb\"\u00a0 \u00a0 \u00a0 \u00a0 \"google.golang.org/api/iterator\")func main() {\u00a0 \u00a0 \u00a0 \u00a0 ctx := context.Background()\u00a0 \u00a0 \u00a0 \u00a0 // This snippet has been automatically generated and should be regarded as a code template only.\u00a0 \u00a0 \u00a0 \u00a0 // It will require modifications to work:\u00a0 \u00a0 \u00a0 \u00a0 // - It may require correct/in-range values for request initialization.\u00a0 \u00a0 \u00a0 \u00a0 // - It may require specifying regional endpoints when creating the service client as shown in:\u00a0 \u00a0 \u00a0 \u00a0 // \u00a0 https://pkg.go.dev/cloud.google.com/go#hdr-Client_Options\u00a0 \u00a0 \u00a0 \u00a0 c, err := documentai.NewDocumentProcessorClient(ctx)\u00a0 \u00a0 \u00a0 \u00a0 if err != nil {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 // TODO: Handle error.\u00a0 \u00a0 \u00a0 \u00a0 }\u00a0 \u00a0 \u00a0 \u00a0 defer c.Close()\u00a0 \u00a0 \u00a0 \u00a0 req := &longrunningpb.ListOperationsRequest{\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 // TODO: Fill request struct fields.\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 // See https://pkg.go.dev/cloud.google.com/go/longrunning/autogen/longrunningpb#ListOperationsRequest.\u00a0 \u00a0 \u00a0 \u00a0 }\u00a0 \u00a0 \u00a0 \u00a0 it := c.ListOperations(ctx, req)\u00a0 \u00a0 \u00a0 \u00a0 for {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 resp, err := it.Next()\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 if err == iterator.Done {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 break\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 }\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 if err != nil {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 // TODO: Handle error.\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 }\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 // TODO: Use resp.\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 _ = resp\u00a0 \u00a0 \u00a0 \u00a0 }}\n```For more information, see the [Document AI Python API reference documentation](/python/docs/reference/documentai/latest) .\nTo authenticate to Document AI, set up Application Default Credentials.  For more information, see [Set up authentication for a local development environment](/docs/authentication/provide-credentials-adc#local-dev) .\n [View on GitHub](https://github.com/GoogleCloudPlatform/python-docs-samples/blob/HEAD/documentai/snippets/list_operations_sample.py) \n```\nfrom google.api_core.client_options import ClientOptionsfrom google.cloud import documentai \u00a0# type: ignorefrom google.longrunning.operations_pb2 import ListOperationsRequest \u00a0# type: ignore# TODO(developer): Uncomment these variables before running the sample.# project_id = \"YOUR_PROJECT_ID\"# location = \"YOUR_PROCESSOR_LOCATION\" \u00a0# Format is \"us\" or \"eu\"# Create filter in https://google.aip.dev/160 syntax# For full options, refer to:# https://cloud.google.com/document-ai/docs/long-running-operations#listing_long-running_operations# operations_filter = 'YOUR_FILTER'# Example:# operations_filter = \"TYPE=BATCH_PROCESS_DOCUMENTS AND STATE=RUNNING\"def list_operations_sample(\u00a0 \u00a0 project_id: str, location: str, operations_filter: str) -> None:\u00a0 \u00a0 # You must set the `api_endpoint` if you use a location other than \"us\".\u00a0 \u00a0 opts = ClientOptions(api_endpoint=f\"{location}-documentai.googleapis.com\")\u00a0 \u00a0 client = documentai.DocumentProcessorServiceClient(client_options=opts)\u00a0 \u00a0 # Format: `projects/{project_id}/locations/{location}`\u00a0 \u00a0 name = client.common_location_path(project=project_id, location=location)\u00a0 \u00a0 request = ListOperationsRequest(\u00a0 \u00a0 \u00a0 \u00a0 name=f\"{name}/operations\",\u00a0 \u00a0 \u00a0 \u00a0 filter=operations_filter,\u00a0 \u00a0 )\u00a0 \u00a0 # Make ListOperations request\u00a0 \u00a0 operations = client.list_operations(request=request)\u00a0 \u00a0 # Print the Operation Information\u00a0 \u00a0 print(operations)\n```\n## Polling a long-running operation\nThe following samples show how to poll the status of an LRO.\nTo poll an LRO, repeatedly call the [projects.locations.operations.get](/document-ai/docs/reference/rest/v1/projects.locations.operations/get) method until the operation finishes. Use a backoff between each poll request, such as 10 seconds.\nBefore using any of the request data below, make the following replacements:- : your Google Cloud project ID\n- : the location where the LRO is running\n- : the identifier for the LRO\nHTTP method and URL:\n```\nGET https://LOCATION-documentai.googleapis.com/v1/projects/PROJECT_ID/locations/LOCATION/operations/OPERATION_ID\u00a0 \n```\nTo send your request, choose one of these options:\n **Note:** If you are not executing the commands below from [Cloud Shell](/shell/docs) or [Compute Engine](/compute) , ensure you have set the [GOOGLE_APPLICATION_CREDENTIALS](/docs/authentication/production) environment variable to your service account private key file path.\nExecute the following command to poll for the status of an LRO every 10 seconds:\n```\nwhile true; \\\u00a0 \u00a0 do curl -X GET \\\u00a0 \u00a0 -H \"Authorization: Bearer \"$(gcloud auth print-access-token) \\\u00a0 \u00a0 \"https://LOCATION-documentai.googleapis.com/v1/projects/PROJECT_ID/locations/LOCATION/operations/OPERATION_ID\"; \\\u00a0 \u00a0 sleep 10; \\\u00a0 \u00a0 done\n```\nYou should receive a JSON response every 10 seconds. While the operation is running, the response will contain `\"state\": \"RUNNING\"` . When the operation finishes, the response will contain `\"state\": \"SUCCEEDED\"` and `\"done\": true` .\nExecute the following command to poll for the status of an LRO every ten seconds:\n```\n$cred = gcloud auth print-access-token$headers = @{ Authorization = \"Bearer $cred\" }Do {\u00a0 Invoke-WebRequest `\u00a0 \u00a0 -Method Get `\u00a0 \u00a0 -Headers $headers `\u00a0 \u00a0 -Uri \"https://LOCATION-documentai.googleapis.com/v1/projects/PROJECT_ID/locations/LOCATION/operations/OPERATION_ID\" | Select-Object -Expand Contentsleep 10}while ($true)\n```\nYou should receive a JSON response every 10 seconds. While the operation is running, the response will contain `\"state\": \"RUNNING\"` . When the operation finishes, the response will contain `\"state\": \"SUCCEEDED\"` and `\"done\": true` .For more information, see the [Document AI Python API reference documentation](/python/docs/reference/documentai/latest) .\nTo authenticate to Document AI, set up Application Default Credentials.  For more information, see [Set up authentication for a local development environment](/docs/authentication/provide-credentials-adc#local-dev) .\n [View on GitHub](https://github.com/GoogleCloudPlatform/python-docs-samples/blob/HEAD/documentai/snippets/poll_operation_sample.py) \n```\nfrom time import sleepfrom google.api_core.client_options import ClientOptionsfrom google.cloud import documentai \u00a0# type: ignorefrom google.longrunning.operations_pb2 import GetOperationRequest \u00a0# type: ignore# TODO(developer): Uncomment these variables before running the sample.# location = \"YOUR_PROCESSOR_LOCATION\" \u00a0# Format is \"us\" or \"eu\"# operation_name = \"YOUR_OPERATION_NAME\" \u00a0# Format is \"projects/{project_id}/locations/{location}/operations/{operation_id}\"def poll_operation_sample(location: str, operation_name: str) -> None:\u00a0 \u00a0 # You must set the `api_endpoint` if you use a location other than \"us\".\u00a0 \u00a0 opts = ClientOptions(api_endpoint=f\"{location}-documentai.googleapis.com\")\u00a0 \u00a0 client = documentai.DocumentProcessorServiceClient(client_options=opts)\u00a0 \u00a0 request = GetOperationRequest(name=operation_name)\u00a0 \u00a0 while True:\u00a0 \u00a0 \u00a0 \u00a0 # Make GetOperation request\u00a0 \u00a0 \u00a0 \u00a0 operation = client.get_operation(request=request)\u00a0 \u00a0 \u00a0 \u00a0 # Print the Operation Information\u00a0 \u00a0 \u00a0 \u00a0 print(operation)\u00a0 \u00a0 \u00a0 \u00a0 # Stop polling when Operation is no longer running\u00a0 \u00a0 \u00a0 \u00a0 if operation.done:\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 break\u00a0 \u00a0 \u00a0 \u00a0 # Wait 10 seconds before polling again\u00a0 \u00a0 \u00a0 \u00a0 sleep(10)\n```\n## Cancelling a long-running operation\nThe following samples show how to cancel an LRO while it is running.\nTo cancel an LRO, call the [projects.locations.operations.cancel](/document-ai/docs/reference/rest/v1/projects.locations.operations/cancel) method.\nBefore using any of the request data, make the following replacements:- : Your Google Cloud project ID.\n- : the [location](/document-ai/docs/regions) where the LRO is running, for example:- `us`- United States\n- `eu`- European Union\n- : The ID of your operation. The ID is the last element of the name of your operation. For example:- Operation name:`projects/` `` `/locations/` `` `/operations/` ` **bc4e1d412863e626** `\n- Operation id:` **bc4e1d412863e626** `\nHTTP method and URL:\n```\nPOST https://LOCATION-documentai.googleapis.com/v1/projects/PROJECT_ID/locations/LOCATION/operations/OPERATION_ID:cancel\n```\nTo send your request, choose one of these options:\n **Note:** The following command assumes that you have logged in to  the`gcloud`CLI with your user account by running [gcloud init](/sdk/gcloud/reference/init) or [gcloud auth login](/sdk/gcloud/reference/auth/login) ,  or by using [Cloud Shell](/shell/docs) ,  which automatically logs you into the`gcloud`CLI.  You can check the currently active account by running [gcloud auth list](/sdk/gcloud/reference/auth/list) .\nExecute the following command:\n```\ncurl -X POST \\ -H \"Authorization: Bearer $(gcloud auth print-access-token)\" \\ -H \"Content-Type: application/json; charset=utf-8\" \\ -d \"\" \\ \"https://LOCATION-documentai.googleapis.com/v1/projects/PROJECT_ID/locations/LOCATION/operations/OPERATION_ID:cancel\"\n``` **Note:** The following command assumes that you have logged in to  the`gcloud`CLI with your user account by running [gcloud init](/sdk/gcloud/reference/init) or [gcloud auth login](/sdk/gcloud/reference/auth/login) ,  or by using [Cloud Shell](/shell/docs) ,  which automatically logs you into the`gcloud`CLI.  You can check the currently active account by running [gcloud auth list](/sdk/gcloud/reference/auth/list) .\nExecute the following command:\n```\n$cred = gcloud auth print-access-token$headers = @{ \"Authorization\" = \"Bearer $cred\" }Invoke-WebRequest ` -Method POST ` -Headers $headers ` -Uri \"https://LOCATION-documentai.googleapis.com/v1/projects/PROJECT_ID/locations/LOCATION/operations/OPERATION_ID:cancel\" | Select-Object -Expand Content\n```\nYou should receive a JSON response similar to the following:\n```\n{}\n```\nIf you attempt to cancel an operation that has already completed, you should receive the following error message:\n```\n\u00a0 \"error\": {\u00a0 \u00a0 \u00a0 \"code\": 400,\u00a0 \u00a0 \u00a0 \"message\": \"Operation has completed and cannot be cancelled: 'PROJECT_ID/locations/LOCATION/operations/OPERATION_ID'.\",\u00a0 \u00a0 \u00a0 \"status\": \"FAILED_PRECONDITION\"\u00a0 }\n```For more information, see the [Document AI Go API reference documentation](/go/docs/reference/cloud.google.com/go/documentai/latest/apiv1) .\nTo authenticate to Document AI, set up Application Default Credentials.  For more information, see [Set up authentication for a local development environment](/docs/authentication/provide-credentials-adc#local-dev) .\n [View on GitHub](https://github.com/googleapis/google-cloud-go/blob/HEAD/internal/generated/snippets/documentai/apiv1/DocumentProcessorClient/CancelOperation/main.go) \n```\npackage mainimport (\u00a0 \u00a0 \u00a0 \u00a0 \"context\"\u00a0 \u00a0 \u00a0 \u00a0 documentai \"cloud.google.com/go/documentai/apiv1\"\u00a0 \u00a0 \u00a0 \u00a0 longrunningpb \"cloud.google.com/go/longrunning/autogen/longrunningpb\")func main() {\u00a0 \u00a0 \u00a0 \u00a0 ctx := context.Background()\u00a0 \u00a0 \u00a0 \u00a0 // This snippet has been automatically generated and should be regarded as a code template only.\u00a0 \u00a0 \u00a0 \u00a0 // It will require modifications to work:\u00a0 \u00a0 \u00a0 \u00a0 // - It may require correct/in-range values for request initialization.\u00a0 \u00a0 \u00a0 \u00a0 // - It may require specifying regional endpoints when creating the service client as shown in:\u00a0 \u00a0 \u00a0 \u00a0 // \u00a0 https://pkg.go.dev/cloud.google.com/go#hdr-Client_Options\u00a0 \u00a0 \u00a0 \u00a0 c, err := documentai.NewDocumentProcessorClient(ctx)\u00a0 \u00a0 \u00a0 \u00a0 if err != nil {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 // TODO: Handle error.\u00a0 \u00a0 \u00a0 \u00a0 }\u00a0 \u00a0 \u00a0 \u00a0 defer c.Close()\u00a0 \u00a0 \u00a0 \u00a0 req := &longrunningpb.CancelOperationRequest{\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 // TODO: Fill request struct fields.\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 // See https://pkg.go.dev/cloud.google.com/go/longrunning/autogen/longrunningpb#CancelOperationRequest.\u00a0 \u00a0 \u00a0 \u00a0 }\u00a0 \u00a0 \u00a0 \u00a0 err = c.CancelOperation(ctx, req)\u00a0 \u00a0 \u00a0 \u00a0 if err != nil {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 // TODO: Handle error.\u00a0 \u00a0 \u00a0 \u00a0 }}\n```For more information, see the [Document AI Python API reference documentation](/python/docs/reference/documentai/latest) .\nTo authenticate to Document AI, set up Application Default Credentials.  For more information, see [Set up authentication for a local development environment](/docs/authentication/provide-credentials-adc#local-dev) .\n [View on GitHub](https://github.com/GoogleCloudPlatform/python-docs-samples/blob/HEAD/documentai/snippets/cancel_operation_sample.py) \n```\nfrom google.api_core.client_options import ClientOptionsfrom google.cloud import documentai \u00a0# type: ignorefrom google.longrunning.operations_pb2 import CancelOperationRequest \u00a0# type: ignore# TODO(developer): Uncomment these variables before running the sample.# location = \"YOUR_PROCESSOR_LOCATION\" \u00a0# Format is \"us\" or \"eu\"# operation_name = \"YOUR_OPERATION_NAME\" \u00a0# Format is \"projects/{project_id}/locations/{location}/operations/{operation_id}\"def cancel_operation_sample(location: str, operation_name: str) -> None:\u00a0 \u00a0 # You must set the `api_endpoint` if you use a location other than \"us\".\u00a0 \u00a0 opts = ClientOptions(api_endpoint=f\"{location}-documentai.googleapis.com\")\u00a0 \u00a0 client = documentai.DocumentProcessorServiceClient(client_options=opts)\u00a0 \u00a0 request = CancelOperationRequest(name=operation_name)\u00a0 \u00a0 # Make CancelOperation request\u00a0 \u00a0 client.cancel_operation(request=request)\u00a0 \u00a0 print(f\"Operation {operation_name} cancelled\")\n```", "guide": "Document AI"}