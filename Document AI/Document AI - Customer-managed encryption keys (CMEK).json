{"title": "Document AI - Customer-managed encryption keys (CMEK)", "url": "https://cloud.google.com/document-ai/docs/cmek?hl=zh-cn", "abstract": "# Document AI - Customer-managed encryption keys (CMEK)\n# Customer-managed encryption keys (CMEK)\nBy default, Google Cloud automatically [encrypts data when it is atrest](/security/encryption-at-rest/default-encryption) using encryption keys managed by Google.\nIf you have specific compliance or regulatory requirements related to the keys that protect your data, you can use customer-managed encryption keys (CMEK) for Document AI. Instead of Google managing the encryption keys that protect your data, your Document AI processor is protected using a key that you control and manage in [Cloud Key Management Service (KMS)](/security-key-management) .\nThis guide describes CMEK for Document AI. For more information about CMEK in general, including when and why to enable it, see the [Cloud Key Management Service documentation](/kms/docs/cmek) .\n", "content": "## Using CMEK\nEncryption settings are available when you [create a processor](/document-ai/docs/create-processor) . To use CMEK, select the **CMEK** option and select a key as shown below.\n**Note:** The location of your key must match the location of your processor. For example, if your processor is located in `us-central1` , the corresponding CMEK key must also be located in `us-central1` . However, for the `us` and `eu` multi-regions the key must be located in `us-central1` and `europe-west4` respectively.\nThe CMEK key is used for all data associated with the processor, and its child resources. All customer-related data that is sent to the processor is automatically encrypted with the provided key before writing to disk.\nOnce a processor has been created, you cannot change its encryption settings. To use a different key, you must create a new processor.\n## External keys\nYou can use [Cloud External Key Manager](/kms/docs/ekm) to create and manage external keys to encrypt data within Google Cloud.\nWhen you use a Cloud EKM key, Google has no control over the availability of your externally managed key. If you request access to a resource encrypted with an externally managed key, and the key is unavailable, then Document AI will reject the request. There can be a delay of up to 10 minutes before you can access the resource after the key becomes available.\nFor more considerations when using external keys, see [EKM considerations](/kms/docs/ekm#considerations) .\n## CMEK supported resources\nWhen storing any resource to disk, if any customer data is stored as part of the resource, Document AI first encrypts the contents using the CMEK key.\n| Resource   | Material Encrypted                      |\n|:------------------|:--------------------------------------------------------------------------------------------------------|\n| Processor   | N/A - no user data. However, if you specify a CMEK key during processor creation then it must be valid. |\n| ProcessorVersion | schema                         |\n| HumanReviewConfig | validation_criteria, labeling_schema, review_instructions            |\n| Evaluation  | All                          |\n## CMEK supported APIs\nThe APIs that use the CMEK key for encryption include the following:\n| Method     | Encryption                        |\n|:-------------------------|:---------------------------------------------------------------------------------------------------------|\n| processDocument   | N/A - no data saved to disk.                    |\n| batchProcessDocuments | Data is temporarily stored on disk and encrypted using an ephemeral key (see CMEK compliance).   |\n| reviewDocument   | Documents pending review are stored in a Cloud Storage bucket encrypted using the provided KMS/CMEK key. |\n| trainProcessorVersion | Documents used for training are encrypted using the provided KMS/CMEK key.        |\n| evaluateProcessorVersion | Evaluations are encrypted using the provided KMS/CMEK key.            |\nAPI requests that access encrypted resources will fail if the key is disabled or is unreachable. Examples include the following:\n| Method    | Decryption                        |\n|:--------------------|:---------------------------------------------------------------------------------------------------------|\n| getProcessorVersion | Processor versions trained using customer data are encrypted. Access requires decryption.    |\n| processDocument  | Processing documents using an encrypted processor version requires decryption.       |\n| Import Documents | Importing documents with auto-labeling enabled using an encrypted processor version requires decryption. |\n**Note:** [Human-in-the-Loop (HITL)](/document-ai/docs/hitl) is currently not supported with external keys from Cloud EKM.\n## CMEK and Cloud Storage\nAPIs, such as [batchProcess](/document-ai/docs/reference/rest/v1/projects.locations.processors/batchProcess) and [reviewDocument](/document-ai/docs/reference/rest/v1/projects.locations.processors.humanReviewConfig/reviewDocument) , can read from and write to Cloud Storage buckets.\nAny data written to Cloud Storage by Document AI will be encrypted using the bucket's configured encryption key, which can be different than your processor's CMEK key.\nFor more information, see the [CMEK documentation for Cloud Storage](/storage/docs/encryption/customer-managed-keys) .", "guide": "Document AI"}