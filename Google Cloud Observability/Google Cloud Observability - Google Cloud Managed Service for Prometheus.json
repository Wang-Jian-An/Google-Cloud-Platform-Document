{"title": "Google Cloud Observability - Google Cloud Managed Service for Prometheus", "url": "https://cloud.google.com/stackdriver/docs/managed-prometheus?hl=zh-cn", "abstract": "# Google Cloud Observability - Google Cloud Managed Service for Prometheus\nGoogle Cloud Managed Service for Prometheus \u662f\u91dd\u5c0d [Prometheus](https://prometheus.io) \u6307\u6a19\u7684 Google Cloud \u5168\u4ee3\u7ba1\u5f0f\u591a\u96f2\u8de8\u9805\u76ee\u89e3\u6c7a\u65b9\u6848\u3002\u60a8\u53ef\u4ee5\u4f7f\u7528 Prometheus \u5168\u5c40\u76e3\u63a7\u5de5\u4f5c\u8ca0\u8f09\u4f75\u767c\u51fa\u63d0\u9192\uff0c\u800c\u7121\u9700\u5927\u898f\u6a21\u624b\u52d5\u7ba1\u7406\u548c\u64cd\u4f5c Prometheus\u3002\nManaged Service for Prometheus \u6703\u5f9e Prometheus \u5c0e\u51fa\u5668\u4e2d\u6536\u96c6\u6307\u6a19\uff0c\u4e26\u652f\u6301\u4f7f\u7528 PromQL \u5168\u5c40\u67e5\u8a62\u6578\u64da\uff0c\u9019\u610f\u5473\u7740\u60a8\u53ef\u4ee5\u7e7c\u7e8c\u4f7f\u7528\u4efb\u4f55\u73fe\u6709\u7684 [Grafana](https://grafana.com/grafana) \u4fe1\u606f\u4e2d\u5fc3\u3001\u57fa\u65bc PromQL \u7684\u63d0\u9192\u548c\u5de5\u4f5c\u6d41\u3002\u5b83\u8207\u6df7\u5408\u96f2\u548c\u591a\u96f2\u517c\u5bb9\uff0c\u53ef\u4ee5\u76e3\u63a7 Kubernetes\u3001\u865b\u64ec\u6a5f\u548c Cloud Run \u4e0a\u7684\u7121\u670d\u52d9\u5668\u5de5\u4f5c\u8ca0\u8f09\uff0c\u5c07\u6578\u64da\u4fdd\u7559 24 \u500b\u6708\uff0c\u4e26\u8207\u4e0a\u6e38 Prometheus \u4fdd\u6301\u517c\u5bb9\u4ee5\u7dad\u6301\u53ef\u79fb\u690d\u6027\u3002\u60a8\u9084\u53ef\u4ee5\u4f7f\u7528 PromQL \u5728 Cloud Monitoring \u4e2d\u67e5\u8a62 [\u8d85\u904e 1500 \u500b\u514d\u8cbb\u6307\u6a19](https://cloud.google.com/monitoring/api/metrics_gcp?hl=zh-cn) \uff08\u5305\u62ec [\u514d\u8cbb\u7684 GKE \u7cfb\u7d71\u6307\u6a19](https://cloud.google.com/monitoring/api/metrics_kubernetes?hl=zh-cn) \uff09\uff0c\u4f5c\u7232 Prometheus \u76e3\u63a7\u7684\u88dc\u5145\u3002\n\u672c\u6587\u6a94\u7c21\u8981\u4ecb\u7d39\u4ee3\u7ba1\u5f0f\u670d\u52d9\uff0c\u6b64\u5916\u9084\u6709\u5176\u4ed6\u6587\u6a94\u4ecb\u7d39\u5982\u4f55\u8a2d\u7f6e\u548c\u904b\u884c\u8a72\u670d\u52d9\u3002\u5982\u9700\u5b9a\u671f\u63a5\u6536\u65b0\u529f\u80fd\u548c\u7248\u672c\u7684\u6700\u65b0\u52d5\u614b\uff0c\u8acb\u63d0\u4ea4\u53ef\u9078\u7684 [\u8a3b\u518a\u8868\u55ae](https://docs.google.com/forms/d/e/1FAIpQLScXB4ezLOF_0ifXrz9THQz7w9B4fS0yPkX4Ul1w-gkbPRf2EA/viewform?hl=zh-cn) \u3002\n\u77ad\u89e3\u5bb6\u5f97\u5bf6\u516c\u53f8\u5982\u4f55\u4f7f\u7528 Managed Service for Prometheus \u5728\u904b\u884c Kubernetes \u672c\u5730\u96c6\u7fa3\u7684 2,200 \u5bb6\u9580\u5e97\u4e2d\u7d71\u4e00\u53ef\u89c0\u6e2c\u6027\uff1a", "content": "## \u7cfb\u7d71\u6982\u89bd\nGoogle Cloud Managed Service for Prometheus \u53ef\u8b93\u60a8\u719f\u6089 Prometheus\uff0c\u5f8c\u8005\u7531 Cloud Monitoring \u7684\u5168\u7403\u591a\u96f2\u8de8\u9805\u76ee\u57fa\u790e\u67b6\u69cb\u63d0\u4f9b\u652f\u6301\u3002\nManaged Service for Prometheus \u57fa\u65bc Monarch \u69cb\u5efa\u3002Monarch \u662f [\u53ef\u5168\u5c40\u64f4\u7e2e\u7684\u6578\u64da\u5b58\u5132\u5340](https://research.google/pubs/pub50652/?hl=zh-cn) \uff0cGoogle \u5c07\u5176\u7528\u65bc\u81ea\u5df1\u7684\u76e3\u63a7\u670d\u52d9\u3002\u7531\u65bc Managed Service for Prometheus \u4f7f\u7528\u8207 [Cloud Monitoring](https://cloud.google.com/monitoring?hl=zh-cn) \u76f8\u540c\u7684\u5f8c\u7aef\u548c API\uff0c\u56e0\u6b64 Cloud Monitoring \u6307\u6a19\u548c Managed Service for Prometheus \u6ce8\u5165\u7684\u6307\u6a19\u90fd\u53ef\u4ee5\u4f7f\u7528 [Cloud Monitoring \u4e2d\u7684 PromQL](https://cloud.google.com/stackdriver/docs/managed-prometheus/query-cm?hl=zh-cn) \u3001 [Grafana](https://cloud.google.com/stackdriver/docs/managed-prometheus/query?hl=zh-cn) \u6216 [\u4efb\u4f55\u80fd\u5920\u8b80\u53d6 Prometheus API \u7684\u5176\u4ed6\u5de5\u5177](https://cloud.google.com/stackdriver/docs/managed-prometheus/query-api-ui?hl=zh-cn) \u9032\u884c\u67e5\u8a62\u3002\n\u5728\u6a19\u6e96 Prometheus \u90e8\u7f72\u4e2d\uff0c\u6578\u64da\u6536\u96c6\u3001\u67e5\u8a62\u8a55\u4f30\u3001\u898f\u5247\u548c\u63d0\u9192\u8a55\u4f30\uff0c\u4ee5\u53ca\u6578\u64da\u5b58\u5132\u90fd\u5728\u55ae\u500b Prometheus \u670d\u52d9\u5668\u4e2d\u8655\u7406\u3002Managed Service for Prometheus \u5c07\u9019\u4e9b\u529f\u80fd\u7684\u8cac\u4efb\u62c6\u5206\u7232\u591a\u500b\u7d44\u4ef6\uff1a\n- [\u6578\u64da\u6536\u96c6](#gmp-data-collection) \u7531\u4ee3\u7ba1\u5f0f\u6536\u96c6\u5668\u3001\u81ea\u884c\u90e8\u7f72\u7684\u6536\u96c6\u5668\u3001OpenTelemetry \u6536\u96c6\u5668\u6216 [Ops Agent](https://cloud.google.com/monitoring/agent/ops-agent/prometheus?hl=zh-cn) \u8655\u7406\uff0c\u9019\u4e9b\u6536\u96c6\u5668\u6216\u4ee3\u7406\u6703\u722c\u53d6\u672c\u5730\u5c0e\u51fa\u5668\uff0c\u4e26\u5c07\u6536\u96c6\u5230\u7684\u6578\u64da\u8f49\u767c\u5230 Monarch\u3002\u9019\u4e9b\u6536\u96c6\u5668\u53ef\u7528\u65bc Kubernetes\u3001\u7121\u670d\u52d9\u5668\u548c\u50b3\u7d71\u865b\u64ec\u6a5f\u5de5\u4f5c\u8ca0\u8f09\uff0c\u4e26\u4e14\u53ef\u4ee5\u5728\u4efb\u4f55\u5730\u65b9\u904b\u884c\uff0c\u5305\u62ec\u5176\u4ed6\u96f2\u548c\u672c\u5730\u90e8\u7f72\u3002\n- [\u67e5\u8a62\u8a55\u4f30](#gmp-query-evaluation) \u7531 Monarch \u8655\u7406\uff0c\u5b83\u6703\u5728\u6240\u6709 Google Cloud \u5340\u57df\u548c\u591a\u9054 1,000 \u500b Google Cloud \u9805\u76ee\u4e2d\u57f7\u884c\u67e5\u8a62\u4e26\u806f\u5408\u7d50\u679c\u3002\n- [\u898f\u5247\u548c\u63d0\u9192\u8a55\u4f30](#gmp-rule-evaluation) \u7684\u8655\u7406\u65b9\u5f0f\u5982\u4e0b\uff1a\u7de8\u5beb [Cloud Monitoring \u4e2d\u7684 PromQL \u63d0\u9192](https://cloud.google.com/monitoring/promql/promql-in-alerting?hl=zh-cn) \uff0c\u9019\u4e9b\u63d0\u9192\u5b8c\u5168\u5728\u96f2\u7aef\u57f7\u884c\uff1b\u6216\u8005\uff0c\u4f7f\u7528\u672c\u5730\u904b\u884c\u548c\u672c\u5730\u914d\u7f6e\u7684\u898f\u5247\u8a55\u4f30\u5668\u7d44\u4ef6\uff0c\u9019\u4e9b\u7d44\u4ef6\u91dd\u5c0d\u5168\u5c40 Monarch \u6578\u64da\u5b58\u5132\u5340\u57f7\u884c\u898f\u5247\u548c\u63d0\u9192\uff0c\u4e26\u5c07\u6240\u6709\u89f8\u767c\u7684\u63d0\u9192\u8f49\u767c\u5230 [Prometheus AlertManager](https://prometheus.io/docs/alerting/latest/alertmanager/) \u3002\n- [\u6578\u64da\u5b58\u5132](#gmp-data-storage) \u7531 Monarch \u8655\u7406\uff0c\u5b83\u6703\u5c07\u6240\u6709 Prometheus \u6578\u64da\u5b58\u5132 24 \u500b\u6708\uff0c\u4e0d\u7522\u751f\u984d\u5916\u8cbb\u7528\u3002\nGrafana \u9023\u63a5\u5230\u5168\u5c40 Monarch \u6578\u64da\u5b58\u5132\u5340\uff0c\u800c\u4e0d\u662f\u9023\u63a5\u5230\u5404\u500b Prometheus \u670d\u52d9\u5668\u3002\u5982\u679c\u60a8\u5728\u6240\u6709\u90e8\u7f72\u4e2d\u914d\u7f6e\u4e86 Managed Service for Prometheus \u6536\u96c6\u5668\uff0c\u5247\u6b64\u55ae\u500b Grafana \u5be6\u4f8b\u53ef\u8b93\u60a8\u96c6\u4e2d\u67e5\u770b\u6240\u6709\u4e91\u4e2d\u7684\u6240\u6709\u6307\u6a19\u3002\n## \u6578\u64da\u6536\u96c6\n\u60a8\u53ef\u4ee5\u901a\u904e\u4ee5\u4e0b\u56db\u7a2e\u6a21\u5f0f\u4e4b\u4e00\u4f7f\u7528 Managed Service for Prometheus\uff1a\u4f7f\u7528 [\u4ee3\u7ba1\u5f0f\u6578\u64da\u6536\u96c6](https://cloud.google.com/stackdriver/docs/managed-prometheus/setup-managed?hl=zh-cn) \u3001 [\u81ea\u90e8\u7f72\u6578\u64da\u6536\u96c6](https://cloud.google.com/stackdriver/docs/managed-prometheus/setup-unmanaged?hl=zh-cn) \u3001 [OpenTelemetry \u6536\u96c6\u5668](https://cloud.google.com/stackdriver/docs/managed-prometheus/setup-otel?hl=zh-cn) \u6216 [Ops Agent](https://cloud.google.com/monitoring/agent/ops-agent/prometheus?hl=zh-cn) \u3002\nManaged Service for Prometheus \u7232 Kubernetes \u74b0\u5883\u4e2d\u7684\u4ee3\u7ba1\u5f0f\u6578\u64da\u6536\u96c6\u63d0\u4f9b operator\u3002\u6211\u5011\u5efa\u8b70\u60a8\u4f7f\u7528\u4ee3\u7ba1\u5f0f\u6536\u96c6\uff1b\u4f7f\u7528\u5b83\u53ef\u4f7f\u60a8\u514d\u65bc\u90e8\u7f72\u3001\u64f4\u7e2e\u3001\u5206\u7247\u3001\u914d\u7f6e\u548c\u7dad\u8b77 Prometheus \u670d\u52d9\u5668\u3002GKE \u548c\u975e GKE Kubernetes \u74b0\u5883\u5747\u652f\u6301\u4ee3\u7ba1\u5f0f\u6536\u96c6\u3002\n\u85c9\u52a9\u81ea\u90e8\u7f72\u6578\u64da\u6536\u96c6\uff0c\u60a8\u53ef\u4ee5\u50cf\u5f80\u5e38\u4e00\u6a23\u7ba1\u7406 Prometheus \u5b89\u88dd\u3002\u5b83\u8207\u4e0a\u6e38 Prometheus \u7684\u552f\u4e00\u5340\u5225\u5728\u65bc\uff0c\u60a8\u904b\u884cManaged Service for Prometheus \u76f4\u63a5\u66ff\u63db\u4e8c\u9032\u5236\u6587\u4ef6\uff0c\u800c\u4e0d\u662f\u4e0a\u6e38 Prometheus \u4e8c\u9032\u5236\u6587\u4ef6\u3002\nOpenTelemetry \u6536\u96c6\u5668\u53ef\u7528\u65bc\u722c\u53d6 Prometheus \u5c0e\u51fa\u5668\uff0c\u4e26\u5c07\u6578\u64da\u767c\u9001\u5230 Managed Service for Prometheus\u3002OpenTelemetry \u652f\u6301\u7232\u6240\u6709\u4fe1\u865f\u4f7f\u7528\u55ae\u4ee3\u7406\u7b56\u7565\uff0c\u901a\u904e\u8a72\u7b56\u7565\uff0c\u4e00\u500b\u6536\u96c6\u5668\u53ef\u7528\u65bc\u4efb\u4f55\u74b0\u5883\u4e2d\u7684\u6307\u6a19\uff08\u5305\u62ec Prometheus \u6307\u6a19\uff09\u3001\u65e5\u8a8c\u548c\u8ddf\u8e64\u8a18\u9304\u3002\n\u60a8\u53ef\u4ee5\u5728\u4efb\u4f55 Compute Engine \u5be6\u4f8b\u4e0a\u914d\u7f6e Ops Agent\uff0c\u4ee5\u722c\u53d6 Prometheus \u6307\u6a19\u4e26\u5c07\u5176\u767c\u9001\u5230\u5168\u5c40\u6578\u64da\u5b58\u5132\u5340\u3002\u4f7f\u7528\u4ee3\u7406\u53ef\u4ee5\u6975\u5927\u5730\u7c21\u5316\u865b\u64ec\u6a5f\u767c\u73fe\uff0c\u4e26\u4e14\u7121\u9700\u5728\u865b\u64ec\u6a5f\u74b0\u5883\u4e2d\u5b89\u88dd\u3001\u90e8\u7f72\u6216\u914d\u7f6e Prometheus\u3002\n\u5982\u679c\u60a8\u6709\u4e00\u9805\u53ef\u5beb\u5165 [Prometheus \u6307\u6a19](https://prometheus.io/docs/concepts/metric_types/) \u6216 [OTLP \u6307\u6a19](https://opentelemetry.io/docs/concepts/signals/metrics/) \u7684 Cloud Run \u670d\u52d9\uff0c\u90a3\u9ebc\u60a8\u53ef\u4ee5\u4f7f\u7528 Sidecar \u548c Managed Service for Prometheus \u5c07\u6307\u6a19\u767c\u9001\u5230 Cloud Monitoring\u3002\n- \u5982\u9700\u5f9e Cloud Run \u6536\u96c6 Prometheus \u6307\u6a19\uff0c\u8acb\u4f7f\u7528 [Prometheus Sidecar](https://cloud.google.com/stackdriver/docs/managed-prometheus/cloudrun-sidecar?hl=zh-cn) \u3002\n- \u5982\u9700\u5f9e Cloud Run \u6536\u96c6 OTLP \u6307\u6a19\uff0c\u8acb\u4f7f\u7528 [OpenTelemetry Sidecar](https://cloud.google.com/run/docs/tutorials/custom-metrics-opentelemetry-sidecar?hl=zh-cn) \u3002\n\u60a8\u53ef\u4ee5\u5728\u672c\u5730\u90e8\u7f72\u548c\u4efb\u4f55\u96f2\u4e2d\u904b\u884c\u8a17\u7ba1\u5f0f\u6536\u96c6\u5668\u3001\u81ea\u90e8\u7f72\u6536\u96c6\u5668\u548c OpenTelemetry \u6536\u96c6\u5668\u3002\u5728 Google Cloud \u5916\u90e8\u904b\u884c\u7684\u6536\u96c6\u5668\u6703\u5c07\u6578\u64da\u767c\u9001\u5230 Monarch\uff0c\u4ee5\u9032\u884c\u9577\u671f\u5b58\u5132\u548c\u5168\u5c40\u67e5\u8a62\u3002\n\u5728\u9078\u64c7\u6536\u96c6\u9078\u9805\u6642\uff0c\u8acb\u8003\u616e\u4ee5\u4e0b\u4e8b\u9805\uff1a\n- \u4ee3\u7ba1\u5f0f\u6536\u96c6\uff1a- Google \u63a8\u85a6\u5728\u6240\u6709 Kubernetes \u74b0\u5883\u4e2d\u4f7f\u7528\u7684\u65b9\u6cd5\u3002\n- \u4f7f\u7528 GKE \u754c\u9762\u3001gcloud CLI\u3001`kubectl`CLI \u6216 Terraform \u9032\u884c\u90e8\u7f72\u3002\n- Prometheus \u7684\u64cd\u4f5c\uff08\u751f\u6210\u6293\u53d6\u914d\u7f6e\u3001\u64f4\u7e2e\u6ce8\u5165\u3001\u5c07\u898f\u5247\u7684\u7bc4\u570d\u9650\u5b9a\u5230\u6b63\u78ba\u7684\u6578\u64da\u7b49\u7b49\uff09\u5b8c\u5168\u7531 Kubernetes operator \u8655\u7406\u3002\n- \u4f7f\u7528\u8f15\u91cf\u7d1a\u81ea\u5b9a\u7fa9\u8cc7\u6e90 (CR) \u914d\u7f6e\u6293\u53d6\u548c\u898f\u5247\u3002\n- \u9069\u5408\u5e0c\u671b\u4eab\u53d7\u81ea\u52d5\u5316\u7a0b\u5ea6\u66f4\u9ad8\u7684\u5168\u4ee3\u7ba1\u5f0f\u9ad4\u9a57\u7684\u7528\u6236\u3002\n- \u901a\u904e [prometheus-operator](https://github.com/prometheus-operator) \u914d\u7f6e\u9032\u884c\u76f4\u89c0\u9077\u79fb\u3002\n- \u652f\u6301\u6700\u65b0\u7684 Prometheus \u4f7f\u7528\u5834\u666f\u3002\n- Google Cloud \u6280\u8853\u652f\u6301\u63d0\u4f9b\u5b8c\u6574\u652f\u6301\u3002\n- \u81ea\u90e8\u7f72\u6536\u96c6\uff1a- \u53ef\u4ee5\u76f4\u63a5\u66ff\u4ee3\u4e0a\u6e38 Prometheus \u4e8c\u9032\u5236\u6587\u4ef6\u3002\n- \u60a8\u53ef\u4ee5\u4f7f\u7528\u81ea\u5df1\u504f\u597d\u7684\u90e8\u7f72\u6a5f\u5236\uff0c\u4f8b\u5982 [prometheus-operator](https://github.com/prometheus-operator) \u6216\u624b\u52d5\u90e8\u7f72\u3002\n- \u4f7f\u7528\u504f\u597d\u7684\u65b9\u6cd5\uff08\u5982\u8a3b\u89e3\u6216 prometheus-operator\uff09\u914d\u7f6e\u6293\u53d6\u3002\n- \u64f4\u7e2e\u548c\u529f\u80fd\u5206\u7247\u662f\u624b\u52d5\u5b8c\u6210\u7684\u3002\n- \u9069\u5408\u5feb\u901f\u96c6\u6210\u5230\u66f4\u5fa9\u96dc\u7684\u73fe\u6709\u8a2d\u7f6e\u4e2d\u3002\u60a8\u53ef\u4ee5\u91cd\u8907\u4f7f\u7528\u73fe\u6709\u914d\u7f6e\uff0c\u4e26\u884c\u904b\u884c\u4e0a\u6e38 Prometheus \u548c Managed Service for Prometheus\u3002\n- \u898f\u5247\u548c\u63d0\u9192\u901a\u5e38\u5728\u55ae\u7368\u7684 Prometheus \u670d\u52d9\u5668\u4e2d\u904b\u884c\uff0c\u53ef\u80fd\u66f4\u9069\u5408\u908a\u7de3\u90e8\u7f72\uff0c\u56e0\u7232\u672c\u5730\u898f\u5247\u8a55\u4f30\u4e0d\u6703\u7522\u751f\u4efb\u4f55\u7db2\u7d61\u6d41\u91cf\u3002\n- \u53ef\u80fd\u652f\u6301\u4ee3\u7ba1\u5f0f\u6536\u96c6\u5c1a\u4e0d\u652f\u6301\u7684\u9577\u5c3e\u7528\u4f8b\uff0c\u4f8b\u5982\u7528\u65bc\u6e1b\u5c11\u57fa\u6578\u7684 [\u5c40\u90e8\u805a\u5408](https://cloud.google.com/stackdriver/docs/managed-prometheus/cost-controls?hl=zh-cn#local-aggregation) \u3002\n- Google Cloud \u6280\u8853\u652f\u6301\u63d0\u4f9b\u6709\u9650\u5e6b\u52a9\u3002\n- OpenTelemetry \u6536\u96c6\u5668\uff1a- \u4e00\u500b\u53ef\u4ee5\u5f9e\u4efb\u4f55\u74b0\u5883\u4e2d\u6536\u96c6\u6307\u6a19\uff08\u5305\u62ec Prometheus \u6307\u6a19\uff09\u4e26\u5c07\u5176\u767c\u9001\u5230\u4efb\u4f55\u517c\u5bb9\u7684\u5f8c\u7aef\u7684\u6536\u96c6\u5668\u3002 \u4e5f\u53ef\u7528\u65bc\u6536\u96c6\u65e5\u8a8c\u548c\u8ddf\u8e64\u8a18\u9304\uff0c\u4e26\u5c07\u5176\u767c\u9001\u5230\u4efb\u4f55\u517c\u5bb9\u7684\u5f8c\u7aef\uff0c\u5305\u62ec Cloud Logging \u548c Cloud Trace\u3002\n- \u624b\u52d5\u6216\u4f7f\u7528 Terraform \u90e8\u7f72\u5728\u4efb\u4f55\u8a08\u7b97\u6216 Kubernetes \u74b0\u5883\u4e2d\u3002\u53ef\u7528\u65bc\u5f9e\u7121\u72c0\u614b\u74b0\u5883\uff08\u5982 Cloud Run\uff09\u767c\u9001\u6307\u6a19\u3002\n- \u722c\u53d6\u4f7f\u7528\u8a72\u6536\u96c6\u5668\u7684 Prometheus \u63a5\u6536\u5668\u4e2d\u985e\u4f3c Prometheus \u7684\u914d\u7f6e\u9032\u884c\u914d\u7f6e\u3002\n- \u652f\u6301\u57fa\u65bc\u63a8\u9001\u7684\u6307\u6a19\u6536\u96c6\u6a21\u5f0f\u3002\n- \u5143\u6578\u64da\u662f\u4f7f\u7528\u8cc7\u6e90\u6aa2\u6e2c\u5668\u8655\u7406\u5668\u5f9e\u4efb\u4f55\u96f2\u6ce8\u5165\u7684\u3002\n- \u60a8\u53ef\u4ee5\u4f7f\u7528 Cloud Monitoring \u63d0\u9192\u653f\u7b56\u6216\u7368\u7acb\u898f\u5247\u8a55\u4f30\u5668\u57f7\u884c\u898f\u5247\u548c\u63d0\u9192\u3002\n- \u80fd\u5920\u7232\u8de8\u4fe1\u865f\u7684\u5de5\u4f5c\u6d41\u548c\u529f\u80fd\uff08\u4f8b\u5982\u7bc4\u4f8b\uff09\u63d0\u4f9b\u6709\u529b\u652f\u6301\u3002\n- Google Cloud \u6280\u8853\u652f\u6301\u63d0\u4f9b\u6709\u9650\u5e6b\u52a9\u3002\n- Ops Agent\uff1a- \u6536\u96c6\u548c\u767c\u9001\u6e90\u81ea Compute Engine \u74b0\u5883\uff08\u5305\u62ec Linux \u548c Windows \u767c\u884c\u7248\uff09\u7684 Prometheus \u6307\u6a19\u6578\u64da\u7684\u6700\u7c21\u55ae\u65b9\u6cd5\u3002\n- \u4f7f\u7528 gcloud CLI\u3001Compute Engine \u754c\u9762\u6216 Terraform \u9032\u884c\u90e8\u7f72\u3002\n- \u722c\u53d6\u5728\u4ee3\u7406\u7684 Prometheus \u63a5\u6536\u5668\u4e2d\u4f7f\u7528\u985e\u4f3c Prometheus \u7684\u914d\u7f6e\u9032\u884c\u914d\u7f6e\uff0c\u7531 OpenTelemetry \u63d0\u4f9b\u652f\u6301\u3002\n- \u60a8\u53ef\u4ee5\u4f7f\u7528 Cloud Monitoring \u6216\u7368\u7acb\u898f\u5247\u8a55\u4f30\u5668\u57f7\u884c\u898f\u5247\u548c\u63d0\u9192\u3002\n- \u9644\u5e36\u53ef\u9078\u7684 Logging \u4ee3\u7406\u548c [\u9032\u7a0b\u6307\u6a19](https://cloud.google.com/monitoring/api/metrics_opsagent?hl=zh-cn#agent-processes) \u3002\n- Google Cloud \u6280\u8853\u652f\u6301\u63d0\u4f9b\u5b8c\u6574\u652f\u6301\u3002\u5982\u9700\u958b\u59cb\u4f7f\u7528\uff0c\u8acb\u53c3\u95b1 [\u4ee3\u7ba1\u5f0f\u6536\u96c6\u4f7f\u7528\u5165\u9580](https://cloud.google.com/stackdriver/docs/managed-prometheus/setup-managed?hl=zh-cn) \u3001 [\u81ea\u90e8\u7f72\u6536\u96c6\u4f7f\u7528\u5165\u9580](https://cloud.google.com/stackdriver/docs/managed-prometheus/setup-unmanaged?hl=zh-cn) \u3001 [OpenTelemetry \u6536\u96c6\u5668\u4f7f\u7528\u5165\u9580](https://cloud.google.com/stackdriver/docs/managed-prometheus/setup-otel?hl=zh-cn) \u6216 [Ops Agent \u4f7f\u7528\u5165\u9580](https://cloud.google.com/monitoring/agent/ops-agent/prometheus?hl=zh-cn) \u3002\u5982\u679c\u60a8\u5728 Google Kubernetes Engine \u6216 Google Cloud \u5916\u90e8\u4f7f\u7528\u4ee3\u7ba1\u5f0f\u670d\u52d9\uff0c\u5247\u53ef\u80fd\u9700\u8981\u9032\u884c\u4e00\u4e9b\u5176\u4ed6\u914d\u7f6e\uff1b\u8acb\u53c3\u95b1 [\u5728 Google Cloud \u5916\u90e8\u904b\u884c\u4ee3\u7ba1\u5f0f\u6536\u96c6](https://cloud.google.com/stackdriver/docs/managed-prometheus/setup-managed?hl=zh-cn#gmp-outside-gcp) \u3001 [\u5728 Google Cloud \u5916\u90e8\u904b\u884c\u81ea\u90e8\u7f72\u6536\u96c6](https://cloud.google.com/stackdriver/docs/managed-prometheus/setup-unmanaged?hl=zh-cn#gmp-outside-gcp) \u6216 [\u6dfb\u52a0 OpenTelemetry \u8655\u7406\u5668](https://cloud.google.com/stackdriver/docs/managed-prometheus/setup-otel?hl=zh-cn#add-processors) \u3002\n## \u67e5\u8a62\u8a55\u4f30\nManaged Service for Prometheus \u652f\u6301\u53ef\u8abf\u7528 Prometheus \u67e5\u8a62 API \u7684\u4efb\u4f55\u67e5\u8a62\u754c\u9762\uff0c\u5305\u62ec Grafana \u548c Cloud Monitoring \u754c\u9762\u3002\u5f9e\u672c\u5730 Prometheus \u5207\u63db\u5230 Managed Service for Prometheus \u6642\uff0c\u73fe\u6709 Grafana \u4fe1\u606f\u4e2d\u5fc3\u6703\u7e7c\u7e8c\u904b\u884c\uff1b\u60a8\u53ef\u4ee5\u7e7c\u7e8c\u4f7f\u7528\u71b1\u9580\u958b\u6e90\u4ee3\u78bc\u5eab\u548c\u793e\u5340\u8ad6\u58c7\u4e2d\u7684 PromQL\u3002\n\u60a8\u53ef\u4ee5\u4f7f\u7528 PromQL \u5728 Cloud Monitoring \u4e2d\u67e5\u8a62 [\u8d85\u904e 1,500 \u500b\u514d\u8cbb\u6307\u6a19](https://cloud.google.com/monitoring/api/metrics_gcp?hl=zh-cn) \uff0c\u751a\u81f3\u7121\u9700\u5c07\u6578\u64da\u767c\u9001\u5230 Managed Service for Prometheus\u3002\u60a8\u9084\u53ef\u4ee5\u4f7f\u7528 PromQL \u67e5\u8a62 [\u514d\u8cbb\u7684 Kubernetes \u6307\u6a19](https://cloud.google.com/monitoring/api/metrics_kubernetes?hl=zh-cn) \u3001 [\u81ea\u5b9a\u7fa9\u6307\u6a19](https://cloud.google.com/monitoring/custom-metrics?hl=zh-cn) \u548c [\u57fa\u65bc\u65e5\u8a8c\u7684\u6307\u6a19](https://cloud.google.com/logging/docs/logs-based-metrics?hl=zh-cn) \u3002\n\u5982\u9700\u77ad\u89e3\u5982\u4f55\u914d\u7f6e Grafana \u4ee5\u67e5\u8a62 Managed Service for Prometheus \u6578\u64da\uff0c\u8acb\u53c3\u95b1 [\u4f7f\u7528 Grafana \u9032\u884c\u67e5\u8a62](https://cloud.google.com/stackdriver/docs/managed-prometheus/query?hl=zh-cn) \u3002\n\u5982\u9700\u77ad\u89e3\u5982\u4f55\u4f7f\u7528 PromQL \u67e5\u8a62 Cloud Monitoring \u6307\u6a19\uff0c\u8acb\u53c3\u95b1 [Cloud Monitoring \u4e2d\u7684 PromQL](https://cloud.google.com/monitoring/promql?hl=zh-cn) \u3002\n## \u898f\u5247\u548c\u63d0\u9192\u8a55\u4f30\nManaged Service for Prometheus \u63d0\u4f9b\u5b8c\u5168\u57fa\u65bc\u96f2\u7684\u63d0\u9192\u6d41\u6c34\u7dda\u548c\u7368\u7acb\u7684\u898f\u5247\u8a55\u4f30\u5668\uff0c\u9019\u5169\u8005\u90fd\u91dd\u5c0d [\u6307\u6a19\u7bc4\u570d](https://cloud.google.com/monitoring/settings?hl=zh-cn#concept-scope) \u4e2d\u53ef\u8a2a\u554f\u7684\u6240\u6709 Monarch \u6578\u64da\u8a55\u4f30\u898f\u5247\u3002\u5982\u679c\u91dd\u5c0d\u591a\u9805\u76ee\u6307\u6a19\u7bc4\u570d\u8a55\u4f30\u898f\u5247\uff0c\u60a8\u5c31\u7121\u9700\u5c07\u611f\u8208\u8da3\u7684\u6240\u6709\u6578\u64da\u5171\u540c\u5b58\u5132\u5728\u55ae\u500b Prometheus \u670d\u52d9\u5668\u6216\u55ae\u500b Google Cloud \u9805\u76ee\u4e2d\uff0c\u800c\u4e14\u9084\u53ef\u4ee5\u5728\u7fa3\u7d44\u6216\u8005\u9805\u76ee\u4e0a\u8a2d\u7f6e IAM \u6b0a\u9650\u3002\n\u7531\u65bc\u6240\u6709\u898f\u5247\u8a55\u4f30\u9078\u9805\u90fd\u63a5\u53d7\u6a19\u6e96 Prometheus `rule_files` \u683c\u5f0f\uff0c\u56e0\u6b64\u60a8\u53ef\u4ee5\u901a\u904e\u8907\u88fd\u7c98\u8cbc\u73fe\u6709\u898f\u5247\u6216\u8907\u88fd\u7c98\u8cbc\u5e38\u898b\u958b\u6e90\u5eab\u4e2d\u7684\u898f\u5247\uff0c\u8f15\u9b06\u9077\u79fb\u5230 Managed Service for Prometheus \u4ee3\u78bc\u5eab\u3002\u5982\u679c\u4f7f\u7528\u81ea\u90e8\u7f72\u6536\u96c6\u5668\uff0c\u60a8\u53ef\u4ee5\u7e7c\u7e8c\u5728\u6536\u96c6\u5668\u4e2d\u672c\u5730\u8a55\u4f30\u8a18\u9304\u898f\u5247\u3002\u8a18\u9304\u548c\u63d0\u9192\u898f\u5247\u7684\u7d50\u679c\u5b58\u5132\u5728 Monarch \u4e2d\uff0c\u5c31\u50cf\u76f4\u63a5\u6536\u96c6\u7684\u6307\u6a19\u6578\u64da\u4e00\u6a23\u3002 \u60a8\u9084\u53ef\u4ee5\u5c07 Prometheus \u63d0\u9192\u898f\u5247\u9077\u79fb\u5230 Cloud Monitoring \u4e2d\u57fa\u65bc PromQL \u7684\u63d0\u9192\u653f\u7b56\u3002\n\u5982\u9700\u4f7f\u7528 Cloud Monitoring \u9032\u884c\u63d0\u9192\u8a55\u4f30\uff0c\u8acb\u53c3\u95b1 [Cloud Monitoring \u4e2d\u7684 PromQL \u63d0\u9192](https://cloud.google.com/monitoring/promql/promql-in-alerting?hl=zh-cn) \u3002\n\u5982\u9700\u77ad\u89e3\u5982\u4f55\u4f7f\u7528\u4ee3\u7ba1\u5f0f\u6536\u96c6\u9032\u884c\u898f\u5247\u8a55\u4f30\uff0c\u8acb\u53c3\u95b1 [\u4ee3\u7ba1\u5f0f\u898f\u5247\u8a55\u4f30\u548c\u63d0\u9192](https://cloud.google.com/stackdriver/docs/managed-prometheus/rules-managed?hl=zh-cn) \u3002\n\u5982\u9700\u77ad\u89e3\u5982\u4f55\u4f7f\u7528\u81ea\u90e8\u7f72\u6536\u96c6\u3001OpenTelemetry \u6536\u96c6\u5668\u548c Ops Agent \u9032\u884c\u898f\u5247\u8a55\u4f30\uff0c\u8acb\u53c3\u95b1 [\u81ea\u90e8\u7f72\u898f\u5247\u8a55\u4f30\u548c\u63d0\u9192](https://cloud.google.com/stackdriver/docs/managed-prometheus/rules-unmanaged?hl=zh-cn) \u3002\n\u5982\u9700\u77ad\u89e3\u5982\u4f55\u4f7f\u7528\u81ea\u90e8\u7f72\u6536\u96c6\u5668\u7684\u8a18\u9304\u898f\u5247\u4f86\u6e1b\u5c11\u57fa\u6578\uff0c\u8acb\u53c3\u95b1 [\u8cbb\u7528\u63a7\u5236\u548c\u6b78\u56e0](https://cloud.google.com/stackdriver/docs/managed-prometheus/cost-controls?hl=zh-cn#local-aggregation) \u3002\n## \u6578\u64da\u5b58\u5132\n\u6240\u6709 Managed Service for Prometheus \u6578\u64da\u90fd\u6703\u5b58\u5132 24 \u500b\u6708\uff0c\u4e14\u7121\u984d\u5916\u8cbb\u7528\u3002\nManaged Service for Prometheus \u652f\u6301\u6700\u77ed 5 \u79d2\u7684\u6293\u53d6\u9593\u9694\u3002\u6578\u64da\u6703\u4ee5\u5b8c\u6574\u7684\u7c92\u5ea6\u4fdd\u5b58 1 \u5468\uff0c\u7136\u5f8c\u964d\u63a1\u6a23\u7232 1 \u5206\u9418\u6642\u9593\u9ede\u4e26\u4fdd\u5b58 5 \u5468\uff0c\u7136\u5f8c\u964d\u63a1\u6a23\u7232 10 \u5206\u9418\u6642\u9593\u9ede\u4e26\u4fdd\u5b58\u5269\u9918\u7684\u4fdd\u7559\u671f\u9650\u3002\nManaged Service for Prometheus \u5c0d\u6d3b\u8e8d\u6642\u5e8f\u6578\u6216\u6642\u5e8f\u7e3d\u6578\u6c92\u6709\u9650\u5236\u3002\n\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [Cloud Monitoring \u6587\u6a94\u4e2d\u7684\u914d\u984d\u548c\u9650\u5236](https://cloud.google.com/monitoring/quotas?hl=zh-cn) \u3002\n## \u7d50\u7b97\u548c\u914d\u984d\nManaged Service for Prometheus \u662f\u4e00\u6b3e Google Cloud \u7522\u54c1\uff0c\u5177\u6709\u7d50\u7b97\u548c\u7528\u91cf\u914d\u984d\u3002\n### \u7d50\u7b97\n\u8a72\u670d\u52d9\u7684\u7d50\u7b97\u4e3b\u8981\u53d6\u6c7a\u65bc\u63d0\u53d6\u5230\u5b58\u5132\u7a7a\u9593\u4e2d\u7684\u6307\u6a19\u6a23\u672c\u6578\u91cf\u3002\u8b80\u53d6 API \u8abf\u7528\u9084\u5b58\u5728\u540d\u7fa9\u8cbb\u7528\u3002Managed Service for Prometheus \u4e0d\u6536\u53d6\u6307\u6a19\u6578\u64da\u7684\u5b58\u5132\u6216\u4fdd\u7559\u8cbb\u7528\u3002\n- \u5982\u9700\u77ad\u89e3\u7576\u524d\u50f9\u683c\uff0c\u8acb\u53c3\u95b1 [Google Cloud Managed Service for Prometheus \u50f9\u683c\u6458\u8981](https://cloud.google.com/stackdriver/pricing?hl=zh-cn#mgd-prometheus-pricing-summary) \u3002\n- \u5982\u9700\u6839\u64da\u9810\u671f\u6642\u5e8f\u6578\u6216\u9810\u671f\u7684\u6bcf\u79d2\u6a23\u672c\u6578\u4f30\u7b97\u8cec\u55ae\u8cbb\u7528\uff0c\u8acb\u53c3\u95b1 [Google Cloud \u50f9\u683c\u8a08\u7b97\u5668](https://cloud.google.com/products/calculator?hl=zh-cn) \u4e2d\u7684\u201cCloud Operations\u201d\u6a19\u7c64\u9801\u3002\n- \u5982\u9700\u77ad\u89e3\u5982\u4f55\u964d\u4f4e\u8cbb\u7528\u6216\u78ba\u5b9a\u9ad8\u8cbb\u7528\u4f86\u6e90\uff0c\u8acb\u53c3\u95b1 [\u8cbb\u7528\u63a7\u5236\u548c\u6b78\u56e0](https://cloud.google.com/stackdriver/docs/managed-prometheus/cost-controls?hl=zh-cn) \u3002\n- \u5982\u9700\u77ad\u89e3\u50f9\u683c\u6a21\u5f0f\uff0c\u8acb\u53c3\u95b1 [\u53ef\u63a7\u5236\u6027\u548c\u53ef\u9810\u6e2c\u6027\u7684\u50f9\u683c](https://cloud.google.com/stackdriver/pricing?hl=zh-cn#sample-pricing-rationale) \u3002\n- \u5982\u9700\u67e5\u770b\u50f9\u683c\u793a\u4f8b\uff0c\u8acb\u53c3\u95b1 [\u57fa\u65bc\u6ce8\u5165\u7684\u6a23\u672c\u6578\u91cf\u7684\u50f9\u683c\u793a\u4f8b](https://cloud.google.com/stackdriver/pricing?hl=zh-cn#pricing_examples_samples) \u3002\n### \u914d\u984d\nManaged Service for Prometheus \u8207 Cloud Monitoring \u5171\u4eab\u6ce8\u5165\u548c\u8b80\u53d6\u914d\u984d\u3002\u9ed8\u8a8d\u6ce8\u5165\u914d\u984d\u7232\u6bcf\u500b\u9805\u76ee 500 QPS\uff0c\u4e00\u6b21\u8abf\u7528\u6700\u591a\u53ef\u4ee5\u5305\u542b 200 \u500b\u6a23\u672c\uff0c\u76f8\u7576\u65bc\u6bcf\u79d2 10 \u842c\u500b\u6a23\u672c\u3002\u9ed8\u8a8d\u8b80\u53d6\u914d\u984d\u7232\u6bcf\u500b [\u6307\u6a19\u7bc4\u570d](https://cloud.google.com/monitoring/settings?hl=zh-cn#concept-scope) 100 QPS\u3002\n\u60a8\u53ef\u4ee5\u589e\u52a0\u9019\u4e9b\u914d\u984d\u4ee5\u652f\u6301\u60a8\u7684\u6307\u6a19\u548c\u67e5\u8a62\u91cf\u3002\u5982\u9700\u77ad\u89e3\u5982\u4f55\u7ba1\u7406\u914d\u984d\u53ca\u7533\u8acb\u589e\u52a0\u914d\u984d\uff0c\u8acb\u53c3\u95b1 [\u4f7f\u7528\u914d\u984d](https://cloud.google.com/docs/quota?hl=zh-cn) \u3002\n### \u670d\u52d9\u689d\u6b3e\u8207\u5408\u898f\u6027\nManaged Service for Prometheus \u662f Cloud Monitoring \u7684\u4e00\u90e8\u5206\uff0c\u56e0\u6b64\u7e7c\u627f\u4e86 Cloud Monitoring \u7684\u67d0\u4e9b\u5354\u8b70\u548c\u8a8d\u8b49\uff0c\u5305\u62ec\u4f46\u4e0d\u9650\u65bc\uff1a\n- [Google Cloud \u670d\u52d9\u689d\u6b3e](https://cloud.google.com/terms/services?hl=zh-cn) \n- [\u904b\u71df\u670d\u52d9\u7b49\u7d1a\u5354\u8b70 (SLA)](https://cloud.google.com/operations/sla?hl=zh-cn) \n- [US DISA](https://cloud.google.com/security/compliance/disa?hl=zh-cn) \u548c [FedRAMP](https://cloud.google.com/security/compliance/fedramp?hl=zh-cn) \u5408\u898f\u6027\u7d1a\u5225\n- [VPC-SC (VPC Service Controls)](https://cloud.google.com/vpc-service-controls/docs/supported-products?hl=zh-cn#table_monitoring) \u652f\u6301## \u5f8c\u7e8c\u6b65\u9a5f\n- [\u4ee3\u7ba1\u5f0f\u6536\u96c6](https://cloud.google.com/stackdriver/docs/managed-prometheus/setup-managed?hl=zh-cn) \u4f7f\u7528\u5165\u9580\u3002\n- [\u81ea\u90e8\u7f72\u6536\u96c6](https://cloud.google.com/stackdriver/docs/managed-prometheus/setup-unmanaged?hl=zh-cn) \u4f7f\u7528\u5165\u9580\u3002\n- [OpenTelemetry \u6536\u96c6\u5668](https://cloud.google.com/stackdriver/docs/managed-prometheus/setup-otel?hl=zh-cn) \u4f7f\u7528\u5165\u9580\u3002\n- [Ops Agent](https://cloud.google.com/monitoring/agent/ops-agent/prometheus?hl=zh-cn) \u4f7f\u7528\u5165\u9580\u3002\n- [\u4f7f\u7528 Cloud Monitoring \u4e2d\u7684 PromQL \u67e5\u8a62 Prometheus \u6307\u6a19](https://cloud.google.com/stackdriver/docs/managed-prometheus/query-cm?hl=zh-cn) \u3002\n- [\u4f7f\u7528 Grafana \u67e5\u8a62 Prometheus \u6307\u6a19](https://cloud.google.com/stackdriver/docs/managed-prometheus/query?hl=zh-cn) \u3002\n- \u4f7f\u7528 PromQL [\u67e5\u8a62 Cloud Monitoring \u6307\u6a19](https://cloud.google.com/monitoring/promql?hl=zh-cn) \u3002\n- \u95b1\u8b80 [\u6700\u4f73\u5be6\u8e10\u548c\u67e5\u770b\u67b6\u69cb\u5716](https://cloud.google.com/stackdriver/docs/managed-prometheus/best-practices/ingest-and-query?hl=zh-cn) \u3002", "guide": "Google Cloud Observability"}