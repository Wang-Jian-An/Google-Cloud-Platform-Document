{"title": "Google Cloud Observability - \u4f7f\u7528 PromQL \u7684\u63d0\u9192\u653f\u7b56", "url": "https://cloud.google.com/monitoring/promql/promql-in-alerting?hl=zh-cn", "abstract": "# Google Cloud Observability - \u4f7f\u7528 PromQL \u7684\u63d0\u9192\u653f\u7b56\n\u672c\u9801\u9762\u4ecb\u7d39\u4e86\u6839\u64da PromQL \u67e5\u8a62\u5275\u5efa\u63d0\u9192\u653f\u7b56\u7684\u4e0d\u540c\u65b9\u6cd5\u3002\n\u4f7f\u7528\u57fa\u65bc PromQL \u7684\u689d\u4ef6\u7684\u63d0\u9192\u653f\u7b56\u7232\u4f7f\u7528 Monitoring Query Language (MQL) \u67e5\u8a62\u914d\u7f6e\u63d0\u9192\u653f\u7b56\u689d\u4ef6\u63d0\u4f9b\u4e86\u4e00\u7a2e\u958b\u6e90\u66ff\u4ee3\u65b9\u6848\u3002\u60a8\u53ef\u4ee5\u4f7f\u7528 PromQL \u67e5\u8a62\u5275\u5efa\u5177\u6709\u6bd4\u7387\u3001\u52d5\u614b\u95be\u503c\u548c\u7d44\u5408\u6307\u6a19\u7b49\u529f\u80fd\u7684\u8907\u96dc\u689d\u4ef6\u3002\n\u5982\u679c\u60a8\u5728 Google Cloud \u4e4b\u5916\u7684\u74b0\u5883\u4e2d\u4f7f\u7528 Prometheus\uff0c\u6216\u5728 Managed Service for Prometheus \u4e2d\u4f7f\u7528\u63d0\u9192\uff0c\u5247\u53ef\u4ee5\u5c07 Prometheus \u63d0\u9192\u898f\u5247\u9077\u79fb\u5230\u5177\u6709\u57fa\u65bc PromQL \u7684\u689d\u4ef6\u7684\u63d0\u9192\u653f\u7b56\u3002\u9019\u6a23\uff0c\u60a8\u5c31\u53ef\u4ee5\u5728 Cloud Monitoring \u4e2d\u7ba1\u7406\u6240\u6709\u63d0\u9192\u653f\u7b56\u3002\n\u60a8\u9084\u53ef\u4ee5 [\u5c07 Grafana \u4fe1\u606f\u4e2d\u5fc3\u5c0e\u5165 Cloud Monitoring](https://cloud.google.com/monitoring/dashboards/import-grafana-dashboards?hl=zh-cn) \u3002\n- \u5982\u9700\u77ad\u89e3\u5982\u4f55\u5728 Monitoring \u4e2d\u4f7f\u7528 PromQL\uff0c\u8acb\u53c3\u95b1 [Cloud Monitoring \u4e2d\u7684 PromQL](https://cloud.google.com/monitoring/promql?hl=zh-cn) \u3002\n- \u5982\u9700\u77ad\u89e3\u6709\u95dc\u63d0\u9192\u653f\u7b56\u7684\u4e00\u822c\u4fe1\u606f\uff0c\u8acb\u53c3\u95b1 [\u57fa\u65bc\u6307\u6a19\u7684\u63d0\u9192\u653f\u7b56\u7684\u884c\u7232](https://cloud.google.com/monitoring/alerts/concepts-indepth?hl=zh-cn) \u3002", "content": "## \u6982\u89bd\n\u60a8\u53ef\u4ee5\u901a\u904e\u4ee5\u4e0b\u65b9\u5f0f\u5275\u5efa\u5177\u6709\u57fa\u65bc PromQL \u7684\u689d\u4ef6\u7684\u63d0\u9192\u653f\u7b56\uff1a\n- \u5728 Google Cloud \u63a7\u5236\u6aaf\u4e2d\u5275\u5efa\u63d0\u9192\u653f\u7b56\uff0c\u4e26\u5728\u4ee3\u78bc\u7de8\u8f2f\u5668\u4e2d\u5b9a\u7fa9 PromQL \u67e5\u8a62\u3002\n- \u4f7f\u7528 gcloud CLI \u6216 Monitoring API \u4e2d\u7684 [AlertPolicy](https://cloud.google.com/monitoring/api/ref_v3/rest/v3/projects.alertPolicies?hl=zh-cn#AlertPolicy) \u7d50\u69cb\u5275\u5efa\u63a1\u7528\u57fa\u65bc PromQL \u7684\u689d\u4ef6\u7684\u63d0\u9192\u653f\u7b56\u3002\n- \u4f7f\u7528 Google Cloud CLI \u5c07\u60a8\u7684 Prometheus \u63d0\u9192\u898f\u5247\u548c\u901a\u77e5\u6e20\u9053\u9077\u79fb\u5230 Cloud Monitoring\u3002\n\u7531\u5177\u6709\u57fa\u65bc PromQL \u689d\u4ef6\u7684\u63d0\u9192\u653f\u7b56\u5275\u5efa\u7684\u7a81\u767c\u4e8b\u4ef6\u6703\u8207\u60a8\u7684\u5176\u4ed6\u7a81\u767c\u4e8b\u4ef6\u4e00\u8d77\u986f\u793a\u5728 Google Cloud \u63a7\u5236\u6aaf\u4e2d\u3002\u60a8\u53ef\u4ee5\u5728 Google Cloud \u63a7\u5236\u6aaf\u4e2d\u8207\u9019\u4e9b\u7a81\u767c\u4e8b\u4ef6\u9032\u884c\u4ea4\u4e92\u3002\n\u60a8\u7684 PromQL \u63d0\u9192\u653f\u7b56\u689d\u4ef6\u53ef\u4ee5\u5f15\u7528 Cloud Monitoring \u4e2d\u7684\u4efb\u4f55\u6307\u6a19\uff0c\u5305\u62ec Google Cloud \u7cfb\u7d71\u6307\u6a19\u3001\u81ea\u5b9a\u7fa9\u6307\u6a19\u548c\u57fa\u65bc\u65e5\u8a8c\u7684\u6307\u6a19\u4ee5\u53ca Prometheus \u6307\u6a19\u3002\u60a8\u5fc5\u9808\u5c07\u975e Prometheus \u6307\u6a19\u7684\u540d\u7a31\u8f49\u63db\u7232 PromQL \u6307\u6a19\u8a9e\u6cd5\u3002\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [\u5c07 Monitoring \u6307\u6a19\u6620\u5c04\u5230 PromQL](https://cloud.google.com/monitoring/promql/promql-mapping?hl=zh-cn) \u3002\n## \u9650\u5236\n\u5177\u6709\u57fa\u65bc PromQL \u7684\u689d\u4ef6\u7684\u63d0\u9192\u653f\u7b56\u6700\u9577\u53ef\u4ee5\u6301\u7e8c 24 \u5c0f\u6642\uff0c\u56de\u6eaf\u671f\u6700\u9577 24 \u5c0f\u6642\u3002\u6642\u9577\u548c\u56de\u6eaf\u671f\u7684\u7e3d\u548c\u4e0d\u5f97\u8d85\u904e 25 \u5c0f\u6642\u3002\n\u5982\u679c\u60a8\u7684 Prometheus \u63d0\u9192\u898f\u5247\u5f15\u7528\u4e86\u81ea\u5b9a\u7fa9\u6307\u6a19\uff0c\u5247\u60a8\u5fc5\u9808\u5148\u5728 Cloud Monitoring \u4e2d\u8a2d\u7f6e\u7b49\u6548\u7684\u81ea\u5b9a\u7fa9\u6307\u6a19\u63cf\u8ff0\u7b26\u3002\n## \u50f9\u683c\n\u4e00\u822c\u4f86\u8aaa\uff0cCloud Monitoring \u7cfb\u7d71\u6307\u6a19\u662f\u514d\u8cbb\u7684\uff0c\u4f86\u81ea\u5916\u90e8\u7cfb\u7d71\u3001\u4ee3\u7406\u6216\u61c9\u7528\u7684\u6307\u6a19\u4e0d\u662f\u3002\u8a08\u8cbb\u6307\u6a19\u6309\u6ce8\u5165\u7684\u5b57\u7bc0\u6578\u6216\u6a23\u672c\u6578\u8a08\u8cbb\u3002\n\u5982\u9700\u8a73\u7d30\u77ad\u89e3 Cloud Monitoring \u50f9\u683c\uff0c\u8acb\u53c3\u95b1\u4ee5\u4e0b\u6587\u6a94\uff1a\n- [Cloud Monitoring \u50f9\u683c\u6458\u8981](https://cloud.google.com/stackdriver/pricing?hl=zh-cn#monitoring-pricing-summary) \u3002\n- [Cloud Monitoring \u50f9\u683c](https://cloud.google.com/stackdriver/pricing?hl=zh-cn#monitoring-costs) \u3002## \u5f8c\u7e8c\u6b65\u9a5f\n\u5982\u9700\u77ad\u89e3\u5982\u4f55\u4f7f\u7528 Google Cloud \u63a7\u5236\u6aaf\u5728\u689d\u4ef6\u4e2d\u4f7f\u7528 PromQL \u67e5\u8a62\u5275\u5efa\u63d0\u9192\u653f\u7b56\uff0c\u8acb\u53c3\u95b1 [\u4f7f\u7528\u57fa\u65bc PromQL \u7684\u689d\u4ef6\u5275\u5efa\u63d0\u9192\u653f\u7b56\uff08\u63a7\u5236\u6aaf\uff09](https://cloud.google.com/monitoring/promql/create-promql-alerts-console?hl=zh-cn) \u3002\n\u5982\u9700\u77ad\u89e3\u5982\u4f55\u4f7f\u7528 Cloud Monitoring API \u76f4\u63a5\u4f7f\u7528 PromQL \u5275\u5efa\u63d0\u9192\u653f\u7b56\uff0c\u8acb\u53c3\u95b1 [\u4f7f\u7528\u57fa\u65bc PromQL \u7684\u689d\u4ef6 (API) \u5275\u5efa\u63d0\u9192\u653f\u7b56](https://cloud.google.com/monitoring/promql/create-promql-alerts?hl=zh-cn) \u3002\n\u5982\u9700\u77ad\u89e3\u5982\u4f55\u4f7f\u7528 PromQL \u67e5\u8a62\u5c07 PromQL \u63d0\u9192\u898f\u5247\u9077\u79fb\u5230\u63d0\u9192\u653f\u7b56\uff0c\u8acb\u53c3\u95b1 [\u5f9e Prometheus \u9077\u79fb\u63d0\u9192\u898f\u5247\u548c\u63a5\u6536\u5668](https://cloud.google.com/monitoring/promql/promql-migrate?hl=zh-cn) \u3002\n\u5982\u9700\u77ad\u89e3\u5982\u4f55\u5c0e\u5165 Grafana \u4fe1\u606f\u4e2d\u5fc3\uff0c\u8acb\u53c3\u95b1 [\u5c07 Grafana \u4fe1\u606f\u4e2d\u5fc3\u5c0e\u5165 Cloud Monitoring](https://cloud.google.com/monitoring/dashboards/import-grafana-dashboards?hl=zh-cn) \u3002", "guide": "Google Cloud Observability"}