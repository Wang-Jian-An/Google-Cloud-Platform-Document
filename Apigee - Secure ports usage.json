{"title": "Apigee - Secure ports usage", "url": "https://cloud.google.com/apigee/docs/api-platform/get-started/what-apigee", "abstract": "# Apigee - Secure ports usage\nYou are currently viewing version 1.5 of the Apigee hybrid documentation. **This version is end of life.** You should upgrade to a newer version. For more information, see [Supported versions](/apigee/docs/hybrid/supported-platforms#supported-versions) .\nUnderstanding which ports the hybrid runtime plane uses is important for enterprise implementations. This section describes the ports used for secure communications within the runtime plane as well as external ports used for communications with external services.\n", "content": "## Internal connections\nCommunication between the runtime plane and management plane is secured with TLS 1-way and OAuth 2.0. Individual services use different protocols, depending on which service they are communicating with.\nThe certificates used for intra-component communication are generated by Apigee's certificate manager. You do not have to provide a certificate or manage it.\nThe following image shows the ports and communications channels within the hybrid runtime plane:\nThe following table describes the ports and communications channels within the hybrid runtime plane:\n| ('Internal Connections', 'Source') | ('Internal Connections', 'Unnamed: 1_level_1') | ('Internal Connections', 'Destination') | ('Internal Connections', 'Protocol/Ports') | ('Internal Connections', 'Security protocol') | ('Internal Connections', 'Description')                              |\n|:-------------------------------------|:-------------------------------------------------|:------------------------------------------|:---------------------------------------------|:------------------------------------------------|:-------------------------------------------------------------------------------------------------------------------------------------------------------------|\n| MART         | arrow_right_alt         | Cassandra         | TCP/9042 TCP/9142       | TLS            | Sends data for persistence                                 |\n| Apigee Connect      | arrow_right_alt         | MART          | TCP/8443          | TLS            | Requests from the management plane go through Apigee Connect. Apigee Connect initiates the connection.              |\n| Default\u00a0Istio\u00a0Ingress    | arrow_right_alt         | Message Processor       | TCP/8443          | TLS (Apigee-generated, self-signed cert)  | Processes incoming API requests                                |\n| Message Processor     | arrow_right_alt         | Cassandra         | TCP/9042 TCP/9142       | TLS            | Sends data for persistence                                 |\n| Message Processor     | arrow_right_alt         | fluentd (Analytics)      | TCP/20001         | mTLS           | Streams data to the data collection pod                              |\n| Cassandra       | compare_arrows         | Cassandra         | TCP/7001          | mTLS           | Intra-node cluster communications. Note that you can also leave port 7000 open for firewall configuration as a backup option for potential troubleshooting. |\n| Synchronizer       | arrow_right_alt         | Cassandra         | TCP/9042 TCP/9142       | TLS            | Sends data for persistence                                 |\n| Prometheus       | arrow_right_alt         | Cassandra         | TCP/7070 (HTTPS)        | TLS            | Scrapes metrics data from various services                             |\n| Prometheus       | arrow_right_alt         | MART          | TCP/8843\u00a0(HTTPS)        | TLS            | Scrapes metrics data from various services                             |\n| Prometheus       | arrow_right_alt         | Message\u00a0Processor       | TCP/8843 (HTTPS)        | TLS            | Scrapes metrics data from various services                             |\n| Prometheus       | arrow_right_alt         | Synchronizer        | TCP/8843 (HTTPS)        | TLS            | Scrapes metrics data from various services                             |\n| Prometheus       | arrow_right_alt         | UDCA          | TCP/7070 (HTTPS)        | TLS            | Scrapes metrics data from various services                             |\n## External connections\nTo appropriately configure your network firewall, you should know the inbound and outbound ports used by hybrid to communicate with external services.\nThe following image shows the ports used for external communications with the hybrid runtime plane:\nThe following table describes the ports used for external communications with the hybrid runtime plane:\n| ('External Connections', 'Source')                  | ('External Connections', 'Unnamed: 1_level_1')        | ('External Connections', 'Destination')          | ('External Connections', 'Protocol/Port(s)')         | ('External Connections', 'Security Protocol')        | ('External Connections', 'Description')                                             |\n|:----------------------------------------------------------------------------------------------------------|:-----------------------------------------------------------------------------|:-----------------------------------------------------------------------------|:-----------------------------------------------------------------------------|:-----------------------------------------------------------------------------|:------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|\n| Inbound Connections (exposed externally)                 | Inbound Connections (exposed externally)          | Inbound Connections (exposed externally)          | Inbound Connections (exposed externally)          | Inbound Connections (exposed externally)          | Inbound Connections (exposed externally)                                            |\n| OPTIONAL: Apigee Services Only if not using Apigee Connect (recommended). See Two-way Connections below. | arrow_right_alt                | MART Istio Ingress               | TCP/443                  | OAuth over TLS 1.2               | Hybrid API calls from the management plane                                            |\n| Client Apps                        | arrow_right_alt                | Default Istio Ingress              | TCP/*                  | None/OAuth over TLS 1.2              | API requests from external apps                                               |\n| Outbound Connections                      | Outbound Connections               | Outbound Connections               | Outbound Connections               | Outbound Connections               | Outbound Connections                                                 |\n| Message\u00a0Processor                       | arrow_right_alt                | Backend services                | TCP/* UDP/*                 | None/OAuth over TLS 1.2              | Sends requests to customer-defined hosts                                            |\n| Synchronizer                        | arrow_right_alt                | Apigee Services                | TCP/443                  | OAuth over TLS 1.2               | Fetches configuration data; connects to apigee.googleapis.com                                       |\n| Synchronizer                        | arrow_right_alt                | Google Cloud                 | TCP/443                  | OAuth over TLS 1.2               | Connects to iamcredentials.googleapis.com for authorization                                        |\n| UDCA (Analytics)                       | arrow_right_alt                | Apigee\u00a0Services\u00a0(UAP)              | TCP/443                  | OAuth over TLS 1.2               | Sends data to UAP in the management plane and to Google Cloud; connects to apigee.googleapis.com and storage.googleapis.com                       |\n| Apigee Connect                       | arrow_right_alt                | Apigee\u00a0Services                | TCP/443                  | TLS                   | Establishes the connection with the management plane; connects to apigeeconnect.googleapis.com                               |\n| Prometheus (Metrics)                      | arrow_right_alt                | Google Cloud (Cloud Operations)            | TCP/443                  | TLS                   | Sends data to Cloud Operations in the management plane; connects to monitoring.googleapis.com                               |\n| fluentd (Logging)                       | arrow_right_alt                | Google Cloud (Cloud Operations)            | TCP/443                  | TLS                   | Sends data to Cloud Operations in the management plane; connects to logging.googleapis.com                                |\n| MART                          | arrow_right_alt                | Google Cloud                 | TCP/443                  | OAuth over TLS 1.2               | Connects to iamcredentials.googleapis.com for authorization                                        |\n| Message Processor                       | arrow_right_alt                | Distributed Trace back end             | http or https                | TLS (configurable)               | (Optional) Communicates trace information to the Distributed Trace back end service. Configure the service and protocol in the TraceConfig API. The back end for Distributed Trace is usually Cloud Trace or Jaeger. |\n| Two-way Connections                      | Two-way Connections               | Two-way Connections               | Two-way Connections               | Two-way Connections               | Two-way Connections                                                  |\n| Apigee Connect                       | compare_arrows                | Apigee\u00a0Services                | TCP/443                  | TLS                   | Communicates management data between the managemennt plane and the Management API for runtime data (MART) in the runtime plane. Apigee Connect initiates the connection; connects to apigeeconnect.googleapis.com  |\n| * indicates that the port is configurable. Apigee recommends using port 443.        | * indicates that the port is configurable. Apigee recommends using port 443. | * indicates that the port is configurable. Apigee recommends using port 443. | * indicates that the port is configurable. Apigee recommends using port 443. | * indicates that the port is configurable. Apigee recommends using port 443. | * indicates that the port is configurable. Apigee recommends using port 443.                                   |\nYou should not allow external connections for specific IP addresses associated with `*.googleapis.com` . The IP addresses can change since the domain currently resolves to multiple addresses.", "guide": "Apigee"}