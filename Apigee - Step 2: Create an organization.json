{"title": "Apigee - Step 2: Create an organization", "url": "https://cloud.google.com/apigee/docs/api-platform/get-started/what-apigee", "abstract": "# Apigee - Step 2: Create an organization\nYou are currently viewing version 1.8 of the Apigee hybrid documentation. **This version is end of life.** You should upgrade to a newer version. For more information, see [Supported versions](/apigee/docs/hybrid/supported-platforms#supported-versions) .\nIn this step, you create an [Apigee organization](/apigee/docs/api-platform/get-started/basic-concepts) .\n**To create a new organization and provision it:**\n**Note: ** If you have an Apigee evaluation account, the organization you create will expire after 60 days. At that time, the organization will be deleted.If this occurs, you may encounter the following error: `\"Project <project> doesn't have an Apigee organization provisioned.\"` To resolve this error, follow the steps to create a new organization and provision it.\n- On the command line, get your `gcloud` authentication  credentials using the following command:\n```\nexport TOKEN=$(gcloud auth print-access-token)\n```\nTo check that your token was populated, use `echo` , as the   following example shows:\n```\necho $TOKEN\n```\nThis should display your token as an encoded string.```\nfor /f \"tokens=*\" %a in ('gcloud auth print-access-token') do set TOKEN=%a\n```\nTo check that your token was populated, use `echo` , as the   following example shows:\n```\necho %TOKEN%\n```\nThis should display your token as an encoded string.\n- In [Step 1](/apigee/docs/hybrid/v1.8/precog-enableapi) , you created the `PROJECT_ID` environment variable. Add these environment variables:\n```\nexport ORG_NAME=$PROJECT_ID\nexport ANALYTICS_REGION=\"ANALYTICS_REGION\"\nexport RUNTIMETYPE=HYBRID\n``````\nset ORG_NAME=$PROJECT_ID\nset ANALYTICS_REGION=\"ANALYTICS_REGION\"\nset RUNTIMETYPE=HYBRID\n```\n **Tip:** Use the`echo %` `` `%`command to verify that the  environment variables are properly set.\nWhere:- **ORG_NAME** **(Required)** : This value must   match the`PROJECT_ID`.\n- **ANALYTICS_REGION** **(Required)** : The primary region for   analytics data storage, where the variable is set to one of the following:| 0     | 1   | 2   | 3    |\n|:---------------------|:-------------|:-------------|:----------------|\n| asia-northeast1  | asia-south1 | asia-east1 | asia-southeast1 |\n| australia-southeast1 | us-central1 | us-east1  | us-west1  |\n| asia-southeast2  | europe-west1 | europe-west2 | nan    |Choose a region that is geographically close or one that satisfies your organization's storage requirements.\n- **RUNTIMETYPE** **(Required)** : Must be set to`HYBRID`.- Call the following Apigee API to create the organization:```\ncurl -H \"Authorization: Bearer $TOKEN\" -X POST -H \"content-type:application/json\" \\\n -d '{\n \"name\":\"'\"$ORG_NAME\"'\",\n \"runtimeType\":\"'\"$RUNTIMETYPE\"'\",\n \"analyticsRegion\":\"'\"$ANALYTICS_REGION\"'\"\n }' \\\n \"https://apigee.googleapis.com/v1/organizations?parent=projects/$PROJECT_ID\"\n``` **Tip: ** The quotation mark structure (`\"'\"`) in the previous  code sample is needed to pass the values of the environment variables within the JSON  body.On a successful creation request, the organizations API responds with a message similar  to the following:```\n{\u00a0 \"name\": \"organizations/org_name/operations/LONG_RUNNING_OPERATION_ID\",\u00a0 \"metadata\": {\u00a0 \u00a0 \"@type\": \"type.googleapis.com/google.cloud.apigee.v1.OperationMetadata\",\u00a0 \u00a0 \"operationType\": \"INSERT\",\u00a0 \u00a0 \"targetResourceName\": \"organizations/org_name\",\u00a0 \u00a0 \"state\": \"IN_PROGRESS\"\u00a0 }}\n```Where:- is the UUID of an asynchronous, long-running   operation. You can use this ID to check the status of your organization creation request   (described in step 5).\n- is the ID of your new organization that is currently   being created.\nAs the `state` property in the response indicates, Apigee has started to create  the new organization, so  its state is `IN_PROGRESS` . This process can take several minutes.If you get an error, see [Troubleshooting organization creation](#errors) .\n- Save the long-running operation ID to an environment variable.  It will be useful for future management tasks.\n```\nexport LONG_RUNNING_OPERATION_ID=LONG_RUNNING_OPERATION_ID\n``````\nexport LONG_RUNNING_OPERATION_ID=6abc8a72-46de-f9da-bcfe-70d9ab347e4f\n```\n- You can check the status of the long-running operation whose ID was returned by the  creation request. To do this, use the operations API. For example:```\ncurl -H \"Authorization: Bearer $TOKEN\" \\\n \"https://apigee.googleapis.com/v1/organizations/$ORG_NAME/operations/$LONG_RUNNING_OPERATION_ID\"\n```The following examples show possible responses to this request:\nIf Apigee is still creating the organization, Apigee responds with a status of `IN_PROGRESS` . For example:\n```\n{\u00a0 \"name\": \"organizations/ORG_NAME/operations/LONG_RUNNING_OPERATION_ID\",\u00a0 \"metadata\": {\u00a0 \u00a0 \"@type\": \"type.googleapis.com/google.cloud.apigee.v1.OperationMetadata\",\u00a0 \u00a0 \"operationType\": \"INSERT\",\u00a0 \u00a0 \"targetResourceName\": \"organizations/ORG_NAME\",\u00a0 \u00a0 \"state\": \"IN_PROGRESS\"\u00a0 }}\n```\nYou should wait a little longer before attempting to verify that the creation process   is complete.When the organization has been provisioned, the state of the long-running operation is `FINISHED` . For example:\n```\n{\u00a0 \"name\": \"organizations/ORG_NAME/operations/LONG_RUNNING_OPERATION_ID\",\u00a0 \"metadata\": {\u00a0 \u00a0 \"@type\": \"type.googleapis.com/google.cloud.apigee.v1.OperationMetadata\",\u00a0 \u00a0 \"operationType\": \"INSERT\",\u00a0 \u00a0 \"targetResourceName\": \"organizations/ORG_NAME\",\u00a0 \u00a0 \"state\": \"FINISHED\"\u00a0 },\u00a0 \"done\": true,\u00a0 \"response\": {\u00a0 \u00a0 \"@type\": \"type.googleapis.com/google.cloud.apigee.v1.Organization\",\u00a0 \u00a0 \"name\": \"ORG_NAME\",\u00a0 \u00a0 \"description\": \"\",\u00a0 \u00a0 \"createdAt\": \"1626237148461\",\u00a0 \u00a0 \"lastModifiedAt\": \"1626237149384\",\u00a0 \u00a0 \"properties\": {\u00a0 \u00a0 \u00a0 \"property\": [\u00a0 \u00a0 \u00a0 \u00a0 {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"name\": \"features.hybrid.enabled\",\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"value\": \"true\"\u00a0 \u00a0 \u00a0 \u00a0 },\u00a0 \u00a0 \u00a0 \u00a0 {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"name\": \"features.mart.connect.enabled\",\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"value\": \"true\"\u00a0 \u00a0 \u00a0 \u00a0 }\u00a0 \u00a0 \u00a0 ]\u00a0 \u00a0 },\u00a0 \u00a0 \"analyticsRegion\": \"ANALYTICS_REGION\",\u00a0 \u00a0 \"runtimeType\": \"HYBRID\",\u00a0 \u00a0 \"subscriptionType\": \"TRIAL\",\u00a0 \u00a0 \"state\": \"ACTIVE\",\u00a0 \u00a0 \"billingType\": \"EVALUATION\",\u00a0 \u00a0 \"expiresAt\": \"1631421073171\",\u00a0 \u00a0 \"addonsConfig\": {\u00a0 \u00a0 \u00a0 \"advancedApiOpsConfig\": {},\u00a0 \u00a0 \u00a0 \"integrationConfig\": {},\u00a0 \u00a0 \u00a0 \"monetizationConfig\": {}\u00a0 \u00a0 }\u00a0 }}\n```\n- You can use the Apigee organizations API to retrieve information about an organization after  it is created.  For example:```\ncurl -H \"Authorization: Bearer $TOKEN\" \\\n \"https://apigee.googleapis.com/v1/organizations/$ORG_NAME\"\n```The response to your request contains details about the specified organization in JSON  format.```\n{\u00a0 \"name\": \"apigee-example\",\u00a0 \"createdAt\": \"1626237148461\",\u00a0 \"lastModifiedAt\": \"1626237149384\",\u00a0 \"properties\": {\u00a0 \u00a0 \"property\": [\u00a0 \u00a0 \u00a0 {\u00a0 \u00a0 \u00a0 \u00a0 \"name\": \"features.hybrid.enabled\",\u00a0 \u00a0 \u00a0 \u00a0 \"value\": \"true\"\u00a0 \u00a0 \u00a0 },\u00a0 \u00a0 \u00a0 {\u00a0 \u00a0 \u00a0 \u00a0 \"name\": \"features.mart.connect.enabled\",\u00a0 \u00a0 \u00a0 \u00a0 \"value\": \"true\"\u00a0 \u00a0 \u00a0 }\u00a0 \u00a0 ]\u00a0 },\u00a0 \"analyticsRegion\": \"us-west1\",\u00a0 \"runtimeType\": \"HYBRID\",\u00a0 \"subscriptionType\": \"TRIAL\",\u00a0 \"projectId\": \"apigee-example\",\u00a0 \"state\": \"ACTIVE\",\u00a0 \"billingType\": \"EVALUATION\",\u00a0 \"expiresAt\": \"1631421073171\",\u00a0 \"addonsConfig\": {\u00a0 \u00a0 \"advancedApiOpsConfig\": {},\u00a0 \u00a0 \"integrationConfig\": {},\u00a0 \u00a0 \"monetizationConfig\": {}\u00a0 }}\n```", "content": "## Troubleshooting organization creation\nWhen you create an organization with the [Create organizations API](/apigee/docs/reference/apis/apigee/rest/v1/organizations/create) , you might get an error response. Responses look like the following:\n```\n{\n \"error\": {\n \"code\": HTTP_error_code,\n \"message\": \"short_error_message\",\n \"status\": \"high_level_error_type\",\n \"details\": [  {\n  \"@type\": \"specific_error_type\",\n  \"detail\": \"expanded_error_description\"\n  }\n ]\n }\n}\n```\nThe following table lists errors you might receive and potential resolutions when you try to create  a new organization:\n| HTTP\u00a0Error Code | HTTP Error          | Description                                                                   |\n|------------------:|:-------------------------------------------------|:-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|\n|    400 | Invalid JSON payload received     | Either the structure of the data in your request contains a syntax error or the path to the endpoint is incorrect.                                         |\n|    400 | Invalid organization ID       | The organization ID that you request cannot contain uppercase letters or any special characters other than hyphens. It must contain only lowercase letters, numbers, and/or hyphens. It can be up to a maximum of 32 characters long.            |\n|    400 | Unsupported analytics region      | You either did not specify the value of the analyticsRegion in your request body, or the value you specified is not one of the valid options.                                  |\n|    400 | Does not have an Apigee entitlement    | Your Google Cloud project (that you created in Step 2: Create a Google Cloud project) has not yet been hybrid enabled. This could indicate an issue with your billing or some other error related to your Google Cloud account. For more information, contact Apigee Sales.  |\n|    401 | Request\u00a0had\u00a0invalid\u00a0authentication credentials | Your gcloud authentication token is either bad or outdated, or you did not include one in the request. Generate a new token and resend the address.                                 |\n|    403 | Permission denied on resource project project_ID | You might have sent a request that contained an incorrect project ID or path.                                                  |\n|    403 | Unable to retrieve project information   | The organization has not yet been created or provisioned. You can issue a request to the Operations API to check the status of the long-running operation, as described in the step 5.                        |\n|    409 | Organization already exists      | You tried to create more than one organization for the Google Cloud project. You can only create one organization per project.                                      |\n|    409 | Org proposed_org_name already exists    | You tried to create an organization that has the same ID as one that already exists. Organization IDs must be unique across all hybrid customers. Resubmit with a new proposed organization ID; for example, append a numeric value to the end of the previous ID that you tried. |\n## \n Next step\nGo to Step 3: [Create an environment group](/apigee/docs/hybrid/v1.8/precog-add-environment) .", "guide": "Apigee"}