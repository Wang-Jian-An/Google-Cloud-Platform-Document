{"title": "Live Stream API - Configure live stream settings", "url": "https://cloud.google.com/livestream/docs/how-to/livestream-configurations", "abstract": "# Live Stream API - Configure live stream settings\nThis page describes how to configure settings during input endpoint or channel creation for live stream features such as multiple audio tracks, captions, and spritesheets.\n", "content": "## Configure through input endpoint creation\nYou can specify configurations for the following features during [input endpointcreation](/livestream/docs/how-to/create-input-endpoints) :\n### IP allowlisting\nYou can restrict access to input endpoints by specifying IP ranges the input stream should originate from, such as the IP address of the encoder. The video pipeline only accepts traffic from IP addresses in these ranges. The IP ranges must be in CIDR block format.\nConfigure the [securityRules](/livestream/docs/reference/rest/v1/projects.locations.inputs#SecurityRule) field in the `Input` resource:\n```\n{\u00a0 \"type\": \"RTMP_PUSH\",\u00a0 \"securityRules\": {\u00a0 \u00a0 \"ipRanges\": [\"1.2.3.4/32\"]\u00a0 }}\n```\n## Configure through channel creation\nYou can specify configurations for the following features during [channelcreation](/livestream/docs/how-to/create-channels) :\n### Multiple bitrate streams\nYou can create advanced channel configurations that support multiple bitrates, resolutions, and frame rates. The following configuration includes two `muxStream` s in the output, one at 360p with a frame rate of 30 FPS ( `mux_video_360p30` ) and another at 720p with a frame rate of 60 FPS ( `mux_video_720p60` ). This configuration also supports multiple audio bitrates. See [Recommended bitrates](/livestream/docs/best-practices#recommended-bitrates) for more information.\n```\n{\u00a0 \"inputAttachments\":[\u00a0 \u00a0 {\u00a0 \u00a0 \u00a0 \"key\":\"input-primary\",\u00a0 \u00a0 \u00a0 \"input\": \"projects/PROJECT_NUMBER/locations/LOCATION/inputs/INPUT_ID\"\u00a0 \u00a0 }\u00a0 ],\u00a0 \"output\":{\u00a0 \u00a0 \"uri\": \"gs://BUCKET_NAME\"\u00a0 },\u00a0 \"elementaryStreams\": [\u00a0 \u00a0 {\u00a0 \u00a0 \u00a0 \"key\": \"es_video_720p60\",\u00a0 \u00a0 \u00a0 \"videoStream\": {\u00a0 \u00a0 \u00a0 \u00a0 \"h264\": {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"profile\": \"high\",\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"heightPixels\": 720,\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"widthPixels\": 1280,\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"bitrateBps\": 5500000,\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"frameRate\": 60\u00a0 \u00a0 \u00a0 \u00a0 }\u00a0 \u00a0 \u00a0 }\u00a0 \u00a0 },\u00a0 \u00a0 {\u00a0 \u00a0 \u00a0 \"key\": \"es_video_360p30\",\u00a0 \u00a0 \u00a0 \"videoStream\": {\u00a0 \u00a0 \u00a0 \u00a0 \"h264\": {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"profile\": \"high\",\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"heightPixels\": 360,\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"widthPixels\": 640,\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"bitrateBps\": 400000,\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"frameRate\": 30\u00a0 \u00a0 \u00a0 \u00a0 }\u00a0 \u00a0 \u00a0 }\u00a0 \u00a0 },\u00a0 \u00a0 {\u00a0 \u00a0 \u00a0 \"key\": \"es_audio_160k\",\u00a0 \u00a0 \u00a0 \"audioStream\": {\u00a0 \u00a0 \u00a0 \u00a0 \"codec\": \"aac\",\u00a0 \u00a0 \u00a0 \u00a0 \"channelCount\": 2,\u00a0 \u00a0 \u00a0 \u00a0 \"bitrateBps\": 160000\u00a0 \u00a0 \u00a0 }\u00a0 \u00a0 },\u00a0 \u00a0 {\u00a0 \u00a0 \u00a0 \"key\": \"es_audio_64k\",\u00a0 \u00a0 \u00a0 \"audioStream\": {\u00a0 \u00a0 \u00a0 \u00a0 \"codec\": \"aac\",\u00a0 \u00a0 \u00a0 \u00a0 \"channelCount\": 2,\u00a0 \u00a0 \u00a0 \u00a0 \"bitrateBps\": 64000\u00a0 \u00a0 \u00a0 }\u00a0 \u00a0 }\u00a0 ],\u00a0 \"muxStreams\": [\u00a0 \u00a0 {\u00a0 \u00a0 \u00a0 \"key\": \"mux_video_720p60\",\u00a0 \u00a0 \u00a0 \"elementaryStreams\": [\u00a0 \u00a0 \u00a0 \u00a0 \"es_video_720p60\"\u00a0 \u00a0 \u00a0 ],\u00a0 \u00a0 \u00a0 \"segmentSettings\": {\u00a0 \u00a0 \u00a0 \u00a0 \"segmentDuration\": \"2s\"\u00a0 \u00a0 \u00a0 }\u00a0 \u00a0 },\u00a0 \u00a0 {\u00a0 \u00a0 \u00a0 \"key\": \"mux_video_360p30\",\u00a0 \u00a0 \u00a0 \"elementaryStreams\": [\u00a0 \u00a0 \u00a0 \u00a0 \"es_video_360p30\"\u00a0 \u00a0 \u00a0 ],\u00a0 \u00a0 \u00a0 \"segmentSettings\": {\u00a0 \u00a0 \u00a0 \u00a0 \"segmentDuration\": \"2s\"\u00a0 \u00a0 \u00a0 }\u00a0 \u00a0 },\u00a0 \u00a0 {\u00a0 \u00a0 \u00a0 \"key\": \"mux_audio_160k\",\u00a0 \u00a0 \u00a0 \"elementaryStreams\": [\u00a0 \u00a0 \u00a0 \u00a0 \"es_audio_160k\"\u00a0 \u00a0 \u00a0 ],\u00a0 \u00a0 \u00a0 \"segmentSettings\": {\u00a0 \u00a0 \u00a0 \u00a0 \"segmentDuration\": \"2s\"\u00a0 \u00a0 \u00a0 }\u00a0 \u00a0 },\u00a0 \u00a0 {\u00a0 \u00a0 \u00a0 \"key\": \"mux_audio_64k\",\u00a0 \u00a0 \u00a0 \"elementaryStreams\": [\u00a0 \u00a0 \u00a0 \u00a0 \"es_audio_64k\"\u00a0 \u00a0 \u00a0 ],\u00a0 \u00a0 \u00a0 \"segmentSettings\": {\u00a0 \u00a0 \u00a0 \u00a0 \"segmentDuration\": \"2s\"\u00a0 \u00a0 \u00a0 }\u00a0 \u00a0 }\u00a0 ],\u00a0 \"manifests\": [\u00a0 \u00a0 {\u00a0 \u00a0 \u00a0 \"fileName\": \"main.mpd\",\u00a0 \u00a0 \u00a0 \"type\": \"DASH\",\u00a0 \u00a0 \u00a0 \"muxStreams\": [\u00a0 \u00a0 \u00a0 \u00a0 \"mux_video_720p60\",\u00a0 \u00a0 \u00a0 \u00a0 \"mux_video_360p30\",\u00a0 \u00a0 \u00a0 \u00a0 \"mux_audio_160k\",\u00a0 \u00a0 \u00a0 \u00a0 \"mux_audio_64k\"\u00a0 \u00a0 \u00a0 ],\u00a0 \u00a0 \u00a0 \"maxSegmentCount\": 5\u00a0 \u00a0 },\u00a0 \u00a0 {\u00a0 \u00a0 \u00a0 \"fileName\": \"main.m3u8\",\u00a0 \u00a0 \u00a0 \"type\": \"HLS\",\u00a0 \u00a0 \u00a0 \"muxStreams\": [\u00a0 \u00a0 \u00a0 \u00a0 \"mux_video_720p60\",\u00a0 \u00a0 \u00a0 \u00a0 \"mux_video_360p30\",\u00a0 \u00a0 \u00a0 \u00a0 \"mux_audio_160k\",\u00a0 \u00a0 \u00a0 \u00a0 \"mux_audio_64k\"\u00a0 \u00a0 \u00a0 ],\u00a0 \u00a0 \u00a0 \"maxSegmentCount\": 5\u00a0 \u00a0 }\u00a0 ]}\n```\n### Multiple audio tracks\nIf the input stream contains more than one audio track, use the [AudioMapping](/livestream/docs/reference/rest/v1/projects.locations.channels#AudioMapping) object to select the track for each [AudioStream](/livestream/docs/reference/rest/v1/projects.locations.channels#audiostream) .\n```\n{\u00a0 \"inputAttachments\": [\u00a0 \u00a0 {\u00a0 \u00a0 \u00a0 \"key\": \"MY-INPUT\",\u00a0 \u00a0 \u00a0 \"input\": \"/projects/PROJECT-ID/locations/LOCATION/inputs/MY-INPUT\",\u00a0 \u00a0 }\u00a0 ],\u00a0 \"output\": {\u00a0 \u00a0 \"uri\": \"gs://BUCKET_NAME/outputs/\"\u00a0 },\u00a0 \"elementaryStreams\": [\u00a0 \u00a0 {\u00a0 \u00a0 \u00a0 \"key\": \"es_video\",\u00a0 \u00a0 \u00a0 \"videoStream\": {\u00a0 \u00a0 \u00a0 \u00a0 \"h264\": {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"heightPixels\": 720,\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"widthPixels\": 1280,\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"bitrateBps\": 3000000,\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"frameRate\": 30\u00a0 \u00a0 \u00a0 \u00a0 }\u00a0 \u00a0 \u00a0 }\u00a0 \u00a0 },\u00a0 \u00a0 {\u00a0 \u00a0 \u00a0 \"key\": \"es_first_audio\",\u00a0 \u00a0 \u00a0 \"audioStream\": {\u00a0 \u00a0 \u00a0 \u00a0 \"codec\": \"aac\",\u00a0 \u00a0 \u00a0 \u00a0 \"bitrateBps\": 160000,\u00a0 \u00a0 \u00a0 \u00a0 \"mapping\": [\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"inputKey\": \"MY-INPUT\",\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"inputTrack\": 1\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 }\u00a0 \u00a0 \u00a0 \u00a0 ]\u00a0 \u00a0 \u00a0 }\u00a0 \u00a0 },\u00a0 \u00a0 {\u00a0 \u00a0 \u00a0 \"key\": \"es_second_audio\",\u00a0 \u00a0 \u00a0 \"audioStream\": {\u00a0 \u00a0 \u00a0 \u00a0 \"codec\": \"aac\",\u00a0 \u00a0 \u00a0 \u00a0 \"bitrateBps\": 160000,\u00a0 \u00a0 \u00a0 \u00a0 \"mapping\": [\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"inputKey\": \"MY-INPUT\",\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"inputTrack\": 2\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 }\u00a0 \u00a0 \u00a0 \u00a0 ]\u00a0 \u00a0 \u00a0 }\u00a0 \u00a0 }\u00a0 ],\u00a0 \"muxStreams\": [\u00a0 \u00a0 {\u00a0 \u00a0 \u00a0 \"key\": \"mux_video\",\u00a0 \u00a0 \u00a0 \"elementaryStreams\": [\"es_video\"],\u00a0 \u00a0 },\u00a0 \u00a0 {\u00a0 \u00a0 \u00a0 \"key\": \"mux_first_audio\",\u00a0 \u00a0 \u00a0 \"elementaryStreams\": [\"es_first_audio\"],\u00a0 \u00a0 },\u00a0 \u00a0 {\u00a0 \u00a0 \u00a0 \"key\": \"mux_second_audio\",\u00a0 \u00a0 \u00a0 \"elementaryStreams\": [\"es_second_audio\"],\u00a0 \u00a0 }\u00a0 ],\u00a0 \"manifests\": [\u00a0 \u00a0 {\u00a0 \u00a0 \u00a0 \"type\": \"DASH\",\u00a0 \u00a0 \u00a0 \"muxStreams\": [\u00a0 \u00a0 \u00a0 \u00a0 \"mux_video\",\u00a0 \u00a0 \u00a0 \u00a0 \"mux_first_audio\",\u00a0 \u00a0 \u00a0 \u00a0 \"mux_second_audio\",\u00a0 \u00a0 \u00a0 ]\u00a0 \u00a0 }\u00a0 ]}\n```\nNote that [Shaka Player](https://shaka-player-demo.appspot.com/demo/) doesn't support the following features for HLS streams with multiple audio tracks:\n- Alternate audio track playback with TS segments.\n- Secondary and alternate audio track selection with fMP4 segments.\n### Passthrough CEA 608/708 captions\nIf the input streams contain CEA 608/708 captions, you can forward the captions to the output streams. Add the following [textStream](/livestream/docs/reference/rest/v1/projects.locations.channels#textstream) to the [elementaryStreams](/livestream/docs/reference/rest/v1/projects.locations.channels#elementarystream) when creating a `Channel` . This `textStream` embeds the CEA 608/708 captions in all output video streams and renditions.\n```\n{\u00a0 \"key\": \"captions\",\u00a0 \"textStream\": {\u00a0 \u00a0 \"codec\": \"cea608\"\u00a0 }}\n```\n### Sprite sheets\nTo generate a sprite sheet, configure the [spriteSheets](/livestream/docs/reference/rest/v1/projects.locations.channels#spritesheet) field in the `Channel` resource.\n```\n{\u00a0 \"spriteSheets\": [\u00a0 \u00a0 {\u00a0 \u00a0 \u00a0 \"format\": \"jpeg\",\u00a0 \u00a0 \u00a0 \"filePrefix\": \"sprite\",\u00a0 \u00a0 \u00a0 \"interval\": \"2s\",\u00a0 \u00a0 \u00a0 \"spriteWidthPixels\": 320,\u00a0 \u00a0 \u00a0 \"spriteHeightPixels\": 240,\u00a0 \u00a0 \u00a0 \"columnCount\": 3,\u00a0 \u00a0 \u00a0 \"rowCount\": 3,\u00a0 \u00a0 \u00a0 \"quality\": 80\u00a0 \u00a0 }\u00a0 ]}\n```", "guide": "Live Stream API"}