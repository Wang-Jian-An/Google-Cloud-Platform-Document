{"title": "Live Stream API - Encrypt a live stream", "url": "https://cloud.google.com/livestream/docs/how-to/encrypt-content", "abstract": "# Live Stream API - Encrypt a live stream\nThis page explains how to encrypt live stream content. The Live Stream API does not create or manage encryption keys or licenses directly. Instead, you must use a third-party digital rights management (DRM) provider for these features. Once encryption keys have been created for your media, pass those keys to the Live Stream API using [Secret Manager](/secret-manager) .\nEncryption settings are specified in the [Channel](/livestream/docs/reference/rest/v1/projects.locations.channels) settings. Once streaming begins, the Live Stream API video pipeline begins encrypting your content. The output manifest includes information required to decrypt the content within your media player of choice.\n", "content": "## Supported configurations\n| Streaming protocol | Container | DRM system | Encryption scheme  |\n|:---------------------|:------------|:-------------|:----------------------|\n| HLS     | TS   | ClearKey  | aes128    |\n| HLS     | TS   | ClearKey  | sampleAes    |\n| HLS     | TS   | FairPlay  | sampleAes    |\n| HLS     | fMP4  | FairPlay  | mpegCenc cbcs only |\n| MPEG-DASH   | fMP4  | ClearKey  | mpegCenc cenc or cbcs |\n| MPEG-DASH   | fMP4  | Widevine  | mpegCenc cenc or cbcs |\n| HLS     | fMP4  | Widevine  | mpegCenc cenc or cbcs |\n| MPEG-DASH   | fMP4  | PlayReady | mpegCenc cenc or cbcs |\n| HLS     | fMP4  | PlayReady | mpegCenc cenc or cbcs |\n## Add the encryption key to Secret Manager\nBefore you begin, create your encryption keys using your third-party DRM provider of choice.\nThe Live Stream API requires your secret to contain the encryption key in the following JSON format, along with other necessary information.\nSee the [DRM protocol documentation](/livestream/docs/reference/drm) for a description of each field. Note that you need to convert from snake case to camel case for JSON format.\n```\n{\u00a0 \"encryptionKeys\": [\u00a0 \u00a0 {\u00a0 \u00a0 \u00a0 // Key for FairPlay configuration.\u00a0 \u00a0 \u00a0 \"keyId\": \"d569cb35bd0548c7a99d92feb381df13\",\u00a0 \u00a0 \u00a0 \"key\": \"f1967daca83e81f38d80aa741e7b32c2\",\u00a0 \u00a0 \u00a0 \"iv\": \"8d80aa741e7b32c2f1967daca83e81f3\",\u00a0 \u00a0 \u00a0 \"keyUri\": \"skd://d569cb35bd0548c7a99d92feb381df13\",\u00a0 \u00a0 \u00a0 \"matchers\": [\u00a0 \u00a0 \u00a0 \u00a0 {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"muxStreams\": [\"ts_fairplay\"]\u00a0 \u00a0 \u00a0 \u00a0 }\u00a0 \u00a0 \u00a0 ]\u00a0 \u00a0 },\u00a0 \u00a0 {\u00a0 \u00a0 \u00a0 // Key for Widevine configurations.\u00a0 \u00a0 \u00a0 \"keyId\": \"44ec248b048c43a6a6ee58a752c6f9f8\",\u00a0 \u00a0 \u00a0 \"key\": \"f1967daca83e81f38d80aa741e7b32c2\",\u00a0 \u00a0 \u00a0 \"keyUri\": \"skd://44ec248b048c43a6a6ee58a752c6f9f8\",\u00a0 \u00a0 \u00a0 \"matchers\": [\u00a0 \u00a0 \u00a0 \u00a0 {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"muxStreams\": [\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"fmp4_widevine_cenc_video\",\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"fmp4_widevine_cenc_audio\",\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"fmp4_widevine_cbcs_video\",\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"fmp4_widevine_cbcs_audio\"\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 ]\u00a0 \u00a0 \u00a0 \u00a0 }\u00a0 \u00a0 \u00a0 ]\u00a0 \u00a0 },\u00a0 \u00a0 {\u00a0 \u00a0 \u00a0 // Key for PlayReady configurations.\u00a0 \u00a0 \u00a0 \"keyId\": \"8beed229709f480bb6004ec0f33e82d1\",\u00a0 \u00a0 \u00a0 \"key\": \"ad20cd838f354dcc8a77c443d08ff09f\",\u00a0 \u00a0 \u00a0 \"keyUri\": \"skd://8beed229709f480bb6004ec0f33e82d1\",\u00a0 \u00a0 \u00a0 \"matchers\": [\u00a0 \u00a0 \u00a0 \u00a0 {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"muxStreams\": [\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"fmp4_playready_cenc_video\",\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"fmp4_playready_cenc_audio\",\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"fmp4_playready_cbcs_video\",\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"fmp4_playready_cbcs_audio\"\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 ]\u00a0 \u00a0 \u00a0 \u00a0 }\u00a0 \u00a0 \u00a0 ]\u00a0 \u00a0 },\u00a0 \u00a0 {\u00a0 \u00a0 \u00a0 // Key for all ClearKey configurations.\u00a0 \u00a0 \u00a0 \"keyId\": \"3d9dccb479c64adbb6e514790caa7822\",\u00a0 \u00a0 \u00a0 \"key\": \"f1967daca83e81f38d80aa741e7b32c2\",\u00a0 \u00a0 \u00a0 \"keyUri\": \"https://example.com/keys/3d9dccb479c64adbb6e514790caa7822.bin\",\u00a0 \u00a0 \u00a0 \"iv\": \"8d80aa741e7b32c2f1967daca83e81f3\"\u00a0 \u00a0 \u00a0 // No `matchers` field. This is the default key to use when none of the keys above match.\u00a0 \u00a0 }\u00a0 ]}\n```\nIf your encryption configuration (for example, FairPlay) requires an explicit initialization vector (IV) but it is not included, the API will use the value of `keyId` for the value of `iv` .\nTo add your encryption key, do either of the following:\n- Manually add and configure keys. Use the preceding JSON data, add your encryption key to  Secret Manager following the steps at [Create a secret](/secret-manager/docs/creating-and-accessing-secrets) .\n- Implement a `key publisher` that obtains any needed encryption keys and writes them to Secret Manager as secret versions. See a [sampleimplementation that runs as a Cloud Functions](https://github.com/GoogleCloudPlatform/python-docs-samples/tree/main/cloud-media-livestream/keypublisher) . **Note:** Implementing Secret Manager might incur some [additional costs](/secret-manager/pricing) .\nThen, do the following to configure your encryption key:\n- Configure IAM permissions on your secret so that the Live Stream API can access the secret content. To do this, grant the`secretmanager.secretAccessor`role to the`service-` `` `@gcp-sa-livestream.iam.gserviceaccount.com`service account (this is similar to how the [service account has access to yourCloud Storage buckets](/livestream/docs/access-control#access_to_gcs) ).\n- Find the resource name of the secret version you created (for example,`projects/` `` `/secrets/` `` `/versions/` ``). You need this name to configure the channel.## Configure the channel\nEncryption settings are specified using objects in the [encryptions](/livestream/docs/reference/rest/v1/projects.locations.channels#Channel.FIELDS.encryptions) array at the `Channel` level. A unique identifier ( [id](/livestream/docs/reference/rest/v1/projects.locations.channels#encryption) ) is assigned to each different configuration. Each `muxStream` uses an identifier to indicate which encryption configuration to use, or omits that field to remain unencrypted.\n```\n{\u00a0 // other channel settings \u2026\u00a0 \"encryptions\": [\u00a0 \u00a0 {\u00a0 \u00a0 \u00a0 // Identifier for this encryption configuration, to be specified in muxStream(s).\u00a0 \u00a0 \u00a0 \"id\": string,\u00a0 \u00a0 \u00a0 // Configuration for secrets stored in Google Secret Manager.\u00a0 \u00a0 \u00a0 \"secretManagerKeySource\": {\u00a0 \u00a0 \u00a0 \u00a0 // The name of the Secret Version containing the encryption key.\u00a0 \u00a0 \u00a0 \u00a0 // `projects/{project}/secrets/{secret_id}/versions/{version_number}`\u00a0 \u00a0 \u00a0 \u00a0 // Using {version_number} of `latest` is not supported.\u00a0 \u00a0 \u00a0 \u00a0 \"secretVersion\": string\u00a0 \u00a0 \u00a0 },\u00a0 \u00a0 \u00a0 // DRM system(s) that will be used. At least one must be specified. If a DRM system\u00a0 \u00a0 \u00a0 // is omitted, it will be considered disabled.\u00a0 \u00a0 \u00a0 \"drmSystems\": {\u00a0 \u00a0 \u00a0 \u00a0 // Widevine configuration.\u00a0 \u00a0 \u00a0 \u00a0 \"widevine\": {},\u00a0 \u00a0 \u00a0 \u00a0 // FairPlay configuration.\u00a0 \u00a0 \u00a0 \u00a0 \"fairplay\": {},\u00a0 \u00a0 \u00a0 \u00a0 // PlayReady configuration.\u00a0 \u00a0 \u00a0 \u00a0 \"playready\": {},\u00a0 \u00a0 \u00a0 \u00a0 // ClearKey configuration.\u00a0 \u00a0 \u00a0 \u00a0 \"clearkey\": {}\u00a0 \u00a0 \u00a0 },\u00a0 \u00a0 \u00a0 // Union field encryption_mode can be only one of the following:\u00a0 \u00a0 \u00a0 // Configuration for HLS AES-128 encryption.\u00a0 \u00a0 \u00a0 \"aes128\": {},\u00a0 \u00a0 \u00a0 // Configuration for HLS SAMPLE-AES encryption.\u00a0 \u00a0 \u00a0 \"sampleAes\": {},\u00a0 \u00a0 \u00a0 // Configuration for MPEG-DASH Common Encryption (MPEG-CENC).\u00a0 \u00a0 \u00a0 \"mpegCenc\": {\u00a0 \u00a0 \u00a0 \u00a0 // Specify the encryption scheme. Supported schemes:\u00a0 \u00a0 \u00a0 \u00a0 // - `cenc` - AES-CTR subsample\u00a0 \u00a0 \u00a0 \u00a0 // - `cbcs`- AES-CBC subsample pattern\u00a0 \u00a0 \u00a0 \u00a0 \"scheme\": string\u00a0 \u00a0 \u00a0 }\u00a0 \u00a0 \u00a0 // End of list of possible types for union field encryption_mode.\u00a0 \u00a0 }\u00a0 \u00a0 // Any other encryption configurations.\u00a0 ],\u00a0 \"muxStreams\": [\u00a0 \u00a0 {\u00a0 \u00a0 \u00a0 // Unique identifier for the muxStream.\u00a0 \u00a0 \u00a0 \"key\": string,\u00a0 \u00a0 \u00a0 // Identifier of the encryption configuration for the muxStream.\u00a0 \u00a0 \u00a0 \"encryptionId\": string\u00a0 \u00a0 \u00a0 // \u2026 other muxStream settings.\u00a0 \u00a0 }\u00a0 \u00a0 // Other muxStreams.\u00a0 ],\u00a0 // Other channel settings.}\n```\nThe following example configures AES-128 and SAMPLE-AES muxStreams in HLS manifests, and MPEG-CENC muxStreams (cenc and cbcs) in DASH manifests:\n```\n\"elementaryStreams\": [\u00a0 {\u00a0 \u00a0 \"key\": \"es_video\",\u00a0 \u00a0 \"videoStream\": {\u00a0 \u00a0 \u00a0 \"h264\": {\u00a0 \u00a0 \u00a0 \u00a0 \"profile\": \"main\",\u00a0 \u00a0 \u00a0 \u00a0 \"heightPixels\": 600,\u00a0 \u00a0 \u00a0 \u00a0 \"widthPixels\": 800,\u00a0 \u00a0 \u00a0 \u00a0 \"bitrateBps\": 1000000,\u00a0 \u00a0 \u00a0 \u00a0 \"frameRate\": 60,\u00a0 \u00a0 \u00a0 },\u00a0 \u00a0 },\u00a0 },\u00a0 {\u00a0 \u00a0 \"key\": \"es_audio\",\u00a0 \u00a0 \"audioStream\": {\u00a0 \u00a0 \u00a0 \"codec\": \"aac\",\u00a0 \u00a0 \u00a0 \"channelCount\": 2,\u00a0 \u00a0 \u00a0 \"bitrateBps\": 160000\u00a0 \u00a0 }\u00a0 }],\"encryptions\": [\u00a0 {\u00a0 \u00a0 \"id\": \"aes-128\",\u00a0 \u00a0 \"secretManagerKeySource\": {\u00a0 \u00a0 \u00a0 \"secretVersion\": \"projects/12345/secrets/key-1/versions/1\"\u00a0 \u00a0 },\u00a0 \u00a0 \"drmSystems\": {\"clearkey\": {}},\u00a0 \u00a0 \"aes128\": {}\u00a0 },\u00a0 {\u00a0 \u00a0 \"id\": \"sample-aes\",\u00a0 \u00a0 \"secretManagerKeySource\": {\u00a0 \u00a0 \u00a0 \"secretVersion\": \"projects/12345/secrets/key-1/versions/1\"\u00a0 \u00a0 },\u00a0 \u00a0 \"drmSystems\": {\"clearkey\": {}},\u00a0 \u00a0 \"sampleAes\": {}\u00a0 },\u00a0 {\u00a0 \u00a0 \"id\": \"cenc\",\u00a0 \u00a0 \"secretManagerKeySource\": {\u00a0 \u00a0 \u00a0 \"secretVersion\": \"projects/12345/secrets/key-1/versions/1\"\u00a0 \u00a0 },\u00a0 \u00a0 \"drmSystems\": {\"clearkey\": {}},\u00a0 \u00a0 \"mpegCenc\": {\u00a0 \u00a0 \u00a0 \"scheme\": \"cenc\"\u00a0 \u00a0 }\u00a0 },\u00a0 {\u00a0 \u00a0 \"id\": \"cbcs\",\u00a0 \u00a0 \"secretManagerKeySource\": {\u00a0 \u00a0 \u00a0 \"secretVersion\": \"projects/12345/secrets/key-1/versions/1\"\u00a0 \u00a0 },\u00a0 \u00a0 \"drmSystems\": {\"clearkey\": {}},\u00a0 \u00a0 \"mpegCenc\": {\u00a0 \u00a0 \u00a0 \"scheme\": \"cbcs\"\u00a0 \u00a0 }\u00a0 }],\"muxStreams\": [\u00a0 {\u00a0 \u00a0 \"key\": \"ts_aes128\",\u00a0 \u00a0 \"container\": \"ts\",\u00a0 \u00a0 \"elementaryStreams\": [\"es_video\", \"es_audio\"],\u00a0 \u00a0 \"segmentSettings\": {\"segmentDuration\": \"2s\"},\u00a0 \u00a0 \"encryptionId\": \"aes-128\"\u00a0 },\u00a0 {\u00a0 \u00a0 \"key\": \"ts_sampleaes\",\u00a0 \u00a0 \"container\": \"ts\",\u00a0 \u00a0 \"elementaryStreams\": [\"es_video\", \"es_audio\"],\u00a0 \u00a0 \"segmentSettings\": {\"segmentDuration\": \"2s\"},\u00a0 \u00a0 \"encryptionId\": \"sample-aes\"\u00a0 },\u00a0 {\u00a0 \u00a0 \"key\": \"fmp4_cenc_video\",\u00a0 \u00a0 \"container\": \"fmp4\",\u00a0 \u00a0 \"elementaryStreams\": [\"es_video\"],\u00a0 \u00a0 \"segmentSettings\": {\"segmentDuration\": \"2s\"},\u00a0 \u00a0 \"encryptionId\": \"cenc\"\u00a0 },\u00a0 {\u00a0 \u00a0 \"key\": \"fmp4_cenc_audio\",\u00a0 \u00a0 \"container\": \"fmp4\",\u00a0 \u00a0 \"elementaryStreams\": [\"es_audio\"],\u00a0 \u00a0 \"segmentSettings\": {\"segmentDuration\": \"2s\"},\u00a0 \u00a0 \"encryptionId\": \"cenc\"\u00a0 },\u00a0 {\u00a0 \u00a0 \"key\": \"fmp4_cbcs_video\",\u00a0 \u00a0 \"container\": \"fmp4\",\u00a0 \u00a0 \"elementaryStreams\": [\"es_video\"],\u00a0 \u00a0 \"segmentSettings\": {\"segmentDuration\": \"2s\"},\u00a0 \u00a0 \"encryptionId\": \"cbcs\"\u00a0 },\u00a0 {\u00a0 \u00a0 \"key\": \"fmp4_cbcs_audio\",\u00a0 \u00a0 \"container\": \"fmp4\",\u00a0 \u00a0 \"elementaryStreams\": [\"es_audio\"],\u00a0 \u00a0 \"segmentSettings\": {\"segmentDuration\": \"2s\"},\u00a0 \u00a0 \"encryptionId\": \"cbcs\"\u00a0 }],\"manifests\": [\u00a0 {\u00a0 \u00a0 \"fileName\": \"manifest_aes128.m3u8\",\u00a0 \u00a0 \"type\": \"HLS\",\u00a0 \u00a0 \"muxStreams\": [\"ts_aes128\"],\u00a0 \u00a0 \"maxSegmentCount\": 10\u00a0 },\u00a0 {\u00a0 \u00a0 \"fileName\": \"manifest_sampleaes.m3u8\",\u00a0 \u00a0 \"type\": \"HLS\",\u00a0 \u00a0 \"muxStreams\": [\"ts_sampleaes\"],\u00a0 \u00a0 \"maxSegmentCount\": 10\u00a0 },\u00a0 {\u00a0 \u00a0 \"fileName\": \"manifest_cenc.mpd\",\u00a0 \u00a0 \"type\": \"DASH\",\u00a0 \u00a0 \"muxStreams\": [\"fmp4_cenc_video\", \"fmp4_cenc_audio\"],\u00a0 \u00a0 \"maxSegmentCount\": 10\u00a0 },\u00a0 {\u00a0 \u00a0 \"fileName\": \"manifest_cbcs.mpd\",\u00a0 \u00a0 \"type\": \"DASH\",\u00a0 \u00a0 \"muxStreams\": [\"fmp4_cbcs_video\", \"fmp4_cbcs_audio\"],\u00a0 \u00a0 \"maxSegmentCount\": 10\u00a0 }]\n```\nThe following example configures FairPlay/SAMPLE-AES, Widevine/MPEG-CENC (cenc and cbcs), and PlayReady/MPEG-CENC (cenc and cbcs) muxStreams. Widevine and PlayReady muxStreams are included in both HLS and DASH manifests.\n```\n\"elementaryStreams\": [\u00a0 {\u00a0 \u00a0 \"key\": \"es_video\",\u00a0 \u00a0 \"videoStream\": {\u00a0 \u00a0 \u00a0 \"h264\": {\u00a0 \u00a0 \u00a0 \u00a0 \"profile\": \"main\",\u00a0 \u00a0 \u00a0 \u00a0 \"heightPixels\": 600,\u00a0 \u00a0 \u00a0 \u00a0 \"widthPixels\": 800,\u00a0 \u00a0 \u00a0 \u00a0 \"bitrateBps\": 1000000,\u00a0 \u00a0 \u00a0 \u00a0 \"frameRate\": 60,\u00a0 \u00a0 \u00a0 },\u00a0 \u00a0 },\u00a0 },\u00a0 {\u00a0 \u00a0 \"key\": \"es_audio\",\u00a0 \u00a0 \"audioStream\": {\u00a0 \u00a0 \u00a0 \"codec\": \"aac\",\u00a0 \u00a0 \u00a0 \"channelCount\": 2,\u00a0 \u00a0 \u00a0 \"bitrateBps\": 160000\u00a0 \u00a0 }\u00a0 }],\"encryptions\": [\u00a0 {\u00a0 \u00a0 \"id\": \"fairplay\",\u00a0 \u00a0 \"secretManagerKeySource\": {\u00a0 \u00a0 \u00a0 \"secretVersion\": \"projects/12345/secrets/key-1/versions/1\"\u00a0 \u00a0 },\u00a0 \u00a0 \"drmSystems\": {\"fairplay\": {}},\u00a0 \u00a0 \"sampleAes\": {}\u00a0 },\u00a0 {\u00a0 \u00a0 \"id\": \"widevine-cenc\",\u00a0 \u00a0 \"secretManagerKeySource\": {\u00a0 \u00a0 \u00a0 \"secretVersion\": \"projects/12345/secrets/key-1/versions/1\"\u00a0 \u00a0 },\u00a0 \u00a0 \"drmSystems\": {\"widevine\": {}},\u00a0 \u00a0 \"mpegCenc\": {\u00a0 \u00a0 \u00a0 \"scheme\": \"cenc\"\u00a0 \u00a0 }\u00a0 },\u00a0 {\u00a0 \u00a0 \"id\": \"widevine-cbcs\",\u00a0 \u00a0 \"secretManagerKeySource\": {\u00a0 \u00a0 \u00a0 \"secretVersion\": \"projects/12345/secrets/key-1/versions/1\"\u00a0 \u00a0 },\u00a0 \u00a0 \"drmSystems\": {\"widevine\": {}},\u00a0 \u00a0 \"mpegCenc\": {\u00a0 \u00a0 \u00a0 \"scheme\": \"cbcs\"\u00a0 \u00a0 }\u00a0 },\u00a0 {\u00a0 \u00a0 \"id\": \"playready-cenc\",\u00a0 \u00a0 \"secretManagerKeySource\": {\u00a0 \u00a0 \u00a0 \"secretVersion\": \"projects/12345/secrets/key-1/versions/1\"\u00a0 \u00a0 },\u00a0 \u00a0 \"drmSystems\": {\"playready\": {}},\u00a0 \u00a0 \"mpegCenc\": {\u00a0 \u00a0 \u00a0 \"scheme\": \"cenc\"\u00a0 \u00a0 }\u00a0 },\u00a0 {\u00a0 \u00a0 \"id\": \"playready-cbcs\",\u00a0 \u00a0 \"secretManagerKeySource\": {\u00a0 \u00a0 \u00a0 \"secretVersion\": \"projects/12345/secrets/key-1/versions/1\"\u00a0 \u00a0 },\u00a0 \u00a0 \"drmSystems\": {\"playready\": {}},\u00a0 \u00a0 \"mpegCenc\": {\u00a0 \u00a0 \u00a0 \"scheme\": \"cbcs\"\u00a0 \u00a0 }\u00a0 }],\"muxStreams\": [\u00a0 {\u00a0 \u00a0 \"key\": \"ts_fairplay\",\u00a0 \u00a0 \"container\": \"ts\",\u00a0 \u00a0 \"elementaryStreams\": [\"es_video\", \"es_audio\"],\u00a0 \u00a0 \"segmentSettings\": {\"segmentDuration\": \"2s\"},\u00a0 \u00a0 \"encryptionId\": \"fairplay\"\u00a0 },\u00a0 {\u00a0 \u00a0 \"key\": \"fmp4_widevine_cenc_video\",\u00a0 \u00a0 \"container\": \"fmp4\",\u00a0 \u00a0 \"elementaryStreams\": [\"es_video\"],\u00a0 \u00a0 \"segmentSettings\": {\"segmentDuration\": \"2s\"},\u00a0 \u00a0 \"encryptionId\": \"widevine-cenc\"\u00a0 },\u00a0 {\u00a0 \u00a0 \"key\": \"fmp4_widevine_cenc_audio\",\u00a0 \u00a0 \"container\": \"fmp4\",\u00a0 \u00a0 \"elementaryStreams\": [\"es_audio\"],\u00a0 \u00a0 \"segmentSettings\": {\"segmentDuration\": \"2s\"},\u00a0 \u00a0 \"encryptionId\": \"widevine-cenc\"\u00a0 },\u00a0 {\u00a0 \u00a0 \"key\": \"fmp4_widevine_cbcs_video\",\u00a0 \u00a0 \"container\": \"fmp4\",\u00a0 \u00a0 \"elementaryStreams\": [\"es_video\"],\u00a0 \u00a0 \"segmentSettings\": {\"segmentDuration\": \"2s\"},\u00a0 \u00a0 \"encryptionId\": \"widevine-cbcs\"\u00a0 },\u00a0 {\u00a0 \u00a0 \"key\": \"fmp4_widevine_cbcs_audio\",\u00a0 \u00a0 \"container\": \"fmp4\",\u00a0 \u00a0 \"elementaryStreams\": [\"es_audio\"],\u00a0 \u00a0 \"segmentSettings\": {\"segmentDuration\": \"2s\"},\u00a0 \u00a0 \"encryptionId\": \"widevine-cbcs\"\u00a0 },\u00a0 {\u00a0 \u00a0 \"key\": \"fmp4_playready_cenc_video\",\u00a0 \u00a0 \"container\": \"fmp4\",\u00a0 \u00a0 \"elementaryStreams\": [\"es_video\"],\u00a0 \u00a0 \"segmentSettings\": {\"segmentDuration\": \"2s\"},\u00a0 \u00a0 \"encryptionId\": \"playready-cenc\"\u00a0 },\u00a0 {\u00a0 \u00a0 \"key\": \"fmp4_playready_cenc_audio\",\u00a0 \u00a0 \"container\": \"fmp4\",\u00a0 \u00a0 \"elementaryStreams\": [\"es_audio\"],\u00a0 \u00a0 \"segmentSettings\": {\"segmentDuration\": \"2s\"},\u00a0 \u00a0 \"encryptionId\": \"playready-cenc\"\u00a0 },\u00a0 {\u00a0 \u00a0 \"key\": \"fmp4_playready_cbcs_video\",\u00a0 \u00a0 \"container\": \"fmp4\",\u00a0 \u00a0 \"elementaryStreams\": [\"es_video\"],\u00a0 \u00a0 \"segmentSettings\": {\"segmentDuration\": \"2s\"},\u00a0 \u00a0 \"encryptionId\": \"playready-cbcs\"\u00a0 },\u00a0 {\u00a0 \u00a0 \"key\": \"fmp4_playready_cbcs_audio\",\u00a0 \u00a0 \"container\": \"fmp4\",\u00a0 \u00a0 \"elementaryStreams\": [\"es_audio\"],\u00a0 \u00a0 \"segmentSettings\": {\"segmentDuration\": \"2s\"},\u00a0 \u00a0 \"encryptionId\": \"playready-cbcs\"\u00a0 }],\"manifests\": [\u00a0 {\u00a0 \u00a0 \"fileName\": \"manifest_fairplay.m3u8\",\u00a0 \u00a0 \"type\": \"HLS\",\u00a0 \u00a0 \"muxStreams\": [\"ts_fairplay\"],\u00a0 \u00a0 \"maxSegmentCount\": 10\u00a0 },\u00a0 {\u00a0 \u00a0 \"fileName\": \"manifest_widevine_cenc.m3u8\",\u00a0 \u00a0 \"type\": \"HLS\",\u00a0 \u00a0 \"muxStreams\": [\"fmp4_widevine_cenc_video\", \"fmp4_widevine_cenc_audio\"],\u00a0 \u00a0 \"maxSegmentCount\": 10\u00a0 },\u00a0 {\u00a0 \u00a0 \"fileName\": \"manifest_widevine_cbcs.m3u8\",\u00a0 \u00a0 \"type\": \"HLS\",\u00a0 \u00a0 \"muxStreams\": [\"fmp4_widevine_cbcs_video\", \"fmp4_widevine_cbcs_audio\"],\u00a0 \u00a0 \"maxSegmentCount\": 10\u00a0 },\u00a0 {\u00a0 \u00a0 \"fileName\": \"manifest_widevine_cenc.mpd\",\u00a0 \u00a0 \"type\": \"DASH\",\u00a0 \u00a0 \"muxStreams\": [\"fmp4_widevine_cenc_video\", \"fmp4_widevine_cenc_audio\"],\u00a0 \u00a0 \"maxSegmentCount\": 10\u00a0 },\u00a0 {\u00a0 \u00a0 \"fileName\": \"manifest_widevine_cbcs.mpd\",\u00a0 \u00a0 \"type\": \"DASH\",\u00a0 \u00a0 \"muxStreams\": [\"fmp4_widevine_cbcs_video\", \"fmp4_widevine_cbcs_audio\"],\u00a0 \u00a0 \"maxSegmentCount\": 10\u00a0 },\u00a0 {\u00a0 \u00a0 \"fileName\": \"manifest_playready_cenc.m3u8\",\u00a0 \u00a0 \"type\": \"HLS\",\u00a0 \u00a0 \"muxStreams\": [\"fmp4_playready_cenc_video\", \"fmp4_playready_cenc_audio\"],\u00a0 \u00a0 \"maxSegmentCount\": 10\u00a0 },\u00a0 {\u00a0 \u00a0 \"fileName\": \"manifest_playready_cbcs.m3u8\",\u00a0 \u00a0 \"type\": \"HLS\",\u00a0 \u00a0 \"muxStreams\": [\"fmp4_playready_cbcs_video\", \"fmp4_playready_cbcs_audio\"],\u00a0 \u00a0 \"maxSegmentCount\": 10\u00a0 },\u00a0 {\u00a0 \u00a0 \"fileName\": \"manifest_playready_cenc.mpd\",\u00a0 \u00a0 \"type\": \"DASH\",\u00a0 \u00a0 \"muxStreams\": [\"fmp4_playready_cenc_video\", \"fmp4_playready_cenc_audio\"],\u00a0 \u00a0 \"maxSegmentCount\": 10\u00a0 },\u00a0 {\u00a0 \u00a0 \"fileName\": \"manifest_playready_cbcs.mpd\",\u00a0 \u00a0 \"type\": \"DASH\",\u00a0 \u00a0 \"muxStreams\": [\"fmp4_playready_cbcs_video\", \"fmp4_playready_cbcs_audio\"],\u00a0 \u00a0 \"maxSegmentCount\": 10\u00a0 }]\n```\nOnce you know the JSON configuration you want to use, [create a channel](/livestream/docs/how-to/create-channels#create_channel) as normal.\n## Start streaming\nOnce the channel is created, [start the channel](/livestream/docs/how-to/create-channels#start_channel) and [send the input stream](/livestream/docs/quickstarts/quickstart-dash#send_input_stream) .\nWhen the channel starts, the Live Stream API fetches the encryption key identified by `secretVersion` from Secret Manager. If the Live Stream API is not able to fetch the key or the key is in an unrecognizable format, the channel state becomes `STREAMING_ERROR` . If the key is fetched successfully, the channel's state becomes `AWAITING_INPUT` as usual.\nOnce streaming begins, the Live Stream API begins encrypting output content according to the configuration provided at creation time.\n## Monitor the output\nEncrypted output streams contain modified manifests with the information needed to decrypt the content for playback.\n### Manifest examples\nThe following manifests show the information needed to decrypt the associated content.\n```\n#EXTM3U#EXT-X-VERSION:7#EXT-X-TARGETDURATION:4#EXT-X-MEDIA-SEQUENCE:0#EXT-X-DISCONTINUITY-SEQUENCE:0#EXT-X-KEY:METHOD=AES-128,URI=\"https://example.com/keys/3d9dccb479c64adbb6e514790caa7822.bin\",IV=0x8d80aa741e7b32c2f1967daca83e81f3#EXT-X-PROGRAM-DATE-TIME:2022-10-12T20:08:22.870Z#EXTINF:2.576778segment-0000000000.ts#EXT-X-PROGRAM-DATE-TIME:2022-10-12T20:08:25.447Z#EXTINF:2.000000segment-0000000001.ts#EXT-X-PROGRAM-DATE-TIME:2022-10-12T20:08:27.447Z#EXTINF:2.000000segment-0000000002.ts#EXT-X-PROGRAM-DATE-TIME:2022-10-12T20:08:29.447Z#EXTINF:2.000000segment-0000000003.ts\n```\n```\n#EXTM3U#EXT-X-VERSION:7#EXT-X-TARGETDURATION:4#EXT-X-MEDIA-SEQUENCE:0#EXT-X-DISCONTINUITY-SEQUENCE:0#EXT-X-KEY:METHOD=SAMPLE-AES,URI=\"skd://d569cb35bd0548c7a99d92feb381df13\",KEYFORMAT=\"com.apple.streamingkeydelivery\",KEYFORMATVERSIONS=\"1\"#EXT-X-PROGRAM-DATE-TIME:2022-10-12T20:08:22.870Z#EXTINF:2.576778segment-0000000000.ts#EXT-X-PROGRAM-DATE-TIME:2022-10-12T20:08:25.447Z#EXTINF:2.000000segment-0000000001.ts#EXT-X-PROGRAM-DATE-TIME:2022-10-12T20:08:27.447Z#EXTINF:2.000000segment-0000000002.ts#EXT-X-PROGRAM-DATE-TIME:2022-10-12T20:08:29.447Z#EXTINF:2.000000segment-0000000003.ts\n```\n```\n#EXTM3U#EXT-X-VERSION:7#EXT-X-TARGETDURATION:4#EXT-X-MEDIA-SEQUENCE:0#EXT-X-DISCONTINUITY-SEQUENCE:0#EXT-X-KEY:METHOD=SAMPLE-AES-CTR,URI=\"data:text/plain;base64,AAAAOHBzc2gAAAAA7e+LqXnWSs6jyCfSEAB3Gcrj/8kFtioyiVbJMh9I49yVmwY=\",KEYFORMAT=\"urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed\",KEYFORMATVERSIONS=\"1\"#EXT-X-MAP:URI=\"segment-initialization_segment_0000000000.m4s\"#EXT-X-PROGRAM-DATE-TIME:2022-10-12T20:08:22.870Z#EXTINF:2.576778segment-0000000000.m4s#EXT-X-PROGRAM-DATE-TIME:2022-10-12T20:08:25.447Z#EXTINF:2.000000segment-0000000001.m4s#EXT-X-PROGRAM-DATE-TIME:2022-10-12T20:08:27.447Z#EXTINF:2.000000segment-0000000002.m4s#EXT-X-PROGRAM-DATE-TIME:2022-10-12T20:08:29.447Z#EXTINF:2.000000segment-0000000003.m4s\n```\n```\n<AdaptationSet segmentAlignment=\"true\" maxWidth=\"800\" maxHeight=\"600\">\u00a0 <Representation mimeType=\"video/mp4\" id=\"fmp4_widevine_cenc_video\" codecs=\"avc1.4d001f\">\u00a0 \u00a0 <ContentProtection value=\"cenc\" schemeIdUri=\"urn:mpeg:dash:mp4protection:2011\" cenc:default_KID=\"44ec248b-048c-43a6-a6ee-58a752c6f9f8\"/>\u00a0 \u00a0 <ContentProtection schemeIdUri=\"urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed\" value=\"Widevine\">\u00a0 \u00a0 \u00a0 <cenc:pssh>AAAAOHBzc2gAAAAA7e+LqXnWSs6jCfc1R0h7QAAABgSEAB3Gcrj/8kFklokiVbJMh9VmwY=</cenc:pssh>\u00a0 \u00a0 </ContentProtection>\u00a0 </Representation></AdaptationSet><AdaptationSet segmentAlignment=\"true\" mimeType=\"audio/mp4\" id=\"1\" label=\"fmp4_widevine_cenc_audio\">\u00a0 <Representation id=\"fmp4_widevine_cenc_audio\" codecs=\"mp4a.40.2\">\u00a0 \u00a0 <ContentProtection value=\"cenc\" schemeIdUri=\"urn:mpeg:dash:mp4protection:2011\" cenc:default_KID=\"44ec248b-048c-43a6-a6ee-58a752c6f9f8\"/>\u00a0 \u00a0 <ContentProtection schemeIdUri=\"urn:uuid:edef8ba9-79d6-4ace-a3c8-27dcd51d21ed\" value=\"Widevine\">\u00a0 \u00a0 \u00a0 <cenc:pssh>AAAAOHBzc2gAAAAA7e+LqXnWSs6jCfc1R0h7QAAABgSEAB3Gcrj/8kFklokiVbJMh9VmwY=</cenc:pssh>\u00a0 \u00a0 </ContentProtection>\u00a0 </Representation></AdaptationSet>\n```\n### Recommended players\nPlayers based on [HLS.js](https://github.com/video-dev/hls.js) are recommended for HLS/TS decryption. Players based on [Shaka Player](https://github.com/shaka-project/shaka-player) are recommended for DASH/fMP4 decryption.\nThe PlayReady 'cenc' scheme is supported on physical machines running Windows 10 with the Microsoft Edge browser, Xbox One (version 1703 or lower), and some non-Windows devices (for example, smart TVs). The PlayReady 'cbcs' scheme is only supported on Xbox One version 1709 or higher. See [PlayReady Content Encryption Modes](https://learn.microsoft.com/en-us/playready/packaging/content-encryption-modes) for more information.\n## Update the encryption key\nTo switch a channel to a new encryption key, do the following:\n- [Stop the channel](/livestream/docs/how-to/create-channels#stop_channel) .\n- [Update the encryption settings](#configure-channel) on the channel.\n- [Start the channel](/livestream/docs/how-to/create-channels#start_channel) .", "guide": "Live Stream API"}