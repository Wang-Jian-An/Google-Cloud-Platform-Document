{"title": "Dataflow - Use Pub/Sub Seek with Dataflow", "url": "https://cloud.google.com/dataflow/docs/guides/using-cloud-pubsub-seek", "abstract": "# Dataflow - Use Pub/Sub Seek with Dataflow\n[Pub/Sub Seek](/pubsub/docs/replay-overview) lets users replay and reprocess previously acknowledged messages or to acknowledge messages in bulk. However, we do not recommend direct access to Pub/Sub Seek from within a running Dataflow pipeline. Direct access invalidates Dataflow's watermark logic and does not work well with exactly-once processing. In addition, direct access conflicts with the state of a pipeline that incorporates processed data.\nWe recommend using Pub/Sub Seek with the following workflow:\n- Make a snapshot of the subscription.\n- Drain the subscription messages in Dataflow.\n- Resubmit the pipeline.", "content": "## Creating a snapshot\nYou seek to and redo processing from a subscription snapshot. To create this snapshot using the `gcloud` [command-line tool](/sdk/gcloud) , run the following commands:\n```\nalias pubsub='gcloud pubsub'pubsub snapshots create my-snapshot --subscription=seek-demo-sub\n```\nTo verify that you have created the snapshot, run the command:\n```\npubsub snapshots list\n```\n## Draining the subscription\nTo drain the subscription and resubmit the pipeline, follow these steps:\n- Navigate to the [Dataflow console](https://console.cloud.google.com/dataflow) and click your streaming pipeline.\n- In the **Summary** pane, click **Stop Job** .\n- Select **Drain** to allow for processing of the in-flight messages and wait until the job is terminated.\n- Seek your subscription to the snapshot with the`gcloud` [command-line tool](/sdk/gcloud) :```\npubsub subscriptions seek seek-demo-sub --snapshot=my-snapshot\n```\n- Resubmit your Dataflow pipeline.", "guide": "Dataflow"}