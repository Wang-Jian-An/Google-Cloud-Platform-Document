{"title": "Dataflow - \u6307\u5b9a\u7db2\u7d61\u548c\u5b50\u7db2", "url": "https://cloud.google.com/dataflow/docs/guides/specifying-networks?hl=zh-cn", "abstract": "# Dataflow - \u6307\u5b9a\u7db2\u7d61\u548c\u5b50\u7db2\n\u672c\u6587\u6a94\u4ecb\u7d39\u5982\u4f55\u5728\u904b\u884c Dataflow \u4f5c\u696d\u6642\u6307\u5b9a\u7db2\u7d61\u548c/\u6216\u5b50\u7db2\u9078\u9805\u3002\n\u672c\u6587\u6a94\u8981\u6c42\u60a8\u77ad\u89e3\u5982\u4f55\u5275\u5efa Google Cloud \u7db2\u7d61\u548c\u5b50\u7db2\u3002\u672c\u6587\u6a94\u9084\u8981\u6c42\u60a8\u719f\u6089\u4e0b\u4e00\u90e8\u5206\u4e2d\u4ecb\u7d39\u7684\u7db2\u7d61\u8853\u8a9e\u3002\n`default` \u7db2\u7d61\u914d\u7f6e\u7232\u5141\u8a31\u904b\u884c Dataflow \u4f5c\u696d\uff0c\u4f46\u5176\u4ed6\u670d\u52d9\u4e5f\u53ef\u80fd\u6703\u4f7f\u7528\u6b64\u7db2\u7d61\u3002\u8acb\u78ba\u4fdd\u5c0d `default` \u7db2\u7d61\u7684\u66f4\u6539\u8207\u6240\u6709\u670d\u52d9\u517c\u5bb9\u3002\u6216\u8005\uff0c\u60a8\u4e5f\u53ef\u4ee5\u7232 Dataflow \u5275\u5efa\u55ae\u7368\u7684\u7db2\u7d61\u3002\n\u5982\u9700\u8a73\u7d30\u77ad\u89e3\u5982\u4f55\u6392\u67e5\u7db2\u7d61\u554f\u984c\uff0c\u8acb\u53c3\u95b1 [\u6392\u67e5 Dataflow \u7db2\u7d61\u554f\u984c](https://cloud.google.com/dataflow/docs/guides/troubleshoot-networking?hl=zh-cn) \u3002\n", "content": "## Google Cloud \u7db2\u7d61\u8853\u8a9e\n- **VPC \u7db2\u7d61** \u3002VPC \u7db2\u7d61 \uff08\u6709\u6642\u7a31\u7232\u201c\u7db2\u7d61\u201d\uff09\u53ef\u7232\u9805\u76ee\u4e2d\u7684\u8cc7\u6e90\u63d0\u4f9b\u9023\u63a5\u3002\u5982\u9700\u8a73\u7d30\u77ad\u89e3 VPC\uff0c\u8acb\u53c3\u95b1 [VPC \u7db2\u7d61\u6982\u89bd](https://cloud.google.com/vpc/docs/vpc?hl=zh-cn) \u3002\n- **\u5171\u4eab VPC \u7db2\u7d61** \u3002\u5171\u4eab VPC \u7db2\u7d61 \u5b58\u5728\u65bc\u7d44\u7e54\u5167\u7684\u55ae\u7368\u9805\u76ee\uff08\u7a31\u7232\u201c\u5bbf\u4e3b\u9805\u76ee\u201d\uff09\u4e2d\u3002\u5982\u679c [Shared VPC Admin](https://cloud.google.com/vpc/docs/shared-vpc?hl=zh-cn#iam_roles_required_for_shared_vpc) \u5df2\u5c07\u60a8\u5b9a\u7fa9\u7232 [Service Project Admin](https://cloud.google.com/vpc/docs/shared-vpc?hl=zh-cn#svc_proj_admins) \uff0c\u5247\u60a8\u6709\u6b0a\u5728\u5bbf\u4e3b\u9805\u76ee\u7684\u7db2\u7d61\u4e2d\u81f3\u5c11\u4f7f\u7528\u90e8\u5206\u5b50\u7db2\u3002\u5982\u9700\u8a73\u7d30\u77ad\u89e3\u5171\u4eab VPC\uff0c\u8acb\u53c3\u95b1 [\u5171\u4eab VPC \u6982\u89bd](https://cloud.google.com/vpc/docs/shared-vpc?hl=zh-cn) \u3002\n- **VPC Service Controls\u3002** Dataflow VPC Service Controls \u6709\u52a9\u65bc\u4fdd\u8b77\u6d41\u6c34\u7dda\u7684\u8cc7\u6e90\u548c\u670d\u52d9\u3002\u5982\u9700\u8a73\u7d30\u77ad\u89e3 VPC Service Controls\uff0c\u8acb\u53c3\u95b1 [VPC Service Controls \u6982\u89bd](https://cloud.google.com/vpc-service-controls/docs/overview?hl=zh-cn) \u3002\u5982\u9700\u77ad\u89e3\u5c07 Dataflow \u8207 VPC Service Controls \u7d50\u5408\u4f7f\u7528\u7684\u9650\u5236\uff0c\u8acb\u53c3\u95b1 [\u652f\u6301\u7684\u7522\u54c1\u548c\u9650\u5236](https://cloud.google.com/vpc-service-controls/docs/supported-products?hl=zh-cn) \u3002## Dataflow \u4f5c\u696d\u7684\u7db2\u7d61\u548c\u5b50\u7db2\n\u5275\u5efa Dataflow \u4f5c\u696d\u6642\uff0c\u60a8\u53ef\u4ee5\u6307\u5b9a\u7db2\u7d61\u548c/\u6216\u5b50\u7db2\u9078\u9805\u3002\n\u8acb\u8003\u616e\u4ee5\u4e0b\u6e96\u5247\uff1a\n- \u5982\u679c\u60a8\u4e0d\u78ba\u5b9a\u8981\u4f7f\u7528\u54ea\u500b\u53c3\u6578\uff0c\u8acb\u50c5\u6307\u5b9a\u5b50\u7db2\u53c3\u6578\u3002\u7136\u5f8c\uff0c\u7cfb\u7d71\u6703\u96b1\u5f0f\u7232\u60a8\u6307\u5b9a\u7db2\u7d61\u53c3\u6578\u3002\n- \u5982\u679c\u540c\u6642\u7701\u7565\u5b50\u7db2\u548c\u7db2\u7d61\u53c3\u6578\uff0cGoogle Cloud \u6703\u5047\u5b9a\u60a8\u6253\u7b97\u4f7f\u7528\u540d\u7232 `default` \u7684 [\u81ea\u52d5\u6a21\u5f0f VPC \u7db2\u7d61](https://cloud.google.com/vpc/docs/vpc?hl=zh-cn#subnet-ranges) \u3002 \u5982\u679c\u60a8\u7684\u9805\u76ee\u4e2d\u6c92\u6709\u540d\u7232 `default` \u7684\u7db2\u7d61\uff0c\u5247\u5fc5\u9808\u6307\u5b9a\u5099\u7528\u7db2\u7d61\u6216\u5b50\u7db2\u3002\n### \u6307\u5b9a\u7db2\u7d61\u53c3\u6578\u7684\u6e96\u5247\n- \u60a8\u53ef\u4ee5\u4f7f\u7528\u7db2\u7d61\u53c3\u6578\u5728\u9805\u76ee\u4e2d\u9078\u64c7 [\u81ea\u52d5\u6a21\u5f0f VPC \u7db2\u7d61](https://cloud.google.com/vpc/docs/create-modify-vpc-networks?hl=zh-cn#create-auto-network) \u3002\n- \u60a8\u53ea\u80fd\u4f7f\u7528\u7db2\u7d61\u540d\u7a31\u4f86\u6307\u5b9a\u7db2\u7d61\uff0c\u800c\u4e0d\u80fd\u901a\u904e\u5b8c\u6574\u7684\u7db2\u5740\u4f86\u6307\u5b9a\u7db2\u7d61\u3002\n- \u5982\u679c\u540c\u6642\u6eff\u8db3\u4ee5\u4e0b\u5169\u500b\u689d\u4ef6\uff0c\u60a8\u53ea\u80fd\u4f7f\u7528\u7db2\u7d61\u53c3\u6578\u9078\u64c7\u5171\u4eab VPC \u7db2\u7d61\uff1a- \u60a8\u9078\u64c7\u7684\u5171\u4eab VPC \u7db2\u7d61\u662f\u81ea\u52d5\u6a21\u5f0f VPC \u7db2\u7d61\u3002\n- \u60a8\u662f Service Project Admin\uff0c\u5c0d\u6574\u500b\u5171\u4eab VPC \u5bbf\u4e3b\u9805\u76ee\u5177\u6709 [\u9805\u76ee\u7d1a\u6b0a\u9650](https://cloud.google.com/vpc/docs/shared-vpc?hl=zh-cn#svc_proj_admins) \u3002\u5171\u4eab VPC \u7ba1\u7406\u54e1\u5df2\u6388\u4e88\u60a8\u6574\u500b\u5bbf\u4e3b\u9805\u76ee\u7684 [Compute Network User \u89d2\u8272](https://cloud.google.com/compute/docs/access/iam?hl=zh-cn#compute.networkUser) \uff0c\u56e0\u6b64\u60a8\u53ef\u4ee5\u4f7f\u7528\u5176\u6240\u6709\u7db2\u7d61\u548c\u5b50\u7db2\u3002\n- \u5c0d\u65bc\u6240\u6709\u5176\u4ed6\u60c5\u6cc1\uff0c\u60a8\u5fc5\u9808\u6307\u5b9a\u5b50\u7db2\u3002\n### \u6307\u5b9a\u5b50\u7db2\u53c3\u6578\u7684\u6e96\u5247\n- \u5982\u679c\u6307\u5b9a\u5b50\u7db2\uff0c\u5247 Dataflow \u6703\u7232\u60a8\u9078\u64c7\u7db2\u7d61\u3002\u56e0\u6b64\uff0c\u5728\u6307\u5b9a\u5b50\u7db2\u6642\u53ef\u4ee5\u7701\u7565\u7db2\u7d61\u53c3\u6578\u3002\n- \u5982\u9700\u5728\u7db2\u7d61\u4e2d\u9078\u64c7\u7279\u5b9a\u5b50\u7db2\uff0c\u8acb\u4f7f\u7528\u5b50\u7db2\u53c3\u6578\u3002\n- \u4f7f\u7528\u5b8c\u6574\u7db2\u5740\u6216\u7e2e\u5beb\u8def\u5f91\u6307\u5b9a\u5b50\u7db2\u3002 \u5982\u679c\u5b50\u7db2\u4f4d\u65bc\u5171\u4eab VPC \u7db2\u7d61\u4e2d\uff0c\u5247\u5fc5\u9808\u4f7f\u7528\u5b8c\u6574\u7684\u7db2\u5740\u3002\n- \u60a8\u5fc5\u9808\u9078\u64c7\u8207\u904b\u884c Dataflow \u5de5\u4f5c\u5668\u7684\u53ef\u7528\u5340\u4f4d\u65bc\u540c\u4e00\u5340\u57df\u7684\u5b50\u7db2\u3002\u4f8b\u5982\u5728\u4ee5\u4e0b\u60c5\u6cc1\u4e0b\uff0c\u60a8\u5fc5\u9808\u6307\u5b9a\u5b50\u7db2\u53c3\u6578\uff1a- \u60a8\u6307\u5b9a\u7684\u5b50\u7db2\u4f4d\u65bc\u81ea\u5b9a\u7fa9\u6a21\u5f0f VPC \u7db2\u7d61\u4e2d\u3002\n- \u60a8\u662f\u670d\u52d9\u9805\u76ee\u7ba1\u7406\u54e1\uff0c\u5177\u6709\u5c0d\u5171\u4eab VPC \u5bbf\u4e3b\u9805\u76ee\u4e2d\u7279\u5b9a\u5b50\u7db2\u7684 [\u5b50\u7db2\u7d1a\u6b0a\u9650](https://cloud.google.com/vpc/docs/shared-vpc?hl=zh-cn#svc_proj_admins) \u3002\n- \u5b50\u7db2\u5927\u5c0f\u50c5\u6839\u64da\u53ef\u7528 IP \u5730\u5740\u6578\u91cf\u9650\u5236\u5be6\u4f8b\u6578\u3002\u6b64\u5927\u5c0f\u4e0d\u6703\u5f71\u97ff Dataflow VPC Service Controls \u7684\u6027\u80fd\u3002\n### \u7232\u5171\u4eab VPC \u6307\u5b9a\u5b50\u7db2\u53c3\u6578\u7684\u6e96\u5247\n- \u7232\u5171\u4eab VPC \u6307\u5b9a\u5b50\u7db2\u7db2\u5740\u6642\uff0c\u8acb\u78ba\u4fdd \u662f\u5728\u5176\u4e2d\u8a17\u7ba1 VPC \u7684\u9805\u76ee\u3002\n- \u5982\u679c\u5b50\u7db2\u4f4d\u65bc\u5171\u4eab VPC \u7db2\u7d61\u4e2d\uff0c\u5247\u5fc5\u9808\u4f7f\u7528\u5b8c\u6574\u7684\u7db2\u5740\u3002\n- \u78ba\u4fdd\u5171\u4eab VPC \u5b50\u7db2\u8207 [Dataflow \u670d\u52d9\u8cec\u865f](https://cloud.google.com/dataflow/docs/concepts/security-and-permissions?hl=zh-cn#df-service-account) \u5171\u4eab\uff0c\u4e26\u4e14\u5728\u6307\u5b9a\u5b50\u7db2\u4e0a\u5206\u914d\u4e86 [Compute Network User \u89d2\u8272](https://cloud.google.com/compute/docs/access/iam?hl=zh-cn#compute.networkUser) \u3002\u5fc5\u9808\u5411\u5bbf\u4e3b\u9805\u76ee\u4e2d\u7684 Dataflow \u670d\u52d9\u8cec\u865f\u5206\u914d Compute Network User \u89d2\u8272\u3002- \u5728 Google Cloud \u63a7\u5236\u6aaf\u4e2d\uff0c\u8f49\u5230 **\u5171\u4eab VPC** \u9801\u9762\u4e26\u641c\u7d22\u5b50\u7db2\u3002\u5728 **\u5171\u4eab\u5c0d\u8c61** \u5217\u4e2d\uff0c\u60a8\u53ef\u4ee5\u67e5\u770b VPC \u5b50\u7db2\u662f\u5426\u8207 Dataflow \u670d\u52d9\u8cec\u865f\u5171\u4eab\u3002\n- \u5982\u679c\u7db2\u7d61\u672a\u5171\u4eab\uff0c\u5247\u7cfb\u7d71\u6703\u986f\u793a\u4ee5\u4e0b\u932f\u8aa4\u6d88\u606f\uff1a [Error: Message: Required 'compute.subnetworks.get' permission](https://cloud.google.com/dataflow/docs/guides/troubleshoot-permissions?hl=zh-cn#shared-VPC) \u3002\n## \u7db2\u7d61\u548c\u5b50\u7db2\u898f\u7bc4\u793a\u4f8b\n\u6307\u5b9a\u5b50\u7db2\u7684\u5b8c\u6574\u7db2\u5740\u793a\u4f8b\uff1a\n```\nhttps://www.googleapis.com/compute/v1/projects/HOST_PROJECT_ID/regions/REGION_NAME/subnetworks/SUBNETWORK_NAME\n```\n\u66ff\u63db\u4ee5\u4e0b\u5167\u5bb9\uff1a\n- ``\uff1a\u5bbf\u4e3b\u9805\u76ee ID\n- ``\uff1a\u60a8\u7684 Dataflow \u4f5c\u696d\u7684 [\u5340\u57df](https://cloud.google.com/dataflow/docs/resources/locations?hl=zh-cn) \n- ``\uff1a\u60a8\u7684 Compute Engine \u5b50\u7db2\u7684\u540d\u7a31\n\u4ee5\u4e0b\u662f\u4e00\u500b\u793a\u4f8b\u7db2\u5740\uff0c\u5176\u4e2d\u5bbf\u4e3b\u9805\u76ee ID \u7232 `my-cloud-project` \uff0c\u5340\u57df\u7232 `us-central1` \uff0c\u5b50\u7db2\u540d\u7a31\u7232 `mysubnetwork` \uff1a\n```\n https://www.googleapis.com/compute/v1/projects/my-cloud-project/regions/us-central1/subnetworks/mysubnetwork\n```\n\u4ee5\u4e0b\u662f\u6307\u5b9a\u5b50\u7db2\u7684\u7c21\u5beb\u5f62\u5f0f\u793a\u4f8b\uff1a\n```\nregions/REGION_NAME/subnetworks/SUBNETWORK_NAME\n```\n\u66ff\u63db\u4ee5\u4e0b\u5167\u5bb9\uff1a\n- ``\uff1a\u60a8\u7684 Dataflow \u4f5c\u696d\u7684 [\u5340\u57df](https://cloud.google.com/dataflow/docs/resources/locations?hl=zh-cn) \n- ``\uff1a\u60a8\u7684 Compute Engine \u5b50\u7db2\u7684\u540d\u7a31## \u4f7f\u7528\u6307\u5b9a\u7684\u7db2\u7d61\u904b\u884c\u6d41\u6c34\u7dda\n\u5982\u679c\u60a8\u8981\u4f7f\u7528 Google Cloud \u5275\u5efa\u7684\u9ed8\u8a8d\u7db2\u7d61\u4ee5\u5916\u7684\u7db2\u7d61\uff0c\u5247\u5728\u5927\u591a\u6578\u60c5\u6cc1\u4e0b\uff0c\u60a8\u9700\u8981 [\u6307\u5b9a\u5b50\u7db2](#specify-subnet) \u3002\u7cfb\u7d71\u6703\u6839\u64da\u60a8\u6307\u5b9a\u7684\u5b50\u7db2\u81ea\u52d5\u63a8\u65b7\u7db2\u7d61\u3002\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1\u672c\u6587\u6a94\u4e2d\u7684 [\u6307\u5b9a\u7db2\u7d61\u53c3\u6578\u7684\u6307\u5357](#network_parameter) \u3002\n\u4ee5\u4e0b\u793a\u4f8b\u5c55\u793a\u77ad\u5982\u4f55\u5f9e\u547d\u4ee4\u884c\u6216\u4f7f\u7528 REST API \u904b\u884c\u6d41\u6c34\u7dda\u3002\u8a72\u793a\u4f8b\u6307\u5b9a\u4e86\u4e00\u500b\u7db2\u7d61\u3002\n```\nmvn compile exec:java \\\u00a0 \u00a0 -Dexec.mainClass=INPUT_PATH \\\u00a0 \u00a0 -Dexec.args=\"--project=HOST_PROJECT_ID \\\u00a0 \u00a0 \u00a0 \u00a0 --stagingLocation=gs://STORAGE_BUCKET/staging/ \\\u00a0 \u00a0 \u00a0 \u00a0 --output=gs://STORAGE_BUCKET/output \\\u00a0 \u00a0 \u00a0 \u00a0 --region=REGION \\\u00a0 \u00a0 \u00a0 \u00a0 --runner=DataflowRunner \\\u00a0 \u00a0 \u00a0 \u00a0 --network=NETWORK_NAME\"\n```\n```\npython -m INPUT_PATH \\\u00a0 \u00a0 --project HOST_PROJECT_ID \\\u00a0 \u00a0 --region=REGION \\\u00a0 \u00a0 --runner DataflowRunner \\\u00a0 \u00a0 --staging_location gs://STORAGE_BUCKET/staging \\\u00a0 \u00a0 --temp_location gs://STORAGE_BUCKET/temp \\\u00a0 \u00a0 --output gs://STORAGE_BUCKET/output \\\u00a0 \u00a0 --network NETWORK_NAME\n```\n```\nwordcount\u00a0 \u00a0 --project HOST_PROJECT_ID \\\u00a0 \u00a0 --region HOST_GCP_REGION \\\u00a0 \u00a0 --runner dataflow \\\u00a0 \u00a0 --staging_location gs://STORAGE_BUCKET/staging \\\u00a0 \u00a0 --temp_location gs://STORAGE_BUCKET/temp \\\u00a0 \u00a0 --input INPUT_PATH \\\u00a0 \u00a0 --output gs://STORAGE_BUCKET/output \\\u00a0 \u00a0 --network NETWORK_NAME\n```\n\u5982\u679c\u60a8\u4f7f\u7528 [REST API](https://cloud.google.com/dataflow/docs/reference/rest/v1b3/projects.templates/launch?hl=zh-cn)  [\u904b\u884c Dataflow \u6a21\u677f](https://cloud.google.com/dataflow/docs/templates/executing-templates?hl=zh-cn#using-the-rest-api) \uff0c\u8acb\u5c07 `network` \u548c/\u6216 `subnetwork` \u6dfb\u52a0\u5230 `environment` \u5c0d\u8c61\u3002\n```\nPOST https://dataflow.googleapis.com/v1b3/projects/[YOUR_PROJECT_ID]/templates:launch?gcsPath=gs://dataflow-templates/wordcount/template_file{\u00a0 \u00a0 \"jobName\": \"JOB_NAME\",\u00a0 \u00a0 \"parameters\": {\u00a0 \u00a0 \u00a0 \u00a0\"inputFile\" : \"INPUT_PATH\",\u00a0 \u00a0 \u00a0 \u00a0\"output\": \"gs://STORAGE_BUCKET/output\"\u00a0 \u00a0 },\u00a0 \u00a0 \"environment\": {\u00a0 \u00a0 \u00a0 \u00a0\"tempLocation\": \"gs://STORAGE_BUCKET/temp\",\u00a0 \u00a0 \u00a0 \u00a0\"network\": \"NETWORK_NAME\",\u00a0 \u00a0 \u00a0 \u00a0\"zone\": \"us-central1-f\"\u00a0 \u00a0 }}\n```\n\u8acb\u66ff\u63db\u4ee5\u4e0b\u5167\u5bb9\uff1a\n- ``\uff1a\u60a8\u7684 Dataflow \u4f5c\u696d\u7684\u540d\u7a31\uff08\u50c5\u9650 API\uff09\n- ``\uff1a\u4f86\u6e90\u7684\u8def\u5f91\n- ``\uff1a\u5bbf\u4e3b\u9805\u76ee ID\n- ``\uff1a [Dataflow \u5340\u57df](https://cloud.google.com/dataflow/docs/resources/locations?hl=zh-cn) \uff0c\u4f8b\u5982`us-central1`\n- ``\uff1a\u5b58\u5132\u6876\n- ``\uff1a\u60a8\u7684 Compute Engine \u7db2\u7d61\u7684\u540d\u7a31## \u4f7f\u7528\u6307\u5b9a\u7684\u5b50\u7db2\u904b\u884c\u6d41\u6c34\u7dda\n\u5982\u679c\u60a8\u662f\u670d\u52d9\u9805\u76ee\u7ba1\u7406\u54e1\u4e26\u4e14\u50c5\u6709\u6b0a\u4f7f\u7528\u5171\u4eab VPC \u7db2\u7d61\u4e2d\u7684\u7279\u5b9a\u5b50\u7db2\uff0c\u5247 **\u5fc5\u9808** \u4f7f\u7528\u60a8\u6709\u6b0a\u4f7f\u7528\u7684\u5b50\u7db2\u6307\u5b9a `subnetwork` \u53c3\u6578\u3002\n\u4ee5\u4e0b\u793a\u4f8b\u5c55\u793a\u77ad\u5982\u4f55\u5f9e\u547d\u4ee4\u884c\u6216\u4f7f\u7528 REST API \u904b\u884c\u6d41\u6c34\u7dda\u3002\u8a72\u793a\u4f8b\u6307\u5b9a\u4e86\u5b50\u7db2\u3002\u60a8\u9084\u53ef\u4ee5\u6307\u5b9a\u7db2\u7d61\u3002\n```\nmvn compile exec:java \\\u00a0 \u00a0 -Dexec.mainClass=INPUT_PATH \\\u00a0 \u00a0 -Dexec.args=\"--project=HOST_PROJECT_ID \\\u00a0 \u00a0 \u00a0 \u00a0 --stagingLocation=gs://STORAGE_BUCKET/staging/ \\\u00a0 \u00a0 \u00a0 \u00a0 --output=gs://STORAGE_BUCKET/output \\\u00a0 \u00a0 \u00a0 \u00a0 --region=REGION \\\u00a0 \u00a0 \u00a0 \u00a0 --runner=DataflowRunner \\\u00a0 \u00a0 \u00a0 \u00a0 --subnetwork=https://www.googleapis.com/compute/v1/projects/HOST_PROJECT_ID/regions/REGION/subnetworks/SUBNETWORK_NAME\"\n```\n```\npython -m INPUT_PATH \\\u00a0 \u00a0 --project HOST_PROJECT_ID \\\u00a0 \u00a0 --region=REGION \\\u00a0 \u00a0 --runner DataflowRunner \\\u00a0 \u00a0 --staging_location gs://STORAGE_BUCKET/staging \\\u00a0 \u00a0 --temp_location gs://STORAGE_BUCKET/temp \\\u00a0 \u00a0 --output gs://STORAGE_BUCKET/output \\\u00a0 \u00a0 --subnetwork https://www.googleapis.com/compute/v1/projects/HOST_PROJECT_ID/regions/REGION/subnetworks/SUBNETWORK_NAME\n```\n```\nwordcount\u00a0 \u00a0 --project HOST_PROJECT_ID \\\u00a0 \u00a0 --region HOST_GCP_REGION \\\u00a0 \u00a0 --runner dataflow \\\u00a0 \u00a0 --staging_location gs://STORAGE_BUCKET/staging \\\u00a0 \u00a0 --temp_location gs://STORAGE_BUCKET/temp \\\u00a0 \u00a0 --input INPUT_PATH \\\u00a0 \u00a0 --output gs://STORAGE_BUCKET/output \\\u00a0 \u00a0 --subnetwork https://www.googleapis.com/compute/v1/projects/HOST_PROJECT_ID/regions/REGION/subnetworks/SUBNETWORK_NAME\n```\n\u5982\u679c\u60a8\u4f7f\u7528 [REST API](https://cloud.google.com/dataflow/docs/reference/rest/v1b3/projects.templates/launch?hl=zh-cn)  [\u904b\u884c Dataflow \u6a21\u677f](https://cloud.google.com/dataflow/docs/templates/executing-templates?hl=zh-cn#using-the-rest-api) \uff0c\u8acb\u5c07 `network` \u548c/\u6216 `subnetwork` \u6dfb\u52a0\u5230 `environment` \u5c0d\u8c61\u3002\n```\nPOST https://dataflow.googleapis.com/v1b3/projects/[YOUR_PROJECT_ID]/templates:launch?gcsPath=gs://dataflow-templates/wordcount/template_file{\u00a0 \u00a0 \"jobName\": \"JOB_NAME\",\u00a0 \u00a0 \"parameters\": {\u00a0 \u00a0 \u00a0 \u00a0\"inputFile\" : \"INPUT_PATH\",\u00a0 \u00a0 \u00a0 \u00a0\"output\": \"gs://STORAGE_BUCKET/output\"\u00a0 \u00a0 },\u00a0 \u00a0 \"environment\": {\u00a0 \u00a0 \u00a0 \u00a0\"tempLocation\": \"gs://STORAGE_BUCKET/temp\",\u00a0 \u00a0 \u00a0 \u00a0\"subnetwork\": \"https://www.googleapis.com/compute/v1/projects/HOST_PROJECT_ID/regions/REGION/subnetworks/SUBNETWORK_NAME\",\u00a0 \u00a0 \u00a0 \u00a0\"zone\": \"us-central1-f\"\u00a0 \u00a0 }}\n```\n\u66ff\u63db\u4ee5\u4e0b\u5167\u5bb9\uff1a\n- ``\uff1a\u60a8\u7684 Dataflow \u4f5c\u696d\u7684\u540d\u7a31\uff08\u50c5\u9650 API\uff09\n- ``\uff1a\u4f86\u6e90\u7684\u8def\u5f91\n- ``\uff1a\u5bbf\u4e3b\u9805\u76ee ID\n- ``\uff1a [Dataflow \u5340\u57df](https://cloud.google.com/dataflow/docs/resources/locations?hl=zh-cn) \uff0c\u4f8b\u5982`us-central1`\n- ``\uff1a\u5b58\u5132\u6876\n- ``\uff1a\u60a8\u7684 Compute Engine \u5b50\u7db2\u7684\u540d\u7a31## \u95dc\u9589\u5916\u90e8 IP \u5730\u5740\n\u5982\u9700\u95dc\u9589\u5916\u90e8 IP \u5730\u5740\uff0c\u8acb\u53c3\u95b1 [\u914d\u7f6e\u4e92\u806f\u7db2\u8a2a\u554f\u6b0a\u9650\u548c\u9632\u706b\u7246\u898f\u5247](https://cloud.google.com/dataflow/docs/guides/routes-firewall?hl=zh-cn) \u3002", "guide": "Dataflow"}