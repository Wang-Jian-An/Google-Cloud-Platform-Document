{"title": "Documentation - Node and operating system (OS)", "url": "https://cloud.google.com/distributed-cloud/hosted/docs/latest/gdch/overview", "abstract": "# Documentation - Node and operating system (OS)\n| 0     | 1                                     |\n|:-------------------|:-----------------------------------------------------------------------------------------------------------------------------------------------------|\n| Workload location | Hardware                                    |\n| Audit log source | Node OS                                    |\n| Audited operations | Sign-in events Operating system teletypewriter (OS TTY) events Clam antivirus (ClamAV) events Advanced Intrusion Detection Environment (AIDE) events |\n", "content": "## Sign-in events\nAll access attempts and actions through OS SSH connections.\n| ('Fields in the log entry that contain audit information', 'Audit metadata') | ('Fields in the log entry that contain audit information', 'Audit field name') | ('Fields in the log entry that contain audit information', 'Value')   |\n|:-------------------------------------------------------------------------------|:---------------------------------------------------------------------------------|:----------------------------------------------------------------------------|\n| User or service identity              | ident                   | \"ident\": \"sshd\"                |\n| Target (Fields and values that call the API)         | message                   | For example, \"message\": \"pam_tty_audit(sshd:session): restored status to 0\" |\n| Action (Fields containing the performed operation)        | message                   | For example, \"message\": \"pam_tty_audit(sshd:session): restored status to 0\" |\n| Event timestamp                | time                    | For example, \"time\": \"2022-11-30T22:53:39.442037+00:00\"      |\n| Source of action                | host                    | For example, \"host\": \"zb-aa-bm01\"           |\n| Outcome                  | message                   | For example, \"message\": \"pam_tty_audit(sshd:session): restored status to 0\" |\n| Other fields                 | Not applicable                 | Not applicable                |\n**Example log**\n```\n{\u00a0 \"pri\": \"87\",\u00a0 \"time\": \"2022-11-30T22:53:39.442037+00:00\",\u00a0 \"host\": \"zb-aa-bm01\",\u00a0 \"ident\": \"sshd\",\u00a0 \"pid\": \"757322\",\u00a0 \"msgid\": \"-\",\u00a0 \"extradata\": \"-\",\u00a0 \"message\": \"pam_tty_audit(sshd:session): restored status to 0\",\u00a0 \"_gdch_cluster\": \"root-admin\",\u00a0 \"_gdch_fluentbit_pod\": \"anthos-audit-logs-forwarder-dn5jn\",\u00a0 \"_gdch_service_name\": \"inventory-machine-bm-e2c2a7e1\"}\n```\n## OS TTY events\nAll commands printing outputs on the console.\n| ('Fields in the log entry that contain audit information', 'Audit metadata') | ('Fields in the log entry that contain audit information', 'Audit field name') | ('Fields in the log entry that contain audit information', 'Value')                       |\n|:-------------------------------------------------------------------------------|:---------------------------------------------------------------------------------|:---------------------------------------------------------------------------------------------------------------------------------------------------------------|\n| User or service identity              | ident                   | \"ident\": \"audispd\"                                    |\n| Target (Fields and values that call the API)         | message                   | For example, \"message\": \"node=ubuntu type=TTY msg=audit(1671531815.870:94280): tty pid=1217279 uid=0 auid=0 ses=3536 major=136 minor=0 comm=\\\"pager\\\" data=71\" |\n| Action (Fields containing the performed operation)        | message                   | For example, \"message\": \"node=ubuntu type=TTY msg=audit(1671531815.870:94280): tty pid=1217279 uid=0 auid=0 ses=3536 major=136 minor=0 comm=\\\"pager\\\" data=71\" |\n| Event timestamp                | time                    | For example, \"time\": \"2022-12-20T10:23:35.878924+00:00\"                          |\n| Source of action                | host                    | For example, \"host\": \"zk-aa-bm08\"                                |\n| Outcome                  | message                   | For example, \"message\": \"node=ubuntu type=TTY msg=audit(1671531815.870:94280): tty pid=1217279 uid=0 auid=0 ses=3536 major=136 minor=0 comm=\\\"pager\\\" data=71\" |\n| Other fields                 | Not applicable                 | Not applicable                                     |\n**Example log**\n```\n{\u00a0 \"pri\": \"14\",\u00a0 \"time\": \"2022-12-20T10:23:35.878924+00:00\",\u00a0 \"host\": \"zk-aa-bm08\",\u00a0 \"ident\": \"audispd\",\u00a0 \"pid\": \"-\",\u00a0 \"msgid\": \"-\",\u00a0 \"extradata\": \"-\",\u00a0 \"message\": \"node=ubuntu type=TTY msg=audit(1671531815.870:94280): tty pid=1217279 uid=0 auid=0 ses=3536 major=136 minor=0 comm=\\\"pager\\\" data=71\",\u00a0 \"_gdch_cluster\": \"root-admin\",\u00a0 \"_gdch_fluentbit_pod\": \"anthos-audit-logs-forwarder-w6fl4\",\u00a0 \"_gdch_service_name\": \"inventory-machine-bm-7cc496d5\"}\n```\n## ClamAV events\nAll ClamAV scanning events.\n| ('Fields in the log entry that contain audit information', 'Audit metadata') | ('Fields in the log entry that contain audit information', 'Audit field name') | ('Fields in the log entry that contain audit information', 'Value') |\n|:-------------------------------------------------------------------------------|:---------------------------------------------------------------------------------|:----------------------------------------------------------------------|\n| User or service identity              | ident                   | Possible values: \"ident\": \"clamav\" \"ident\": \"clamonacc\"    |\n| Target (Fields and values that call the API)         | message                   | For example, \"message\": \"No virus found\"        |\n| Action (Fields containing the performed operation)        | message                   | For example, \"message\": \"No virus found\"        |\n| Event timestamp                | time                    | For example, \"time\": \"2022-12-20T04:01:47.219862+00:00\"    |\n| Source of action                | host                    | For example, \"host\": \"zk-aa-bm09\"          |\n| Outcome                  | message                   | For example, \"message\": \"No virus found\"        |\n| Other fields                 | Not applicable                 | Not applicable              |\n**Example log**\n```\n{\u00a0 \"pri\": \"86\",\u00a0 \"time\": \"2022-12-20T04:01:47.219862+00:00\",\u00a0 \"host\": \"zk-aa-bm09\",\u00a0 \"ident\": \"clamav\",\u00a0 \"pid\": \"-\",\u00a0 \"msgid\": \"-\",\u00a0 \"extradata\": \"-\",\u00a0 \"message\": \"No virus found\",\u00a0 \"_gdch_cluster\": \"root-admin\",\u00a0 \"_gdch_fluentbit_pod\": \"anthos-audit-logs-forwarder-lcxgq\",\u00a0 \"_gdch_service_name\": \"inventory-machine-bm-b11f4752\"}\n```\n## AIDE events\nAll AIDE intrusion detection events.\n| ('Fields in the log entry that contain audit information', 'Audit metadata') | ('Fields in the log entry that contain audit information', 'Audit field name') | ('Fields in the log entry that contain audit information', 'Value') |\n|:-------------------------------------------------------------------------------|:---------------------------------------------------------------------------------|:----------------------------------------------------------------------|\n| User or service identity              | ident                   | \"ident\": \"aide\"              |\n| Target (Fields and values that call the API)         | message                   | For example, \"message\": \"AIDE check passed.\"       |\n| Action (Fields containing the performed operation)        | message                   | For example, \"message\": \"AIDE check passed.\"       |\n| Event timestamp                | time                    | For example, \"time\": \"2022-12-20T10:20:09.428106+00:00\"    |\n| Source of action                | host                    | For example, \"host\": \"zk-aa-bm08\"          |\n| Outcome                  | message                   | For example, \"message\": \"AIDE check passed.\"       |\n| Other fields                 | Not applicable                 | Not applicable              |\n**Example log**\n```\n{\u00a0 \"pri\": \"86\",\u00a0 \"time\": \"2022-12-20T10:20:09.428106+00:00\",\u00a0 \"host\": \"zk-aa-bm08\",\u00a0 \"ident\": \"aide\",\u00a0 \"pid\": \"-\",\u00a0 \"msgid\": \"-\",\u00a0 \"extradata\": \"-\",\u00a0 \"message\": \"AIDE check passed.\",\u00a0 \"_gdch_cluster\": \"root-admin\",\u00a0 \"_gdch_fluentbit_pod\": \"anthos-audit-logs-forwarder-lcxgq\",\u00a0 \"_gdch_service_name\": \"inventory-machine-bm-7cc496d5\"}\n```", "guide": "Documentation"}