{"title": "Google Kubernetes Engine (GKE) - Control log ingestion", "url": "https://cloud.google.com/kubernetes-engine/docs/concepts/kubernetes-engine-overview", "abstract": "# Google Kubernetes Engine (GKE) - Control log ingestion\n[Exclusion filters](/logging/docs/routing/overview#exclusions) let you control the volume of Google Kubernetes Engine (GKE) logs ingested by Cloud Logging while still making verbose logging available for debugging. You can use exclusion filters to exclude matching log entries from being ingested by Cloud Logging or from being routed to the destination of a [sink](/logging/docs/routing/overview#sinks) .\nCreate exclusion filters by using the [Logging query language](/logging/docs/view/logging-query-language) .\nLog entries are excluded after they are received by the Logging API and therefore these log entries consume [entries.write API quota](/logging/quotas#api-limits) . You can't reduce the number of [entries.write API calls](/logging/quotas#log-limits) by excluding log entries.\nExcluded log entries aren't available in the Logs Explorer or in Error Reporting.\nFor information about viewing ingestion data, see [View detailed usage in Metrics Explorer](/stackdriver/estimating-bills#metric-exp-usage) .\n", "content": "## Before you begin\nBefore you start, make sure you have performed the following tasks:\n- Enable    the Google Kubernetes Engine API.\n- [    Enable Google Kubernetes Engine API   ](https://console.cloud.google.com/flows/enableapi?apiid=container.googleapis.com) \n- If you want to use the Google Cloud CLI for this task, [install](/sdk/docs/install) and then [initialize](/sdk/docs/initializing) the  gcloud CLI. If you previously installed the gcloud CLI, get the latest  version by running`gcloud components update`. **Note:** For existing gcloud CLI  installations, make sure to set the`compute/region`and`compute/zone` [properties](/sdk/docs/properties#setting_properties) . By setting default locations,  you can avoid errors in gcloud CLI like the following:`One of [--zone, --region] must be supplied: Please specify location`.\n- Verify that you have a Google Cloud project with logs that you can see in the [Logs Explorer](/logging/docs/view/logs-explorer-summary) .\n### Permissions\nVerify that you have one of the following IAM roles for the source Google Cloud project from which you're routing logs.\n- **Owner** (`roles/owner`)\n- **Logging Admin** (`roles/logging.admin`)\n- **Logs Configuration Writer** (`roles/logging.configWriter`)\nThe permissions contained in these roles let you create, delete, or modify sinks. For information on setting IAM roles, see the Logging [Access control guide](/logging/docs/access-control) .\n## Add an exclusion filter\nThe following steps describe how to add a Cloud Logging exclusion filter that excludes logs from ingestion into the `Default` Cloud Logging bucket.\n- In the Google Cloud console, go to the **Logs Router** page: [Go to Logs Router](https://console.cloud.google.com/logs/router) \n- Find the row with the `_Default` sink, expand the more_vert **Actions** option, and then click **Edit sink** .\n- In **Choose logs to filter out of sink** , for **Build an exclusion filter** , click add **Add exclusion** .\n- Enter a name for your exclusion filter.\n- In the **Build an exclusion filter** section, enter the filter criteria. For example, you can exclude log entries for a cluster, or specific log entries for a container.Exclude all log entries from a specific cluster:```\nresource.labels.cluster_name=\"CLUSTER_NAME\"\n```Exclude log entries with the [log severity](/logging/docs/reference/v2/rest/v2/LogEntry#logseverity) `DEFAULT` , `DEBUG` , `INFO` , or `NOTICE` for a specific container in a specific cluster:```\nresource.type=\"k8s_container\"resource.labels.container_name=\"CONTAINER_NAME\"resource.labels.cluster_name=\"CLUSTER_NAME\"severity=(DEFAULT OR DEBUG OR INFO OR NOTICE)\n```\n- Click **Update sink** .\nThe `_Default` sink is now configured to exclude logs with the filter you added.\n## What's next\n- Learn about [configuring logging and monitoring](/kubernetes-engine/docs/how-to/config-logging-monitoring) for GKE.\n- Learn more about [exclusion filters](/logging/docs/routing/overview#exclusions) .", "guide": "Google Kubernetes Engine (GKE)"}