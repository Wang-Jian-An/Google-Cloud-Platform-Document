{"title": "Compute Engine - Running a basic Apache web server", "url": "https://cloud.google.com/compute/docs/instances", "abstract": "# Compute Engine - Running a basic Apache web server\nThis tutorial shows you how to use Compute Engine to deploy an Apache web server on a virtual machine (VM) instance. To learn more about the technologies that you can use for web serving on Google Cloud, see [Choosing a hosting option onGoogle Cloud](/architecture/web-serving-overview#choosing_an_option) .\nA VM on Compute Engine can be controlled like any standard Linux server. Deploy an Apache web server to learn the basics of running a server on a VM instance.", "content": "## PrerequisitesCreate a Linux VM that allows HTTP traffic by doing the following:- Create a new Linux VM. For more information, see [Quickstart using a LinuxVM](/compute/docs/create-linux-vm-instance) .- Optional: While creating a Linux VM, you can select the **Allow HTTP\ntraffic** checkbox to open port`tcp:80`for traffic and **Allow HTTPS\ntraffic** checkbox to open port`tcp:443`. However, if you want to open a different port, [configure the firewall](/vpc/docs/using-firewalls) after creating the VM, and then [configure Apache](https://httpd.apache.org/docs/2.4/bind.html) to use the firewall.\n- Connect to the Linux VM. For more information, see [Connect to theVM instance](/compute/docs/create-linux-vm-instance#connect_to_the_vm_instance) .\n## Install Apache\n- In the Google Cloud console, go to the **VM Instances** page. [  Go to VM instances](https://console.cloud.google.com/compute/instances) \n- To connect to the Linux VM you just created, click **SSH** in the row of the VM.\n- To update the available packages and install the `apache2` package, use the system package manager for that operating system. If you followed the Quickstart, this creates an Ubuntu VM. To update an Ubuntu VM, run the following command:```\nsudo apt update && sudo apt -y install apache2\n```After installing Apache, the operating system automatically starts the Apache server.\n- Verify that Apache is running:```\nsudo systemctl status apache2\n```\n- Overwrite the Apache web server default web page:```\necho '<!doctype html><html><body><h1>Hello World!</h1></body></html>' | sudo tee /var/www/html/index.html\n```\n## Test your serverTest that your VM is serving traffic on its external IP.- In the Google Cloud console, go to the **VM Instances** page. [  Go to VM instances](https://console.cloud.google.com/compute/instances) \n- Copy the external IP for your VM under the **External IP** column.\n- In a browser, navigate to`http://[EXTERNAL_IP]`. Don't connect using`https`because this causes the server to return a`Connection Refused`error.\nYou should now see the \"Hello World!\" page.## Clean upTo avoid incurring charges for the VM after you're done experimenting, delete the VM. For more information, see [Clean up](/compute/docs/create-linux-vm-instance#clean-up) .## Troubleshooting **Receiving a Connection Refused error** \nIf you are seeing a `Connection Refused` error, it is possible that:- Your VM instance is not publicly accessible because your firewall rules or tags are misconfigured in one of the following ways:- The VM instance does not have the proper tag that allows Compute Engine to apply the appropriate firewall rules to your instance.\n- Your project does not have a firewall rule that allows traffic to the external IP address for your instance.\n- You are trying to access the VM using an `https` address. Check that your URL is `http://[EXTERNAL_IP]` rather than `https://[EXTERNAL_IP]` .\nTo ensure that your VM instance has the correct tags:- In the Google Cloud console, go to the **VM instances** page. [  Go to VM instances](https://console.cloud.google.com/compute/instances) \n- Click the name of the instance that you are trying to connect to.\n- Click **Edit** at the top of the page.\n- Scroll down to **Firewalls** , and make sure the **Allow HTTP traffic** box is checked. If it is not checked, check it.\n- Save your changes. This ensures that the correct tags are added to the VM instance.\nTo ensure that the correct firewall rule exists:- In the Google Cloud console, go to the **Firewall rules** page. [  Go to Firewall rules](https://console.cloud.google.com/networking/firewalls) \n- Look for a firewall rule that allows all IP ranges through tcp:80. Usually, this rule is named the`default-allow-http`rule.\n- If a rule does not exist, create one.- Click **Create firewall rule** .\n- Enter a name for the rule, such as`default-allow-http`.\n- Under **Source IP ranges** , enter`0.0.0.0/0`to allow traffic from all sources.\n- Under **Protocols and ports** , check **Specified protocols and ports** and enter`tcp:80`.\n- Create your firewall rule.\nTest your server again by going to the external IP address of the instance:\n```\nhttp://[EXTERNAL_IP]\n```## What's nextLearn how to [host a website on Compute Engine](/solutions/web-serving-overview) .\nLearn how to [set up LAMP on Compute Engine](/community/tutorials/setting-up-lamp) .", "guide": "Compute Engine"}