{"title": "Docs - \u7db2\u7d61", "url": "https://cloud.google.com/architecture/security-foundations/networking?hl=zh-cn", "abstract": "# Docs - \u7db2\u7d61\nLast reviewed 2023-12-20 UTC\n\u8cc7\u6e90\u5728\u60a8\u7684 Google Cloud \u7d44\u7e54\u5167\u90e8\u4ee5\u53ca\u5728\u96f2\u74b0\u5883\u548c\u672c\u5730\u74b0\u5883\u4e4b\u9593\u901a\u4fe1\u9700\u8981\u7db2\u7d61\u3002\u672c\u90e8\u5206\u4ecb\u7d39\u85cd\u5716\u4e2d VPC \u7db2\u7d61\u3001IP \u5730\u5740\u7a7a\u9593\u3001DNS\u3001\u9632\u706b\u7246\u653f\u7b56\u4ee5\u53ca\u8207\u672c\u5730\u74b0\u5883\u7684\u9023\u63a5\u7684\u7d50\u69cb\u3002\n", "content": "## \u7db2\u7d61\u62d3\u64b2\n\u85cd\u5716\u5eab\u7232\u60a8\u7684\u7db2\u7d61\u62d3\u64b2\u63d0\u4f9b\u4ee5\u4e0b\u9078\u9805\uff1a\n- \u5c0d\u6bcf\u500b\u74b0\u5883\u4f7f\u7528\u55ae\u7368\u7684\u5171\u4eab VPC \u7db2\u7d61\uff0c\u4e26\u4e14\u4e0d\u540c\u74b0\u5883\u4e4b\u9593\u4e0d\u5141\u8a31\u76f4\u63a5\u50b3\u8f38\u7db2\u7d61\u6d41\u91cf\u3002\n- \u4f7f\u7528\u4e2d\u5fc3\u8f3b\u5c04\u578b\u6a21\u578b\u4f86\u6dfb\u52a0 hub \u7db2\u7d61\uff0c\u4ee5\u9023\u63a5 Google Cloud \u4e2d\u6bcf\u500b\u74b0\u5883\uff0c\u4e26\u901a\u904e\u7db2\u7d61\u865b\u64ec\u8a2d\u5099 (NVA) \u63a7\u5236\u74b0\u5883\u4e4b\u9593\u7684\u7db2\u7d61\u6d41\u91cf\u3002\n\u5982\u679c\u60a8\u4e0d\u60f3\u5728\u74b0\u5883\u4e4b\u9593\u5b58\u5728\u76f4\u63a5\u7684\u7db2\u7d61\u9023\u63a5\uff0c\u8acb\u9078\u64c7 [\u96d9\u5171\u4eab VPC \u7db2\u7d61\u62d3\u64b2](#dual-shared-vpc-network-topology) \u3002\u7576\u60f3\u8981\u5728\u74b0\u5883\u4e4b\u9593\u5141\u8a31\u7531 NVA \u904e\u6ffe\u7684\u7db2\u7d61\u9023\u63a5\u6642\uff0c\u4f8b\u5982\u7576\u60a8\u4f9d\u8cf4\u7684\u73fe\u6709\u5de5\u5177\u9700\u8981\u6709\u4e00\u500b\u76f4\u63a5\u7db2\u7d61\u8def\u5f91\u9023\u63a5\u60a8\u74b0\u5883\u4e2d\u6bcf\u500b\u670d\u52d9\u5668\u6642\uff0c\u8acb\u9078\u64c7 [\u4e2d\u5fc3\u8f3b\u5c04\u578b\u7db2\u7d61\u62d3\u64b2](#hub-spoke-network-topology) \u3002\n\u9019\u5169\u7a2e\u62d3\u64b2\u4f7f\u7528\u5171\u4eab VPC \u4f5c\u7232\u4e3b\u7db2\u7d61\u7d50\u69cb\uff0c\u56e0\u7232\u5171\u4eab VPC \u53ef\u660e\u78ba\u5283\u5206\u8077\u8cac\u3002\u7db2\u7d61\u7ba1\u7406\u54e1\u5728\u96c6\u4e2d\u5f0f\u5bbf\u4e3b\u9805\u76ee\u4e2d\u7ba1\u7406\u7db2\u7d61\u8cc7\u6e90\uff0c\u800c\u5de5\u4f5c\u8ca0\u8f09\u5718\u968a\u5728\u9644\u52a0\u5230\u5bbf\u4e3b\u9805\u76ee\u7684\u670d\u52d9\u9805\u76ee\u4e2d\u90e8\u7f72\u4ed6\u5011\u81ea\u5df1\u7684\u61c9\u7528\u8cc7\u6e90\u4e26\u4f7f\u7528\u7db2\u7d61\u8cc7\u6e90\u3002\n\u9019\u5169\u7a2e\u62d3\u64b2\u90fd\u5305\u542b\u6bcf\u500b VPC \u7db2\u7d61\u7684\u57fa\u672c\u7248\u672c\u548c\u53d7\u9650\u7248\u672c\u3002\u57fa\u672c VPC \u7db2\u7d61\u7528\u65bc\u5305\u542b\u975e\u654f\u611f\u6578\u64da\u7684\u8cc7\u6e90\uff0c\u800c\u53d7\u9650 VPC \u7db2\u7d61\u7528\u65bc\u5305\u542b\u654f\u611f\u6578\u64da\u4e14\u9700\u8981 VPC Service Controls \u7684\u8cc7\u6e90\u3002\u5982\u9700\u8a73\u7d30\u77ad\u89e3\u5982\u4f55\u5be6\u73fe VPC Service Controls\uff0c\u8acb\u53c3\u95b1 [\u4f7f\u7528 VPC Service Controls \u4fdd\u8b77\u60a8\u7684\u8cc7\u6e90](https://cloud.google.com/architecture/security-foundations/operation-best-practices?hl=zh-cn#protect-resources) \u3002\n### \u96d9\u5171\u4eab VPC \u7db2\u7d61\u62d3\u64b2\n\u5982\u679c\u60a8\u9700\u8981\u5728 Google Cloud \u4e0a\u7684\u958b\u767c\u7db2\u7d61\u3001\u975e\u751f\u7522\u7db2\u7d61\u548c\u751f\u7522\u7db2\u7d61\u4e4b\u9593\u9032\u884c\u7db2\u7d61\u9694\u96e2\uff0c\u6211\u5011\u5efa\u8b70\u4f7f\u7528\u96d9\u5171\u4eab VPC \u7db2\u7d61\u62d3\u64b2\u3002\u6b64\u62d3\u64b2\u7232\u6bcf\u500b\u74b0\u5883\u4f7f\u7528\u55ae\u7368\u7684\u5171\u4eab VPC \u7db2\u7d61\uff0c\u4e26\u4e14\u6bcf\u500b\u74b0\u5883\u6703\u53e6\u5916\u5728\u57fa\u672c\u5171\u4eab VPC \u7db2\u7d61\u548c\u53d7\u9650\u5171\u4eab VPC \u7db2\u7d61\u4e4b\u9593\u62c6\u5206\u3002\n\u4e0b\u5716\u986f\u793a\u4e86\u96d9\u5171\u4eab VPC \u7db2\u7d61\u62d3\u64b2\u3002\n\u8a72\u5716\u63cf\u8ff0\u4e86\u96d9\u5171\u4eab VPC \u62d3\u64b2\u7684\u4ee5\u4e0b\u4e3b\u8981\u6982\u5ff5\uff1a\n- \u6bcf\u7a2e\u74b0\u5883\uff08\u751f\u7522\u3001\u975e\u751f\u7522\u548c\u958b\u767c\uff09\u90fd\u6703\u7232\u57fa\u672c\u7db2\u7d61\u914d\u7f6e\u4e00\u500b\u5171\u4eab VPC \u7db2\u7d61\uff0c\u7232\u53d7\u9650\u7db2\u7d61\u914d\u7f6e\u4e00\u500b\u5171\u4eab VPC \u7db2\u7d61\u3002\u6b64\u5716\u50c5\u986f\u793a\u751f\u7522\u74b0\u5883\uff0c\u4f46\u6bcf\u500b\u74b0\u5883\u90fd\u63a1\u7528\u6b64\u540c\u4e00\u6a21\u5f0f\u3002\n- \u6bcf\u500b\u5171\u4eab VPC \u7db2\u7d61\u90fd\u6709\u5169\u500b\u5b50\u7db2\uff0c\u5404\u5b50\u7db2\u4f4d\u65bc\u4e0d\u540c\u7684\u5340\u57df\u3002\n- \u901a\u904e\u4f7f\u7528\u56db\u500b Cloud Router \u670d\u52d9\uff08\u6bcf\u500b\u5340\u57df\u5169\u500b\u4ee5\u5be6\u73fe\u5197\u9918\uff09\u8207\u6bcf\u500b\u5171\u4eab VPC \u7db2\u7d61\u7684\u5c08\u7528\u4e92\u9023\u5be6\u4f8b\u5efa\u7acb\u56db\u500b VLAN \u9023\u63a5\uff0c\u5f9e\u800c\u5be6\u73fe\u8207\u672c\u5730\u8cc7\u6e90\u7684\u9023\u63a5\u3002\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [\u672c\u5730\u74b0\u5883\u8207 Google Cloud \u4e4b\u9593\u7684\u6df7\u5408\u9023\u63a5](#hybrid-connectivity) \u3002\n\u6839\u64da\u8a2d\u8a08\uff0c\u6b64\u62d3\u64b2\u4e0d\u5141\u8a31\u7db2\u7d61\u6d41\u91cf\u76f4\u63a5\u5728\u74b0\u5883\u4e4b\u9593\u6d41\u52d5\u3002\u5982\u679c\u60a8\u78ba\u5be6\u9700\u8981\u7db2\u7d61\u6d41\u91cf\u76f4\u63a5\u5728\u74b0\u5883\u4e4b\u9593\u6d41\u52d5\uff0c\u5247\u5fc5\u9808\u57f7\u884c\u984d\u5916\u6b65\u9a5f\u624d\u80fd\u5141\u8a31\u6b64\u7db2\u7d61\u8def\u5f91\u3002\u4f8b\u5982\uff0c\u60a8\u53ef\u4ee5 [\u914d\u7f6e Private Service Connect \u7aef\u9ede](https://cloud.google.com/vpc/docs/about-accessing-vpc-hosted-services-endpoints?hl=zh-cn) \uff0c\u4ee5\u5c07\u670d\u52d9\u5f9e\u4e00\u500b VPC \u7db2\u7d61\u516c\u958b\u7d66\u53e6\u4e00\u500b VPC \u7db2\u7d61\u3002\u6216\u8005\uff0c\u60a8\u53ef\u4ee5\u914d\u7f6e\u672c\u5730\u7db2\u7d61\uff0c\u4ee5\u5141\u8a31\u6d41\u91cf\u5f9e\u4e00\u500b Google Cloud \u74b0\u5883\u6d41\u5411\u672c\u5730\u74b0\u5883\uff0c\u7136\u5f8c\u6d41\u5411\u53e6\u4e00\u500b Google Cloud \u74b0\u5883\u3002\n### \u4e2d\u5fc3\u8f3b\u5c04\u578b\u7db2\u7d61\u62d3\u64b2\n\u5982\u679c\u60a8\u5728 Google Cloud \u4e2d\u90e8\u7f72\u7684\u8cc7\u6e90\u9700\u8981\u6709\u4e00\u500b\u76f4\u63a5\u7db2\u7d61\u8def\u5f91\u4f86\u9023\u63a5\u591a\u500b\u74b0\u5883\u4e2d\u7684\u8cc7\u6e90\uff0c\u6211\u5011\u5efa\u8b70\u4f7f\u7528\u4e2d\u5fc3\u8f3b\u5c04\u578b\u7db2\u7d61\u62d3\u64b2\u3002\n\u4e2d\u5fc3\u8f3b\u5c04\u578b\u62d3\u64b2\u96d6\u7136\u4f7f\u7528\u4e86\u96d9\u5171\u4eab VPC \u62d3\u64b2\u4e2d\u7684\u5e7e\u500b\u6982\u5ff5\uff0c\u4f46\u5b83\u53ef\u4fee\u6539\u62d3\u64b2\u4ee5\u6dfb\u52a0 hub \u7db2\u7d61\u3002\u4e0b\u5716\u5c55\u793a\u4e86\u4e2d\u5fc3\u8f3b\u5c04\u578b\u62d3\u64b2\u3002\n\u8a72\u5716\u63cf\u8ff0\u4e86\u4e2d\u5fc3\u8f3b\u5c04\u578b\u7db2\u7d61\u62d3\u64b2\u7684\u4ee5\u4e0b\u4e3b\u8981\u6982\u5ff5\uff1a\n- \u6b64\u6a21\u578b\u6dfb\u52a0\u4e86\u4e00\u500b hub \u7db2\u7d61\uff0c\u6bcf\u500b\u958b\u767c\u7db2\u7d61\u3001\u975e\u751f\u7522\u7db2\u7d61\u548c\u751f\u7522\u7db2\u7d61 (spoke) \u90fd\u901a\u904e VPC \u7db2\u7d61\u5c0d\u7b49\u4e92\u9023\u9023\u63a5\u5230 hub \u7db2\u7d61\u3002\u6216\u8005\uff0c\u5982\u679c\u60a8\u9810\u8a08\u6703\u8d85\u51fa [\u914d\u984d\u9650\u5236](https://cloud.google.com/vpc/docs/quota?hl=zh-cn#per_network) \uff0c\u5247\u53ef\u4ee5\u6539\u7528 [\u9ad8\u53ef\u7528\u6027 VPN \u7db2\u95dc](https://cloud.google.com/network-connectivity/docs/vpn/concepts/topologies?hl=zh-cn) \u3002\n- \u50c5\u5141\u8a31\u901a\u904e hub \u7db2\u7d61\u9023\u63a5\u5230\u672c\u5730\u7db2\u7d61\u3002\u6240\u6709 spoke \u7db2\u7d61\u90fd\u53ef\u4ee5\u8207 hub \u7db2\u7d61\u4e2d\u7684\u5171\u4eab\u8cc7\u6e90\u901a\u4fe1\uff0c\u4e26\u4f7f\u7528\u6b64\u8def\u5f91\u9023\u63a5\u5230\u672c\u5730\u7db2\u7d61\u3002\n- hub \u7db2\u7d61\u5305\u62ec\u6bcf\u500b\u5340\u57df\u5728\u5167\u90e8\u7db2\u7d61\u8ca0\u8f09\u5747\u8861\u5668\u5be6\u4f8b\u5f8c\u5197\u9918\u90e8\u7f72\u7684 NVA\u3002\u6b64 NVA \u5145\u7576\u7db2\u95dc\uff0c\u4ee5\u5141\u8a31\u6216\u62d2\u7d55\u6d41\u91cf\u5728 spoke \u7db2\u7d61\u4e4b\u9593\u9032\u884c\u901a\u4fe1\u3002\n- hub \u7db2\u7d61\u9084\u8a17\u7ba1\u9700\u8981\u9023\u63a5\u5230\u6240\u6709\u5176\u4ed6\u7db2\u7d61\u7684\u5de5\u5177\u3002\u4f8b\u5982\uff0c\u60a8\u53ef\u4ee5\u5c07\u7528\u65bc\u914d\u7f6e\u7ba1\u7406\u7684\u865b\u64ec\u6a5f\u5be6\u4f8b\u4e0a\u7684\u5de5\u5177\u90e8\u7f72\u5230\u901a\u7528\u74b0\u5883\u3002\n- \u6bcf\u500b\u7db2\u7d61\u7684\u57fa\u672c\u7248\u672c\u548c\u53d7\u9650\u7248\u672c\u90fd\u5177\u6709\u76f8\u540c\u7684\u4e2d\u5fc3\u8f3b\u5c04\u578b\u6a21\u578b\u3002\n\u7232\u4e86\u5be6\u73fe spoke \u4e4b\u9593\u7684\u6d41\u91cf\u50b3\u8f38\uff0c\u8a72\u85cd\u5716\u6703\u5728 hub \u5171\u4eab VPC \u7db2\u7d61\u4e0a\u90e8\u7f72 NVA\uff0c\u4ee5\u5145\u7576\u7db2\u7d61\u4e4b\u9593\u7684\u7db2\u95dc\u3002\u8def\u7531\u901a\u904e [\u81ea\u5b9a\u7fa9\u8def\u7531\u4ea4\u63db](https://cloud.google.com/vpc/docs/vpc-peering?hl=zh-cn#importing-exporting-routes) \u5f9e hub VPC \u7db2\u7d61\u4ea4\u63db\u5230 spoke VPC \u7db2\u7d61\u3002\u5728\u9019\u7a2e\u60c5\u6cc1\u4e0b\uff0cspoke \u4e4b\u9593\u7684\u9023\u63a5\u5fc5\u9808\u901a\u904e NVA \u9032\u884c\u8def\u7531\uff0c\u56e0\u7232 VPC \u7db2\u7d61\u5c0d\u7b49\u4e92\u9023\u4e0d\u5177\u6709\u50b3\u905e\u6027\uff0c\u56e0\u6b64 spoke VPC \u7db2\u7d61\u4e4b\u9593\u7121\u6cd5\u76f4\u63a5\u76f8\u4e92\u4ea4\u63db\u6578\u64da\u3002\u60a8\u5fc5\u9808\u5c07\u865b\u64ec\u8a2d\u5099\u914d\u7f6e\u7232\u6709\u9078\u64c7\u5730\u5141\u8a31 spoke \u4e4b\u9593\u7684\u6d41\u91cf\u3002\n\u5982\u9700\u8a73\u7d30\u77ad\u89e3\u5982\u4f55\u4f7f\u7528 NVA \u63a7\u5236 spoke \u4e4b\u9593\u7684\u6d41\u91cf\uff0c\u8acb\u53c3\u95b1 [Google Cloud \u4e0a\u7684\u96c6\u4e2d\u5f0f\u7db2\u7d61\u8a2d\u5099](https://cloud.google.com/architecture/architecture-centralized-network-appliances-on-google-cloud?hl=zh-cn#example_architecture_using_vpc_network_peering_and_internal_tcp_udp_load_balancer_as_next_hop) \u3002\n## \u9805\u76ee\u90e8\u7f72\u6a21\u5f0f\n\u7232\u5de5\u4f5c\u8ca0\u8f09\u5275\u5efa\u65b0\u9805\u76ee\u6642\uff0c\u60a8\u5fc5\u9808\u78ba\u5b9a\u6b64\u9805\u76ee\u4e2d\u7684\u8cc7\u6e90\u5982\u4f55\u9023\u63a5\u5230\u73fe\u6709\u7db2\u7d61\u3002\u4e0b\u8868\u4ecb\u7d39\u4e86\u85cd\u5716\u4e2d\u4f7f\u7528\u7684\u9805\u76ee\u90e8\u7f72\u6a21\u5f0f\u3002\n| \u6a21\u5f0f   | \u8aaa\u660e                                                                                                                            | \u7528\u6cd5\u793a\u4f8b         |\n|:-------------|:-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:-----------------------------------------|\n| \u5171\u4eab\u57fa\u672c\u9805\u76ee | \u9019\u4e9b\u9805\u76ee\u4f5c\u7232\u670d\u52d9\u9805\u76ee\u914d\u7f6e\u5230\u57fa\u672c\u5171\u4eab VPC \u5bbf\u4e3b\u9805\u76ee\u3002 \u7576\u9805\u76ee\u4e2d\u7684\u8cc7\u6e90\u7b26\u5408\u4ee5\u4e0b\u689d\u4ef6\u6642\uff0c\u8acb\u4f7f\u7528\u6b64\u6a21\u5f0f\uff1a \u9700\u8981\u8207\u672c\u5730\u74b0\u5883\u6216\u540c\u4e00\u5171\u4eab VPC \u62d3\u64b2\u4e2d\u7684\u8cc7\u6e90\u5efa\u7acb\u7db2\u7d61\u9023\u63a5\u3002 \u9700\u8981\u4e00\u500b\u7db2\u7d61\u8def\u5f91\u9023\u63a5\u5c08\u7528\u865b\u64ec IP \u5730\u5740\u4e2d\u5305\u542b\u7684 Google \u670d\u52d9\u3002 \u4e0d\u9700\u8981 VPC Service Controls\u3002                                                                 | example_base_shared_vpc_project.tf  |\n| \u5171\u4eab\u53d7\u9650\u9805\u76ee | \u9019\u4e9b\u9805\u76ee\u4f5c\u7232\u670d\u52d9\u9805\u76ee\u914d\u7f6e\u5230\u53d7\u9650\u5171\u4eab VPC \u5bbf\u4e3b\u9805\u76ee\u3002 \u7576\u9805\u76ee\u4e2d\u7684\u8cc7\u6e90\u7b26\u5408\u4ee5\u4e0b\u689d\u4ef6\u6642\uff0c\u8acb\u4f7f\u7528\u6b64\u6a21\u5f0f\uff1a \u9700\u8981\u8207\u672c\u5730\u74b0\u5883\u6216\u540c\u4e00\u5171\u4eab VPC \u62d3\u64b2\u4e2d\u7684\u8cc7\u6e90\u5efa\u7acb\u7db2\u7d61\u9023\u63a5\u3002 \u9700\u8981\u4e00\u500b\u7db2\u7d61\u8def\u5f91\u9023\u63a5\u53d7\u9650\u865b\u64ec IP \u5730\u5740\u4e2d\u5305\u542b\u7684 Google \u670d\u52d9\u3002 \u9700\u8981 VPC Service Controls\u3002                                                                 | example_restricted_shared_vpc_project.tf |\n| \u61f8\u6d6e\u9805\u76ee  | \u61f8\u6d6e\u9805\u76ee\u672a\u9023\u63a5\u5230\u62d3\u64b2\u4e2d\u7684\u5176\u4ed6 VPC \u7db2\u7d61\u3002 \u7576\u9805\u76ee\u4e2d\u7684\u8cc7\u6e90\u7b26\u5408\u4ee5\u4e0b\u689d\u4ef6\u6642\uff0c\u8acb\u4f7f\u7528\u6b64\u6a21\u5f0f\uff1a \u4e0d\u9700\u8981\u8207\u672c\u5730\u74b0\u5883\u6216\u5171\u4eab VPC \u62d3\u64b2\u4e2d\u7684\u8cc7\u6e90\u5efa\u7acb\u5168\u7db2\u72c0\u9023\u63a5\u3002 \u4e0d\u9700\u8981 VPC \u7db2\u7d61\uff0c\u6216\u8005\u60a8\u5e0c\u671b\u4e0d\u8003\u616e\u4e3b VPC \u7db2\u7d61\u62d3\u64b2\u4f86\u7ba1\u7406\u6b64\u9805\u76ee\u7684 VPC \u7db2\u7d61\u6642\uff08\u4f8b\u5982\uff0c\u7576\u60a8\u60f3\u8981\u4f7f\u7528\u8207\u5df2\u7528\u7bc4\u570d\u885d\u7a81\u7684 IP \u5730\u5740\u7bc4\u570d\u6642\uff09\u3002 \u60a8\u53ef\u80fd\u9047\u5230\u9019\u6a23\u7684\u60c5\u6cc1\uff1a\u60a8\u5e0c\u671b\u5c07\u61f8\u6d6e\u9805\u76ee\u7684 VPC \u7db2\u7d61\u8207\u4e3b VPC \u7db2\u7d61\u62d3\u64b2\u5206\u958b\uff0c\u4f46\u9084\u5e0c\u671b\u5728\u7db2\u7d61\u4e4b\u9593\u516c\u958b\u6709\u9650\u6578\u91cf\u7684\u7aef\u9ede\u3002 \u5728\u9019\u7a2e\u60c5\u6cc1\u4e0b\uff0c\u8acb\u4f7f\u7528 Private Service Connect \u767c\u4f48\u670d\u52d9\uff0c\u4ee5\u8de8 VPC \u7db2\u7d61\u5171\u4eab\u5c0d\u55ae\u500b\u7aef\u9ede\u7684\u7db2\u7d61\u8a2a\u554f\u6b0a\u9650\uff0c\u4f46\u4e0d\u516c\u958b\u6574\u500b\u7db2\u7d61\u3002 | example_floating_project.tf    |\n| \u5c0d\u7b49\u4e92\u9023\u9805\u76ee | \u5c0d\u7b49\u4e92\u9023\u9805\u76ee\u6703\u5275\u5efa\u81ea\u5df1\u7684 VPC \u7db2\u7d61\uff0c\u4e26\u8207\u62d3\u64b2\u4e2d\u7684\u5176\u4ed6 VPC \u7db2\u7d61\u5efa\u7acb\u5c0d\u7b49\u4e92\u9023\u3002 \u7576\u9805\u76ee\u4e2d\u7684\u8cc7\u6e90\u7b26\u5408\u4ee5\u4e0b\u689d\u4ef6\u6642\uff0c\u8acb\u4f7f\u7528\u6b64\u6a21\u5f0f\uff1a \u9700\u8981\u5728\u76f4\u63a5\u5c0d\u7b49\u4e92\u9023\u7684 VPC \u7db2\u7d61\u4e2d\u5efa\u7acb\u7db2\u7d61\u9023\u63a5\uff0c\u4f46\u4e0d\u9700\u8981\u8207\u672c\u5730\u74b0\u5883\u6216\u5176\u4ed6 VPC \u7db2\u7d61\u5efa\u7acb\u50b3\u905e\u6027\u9023\u63a5\u3002 \u7ba1\u7406\u6b64\u9805\u76ee\u7684 VPC \u7db2\u7d61\uff0c\u800c\u4e0d\u8003\u616e\u4e3b\u7db2\u7d61\u62d3\u64b2\u3002 \u5982\u679c\u60a8\u5275\u5efa\u4e86\u5c0d\u7b49\u4e92\u9023\u9805\u76ee\uff0c\u5247\u6709\u8cac\u4efb\u5206\u914d\u975e\u885d\u7a81\u7684 IP \u5730\u5740\u7bc4\u570d\u4e26\u898f\u5283\u5c0d\u7b49\u4e92\u9023\u7d44\u914d\u984d\u3002                                        | example_peering_project.tf    |\n## IP \u5730\u5740\u5206\u914d\n\u672c\u90e8\u5206\u4ecb\u7d39\u85cd\u5716\u67b6\u69cb\u5982\u4f55\u5206\u914d IP \u5730\u5740\u7bc4\u570d\u3002\u60a8\u53ef\u80fd\u9700\u8981\u6839\u64da\u73fe\u6709\u6df7\u5408\u74b0\u5883\u4e2d\u7684 IP \u5730\u5740\u53ef\u7528\u6027\u66f4\u6539\u6240\u4f7f\u7528\u7684\u7279\u5b9a IP \u5730\u5740\u7bc4\u570d\u3002\n\u4e0b\u8868\u63d0\u4f9b\u4e86\u7232\u85cd\u5716\u5206\u914d\u7684 IP \u5730\u5740\u7a7a\u9593\u7684\u660e\u7d30\u3002\u4e2d\u5fc3\u74b0\u5883\u50c5\u9069\u7528\u65bc\u4e2d\u5fc3\u8f3b\u5c04\u578b\u62d3\u64b2\u3002\n| \u7528\u9014       | VPC \u985e\u578b | \u5340\u57df | \u4e2d\u5fc3\u74b0\u5883   | \u958b\u767c\u74b0\u5883   | \u975e\u751f\u7522\u74b0\u5883   | \u751f\u7522\u74b0\u5883    |\n|:-----------------------------|:-----------|:-------|:-------------------|:--------------------|:---------------------|:---------------------|\n| \u4e3b\u8981\u5b50\u7db2\u7bc4\u570d     | \u57fa\u672c  | \u5340\u57df 1 | 10.0.0.0/18  | 10.0.64.0/18  | 10.0.128.0/18  | 10.0.192.0/18  |\n| \u4e3b\u8981\u5b50\u7db2\u7bc4\u570d     | \u57fa\u672c  | \u5340\u57df 2 | 10.1.0.0/18  | 10.1.64.0/18  | 10.1.128.0/18  | 10.1.192.0/18  |\n| \u4e3b\u8981\u5b50\u7db2\u7bc4\u570d     | \u57fa\u672c  | \u672a\u5206\u914d | 10.{2-7}.0.0/18 | 10.{2-7}.64.0/18 | 10.{2-7}.128.0/18 | 10.{2-7}.192.0/18 |\n| \u4e3b\u8981\u5b50\u7db2\u7bc4\u570d     | \u53d7\u9650  | \u5340\u57df 1 | 10.8.0.0/18  | 10.8.64.0/18  | 10.8.128.0/18  | 10.8.192.0/18  |\n| \u4e3b\u8981\u5b50\u7db2\u7bc4\u570d     | \u53d7\u9650  | \u5340\u57df 2 | 10.9.0.0/18  | 10.9.64.0/18  | 10.9.128.0/18  | 10.9.192.0/18  |\n| \u4e3b\u8981\u5b50\u7db2\u7bc4\u570d     | \u53d7\u9650  | \u672a\u5206\u914d | 10.{10-15}.0.0/18 | 10.{10-15}.64.0/18 | 10.{10-15}.128.0/18 | 10.{10-15}.192.0/18 |\n| \u5c08\u7528\u670d\u52d9\u8a2a\u554f\u901a\u9053    | \u57fa\u672c  | \u5168\u7403 | 10.16.0.0/21  | 10.16.8.0/21  | 10.16.16.0/21  | 10.16.24.0/21  |\n| \u5c08\u7528\u670d\u52d9\u8a2a\u554f\u901a\u9053    | \u53d7\u9650  | \u5168\u7403 | 10.16.32.0/21  | 10.16.40.0/21  | 10.16.48.0/21  | 10.16.56.0/21  |\n| Private Service Connect \u7aef\u9ede | \u57fa\u672c  | \u5168\u7403 | 10.17.0.1/32  | 10.17.0.2/32  | 10.17.0.3/32   | 10.17.0.4/32   |\n| Private Service Connect \u7aef\u9ede | \u53d7\u9650  | \u5168\u7403 | 10.17.0.5/32  | 10.17.0.6/32  | 10.17.0.7/32   | 10.17.0.8/32   |\n| \u4ee3\u7406\u5c08\u7528\u5b50\u7db2     | \u57fa\u672c  | \u5340\u57df 1 | 10.18.0.0/23  | 10.18.2.0/23  | 10.18.4.0/23   | 10.18.6.0/23   |\n| \u4ee3\u7406\u5c08\u7528\u5b50\u7db2     | \u57fa\u672c  | \u5340\u57df 2 | 10.19.0.0/23  | 10.19.2.0/23  | 10.19.4.0/23   | 10.19.6.0/23   |\n| \u4ee3\u7406\u5c08\u7528\u5b50\u7db2     | \u57fa\u672c  | \u672a\u5206\u914d | 10.{20-25}.0.0/23 | 10.{20-25}.2.0/23 | 10.{20-25}.4.0/23 | 10.{20-25}.6.0/23 |\n| \u4ee3\u7406\u5c08\u7528\u5b50\u7db2     | \u53d7\u9650  | \u5340\u57df 1 | 10.26.0.0/23  | 10.26.2.0/23  | 10.26.4.0/23   | 10.26.6.0/23   |\n| \u4ee3\u7406\u5c08\u7528\u5b50\u7db2     | \u53d7\u9650  | \u5340\u57df 2 | 10.27.0.0/23  | 10.27.2.0/23  | 10.27.4.0/23   | 10.27.6.0/23   |\n| \u4ee3\u7406\u5c08\u7528\u5b50\u7db2     | \u53d7\u9650  | \u672a\u5206\u914d | 10.{28-33}.0.0/23 | 10.{28-33}.2.0/23 | 10.{28-33}.4.0/23 | 10.{28-33}.6.0/23 |\n| \u6b21\u8981\u5b50\u7db2\u7bc4\u570d     | \u57fa\u672c  | \u5340\u57df 1 | 100.64.0.0/18  | 100.64.64.0/18  | 100.64.128.0/18  | 100.64.192.0/18  |\n| \u6b21\u8981\u5b50\u7db2\u7bc4\u570d     | \u57fa\u672c  | \u5340\u57df 2 | 100.65.0.0/18  | 100.65.64.0/18  | 100.65.128.0/18  | 100.65.192.0/18  |\n| \u6b21\u8981\u5b50\u7db2\u7bc4\u570d     | \u57fa\u672c  | \u672a\u5206\u914d | 100.{66-71}.0.0/18 | 100.{66-71}.64.0/18 | 100.{66-71}.128.0/18 | 100.{66-71}.192.0/18 |\n| \u6b21\u8981\u5b50\u7db2\u7bc4\u570d     | \u53d7\u9650  | \u5340\u57df 1 | 100.72.0.0/18  | 100.72.64.0/18  | 100.72.128.0/18  | 100.72.192.0/18  |\n| \u6b21\u8981\u5b50\u7db2\u7bc4\u570d     | \u53d7\u9650  | \u5340\u57df 2 | 100.73.0.0/18  | 100.73.64.0/18  | 100.73.128.0/18  | 100.73.192.0/18  |\n| \u6b21\u8981\u5b50\u7db2\u7bc4\u570d     | \u53d7\u9650  | \u672a\u5206\u914d | 100.{74-79}.0.0/18 | 100.{74-79}.64.0/18 | 100.{74-79}.128.0/18 | 100.{74-79}.192.0/18 |\n\u4e0b\u8868\u5c55\u793a\u4e86\u4ee5\u4e0b\u5206\u914d IP \u5730\u5740\u7bc4\u570d\u7684\u6982\u5ff5\uff1a\n- IP \u5730\u5740\u5206\u914d\u53ef\u7d30\u5206\u7232\u57fa\u672c\u5171\u4eab VPC\u3001\u53d7\u9650\u5171\u4eab VPC\u3001\u5340\u57df\u548c\u74b0\u5883\u7684\u6bcf\u500b\u7d44\u5408\u7684\u7bc4\u570d\u3002\n- \u67d0\u4e9b\u8cc7\u6e90\u662f\u5168\u7403\u6027\u7684\uff0c\u4e0d\u9700\u8981\u5c0d\u6bcf\u500b\u5340\u57df\u9032\u884c\u7d30\u5206\u3002\n- \u9ed8\u8a8d\u60c5\u6cc1\u4e0b\uff0c\u5c0d\u65bc\u5340\u57df\u7d1a\u8cc7\u6e90\uff0c\u85cd\u5716\u5c07\u90e8\u7f72\u5728\u5169\u500b\u5340\u57df\u4e2d\u3002\u6b64\u5916\uff0c\u9084\u6709\u672a\u4f7f\u7528\u7684 IP \u5730\u5740\u7bc4\u570d\uff0c\u56e0\u6b64\u60a8\u53ef\u4ee5\u518d\u64f4\u5c55\u516d\u500b\u5340\u57df\u3002\n- hub \u7db2\u7d61\u50c5\u7528\u65bc\u4e2d\u5fc3\u8f3b\u5c04\u578b\u7db2\u7d61\u62d3\u64b2\uff0c\u800c\u958b\u767c\u3001\u975e\u751f\u7522\u548c\u751f\u7522\u74b0\u5883\u53ef\u7528\u65bc\u9019\u5169\u7a2e\u7db2\u7d61\u62d3\u64b2\u3002\n\u4e0b\u8868\u4ecb\u7d39\u4e86\u6bcf\u7a2e IP \u5730\u5740\u7bc4\u570d\u7684\u4f7f\u7528\u65b9\u5f0f\u3002\n| ('\u7528\u9014', '\u7528\u9014')  | ('\u8aaa\u660e', '\u8aaa\u660e')                                                               |\n|:------------------------|:-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|\n| nan      | nan                                                                  |\n| \u4e3b\u8981\u5b50\u7db2\u7bc4\u570d   | \u60a8\u90e8\u7f72\u5230 VPC \u7db2\u7d61\u7684\u8cc7\u6e90\uff08\u4f8b\u5982\u865b\u64ec\u6a5f\u5be6\u4f8b\uff09\u6703\u4f7f\u7528\u9019\u4e9b\u7bc4\u570d\u5167\u7684\u5167\u90e8 IP \u5730\u5740\u3002                                                |\n| \u4e3b\u8981\u5b50\u7db2\u7bc4\u570d   | \u60a8\u90e8\u7f72\u5230 VPC \u7db2\u7d61\u7684\u8cc7\u6e90\uff08\u4f8b\u5982\u865b\u64ec\u6a5f\u5be6\u4f8b\uff09\u6703\u4f7f\u7528\u9019\u4e9b\u7bc4\u570d\u5167\u7684\u5167\u90e8 IP \u5730\u5740\u3002                                                |\n| \u4e3b\u8981\u5b50\u7db2\u7bc4\u570d   | \u60a8\u90e8\u7f72\u5230 VPC \u7db2\u7d61\u7684\u8cc7\u6e90\uff08\u4f8b\u5982\u865b\u64ec\u6a5f\u5be6\u4f8b\uff09\u6703\u4f7f\u7528\u9019\u4e9b\u7bc4\u570d\u5167\u7684\u5167\u90e8 IP \u5730\u5740\u3002                                                |\n| \u5c08\u7528\u670d\u52d9\u8a2a\u554f\u901a\u9053  | \u67d0\u4e9b Google Cloud \u670d\u52d9\uff08\u4f8b\u5982 Cloud SQL\uff09\u8981\u6c42\u60a8\u7232\u5c08\u7528\u670d\u52d9\u8a2a\u554f\u901a\u9053\u9810\u5148\u5206\u914d\u5b50\u7db2\u7bc4\u570d\u3002\u6b64\u85cd\u5716\u5728\u5168\u7403\u7bc4\u570d\u5167\u7232\u6bcf\u500b\u5171\u4eab VPC \u7db2\u7d61\u9810\u7559\u4e00\u500b /21 \u7bc4\u570d\uff0c\u4ee5\u4fbf\u7232\u9700\u8981\u5c08\u7528\u670d\u52d9\u8a2a\u554f\u901a\u9053\u7684\u670d\u52d9\u5206\u914d IP \u5730\u5740\u3002\u5275\u5efa\u4f9d\u8cf4\u65bc\u5c08\u7528\u670d\u52d9\u8a2a\u554f\u901a\u9053\u7684\u670d\u52d9\u6642\uff0c\u60a8\u53ef\u4ee5\u5f9e\u9810\u7559\u7684 /21 \u7bc4\u570d\u5206\u914d\u5340\u57df\u7d1a /24 \u5b50\u7db2\u3002 |\n| Private Service Connect | \u6b64\u85cd\u5716\u7232\u6bcf\u500b VPC \u7db2\u7d61\u9810\u914d\u4e86\u4e00\u500b Private Service Connect \u7aef\u9ede\uff0c\u4ee5\u4fbf\u8207 Google Cloud API \u901a\u4fe1\u3002\u6b64\u7aef\u9ede\u5141\u8a31 VPC \u7db2\u7d61\u4e2d\u7684\u8cc7\u6e90\u8a2a\u554f Google Cloud API\uff0c\u800c\u7121\u9700\u4f9d\u8cf4\u6d41\u5411\u4e92\u806f\u7db2\u6216\u516c\u958b\u901a\u544a\u7684\u4e92\u806f\u7db2\u7bc4\u570d\u7684\u51fa\u7ad9\u6d41\u91cf\u3002                  |\n| \u57fa\u65bc\u4ee3\u7406\u7684\u8ca0\u8f09\u5747\u8861\u5668 | \u67d0\u4e9b\u985e\u578b\u7684\u61c9\u7528\u8ca0\u8f09\u5747\u8861\u5668\u8981\u6c42\u60a8\u9810\u5148\u5206\u914d\u4ee3\u7406\u5c08\u7528\u5b50\u7db2\u3002\u96d6\u7136\u85cd\u5716\u4e0d\u6703\u90e8\u7f72\u9700\u8981\u6b64\u7bc4\u570d\u7684\u61c9\u7528\u8ca0\u8f09\u5747\u8861\u5668\uff0c\u4f46\u63d0\u524d\u5206\u914d\u7bc4\u570d\u6709\u52a9\u65bc\u5728\u5de5\u4f5c\u8ca0\u8f09\u9700\u8981\u8acb\u6c42\u65b0\u5b50\u7db2\u7bc4\u570d\u4ee5\u5553\u7528\u7279\u5b9a\u8ca0\u8f09\u5747\u8861\u5668\u8cc7\u6e90\u6642\u6e1b\u5c11\u885d\u7a81\u3002                      |\n| \u6b21\u8981\u5b50\u7db2\u7bc4\u570d   | \u67d0\u4e9b\u7528\u4f8b\uff08\u4f8b\u5982\u57fa\u65bc\u5bb9\u5668\u7684\u5de5\u4f5c\u8ca0\u8f09\uff09\u9700\u8981\u6b21\u8981\u7bc4\u570d\u3002\u6b64\u85cd\u5716\u6703\u7232\u6b21\u8981\u7bc4\u570d\u5206\u914d RFC 6598 IP \u5730\u5740\u7a7a\u9593\u4e2d\u7684\u7bc4\u570d\u3002                                         |\n## \u96c6\u4e2d\u5f0f DNS \u8a2d\u7f6e\n\u5c0d\u65bc Google Cloud \u548c\u672c\u5730\u74b0\u5883\u4e4b\u9593\u7684 DNS \u89e3\u6790\uff0c\u6211\u5011\u5efa\u8b70\u60a8\u5728\u5169\u500b\u6b0a\u5a01 DNS \u7cfb\u7d71\u4e2d\u4f7f\u7528\u6df7\u5408\u65b9\u6cd5\u3002\u5728\u6b64\u65b9\u6cd5\u4e2d\uff0cCloud DNS \u6703\u8655\u7406 Google Cloud \u74b0\u5883\u7684\u6b0a\u5a01 DNS \u89e3\u6790\uff0c\u800c\u60a8\u73fe\u6709\u7684\u672c\u5730 DNS \u670d\u52d9\u5668\u6703\u8655\u7406\u672c\u5730\u8cc7\u6e90\u7684\u6b0a\u5a01 DNS \u89e3\u6790\u3002\u60a8\u7684\u672c\u5730\u74b0\u5883\u548c Google Cloud \u74b0\u5883\u901a\u904e\u8f49\u767c\u8acb\u6c42\u5728\u74b0\u5883\u4e4b\u9593\u57f7\u884c DNS \u67e5\u627e\u3002\n\u4e0b\u5716\u5c55\u793a\u4e86\u85cd\u5716\u4e2d\u4f7f\u7528\u7684\u591a\u500b VPC \u7db2\u7d61\u4e2d\u7684 DNS \u62d3\u64b2\u3002\n\u8a72\u5716\u63cf\u8ff0\u4e86\u85cd\u5716\u90e8\u7f72\u7684 DNS \u8a2d\u8a08\u7684\u4ee5\u4e0b\u7d44\u4ef6\uff1a\n- \u901a\u7528\u6587\u4ef6\u593e\u4e2d\u7684 DNS hub \u9805\u76ee\u662f\u672c\u5730\u74b0\u5883\u548c Google Cloud \u74b0\u5883\u4e4b\u9593\u7684 DNS \u4ea4\u63db\u4e2d\u5fc3\u3002DNS \u8f49\u767c\u4f7f\u7528\u5df2\u5728\u60a8\u7684\u7db2\u7d61\u62d3\u64b2\u4e2d\u914d\u7f6e\u7684\u5c08\u7528\u4e92\u9023\u5be6\u4f8b\u548c Cloud Router \u8def\u7531\u5668\u3002- \u5728\u96d9\u5171\u4eab VPC \u62d3\u64b2\u4e2d\uff0cDNS \u4e2d\u5fc3\u4f7f\u7528\u57fa\u672c\u751f\u7522\u5171\u4eab VPC \u7db2\u7d61\u3002\n- \u5728\u4e2d\u5fc3\u8f3b\u5c04\u578b\u62d3\u64b2\u4e2d\uff0cDNS \u4e2d\u5fc3\u4f7f\u7528\u57fa\u672c\u4e2d\u5fc3\u5171\u4eab VPC \u7db2\u7d61\u3002\n- \u6bcf\u500b\u5171\u4eab VPC \u7db2\u7d61\u4e2d\u7684\u670d\u52d9\u5668\u90fd\u53ef\u4ee5\u901a\u904e\u6bcf\u500b\u5171\u4eab VPC \u5bbf\u4e3b\u9805\u76ee\u4e2d\u7684 Cloud DNS \u548c DNS \u4e2d\u5fc3\u4e4b\u9593\u914d\u7f6e\u7684 [DNS \u8f49\u767c](https://cloud.google.com/dns/docs/overview?hl=zh-cn#dns-forwarding-methods) \u89e3\u6790\u5176\u4ed6\u5171\u4eab VPC \u7db2\u7d61\u4e2d\u7684 DNS \u8a18\u9304\u3002\n- \u672c\u5730\u670d\u52d9\u5668\u53ef\u4ee5\u4f7f\u7528\u5141\u8a31\u4f86\u81ea\u672c\u5730\u670d\u52d9\u5668\u7684\u67e5\u8a62\u7684 [DNS \u670d\u52d9\u5668\u653f\u7b56](https://cloud.google.com/dns/docs/best-practices?hl=zh-cn#use_dns_server_policies_to_allow_queries_from_on-premises) \u4f86\u89e3\u6790 Google Cloud \u74b0\u5883\u4e2d\u7684 DNS \u8a18\u9304\u3002\u6b64\u85cd\u5716\u5728 DNS \u4e2d\u5fc3\u914d\u7f6e\u5165\u7ad9\u670d\u52d9\u5668\u653f\u7b56\uff0c\u4ee5\u5206\u914d IP \u5730\u5740\uff0c\u800c\u672c\u5730 DNS \u670d\u52d9\u5668\u6703\u5c07\u8acb\u6c42\u8f49\u767c\u5230\u9019\u4e9b\u5730\u5740\u3002\u767c\u9001\u5230 Google Cloud \u7684\u6240\u6709 DNS \u8acb\u6c42\u90fd\u6703\u5148\u5230\u9054 DNS \u4e2d\u5fc3\uff0c\u7136\u5f8c\u8a72\u4e2d\u5fc3\u518d\u89e3\u6790\u4f86\u81ea DNS \u5c0d\u7b49\u9ad4\u7684\u8a18\u9304\u3002\n- Google Cloud \u4e2d\u7684\u670d\u52d9\u5668\u53ef\u4ee5\u4f7f\u7528\u67e5\u8a62\u672c\u5730\u670d\u52d9\u5668\u7684 [\u8f49\u767c\u5340\u57df](https://cloud.google.com/dns/docs/best-practices?hl=zh-cn#use_forwarding_zones_to_query_on-premises_servers) \u4f86\u89e3\u6790\u672c\u5730\u74b0\u5883\u4e2d\u7684 DNS \u8a18\u9304\u3002\u767c\u9001\u5230\u672c\u5730\u74b0\u5883\u7684\u6240\u6709 DNS \u8acb\u6c42\u90fd\u4f86\u81ea DNS \u4e2d\u5fc3\u3002DNS \u8acb\u6c42\u4f86\u6e90\u7232 35.199.192.0/19\u3002\n### \u9632\u706b\u7246\u653f\u7b56\nGoogle Cloud \u5177\u6709\u591a\u7a2e [\u9632\u706b\u7246\u653f\u7b56](https://cloud.google.com/firewall/docs/firewall-policies-overview?hl=zh-cn) \u985e\u578b\u3002\u5206\u5c64\u9632\u706b\u7246\u653f\u7b56\u5728\u7d44\u7e54\u6216\u6587\u4ef6\u593e\u7d1a\u5c64\u5f37\u5236\u57f7\u884c\uff0c\u5f9e\u800c\u5728\u5c64\u6b21\u7d50\u69cb\u7684\u6240\u6709\u8cc7\u6e90\u4e2d\u4e00\u81f4\u7e7c\u627f\u9632\u706b\u7246\u653f\u7b56\u898f\u5247\u3002\u6b64\u5916\uff0c\u60a8\u9084\u53ef\u4ee5\u7232\u6bcf\u500b VPC \u7db2\u7d61\u914d\u7f6e\u7db2\u7d61\u9632\u706b\u7246\u653f\u7b56\u3002\u6b64\u85cd\u5716\u517c\u5099\u9019\u4e9b\u9632\u706b\u7246\u653f\u7b56\uff0c\u53ef\u4f7f\u7528\u5206\u5c64\u9632\u706b\u7246\u653f\u7b56\u5728\u6240\u6709\u74b0\u5883\u4e2d\u5f37\u5236\u57f7\u884c\u901a\u7528\u914d\u7f6e\uff0c\u4f7f\u7528\u7db2\u7d61\u9632\u706b\u7246\u653f\u7b56\u5728\u6bcf\u500b VPC \u7db2\u7d61\u4e0a\u5f37\u5236\u57f7\u884c\u66f4\u5177\u9ad4\u7684\u914d\u7f6e\u3002\n\u6b64\u85cd\u5716\u4e0d\u4f7f\u7528 [\u820a\u7248 VPC \u9632\u706b\u7246\u898f\u5247](https://cloud.google.com/firewall/docs/firewalls?hl=zh-cn) \u3002\u6211\u5011\u5efa\u8b70\u50c5\u4f7f\u7528\u9632\u706b\u7246\u653f\u7b56\uff0c\u5f9e\u800c\u907f\u514d\u8207\u820a\u7248 VPC \u9632\u706b\u7246\u898f\u5247\u6df7\u7528\u3002\n### \u5206\u5c64\u9632\u706b\u7246\u653f\u7b56\n\u6b64\u85cd\u5716\u5b9a\u7fa9\u4e86\u4e00\u500b [\u5206\u5c64\u9632\u706b\u7246\u653f\u7b56](https://cloud.google.com/firewall/docs/firewall-policies?hl=zh-cn) \uff0c\u4e26\u5c07\u8a72\u653f\u7b56\u9644\u52a0\u5230\u6bcf\u500b\u751f\u7522\u3001\u975e\u751f\u7522\u3001\u958b\u767c\u3001\u5f15\u5c0e\u548c\u901a\u7528\u6587\u4ef6\u593e\u3002\u6b64\u5206\u5c64\u9632\u706b\u7246\u653f\u7b56\u5305\u542b\u61c9\u5728\u6240\u6709\u74b0\u5883\u4e2d\u5ee3\u6cdb\u5f37\u5236\u57f7\u884c\u7684\u898f\u5247\uff0c\u4e26\u5c07\u66f4\u7cbe\u7d30\u898f\u5247\u7684\u8a55\u4f30\u59d4\u8a17\u7d66\u6bcf\u500b\u74b0\u5883\u7684\u7db2\u7d61\u9632\u706b\u7246\u653f\u7b56\u3002\n\u4e0b\u8868\u4ecb\u7d39\u4e86\u6b64\u85cd\u5716\u90e8\u7f72\u7684\u5206\u5c64\u9632\u706b\u7246\u653f\u7b56\u898f\u5247\u3002\n| \u898f\u5247\u8aaa\u660e             | \u6d41\u91cf\u65b9\u5411 | \u904e\u6ffe\u689d\u4ef6\uff08IPv4 \u7bc4\u570d\uff09           | \u5354\u8b70\u548c\u7aef\u53e3 | \u64cd\u4f5c  |\n|:-----------------------------------------------------------|:-----------|:----------------------------------------------------------------|:-------------|:-----------|\n| \u5c07\u4f86\u81ea RFC 1918 \u7684\u5165\u7ad9\u6d41\u91cf\u8a55\u4f30\u59d4\u8a17\u7d66\u5c64\u6b21\u7d50\u69cb\u4e2d\u7684\u8f03\u4f4e\u7d1a\u5c64\u3002 | Ingress | 192.168.0.0/16\u300110.0.0.0/8\u3001172.16.0.0/12      | all   | Go to next |\n| \u5c07\u6d41\u5411 RFC 1918 \u7684\u51fa\u7ad9\u6d41\u91cf\u8a55\u4f30\u59d4\u8a17\u7d66\u5c64\u6b21\u7d50\u69cb\u4e2d\u7684\u8f03\u4f4e\u7d1a\u5c64\u3002 | Egress  | 192.168.0.0/16\u300110.0.0.0/8\u3001172.16.0.0/12      | all   | Go to next |\n| \u4f7f\u7528 IAP \u9032\u884c TCP \u8f49\u767c          | Ingress | 35.235.240.0/20             | tcp:22,3390 | Allow  |\n| Windows \u670d\u52d9\u5668\u6fc0\u6d3b           | Egress  | 35.190.247.13/32            | tcp:1688  | Allow  |\n| Cloud Load Balancing \u5065\u5eb7\u6aa2\u67e5        | Ingress | 130.211.0.0/22\u300135.191.0.0/16\u3001209.85.152.0/22\u3001209.85.204.0/22 | tcp:80,443 | Allow  |\n### \u7db2\u7d61\u9632\u706b\u7246\u653f\u7b56\n\u6b64\u85cd\u5716\u7232\u6bcf\u500b\u7db2\u7d61\u914d\u7f6e\u4e00\u500b [\u7db2\u7d61\u9632\u706b\u7246\u653f\u7b56](https://cloud.google.com/vpc/docs/network-firewall-policies?hl=zh-cn) \u3002\u6bcf\u9805\u7db2\u7d61\u9632\u706b\u7246\u653f\u7b56\u958b\u59cb\u6642\u90fd\u662f\u4e00\u7d44\u6700\u4f4e\u6b0a\u9650\u898f\u5247\uff0c\u9019\u4e9b\u898f\u5247\u5141\u8a31\u8a2a\u554f Google Cloud \u670d\u52d9\u4e26\u62d2\u7d55\u6d41\u5411\u6240\u6709\u5176\u4ed6 IP \u5730\u5740\u7684\u51fa\u7ad9\u6d41\u91cf\u3002\n\u5728\u4e2d\u5fc3\u8f3b\u5c04\u578b\u6a21\u578b\u4e2d\uff0c\u7db2\u7d61\u9632\u706b\u7246\u653f\u7b56\u5305\u542b\u5141\u8a31 spoke \u4e4b\u9593\u901a\u4fe1\u7684\u984d\u5916\u898f\u5247\u3002\u7db2\u7d61\u9632\u706b\u7246\u653f\u7b56\u5141\u8a31\u5f9e\u4e00\u500b spoke \u5230 hub \u6216\u5176\u4ed6 spoke \u7684\u51fa\u7ad9\u6d41\u91cf\uff0c\u4e26\u5141\u8a31\u4f86\u81ea hub \u7db2\u7d61\u4e2d\u7684 NVA \u7684\u5165\u7ad9\u6d41\u91cf\u3002\n\u4e0b\u8868\u4ecb\u7d39\u4e86\u85cd\u5716\u4e2d\u7232\u6bcf\u500b VPC \u7db2\u7d61\u90e8\u7f72\u7684\u5168\u7403\u7db2\u7d61\u9632\u706b\u7246\u653f\u7b56\u4e2d\u7684\u898f\u5247\u3002\n| \u898f\u5247\u8aaa\u660e                 | \u6d41\u91cf\u65b9\u5411 | \u904e\u6ffe\u689d\u4ef6                      | \u5354\u8b70\u548c\u7aef\u53e3 |\n|:--------------------------------------------------------------------------|:-----------|:---------------------------------------------------------------------------------------------|:-------------|\n| \u5141\u8a31\u6d41\u5411 Google Cloud API \u7684\u51fa\u7ad9\u6d41\u91cf\u3002         | Egress  | \u7232\u6bcf\u500b\u7db2\u7d61\u914d\u7f6e\u7684 Private Service Connect \u7aef\u9ede\u3002\u8acb\u53c3\u95b1 Google API \u5c08\u7528\u8a2a\u554f\u901a\u9053\u3002    | tcp:443  |\n| \u62d2\u7d55\u5176\u4ed6\u898f\u5247\u4e0d\u5339\u914d\u7684\u51fa\u7ad9\u6d41\u91cf\u3002           | Egress  | \u5168\u90e8                       | all   |\n| \u5141\u8a31\u5f9e\u4e00\u500b spoke \u6d41\u5411\u53e6\u4e00\u500b spoke \u7684\u51fa\u7ad9\u6d41\u91cf\uff08\u50c5\u9069\u7528\u65bc\u4e2d\u5fc3\u8f3b\u5c04\u578b\u6a21\u578b\uff09\u3002 | Egress  | \u4e2d\u5fc3\u8f3b\u5c04\u578b\u62d3\u64b2\u4e2d\u4f7f\u7528\u7684\u6240\u6709 IP \u5730\u5740\u7684\u805a\u5408\u3002\u96e2\u958b spoke VPC \u7684\u6d41\u91cf\u6703\u5148\u8def\u7531\u5230 hub \u7db2\u7d61\u4e2d\u7684 NVA\u3002 | all   |\n| \u5141\u8a31\u5f9e hub \u7db2\u7d61\u4e2d\u7684 NVA \u6d41\u5411 spoke \u7684\u5165\u7ad9\u6d41\u91cf\uff08\u50c5\u9069\u7528\u65bc\u4e2d\u5fc3\u8f3b\u5c04\u578b\u6a21\u578b\uff09\u3002 | Ingress | \u6e90\u81ea hub \u7db2\u7d61\u4e2d\u7684 NVA \u7684\u6d41\u91cf\u3002                | all   |\n\u9996\u6b21\u90e8\u7f72\u85cd\u5716\u6642\uff0cVPC \u7db2\u7d61\u4e2d\u7684\u865b\u64ec\u6a5f\u5be6\u4f8b\u53ef\u4ee5\u8207 Google Cloud \u670d\u52d9\u901a\u4fe1\uff0c\u4f46\u4e0d\u80fd\u8207\u540c\u4e00 VPC \u7db2\u7d61\u4e2d\u7684\u5176\u4ed6\u57fa\u790e\u67b6\u69cb\u8cc7\u6e90\u901a\u4fe1\u3002\u5982\u9700\u5141\u8a31\u865b\u64ec\u6a5f\u5be6\u4f8b\u9032\u884c\u901a\u4fe1\uff0c\u60a8\u5fc5\u9808\u5411\u7db2\u7d61\u9632\u706b\u7246\u653f\u7b56\u6dfb\u52a0\u984d\u5916\u7684\u898f\u5247\u4e26\u6dfb\u52a0\u660e\u78ba\u5141\u8a31\u865b\u64ec\u6a5f\u5be6\u4f8b\u901a\u4fe1\u7684 [\u6a19\u8a18](https://cloud.google.com/resource-manager/docs/tags/tags-overview?hl=zh-cn) \u3002\u6a19\u8a18\u6703\u6dfb\u52a0\u5230\u865b\u64ec\u6a5f\u5be6\u4f8b\uff0c\u7cfb\u7d71\u6703\u91dd\u5c0d\u9019\u4e9b\u6a19\u8a18\u8a55\u4f30\u6d41\u91cf\u3002\u6b64\u5916\uff0c\u6a19\u8a18\u9084\u5177\u6709 IAM \u63a7\u4ef6\uff0c\u56e0\u6b64\u60a8\u53ef\u4ee5\u96c6\u4e2d\u5b9a\u7fa9\u5b83\u5011\u4e26\u5c07\u5176\u4f7f\u7528\u59d4\u8a17\u7d66\u5176\u4ed6\u5718\u968a\u3002\n**\u6ce8\u610f** \uff1a\u672c\u6587\u6a94\u4e2d\u5c0d\u6a19\u8a18\u7684\u6240\u6709\u5f15\u7528\u5747\u5f15\u7528 [\u5177\u6709 IAM \u63a7\u4ef6\u7684\u6a19\u8a18](https://cloud.google.com/resource-manager/docs/tags/tags-overview?hl=zh-cn) \u3002\u6211\u5011\u4e0d\u5efa\u8b70\u4f7f\u7528\u5177\u6709 [\u820a\u7248\u7db2\u7d61\u6a19\u8a18](https://cloud.google.com/vpc/docs/add-remove-network-tags?hl=zh-cn) \u7684 VPC \u9632\u706b\u7246\u898f\u5247\u3002\n\u4e0b\u5716\u8209\u4f8b\u8aaa\u660e\u4e86\u5982\u4f55\u6dfb\u52a0\u81ea\u5b9a\u7fa9\u6a19\u8a18\u548c\u7db2\u7d61\u9632\u706b\u7246\u653f\u7b56\u898f\u5247\uff0c\u4ee5\u5141\u8a31\u5de5\u4f5c\u8ca0\u8f09\u5728 VPC \u7db2\u7d61\u5167\u9032\u884c\u901a\u4fe1\u3002\n\u4e0b\u5716\u6f14\u793a\u4e86\u6b64\u793a\u4f8b\u7684\u4ee5\u4e0b\u6982\u5ff5\uff1a\n- \u7db2\u7d61\u9632\u706b\u7246\u653f\u7b56\u5305\u542b\u898f\u5247 1\uff0c\u8a72\u898f\u5247\u62d2\u7d55\u4f86\u81ea\u6240\u6709\u4f86\u6e90\u7684\u51fa\u7ad9\u6d41\u91cf\uff08\u512a\u5148\u7d1a\u7232 65530\uff09\u3002\n- \u7db2\u7d61\u9632\u706b\u7246\u653f\u7b56\u5305\u542b\u898f\u5247 2\uff0c\u8a72\u898f\u5247\u5141\u8a31\u5165\u7ad9\u6d41\u91cf\u5f9e\u5177\u6709`service=frontend`\u6a19\u8a18\u7684\u5be6\u4f8b\u9032\u5165\u5177\u6709`service=backend`\u6a19\u8a18\u7684\u5be6\u4f8b\uff0c\u512a\u5148\u7d1a\u7232 999\u3002\n- instance-2 \u865b\u64ec\u6a5f\u53ef\u4ee5\u63a5\u6536\u4f86\u81ea instance-1 \u7684\u6d41\u91cf\uff0c\u56e0\u7232\u8a72\u6d41\u91cf\u8207\u898f\u5247 2 \u5141\u8a31\u7684\u6a19\u8a18\u5339\u914d\u3002\u6839\u64da\u512a\u5148\u7d1a\u503c\u8a55\u4f30\u5728\u898f\u5247 1 \u524d\u5339\u914d\u7684\u898f\u5247 2\u3002\n- instance-3 \u865b\u64ec\u6a5f\u4e0d\u63a5\u6536\u6d41\u91cf\u3002\u552f\u4e00\u8207\u6b64\u6d41\u91cf\u5339\u914d\u7684\u9632\u706b\u7246\u653f\u7b56\u898f\u5247\u662f\u898f\u5247 1\uff0c\u56e0\u6b64\u4f86\u81ea instance-1 \u7684\u51fa\u7ad9\u6d41\u91cf\u6703\u88ab\u62d2\u7d55\u3002## Google Cloud API \u7684\u5c08\u7528\u8a2a\u554f\u901a\u9053\n\u5982\u9700\u8b93 VPC \u7db2\u7d61\u6216\u672c\u5730\u74b0\u5883\u4e2d\u7684\u8cc7\u6e90\u8a2a\u554f Google Cloud \u670d\u52d9\uff0c\u6211\u5011\u5efa\u8b70\u4f7f\u7528\u5c08\u7528\u9023\u63a5\uff0c\u800c\u4e0d\u662f\u5230\u516c\u5171 API \u7aef\u9ede\u7684\u51fa\u7ad9\u4e92\u806f\u7db2\u6d41\u91cf\u3002\u6b64\u85cd\u5716\u5728\u6bcf\u500b\u5b50\u7db2\u4e0a\u914d\u7f6e [\u5c08\u7528 Google \u8a2a\u554f\u901a\u9053](https://cloud.google.com/vpc/docs/private-google-access?hl=zh-cn) \uff0c\u4e26\u4f7f\u7528 [Private Service Connect](https://cloud.google.com/vpc/docs/about-accessing-google-apis-endpoints?hl=zh-cn) \u5275\u5efa\u5167\u90e8\u7aef\u9ede\u4ee5\u8207 Google Cloud \u670d\u52d9\u901a\u4fe1\u3002\u901a\u904e\u7d9c\u5408\u5229\u7528\u9019\u4e9b\u63a7\u5236\u63aa\u65bd\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528\u5c08\u7528\u8def\u5f91\u9023\u63a5 Google Cloud \u670d\u52d9\uff0c\u800c\u7121\u9700\u4f9d\u8cf4\u4e92\u806f\u7db2\u51fa\u7ad9\u6d41\u91cf\u6216\u516c\u958b\u901a\u544a\u7684\u4e92\u806f\u7db2\u7bc4\u570d\u3002\n\u6b64\u85cd\u5716\u4f7f\u7528 [API \u8edf\u4ef6\u5305](https://cloud.google.com/vpc/docs/about-accessing-google-apis-endpoints?hl=zh-cn#supported-apis) \u914d\u7f6e Private Service Connect \u7aef\u9ede\uff0c\u4ee5\u5340\u5206\u53ef\u4ee5\u5728\u54ea\u500b\u7db2\u7d61\u4e2d\u8a2a\u554f\u54ea\u4e9b\u670d\u52d9\u3002\u57fa\u672c\u7db2\u7d61\u4f7f\u7528 `all-apis` \u8edf\u4ef6\u5305\uff0c\u53ef\u4ee5\u8a2a\u554f\u4efb\u4f55 Google \u670d\u52d9\uff0c\u800c\u53d7\u9650\u7db2\u7d61\u4f7f\u7528 `vpcsc` \u8edf\u4ef6\u5305\uff0c\u53ef\u4ee5\u8a2a\u554f [\u652f\u6301 VPC Service Controls](https://cloud.google.com/vpc-service-controls/docs/supported-products?hl=zh-cn) \u7684\u4e00\u7d44\u6709\u9650\u670d\u52d9\u3002\n\u5982\u9700\u5f9e\u672c\u5730\u74b0\u5883\u4e2d\u7684\u4e3b\u6a5f\u9032\u884c\u8a2a\u554f\uff0c\u6211\u5011\u5efa\u8b70\u60a8\u5c0d\u6bcf\u500b\u7aef\u9ede\u4f7f\u7528\u81ea\u5b9a\u7fa9 FQDN \u6163\u4f8b\uff0c\u5982\u4e0b\u8868\u6240\u793a\u3002\u6b64\u85cd\u5716\u5c0d\u6bcf\u500b VPC \u7db2\u7d61\u4f7f\u7528\u552f\u4e00\u7684 Private Service Connect \u7aef\u9ede\uff0c\u9019\u4e9b\u7aef\u9ede\u914d\u7f6e\u7232\u8a2a\u554f\u4e00\u7d44\u4e0d\u540c\u7684 API \u8edf\u4ef6\u5305\u3002\u56e0\u6b64\uff0c\u60a8\u5fc5\u9808\u8003\u616e\u5982\u4f55\u5c07\u670d\u52d9\u6d41\u91cf\u5f9e\u672c\u5730\u74b0\u5883\u8def\u7531\u5230\u5177\u6709\u6b63\u78ba API \u7aef\u9ede\u7684 VPC \u7db2\u7d61\uff0c\u4e26\u4e14\u5982\u679c\u60a8\u4f7f\u7528\u7684\u662f VPC Service Controls\uff0c\u8acb\u78ba\u4fdd\u6d41\u5411 Google Cloud \u670d\u52d9\u7684\u6d41\u91cf\u5230\u9054\u9810\u671f\u908a\u754c\u5167\u7684\u7aef\u9ede\u3002\u7232 DNS\u3001\u9632\u706b\u7246\u548c\u8def\u7531\u5668\u914d\u7f6e\u672c\u5730\u63a7\u5236\u4ee5\u5141\u8a31\u8a2a\u554f\u9019\u4e9b\u7aef\u9ede\uff0c\u4e26\u5c07\u672c\u5730\u4e3b\u6a5f\u914d\u7f6e\u7232\u4f7f\u7528\u9069\u7576\u7684\u7aef\u9ede\u3002\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [\u901a\u904e\u7aef\u9ede\u8a2a\u554f Google API](https://cloud.google.com/vpc/docs/configure-private-service-connect-apis?hl=zh-cn#on-premises) \u3002\n\u4e0b\u8868\u4ecb\u7d39\u4e86\u7232\u6bcf\u500b\u7db2\u7d61\u5275\u5efa\u7684 Private Service Connect \u7aef\u9ede\u3002\n| VPC | \u74b0\u5883 | API \u8edf\u4ef6\u5305 | Private Service Connect \u7aef\u9ede IP \u5730\u5740 | Private Service Connect \u7aef\u9ede IP \u5730\u5740.1 | Private Service Connect \u7aef\u9ede IP \u5730\u5740.2 | \u81ea\u5b9a\u7fa9 FQDN     | \u81ea\u5b9a\u7fa9 FQDN.1    | \u81ea\u5b9a\u7fa9 FQDN.2    |\n|:------|:-------|:-------------|:---------------------------------------|:-----------------------------------------|:-----------------------------------------|:----------------------------|:----------------------------|:----------------------------|\n| \u57fa\u672c | \u901a\u7528 | all-apis  | 10.17.0.1/32       | 10.17.0.1/32        | 10.17.0.1/32        | c.private.googleapis.com | c.private.googleapis.com | c.private.googleapis.com |\n| \u57fa\u672c | \u958b\u767c | all-apis  | 10.17.0.2/32       | 10.17.0.2/32        | 10.17.0.2/32        | d.private.googleapis.com | d.private.googleapis.com | d.private.googleapis.com |\n| \u57fa\u672c | \u975e\u751f\u7522 | all-apis  | 10.17.0.3/32       | 10.17.0.3/32        | 10.17.0.3/32        | n.private.googleapis.com | n.private.googleapis.com | n.private.googleapis.com |\n| \u57fa\u672c | \u751f\u7522 | all-apis  | 10.17.0.4/32       | 10.17.0.4/32        | 10.17.0.4/32        | p.private.googleapis.com | p.private.googleapis.com | p.private.googleapis.com |\n| \u53d7\u9650 | \u901a\u7528 | vpcsc  | 10.17.0.5/32       | 10.17.0.5/32        | 10.17.0.5/32        | c.restricted.googleapis.com | c.restricted.googleapis.com | c.restricted.googleapis.com |\n| \u53d7\u9650 | \u958b\u767c | vpcsc  | 10.17.0.6/32       | 10.17.0.6/32        | 10.17.0.6/32        | d.restricted.googleapis.com | d.restricted.googleapis.com | d.restricted.googleapis.com |\n| \u53d7\u9650 | \u975e\u751f\u7522 | vpcsc  | 10.17.0.7/32       | 10.17.0.7/32        | 10.17.0.7/32        | n.restricted.googleapis.com | n.restricted.googleapis.com | n.restricted.googleapis.com |\n| \u53d7\u9650 | \u751f\u7522 | vpcsc  | 10.17.0.8/32       | 10.17.0.8/32        | 10.17.0.8/32        | p.restricted.googleapis.com | p.restricted.googleapis.com | p.restricted.googleapis.com |\n\u7232\u78ba\u4fdd Google Cloud \u670d\u52d9\u7684\u6d41\u91cf\u901a\u904e DNS \u67e5\u627e\u9032\u5165\u6b63\u78ba\u7aef\u9ede\uff0c\u6b64\u85cd\u5716\u6703\u7232\u6bcf\u500b VPC \u7db2\u7d61\u914d\u7f6e\u5c08\u7528 DNS \u5340\u57df\u3002\u4e0b\u8868\u4ecb\u7d39\u4e86\u9019\u4e9b\u5c08\u7528 DNS \u5340\u57df\u3002\n| \u5c08\u7528\u5340\u57df\u540d\u7a31 | DNS \u540d\u7a31                   | \u8a18\u9304\u985e\u578b | \u6578\u64da                     |\n|:----------------|:-----------------------------------------------------------------------------------|:-----------|:-------------------------------------------------------------------------------------|\n| googleapis.com. | *.googleapis.com.                 | CNAME  | private.googleapis.com.\uff08\u91dd\u5c0d\u57fa\u672c\u7db2\u7d61\uff09\u6216 restricted.googleapis.com.\uff08\u91dd\u5c0d\u53d7\u9650\u7db2\u7d61\uff09 |\n| googleapis.com. | private.googleapis.com\uff08\u91dd\u5c0d\u57fa\u672c\u7db2\u7d61\uff09\u6216 restricted.googleapis.com\uff08\u91dd\u5c0d\u53d7\u9650\u7db2\u7d61\uff09 | A   | \u8a72 VPC \u7db2\u7d61\u7684 Private Service Connect \u7aef\u9ede IP \u5730\u5740\u3002         |\n| gcr.io.   | *.gcr.io                   | CNAME  | gcr.io.                    |\n| gcr.io.   | gcr.io                    | A   | \u8a72 VPC \u7db2\u7d61\u7684 Private Service Connect \u7aef\u9ede IP \u5730\u5740\u3002         |\n| pkg.dev.  | *.pkg.dev.                   | CNAME  | pkg.dev.                    |\n| pkg.dev.  | pkg.dev.                   | A   | \u8a72 VPC \u7db2\u7d61\u7684 Private Service Connect \u7aef\u9ede IP \u5730\u5740\u3002         |\n\u6b64\u85cd\u5716\u5177\u6709\u984d\u5916\u7684\u914d\u7f6e\uff0c\u53ef\u5f37\u5236\u4e00\u81f4\u4f7f\u7528\u9019\u4e9b Private Service Connect \u7aef\u9ede\u3002\u6bcf\u500b\u5171\u4eab VPC \u7db2\u7d61\u9084\u6703\u5f37\u5236\u57f7\u884c\u4ee5\u4e0b\u653f\u7b56\uff1a\n- \u5141\u8a31\u51fa\u7ad9\u6d41\u91cf\u5f9e\u6240\u6709\u4f86\u6e90\u6d41\u5411 TCP 443 \u4e0a Private Service Connect \u7aef\u9ede\u7684 IP \u5730\u5740\u7684\u7db2\u7d61\u9632\u706b\u7246\u653f\u7b56\u898f\u5247\u3002\n- \u62d2\u7d55\u51fa\u7ad9\u6d41\u91cf\u6d41\u5411 0.0.0.0/0\uff08\u5305\u62ec\u7528\u65bc\u8a2a\u554f Google Cloud \u670d\u52d9\u7684 [\u9ed8\u8a8d\u7db2\u57df](https://cloud.google.com/vpc/docs/configure-private-google-access?hl=zh-cn#domain-options) \uff09\u7684\u7db2\u7d61\u9632\u706b\u7246\u653f\u7b56\u898f\u5247\u3002## \u4e92\u806f\u7db2\u9023\u63a5\n\u6b64\u85cd\u5716\u4e0d\u5141\u8a31\u5176 VPC \u7db2\u7d61\u8207\u4e92\u806f\u7db2\u4e4b\u9593\u7684\u5165\u7ad9\u6216\u51fa\u7ad9\u6d41\u91cf\u3002\u5c0d\u65bc\u9700\u8981\u4e92\u806f\u7db2\u9023\u63a5\u7684\u5de5\u4f5c\u8ca0\u8f09\uff0c\u60a8\u5fc5\u9808\u57f7\u884c\u984d\u5916\u6b65\u9a5f\u4f86\u8a2d\u8a08\u6240\u9700\u7684\u8a2a\u554f\u8def\u5f91\u3002\n\u5c0d\u65bc\u9700\u8981\u51fa\u7ad9\u6d41\u91cf\u9032\u5165\u4e92\u806f\u7db2\u7684\u5de5\u4f5c\u8ca0\u8f09\uff0c\u6211\u5011\u5efa\u8b70\u60a8\u901a\u904e [Cloud NAT](https://cloud.google.com/nat/docs/overview?hl=zh-cn) \u7ba1\u7406\u51fa\u7ad9\u6d41\u91cf\uff0c\u4ee5\u5728\u7121\u4e3b\u52d5\u767c\u9001\u7684\u5165\u7ad9\u9023\u63a5\u7684\u60c5\u6cc1\u4e0b\u5141\u8a31\u51fa\u7ad9\u6d41\u91cf\uff0c\u6216\u8005\u901a\u904e [\u5b89\u5168 Web \u4ee3\u7406](https://cloud.google.com/secure-web-proxy/docs/overview?hl=zh-cn) \u7ba1\u7406\u51fa\u7ad9\u6d41\u91cf\uff0c\u4ee5\u5be6\u73fe\u66f4\u7cbe\u7d30\u7684\u63a7\u5236\uff0c\u5f9e\u800c\u50c5\u5141\u8a31\u51fa\u7ad9\u6d41\u91cf\u6d41\u5411\u53ef\u4fe1 Web \u670d\u52d9\u3002\n\u5c0d\u65bc\u9700\u8981\u5f9e\u4e92\u806f\u7db2\u50b3\u5165\u5165\u7ad9\u6d41\u91cf\u7684\u5de5\u4f5c\u8ca0\u8f09\uff0c\u6211\u5011\u5efa\u8b70\u60a8\u4f7f\u7528 [Cloud Load Balancing](https://cloud.google.com/load-balancing/docs/https?hl=zh-cn) \u548c [Google Cloud Armor](https://cloud.google.com/armor/docs/cloud-armor-overview?hl=zh-cn) \u8a2d\u8a08\u5de5\u4f5c\u8ca0\u8f09\u4ee5\u53d7\u76ca\u65bc DDoS \u548c WAF \u4fdd\u8b77\u3002\n\u6211\u5011\u4e0d\u5efa\u8b70\u60a8\u8a2d\u8a08\u5141\u8a31\u5728\u865b\u64ec\u6a5f\u4e0a\u4f7f\u7528\u5916\u90e8 IP \u5730\u5740\u5728\u4e92\u806f\u7db2\u8207\u865b\u64ec\u6a5f\u4e4b\u9593\u76f4\u63a5\u9023\u63a5\u7684\u5de5\u4f5c\u8ca0\u8f09\u3002\n## \u672c\u5730\u74b0\u5883\u8207 Google Cloud \u4e4b\u9593\u7684\u6df7\u5408\u9023\u63a5\n\u5982\u9700\u5728\u672c\u5730\u74b0\u5883\u8207 Google Cloud \u4e4b\u9593\u5efa\u7acb\u9023\u63a5\uff0c\u6211\u5011\u5efa\u8b70\u60a8\u4f7f\u7528 [\u5c08\u7528\u4e92\u9023](https://cloud.google.com/interconnect/docs/concepts/dedicated-overview?hl=zh-cn) \u4f86\u6700\u5927\u9650\u5ea6\u5730\u63d0\u9ad8\u5b89\u5168\u6027\u548c\u53ef\u9760\u6027\u3002\u5c08\u7528\u4e92\u9023\u9023\u63a5\u662f\u672c\u5730\u7db2\u7d61\u8207 Google Cloud \u4e4b\u9593\u7684\u76f4\u63a5\u93c8\u63a5\u3002\n\u4e0b\u5716\u5c55\u793a\u4e86\u672c\u5730\u74b0\u5883\u8207 Google Virtual Private Cloud \u7db2\u7d61\u4e4b\u9593\u7684\u6df7\u5408\u9023\u63a5\u3002\n\u8a72\u5716\u63cf\u8ff0\u4e86\u6a21\u5f0f\u7684\u4ee5\u4e0b\u7d44\u4ef6\uff0c\u4ee5\u5be6\u73fe [\u5c08\u7528\u4e92\u9023\u7684 99.99% \u53ef\u7528\u6027](https://cloud.google.com/interconnect/docs/tutorials/dedicated-creating-9999-availability?hl=zh-cn) \uff1a\n- \u56db\u500b\u5c08\u7528\u4e92\u9023\u9023\u63a5\uff0c\u5176\u4e2d\u5169\u500b\u9023\u63a5\u5728\u4e00\u500b\u90fd\u5e02\u5340\uff08\u90fd\u5e02\u5708\uff09\uff0c\u5169\u500b\u9023\u63a5\u5728\u53e6\u4e00\u500b\u90fd\u5e02\u5708\u3002\n- \u9023\u63a5\u5206\u7232\u5169\u5c0d\uff0c\u6bcf\u5c0d\u5747\u9023\u63a5\u5230\u55ae\u7368\u7684\u672c\u5730\u6578\u64da\u4e2d\u5fc3\u3002\n- [VLAN \u9023\u63a5](https://cloud.google.com/interconnect/docs/how-to/dedicated/creating-vlan-attachments?hl=zh-cn) \u7528\u65bc\u5c07\u6bcf\u500b\u5c08\u7528\u4e92\u9023\u5be6\u4f8b\u9023\u63a5\u5230\u5171\u4eab VPC \u62d3\u64b2\u9644\u52a0\u7684 [Cloud Router \u8def\u7531\u5668](https://cloud.google.com/network-connectivity/docs/router/concepts/overview?hl=zh-cn) \u3002\u9019\u4e9b VLAN \u9023\u63a5\u8a17\u7ba1\u5728`prj-c-interconnect`\u9805\u76ee\u4e2d\u3002\n- \u6bcf\u500b\u5171\u4eab VPC \u7db2\u7d61\u90fd\u6709\u56db\u500b Cloud Router \u8def\u7531\u5668\uff0c\u6bcf\u500b\u5340\u57df\u5169\u500b\uff0c\u4e26\u4e14\u52d5\u614b\u8def\u7531\u6a21\u5f0f\u8a2d\u7f6e\u7232`global`\uff0c\u4ee5\u4fbf\u6bcf\u500b Cloud Router \u8def\u7531\u5668\u53ef\u4ee5\u901a\u544a\u6240\u6709\u5b50\u7db2\uff08\u7121\u8ad6\u5340\u57df\u5982\u4f55\uff09\u3002\n\u901a\u904e\u5168\u5c40\u52d5\u614b\u8def\u7531\uff0cCloud Router \u8def\u7531\u5668\u5411 VPC \u7db2\u7d61\u4e2d\u7684\u6240\u6709\u5b50\u7db2\u901a\u544a\u8def\u7531\u3002Cloud Router \u8def\u7531\u5668\u5411\u9060\u7a0b\u5b50\u7db2\uff08Cloud Router \u8def\u7531\u5668\u5340\u57df\u4ee5\u5916\u7684\u5b50\u7db2\uff09\u901a\u544a\u8def\u7531\u6240\u63a1\u7528\u7684\u512a\u5148\u7d1a\uff0c\u4f4e\u65bc\u5411\u672c\u5730\u5b50\u7db2\uff08\u4f4d\u65bc Cloud Router \u8def\u7531\u5668\u5340\u57df\u7684\u5b50\u7db2\uff09\u901a\u544a\u7684\u512a\u5148\u7d1a\u3002\uff08\u53ef\u9078\uff09\u5728\u7232 Cloud Router \u8def\u7531\u5668\u914d\u7f6e BGP \u6703\u8a71\u6642\uff0c\u60a8\u53ef\u4ee5\u66f4\u6539 [\u901a\u544a\u7684\u524d\u7db4\u548c\u512a\u5148\u7d1a](https://cloud.google.com/network-connectivity/docs/router/concepts/overview?hl=zh-cn#advertised-prefixes-and-priorities) \u3002\n\u5f9e Google Cloud \u5230\u672c\u5730\u74b0\u5883\u7684\u6d41\u91cf\u4f7f\u7528\u6700\u9760\u8fd1\u96f2\u8cc7\u6e90\u7684 Cloud Router \u8def\u7531\u5668\u3002\u5728\u4e00\u500b\u5340\u57df\u5167\uff0c\u591a\u500b\u5230\u672c\u5730\u7db2\u7d61\u7684\u8def\u7531\u5177\u6709\u76f8\u540c\u7684\u591a\u51fa\u53e3\u5224\u5225\u5668 (MED) \u503c\uff0cGoogle Cloud \u4f7f\u7528 [\u7b49\u6210\u672c\u591a\u8def\u5f91 (ECMP)](https://en.wikipedia.org/wiki/Equal-cost_multi-path_routing) \u5728\u6240\u6709\u53ef\u80fd\u7684\u8def\u7531\u4e4b\u9593\u5206\u914d\u51fa\u7ad9\u6d41\u91cf\u3002\n## \u672c\u5730\u914d\u7f6e\u66f4\u6539\n\u8981\u914d\u7f6e\u672c\u5730\u74b0\u5883\u8207 Google Cloud \u4e4b\u9593\u7684\u9023\u63a5\uff0c\u60a8\u5fc5\u9808\u5728\u672c\u5730\u74b0\u5883\u4e2d\u914d\u7f6e\u5176\u4ed6\u66f4\u6539\u3002\u6b64\u85cd\u5716\u4e2d\u7684 Terraform \u4ee3\u78bc\u6703\u81ea\u52d5\u914d\u7f6e Google Cloud \u8cc7\u6e90\uff0c\u4f46\u4e0d\u6703\u4fee\u6539\u4efb\u4f55\u672c\u5730\u7db2\u7d61\u8cc7\u6e90\u3002\n\u6b64\u85cd\u5716\u6703\u81ea\u52d5\u5553\u7528\u67d0\u4e9b\u5f9e\u672c\u5730\u74b0\u5883\u5230 Google Cloud \u7684\u6df7\u5408\u9023\u63a5\u7684\u7d44\u4ef6\uff0c\u5305\u62ec\uff1a\n- Cloud DNS \u914d\u7f6e\u4e86\u5728\u6240\u6709\u5171\u4eab VPC \u7db2\u7d61\u548c\u55ae\u500b hub \u4e4b\u9593\u7684 DNS \u8f49\u767c\uff0c\u5982 [DNS \u8a2d\u7f6e](#dns-setup) \u4e2d\u6240\u8ff0\u3002Cloud DNS \u670d\u52d9\u5668\u653f\u7b56\u914d\u7f6e\u4e86 [\u5165\u7ad9\u8f49\u767c\u5668 IP \u5730\u5740](https://cloud.google.com/dns/docs/policies?hl=zh-cn#list-in-entrypoints) \u3002\n- Cloud Router \u8def\u7531\u5668\u7d93\u904e\u914d\u7f6e\uff0c\u53ef\u7232 Private Service Connect \u7aef\u9ede\u4f7f\u7528\u7684 IP \u5730\u5740\u5c0e\u51fa\u6240\u6709\u5b50\u7db2\u7684\u8def\u7531\u548c\u81ea\u5b9a\u7fa9\u8def\u7531\u3002\n\u5982\u9700\u5553\u7528\u6df7\u5408\u9023\u63a5\uff0c\u60a8\u5fc5\u9808\u57f7\u884c\u4ee5\u4e0b\u984d\u5916\u6b65\u9a5f\uff1a\n- [\u8a02\u8cfc\u5c08\u7528\u4e92\u9023\u9023\u63a5](https://cloud.google.com/network-connectivity/docs/interconnect/how-to/dedicated/ordering-dedicated-interconnect?hl=zh-cn) \u3002\n- \u914d\u7f6e\u672c\u5730\u8def\u7531\u5668\u548c\u9632\u706b\u7246\u4ee5\u5141\u8a31\u51fa\u7ad9\u6d41\u91cf\u9032\u5165 [IP \u5730\u5740\u7a7a\u9593\u5206\u914d](#ip-address-allocation) \u4e2d\u5b9a\u7fa9\u7684\u5167\u90e8 IP \u5730\u5740\u7a7a\u9593\u3002\n- \u914d\u7f6e\u672c\u5730 DNS \u670d\u52d9\u5668\uff0c\u4ee5\u5c07\u767c\u5f80 Google Cloud \u7684 DNS \u67e5\u627e\u8f49\u767c\u5230\u5df2\u7531\u85cd\u5716\u914d\u7f6e\u7684 [\u5165\u7ad9\u8f49\u767c\u5668 IP \u5730\u5740](https://cloud.google.com/dns/docs/policies?hl=zh-cn#list-in-entrypoints) \u3002\n- \u914d\u7f6e\u672c\u5730 DNS \u670d\u52d9\u5668\u3001\u9632\u706b\u7246\u548c\u8def\u7531\u5668\u4ee5\u63a5\u53d7\u4f86\u81ea Cloud DNS [\u8f49\u767c\u5340\u57df](https://cloud.google.com/dns/docs/zones/forwarding-zones?hl=zh-cn) (35.199.192.0/19) \u7684 DNS \u67e5\u8a62\u3002\n- \u914d\u7f6e\u672c\u5730 DNS \u670d\u52d9\u5668\uff0c\u4ee5\u4f7f\u7528 [Cloud API \u7684\u5c08\u7528\u8a2a\u554f\u901a\u9053](#private-access-to-google-cloud-apis) \u4e2d\u5b9a\u7fa9\u7684 IP \u5730\u5740\u97ff\u61c9\u5f9e\u672c\u5730\u4e3b\u6a5f\u5230 Google Cloud \u670d\u52d9\u7684\u67e5\u8a62\u3002\n- \u5c0d\u65bc\u901a\u904e\u5c08\u7528\u4e92\u9023\u9023\u63a5\u9032\u884c\u7684\u50b3\u8f38\u52a0\u5bc6\uff0c\u8acb\u914d\u7f6e [MACsec for Cloud Interconnect](https://cloud.google.com/network-connectivity/docs/interconnect/concepts/macsec-overview?hl=zh-cn) \u6216\u914d\u7f6e [\u901a\u904e Cloud Interconnect \u5be6\u73fe\u7684\u9ad8\u53ef\u7528\u6027 VPN](https://cloud.google.com/network-connectivity/docs/interconnect/concepts/ha-vpn-interconnect?hl=zh-cn) \u4ee5\u5be6\u73fe IPsec \u52a0\u5bc6\u3002\n\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [\u7232\u672c\u5730\u4e3b\u6a5f\u914d\u7f6e\u5c08\u7528 Google \u8a2a\u554f\u901a\u9053](https://cloud.google.com/vpc/docs/configure-private-google-access-hybrid?hl=zh-cn) \u3002\n## \u5f8c\u7e8c\u6b65\u9a5f\n- \u77ad\u89e3 [\u6aa2\u6e2c\u63a7\u5236\u63aa\u65bd](https://cloud.google.com/architecture/security-foundations/detective-controls?hl=zh-cn) \uff08\u672c\u7cfb\u5217\u7684\u4e0b\u4e00\u500b\u6587\u6a94\uff09\u3002", "guide": "Docs"}