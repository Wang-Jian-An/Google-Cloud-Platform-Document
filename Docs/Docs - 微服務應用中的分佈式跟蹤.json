{"title": "Docs - \u5fae\u670d\u52d9\u61c9\u7528\u4e2d\u7684\u5206\u4f48\u5f0f\u8ddf\u8e64", "url": "https://cloud.google.com/architecture/microservices-architecture-distributed-tracing?hl=zh-cn", "abstract": "# Docs - \u5fae\u670d\u52d9\u61c9\u7528\u4e2d\u7684\u5206\u4f48\u5f0f\u8ddf\u8e64\n\u672c\u6587\u6a94\u662f\u95dc\u65bc\u8a2d\u8a08\u3001\u69cb\u5efa\u548c\u90e8\u7f72\u5fae\u670d\u52d9\u7684\u56db\u7bc7\u7cfb\u5217\u6587\u7ae0\u4e2d\u7684\u7b2c\u56db\u7bc7\u3002\u672c\u7cfb\u5217\u6587\u7ae0\u4ecb\u7d39\u5fae\u670d\u52d9\u67b6\u69cb\u7684\u5404\u7a2e\u5143\u7d20\u3002\u8a72\u7cfb\u5217\u4ecb\u7d39\u4e86\u5fae\u670d\u52d9\u67b6\u69cb\u6a21\u5f0f\u7684\u512a\u7f3a\u9ede\u53ca\u5176\u61c9\u7528\u65b9\u5f0f\u3002- [\u5fae\u670d\u52d9\u7c21\u4ecb](https://cloud.google.com/architecture/microservices-architecture-introduction?hl=zh-cn) \n- [\u5c07\u55ae\u9ad4\u5f0f\u61c9\u7528\u91cd\u69cb\u7232\u5fae\u670d\u52d9](https://cloud.google.com/architecture/microservices-architecture-refactoring-monoliths?hl=zh-cn) \n- [\u5fae\u670d\u52d9\u8a2d\u7f6e\u4e2d\u7684\u670d\u52d9\u9593\u901a\u4fe1](https://cloud.google.com/architecture/microservices-architecture-interservice-communication?hl=zh-cn) \n- \u5fae\u670d\u52d9\u61c9\u7528\u4e2d\u7684\u5206\u4f48\u5f0f\u8ddf\u8e64\uff08\u672c\u6587\u6a94\uff09\n\u672c\u7cfb\u5217\u6587\u7ae0\u9762\u5411\u8a2d\u8a08\u548c\u5be6\u65bd\u9077\u79fb\u4ee5\u5c07\u55ae\u9ad4\u5f0f\u61c9\u7528\u91cd\u69cb\u7232\u5fae\u670d\u52d9\u61c9\u7528\u7684\u61c9\u7528\u958b\u767c\u8005\u548c\u67b6\u69cb\u5e2b\u3002\n\u5728\u5206\u4f48\u5f0f\u7cfb\u7d71\u4e2d\uff0c\u8acb\u52d9\u5fc5\u77ad\u89e3\u8acb\u6c42\u5982\u4f55\u5f9e\u4e00\u9805\u670d\u52d9\u6d41\u5411\u53e6\u4e00\u9805\u670d\u52d9\uff0c\u4ee5\u53ca\u6bcf\u9805\u670d\u52d9\u4e2d\u57f7\u884c\u4efb\u52d9\u6240\u9700\u7684\u6642\u9593\u3002\u8003\u616e\u60a8\u5728\u4e0a\u4e00\u500b\u6587\u6a94\u4e2d\u90e8\u7f72\u7684\u57fa\u65bc\u5fae\u670d\u52d9\u7684 Online Boutique \u61c9\u7528\uff0c [\u5c07\u55ae\u9ad4\u5f0f\u61c9\u7528\u91cd\u69cb\u7232\u5fae\u670d\u52d9](https://cloud.google.com/architecture/microservices-architecture-refactoring-monoliths?hl=zh-cn) \u3002\u61c9\u7528\u7531\u591a\u9805\u670d\u52d9\u7d44\u6210\u3002\u4f8b\u5982\uff0c\u4e0b\u9762\u7684\u5c4f\u5e55\u622a\u5716\u986f\u793a\u4e86\u5546\u54c1\u8a73\u60c5\u9801\u9762\uff0c\u8a72\u9801\u9762\u5f9e\u524d\u7aef\u3001\u63a8\u85a6\u548c\u5ee3\u544a\u670d\u52d9\u4e2d\u63d0\u53d6\u4fe1\u606f\u3002\u7232\u4e86\u5448\u73fe\u5546\u54c1\u8a73\u60c5\u9801\u9762\uff0c\u524d\u7aef\u670d\u52d9\u6703\u8207\u63a8\u85a6\u670d\u52d9\u548c\u5ee3\u544a\u670d\u52d9\u9032\u884c\u901a\u4fe1\uff0c\u5982\u4e0b\u5716\u6240\u793a\uff1a\n \n **\u5716 1.** \u4f7f\u7528\u4e0d\u540c\u8a9e\u8a00\u7de8\u5beb\u7684\u670d\u52d9\u3002\n\u5728\u5716 1 \u4e2d\uff0c\u524d\u7aef\u670d\u52d9\u662f\u4f7f\u7528 Go \u7de8\u5beb\u7684\u3002\u4ee5 Python \u7de8\u5beb\u7684\u63a8\u85a6\u670d\u52d9\u4f7f\u7528 gRPC \u8207\u524d\u7aef\u670d\u52d9\u9032\u884c\u901a\u4fe1\u3002\u4ee5 Java \u7de8\u5beb\u7684\u5ee3\u544a\u670d\u52d9\u4e5f\u4f7f\u7528 gRPC \u8207\u524d\u7aef\u670d\u52d9\u9032\u884c\u901a\u4fe1\u3002\u9664\u4e86 gRPC \u4e4b\u5916\uff0c\u670d\u52d9\u9593\u901a\u4fe1\u65b9\u6cd5\u4e5f\u53ef\u4ee5\u4f7f\u7528 REST HTTP\u3002\n\u5728\u69cb\u5efa\u6b64\u985e\u5206\u4f48\u5f0f\u7cfb\u7d71\u6642\uff0c\u60a8\u5e0c\u671b\u53ef\u89c0\u6e2c\u6027\u5de5\u5177\u63d0\u4f9b\u4ee5\u4e0b\u6578\u64da\u5206\u6790\uff1a- \u8acb\u6c42\u5b8c\u6210\u7684\u670d\u52d9\u3002\n- \u8acb\u6c42\u7de9\u6162\u6642\u767c\u751f\u7684\u60c5\u6cc1\u3002\n- \u8acb\u6c42\u5931\u6557\u6642\u767c\u751f\u932f\u8aa4\u7684\u4f4d\u7f6e\u3002\n- \u8acb\u6c42\u7684\u57f7\u884c\u65b9\u5f0f\u8207\u7cfb\u7d71\u7684\u6b63\u5e38\u884c\u7232\u6709\u4f55\u4e0d\u540c\u3002\n- \u8acb\u6c42\u57f7\u884c\u60c5\u6cc1\u8207\u6027\u80fd\u662f\u5426\u76f8\u95dc\uff08\u67d0\u4e9b\u670d\u52d9\u8abf\u7528\u82b1\u8cbb\u7684\u6642\u9593\u662f\u5426\u9577\u6216\u77ed\uff09\u3002\n", "content": "## \u76ee\u6a19\n- \u4f7f\u7528 kustomize \u6e05\u55ae\u6587\u4ef6\u8a2d\u7f6e\u57fa\u790e\u67b6\u69cb\u3002\n- \u5c07 Online Boutique \u793a\u4f8b\u61c9\u7528\u90e8\u7f72\u5230 Google Kubernetes Engine (GKE)\u3002\n- \u4f7f\u7528 Cloud Trace \u67e5\u770b\u793a\u4f8b\u61c9\u7528\u4e2d\u7684\u7528\u6236\u6b77\u7a0b\u3002\n## \u8cbb\u7528\nTitles in dynamic includes are not used anywhere, and we should avoid paying to translate them\u5728\u672c\u6587\u6a94\u4e2d\uff0c\u60a8\u5c07\u4f7f\u7528 Google Cloud \u7684\u4ee5\u4e0b\u6536\u8cbb\u7d44\u4ef6\uff1a- [GKE](https://cloud.google.com/kubernetes-engine/pricing?hl=zh-cn) \n- [Cloud SQL](https://cloud.google.com/sql/pricing?hl=zh-cn) \n- [Container Registry](https://cloud.google.com/container-registry/pricing?hl=zh-cn) \n- [Cloud Trace](https://cloud.google.com/stackdriver/pricing?hl=zh-cn) \n\u60a8\u53ef\u4f7f\u7528 [\u50f9\u683c\u8a08\u7b97\u5668](https://cloud.google.com/products/calculator?hl=zh-cn) \u6839\u64da\u60a8\u7684\u9810\u8a08\u4f7f\u7528\u60c5\u6cc1\u4f86\u4f30\u7b97\u8cbb\u7528\u3002 \n\u5b8c\u6210\u672c\u6587\u6a94\u5f8c\uff0c\u60a8\u53ef\u4ee5\u522a\u9664\u6240\u5275\u5efa\u7684\u8cc7\u6e90\u4ee5\u907f\u514d\u7e7c\u7e8c\u8a08\u8cbb\u3002\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [\u6e05\u7406](#clean-up) \u3002## \u6e96\u5099\u5de5\u4f5c\u5982\u679c\u60a8\u5df2\u7d93\u901a\u904e\u5b8c\u6210\u672c\u7cfb\u5217\u4e2d\u7684\u524d\u4e00\u500b\u6587\u6a94\u4f86\u8a2d\u7f6e\u9805\u76ee\uff0c\u5247 [\u5fae\u670d\u52d9\u8a2d\u7f6e\u4e2d\u7684\u670d\u52d9\u9593\u901a\u4fe1](https://cloud.google.com/architecture/microservices-architecture-interservice-communication?hl=zh-cn) \u53ef\u4ee5\u91cd\u8907\u4f7f\u7528\u8a72\u9805\u76ee\u3002\u5b8c\u6210\u4ee5\u4e0b\u6b65\u9a5f\u4ee5\u5553\u7528\u5176\u4ed6 API \u4e26\u8a2d\u7f6e\u74b0\u5883\u8b8a\u91cf\u3002- Titles in dynamic includes are not used anywhere, and we should avoid paying to translate them\u5728 Google Cloud Console \u4e2d\u7684\u9805\u76ee\u9078\u64c7\u5668\u9801\u9762\u4e0a\uff0c\u9078\u64c7\u6216 [\u5275\u5efa\u4e00\u500b Google Cloud \u9805\u76ee](https://cloud.google.com/resource-manager/docs/creating-managing-projects?hl=zh-cn) \u3002 [\u8f49\u5230\u201c\u9805\u76ee\u9078\u64c7\u5668\u201d](https://console.cloud.google.com/projectselector2/home/dashboard?hl=zh-cn) \n- Titles in dynamic includes are not used anywhere, and we should avoid paying to translate them [\u78ba\u4fdd\u60a8\u7684 Google Cloud \u9805\u76ee\u5df2\u5553\u7528\u7d50\u7b97\u529f\u80fd](https://cloud.google.com/billing/docs/how-to/verify-billing-enabled?hl=zh-cn#console) \u3002\n- Titles in dynamic includes are not used anywhere, and we should avoid paying to translate them\u5728 Google Cloud \u63a7\u5236\u6aaf\u4e2d\uff0c\u6fc0\u6d3b Cloud Shell\u3002 [\u6fc0\u6d3b Cloud Shell](https://console.cloud.google.com/?cloudshell=true&hl=zh-cn) \n- \u5553\u7528\u9069\u7528\u65bc Compute Engine\u3001GKE\u3001Cloud SQL\u3001Artifact Analysis\u3001Trace \u548c Container Registry \u7684 API\uff1a```\n\u00a0gcloud services enable \\\u00a0 \u00a0compute.googleapis.com \\\u00a0 \u00a0sql-component.googleapis.com \\\u00a0 \u00a0servicenetworking.googleapis.com\\\u00a0 \u00a0container.googleapis.com \\\u00a0 \u00a0containeranalysis.googleapis.com \\\u00a0 \u00a0containerregistry.googleapis.com \\\u00a0 \u00a0sqladmin.googleapis.com\n```\n## \u5206\u4f48\u5f0f\u8ddf\u8e64\u5206\u4f48\u5f0f\u8ddf\u8e64\u8a18\u9304\u6703\u5c07\u4e0a\u4e0b\u6587\u5143\u6578\u64da\u9644\u52a0\u5230\u6bcf\u500b\u8acb\u6c42\uff0c\u4e26\u78ba\u4fdd\u5143\u6578\u64da\u5728\u8acb\u6c42\u4e4b\u9593\u5171\u4eab\u3002\u60a8\u53ef\u4ee5\u4f7f\u7528\u8ddf\u8e64\u9ede\u4f86\u6aa2\u6e2c\u5206\u4f48\u5f0f\u8ddf\u8e64\u8a18\u9304\u3002\u4f8b\u5982\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528\u5169\u500b\u8ddf\u8e64\u8a18\u9304\u9ede\u5c0d\u670d\u52d9\uff08\u524d\u7aef\u3001\u63a8\u85a6\u548c\u5ee3\u544a\uff09\u9032\u884c\u63d2\u6a01\uff0c\u4ee5\u8655\u7406\u67e5\u770b\u8acb\u6c42\u8a73\u60c5\u7684\u5ba2\u6236\u7aef\u8acb\u6c42\uff1a\u4e00\u500b\u7528\u65bc\u767c\u9001\u8acb\u6c42\u7684\u8ddf\u8e64\u8a18\u9304\u9ede\uff0c\u53e6\u4e00\u500b\u8ddf\u8e64\u8a18\u9304\u63a5\u6536\u97ff\u61c9\u3002\u4e0b\u5716\u5c55\u793a\u4e86\u6b64\u8ddf\u8e64\u9ede\u63d2\u6a01\u7684\u5de5\u4f5c\u539f\u7406\uff1a **\u5716 2** \uff1a\u6bcf\u500b\u670d\u52d9\u9593\u8abf\u7528\u90fd\u6709\u5169\u500b\u8ddf\u8e64\u9ede\uff0c\u7531\u4e00\u500b\u8acb\u6c42-\u97ff\u61c9\u5c0d\u7d44\u6210\u3002\n\u7232\u4e86\u8ddf\u8e64\u8ddf\u8e64\u8a18\u9304\u9ede\uff0c\u77ad\u89e3\u5728\u8abf\u7528\u670d\u52d9\u6642\u8981\u57f7\u884c\u54ea\u500b\u8acb\u6c42\uff0c\u539f\u59cb\u670d\u52d9\u6703\u5728\u57f7\u884c\u6d41\u4e2d\u50b3\u905e\u4e00\u500b\u8ddf\u8e64\u8a18\u9304 ID \u3002\u50b3\u905e\u8ddf\u8e64 ID \u7684\u904e\u7a0b\u7a31\u7232\u201c\u5143\u6578\u64da\u50b3\u64ad\u201d\u6216\u201c\u5206\u4f48\u5f0f\u4e0a\u4e0b\u6587\u50b3\u64ad\u201d\u3002 \u7576\u5206\u4f48\u5f0f\u61c9\u7528\u7684\u670d\u52d9\u5728\u57f7\u884c\u7d66\u5b9a\u8acb\u6c42\u671f\u9593\u76f8\u4e92\u901a\u4fe1\u6642\uff0c\u4e0a\u4e0b\u6587\u50b3\u64ad\u901a\u904e\u7db2\u7d61\u8abf\u7528\u50b3\u8f38\u5143\u6578\u64da\u3002\u4e0b\u5716\u986f\u793a\u4e86\u5143\u6578\u64da\u50b3\u64ad\uff1a **\u5716 3.** \u8ddf\u8e64\u8a18\u9304\u5143\u6578\u64da\u5728\u670d\u52d9\u4e4b\u9593\u50b3\u905e\u3002\u5143\u6578\u64da\u5305\u62ec\u4e00\u4e9b\u670d\u52d9\u7684\u4fe1\u606f\uff0c\u4f8b\u5982\u8abf\u7528\u54ea\u9805\u670d\u52d9\u53ca\u5176\u6642\u9593\u6233\u3002\n\u5728 Online Boutique \u793a\u4f8b\u4e2d\uff0c\u7576\u7528\u6236\u767c\u9001\u521d\u59cb\u8acb\u6c42\u4ee5\u63d0\u53d6\u7522\u54c1\u8a73\u60c5\u6642\uff0c\u8ddf\u8e64\u8a18\u9304\u5373\u6703\u958b\u59cb\u3002\u7cfb\u7d71\u6703\u751f\u6210\u4e00\u500b\u65b0\u7684\u8ddf\u8e64\u8a18\u9304 ID\uff0c\u6bcf\u500b\u5f8c\u7e8c\u8acb\u6c42\u90fd\u6703\u4f7f\u7528\u5305\u542b\u539f\u59cb\u5143\u6578\u64da\u76f8\u95dc\u4e0a\u4e0b\u6587\u7684\u6a19\u982d\u9032\u884c\u4fee\u98fe\u3002\n\u7232\u5b8c\u6210\u6700\u7d42\u7528\u6236\u8acb\u6c42\u800c\u8abf\u7528\u7684\u6bcf\u500b\u55ae\u7368\u64cd\u4f5c\u7a31\u7232 \u3002\u767c\u8d77\u670d\u52d9\u6a19\u8a18\u6bcf\u500b span \u90fd\u6709\u81ea\u5df1\u7684\u552f\u4e00 span \u548c\u7236\u7d1a span \u7684\u8ddf\u8e64\u8a18\u9304 ID\u3002\u4e0b\u5716\u5c55\u793a\u4e86\u8ddf\u8e64\u8a18\u9304\u7684\u7518\u7279\u5716\u53ef\u8996\u5316\u5167\u5bb9\uff1a **\u5716 4.** \u7236 span \u5305\u542b\u5b50 span \u7684\u97ff\u61c9\u6642\u9593\u3002\n\u5716 4 \u986f\u793a\u4e86\u8ddf\u8e64\u6a39\uff0c\u5176\u4e2d\u524d\u7aef\u670d\u52d9\u8abf\u7528\u63a8\u85a6\u670d\u52d9\u548c\u5ee3\u544a\u670d\u52d9\u3002\u524d\u7aef\u670d\u52d9\u662f\u7236\u7d1a span\uff0c\u7528\u65bc\u63cf\u8ff0\u6700\u7d42\u7528\u6236\u89c0\u5bdf\u5230\u7684\u97ff\u61c9\u6642\u9593\u3002\u5b50\u7d1a span \u4ecb\u7d39\u4e86\u63a8\u85a6\u670d\u52d9\u548c\u5ee3\u544a\u670d\u52d9\u7684\u8abf\u7528\u548c\u97ff\u61c9\u65b9\u5f0f\uff0c\u5305\u62ec\u97ff\u61c9\u6642\u9593\u4fe1\u606f\u3002\n\u50cf [Istio](https://istio.io/) \u9019\u6a23\u7684\u670d\u52d9\u7db2\u683c\u652f\u6301\u5c0d\u670d\u52d9\u5230\u670d\u52d9\u6d41\u91cf\u9032\u884c\u5206\u4f48\u5f0f\u8ddf\u8e64\uff0c\u800c\u7121\u9700\u4efb\u4f55\u5c08\u7528\u7684\u63d2\u6a01\u3002\u4f46\u5728\u67d0\u4e9b\u60c5\u6cc1\u4e0b\uff0c\u60a8\u53ef\u80fd\u9700\u8981\u66f4\u597d\u5730\u63a7\u5236\u8ddf\u8e64\u8a18\u9304\uff0c\u6216\u8005\u53ef\u80fd\u9700\u8981\u8ddf\u8e64\u672a\u5728\u670d\u52d9\u7db2\u683c\u4e2d\u904b\u884c\u7684\u4ee3\u78bc\u3002\n\u672c\u6587\u6a94\u4f7f\u7528 [OpenTelemetry](https://opentelemetry.io/) \u5c0d\u5206\u4f48\u5f0f\u5fae\u670d\u52d9\u61c9\u7528\u9032\u884c\u63d2\u6a01\uff0c\u4ee5\u6536\u96c6\u8ddf\u8e64\u8a18\u9304\u548c\u6307\u6a19\u3002OpenTelemetry \u53ef\u8b93\u60a8\u6536\u96c6\u6307\u6a19\u548c\u8ddf\u8e64\u8a18\u9304\uff0c\u7136\u5f8c\u5c07\u5176\u5c0e\u51fa\u5230 [\u5f8c\u7aef](https://opentelemetry.io/docs/instrumentation/js/exporters/) \uff0c\u5982 Prometheus\u3001Cloud Monitoring\u3001Datadog\u3001Graphite\u3001Zipkin \u548c Jaager\u3002## \u4f7f\u7528 OpenTelemetry \u9032\u884c\u63d2\u6a01\u4ee5\u4e0b\u90e8\u5206\u4ecb\u7d39\u77ad\u5982\u4f55\u4f7f\u7528\u4e0a\u4e0b\u6587\u50b3\u64ad\u4f86\u5141\u8a31\u5c07\u591a\u500b\u8acb\u6c42\u7684 span \u9644\u52a0\u5230\u55ae\u500b\u7236\u7d1a\u8ddf\u8e64\u8a18\u9304\u3002\n\u672c\u793a\u4f8b\u4f7f\u7528 OpenTelemetry [JavaScript](https://opentelemetry.io/docs/instrumentation/js/) \u3001 [Python](https://opentelemetry.io/docs/instrumentation/python/getting-started/) \u548c [Go](https://opentelemetry.io/docs/instrumentation/go/getting-started/) \u5eab\u5c0d\u4ed8\u6b3e\u3001\u63a8\u85a6\u548c\u524d\u7aef\u670d\u52d9\u7684\u8ddf\u8e64\u8a18\u9304\u5be6\u73fe\u9032\u884c\u63d2\u6a01\u3002\u6839\u64da\u63d2\u6a01\u7684\u8a73\u7d30\u7a0b\u5ea6\uff0c\u8ddf\u8e64\u6578\u64da\u53ef\u80fd\u6703\u5f71\u97ff\u9805\u76ee\u7684\u8cbb\u7528\uff08Cloud Trace \u7d50\u7b97\uff09\u3002\u7232\u4e86\u7de9\u89e3\u8cbb\u7528\u554f\u984c\uff0c\u5927\u591a\u6578\u8ddf\u8e64\u7cfb\u7d71\u90fd\u63a1\u7528\u5404\u7a2e\u5f62\u5f0f\u7684\u63a1\u6a23\uff0c\u50c5\u6355\u7372\u7279\u5b9a\u767e\u5206\u6bd4\u7684\u89c0\u5bdf\u5230\u8ddf\u8e64\u8a18\u9304\u3002\u5728\u751f\u7522\u74b0\u5883\u4e2d\uff0c\u60a8\u7684\u7d44\u7e54\u53ef\u80fd\u56e0\u7232\u5404\u7a2e\u539f\u56e0\u800c\u78ba\u5b9a\u60f3\u8981\u63a1\u6a23\u7684\u5167\u5bb9\u548c\u7406\u7531\u3002\u60a8\u53ef\u80fd\u5e0c\u671b\u6839\u64da\u7ba1\u7406\u8cbb\u7528\u3001\u95dc\u6ce8\u611f\u8208\u8da3\u7684\u8ddf\u8e64\u8a18\u9304\u6216\u904e\u6ffe\u6389\u566a\u8072\u4f86\u81ea\u5b9a\u7fa9\u63a1\u6a23\u7b56\u7565\u3002\u5982\u9700\u8a73\u7d30\u77ad\u89e3\u63a1\u6a23\uff0c\u8acb\u53c3\u95b1 [OpenTelemetry \u63a1\u6a23](https://opentelemetry.io/docs/concepts/sampling/) \u3002\n\u672c\u6587\u6a94\u4f7f\u7528 [Trace](https://cloud.google.com/trace?hl=zh-cn) \u76f4\u89c0\u5448\u73fe\u5206\u4f48\u5f0f\u8ddf\u8e64\u8a18\u9304\u3002\u60a8\u53ef\u4f7f\u7528 OpenTelemetry \u5c0e\u51fa\u5668\u5c07\u8ddf\u8e64\u8a18\u9304\u767c\u9001\u5230 Trace\u3002\n### \u8a3b\u518a\u8ddf\u8e64\u8a18\u9304\u5c0e\u51fa\u5668\u672c\u90e8\u5206\u4ecb\u7d39\u5982\u4f55\u901a\u904e\u5411\u5fae\u670d\u52d9\u4ee3\u78bc\u6dfb\u52a0\u884c\u4f86\u5728\u6bcf\u500b\u670d\u52d9\u4e2d\u8a3b\u518a\u8ddf\u8e64\u8a18\u9304\u5c0e\u51fa\u5668\u3002\n\u5c0d\u65bc\u524d\u7aef\u670d\u52d9\uff08\u7528 Go \u7de8\u5beb\uff09\uff0c\u4ee5\u4e0b [\u4ee3\u78bc\u793a\u4f8b](https://github.com/GoogleCloudPlatform/microservices-demo/blob/e3722eb82897361f3be80bd2dc238cb2afa9b399/src/frontend/main.go#L165C1-L179C16) \u6703\u8a3b\u518a\u5c0e\u51fa\u5668\uff1a\n```\n[...]\nexporter, err := otlptracegrpc.New(\n  ctx,\n  otlptracegrpc.WithGRPCConn(svc.collectorConn))\n if err != nil {\n  log.Warnf(\"warn: Failed to create trace exporter: %v\", err)\n }\ntp := sdktrace.NewTracerProvider(\n  sdktrace.WithBatcher(exporter),\n  sdktrace.WithSampler(sdktrace.AlwaysSample()))\n otel.SetTracerProvider(tp)\n```\n\u5c0d\u65bc\u63a8\u85a6\u670d\u52d9\uff08\u7528 Python \u7de8\u5beb\uff09\uff0c\u4ee5\u4e0b [\u4ee3\u78bc\u793a\u4f8b](https://github.com/GoogleCloudPlatform/microservices-demo/blob/e3722eb82897361f3be80bd2dc238cb2afa9b399/src/recommendationservice/recommendation_server.py#L111-L121) \u6703\u8a3b\u518a\u5c0e\u51fa\u5668\uff1a\n```\nif os.environ[\"ENABLE_TRACING\"] == \"1\":\n trace.set_tracer_provider(TracerProvider())\n otel_endpoint = os.getenv(\"COLLECTOR_SERVICE_ADDR\", \"localhost:4317\")\n trace.get_tracer_provider().add_span_processor(\n  BatchSpanProcessor(\n   OTLPSpanExporter(\n   endpoint = otel_endpoint,\n   insecure = True\n   )\n  )\n )\n```\n\u5c0d\u65bc\u4ed8\u6b3e\u670d\u52d9\uff08\u7528 JavaScript \u7de8\u5beb\uff09\uff0c\u4ee5\u4e0b [\u4ee3\u78bc\u793a\u4f8b](https://github.com/GoogleCloudPlatform/microservices-demo/blob/e3722eb82897361f3be80bd2dc238cb2afa9b399/src/paymentservice/index.js#L42-L51) \u6703\u8a3b\u518a\u5c0e\u51fa\u5668\uff1a\n```\nprovider.addSpanProcessor(new SimpleSpanProcessor(new OTLPTraceExporter({url: collectorUrl})));\nprovider.register();\n```\n### \u8a2d\u7f6e\u4e0a\u4e0b\u6587\u50b3\u64ad\u8ddf\u8e64\u7cfb\u7d71\u9700\u8981\u9075\u5faa [\u8ddf\u8e64\u4e0a\u4e0b\u6587\u898f\u7bc4](https://www.w3.org/TR/trace-context/) \uff0c\u8a72\u898f\u7bc4\u5b9a\u7fa9\u4e86\u5728\u670d\u52d9\u4e4b\u9593\u50b3\u64ad\u8ddf\u8e64\u4e0a\u4e0b\u6587\u7684\u683c\u5f0f\u3002\u50b3\u64ad\u683c\u5f0f\u793a\u4f8b\u5305\u62ec [Zipkin B3 \u683c\u5f0f](https://github.com/openzipkin/b3-propagation) \u548c [X-Google-Cloud-Trace](https://cloud.google.com/trace/docs/setup?hl=zh-cn) \u3002\nOpenTelemetry \u4f7f\u7528\u5168\u5c40 `TextMapPropagator` \u50b3\u64ad\u4e0a\u4e0b\u6587\u3002\u672c\u793a\u4f8b\u4f7f\u7528\u8ddf\u8e64\u8a18\u9304\u4e0a\u4e0b\u6587\u50b3\u64ad\u5668\uff0c\u8a72\u50b3\u64ad\u5668\u4f7f\u7528 [W3C traceparent \u683c\u5f0f](https://www.w3.org/TR/trace-context/#trace-context-http-headers-format) \u3002\u63d2\u6a01\u5eab\uff08\u4f8b\u5982 OpenTelemetry \u7684 HTTP \u548c gRPC \u5eab\uff09\u4f7f\u7528\u5168\u5c40\u50b3\u64ad\u5668\u5c07\u8ddf\u8e64\u8a18\u9304\u4e0a\u4e0b\u6587\u4f5c\u7232\u5143\u6578\u64da\u6dfb\u52a0\u5230 HTTP \u6216 gRPC \u8acb\u6c42\u3002\u5982\u9700\u4f7f\u4e0a\u4e0b\u6587\u50b3\u64ad\u6210\u529f\uff0c\u5ba2\u6236\u7aef\u548c\u670d\u52d9\u5668\u5fc5\u9808\u4f7f\u7528\u76f8\u540c\u7684\u50b3\u64ad\u683c\u5f0f\u3002\n### \u901a\u904e HTTP \u50b3\u64ad\u4e0a\u4e0b\u6587\u524d\u7aef\u670d\u52d9\u6703\u5c07\u8ddf\u8e64\u8a18\u9304\u4e0a\u4e0b\u6587\u6ce8\u5165\u5230 HTTP \u8acb\u6c42\u6a19\u982d\u4e2d\u3002\u5f8c\u7aef\u670d\u52d9\u6703\u63d0\u53d6\u8ddf\u8e64\u8a18\u9304\u4e0a\u4e0b\u6587\u3002\u4ee5\u4e0b [\u4ee3\u78bc\u793a\u4f8b](https://github.com/GoogleCloudPlatform/microservices-demo/blob/e3722eb82897361f3be80bd2dc238cb2afa9b399/src/frontend/main.go#L99-L110) \u5c55\u793a\u77ad\u5982\u4f55\u5c0d\u524d\u7aef\u670d\u52d9\u9032\u884c\u63d2\u6a01\u4ee5\u914d\u7f6e\u8ddf\u8e64\u8a18\u9304\u4e0a\u4e0b\u6587\uff1a\n```\notel.SetTextMapPropagator(\n propagation.NewCompositeTextMapPropagator(\n  propagation.TraceContext{}, propagation.Baggage{}))\nif os.Getenv(\"ENABLE_TRACING\") == \"1\" {\n log.Info(\"Tracing enabled.\")\n initTracing(log, ctx, svc)\n} else {\n log.Info(\"Tracing disabled.\")\n}\n...\nvar handler http.Handler = r\nhandler = &logHandler{log: log, next: handler}  // add logging\nhandler = ensureSessionID(handler)     // add session ID\nhandler = otelhttp.NewHandler(handler, \"frontend\") // add OpenTelemetry tracing\n```\n### \u901a\u904e gRPC \u9032\u884c\u4e0a\u4e0b\u6587\u50b3\u64ad\u8003\u616e\u7d50\u8cec\u670d\u52d9\u6839\u64da\u7528\u6236\u9078\u64c7\u7684\u5546\u54c1\u4e0b\u8a02\u55ae\u7684\u6d41\u7a0b\u3002\u9019\u4e9b\u670d\u52d9\u901a\u904e gRPC \u9032\u884c\u901a\u4fe1\u3002\n\u4ee5\u4e0b [\u4ee3\u78bc\u793a\u4f8b](https://github.com/GoogleCloudPlatform/microservices-demo/blob/e3722eb82897361f3be80bd2dc238cb2afa9b399/src/checkoutservice/main.go#L128-L138) \u4f7f\u7528 gRPC \u8abf\u7528\u6514\u622a\u5668\uff0c\u8a72\u6514\u622a\u5668\u6703\u6514\u622a\u53bb\u96fb\u4e26\u6ce8\u5165\u8ddf\u8e64\u8a18\u9304\u4e0a\u4e0b\u6587\uff1a\n```\nvar srv *grpc.Server\n// Propagate trace context always\notel.SetTextMapPropagator(\n propagation.NewCompositeTextMapPropagator(\n  propagation.TraceContext{}, propagation.Baggage{}))\nsrv = grpc.NewServer(\n grpc.UnaryInterceptor(otelgrpc.UnaryServerInterceptor()),\n grpc.StreamInterceptor(otelgrpc.StreamServerInterceptor()),\n)\n```\n\u6536\u5230\u8acb\u6c42\u5f8c\uff0c\u4ed8\u6b3e\u6216\u7522\u54c1\u76ee\u9304\u670d\u52d9 ( `ListProducts` ) \u6703\u5f9e\u8acb\u6c42\u6a19\u982d\u4e2d\u63d0\u53d6\u4e0a\u4e0b\u6587\uff0c\u4e26\u4f7f\u7528\u7236\u8ddf\u8e64\u8a18\u9304\u5143\u6578\u64da\u4f86\u751f\u6210\u5b50 span\u3002\n\u4ee5\u4e0b\u90e8\u5206\u8a73\u7d30\u4ecb\u7d39\u77ad\u5982\u4f55\u7232\u793a\u4f8b Online Boutique \u61c9\u7528\u8a2d\u7f6e\u8a2d\u7f6e\u548c\u5be9\u8988\u5206\u4f48\u5f0f\u8ddf\u8e64\u3002## \u90e8\u7f72\u61c9\u7528\u5982\u679c\u60a8\u5df2\u6709\u904b\u884c\u5b8c\u672c\u7cfb\u5217\u6587\u6a94\uff08 [\u5fae\u670d\u52d9\u8a2d\u7f6e\u4e2d\u7684\u670d\u52d9\u9593\u901a\u4fe1](https://cloud.google.com/architecture/microservices-architecture-interservice-communication?hl=zh-cn) \uff09\u7684\u6b63\u5728\u904b\u884c\u7684\u61c9\u7528\uff0c\u5247\u53ef\u4ee5\u8df3\u5230\u4e0b\u4e00\u90e8\u5206 [\u67e5\u770b\u8ddf\u8e64\u8a18\u9304](#reviewing-traces-using-cloud-trace) \u3002\u5426\u5247\uff0c\u8acb\u5b8c\u6210\u4ee5\u4e0b\u6b65\u9a5f\u4ee5\u90e8\u7f72\u793a\u4f8b Online Boutique \u793a\u4f8b\uff1a- \u5982\u9700\u8a2d\u7f6e\u57fa\u790e\u67b6\u69cb\uff0c\u8acb\u5728 Cloud Shell \u4e2d\u514b\u9686 GitHub \u4ee3\u78bc\u5eab\uff1a```\ngit clone https://github.com/GoogleCloudPlatform/microservices-demo.git\n```\n- \u5c0d\u65bc\u65b0\u90e8\u7f72\uff0c\u8acb\u91cd\u7f6e\u74b0\u5883\u8b8a\u91cf\uff1a```\nPROJECT_ID=PROJECT_IDREGION=us-central1GSA_NAME=microservices-saGSA_EMAIL=$GSA_NAME@$PROJECT_ID.iam.gserviceaccount.com\n```\u66ff\u63db\u4ee5\u4e0b\u5167\u5bb9\uff1a- \uff1a\u9805\u76ee ID \u7684\u6a19\u8b58\u7b26\u3002\n- \u53ef\u9078\uff1a\u5275\u5efa\u65b0\u96c6\u7fa3\u6216\u91cd\u8907\u4f7f\u7528\u73fe\u6709\u96c6\u7fa3\uff08\u5982\u679c\u5b58\u5728\uff09\uff1a```\ngcloud container clusters create-auto online-boutique --project=${PROJECT_ID}\u00a0 --region=${REGION}\n```\n- \u5275\u5efa Google \u670d\u52d9\u8cec\u865f\uff1a```\ngcloud iam service-accounts create $GSA_NAME \\\u00a0 --project=$PROJECT_ID\n```\n- \u5553\u7528 API\uff1a```\ngcloud services enable \\monitoring.googleapis.com \\cloudtrace.googleapis.com \\cloudprofiler.googleapis.com \\\u00a0 --project ${PROJECT_ID}\n```\n- \u5411 GSA \u6388\u4e88 Cloud Tracing \u6240\u9700\u7684\u89d2\u8272\uff1a```\ngcloud projects add-iam-policy-binding ${PROJECT_ID} \\--member \"serviceAccount:${GSA_NAME}@${PROJECT_ID}.iam.gserviceaccount.com\" \\--role roles/cloudtrace.agentgcloud projects add-iam-policy-binding ${PROJECT_ID} \\--member \"serviceAccount:${GSA_NAME}@${PROJECT_ID}.iam.gserviceaccount.com\" \\--role roles/monitoring.metricWritergcloud projects add-iam-policy-binding ${PROJECT_ID} \\--member \"serviceAccount:${GSA_NAME}@${PROJECT_ID}.iam.gserviceaccount.com\" \\--role roles/cloudprofiler.agentgcloud iam service-accounts add-iam-policy-binding ${GSA_EMAIL} \\--role roles/iam.workloadIdentityUser \\--member \"serviceAccount:${PROJECT_ID}.svc.id.goog[default/default]\"\n```\n- \u7232\u60a8\u7684 Kubernetes \u670d\u52d9\u8cec\u865f\u6dfb\u52a0\u8a3b\u91cb\uff08\u5c0d\u65bc\u9ed8\u8a8d\u547d\u540d\u7a7a\u9593\u7232 `default` / `default` \uff09\uff0c\u4ee5\u4f7f\u7528 Google IAM \u670d\u52d9\u8cec\u865f\uff1a```\nkubectl annotate serviceaccount default \\\u00a0 \u00a0 iam.gke.io/gcp-service-account=${GSA_EMAIL}\n```\n- \u5553\u7528 Cloud Operations for GKE \u914d\u7f6e\uff1b\u9019\u6703\u5553\u7528\u8ddf\u8e64\uff1a```\ncd ~/microservices-demo/kustomize && \\kustomize edit add component components/google-cloud-operations\n```\n- \u9019\u6703\u66f4\u65b0 `kustomize` / `kustomization.yaml` \u6587\u4ef6\uff0c\u8a72\u6587\u4ef6\u53ef\u80fd\u985e\u4f3c\u65bc\u4ee5\u4e0b\u5167\u5bb9\uff1a```\napiVersion: kustomize.config.k8s.io/v1beta1\nkind: Kustomization\nresources:\n- base\ncomponents:\n- components/google-cloud-operations\n[...]\n```\n- \u90e8\u7f72\u5fae\u670d\u52d9\uff1a```\nkubectl apply -k .\n```\n- \u6aa2\u67e5\u90e8\u7f72\u7684\u72c0\u614b\uff1a```\nkubectl rollout status deployment/frontendkubectl rollout status deployment/paymentservicekubectl rollout status deployment/recommendationservicekubectl rollout status deployment/adservice\n```\u6bcf\u500b\u547d\u4ee4\u7684\u8f38\u51fa\u5982\u4e0b\u6240\u793a\uff1a```\nWaiting for deployment \"\" rollout to finish: 0 of 1 updated replicas are available...\ndeployment \"\" successfully rolled out\n```\n- \u7372\u53d6\u5df2\u90e8\u7f72\u61c9\u7528\u7684 IP \u5730\u5740\uff1a```\nkubectl get service frontend-external | awk '{print $4}'\n```\u7b49\u5f85\u8ca0\u8f09\u5747\u8861\u5668 IP \u5730\u5740\u767c\u4f48\u3002\u5982\u9700\u9000\u51fa\u547d\u4ee4\uff0c\u8acb\u6309 `Ctrl+C` \u3002\u8acb\u8a18\u4e0b\u8ca0\u8f09\u5747\u8861\u5668 IP \u5730\u5740\uff0c\u7136\u5f8c\u901a\u904e\u7db2\u5740 `http://` `` \u8a2a\u554f\u61c9\u7528\u3002\u8ca0\u8f09\u5747\u8861\u5668\u53ef\u80fd\u9700\u8981\u4e00\u6bb5\u6642\u9593\u624d\u80fd\u6062\u5fa9\u6b63\u5e38\u4e26\u958b\u59cb\u50b3\u8f38\u6d41\u91cf\u3002\n## \u4f7f\u7528 Cloud Trace \u67e5\u770b\u8ddf\u8e64\u8a18\u9304Online Boutique \u61c9\u7528\u4e2d\u7684\u7528\u6236\u8cfc\u8cb7\u6d41\u7a0b\u5177\u6709\u4ee5\u4e0b\u6d41\u7a0b\uff1a- \u7528\u6236\u5728\u7740\u9678\u9801\u4e0a\u770b\u5230\u5546\u54c1\u6e05\u55ae\u3002\n- \u7528\u6236\u53ea\u9700\u9ede\u64ca **\u8cfc\u8cb7** \u5373\u53ef\u9032\u884c\u8cfc\u8cb7\u3002\n- \u7528\u6236\u6703\u88ab\u91cd\u5b9a\u5411\u5230\u7522\u54c1\u8a73\u60c5\u9801\u9762\uff0c\u4e26\u5c07\u5546\u54c1\u6dfb\u52a0\u5230\u8cfc\u7269\u8eca\u4e2d\u3002\n- \u7528\u6236\u6703\u88ab\u91cd\u5b9a\u5411\u5230\u7d50\u7b97\u9801\u9762\uff0c\u4ed6\u5011\u53ef\u4ee5\u5728\u90a3\u88cf\u4ed8\u6b3e\u4ee5\u5b8c\u6210\u8a02\u55ae\u3002\n\u8003\u616e\u9019\u6a23\u4e00\u500b\u5834\u666f\uff0c\u60a8\u9700\u8981\u6392\u67e5\u5728\u52a0\u8f09\u5546\u54c1\u8a73\u60c5\u9801\u9762\u6642\u97ff\u61c9\u6642\u9593\u8f03\u9577\u7684\u554f\u984c\u3002\u5982\u524d\u6240\u8ff0\uff0c\u5546\u54c1\u8a73\u60c5\u9801\u9762\u7531\u591a\u500b\u5fae\u670d\u52d9\u7d44\u6210\u3002\u5982\u9700\u78ba\u5b9a\u51fa\u73fe\u9577\u6642\u9593\u5ef6\u9072\u7684\u4f4d\u7f6e\u548c\u539f\u56e0\uff0c\u60a8\u53ef\u4ee5\u67e5\u770b\u5206\u4f48\u5f0f\u8ddf\u8e64\u5716\u8868\uff0c\u4ee5\u77ad\u89e3\u6574\u500b\u8acb\u6c42\u5728\u4e0d\u540c\u670d\u52d9\u4e2d\u7684\u6027\u80fd\u3002\n\u5982\u9700\u67e5\u770b\u5206\u4f48\u5f0f\u8ddf\u8e64\u5716\u8868\uff0c\u8acb\u57f7\u884c\u4ee5\u4e0b\u64cd\u4f5c\uff1a- \u8a2a\u554f\u8a72\u61c9\u7528\uff0c\u7136\u5f8c\u9ede\u64ca\u4efb\u610f\u7522\u54c1\u3002\u7cfb\u7d71\u6703\u986f\u793a\u7522\u54c1\u8a73\u60c5\u9801\u9762\u3002\n- \u5728 Google Cloud \u63a7\u5236\u6aaf\u4e2d\uff0c\u8f49\u5230 [\u8ddf\u8e64\u8a18\u9304\u5217\u8868](https://console.cloud.google.com/traces/list?hl=zh-cn) \u9801\u9762\u4e26\u67e5\u770b\u6642\u9593\u8ef8\u3002\n- \u5982\u9700\u67e5\u770b\u5206\u4f48\u5f0f\u8ddf\u8e64\u8a18\u9304\u7d50\u679c\uff0c\u8acb\u5728 URI \u5217\u4e2d\u9ede\u64ca **\u524d\u7aef** \u3002\n- **\u8ddf\u8e64\u8a18\u9304\u7011\u5e03\u8996\u5716** \u986f\u793a\u8207 URI \u95dc\u806f\u7684 span\uff1a\u5728\u524d\u9762\u7684\u5c4f\u5e55\u622a\u5716\u4e2d\uff0c\u5546\u54c1\u7684\u8ddf\u8e64\u8a18\u9304\u5305\u542b\u4ee5\u4e0b span\uff1a- **\u524d\u7aef** span \u53ef\u6355\u7372\u5ba2\u6236\u7aef\u5728\u52a0\u8f09\u5546\u54c1\u8a73\u60c5\u9801\u9762\u6642\u89c0\u5bdf\u5230\u7684\u7aef\u5230\u7aef\u5ef6\u9072\u6642\u9593\uff08150.349 \u6beb\u79d2\uff09\u3002\n- **\u63a8\u85a6\u670d\u52d9** span \u53ef\u6355\u7372\u5f8c\u7aef\u8abf\u7528\u5728\u63d0\u53d6\u8207\u5546\u54c1\u76f8\u95dc\u7684\u63a8\u85a6\u6642\u7684\u5ef6\u9072\u6642\u9593\uff084.246 \u6beb\u79d2\uff09\u3002\n- **\u5ee3\u544a\u670d\u52d9** span \u53ef\u6355\u7372\u5f8c\u7aef\u8abf\u7528\u5728\u63d0\u53d6\u8207\u5546\u54c1\u9801\u9762\u76f8\u95dc\u7684\u5ee3\u544a\u6642\u7684\u5ef6\u9072\u6642\u9593\uff084.511 \u6beb\u79d2\uff09\u3002\n\u7232\u4e86\u89e3\u6c7a\u9ad8\u97ff\u61c9\u6642\u9593\u554f\u984c\uff0c\u60a8\u53ef\u4ee5\u67e5\u770b\u5206\u6790\u6d1e\u898b\uff0c\u5176\u4e2d\u5305\u62ec\u7576\u670d\u52d9\u7684\u4f9d\u8cf4\u9805\u672a\u6eff\u8db3\u5176 [\u670d\u52d9\u7b49\u7d1a\u76ee\u6a19](https://wikipedia.org/wiki/Service-level_objective) (SLO) \u6642\u4efb\u4f55\u7570\u5e38\u8acb\u6c42\u7684\u5ef6\u9072\u6642\u9593\u5206\u4f48\u5716\u3002\u60a8\u9084\u53ef\u4ee5 [\u4f7f\u7528 Cloud Trace \u5f9e\u63a1\u6a23\u6578\u64da\u4e2d\u7372\u53d6\u6027\u80fd\u6578\u64da\u5206\u6790\u548c\u5275\u5efa\u5206\u6790\u5831\u544a](https://cloud.google.com/trace/docs/analysis-reports?hl=zh-cn) \u3002## \u554f\u984c\u6392\u67e5\u5982\u679c\u61c9\u7528\u6027\u80fd\u7ba1\u7406\u4e2d\u7684\u8ddf\u8e64\u8a18\u9304\u672a\u986f\u793a\uff0c\u8acb\u5728 Logs Explorer \u4e2d\u6aa2\u67e5\u662f\u5426\u5b58\u5728\u6b0a\u9650\u906d\u62d2\u932f\u8aa4\u3002\u7576\u670d\u52d9\u8cec\u865f\u6c92\u6709\u5c0e\u51fa\u8ddf\u8e64\u8a18\u9304\u7684\u8a2a\u554f\u6b0a\u9650\u6642\uff0c\u6703\u767c\u751f\u6b0a\u9650\u906d\u62d2\u3002\u67e5\u770b [\u6388\u4e88 Cloud Trace \u6240\u9700\u7684\u89d2\u8272](https://cloud.google.com/architecture/microservices-architecture-distributed-tracing?hl=zh-cn#deploying_the_application) \u7684\u6b65\u9a5f\uff0c\u4e26\u78ba\u4fdd\u4f7f\u7528\u6b63\u78ba\u7684\u547d\u540d\u7a7a\u9593\u7232\u670d\u52d9\u8cec\u865f\u6dfb\u52a0\u8a3b\u89e3\u3002\u4e4b\u5f8c\uff0c\u91cd\u5553 `opentelemetrycollector` \uff1a\n```\n```kubectl rollout restart deployment opentelemetrycollector```\n```## \u6e05\u7406\u7232\u907f\u514d\u56e0\u672c\u6559\u7a0b\u4e2d\u4f7f\u7528\u7684\u8cc7\u6e90\u5c0e\u81f4\u60a8\u7684 Google Cloud \u8cec\u865f\u7522\u751f\u8cbb\u7528\uff0c\u8acb\u522a\u9664\u5305\u542b\u9019\u4e9b\u8cc7\u6e90\u7684\u9805\u76ee\uff0c\u6216\u8005\u4fdd\u7559\u9805\u76ee\u4f46\u522a\u9664\u5404\u500b\u8cc7\u6e90\u3002\n### \u522a\u9664\u9805\u76ee- Titles in dynamic includes are not used anywhere, and we should avoid paying to translate them\n- **\u8b66\u544a** \uff1a\u522a\u9664\u9805\u76ee\u6703\u7522\u751f\u4ee5\u4e0b\u5f71\u97ff- **\u9805\u76ee\u4e2d\u7684\u6240\u6709\u5167\u5bb9\u90fd\u6703\u88ab\u522a\u9664\u3002** \u5982\u679c\u60a8\u5c07\u73fe\u6709\u9805\u76ee\u7528\u65bc\u672c\u6587\u6a94\u4e2d\u7684\u4efb\u52d9\uff0c\u5247\u522a\u9664\u8a72\u9805\u76ee\u5f8c\uff0c\u9084\u5c07\u522a\u9664\u60a8\u5df2\u5728\u8a72\u9805\u76ee\u4e2d\u5b8c\u6210\u7684\u4efb\u4f55\u5176\u4ed6\u5de5\u4f5c\u3002\n- **\u81ea\u5b9a\u7fa9\u9805\u76ee ID \u4e1f\u5931\u3002** \u5275\u5efa\u6b64\u9805\u76ee\u6642\uff0c\u60a8\u53ef\u80fd\u5275\u5efa\u4e86\u8981\u5728\u5c07\u4f86\u4f7f\u7528\u7684\u81ea\u5b9a\u7fa9\u9805\u76ee ID\u3002\u8981\u4fdd\u7559\u4f7f\u7528\u8a72\u9805\u76ee ID \u7684\u7db2\u5740\uff08\u4f8b\u5982`appspot.com`\u7db2\u5740\uff09\uff0c\u8acb\u522a\u9664\u9805\u76ee\u5167\u7684\u6240\u9078\u8cc7\u6e90\uff0c\u800c\u4e0d\u662f\u522a\u9664\u6574\u500b\u9805\u76ee\u3002\n\u5982\u679c\u60a8\u6253\u7b97\u63a2\u7d22\u591a\u500b\u67b6\u69cb\u3001\u6559\u7a0b\u6216\u5feb\u901f\u5165\u9580\uff0c\u5247\u91cd\u8907\u4f7f\u7528\u9805\u76ee\u53ef\u4ee5\u5e6b\u52a9\u60a8\u907f\u514d\u8d85\u51fa\u9805\u76ee\u914d\u984d\u9650\u5236\u3002\n- \u5728 Google Cloud \u63a7\u5236\u6aaf\u4e2d\uff0c\u9032\u5165 **\u7ba1\u7406\u8cc7\u6e90** \u9801\u9762\u3002 [\u8f49\u5230\u201c\u7ba1\u7406\u8cc7\u6e90\u201d](https://console.cloud.google.com/iam-admin/projects?hl=zh-cn) \n- \u5728\u9805\u76ee\u5217\u8868\u4e2d\uff0c\u9078\u64c7\u8981\u522a\u9664\u7684\u9805\u76ee\uff0c\u7136\u5f8c\u9ede\u64ca **\u522a\u9664** \u3002\n- \u5728\u5c0d\u8a71\u6846\u4e2d\u8f38\u5165\u9805\u76ee ID\uff0c\u7136\u5f8c\u9ede\u64ca **\u95dc\u9589** \u4ee5\u522a\u9664\u9805\u76ee\u3002\n### \u522a\u9664\u8cc7\u6e90\u5982\u679c\u60a8\u5e0c\u671b\u4fdd\u7559\u672c\u6587\u6a94\u4e2d\u4f7f\u7528\u7684 Google Cloud \u9805\u76ee\uff0c\u8acb\u522a\u9664\u5404\u500b\u8cc7\u6e90\uff1a- \u5728 Cloud Shell \u4e2d\uff0c\u522a\u9664\u8cc7\u6e90\uff1a```\ngcloud container clusters delete online-boutique --project=${PROJECT_ID} --region=${REGION}\n```\n## \u5f8c\u7e8c\u6b65\u9a5f\n- \u95b1\u8b80\u672c\u7cfb\u5217\u6587\u7ae0\u7684\u7b2c\u4e00\u7bc7\uff0c\u77ad\u89e3 [\u5fae\u670d\u52d9\u3001\u5176\u512a\u52e2\u3001\u6311\u6230\u548c\u4f7f\u7528\u5834\u666f](https://cloud.google.com/architecture/microservices-architecture-introduction?hl=zh-cn) \u3002\n- \u95b1\u8b80\u672c\u7cfb\u5217\u6587\u7ae0\u7684\u7b2c\u4e8c\u7bc7\uff0c\u77ad\u89e3 [\u7528\u65bc\u5206\u89e3\u5fae\u670d\u52d9\u7684\u61c9\u7528\u91cd\u69cb\u7b56\u7565](https://cloud.google.com/architecture/microservices-architecture-refactoring-monoliths?hl=zh-cn) \u3002\n- \u95b1\u8b80\u672c\u7cfb\u5217\u7684\u7b2c\u4e09\u7bc7\uff0c\u77ad\u89e3 [\u5fae\u670d\u52d9\u8a2d\u7f6e\u4e2d\u7684\u670d\u52d9\u9593\u901a\u4fe1](https://cloud.google.com/architecture/microservices-architecture-interservice-communication?hl=zh-cn) \u3002\n- \u5982\u9700\u67e5\u770b\u66f4\u591a\u53c3\u8003\u67b6\u69cb\u3001\u5716\u8868\u548c\u6700\u4f73\u505a\u6cd5\uff0c\u8acb\u700f\u89bd [\u96f2\u67b6\u69cb\u4e2d\u5fc3](https://cloud.google.com/architecture?hl=zh-cn) \u3002", "guide": "Docs"}