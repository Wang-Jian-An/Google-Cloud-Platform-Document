{"title": "Docs - \u5728 Google Cloud \u4e0a\u904b\u884c IoT \u5f8c\u7aef\u7684\u6700\u4f73\u505a\u6cd5", "url": "https://cloud.google.com/architecture/connected-devices/bps-running-iot-backend-securely?hl=zh-cn", "abstract": "# Docs - \u5728 Google Cloud \u4e0a\u904b\u884c IoT \u5f8c\u7aef\u7684\u6700\u4f73\u505a\u6cd5\nLast reviewed 2023-02-08 UTC\n\u672c\u6587\u6a94\u4ecb\u7d39\u5728 Google Cloud \u4e0a\u7ba1\u7406\u548c\u904b\u884c\u7269\u806f\u7db2 (IoT) \u5f8c\u7aef\u6642\u7684\u5b89\u5168\u6700\u4f73\u505a\u6cd5\u3002\u5728 IoT \u89e3\u6c7a\u65b9\u6848\u4e2d\uff0cIoT \u5f8c\u7aef\u5c07\u908a\u7de3\u8a2d\u5099\u9023\u63a5\u5230\u5176\u4ed6\u8cc7\u6e90\u3002\u672c\u6587\u6a94\u91cd\u9ede\u4ecb\u7d39\u4ee5\u4e0b IoT \u5f8c\u7aef\uff1aMessage Queueing Telemetry Transport (MQTT) \u4ee3\u7406\u548c IoT \u5e73\u81fa\u3002\n\u672c\u6587\u6a94\u662f\u7cfb\u5217\u6587\u6a94\u4e2d\u7684\u4e00\u7bc7\uff0c\u8a72\u7cfb\u5217\u4ecb\u7d39\u4e86 Google Cloud \u4e0a\u7684 IoT \u67b6\u69cb\u4ee5\u53ca\u5982\u4f55\u5f9e IoT Core \u9032\u884c\u9077\u79fb\u3002\u672c\u7cfb\u5217\u4e2d\u7684\u5176\u4ed6\u6587\u6a94\u5305\u62ec\u4ee5\u4e0b\u5167\u5bb9\uff1a\n- [Google Cloud \u4e0a\u7684\u95dc\u806f\u8a2d\u5099\u67b6\u69cb\u6982\u89bd](https://cloud.google.com/architecture/connected-devices?hl=zh-cn) \n- [Google Cloud \u4e0a\u7684\u7368\u7acb MQTT \u4ee3\u7406\u67b6\u69cb](https://cloud.google.com/architecture/connected-devices/mqtt-broker-architecture?hl=zh-cn) \n- [Google Cloud \u4e0a\u7684 IoT \u5e73\u81fa\u7522\u54c1\u67b6\u69cb](https://cloud.google.com/architecture/connected-devices/iot-platform-product-architecture?hl=zh-cn) \n- \u5728 Google Cloud \u4e0a\u904b\u884c IoT \u5f8c\u7aef\u7684\u6700\u4f73\u5be6\u8e10\uff08\u672c\u6587\u6a94\uff09\n- [\u5c07 Pub/Sub \u67b6\u69cb\u4e0a\u7684\u8a2d\u5099\u9077\u79fb\u5230 Google Cloud](https://cloud.google.com/architecture/connected-devices/device-pubsub-architecture?hl=zh-cn) \n- [\u81ea\u52d5\u9810\u914d\u548c\u914d\u7f6e\u908a\u7de3\u8207\u88f8\u6a5f\u7cfb\u7d71\u548c\u670d\u52d9\u5668\u7684\u6700\u4f73\u505a\u6cd5](https://cloud.google.com/architecture/connected-devices/best-practices-provisioning-configuring-bare-metal?hl=zh-cn) \n- [\u5f9e IoT Core \u9077\u79fb\u74b0\u5883](https://cloud.google.com/architecture/connected-devices/iot-core-migration?hl=zh-cn) \n\u672c\u6587\u6a94\u63d0\u4f9b\u4e86\u9810\u914d\u548c\u7ba1\u7406\u8a2d\u5099\u6191\u64da\u3001\u5c0d\u908a\u7de3\u8a2d\u5099\u9032\u884c\u8eab\u4efd\u9a57\u8b49\u548c\u8a2a\u554f\u4ee5\u53ca\u5141\u8a31 IoT \u908a\u7de3\u8a2d\u5099\u8a2a\u554f Google Cloud \u8cc7\u6e90\u7684\u6700\u4f73\u505a\u6cd5\u3002\n", "content": "## IoT \u67b6\u69cb\nIoT \u67b6\u69cb\u5305\u542b\u53ef\u8b93\u60a8\u9810\u914d\u548c\u7ba1\u7406\u8a2d\u5099\u6191\u64da\u3001\u5c0d\u908a\u7de3\u8a2d\u5099\u9032\u884c\u8eab\u4efd\u9a57\u8b49\u548c\u8a2a\u554f\u6b0a\u9650\u63a7\u5236\u4ee5\u53ca\u8b93\u908a\u7de3\u8a2d\u5099\u8a2a\u554f Google Cloud \u8cc7\u6e90\u7684\u670d\u52d9\u3002\u672c\u6587\u6a94\u8a0e\u8ad6\u4e86\u5169\u500b IoT \u5f8c\u7aef\u67b6\u69cb\uff1a\u4e00\u500b\u4f7f\u7528 MQTT \u4ee3\u7406\uff0c\u53e6\u4e00\u500b\u4f7f\u7528 IoT \u5e73\u81fa\u3002\u9019\u5169\u500b\u5f8c\u7aef\u4e4b\u9593\u7684\u4e3b\u8981\u5b89\u5168\u5dee\u7570\u662f\u8a2d\u5099\u8eab\u4efd\u548c\u8a2d\u5099\u7ba1\u7406\u3002IoT \u5e73\u81fa\u4f5c\u7232\u5176\u7cfb\u7d71\u7684\u4e00\u90e8\u5206\u63d0\u4f9b\u9019\u4e9b\u529f\u80fd\uff0c\u800c MQTT \u4ee3\u7406\u8981\u6c42\u60a8\u63d0\u4f9b\u9019\u4e9b\u529f\u80fd\u3002\n\u4e0b\u5716\u63cf\u8ff0\u4e86 IoT \u67b6\u69cb\u3002\n\u8a72\u67b6\u69cb\u986f\u793a\u4e86\u5b8c\u6210\u4ee5\u4e0b\u4e09\u500b\u904e\u7a0b\u6240\u9700\u7684\u670d\u52d9\uff1a\n- \u8b49\u66f8\u9810\u914d\uff0c\u9019\u662f\u6e96\u5099\u908a\u7de3\u8a2d\u5099\u4ee5\u9032\u884c\u914d\u7f6e\u6642\u5fc5\u9808\u5b8c\u6210\u7684\u904e\u7a0b\u3002\n- \u8eab\u4efd\u9a57\u8b49\u548c\u6388\u6b0a\uff0c\u5305\u62ec\u908a\u7de3\u8a2d\u5099\u548c MQTT \u4ee3\u7406\u6216 IoT \u5e73\u81fa\u7528\u65bc\u5f7c\u6b64\u9032\u884c\u8eab\u4efd\u9a57\u8b49\u7684\u8eab\u4efd\u9a57\u8b49\u65b9\u6848\u3002\n- \u908a\u7de3\u8a2d\u5099\u8207 Google Cloud \u670d\u52d9\u4e4b\u9593\u7684\u9023\u63a5\uff0c\u9019\u4e9b\u662f\u908a\u7de3\u8a2d\u5099\u7232\u9023\u63a5\u5230\u96f2\u8cc7\u6e90\u4ee5\u53ca\u4e0a\u50b3\u6216\u4e0b\u8f09\u6578\u64da\u800c\u5b8c\u6210\u7684\u4efb\u52d9\u3002\n\u672c\u6587\u6a94\u4e3b\u8981\u4ecb\u7d39\u9810\u914d\u548c\u8eab\u4efd\u9a57\u8b49\u7684\u5b89\u5168\u6700\u4f73\u505a\u6cd5\u3002\n\u8a72\u67b6\u69cb\u7d50\u5408\u4f7f\u7528\u4e86\u4ee5\u4e0b\u670d\u52d9\u548c\u529f\u80fd\uff1a\n- \u908a\u7de3\u8a2d\u5099\uff08\u5982\u91ab\u7642\u8a2d\u5099\uff09\uff0c\u90e8\u7f72\u5728 [\u60a8\u7684\u74b0\u5883\u908a\u7de3](https://www.lfedge.org/2020/08/18/breaking-down-the-edge-continuum/) \u4e14\u5730\u7406\u4f4d\u7f6e\u9760\u8fd1\u60a8\u8981\u8655\u7406\u7684\u6578\u64da\u3002\u908a\u7de3\u8a2d\u5099\u8207\u60a8\u7684 IoT \u5f8c\u7aef\u96d9\u5411\u9023\u63a5\uff0c\u9019\u610f\u5473\u7740\u5b83\u5011\u53ef\u4ee5\u5411 IoT \u5f8c\u7aef\u767c\u9001\u6d88\u606f\u4ee5\u53ca\u63a5\u6536\u4f86\u81ea IoT \u5f8c\u7aef\u7684\u6d88\u606f\u3002\n- IoT \u5f8c\u7aef\uff0c\u53ef\u4ee5\u662f MQTT \u4ee3\u7406\u6216 IoT \u5e73\u81fa\u3002- MQTT \u4ee3\u7406\u4f7f\u7528 [MQTT \u5354\u8b70](https://mqtt.org/mqtt-specification/) \u63d0\u4f9b\u5b89\u5168\u63a5\u53e3\u4ee5\u4f9b\u908a\u7de3\u8a2d\u5099\u9023\u63a5\u3002MQTT \u4ee3\u7406\u6c92\u6709\u8a2d\u5099\u8eab\u4efd\u548c\u8a2d\u5099\u7ba1\u7406\u529f\u80fd\uff0c\u9700\u4f9d\u8cf4\u5916\u90e8\u7cfb\u7d71\u4f86\u63d0\u4f9b\u3002\n- IoT \u5e73\u81fa\u662f\u4e00\u500b\u96f2\u61c9\u7528\uff0c\u908a\u7de3\u8a2d\u5099\u8207\u5b83\u9023\u63a5\u548c\u901a\u4fe1\u3002IoT \u5e73\u81fa\u4f7f\u7528 MQTT \u5354\u8b70\u63d0\u4f9b\u5b89\u5168\u63a5\u53e3\u4ee5\u4f9b\u908a\u7de3\u8a2d\u5099\u9023\u63a5\u3002\u6bcf\u500b IoT \u5e73\u81fa\u90fd\u6709\u81ea\u5df1\u7684\u5b89\u5168\u5be6\u73fe\uff0c\u8a72\u5be6\u73fe\u78ba\u5b9a\u5982\u4f55\u5c0d\u908a\u7de3\u8a2d\u5099\u9032\u884c\u8eab\u4efd\u9a57\u8b49\u548c\u6388\u6b0a\uff0c\u4ee5\u53ca\u5982\u4f55\u7ba1\u7406\u8a2d\u5099\u8eab\u4efd\u3002\n- \u8a17\u7ba1\u6240\u6709\u908a\u7de3\u8a2d\u5099\u7684\u8b49\u66f8\u7684\u4e2d\u592e\u8b49\u66f8\u5b58\u5132\u5340\u3002\n- \u908a\u7de3\u8a2d\u5099\u5fc5\u9808\u8a2a\u554f\u7684\u96f2\u8cc7\u6e90\u3002## \u9810\u914d\u908a\u7de3\u8a2d\u5099\n\u9023\u63a5\u908a\u7de3\u8a2d\u5099\u8207\u5f8c\u7aef\u5de5\u4f5c\u8ca0\u8f09\u4e4b\u524d\uff0c\u60a8\u5fc5\u9808\u7232\u908a\u7de3\u8a2d\u5099\u9810\u914d\u8b49\u66f8\u3002\u6709\u5169\u7a2e\u4e3b\u8981\u5834\u666f\u6c7a\u5b9a\u8b49\u66f8\u7684\u9810\u914d\u65b9\u5f0f\uff1a\n- \u5982\u679c\u60a8\u7684\u89e3\u6c7a\u65b9\u6848\u57fa\u65bc\u5546\u696d\u901a\u7528\u8a2d\u5099\uff0c\u60a8\u53ef\u4ee5\u5728\u8cfc\u8cb7\u8a2d\u5099\u5f8c\u5b8c\u5168\u63a7\u5236\u9810\u914d\u904e\u7a0b\u3002\n- \u5982\u679c\u60a8\u4f7f\u7528\u5b9a\u88fd\u8a2d\u5099\uff0c\u5247\u521d\u59cb\u9810\u914d\u904e\u7a0b\u6703\u5728\u8a2d\u5099\u88fd\u9020\u671f\u9593\u9032\u884c\uff0c\u60a8\u5fc5\u9808\u5c07\u8a72\u9810\u914d\u904e\u7a0b\u8207\u4f9b\u61c9\u5546\u548c\u88fd\u9020\u5546\u6574\u5408\u3002\n\u5728\u4efb\u4e00\u7a2e\u5834\u666f\u4e2d\uff0c\u60a8\u90fd\u5fc5\u9808\u4f7f\u7528\u93c8\u63a5\u5230\u6839\u8b49\u66f8\u6388\u6b0a\u6a5f\u69cb (CA) \u7684\u4fe1\u4efb\u93c8\u4f86\u5275\u5efa\u8a2d\u5099\u8b49\u66f8\u3002\u9019\u4e9b\u8b49\u66f8\u6703\u5c0d\u8a2d\u5099\u8eab\u4efd\u9032\u884c\u8eab\u4efd\u9a57\u8b49\uff0c\u4e26\u6709\u52a9\u65bc\u78ba\u4fdd\u5728\u8a2d\u5099\u4e0a\u57f7\u884c\u7684\u64cd\u4f5c\u548c\u4fee\u6539\u7531\u53ef\u4fe1\u7684\u64cd\u4f5c\u8005\u57f7\u884c\u3002\u4f7f\u7528 [Certificate Authority Service](https://cloud.google.com/certificate-authority-service?hl=zh-cn) \u7b49 CA \u4f86\u5b8c\u6210\u4ee5\u4e0b\u4efb\u52d9\uff1a\n- \u4ee5\u5b89\u5168\u7684\u65b9\u5f0f [\u751f\u6210\u4e26\u5b58\u5132\u6839 CA \u8b49\u66f8](https://cloud.google.com/certificate-authority-service/docs/creating-certificate-authorities?hl=zh-cn#create-root-ca) \u3002\n- [\u751f\u6210\u4e26\u5b58\u5132\u5f9e\u5c6c CA \u8b49\u66f8](https://cloud.google.com/certificate-authority-service/docs/creating-certificate-authorities?hl=zh-cn#subordinate-internal) \uff0c\u4ee5\u4fbf\u5728\u5fc5\u8981\u6642\u7232\u8a2d\u5099\u8b49\u66f8\u7c64\u540d\u3002\n- [\u8acb\u6c42\u8a2d\u5099\u8b49\u66f8\u3002](https://cloud.google.com/certificate-authority-service/docs/requesting-certificates?hl=zh-cn) \n- \u914d\u7f6e [\u5f9e\u5c6c CA \u6b0a\u9650](https://cloud.google.com/certificate-authority-service/docs/reference/permissions-and-roles?hl=zh-cn) \u4e26\u5206\u767c\u7d66\u4f9b\u61c9\u5546\u548c\u88fd\u9020\u5546\u3002\n- [\u64a4\u6d88\u8a2d\u5099\u8b49\u66f8](https://cloud.google.com/certificate-authority-service/docs/revoking-certificates?hl=zh-cn) \uff08\u5982\u679c\u60a8\u4e0d\u518d\u9700\u8981\u9019\u4e9b\u8b49\u66f8\uff0c\u6216\u8005\u60a8\u61f7\u7591\u8a2d\u5099\u5df2\u906d\u7834\u89e3\uff09\u3002\n\u5982\u9700\u9810\u914d\u8a2d\u5099\u8b49\u66f8\uff0c\u60a8\u5fc5\u9808\u5b8c\u6210\u4ee5\u4e0b\u4efb\u52d9\uff1a\n- \u4f7f\u7528\u8a2d\u5099\u652f\u6301\u7684\u57fa\u65bc\u786c\u4ef6\u7684\u5b89\u5168\u89e3\u6c7a\u65b9\u6848\uff08\u4f8b\u5982 [\u5b89\u5168\u5143\u4ef6 (SE)](https://encyclopedia.kaspersky.com/glossary/secure-element/) \uff09\u6216 [\u786c\u4ef6\u5b89\u5168\u6a21\u584a (HSM)](https://wikipedia.org/wiki/Hardware_security_module) \u3002\u6839\u64da\u8a2d\u8a08\uff0cSE \u6216 HSM \u5c07\u79c1\u9470\u5b58\u5132\u5728\u672c\u5730\uff0c\u4e26\u4e14\u7d55\u4e0d\u6703\u5c07\u79c1\u9470\u5c0d\u5916\u516c\u958b\u3002\u5982\u679c\u60a8\u6c92\u6709\u4f7f\u7528\u57fa\u65bc\u786c\u4ef6\u7684\u5b89\u5168\u89e3\u6c7a\u65b9\u6848\u4f86\u751f\u6210\u516c\u9470/\u79c1\u9470\u5c0d\uff0c\u8acb\u4f7f\u7528 CA \u751f\u6210\u5bc6\u9470\u3002\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [\u4f7f\u7528\u81ea\u52d5\u751f\u6210\u7684\u5bc6\u9470](https://cloud.google.com/certificate-authority-service/docs/requesting-certificates?hl=zh-cn#auto-generated-key) \u3002\n- \u7c3d\u7f72\u4e26\u751f\u6210\u8a2d\u5099\u8b49\u66f8\u3002\u751f\u6210\u516c\u9470/\u79c1\u9470\u5c0d\u5f8c\uff0c\u4e0b\u8f09\u516c\u9470\uff0c\u5275\u5efa [\u8b49\u66f8\u7c64\u540d\u8acb\u6c42 (CSR)](https://wikipedia.org/wiki/Certificate_signing_request) \uff0c\u4e26\u5c07 CSR \u767c\u9001\u5230 CA \u4ee5\u9032\u884c\u7c3d\u540d\u3002CA \u6703\u751f\u6210\u8207\u6839 CA \u95dc\u806f\u7684\u8a2d\u5099\u8b49\u66f8\u3002\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [\u4f7f\u7528 CSR](https://cloud.google.com/certificate-authority-service/docs/requesting-certificates?hl=zh-cn#use-csr) \u3002\u4f7f\u7528\u81ea\u52d5\u751f\u6210\u7684\u5bc6\u9470\u6642\uff0c\u60a8\u53ef\u4ee5\u76f4\u63a5\u5411 CA \u8acb\u6c42\u8a2d\u5099\u8b49\u66f8\u3002\n- \u5728\u908a\u7de3\u8a2d\u5099\u4e0a\u5b89\u88dd\u7c3d\u540d\u8a2d\u5099\u8b49\u66f8\uff0c\u4e26\u5c07\u8b49\u66f8\u767c\u9001\u5230 [Secret Manager](https://cloud.google.com/secret-manager?hl=zh-cn) \u7b49\u4e2d\u592e\u8b49\u66f8\u5eab\u3002\n\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [\u5982\u4f55\u4f7f\u7528 Google Cloud CA Service (PDF) \u90e8\u7f72\u5b89\u5168\u53ef\u9760\u7684\u516c\u9470\u57fa\u790e\u67b6\u69cb](https://services.google.com/fh/files/misc/deploying_public_key_infrastructure_with_cas.pdf?hl=zh-cn) \u3002\n\u5982\u9700\u77ad\u89e3\u5176\u4ed6\u9810\u914d\u6700\u4f73\u505a\u6cd5\uff0c\u8acb\u53c3\u95b1 [\u81ea\u52d5\u9810\u914d\u548c\u914d\u7f6e\u908a\u7de3\u8207\u88f8\u6a5f\u7cfb\u7d71\u548c\u670d\u52d9\u5668\u7684\u6700\u4f73\u505a\u6cd5](https://cloud.google.com/architecture/best-practices-provisioning-configuring-bare-metal?hl=zh-cn#provisioning_and_configuration_processes_best_practicesactices) \u3002\n\u4f7f\u7528\u4e09\u7a2e\u985e\u578b\u7684\u8b49\u66f8\u4f86\u5e6b\u52a9\u4fdd\u8b77 IoT \u89e3\u6c7a\u65b9\u6848\uff1a\n- \u6839 CA \u8b49\u66f8\u63d0\u4f9b\u7cfb\u7d71\u4e2d\u6240\u6709\u5176\u4ed6\u8b49\u66f8\u7684\u4fe1\u4efb\u93c8\u6839\u3002\u5f8c\u7aef\u5de5\u4f5c\u8ca0\u8f09\u4f7f\u7528\u6839\u8b49\u66f8\u4f86\u9a57\u8b49\u5ba2\u6236\u7aef\u8b49\u66f8\uff0c\u908a\u7de3\u8a2d\u5099\u4f7f\u7528\u6839\u8b49\u66f8\u4f86\u9a57\u8b49\u670d\u52d9\u5668\u8b49\u66f8\u3002\u60a8\u5fc5\u9808\u5c07\u6839\u8b49\u66f8\u5206\u767c\u7d66 IoT \u5f8c\u7aef\u548c\u908a\u7de3\u8a2d\u5099\u3002\n- \u670d\u52d9\u5668\u8b49\u66f8\u7528\u65bc\u4fdd\u8b77 IoT \u5f8c\u7aef\u516c\u958b\u7684\u7aef\u9ede\u3002\u60a8\u64c1\u6709\u60a8\u7684\u7aef\u9ede\u9700\u8981\u652f\u6301\u7684\u4e0d\u540c\u52a0\u5bc6\u7b97\u6cd5\u7684\u670d\u52d9\u5668\u8b49\u66f8\u3002\u670d\u52d9\u5668\u8b49\u66f8\u8207\u6839 CA \u76f8\u95dc\u806f\u3002Secret Manager \u540c\u6642\u7ba1\u7406\u548c\u5b58\u5132\u670d\u52d9\u5668\u8b49\u66f8\u7684\u79c1\u6709\u548c\u516c\u958b\u90e8\u5206\u3002\u60a8\u5fc5\u9808\u4f7f\u7528\u670d\u52d9\u5668\u8b49\u66f8\u53ca\u5176\u76f8\u61c9\u7684\u79c1\u9470\u4f86\u914d\u7f6e IoT \u5f8c\u7aef\u3002\n- \u5ba2\u6236\u7aef\u8b49\u66f8\u7528\u65bc\u6a19\u8b58\u908a\u7de3\u8a2d\u5099\u3002\u6bcf\u500b\u908a\u7de3\u8a2d\u5099\u81f3\u5c11\u6709\u4e00\u500b\u5ba2\u6236\u7aef\u8b49\u66f8\uff0c\u9019\u610f\u5473\u7740\u60a8\u64c1\u6709\u7684\u8b49\u66f8\u6578\u91cf\u6703\u96a8\u7740\u60a8\u74b0\u5883\u4e2d\u7684\u908a\u7de3\u8a2d\u5099\u6578\u91cf\u589e\u52a0\u800c\u589e\u52a0\u3002\u5ba2\u6236\u7aef\u8b49\u66f8\u8207\u6839 CA \u76f8\u95dc\u806f\u3002\u60a8\u5fc5\u9808\u5c07\u5ba2\u6236\u7aef\u8b49\u66f8\u5206\u914d\u7d66\u908a\u7de3\u8a2d\u5099\u548c IoT \u5f8c\u7aef\u3002\u4e0b\u5716\u5c55\u793a\u77ad\u5982\u4f55\u5728\u4f7f\u7528 HSM \u6216 SE \u6642\u9810\u914d\u8a2d\u5099\u8b49\u66f8\u3002\n\u5728\u8a72\u5716\u4e2d\uff0c\u57f7\u884c\u4ee5\u4e0b\u6b65\u9a5f\uff1a\n- \u908a\u7de3\u8a2d\u5099\u5728\u786c\u4ef6\u4e2d\u751f\u6210\u516c\u9470\u5c0d\u3002\n- \u4e0b\u8f09\u516c\u9470\u4f75\u7232\u5176\u5275\u5efa\u8b49\u66f8\u7c64\u540d\u8acb\u6c42 (CSR)\u3002\n- \u5c07 CSR \u767c\u9001\u5230 CA \u4ee5\u8acb\u6c42\u8b49\u66f8\u3002\n- CA \u5b8c\u6210\u4ee5\u4e0b\u64cd\u4f5c\uff1a- \u7232\u8b49\u66f8\u7c64\u540d\u3002\n- \u5c07\u8a2d\u5099\u8b49\u66f8\u8fd4\u56de\u7d66\u9810\u914d\u8005\u3002\n- \u9810\u914d\u8005\u5b8c\u6210\u4ee5\u4e0b\u64cd\u4f5c\uff1a- \u5c07\u8b49\u66f8\u767c\u9001\u5230\u908a\u7de3\u8a2d\u5099\u3002\n- \u5c07\u8b49\u66f8\u5b58\u5132\u5728\u4e2d\u592e\u8b49\u66f8\u5b58\u5132\u5340\u4e2d\u3002\n- \u908a\u7de3\u8a2d\u5099\u5c07\u8b49\u66f8\u5b58\u5132\u5728\u5b89\u5168\u7684\u4f4d\u7f6e\u3002\u4e0b\u5716\u986f\u793a\u4e86\u4f7f\u7528 CA \u6642\u5982\u4f55\u9810\u914d\u8a2d\u5099\u8b49\u66f8\u3002\n\u5728\u8a72\u5716\u4e2d\uff0c\u57f7\u884c\u4ee5\u4e0b\u6b65\u9a5f\uff1a\n- \u60a8\u751f\u6210\u4e00\u500b CSR\uff0c\u4e26\u5c07\u5176\u767c\u9001\u7d66 CA \u4ee5\u8acb\u6c42\u8b49\u66f8\u3002\n- CA \u5b8c\u6210\u4ee5\u4e0b\u64cd\u4f5c\uff1a- \u751f\u6210\u516c\u9470\u548c\u516c\u9470\u5c0d\uff0c\u7136\u5f8c\u5c0d\u516c\u9470\u9032\u884c\u7c3d\u540d\u3002\n- \u5c07\u8a2d\u5099\u8b49\u66f8\u548c\u79c1\u9470\u8fd4\u56de\u5230\u9810\u914d\u8005\u3002\n- \u60a8\u9700\u8981\u5b8c\u6210\u4ee5\u4e0b\u64cd\u4f5c\uff1a- \u5c07\u8b49\u66f8\u548c\u79c1\u9470\u767c\u9001\u5230\u908a\u7de3\u8a2d\u5099\u3002\n- \u5c07\u8b49\u66f8\u548c\u79c1\u9470\u5b58\u5132\u5728\u4e2d\u592e\u8b49\u66f8\u5b58\u5132\u5340\u4e2d\u3002\n- \u908a\u7de3\u8a2d\u5099\u5c07\u8b49\u66f8\u5b58\u5132\u5728\u5b89\u5168\u7684\u4f4d\u7f6e\u3002## \u8a2d\u5099\u8eab\u4efd\u7684\u6700\u4f73\u505a\u6cd5\n\u672c\u90e8\u5206\u4ecb\u7d39\u8a2d\u5099\u8eab\u4efd\u7684\u6700\u4f73\u505a\u6cd5\u3002\n### \u5c07\u8eab\u4efd\u63d0\u4f9b\u65b9\u8207 MQTT \u4ee3\u7406\u642d\u914d\u4f7f\u7528\nMQTT \u4ee3\u7406\u4f7f\u7528\u901a\u904e [\u63d2\u4ef6](https://www.hivemq.com/docs/hivemq/3.4/plugins/authentication-and-permissions.html#client-authentication) \u3001 [\u6578\u64da\u5eab](https://docs.vernemq.com/configuring-vernemq/db-auth) \u548c [\u6587\u4ef6](https://mosquitto.org/documentation/authentication-methods/) \u63d0\u4f9b\u7684\u8a2d\u5099\u6191\u64da\u5c0d\u908a\u7de3\u8a2d\u5099\u9032\u884c\u8eab\u4efd\u9a57\u8b49\u3002\u5982\u9700\u4ee5\u53ef\u64f4\u7e2e\u7684\u65b9\u5f0f\u7cfb\u7d71\u5730\u7ba1\u7406\u8a2d\u5099\u8eab\u4efd\uff0c\u8acb\u4f7f\u7528 [\u8eab\u4efd\u63d0\u4f9b\u65b9 (IdP)](https://wikipedia.org/wiki/Identity_provider) \u3002IdP \u7ba1\u7406\u6240\u6709\u8a2d\u5099\u7684\u8eab\u4efd\u548c\u6191\u64da\uff0c\u4e26\u5145\u7576\u8a2d\u5099\u8eab\u4efd\u7684\u4e3b\u8981\u53ef\u9760\u4f86\u6e90\u3002\n\u5982\u9700\u5728 MQTT \u4ee3\u7406\u4e2d\u8b93\u8a2d\u5099\u8eab\u4efd\u4fdd\u6301\u6700\u65b0\uff0c\u8acb\u5be6\u73fe\u4e00\u500b\u7cfb\u7d71\u5c08\u7528\u96c6\u6210\u5c64\u3002\u5982\u9700\u8a73\u7d30\u77ad\u89e3\u5982\u4f55\u7ba1\u7406\u8a2d\u5099\u6191\u64da\uff0c\u8acb\u53c3\u95b1 [\u9810\u914d\u908a\u7de3\u8a2d\u5099](#provisioning) \u3002\n### \u4f7f\u7528 IoT \u5e73\u81fa\u7684\u6578\u5b57\u8eab\u4efd\u4f5c\u7232\u53ef\u9760\u4f86\u6e90\nIoT \u5e73\u81fa\u5177\u6709\u7528\u65bc\u7ba1\u7406\u8a2d\u5099\u8eab\u4efd\u548c\u8a2d\u5099\u6191\u64da\u7684\u5b89\u5168\u529f\u80fd\uff0c\u4ee5\u53ca\u5c0d\u5617\u8a66\u8a2a\u554f\u8a72\u5e73\u81fa\u7684\u8a2d\u5099\u9032\u884c\u8eab\u4efd\u9a57\u8b49\u548c\u6388\u6b0a\u3002\u9019\u4e9b\u5b89\u5168\u529f\u80fd\u6709\u52a9\u65bc\u78ba\u4fdd\u53ea\u6709\u7372\u5f97\u6388\u6b0a\u7684\u8a2d\u5099\u624d\u80fd\u8a2a\u554f IoT \u5e73\u81fa\u4e26\u5e6b\u52a9\u78ba\u4fdd\u6578\u64da\u5b8c\u6574\u6027\u3002\n\u9a57\u8b49 IoT \u5e73\u81fa\u7ba1\u7406\u7684\u8a2d\u5099\u8eab\u4efd\u662f\u5426\u4ee3\u8868 IoT \u5e73\u81fa\u7ba1\u7406\u7684\u6240\u6709\u8a2d\u5099\u7684\u4e3b\u8981\u771f\u5be6\u4f86\u6e90\u3002IoT \u89e3\u6c7a\u65b9\u6848\u4e2d\u9700\u8981\u8a2d\u5099\u8eab\u4efd\u4fe1\u606f\u7684\u5176\u4ed6\u7d44\u4ef6\u61c9\u4f9d\u8cf4 IoT \u5e73\u81fa\u7684\u5b89\u5168\u7cfb\u7d71\u3002IoT \u5e73\u81fa\u6388\u4e88\u5c0d\u8a2d\u5099\u7684\u8a2a\u554f\u6b0a\u9650\uff0c\u4e26\u5728\u6574\u500b IoT \u89e3\u6c7a\u65b9\u6848\u4e2d\u50b3\u64ad\u4efb\u4f55\u5b89\u5168\u66f4\u6539\u3002\n## \u7db2\u7d61\u9023\u63a5\u7684\u6700\u4f73\u505a\u6cd5\n\u78ba\u4fdd\u7db2\u7d61\u9023\u63a5\u5b89\u5168\u975e\u5e38\u91cd\u8981\uff0c\u539f\u56e0\u5982\u4e0b\uff1a\n- \u5b89\u5168\u7684\u7db2\u7d61\u6709\u52a9\u65bc\u78ba\u4fdd\u8a2d\u5099\u9023\u63a5\u5230\u6b63\u78ba\u7684\u5f8c\u7aef\u3002\u4f8b\u5982\uff0c\u5b89\u5168\u7684\u7db2\u7d61\u53ef\u4ee5\u9632\u6b62 [DNS \u4eff\u5192](https://wikipedia.org/wiki/DNS_spoofing) \uff08\u4e00\u7a2e\u5617\u8a66\u4f7f\u8a2d\u5099\u9023\u63a5\u5230\u7531\u653b\u64ca\u8005\u63a7\u5236\u7684\u60e1\u610f\u5f8c\u7aef\u7684\u653b\u64ca\uff09\u3002\n- \u5b89\u5168\u7684\u7db2\u7d61\u6709\u52a9\u65bc\u78ba\u4fdd\u7b2c\u4e09\u65b9\u7121\u6cd5\u8b80\u53d6\u60a8\u7684\u6578\u64da\u6d41\u91cf\u3002\u4f8b\u5982\uff0c\u5b89\u5168\u7684\u7db2\u7d61\u53ef\u4ee5\u9632\u6b62 [\u4e2d\u9593\u4eba\u653b\u64ca](https://wikipedia.org/wiki/Man-in-the-middle_attack) \uff08\u653b\u64ca\u8005\u8b80\u53d6\u60a8\u7684\u8a2d\u5099\u8207\u5f8c\u7aef\u4e4b\u9593\u7684\u6d41\u91cf\uff09\u3002\n\u4f7f\u7528 [\u50b3\u8f38\u5c64\u5b89\u5168\u5354\u8b70 (TLS)](https://wikipedia.org/wiki/Transport_Layer_Security) \u4fdd\u8b77\u908a\u7de3\u8a2d\u5099\u8207\u5f8c\u7aef\u5de5\u4f5c\u8ca0\u8f09\u4e4b\u9593\u7684\u7db2\u7d61\u901a\u4fe1\u3002\n\u4f7f\u7528 [mTLS](https://wikipedia.org/wiki/Mutual_authentication#mTLS) \u64f4\u5c55 TLS \u4ee5\u5be6\u73fe\u96d9\u5411\u8eab\u4efd\u9a57\u8b49\u65b9\u6848\uff0c\u4f7f\u5f97\u9023\u63a5\u7684\u96d9\u65b9\u90fd\u80fd\u5920\u78ba\u5b9a\u5f7c\u6b64\u7684\u8eab\u4efd\u3002\n\u5982\u9700\u77ad\u89e3\u5982\u4f55\u4f7f\u7528 TLS\uff0c\u8acb\u53c3\u95b1 [Google Cloud \u4e0a\u7684\u7368\u7acb MQTT \u4ee3\u7406\u67b6\u69cb](https://cloud.google.com/architecture/connected-devices/mqtt-broker-architecture?hl=zh-cn) \u548c [Google Cloud \u4e0a\u7684 IoT \u5e73\u81fa\u7522\u54c1\u67b6\u69cb](https://cloud.google.com/architecture/connected-devices/iot-platform-product-architecture?hl=zh-cn) \u3002\n## MQTT \u4ee3\u7406\u7684\u8b49\u66f8\u7ba1\u7406\u7684\u6700\u4f73\u505a\u6cd5\n\u672c\u90e8\u5206\u4ecb\u7d39\u4f7f\u7528 MQTT \u4ee3\u7406\u6642\u7ba1\u7406\u8b49\u66f8\u7684\u6700\u4f73\u505a\u6cd5\u3002\n### \u96c6\u4e2d\u5b58\u5132\u8b49\u66f8\n\u5728\u4e00\u500b\u4f4d\u7f6e\u96c6\u4e2d\u5b58\u5132\u548c\u7ba1\u7406\u670d\u52d9\u5668\u8b49\u66f8\u53ca\u8a2d\u5099\u8b49\u66f8\u3002\u5177\u9ad4\u4f86\u8aaa\uff0c\u8acb\u78ba\u4fdd\u60a8\u5be6\u65bd\u4e86\u4ee5\u4e0b\u63a7\u5236\u63aa\u65bd\uff1a\n- \u5305\u542b\u6240\u6709\u8a2d\u5099\u53ca\u5176\u8b49\u66f8\u4ee5\u53ca\u670d\u52d9\u5668\u7aef\u9ede\u53ca\u5176\u8b49\u66f8\u7684\u6e05\u55ae\u3002\n- \u64c1\u6709\u6709\u95dc\u8b49\u66f8\u7684\u5176\u4ed6\u4fe1\u606f\uff0c\u4f8b\u5982\u8b49\u66f8\u7684\u6709\u6548\u6027\u3002\n- \u80fd\u5920\u7232\u8a2d\u5099\u6dfb\u52a0\u548c\u79fb\u9664\u8b49\u66f8\uff0c\u4ee5\u4fbf\u8a2d\u5099\u53ef\u4ee5\u4f7f\u7528\u65b0\u8b49\u66f8\u9032\u884c\u9023\u63a5\u3002\n- \u64c1\u6709\u5c0d\u4e2d\u592e\u8b49\u66f8\u5b58\u5132\u5340\u7684\u8a2a\u554f\u6b0a\u9650\uff0c\u53ef\u9650\u5236\u5f8c\u7aef\u4e2d\u7684\u4e0d\u540c\u89d2\u8272\u5c0d\u8b49\u66f8\u57f7\u884c\u7684\u64cd\u4f5c\u3002\n\u4f7f\u7528 Secret \u5b58\u5132\u548c\u7ba1\u7406\u89e3\u6c7a\u65b9\u6848\uff0c\u4f8b\u5982 Secret Manager \u6216 HashiCorp Vault\u3002Secret Manager \u5141\u8a31\u60a8\u5c0d\u8a2d\u5099\u6191\u64da\u57f7\u884c\u7248\u672c\u63a7\u5236\u3001\u66f4\u65b0\u548c\u5931\u6548\u64cd\u4f5c\uff0c\u4ee5\u53ca [\u7ba1\u7406\u6191\u64da\u7684\u8a2a\u554f\u6b0a\u9650\u653f\u7b56](https://cloud.google.com/secret-manager/docs/access-control?hl=zh-cn) \u3002\n\u5c0d\u65bc IoT \u5e73\u81fa\uff0c\u8acb\u4f7f\u7528 [Secret Manager API \u8a2a\u554f\u6b0a\u9650](https://cloud.google.com/secret-manager/docs/accessing-the-api?hl=zh-cn) \u5be6\u73fe\u5c0d\u6191\u64da\u7684\u8a2a\u554f\u3002\n### \u4fdd\u8b77\u908a\u7de3\u8a2d\u5099\u4e0a\u7684\u8b49\u66f8\n\u5982\u9700\u5728\u908a\u7de3\u8a2d\u5099\u4e0a\u5b58\u5132\u8b49\u66f8\u548c\u5bc6\u9470\uff0c\u8acb\u4f7f\u7528\u672c\u5730 [\u53ef\u4fe1\u57f7\u884c\u74b0\u5883](https://wikipedia.org/wiki/Trusted_execution_environment) \u6216\u8b49\u66f8\u5b58\u5132\u5340\u4f86\u4fdd\u8b77\u6191\u64da\u4e26\u963b\u6b62\u672a\u7d93\u6388\u6b0a\u7684\u8a2a\u554f\u3002\u5982\u679c\u60a8\u9700\u8981\u5728\u81ea\u5df1\u7684\u8a2d\u5099\u4e0a\u5b58\u5132 Secret \u6750\u6599\uff0c\u8acb\u4f7f\u7528 [Flash \u52a0\u5bc6](https://docs.espressif.com/projects/esp-idf/en/latest/esp32/security/flash-encryption.html) \u7b49\u6280\u8853\u5c0d\u6750\u6599\u9032\u884c\u52a0\u5bc6\uff0c\u4e26\u5c07\u6750\u6599\u5b58\u5132\u5728\u9632\u7be1\u6539\u5143\u7d20\u4e2d\uff0c\u4ee5\u9632\u6b62\u672a\u7d93\u6388\u6b0a\u7684\u6578\u64da\u63d0\u53d6\u3002\n### \u4f7f\u4e2d\u592e\u8b49\u66f8\u5b58\u5132\u5340\u8207 MQTT \u4ee3\u7406\u8b49\u66f8\u5b58\u5132\u5340\u540c\u6b65\nMQTT \u4ee3\u7406\u5fc5\u9808\u8a2a\u554f\u5ba2\u6236\u7aef\u8b49\u66f8\u4ee5\u9032\u884c\u57fa\u65bc\u8b49\u66f8\u7684\u8eab\u4efd\u9a57\u8b49\uff0c\u56e0\u6b64\u60a8\u5fc5\u9808\u540c\u6b65 MQTT \u4ee3\u7406\u7684\u8b49\u66f8\u5b58\u5132\u5340\u8207\u4e2d\u592e\u8b49\u66f8\u5b58\u5132\u5340\u3002\u9a57\u8b49\u4e2d\u592e\u8b49\u66f8\u5b58\u5132\u5340\u4e2d\u7684\u66f4\u6539\uff08\u4f8b\u5982\u6dfb\u52a0\u3001\u66f4\u65b0\u548c\u522a\u9664\u8b49\u66f8\uff09\u662f\u5426\u8207 MQTT \u4ee3\u7406\u8b49\u66f8\u5b58\u5132\u5340\u540c\u6b65\u3002MQTT \u4ee3\u7406\u4f7f\u7528 MySQL\u3001PostgresDB \u548c Java \u5bc6\u9470\u5eab\u7b49\u8b49\u66f8\u5b58\u5132\u5340\u3002\u6839\u64da MQTT \u4ee3\u7406\u4f7f\u7528\u7684\u8b49\u66f8\uff0c\u78ba\u4fdd\u5b58\u5728\u4ee5\u4e0b\u904e\u7a0b\uff1a\n- \u76e3\u63a7\u4e2d\u592e\u8b49\u66f8\u5b58\u5132\u5340\u4e2d\u7684\u66f4\u6539\u4e26\u901a\u77e5\u540c\u6b65\u904e\u7a0b\u7684\u904e\u7a0b\u3002\n- \u7372\u53d6\u4e2d\u592e\u8b49\u66f8\u5b58\u5132\u5340\u4e2d\u7684\u66f4\u6539\u4e26\u4f7f\u4e2d\u592e\u8b49\u66f8\u5b58\u5132\u5340\u4e2d\u7684\u66f4\u6539\u8207 MQTT \u4ee3\u7406\u4f7f\u7528\u7684\u8b49\u66f8\u5b58\u5132\u5340\u540c\u6b65\u7684\u904e\u7a0b\u3002\n\u4f7f\u7528 Secret Manager \u4f5c\u7232\u8b49\u66f8\u5b58\u5132\u5340\u6642\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528 [\u4e8b\u4ef6\u901a\u77e5](https://cloud.google.com/secret-manager/docs/event-notifications?hl=zh-cn) \u4f5c\u7232\u76e3\u63a7\u904e\u7a0b\u3002\u60a8\u53ef\u4ee5\u5c07\u540c\u6b65\u904e\u7a0b\u5be6\u73fe\u7232\u4e8b\u4ef6\u901a\u77e5\u7684\u76e3\u807d\u5668\u3002\n### \u5c07\u8b49\u66f8\u5b89\u5168\u5730\u5206\u767c\u5230\u908a\u7de3\u8a2d\u5099\n\u4f7f\u7528 MQTT \u4ee3\u7406\u6642\uff0c\u8acb\u5c07\u6839\u8b49\u66f8\u548c\u5ba2\u6236\u7aef\u8b49\u66f8\u5206\u767c\u5230\u60a8\u7684\u908a\u7de3\u8a2d\u5099\u3002\u5206\u767c\u8b49\u66f8\u6642\uff0c\u60a8\u5fc5\u9808\u4fdd\u8b77\u901a\u4fe1\u901a\u9053\uff0c\u4ee5\u907f\u514d\u6d41\u91cf\u88ab\u6514\u622a\u3002\n\u7528\u65bc\u5206\u767c\u8b49\u66f8\u7684\u4e3b\u8981\u901a\u4fe1\u901a\u9053\u5982\u4e0b\uff1a\n- \u901a\u904e\u73fe\u6709\u901a\u4fe1\u901a\u9053\u5f9e IoT \u5f8c\u7aef\u5230\u908a\u7de3\u8a2d\u5099\u7684\u76f4\u63a5\u8def\u5f91\u3002\n- \u908a\u7de3\u8a2d\u5099\u8acb\u6c42\u4e26\u4e0b\u8f09\u8b49\u66f8\u7684\u9593\u63a5\u8def\u5f91\u3002\n\u5728\u5206\u767c\u8b49\u66f8\u671f\u9593\uff0c\u60a8\u9700\u8981\u4ee5\u4e0b\u7d44\u4ef6\uff1a\n- \u8b49\u66f8\u5b58\u5132\u5340\uff0c\u7528\u65bc\u96c6\u4e2d\u7ba1\u7406\u8b49\u66f8\u3002\n- \uff0c\u7528\u65bc\u7232\u6bcf\u500b\u908a\u7de3\u8a2d\u5099\u767c\u9001\u8b49\u66f8\u4e26\u8ddf\u8e64\u5206\u767c\u904e\u7a0b\u3002\n- \u908a\u7de3\u8a2d\u5099\u4e0a\u7684\u66f4\u65b0\u8655\u7406\u7a0b\u5e8f\uff0c\u7528\u65bc\u63a5\u6536\u6216\u4e0b\u8f09\u8b49\u66f8\u4e26\u5c07\u8b49\u66f8\u5b58\u5132\u5728\u8a2d\u5099\u4e0a\u3002\n\u5728\u908a\u7de3\u8a2d\u5099\u7684\u9810\u914d\u904e\u7a0b\u4e2d\u4ee5\u53ca\u5728\u9700\u8981\u8f2a\u66ff\u8b49\u66f8\u6642\u5206\u767c\u8b49\u66f8\u3002\n\u5728\u9810\u914d\u904e\u7a0b\u4e2d\uff0c\u8acb\u78ba\u4fdd\u9810\u914d\u8005\u80fd\u5920\u901a\u904e\u52a0\u5bc6\u901a\u9053\uff08\u4f8b\u5982 [SSH](https://wikipedia.org/wiki/Secure_Shell) \uff09\u4e26\u4f7f\u7528\u8af8\u5982 [SCP](https://wikipedia.org/wiki/Secure_copy_protocol) \u4e4b\u985e\u7684\u5de5\u5177\u76f4\u63a5\u8a2a\u554f\u908a\u7de3\u8a2d\u5099\u3002\u7531\u65bc\u8a2d\u5099\u672a\u5de5\u4f5c\uff0c\u56e0\u6b64\u60a8\u53ef\u4ee5\u5c07\u8b49\u66f8\u76f4\u63a5\u63a8\u9001\u5230\u908a\u7de3\u8a2d\u5099\u3002\n\u8f2a\u66ff\u8b49\u66f8\u6642\uff0c\u4f7f\u7528 MQTT \u4ee3\u7406\u4f5c\u7232\u5206\u767c\u5354\u8abf\u5668\u548c\u908a\u7de3\u8a2d\u5099\u4e4b\u9593\u7684\u901a\u4fe1\u901a\u9053\u3002\u4f7f\u7528\u5176\u4ed6\u901a\u9053\u5c07\u8b49\u66f8\u4e0b\u8f09\u5230\u8a2d\u5099\u4e0a\u3002\u7232\u4e86\u6700\u5927\u9650\u5ea6\u5730\u6e1b\u5c11\u908a\u7de3\u8a2d\u5099\u7684\u5de5\u4f5c\u4e2d\u65b7\uff0c\u8acb\u4f7f\u7528\u9593\u63a5\u8b49\u66f8\u5206\u767c\u8def\u5f91\u3002\u6b64\u904e\u7a0b\u5c07\u5305\u62ec\u4ee5\u4e0b\u908f\u8f2f\u6b65\u9a5f\uff1a\n- \u5206\u767c\u5354\u8abf\u5668\u5f9e\u8b49\u66f8\u5b58\u5132\u5340\u7372\u53d6\u8a2a\u554f\u6191\u64da\u3002\n- \u5206\u767c\u5354\u8abf\u5668\u5c07\u8b49\u66f8\u8a2a\u554f\u6191\u64da\u548c\u5176\u4ed6\u4fe1\u606f\uff08\u4f8b\u5982\u4e0b\u8f09\u7db2\u5740\uff09\u4e00\u8d77\u63a8\u9001\u5230\u908a\u7de3\u8a2d\u5099\u3002\n- \u8a2d\u5099\u4e0a\u7684\u66f4\u65b0\u8655\u7406\u7a0b\u5e8f\u63a5\u6536\u8a2a\u554f\u6191\u64da\uff0c\u81e8\u6642\u5b58\u5132\u4fe1\u606f\u4e26\u5411\u5206\u767c\u5354\u8abf\u5668\u78ba\u8a8d\u6536\u5230\u6191\u64da\u3002\n- \u66f4\u65b0\u8655\u7406\u7a0b\u5e8f\u6703\u5354\u8abf\u5728\u8a2d\u5099\u8655\u65bc\u975e\u6d3b\u52d5\u72c0\u614b\u6642\u4e0b\u8f09\u8b49\u66f8\u3002\u66f4\u65b0\u8655\u7406\u7a0b\u5e8f\u4f7f\u7528\u8a2a\u554f\u6191\u64da\u5f9e\u6191\u64da\u5b58\u5132\u7a7a\u9593\u4e0b\u8f09\u8b49\u66f8\u3002\n- \u4e0b\u8f09\u8b49\u66f8\u5f8c\uff0c\u66f4\u65b0\u8655\u7406\u7a0b\u5e8f\u7e7c\u7e8c\u57f7\u884c\u8b49\u66f8\u8f2a\u66ff\u9032\u7a0b\uff0c\u5982 [\u8b49\u66f8\u8f2a\u66ff](#certificate-rotation) \u90e8\u5206\u4e2d\u6240\u8ff0\u3002\n\u4f7f\u7528 Secret Manager \u4f5c\u7232\u4e2d\u592e\u8b49\u66f8\u5b58\u5132\u5340\u6642\uff0c\u60a8\u53ef\u4ee5\u751f\u6210 [\u77ed\u671f\u8a2a\u554f\u4ee4\u724c](https://cloud.google.com/secret-manager/docs/accessing-the-api?hl=zh-cn#authenticating) \u4f86\u6388\u4e88\u548c\u9650\u5236\u5c0d\u8b49\u66f8\u7684\u8a2a\u554f\u3002\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [\u5c07\u8a2a\u554f\u4ee4\u724c\u5b89\u5168\u5730\u5206\u767c\u7d66\u8a2d\u5099](#access-tokens) \u3002\n\u7232\u9632\u6b62\u8b49\u66f8\u5728\u50b3\u8f38\u904e\u7a0b\u4e2d\u516c\u958b\uff0c\u8acb\u52a0\u5bc6\u908a\u7de3\u8a2d\u5099\u8207 MQTT \u4ee3\u7406\u4e4b\u9593\u7684\u9023\u63a5\u3002\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [\u7db2\u7d61\u9023\u63a5\u7684\u6700\u4f73\u505a\u6cd5](#network-connectivity) \u3002\n### \u81ea\u52d5\u8f2a\u66ff\u8b49\u66f8\n\u7232\u4e86\u9650\u5236\u6cc4\u9732\u7684\u8b49\u66f8\u53ef\u80fd\u9020\u6210\u7684\u640d\u5bb3\uff0c\u8acb\u751f\u6210\u6709\u6548\u6642\u9593\u6709\u9650\u7684\u8b49\u66f8\uff0c\u4e26\u5728\u8b49\u66f8\u904e\u671f\u4e4b\u524d\u8f2a\u66ff\u8b49\u66f8\u3002\u5c0d\u65bc\u5927\u898f\u6a21\u7684 IoT \u90e8\u7f72\uff0c\u8acb\u5be6\u73fe\u81ea\u52d5\u8b49\u66f8\u8f2a\u66ff\u7a0b\u5e8f\uff0c\u4ee5\u4fbf\u5728\u820a\u8b49\u66f8\u5931\u6548\u4e4b\u524d\u4f7f\u7528\u65b0\u8b49\u66f8\u6301\u7e8c\u66f4\u65b0\u8a2d\u5099\u3002\u6c92\u6709\u6709\u6548\u8b49\u66f8\u7684\u5df2\u90e8\u7f72\u8a2d\u5099\u610f\u5473\u7740\u8a2d\u5099\u53ef\u80fd\u6703\u505c\u6b62\u5de5\u4f5c\uff0c\u9019\u53ef\u80fd\u6703\u4f7f\u5f97\u4fee\u5fa9 IoT \u89e3\u6c7a\u65b9\u6848\u7684\u6210\u672c\u9ad8\u6602\uff0c\u4e26\u4e14\u6703\u5c0d IoT \u89e3\u6c7a\u65b9\u6848\u7684\u6574\u9ad4\u529f\u80fd\u7522\u751f\u8ca0\u9762\u5f71\u97ff\u3002\n\u60a8\u7684\u908a\u7de3\u8a2d\u5099\u5fc5\u9808\u8207 MQTT \u4ee3\u7406\u9032\u884c\u96d9\u5411\u9023\u63a5\uff0c\u4ee5\u78ba\u4fdd\u5b83\u5011\u53ef\u4ee5\u5411 MQTT \u4ee3\u7406\u767c\u9001\u6d88\u606f\uff0c\u4e26\u4e14\u53ef\u4ee5\u63a5\u6536\u4f86\u81ea MQTT \u4ee3\u7406\u7684\u6d88\u606f\u3002\n\u5728\u8b49\u66f8\u8f2a\u66ff\u671f\u9593\uff0c\u60a8\u9700\u8981\u4ee5\u4e0b\u7d44\u4ef6\uff1a\n- \u76e3\u63a7\u9032\u7a0b\uff0c\u7528\u65bc\u5b9a\u671f\u6383\u63cf\u8b49\u66f8\u6e05\u55ae\uff0c\u4e26\u67e5\u627e\u5373\u5c07\u904e\u671f\u7684\u8b49\u66f8\u3002\u76e3\u63a7\u9032\u7a0b\u6703\u89f8\u767c\u5373\u5c07\u5931\u6548\u7684\u8b49\u66f8\u7684\u8b49\u66f8\u8f2a\u66ff\u3002\n- \u521d\u59cb\u5316\u548c\u76e3\u7763\u8b49\u66f8\u8f2a\u66ff\u7684\u8f2a\u66ff\u9032\u7a0b\u3002\n- \u908a\u7de3\u8a2d\u5099\u4e0a\u8207 MQTT \u4ee3\u7406\u901a\u4fe1\u4e26\u57f7\u884c\u8b49\u66f8\u8f2a\u66ff\u6b65\u9a5f\u7684\u8a2d\u5099\u8b49\u66f8\u8f2a\u66ff\u8655\u7406\u7a0b\u5e8f\u3002\n\u7232\u4e86\u8f2a\u66ff\u8b49\u66f8\uff0cIoT \u89e3\u6c7a\u65b9\u6848\u9700\u8981\u5b8c\u6210\u4ee5\u4e0b\u6b65\u9a5f\uff1a\n- \u8f2a\u66ff\u9032\u7a0b\u6703\u5411\u908a\u7de3\u8a2d\u5099\u767c\u9001\u521d\u59cb\u5316\u6d88\u606f\uff0c\u4ee5\u5553\u52d5\u8b49\u66f8\u8f2a\u66ff\u3002\n- \u8a2d\u5099\u8b49\u66f8\u8f2a\u66ff\u8655\u7406\u7a0b\u5e8f\u901a\u904e\u5c07\u97ff\u61c9\u767c\u9001\u56de\u8f2a\u66ff\u4f5c\u696d\u4f86\u78ba\u8a8d\u521d\u59cb\u5316\u6d88\u606f\u3002\n- \u8f2a\u66ff\u9032\u7a0b\u5411 CA \u8acb\u6c42\u65b0\u8b49\u66f8\u3002\u6b64\u8acb\u6c42\u8207 [\u8b49\u66f8\u9810\u914d](#protect-certificates) \u8acb\u6c42\u985e\u4f3c\uff0c\u4e0d\u540c\u4e4b\u8655\u5728\u65bc\u5bc6\u9470\u548c CSR \u4ee5 MQTT \u4ee3\u7406\u6d88\u606f\u7684\u5f62\u5f0f\u767c\u9001\u3002\n- \u5f9e CA \u6536\u5230\u65b0\u8b49\u66f8\u5f8c\uff0c\u8f2a\u66ff\u4f5c\u696d\u5c07\u8b49\u66f8\u5206\u767c\u5230\u4e2d\u592e\u8b49\u66f8\u5b58\u5132\u5340\u548c\u908a\u7de3\u8a2d\u5099\u3002\u5b83\u9084\u5c07\u8b49\u66f8\u540c\u6b65\u5230 MQTT \u4ee3\u7406\u7684\u8b49\u66f8\u5b58\u5132\u5340\u3002\n- \u8a2d\u5099\u8b49\u66f8\u8f2a\u66ff\u8655\u7406\u7a0b\u5e8f\u5b58\u5132\u65b0\u8b49\u66f8\uff0c\u4e26\u4f7f\u7528\u65b0\u8b49\u66f8\u521d\u59cb\u5316\u8207 MQTT \u4ee3\u7406\u7684\u65b0\u9023\u63a5\u3002\n- \u5efa\u7acb\u65b0\u9023\u63a5\u5f8c\uff0c\u8a2d\u5099\u8b49\u66f8\u8f2a\u66ff\u8655\u7406\u7a0b\u5e8f\u5411 MQTT \u4ee3\u7406\u767c\u9001\u5df2\u5b8c\u6210\u6d88\u606f\u3002\n- \u6536\u5230\u5df2\u5b8c\u6210\u6d88\u606f\u5f8c\uff0c\u8f2a\u66ff\u9032\u7a0b\u4f7f\u4e2d\u592e\u8b49\u66f8\u5b58\u5132\u5340\u4e2d\u7684\u820a\u8b49\u66f8\u5931\u6548\u3002\n\u7232\u4e86\u5e6b\u52a9\u4fdd\u8b77\u5728\u8f2a\u66ff\u9032\u7a0b\u4e2d\u767c\u9001\u7684\u8b49\u66f8\uff0c\u8acb\u4f7f\u7528\u5c08\u7528 MQTT \u4e3b\u984c\u9032\u884c\u8b49\u66f8\u8f2a\u66ff\u3002\u50c5\u5141\u8a31\u8f2a\u66ff\u4f5c\u696d\u548c\u908a\u7de3\u8a2d\u5099\u8a2a\u554f\u9019\u4e9b\u4e3b\u984c\u3002\n\u7232\u4e86\u5e6b\u52a9\u4fdd\u8b77\u8b49\u66f8\u8f2a\u66ff\u9032\u7a0b\u514d\u53d7\u904b\u884c\u6642\u6545\u969c\u7684\u5f71\u97ff\uff0c\u8acb\u7232\u66f4\u6539\u548c\u9032\u5ea6\u5553\u7528\u6301\u4e45\u5316\u3002\n\u5982\u9700\u8a73\u7d30\u77ad\u89e3\u5982\u4f55\u4f7f\u7528 Secret Manager \u8f2a\u66ff Secret\uff0c\u8acb\u53c3\u95b1 [Secret \u8f2a\u66ff](https://cloud.google.com/secret-manager/docs/rotation-recommendations?hl=zh-cn) \u3002\n## IoT \u5e73\u81fa\u8b49\u66f8\u7ba1\u7406\u7684\u6700\u4f73\u505a\u6cd5\n\u5982\u679c\u60a8\u4f7f\u7528\u7684\u662f IoT \u5e73\u81fa\uff0c\u8acb\u4f7f\u7528\u8a72\u5e73\u81fa\u63d0\u4f9b\u7684\u8b49\u66f8\u66f4\u65b0\u548c\u5206\u767c\u6a5f\u5236\u3002\u51fa\u65bc\u5099\u4efd\u76ee\u7684\uff0c\u60a8\u53ef\u4ee5\u5b9a\u671f\u5c07\u6191\u64da\u5f9e IoT \u5e73\u81fa\u5c0e\u51fa\u5230\u8f14\u52a9 Secret \u5b58\u5132\uff0c\u4f8b\u5982 Secret Manager\u3002\n## \u4f7f\u7528 MQTT \u4ee3\u7406\u9032\u884c\u8eab\u4efd\u9a57\u8b49\u7684\u6700\u4f73\u505a\u6cd5\n\u5728\u96d9\u5411\u8eab\u4efd\u9a57\u8b49\u904e\u7a0b\u4e2d\uff0c\u5f8c\u7aef\u5de5\u4f5c\u8ca0\u8f09\u6703\u9a57\u8b49\u908a\u7de3\u8a2d\u5099\u7684\u8eab\u4efd\uff0c\u908a\u7de3\u8a2d\u5099\u4e5f\u6703\u9a57\u8b49\u5f8c\u7aef\u5de5\u4f5c\u8ca0\u8f09\u7684\u8eab\u4efd\u3002\u5728\u5f8c\u7aef\u5de5\u4f5c\u8ca0\u8f09\u78ba\u8a8d\u908a\u7de3\u8a2d\u5099\u7684\u8eab\u4efd\u5f8c\uff0c\u5f8c\u7aef\u5de5\u4f5c\u8ca0\u8f09\u7232\u6703\u8a2d\u5099\u6388\u4e88\u8a2a\u554f\u8cc7\u6e90\u7684\u6b0a\u9650\u3002\n\u4ee5\u4e0b\u90e8\u5206\u4ecb\u7d39\u4e86\u4f7f\u7528 MQTT \u4ee3\u7406\u6642\u8eab\u4efd\u9a57\u8b49\u65b9\u6cd5\u7684\u6700\u4f73\u505a\u6cd5\u3002\n**\u6ce8\u610f\uff1a** \u5927\u591a\u6578\u5546\u696d IoT \u5e73\u81fa\u61c9\u7528\u90fd\u652f\u6301\u81ea\u5df1\u7684\u4e00\u7d44\u8eab\u4efd\u9a57\u8b49\u65b9\u6848\u3002\n### \u7232 MQTT \u4ee3\u7406\u9078\u64c7\u8eab\u4efd\u9a57\u8b49\u65b9\u6cd5\n\u4e0d\u540c\u7684 IoT \u5f8c\u7aef\u652f\u6301\u4e0d\u540c\u7684\u8eab\u4efd\u9a57\u8b49\u65b9\u6cd5\u3002\u5e38\u7528\u7684\u65b9\u6cd5\u5982\u4e0b\uff1a\n- **\u7528\u6236\u540d\u548c\u5bc6\u78bc\u8eab\u4efd\u9a57\u8b49** \uff1a\u5728\u6b64\u65b9\u6cd5\u4e2d\uff0c\u908a\u7de3\u8a2d\u5099\u63d0\u4f9b\u5176\u7528\u6236\u540d\u548c\u5bc6\u78bc\u4ee5\u9a57\u8b49\u5176\u8eab\u4efd\u3002\n- **\u57fa\u65bc\u4ee4\u724c\u7684\u8eab\u4efd\u9a57\u8b49** \uff1a\u5728\u6b64\u65b9\u6cd5\u4e2d\uff0c\u4f7f\u7528\u52a0\u5bc6\u7684\u5b89\u5168\u4ee4\u724c\u4f86\u9a57\u8b49\u908a\u7de3\u8a2d\u5099\u7684\u8eab\u4efd\u3002\n- **\u81ea\u5b9a\u7fa9\u8eab\u4efd\u9a57\u8b49\u65b9\u6848** \uff1a\u5728\u6b64\u65b9\u6cd5\u4e2d\uff0c\u60a8\u5be6\u73fe\u81ea\u5b9a\u7fa9\u6a5f\u5236\u4f86\u9a57\u8b49\u908a\u7de3\u8a2d\u5099\u7684\u8eab\u4efd\u3002\n\u4f5c\u7232 [MQTT \u6a19\u6e96](http://docs.oasis-open.org/mqtt/mqtt/v3.1.1/os/mqtt-v3.1.1-os.html#_Toc398718116) \u7684\u4e00\u90e8\u5206\uff0cMQTT \u4ee3\u7406\u652f\u6301\u4f7f\u7528\u7528\u6236\u540d\u548c\u5bc6\u78bc\u9032\u884c\u8eab\u4efd\u9a57\u8b49\u4f5c\u7232 [MQTT CONNECT](https://docs.oasis-open.org/mqtt/mqtt/v5.0/os/mqtt-v5.0-os.html#_Toc3901033) \u6578\u64da\u5305\u7684\u9ed8\u8a8d\u65b9\u6cd5\u3002\n`MQTT CONNECT` \u6578\u64da\u5305\u9084\u5305\u542b [Client Identifier](https://docs.oasis-open.org/mqtt/mqtt/v5.0/os/mqtt-v5.0-os.html#_Toc3901058) \u5b57\u6bb5\uff0c\u53ef\u7528\u65bc\u552f\u4e00\u6a19\u8b58 MQTT \u4ee3\u7406\u7684\u5ba2\u6236\u7aef\u3002\u908a\u7de3\u8a2d\u5099\u6703\u5728\u5efa\u7acb\u9023\u63a5\u6642\u5c07 `MQTT CONNECT` \u6578\u64da\u5305\u767c\u9001\u5230 MQTT \u4ee3\u7406\u3002\n\u9664\u4e86 `MQTT CONNECT` \u6578\u64da\u5305\u4e2d\u7684\u7528\u6236\u540d\u3001\u5bc6\u78bc\u548c\u5ba2\u6236\u7aef\u6a19\u8b58\u7b26\u5b57\u6bb5\u4e4b\u5916\uff0cMQTT 5.0 \u9084\u652f\u6301 [\u589e\u5f37\u578b\u8eab\u4efd\u9a57\u8b49](https://docs.oasis-open.org/mqtt/mqtt/v5.0/os/mqtt-v5.0-os.html#_Toc3901256) \uff0c\u4f7f\u60a8\u80fd\u5920\u69cb\u5efa [\u8cea\u8a62/\u97ff\u61c9](https://wikipedia.org/wiki/Challenge%E2%80%93response_authentication) \u8eab\u4efd\u9a57\u8b49\u6d41\u7a0b\u3002MQTT 5.0 \u5141\u8a31\u908a\u7de3\u8a2d\u5099\u8207 MQTT \u4ee3\u7406\u4e4b\u9593\u7684\u591a\u500b [AUTH](https://docs.oasis-open.org/mqtt/mqtt/v5.0/os/mqtt-v5.0-os.html#_Toc3901217) \u6578\u64da\u5305\u4ea4\u63db\u3002\n### \u5c07\u5bc6\u78bc\u5b58\u5132\u5340\u8207\u7528\u6236\u540d\u548c\u5bc6\u78bc\u8eab\u4efd\u9a57\u8b49\u7d50\u5408\u4f7f\u7528\n\u5c0d\u65bc\u7528\u6236\u540d\u548c\u5bc6\u78bc\u8eab\u4efd\u9a57\u8b49\uff0c\u8acb\u5c07 MQTT \u4ee3\u7406\u914d\u7f6e\u7232\u4f7f\u7528\u5bc6\u78bc\u5b58\u5132\u5340\u3002\u5bc6\u78bc\u5b58\u5132\u5340\u63d0\u4f9b\u4e86\u4e00\u500b\u96c6\u4e2d\u4f4d\u7f6e\uff0c\u7528\u65bc\u7ba1\u7406\u9023\u63a5\u5230 MQTT \u4ee3\u7406\u7684\u6240\u6709\u908a\u7de3\u8a2d\u5099\u7684\u5bc6\u78bc\u3002\u9ed8\u8a8d\u60c5\u6cc1\u4e0b\uff0cMQTT \u898f\u7bc4\u4e2d\u7684\u7528\u6236\u540d\u3001\u5bc6\u78bc\u548c\u5ba2\u6236\u7aef\u6a19\u8b58\u7b26\u5b57\u6bb5\u7232\u53ef\u9078\u5b57\u6bb5\u3002\u56e0\u6b64\uff0c\u8acb\u8a2d\u8a08\u8eab\u4efd\u9a57\u8b49\u6a5f\u5236\u4ee5\u9a57\u8b49 `MQTT CONNECT` \u6578\u64da\u5305\u4e2d\u662f\u5426\u5b58\u5728\u7528\u6236\u540d\u3001\u5bc6\u78bc\u548c\u5ba2\u6236\u7aef\u6a19\u8b58\u7b26\u5b57\u6bb5\u3002\n\u78ba\u4fdd\u5c0d\u975c\u614b\u5bc6\u78bc\u548c\u50b3\u8f38\u4e2d\u5bc6\u78bc\u9032\u884c\u52a0\u5bc6\uff0c\u5982\u4e0b\u6240\u793a\uff1a\n- \u5c0d\u65bc\u975c\u614b\u5bc6\u78bc\uff0c\u5c07\u6703\u5b58\u5132\u5bc6\u78bc\u7684\u52a0\u5bc6\u5f37\u54c8\u5e0c\uff1b\u8a72\u5bc6\u78bc\u7121\u6cd5\u9006\u8f49\u3002\u5982\u9700\u8a73\u7d30\u77ad\u89e3\u5982\u4f55\u5c0d\u5bc6\u78bc\u9032\u884c\u54c8\u5e0c\u8655\u7406\uff0c\u8acb\u53c3\u95b1 [\u8cec\u865f\u8eab\u4efd\u9a57\u8b49\u548c\u5bc6\u78bc\u7ba1\u7406\u7684\u6700\u4f73\u505a\u6cd5](https://cloud.google.com/blog/products/identity-security/account-authentication-and-password-management-best-practices?hl=zh-cn) \u3002\n- \u5c0d\u65bc\u50b3\u8f38\u4e2d\u5bc6\u78bc\uff0c\u5c07\u6703\u52a0\u5bc6\u908a\u7de3\u8a2d\u5099\u8207 MQTT \u4ee3\u7406\u4e4b\u9593\u7684\u9023\u63a5\u3002\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [\u7db2\u7d61\u9023\u63a5\u7684\u6700\u4f73\u505a\u6cd5](#network-connectivity) \u3002\n### \u8003\u616e\u57fa\u65bc\u4ee4\u724c\u7684\u8eab\u4efd\u9a57\u8b49\n\u4f7f\u7528\u57fa\u65bc\u4ee4\u724c\u7684\u8eab\u4efd\u9a57\u8b49\u6642\uff0c\u908a\u7de3\u8a2d\u5099\u6703\u5411 MQTT \u4ee3\u7406\u767c\u9001\u4ee4\u724c\u4ee5\u9032\u884c\u8eab\u4efd\u9a57\u8b49\u3002\u8a2d\u5099\u53ef\u4ee5\u81ea\u884c\u751f\u6210\u4ee4\u724c\uff0c\u4e5f\u53ef\u4ee5\u5f9e\u5176\u4ed6\u8eab\u4efd\u9a57\u8b49\u670d\u52d9\u7372\u53d6\u4ee4\u724c\u3002\u8207\u5bc6\u78bc\u76f8\u6bd4\uff0c\u4ee4\u724c\u7684\u6709\u6548\u671f\u5f88\u77ed\uff1a\u4ee4\u724c\u50c5\u5728\u4e00\u6bb5\u6642\u9593\u5167\u6709\u6548\uff0c\u5177\u6709\u660e\u78ba\u7684\u5931\u6548\u65e5\u671f\u3002\u9a57\u8b49\u4ee4\u724c\u6642\uff0c\u59cb\u7d42\u6aa2\u67e5\u5230\u671f\u65e5\u671f\u3002\n[JSON Web \u4ee4\u724c (JWT)](https://wikipedia.org/wiki/JSON_Web_Token) \u662f\u4e00\u7a2e\u5be6\u73fe\u57fa\u65bc\u4ee4\u724c\u7684\u8eab\u4efd\u9a57\u8b49\u7684\u65b9\u6cd5\u3002Edge \u8a2d\u5099\u53ef\u4ee5\u751f\u6210 JWT \u4e26\u4f7f\u7528 MQTT \u4ee3\u7406\u9032\u884c\u8eab\u4efd\u9a57\u8b49\u3002JWT \u4f5c\u7232\u5bc6\u78bc\u5b57\u6bb5\u5d4c\u5165\u5230 MQTT CONNECT \u6578\u64da\u5305\u4e2d\u3002\nJWT \u7684\u512a\u52e2\u5982\u4e0b\uff1a\n- JWT \u5141\u8a31\u60a8\u9078\u64c7\u7528\u65bc\u5c0d\u4ee4\u724c\u9032\u884c\u7c3d\u540d\u7684\u52a0\u5bc6\u7b97\u6cd5\u3002JWT \u975e\u5e38\u9069\u5408\u53d7\u9650\u7684\u908a\u7de3\u8a2d\u5099\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528\u8cc7\u6e90\u5bc6\u96c6\u578b\u52a0\u5bc6\u7b97\u6cd5\uff08\u5982 ECC\uff09\u5c0d\u4ee4\u724c\u9032\u884c\u7c3d\u540d\u3002\n- \u4f7f\u7528\u516c\u9470\u52a0\u5bc6\u6642\uff0c\u79c1\u9470\u50c5\u7528\u65bc\u908a\u7de3\u8a2d\u5099\uff0c\u7d55\u4e0d\u6703\u8207\u5176\u4ed6\u65b9\u5171\u4eab\u3002\u79c1\u9470\u6709\u52a9\u65bc\u4f7f\u5f97\u6b64\u65b9\u6cd5\u6bd4\u7528\u6236\u540d\u548c\u5bc6\u78bc\u8eab\u4efd\u9a57\u8b49\u66f4\u5b89\u5168\uff0c\u56e0\u7232\u6191\u64da\u901a\u904e\u9023\u63a5\u767c\u9001\uff0c\u4e26\u4e14\u9700\u8981\u52a0\u5bc6\u6578\u64da\u3002\n### \u8003\u616e\u81ea\u5b9a\u7fa9\u8eab\u4efd\u9a57\u8b49\u65b9\u6848\n\u67d0\u4e9b MQTT \u4ee3\u7406\u652f\u6301\u4e0d\u540c\u7684\u8eab\u4efd\u9a57\u8b49\u6a5f\u5236\u548c\u5354\u8b70\u3002\u4f8b\u5982\uff0c\u5982\u679c\u60a8\u7684 MQTT \u4ee3\u7406\u652f\u6301\u81ea\u5b9a\u7fa9\u8eab\u4efd\u9a57\u8b49\u65b9\u6848\uff0c\u60a8\u53ef\u4ee5\u5c07\u5176\u914d\u7f6e\u7232\u652f\u6301\u4ee5\u4e0b\u5167\u5bb9\uff1a\n- **\u884c\u696d\u6a19\u6e96\u8eab\u4efd\u9a57\u8b49\u5354\u8b70** \uff0c\u4f8b\u5982 [OpenID Connect](https://openid.net/connect/) \u3001 [\u5b89\u5168\u65b7\u8a00\u6a19\u8a18\u8a9e\u8a00 (SAML)](https://wikipedia.org/wiki/Security_Assertion_Markup_Language) \u3001 [LDAP](https://wikipedia.org/wiki/Lightweight_Directory_Access_Protocol) \u3001 [Kerberos](https://wikipedia.org/wiki/Kerberos_(protocol)) \u548c [\u7c21\u55ae\u8eab\u4efd\u9a57\u8b49\u548c\u5b89\u5168\u5c64 (SASL)](https://wikipedia.org/wiki/Simple_Authentication_and_Security_Layer) \u3002\u9019\u4e9b\u5354\u8b70\u6703\u5c07\u8a2d\u5099\u8eab\u4efd\u9a57\u8b49\u59d4\u8a17\u7d66\u60a8\u73fe\u6709\u7684\u8eab\u4efd\u63d0\u4f9b\u65b9\u3002\u67d0\u4e9b MQTT \u4ee3\u7406\u652f\u6301\u589e\u5f37\u578b\u8eab\u4efd\u9a57\u8b49\u548c\u53ef\u64f4\u5c55\u7684\u8eab\u4efd\u9a57\u8b49\u6a5f\u5236\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528\u9019\u4e9b\u6a5f\u5236\u4f86\u64f4\u5c55 MQTT \u4ee3\u7406\u4ee5\u652f\u6301\u65b0\u7684\u5354\u8b70\u548c\u8eab\u4efd\u63d0\u4f9b\u65b9\u3002\n- **\u57fa\u65bc\u8b49\u66f8\u7684\u96d9\u5411\u8eab\u4efd\u9a57\u8b49** \u3002\u67d0\u4e9b MQTT \u4ee3\u7406\u652f\u6301\u96d9\u5411\u8eab\u4efd\u9a57\u8b49\u65b9\u6848\uff0c\u4f8b\u5982\u57fa\u65bc mTLS \u7684\u8eab\u4efd\u9a57\u8b49\u3002## \u8a2d\u5099\u8a2a\u554f\u6b0a\u9650\u63a7\u5236\u548c\u6388\u6b0a\u7684\u6700\u4f73\u505a\u6cd5\n\u7531\u65bc MQTT \u5354\u8b70\u7684\u767c\u4f48\u8005\u548c\u8a02\u95b1\u8005\u901a\u4fe1\u6a21\u5f0f\uff0c\u56e0\u6b64\u4f7f\u7528 MQTT \u4e3b\u984c\u5b9a\u7fa9\u8a2d\u5099\u8a2a\u554f\u6b0a\u9650\u63a7\u5236\u3002MQTT \u4e3b\u984c\u63a7\u5236\u8a2d\u5099\u8207 IoT \u5f8c\u7aef\u7684\u901a\u4fe1\u65b9\u5f0f\u3002\u6bcf\u500b IoT \u5f8c\u7aef\u90fd\u6709\u4e0d\u540c\u7684\u8a2a\u554f\u6b0a\u9650\u63a7\u5236\u548c\u6388\u6b0a\u5be6\u73fe\u65b9\u5f0f\uff0c\u56e0\u6b64\u8acb\u53c3\u95b1 IoT \u5f8c\u7aef\u6587\u6a94\uff0c\u77ad\u89e3\u5982\u4f55\u8a2d\u7f6e MQTT \u4e3b\u984c\u3002\n### \u4f7f\u7528\u55ae\u4e00\u7528\u9014\u7684\u670d\u52d9\u8cec\u865f\u8a2a\u554f Google Cloud \u8cc7\u6e90\n[\u5c0d Google Cloud \u8cc7\u6e90\u7684\u8a2a\u554f\u6b0a\u9650](https://cloud.google.com/iam/docs/manage-access-other-resources?hl=zh-cn) \u901a\u904e IAM \u5141\u8a31\u653f\u7b56\uff08\u8a72\u653f\u7b56\u5c07\u8cc7\u6e90\u8a2a\u554f\u6b0a\u9650\u8207\u4e00\u7d44\u4e3b\u8cec\u865f\u7d81\u5b9a\u8d77\u4f86\uff09\u9032\u884c\u7ba1\u7406\u3002\u5178\u578b\u7684\u4e3b\u8cec\u865f\u6709\u7528\u6236\u8cec\u865f\u3001\u670d\u52d9\u8cec\u865f\u548c\u7fa3\u7d44\u3002 [\u670d\u52d9\u8cec\u865f](https://cloud.google.com/iam/docs/service-accounts?hl=zh-cn#what_are_service_accounts) \u901a\u5e38\u4f9b\u61c9\u7528\u6216\u8a08\u7b97\u5de5\u4f5c\u8ca0\u8f09\u7528\u65bc\u5c0d\u96f2\u8cc7\u6e90\u9032\u884c\u5df2\u7372\u6388\u6b0a\u7684 API \u8abf\u7528\u3002\u901a\u904e\u670d\u52d9\u8cec\u865f\uff0cIoT \u908a\u7de3\u8a2d\u5099\u53ef\u4ee5\u8a2a\u554f\u96f2\u8cc7\u6e90\u3002\n\u7531\u65bc\u8a2d\u5099\u8eab\u4efd\u7531 IoT \u5f8c\u7aef\u7ba1\u7406\uff0c\u56e0\u6b64\u60a8\u5fc5\u9808\u5728 IoT \u5f8c\u7aef\u548c IAM \u4e4b\u9593\u6620\u5c04\u8eab\u4efd\uff0c\u4f3c\u7684\u908a\u7de3\u8a2d\u5099\u53ef\u4ee5\u8a2a\u554f Google Cloud \u8cc7\u6e90\u3002\n\u5982\u679c\u60a8\u8981\u7ba1\u7406\u5927\u91cf\u8a2d\u5099\uff0c\u800c\u6bcf\u500b Google Cloud \u9805\u76ee\u7684\u670d\u52d9\u8cec\u865f\u6578\u91cf\u5b58\u5728 [\u9650\u5236](https://cloud.google.com/iam/quotas?hl=zh-cn#quotas) \uff0c\u56e0\u6b64\u7121\u6cd5\u5be6\u73fe\u8a2d\u5099\u548c\u670d\u52d9\u8cec\u865f\u4e4b\u9593\u4e00\u5c0d\u4e00\u7684\u6620\u5c04\u3002\n\u61c9\u6539\u7232\u5275\u5efa\u8207 IoT \u89e3\u6c7a\u65b9\u6848\u9700\u8981\u8a2a\u554f\u7684\u96f2\u8cc7\u6e90\u76f8\u95dc\u806f\u7684\u670d\u52d9\u8cec\u865f\uff0c\u5982 [\u5275\u5efa\u55ae\u4e00\u7528\u9014\u7684\u670d\u52d9\u8cec\u865f](https://cloud.google.com/iam/docs/best-practices-service-accounts?hl=zh-cn#single-purpose) \u4e2d\u6240\u8ff0\u3002\u4f8b\u5982\uff0c\u7232\u4ee5\u4e0b\u6bcf\u500b\u4f7f\u7528\u5834\u666f\u5275\u5efa\u4e00\u500b\u552f\u4e00\u7684\u670d\u52d9\u8cec\u865f\uff1a\n- \u4e0b\u8f09\u8edf\u4ef6\u7684\u66f4\u65b0\u8edf\u4ef6\u5305\n- \u4e0a\u50b3\u5927\u578b\u5a92\u9ad4\u6587\u4ef6\n- \u5f9e\u5ef6\u9072\u6642\u9593\u4fe1\u606f\u6d41\u4e2d\u63d0\u53d6\u6578\u64da\n\u7232\u4e86\u5be6\u73fe [\u6700\u5c0f\u6b0a\u9650](https://cloud.google.com/iam/docs/using-iam-securely?hl=zh-cn#least_privilege) \uff0c\u8acb\u78ba\u4fdd\u6bcf\u500b\u670d\u52d9\u8cec\u865f\u50c5\u5177\u6709\u8db3\u5920\u7684\u8a2a\u554f\u6b0a\u9650\u4f86\u652f\u6301\u5176\u4f7f\u7528\u5834\u666f\u3002\u4f8b\u5982\uff0c\u5c0d\u65bc\u7528\u65bc\u4e0b\u8f09\u8edf\u4ef6\u5305\u7684\u670d\u52d9\u8cec\u865f\uff0c\u8acb\u50c5\u6388\u4e88\u5c0d Cloud Storage \u5b58\u5132\u6876\u7684\u8b80\u53d6\u6b0a\u9650\u3002\n### \u5c07\u8a2a\u554f\u4ee4\u724c\u5b89\u5168\u5730\u5206\u767c\u7d66\u8a2d\u5099\n\u901a\u5e38\uff0c\u60a8\u7684\u908a\u7de3\u8a2d\u5099\u6703\u4f7f\u7528 MQTT \u8207\u60a8\u7684 IoT \u5e73\u81fa\u901a\u4fe1\u3002\u4f46\u5c0d\u65bc\u7279\u5b9a\u4f7f\u7528\u5834\u666f\uff0c\u60a8\u7684\u8a2d\u5099\u53ef\u80fd\u9700\u8981\u76f4\u63a5\u8a2a\u554f Google Cloud \u8cc7\u6e90\u3002\u4f8b\u5982\uff0c\u61c9\u8a72\u8003\u616e\u4ee5\u4e0b\u4e8b\u9805\uff1a\n- \u7232\u4e86\u4e0b\u8f09\u5167\u5bb9\uff0c\u908a\u7de3\u8a2d\u5099\u50c5\u5728\u4e0b\u8f09\u904e\u7a0b\u4e2d\u9700\u8981\u5c0d Cloud Storage \u5b58\u5132\u6876\u7684\u53ea\u8b80\u6b0a\u9650\u3002\n- \u7232\u4e86\u5c07\u6578\u64da\u4e0a\u50b3\u5230 Cloud Storage \u5b58\u5132\u6876\uff0c\u908a\u7de3\u8a2d\u5099\u9700\u8981\u5c0d\u5b58\u5132\u6876\u7684\u5beb\u5165\u6b0a\u9650\u3002\n\u5c0d\u65bc\u9019\u4e9b\u4f7f\u7528\u5834\u666f\uff0c\u8acb\u4f7f\u7528 [\u5de5\u4f5c\u8ca0\u8f09\u8eab\u4efd\u806f\u5408](https://cloud.google.com/iam/docs/workload-identity-federation?hl=zh-cn) \uff0c\u9019\u7a2e\u65b9\u6cd5\u901a\u904e [\u8a2a\u554f\u4ee4\u724c](https://cloud.google.com/docs/authentication/token-types?hl=zh-cn#access) \u6388\u4e88\u5c0d Google Cloud \u8cc7\u6e90\u7684\u8a2a\u554f\u6b0a\u9650\u3002\u5de5\u4f5c\u8ca0\u8f09\u8eab\u4efd\u806f\u5408\u7121\u9700\u5728\u908a\u7de3\u8a2d\u5099\u4e0a\u9810\u914d\u4efb\u4f55\u7279\u5b9a\u65bc\u96f2\u7684\u6191\u64da\uff0c\u4e26\u4e14\u8a2a\u554f\u6b0a\u9650\u5206\u914d\u6839\u64da\u9700\u6c42\u52d5\u614b\u9032\u884c\u3002\n\u5982\u9700\u5c07\u96f2\u8cc7\u6e90\u7684\u8a2a\u554f\u4ee4\u724c\u5206\u767c\u5230\u60a8\u7684\u8a2d\u5099\uff0c\u8acb\u5728\u8a2d\u5099\u8eab\u4efd\u63d0\u4f9b\u65b9\u548c Google Cloud \u4e4b\u9593\u914d\u7f6e\u5de5\u4f5c\u8ca0\u8f09\u8eab\u4efd\u806f\u5408\u3002\u5982\u9700\u652f\u6301\u5de5\u4f5c\u8ca0\u8f09\u8eab\u4efd\u806f\u5408\uff0c\u8acb\u78ba\u4fdd\u60a8\u7684 IoT \u5f8c\u7aef\u6eff\u8db3 [\u5de5\u4f5c\u8ca0\u8f09\u8eab\u4efd\u806f\u5408\u8981\u6c42](https://cloud.google.com/iam/docs/use-workload-identity-federation-to-let-customers-access-their-cloud-resources?hl=zh-cn#requirements) \uff0c\u4e26\u9075\u5faa\u7b26\u5408\u60a8\u7684\u4f7f\u7528\u60c5\u5f62\u7684 [\u5b89\u5168\u6700\u4f73\u505a\u6cd5](https://cloud.google.com/iam/docs/use-workload-identity-federation-to-let-customers-access-their-cloud-resources?hl=zh-cn#best_practices) \u3002\n\u5982\u9700\u4f7f\u7528\u5de5\u4f5c\u8ca0\u8f09\u8eab\u4efd\u806f\u5408\u8a2a\u554f Google Cloud \u8cc7\u6e90\uff0c\u60a8\u7684\u908a\u7de3\u8a2d\u5099\u5fc5\u9808\u5be6\u73fe [OAuth 2.0 \u4ee4\u724c\u4ea4\u63db](https://tools.ietf.org/html/rfc8693) \u5de5\u4f5c\u6d41\uff0c\u5176\u4e2d\u5305\u62ec\u4ee5\u4e0b\u6b65\u9a5f\uff1a\n- \u8a2d\u5099\u8abf\u7528 [Security Token Service](https://cloud.google.com/iam/docs/reference/sts/rest?hl=zh-cn) \uff0c\u4e26\u63d0\u4f9b\u5b83\u81ea\u5df1\u7684\u8a2d\u5099\u6191\u64da\u3002\n- Security Token Service \u901a\u904e\u9a57\u8b49\u908a\u7de3\u8a2d\u5099\u63d0\u4f9b\u7d66\u8a2d\u5099\u8eab\u4efd\u63d0\u4f9b\u65b9\u7684\u6191\u64da\u4f86\u9a57\u8b49\u908a\u7de3\u8a2d\u5099\u7684\u8eab\u4efd\u3002\n- \u5982\u679c\u8eab\u4efd\u9a57\u8b49\u6210\u529f\uff0cSecurity Token Service \u5c31\u6703\u5c07\u806f\u5408\u4ee4\u724c\u8fd4\u56de\u7d66\u908a\u7de3\u8a2d\u5099\u3002\n- \u908a\u7de3\u8a2d\u5099\u4f7f\u7528\u806f\u5408\u4ee4\u724c\u4f86\u6a21\u64ec\u55ae\u4e00\u7528\u9014\u7684\u670d\u52d9\u8cec\u865f\uff0c\u4e26\u7372\u53d6 [\u77ed\u671f\u6709\u6548\u7684 OAuth 2.0 \u8a2a\u554f\u4ee4\u724c](https://cloud.google.com/iam/docs/creating-short-lived-service-account-credentials?hl=zh-cn#sa-credentials-oauth) \u3002\n- \u8a2d\u5099\u4f7f\u7528\u77ed\u671f\u6709\u6548\u7684 OAuth 2.0 \u8a2a\u554f\u4ee4\u724c\u5411 Google Cloud API \u9032\u884c\u8eab\u4efd\u9a57\u8b49\uff0c\u4e26\u7372\u53d6\u5c0d\u6240\u9700\u96f2\u8cc7\u6e90\u7684\u8a2a\u554f\u6b0a\u9650\u3002\n\u5982\u9700\u9650\u5236\u77ed\u671f\u6709\u6548\u7684\u8a2a\u554f\u4ee4\u724c\u5c0d Cloud Storage \u4e2d\u7279\u5b9a\u5b58\u5132\u6876\u548c\u5c0d\u8c61\u7684\u8a2a\u554f\u6b0a\u9650\uff0c\u8acb\u4f7f\u7528 [\u6191\u64da\u8a2a\u554f\u908a\u754c](https://cloud.google.com/iam/docs/downscoping-short-lived-credentials?hl=zh-cn#how-it-works) \u3002\u6191\u64da\u8a2a\u554f\u908a\u754c\u53ef\u8b93\u60a8\u9650\u5236\u77ed\u671f\u6709\u6548\u7684\u6191\u64da\u7684\u8a2a\u554f\u6b0a\u9650\uff0c\u4e26\u6700\u5927\u9650\u5ea6\u5730\u6e1b\u5c11\u8a2a\u554f\u4ee4\u724c\u88ab\u7834\u89e3\u6642 Cloud Storage \u5b58\u5132\u6876\u4e2d\u6cc4\u9732\u7684\u8cc7\u6e90\u6578\u91cf\u3002\n\u5de5\u4f5c\u8ca0\u8f09\u8eab\u4efd\u806f\u5408\u662f\u4e00\u7a2e\u53ef\u64f4\u7e2e\u7684\u65b9\u6cd5\uff0c\u7528\u65bc\u5b89\u5168\u5730\u5c07\u908a\u7de3\u8a2a\u554f\u6b0a\u9650\u5206\u914d\u7d66\u908a\u7de3\u8a2d\u5099\u3002\u5982\u9700\u8a73\u7d30\u77ad\u89e3\u8eab\u4efd\u9a57\u8b49\uff0c\u8acb\u53c3\u95b1 [Google \u8eab\u4efd\u9a57\u8b49](https://cloud.google.com/docs/authentication?hl=zh-cn) \u3002\n### \u76e3\u63a7\u548c\u5be9\u8988\u5c0d\u96f2\u8cc7\u6e90\u7684\u8a2a\u554f\u6b0a\u9650\n\u5553\u7528 Cloud Audit Logs\uff0c\u4ee5\u4fbf\u5728\u908a\u7de3\u8a2d\u5099\u901a\u904e\u7d93\u904e\u8eab\u4efd\u9a57\u8b49\u7684 API \u8acb\u6c42\u8a2a\u554f\u96f2\u8cc7\u6e90\u6642\u5275\u5efa\u65e5\u8a8c\u689d\u76ee\u3002\u85c9\u52a9 Cloud Audit Logs\uff0c\u60a8\u53ef\u4ee5\u76e3\u63a7\u908a\u7de3\u8a2d\u5099\u5728 Google Cloud \u4e0a\u57f7\u884c\u7684\u95dc\u9375\u64cd\u4f5c\u3002\u6b64\u5916\uff0cCloud Audit Logs \u9084\u6703\u5275\u5efa\u5be9\u8988\u8ddf\u8e64\u8a18\u9304\u548c\u65e5\u8a8c\uff0c\u4f9b\u60a8\u8abf\u67e5\u4efb\u4f55\u554f\u984c\u3002\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [\u6a21\u64ec\u670d\u52d9\u8cec\u865f\u4ee5\u8a2a\u554f Google Cloud](https://cloud.google.com/iam/docs/audit-logging/examples-service-accounts?hl=zh-cn#auth-as-service-account) \u3002\n## \u5f8c\u7e8c\u6b65\u9a5f\n- \u8a73\u7d30\u77ad\u89e3 [\u7269\u806f\u7db2\u6280\u8853\u6982\u89bd](https://cloud.google.com/architecture/iot-overview?hl=zh-cn) \u3002\n- \u95b1\u8b80\u672c\u7cfb\u5217\u6587\u7ae0\u4e2d\u7684\u5176\u9918\u6587\u6a94\uff1a- [Google Cloud \u4e0a\u7684\u7368\u7acb MQTT \u4ee3\u7406\u67b6\u69cb](https://cloud.google.com/architecture/connected-devices/mqtt-broker-architecture?hl=zh-cn) \n- [Google Cloud \u4e0a\u7684 IoT \u5e73\u81fa\u7522\u54c1\u67b6\u69cb](https://cloud.google.com/architecture/connected-devices/iot-platform-product-architecture?hl=zh-cn) \n- [\u5f9e IoT Core \u9077\u79fb\u74b0\u5883](https://cloud.google.com/architecture/iot-core-migration?hl=zh-cn) \n- \u8a73\u7d30\u77ad\u89e3 [\u4f7f\u7528\u670d\u52d9\u8cec\u865f\u7684\u6700\u4f73\u505a\u6cd5](https://cloud.google.com/iam/docs/best-practices-service-accounts?hl=zh-cn) \u3002", "guide": "Docs"}