{"title": "Dialogflow - Dialogflow Google Chat integration", "url": "https://cloud.google.com/dialogflow/es/docs/integrations/google-chat", "abstract": "# Dialogflow - Dialogflow Google Chat integration\nBy integrating Dialogflow with Google Chat, you leverage features in both services:\n- **Google Chat** . Provides a messaging platform with a front-end user interface for one-on-one conversations and chat spaces. Through Google Chat, you can enhance user interfaces by building cards incorporating icons, images, buttons, text-entry fields, or apps like Google Maps.\n- **Dialogflow** . Provides a natural language understanding platform for automated conversations and dynamic responses. Through Dialogflow, you can interpret and fulfill user intents, for example, to schedule appointments or process purchases.\nAlthough you can also use Google Chat to fulfill user requests, Dialogflow lets users express their requests through regular conversation.\n", "content": "## How it works\nOnce you build a Dialogflow-enabled Google Chat app, you can make the app available to the following:\n- **General public** . Licensed Google Workspace users can download your app through the Google Workspace Marketplace.\n- **Google Workspace domain** . A Google Workspace administrator can specify which apps users can add to Google Chat.\n- **App testers** . While testing your app, you can restrict access to the app.\nIn Google Chat, a user can have a direct conversation with your app or invoke the app from within a space. The following happens:\n- A user sends a message to a Chat app.\n- Google Chat sends a JSON request to the Chat app, which could be hosted in Cloud Functions.\n- The Chat app receives the JSON request, and parses it. During this parsing, the Chat app invokes Dialogflow.\n- The Chat app sends a request to Dialogflow that includes the user's natural-language message text.\n- Dialogflow interprets the user's text and sends a response to the Chat app.\n- The Chat app parses Dialogflow's response and sends a JSON response to Google Chat.\n- Google Chat receives the Chat app's JSON response and renders a response in the form of a text message, a card message, or a dialog message in the UI.\n- Google Chat shares this response as-is or presents a rich response using a card-based UI.\nThis page describes how to integrate Dialogflow with Google Chat and configure rich chat responses.\n**Note:** Google Chat was formerly called Hangouts Chat, and Chat apps were formerly called Chat bots. Although Google Chat and the Google Cloud console use the term , the Dialogflow console still uses the term .\n## Limitations\nWith Google Chat integrations, a Dialogflow agent can use only the [default agent language](/dialogflow/es/docs/agents-settings#lang) .\n## Before you begin\nOnly licensed Google Workspace users can use Google Chat apps. Your Google Workspace administrator must do the following:\n- [Add a Google Workspace account for you](https://support.google.com/a/answer/33310) .\n- [Allow users to install Chat apps](https://support.google.com/a/answer/7651360) .## Build a Dialogflow agent\nIf you haven't yet built a Dialogflow agent but would like to see how an agent interacts with Google Chat, follow this [Quickstart](/dialogflow/es/docs/quick/build-agent) to create a simple agent. Do not however delete the agent. Next, we set up the agent with a Google Chat interface.\n## Set up Google Chat\nTo set up your Dialogflow agent with Google Chat, you can use either of the following:\n- [Dialogflow console](#configure-with-dialogflow) \n- [Google Cloud console](#configure-with-gcp) \n### Set up Google Chat using the Dialogflow console\nTo integrate Google Chat using the Dialogflow console, follow these steps:\n- Go to the [Dialogflow ES Console](https://dialogflow.cloud.google.com) .\n- In the left menu, select a Dialogflow project.\n- Click **Integrations** .\n- Click **Google Chat** . If Google Chat is not one of the options, see [Troubleshoot](#troubleshoot) .\n- Select who can access the app.\n- [Optional] Select an environment to run the agent.\n- Click **Start** .\nYour Google Chat app is now live and available to those you selected.\nTo configure the app, click **Google Chat** again, then **CONFIGURE BOT DETAILS** . This displays the Google Cloud console page for the Google Chat API, where you can configure [app parameters](https://developers.google.com/chat/how-tos/apps-publish#about_app_configuration) like the app avatar.\n### Set up Google Chat using the Google Cloud console\nTo integrate Google Chat using the Google Cloud console, follow these steps:\n- Select the Dialogflow project. [Go to project selector](https://console.cloud.google.com/projectselector2/home/dashboard) \n- Click .\n- Click **APIs & Services** , then **Library** .\n- Search for and click **Google Chat API** .\n- Click **Enable** .\n- Click the **Configuration** tab.\n- Configure the app.\n- In the **Visibility** pane, select who can access the app:- App testers. Select **Make this chat available to specific people** and enter their email addresses.\n- General public or Enterprise Google Workspace domain. [Publish the app](https://developers.google.com/chat/how-tos/apps-publish) .\n- Click **Save** . Your Google Chat app is now live and available to those you selected.## Test\nBefore testing your Chat app, make sure you've started it, as described in [Set up Google Chat](#setup) .\nYou can test your app using either of these methods:\n- [Chat directly with the app](#test-chat) \n- [Invoke the app from a space](#test-space) \n### Chat directly with the app\n- Open [Google Chat](https://chat.google.com) .\n- In the **Chat** pane, click **+** and select **Find apps** .\n- Search for and select your app. If Google Chat does not list your app, see [Troubleshoot](#troubleshoot) .\n- Click **Chat** .\n- In the chat entry field, enter a natural language phrase to test the app.\n### Invoke the app from a space\n- Open [Google Chat](https://chat.google.com) .\n- In the **Spaces** pane, click **+** and select **Create a space** .\n- Enter the space name **Test** .\n- Click **Create** .\n- In the chat entry field, enter **@** and select your app to auto-complete the name.\n- After the auto-completed app name, enter a natural language phrase to test the app.## Troubleshoot\n| Error                     | Solution                                                 |\n|:-----------------------------------------------------------------------------------------|:------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|\n| The Dialogflow ES Console > Integrations page does not display Google Chat as an option. | Try refreshing the page: In the left menu, click Intents, then click Integrations.                               |\n| Google Chat does not list your app as available.           | Ensure your Google Workspace administrator added a Google Workspace account for you and allowed users to install Chat apps. Then make sure you've started the Chat app, as described in Set up Google Chat. |\n## Rich response messages\nThis integration translates some [rich response messages](/dialogflow/docs/intents-rich-messages) messages to [Google Chat message formats](https://developers.google.com/chat/reference/message-formats) .\n### Text Responses\n[Text responses](https://cloud.google.com/dialogflow/docs/intents-rich-messages#text) are sent to Google Chat as [Text messages](https://developers.google.com/chat/reference/message-formats/basic) . With this formatting you can make text bold or italics by wrapping the text in certain (markdown light) symbols.\nThe text message response, visually looks the same as the Default Text Response in the Dialogflow Console. However, the raw API response will look a bit different. It also sets the platform config to , which could be interesting when building agents for multiple integrations.\n```\n\"fulfillmentMessages\": [{\u00a0 \u00a0\"text\": {\u00a0 \u00a0\"text\": [\u00a0 \u00a0 \u00a0 \u00a0 \"This is a test.\"\u00a0 \u00a0]},\u00a0 \"platform\": \"GOOGLE_HANGOUTS\"},\n```\n### Cards\n[Card responses](https://cloud.google.com/dialogflow/docs/intents-rich-messages#card) are sent to Google Chat as [Card messages](https://developers.google.com/chat/reference/message-formats/cards) .\n### Images\n[Image responses](https://cloud.google.com/dialogflow/docs/intents-rich-messages#image) are sent to Google Chat as [Google Chat Image Widgets](https://developers.google.com/chat/ui/widgets/image) .\n### Custom Payload\n**Note:** This integration does not support [card actions](https://developers.google.com/chat/api/reference/rest/v1/cards#action) .\nTo send other types of Google Chat messages, you can use a [custom payload](/dialogflow/es/docs/intents-rich-messages#custom) .\nGoogle Chat Custom Payload allows you to create more advanced cards. One card can have one or many sections. Each section could have a header. You can have a look into the [Google Chat message formats cards reference guide](https://developers.google.com/chat/reference/message-formats/cards) , to see some of the combinations you can create with this. However, using custom payloads means that you will have to provide the JSON format.\n**Note:** When you copy and paste the examples from the reference guide to the custom payload box in Dialogflow, make sure the editor doesn't contain any linting errors. You can't test the results in the Dialogflow Simulator but can test it directly in Google Chat.\nHere is an example of a custom payload using the Cards v1 format:\n**Note:** The Cards v2 format is not supported.\n```\n{\u00a0 \"hangouts\": {\u00a0 \u00a0 \"header\": {\u00a0 \u00a0 \u00a0 \"title\": \"Pizza Delivery Customer Support\",\u00a0 \u00a0 \u00a0 \"subtitle\": \"pizzadelivery@example.com\",\u00a0 \u00a0 \u00a0 \"imageUrl\": \"https://goo.gl/aeDtrS\"\u00a0 \u00a0 },\u00a0 \u00a0 \"sections\": [{\u00a0 \u00a0 \u00a0 \"widgets\": [{\u00a0 \u00a0 \u00a0 \u00a0 \"keyValue\": {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"icon\": \"TRAIN\",\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"topLabel\": \"Order No.\",\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"content\": \"12345\"\u00a0 \u00a0 \u00a0 \u00a0 }\u00a0 \u00a0 \u00a0 },\u00a0 \u00a0 \u00a0 {\u00a0 \u00a0 \u00a0 \u00a0 \"keyValue\": {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"topLabel\": \"Status\",\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"content\": \"In Delivery\"\u00a0 \u00a0 \u00a0 \u00a0 }\u00a0 \u00a0 \u00a0 }]\u00a0 \u00a0 },\u00a0 \u00a0 {\u00a0 \u00a0 \u00a0 \"header\": \"Location\",\u00a0 \u00a0 \u00a0 \"widgets\": [{\u00a0 \u00a0 \u00a0 \u00a0 \"image\": {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"imageUrl\": \"https://dummyimage.com/600x400/000/fff\"\u00a0 \u00a0 \u00a0 \u00a0 }\u00a0 \u00a0 \u00a0 }]\u00a0 \u00a0 },\u00a0 \u00a0 {\u00a0 \u00a0 \u00a0 \"header\": \"Buttons - I could leave the header out\",\u00a0 \u00a0 \u00a0 \"widgets\": [{\u00a0 \u00a0 \u00a0 \u00a0 \"buttons\": [{\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"textButton\": {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"text\": \"OPEN ORDER\",\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"onClick\": {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"openLink\": {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"url\": \"https://example.com/orders/...\"\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 }\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 }\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 }\u00a0 \u00a0 \u00a0 \u00a0 }]\u00a0 \u00a0 \u00a0 }]\u00a0 \u00a0 }]\u00a0 }}\n```\n## Stop the Chat app\nTo stop the Google Chat app from being available, you can use either of the following:\n- [Dialogflow console](#stop-with-dialogflow) \n- [Google Cloud console](#stop-with-gcp) \n### Stop the Chat app using the Dialogflow console\n- Go to the [Dialogflow ES Console](https://dialogflow.cloud.google.com) .\n- In the left menu, select a Dialogflow project.\n- Click **Integrations** .\n- Click **Google Chat** . If Google Chat is not one of the options, see [Troubleshoot](#troubleshoot) .\n- Click **Stop** .\n### Stop the Chat app using the Google Cloud console\n- Select the Dialogflow project from the Google Cloud console. [Go to project selector](https://console.cloud.google.com/projectselector2/home/dashboard) \n- Click .\n- Click **APIs & Services** , then **Library** .\n- Search for and click **Google Chat API** .\n- Click **Manage** .\n- Click the **Configuration** tab.\n- In the **App status** field, select **DISABLED** .## More information\nFor more information about using Google Chat, see the following:\n- [Google Chat developer docs](https://developers.google.com/chat/) \n- [Build a Chat app](https://developers.google.com/chat/quickstart/gcf-app) \n- [Video: Integrate Dialogflow with Google Chat](https://youtu.be/aRswG2oowEA) \n- [Codelab: Integrating Dialogflow with Google Chat](https://codelabs.developers.google.com/codelabs/chatbots-dialogflow-hangouts#0)", "guide": "Dialogflow"}