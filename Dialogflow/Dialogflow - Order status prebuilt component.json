{"title": "Dialogflow - Order status prebuilt component", "url": "https://cloud.google.com/dialogflow/cx/docs/concept/prebuilt-component/order-status", "abstract": "# Dialogflow - Order status prebuilt component\nThe order status [prebuilt component](/dialogflow/cx/docs/concept/prebuilt-component) checks a customer's authentication level, then provides information about the user's most recent or past orders to an authenticated customer. This component uses the [Retail authentication](/dialogflow/cx/docs/concept/prebuilt-component/authentication-retail) prebuilt component to authenticate users. The component also uses [Generators](/dialogflow/cx/docs/concept/generative/generators) for post-call summarization.\n", "content": "## Limitations\nIn addition to the [common prebuilt component limitations](/dialogflow/cx/docs/concept/prebuilt-component#limits) , this prebuilt component has the following limitations:\n- This component does not encrypt any data.## Sample dialogs\nThe following sample dialogs demonstrate common scenarios handled by this prebuilt component. The sample dialogs demonstrate behavior when the component is called using telephony, which triggers the Default Welcome Intent and the first agent response at the start of the conversation.\n### Recent order\nEnd-user calls from an unregistered number; the agent authenticates the user, then provides detailed information about the shipments in the order. The user confirms that they would like an SMS sent to their registered phone number with additional details.\n| User input | Agent response                                                            |\n|:-------------|:-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|\n| nan   | Agent authenticates user using Retail authentication prebuilt component                                              |\n| nan   | Okay, John. Are you calling about your most recent order for John Doe containing lamp, shirt and 10 other items placed on 2023-11-10 at 06:00 PM?                           |\n| Yes   | nan                                                               |\n| nan   | Your order has 2 shipments, which will be delivered by 2024-01-15. Would you like to hear more about these shipments?                                  |\n| Yes   | nan                                                               |\n| nan   | Shipment 1 containing jeans, belt and 2 other items is in-transit and will be delivered by 2024-01-12. Shipment 2 containing lamp, shirt and 6 other items was delivered on 2023-11-12. Would you like to receive an SMS with further details on your items? |\n| Yes   | nan                                                               |\n| nan   | We have sent you an SMS with a link to track the status of all your shipments. Thank you for calling us.                                      |\n### Duplicate orders\nEnd-user has been previously authenticated. The user requests information about an order and provides the last five digits of the order. The agent identifies that multiple orders placed by this user share the same last five digits, so it confirms which order the user would like to hear the status of and provides the order status to the user.\n| User input  | Agent response                                                                            |\n|:-----------------|:---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|\n| nan    | Okay, Amber. Are you calling about your most recent order for Amber Doe containing lamp, shirt and other 2 items placed on 2023-11-10 at 06:00 PM?                                           |\n| No    | nan                                                                              |\n| nan    | Could you please provide the last 5 digits of your order ID that you want to track?                                                          |\n| 12355   | nan                                                                              |\n| nan    | The last five digits of the order ID that we got are 12355, is that correct?                                                            |\n| Yes that's right | nan                                                                              |\n| nan    | Great, we are done collecting the order ID.                                                                    |\n| nan    | As per our records, we have found 2 orders ending with the same 5 digits 12355. Which order are you looking for? Order number 1 which was placed on 2023-11-10 at 06:00 PM or Order number 2 which was placed on 2023-11-09 at 08:00 PM? To select order number one say 1, to select order number two, say 2. Else say No. |\n| Order one  | nan                                                                              |\n| nan    | Your order has 2 shipments, which will be delivered by 2024-01-15. Would you like to hear more about these shipments?                                                  |\n| Yes    | nan                                                                              |\n| nan    | Shipment 1 containing jeans is in-transit and will be delivered by 2024-01-15. Shipment 2 containing lamp, shirt and 1 other items is cancelled. Would you like to receive an SMS with further details on your items?                          |\n| No that's all | nan                                                                              |\n| nan    | Thank you for calling us.                                                                         |\n## Naming conventions\nThis prebuilt component uses the following naming conventions:\n| Feature | Format            | Example           |\n|:----------|:------------------------------------------------------|:---------------------------------------------------|\n| Flow  | [Component Name]          | Order Status          |\n| Webhook | prebuilt_components_[component_name]:[webhook_action] | prebuilt_components_order_status:get_order_details |\n## Input parameters\nInput parameters are parameters that are used to configure certain behaviors of the component. The parameters will be used by one or more conditions within the flow to determine how the component should behave. Flow-scoped parameters must be set on the start page of the component. Session-scoped parameters may be set either by a calling flow, or on the start page of this component.\nThis prebuilt component accepts the following input parameters:\n| Parameter Name       | Description                                                                | Input Format |\n|:-----------------------------------------|:-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:---------------|\n| $session.params.phone_number    | (optional) User's local phone number, without the country code, used to identify the user.                                            | string   |\n| $session.params.all_recent_order_id  | (optional) This parameter lists order IDs associated with the authenticated user, sorted by the order placement date in descending order. The first element of the array represents the most recent order. If a user has no orders, the value of this parameter is null. | List (string) |\n| $session.params.email     | (optional) The email registered with the account.                                                      | string   |\n| $session.params.user_first_name   | (optional) User's first name, used to greet and confirm ownership of the account.                                              | string   |\n| $flow.max_shipment      | Specifies the number of shipments displayed to the user at a time. The default value is 2.                                            | integer  |\n| $flow.tracking_status_delivered   | Specifies the value returned by the webhook indicating a delivered order status. The default value is \"delivered\".                                      | string   |\n| $flow.tracking_status_cancelled   | Specifies the value returned by the webhook indicating a cancelled order status. The default value is \"cancelled\".                                      | string   |\n| $flow.tracking_status_returned   | Specifies the value returned by the webhook indicating a returned order status. The default value is \"returned\".                                       | string   |\n| $flow.tracking_status_partially_returned | Specifies the value returned by the webhook indicating a partially returned order status. The default value is \"partially returned\".                                  | string   |\n| $flow.max_retry_alternate_profile  | Specifies the number of retries allowed when requesting order status from an unregistered phone number or alternate profile. The default value is 3.                              | integer  |\n| $flow.max_retry_order_number    | Specifies the number of retries allowed when providing an order number. The default value is 3.                                           | integer  |\n| $flow.max_retry_another_order_id   | Specifies the number of retries allowed after providing an invalid order number. The default value is 3.                                         | integer  |\n## Output parameters\nOutput parameters are session parameters that will remain active after exiting the component. These parameters contain important information collected by the component. This prebuilt component provides values for the following output parameters:\n| Parameter Name  | Description                                                                                                                                                                           | Output Format |\n|:--------------------|:-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:----------------|\n| phone_number  | User's local phone number, without the country code, used to identify the user.                                                                                                                                                          | string   |\n| all_recent_order_id | This parameter lists order IDs associated with the authenticated user, sorted by the order placement date in descending order. The first element of the array represents the most recent order. If a user has no orders, the value of this parameter is null.                                                                                                               | List (string) |\n| email    | The email registered with the account.                                                                                                                                                                     | string   |\n| user_first_name  | User's first name, used to greet and confirm ownership of the account.                                                                                                                                                             | string   |\n| transfer_reason  | This parameter indicates the reason the flow exited, if it was not successful. The returned value is one of: agent: the end-user requested a human agent at some point during the conversation. denial_of_information: the end-user declined to share information requested by the component. max_no_input: the conversation reached the maximum number of retries for no-input events. See no-input built-in events. max_no_match: the conversation reached the maximum number of retries for no-match events. See no-match built-in events. webhook_error: a webhook error occurred. See webhook.error built-in event. webhook_not_found: a webhook URL was unreachable. See webhook.error.not-found built-in event. | string   |\n## Basic setup\nTo set up this prebuilt component:\n- [Import the prebuilt component](/dialogflow/cx/docs/concept/prebuilt-component#import) .\n- Configure the provided [flexible webhooks](/dialogflow/cx/docs/concept/webhook#flexible) with configuration describing your Dialogflow-external services, see Webhook setup.## Webhook setup\nIn order to use this component, you will need to configure the included [flexible webhooks](/dialogflow/cx/docs/concept/webhook#flexible) to retrieve needed information from your external services.\n### Authentication\nIf you have not previously configured external services required for authentication, you will need to configure them to enable authentication of users for this component. See [Retail authentication webhook setup](/dialogflow/cx/docs/concept/prebuilt-component/authentication-retail#webhook-setup) for detailed instructions.\n### Get order details\nThe `prebuilt_components_order_status:get_order_details` webhook is used by the component to retrieve order details for a specified order.\nThe following parameters are provided by the component as inputs to the API request.\n| Parameter Name | Description      | Input Format |\n|:-----------------|:----------------------------------|:---------------|\n| $flow.order_id | Order ID to retrieve details for. | string   |\nThe following parameters are pulled from the API response to be used by the component.\n| Parameter Name    | Description                                               | Output Format |\n|:------------------------------|:----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:----------------|\n| order_date     | Date the order was placed, in YYYY-MM-DD format.                                     | string   |\n| order_time     | Time the order was placed, in HH:MM format.                                       | string   |\n| order_status     | Indicates status for the order. Example values include \"pending\", \"processing\", \"in-transit\", \"on-hold\", \"cancelled\", \"delivered\", \"returned\", \"partially returned\".        | string   |\n| order_product_name   | List of product names within the order.                                        | List (string) |\n| order_product_quantity  | Total count of the number of products ordered for each product within an order.                              | integer   |\n| order_product_count   | The number of unique products within an order.                                      | integer   |\n| order_status_notification  | Indicates whether notifications are enabled for this order.                                   | boolean   |\n| return_eligibility_date  | List of dates until which each product within the order is eligible for return, in YYYY-MM-DD format.                        | List (string) |\n| order_customer_billing_name | First name of the customer's billing name for the order.                                   | string   |\n| order_latest_delivery_date | The latest delivery date across all estimated delivery dates for the shipments within the order, in YYYY-MM-DD format.                    | string   |\n| order_shipment_multiple  | Indicates whether the order contains multiple shipments.                                   | boolean   |\n| order_shipment_count   | The number of shipments within the order.                                       | integer   |\n| order_shipment_product_count | Total product count in each shipment within the order.                                    | List (integer) |\n| order_shipment_product_name | List of the product names in each shipment within the order.                                  | List (string) |\n| order_estimated_delivery_date | List of estimated delivery dates for each shipment within the order, in YYYY-MM-DD format.                           | List (string) |\n| order_shipment_status   | List indicating the status for each shipment within the order. Example values include \"pending\", \"processing\", \"in-transit\", \"on-hold\", \"cancelled\", \"delivered\", \"returned\", \"partially returned\". | List (string) |### Get duplicate orders\nThe `prebuilt_components_retail_services:get_duplicate_order` webhook is used by the component to retrieve detailed information in order to distinguish between orders when multiple order numbers have the same last five digits.\nThe following parameters are provided by the component as inputs to the API request.\n| Parameter Name   | Description                       | Input Format |\n|:-------------------------|:------------------------------------------------------------------------------------------------------|:---------------|\n| $flow.duplicate_order_id | List containing the last five digits of order numbers shared between one or more orders for the user. | List (string) |\nThe following parameters are pulled from the API response to be used by the component.\n| Parameter Name | Description                                            | Output Format |\n|:-----------------|:-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:----------------|\n| all_order_date | List of order dates for duplicate orders with the specified last five digits in YYYY-MM-DD format. Each element in this array corresponds to the same element in the all_order_time array. | boolean   |\n| all_order_time | List of order times for duplicate orders with the specified last five digits in HH:MM format. Each element in this array corresponds to the same element in the all_order_date array.  | number   |### Send SMS\nThe `prebuilt_components_order_status:send_sms` webhook is used by the component to send order details to the specified phone number using SMS.\nThe following parameters are provided by the component as inputs to the API request.\n| Parameter Name    | Description                  | Input Format |\n|:-----------------------------|:--------------------------------------------------------------------------------|:---------------|\n| $session.params.phone_number | User's local phone number, without the country code, used to identify the user. | string   |\n| $flow.order_id    | Order ID to send order details for.            | string   |### Enable notifications\nThe `prebuilt_components_order_status:enable_notification` webhook is used by the component to enable notifications for a user's registered phone number.\nThe following parameters are provided by the component as inputs to the API request.\n| Parameter Name    | Description                  | Input Format |\n|:-----------------------------|:--------------------------------------------------------------------------------|:---------------|\n| $session.params.phone_number | User's local phone number, without the country code, used to identify the user. | string   |\n| $flow.order_notification  | Indicates whether notifications should be enabled for the user.     | boolean  |### Complete\nYour agent and its webhooks should now be set up and ready to test.", "guide": "Dialogflow"}