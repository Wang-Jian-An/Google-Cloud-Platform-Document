{"title": "Dialogflow - Messenger from Facebook", "url": "https://cloud.google.com/dialogflow/es/docs/integrations/facebook", "abstract": "# Dialogflow - Messenger from Facebook\nUsing the Dialogflow Facebook Messenger integration, you can create a Facebook Messenger bot to interact with your end-users.\n**Note:** When using a third party integration, requests and end-user data are sent to both Google and the third party. The terms of service, SLA, pricing, and quotas [for your agent edition](/dialogflow/docs/editions) are applicable for Google's handling of these requests. The third party's terms of service, SLA, pricing, and quotas are applicable for the third party's handling of these requests.\n", "content": "## Limitations\nOnly the [default agent language](/dialogflow/es/docs/agents-settings#lang) is supported by this integration.\n## How it works\nThis is how the integration works:\n- You create a Facebook app that uses the [Facebook Messenger platform](https://developers.facebook.com/docs/messenger-platform/introduction) .\n- You configure the Dialogflow integration and Facebook app, so that they communicate with each other.\n- The Dialogflow integration sends messages to the end-user by using the [Facebook Messenger API](https://developers.facebook.com/docs/messenger-platform/reference/send-api/) .\n- The Dialogflow integration receives messages from the end-user by acting as the [Facebook Messenger Webhook](https://developers.facebook.com/docs/messenger-platform/getting-started/webhook-setup/) .## Setup\nTo set up the integration:\n- Follow the steps to create a Facebook app: [Facebook App Development](https://developers.facebook.com/docs/apps) .\n- Set up the Facebook app to use the Facebook Messenger Platform. Follow steps in the [Setting Up Your Facebook App](https://developers.facebook.com/docs/messenger-platform/getting-started/app-setup) documentation to accomplish the following:- Add the Messenger Platform to your Facebook app.\n- Subscribe your app to a Facebook page. You are provided with an access token at this step. Copy this value. This token will be used to configure the integration from the Dialogflow Console.\n- Do not configure the webhook or test your integration yet.\n- Configure the integration from the Dialogflow Console:- Go to the [Dialogflow ES Console](https://dialogflow.cloud.google.com) .\n- Click **Integrations** in the left sidebar menu.\n- Click **Facebook Messenger** .\n- A configuration dialog opens:- **Show old callback URL** : If this toggle is shown, it defaults to off. This is a temporary option to accommodate a recent modification to the Facebook Messenger API. Do not change this toggle unless instructed by Dialogflow support. After all agents have been updated, this option will be removed.\n- **Callback URL** : Copy this value. This will be used to configure the Facebook Messenger Webhook.\n- **Verify Token** : You can enter any private token you desire. Copy this value. This will be used to configure the Facebook Messenger Webhook.\n- **Page Access Token** : Enter the access token you copied when creating the Facebook page.\n- **Start** : Click to start this integration service for your agent.\n- Finish setup of the Facebook app and test it. Follow steps in the [Setting Up Your Facebook App](https://developers.facebook.com/docs/messenger-platform/getting-started/app-setup) documentation to accomplish the following:- Configure the Facebook webhook for your app. Use the **Callback URL** and **Verify Token** values you copied above. Be sure to enable **messages** and **messaging_postbacks** .\n- Test your app.\n## Events\nThe following [events](/dialogflow/docs/events-overview) are invoked by this integration:\n| Event   | Description              |\n|:-----------------|:----------------------------------------------------------------|\n| FACEBOOK_WELCOME | Triggered when an end-user starts a conversation with your bot. |\n## Rich response messages\nThis integration translates some [rich response messages](/dialogflow/docs/intents-rich-messages) messages to [Facebook Messenger Platform message types](https://developers.facebook.com/docs/messenger-platform/send-messages) .\n### Image responses\n[Image responses](/dialogflow/docs/intents-rich-messages#image) are sent to Facebook Messenger as [Facebook Messenger file attachment messages](https://developers.facebook.com/docs/messenger-platform/reference/attachment-upload-api#attachment) . The `message.attachment.type` value is set to `image` . The following formats are supported:\n- jpg\n- png\n- static gif\n- animated gif\n### Card responses\n[Card responses](https://cloud.google.com/dialogflow/docs/intents-rich-messages#card) are sent to Facebook Messenger as [Facebook Messenger generic templates](https://developers.facebook.com/docs/messenger-platform/reference/templates/generic) .\n### Quick reply responses\n[Quick reply responses](https://cloud.google.com/dialogflow/docs/intents-rich-messages#quick) are sent to Facebook Messenger as [Facebook Messenger quick replies](https://developers.facebook.com/docs/messenger-platform/reference/buttons/quick-replies) .\n### Custom payload responses\nTo send other types of Facebook Messenger messages, you can use a [custom payload](https://cloud.google.com/dialogflow/docs/intents-rich-messages#custom) .\nThe general format of the custom payload looks like:\n```\n{\n \"facebook\": {\n message\n }\n}\n```\nIn place of `message` , provide the Facebook Messenger `message` object. For details of the `message` object, see the [Facebook Messenger API reference](https://developers.facebook.com/docs/messenger-platform/reference/send-api/) .\nFor example:\n- Send an audio link:```\n{\n \"facebook\": {\n \"attachment\": {\n  \"type\": \"audio\",\n  \"payload\": {\n  \"url\": \"https://example.com/audio/test.mp3\"\n  }\n }\n }\n}\n \n```\n- Send a playable video:```\n{\n \"facebook\": {\n \"attachment\": {\n  \"type\": \"video\",\n  \"payload\": {\n  \"url\": \"https://example.com/video.mp4\"\n  }\n }\n }\n}\n \n```\n- Send a file:```\n{\n \"facebook\": {\n \"attachment\": {\n  \"type\": \"file\",\n  \"payload\": {\n  \"url\": \"https://example.com/file.pdf\"\n  }\n }\n }\n}\n \n```", "guide": "Dialogflow"}