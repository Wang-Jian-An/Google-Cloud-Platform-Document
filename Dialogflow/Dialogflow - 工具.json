{"title": "Dialogflow - \u5de5\u5177", "url": "https://cloud.google.com/dialogflow/vertex/docs/concept/tools?hl=zh-cn", "abstract": "# Dialogflow - \u5de5\u5177\n**    \u9810\u89bd     ** \u672c\u7522\u54c1\u6216\u529f\u80fd\u9808\u9075\u5b88 [\u670d\u52d9\u5c08\u7528\u689d\u6b3e](https://cloud.google.com/terms/service-terms?hl=zh-cn#1) \u7684\u201c\u901a\u7528\u670d\u52d9\u689d\u6b3e\u201d\u90e8\u5206\u4e2d\u7684\u201c\u975e\u6b63\u5f0f\u7248\u7522\u54c1\u689d\u6b3e\u201d\u3002 \u6b63\u5f0f\u767c\u4f48\u524d\u7522\u54c1\u548c\u529f\u80fd\u201c\u6309\u539f\u6a23\u201d\u63d0\u4f9b\uff0c\u53ef\u80fd\u50c5\u63d0\u4f9b\u6709\u9650\u652f\u6301\u3002 \u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [\u767c\u4f48\u968e\u6bb5\u8aaa\u660e](https://cloud.google.com/products?hl=zh-cn#product-launch-stages) \u3002\n\u60a8\u53ef\u4ee5\u4f7f\u7528\u5de5\u5177\u5c07 playbook \u4ee3\u7406\u9023\u63a5\u5230\u5916\u90e8\u7cfb\u7d71\u3002 \u9019\u4e9b\u7cfb\u7d71\u53ef\u4ee5\u589e\u5f37 playbook \u4ee3\u7406\u7684\u77e5\u8b58\uff0c\u4f7f\u5176\u80fd\u5920\u9ad8\u6548\u5730\u57f7\u884c\u5fa9\u96dc\u4efb\u52d9\u3002\n\u60a8\u53ef\u4ee5\u4f7f\u7528 [\u5167\u7f6e\u5de5\u5177](#built-in) \u6216\u69cb\u5efa [\u81ea\u5b9a\u7fa9\u5de5\u5177](#customized) \u4f86\u6eff\u8db3\u81ea\u5df1\u7684\u9700\u6c42\u3002\n", "content": "## \u5167\u7f6e\u5de5\u5177\n\u5167\u7f6e\u5de5\u5177\u7531 Google \u8a17\u7ba1\u3002 \u60a8\u53ef\u4ee5\u5728 playbook \u4ee3\u7406\u4e2d\u6fc0\u6d3b\u9019\u4e9b\u5de5\u5177\uff0c\u800c\u7121\u9700\u624b\u52d5\u914d\u7f6e\u3002\n\u652f\u6301\u7684\u5167\u7f6e\u5de5\u5177\u5305\u62ec\uff1a\n- `Code Interpreter`\uff1a\u4e00\u6b3e Google \u7b2c\u4e00\u65b9\u5de5\u5177\uff0c\u96c6\u4ee3\u78bc\u751f\u6210\u548c\u4ee3\u78bc\u57f7\u884c\u529f\u80fd\u65bc\u4e00\u8eab\uff0c\u53ef\u8b93\u7528\u6236\u57f7\u884c\u5404\u7a2e\u4efb\u52d9\uff0c\u5305\u62ec\u6578\u64da\u5206\u6790\u3001\u6578\u64da\u53ef\u8996\u5316\u3001\u6587\u672c\u8655\u7406\u3001\u89e3\u6c7a\u65b9\u7a0b\u5f0f\u6216\u512a\u5316\u554f\u984c\u3002\n\u60a8\u7684 playbook \u4ee3\u7406\u7d93\u904e\u512a\u5316\uff0c\u53ef\u78ba\u5b9a\u61c9\u5982\u4f55\u4ee5\u53ca\u4f55\u6642\u8abf\u7528\u9019\u4e9b\u5de5\u5177\uff0c\u4f46\u60a8\u4e5f\u53ef\u4ee5\u63d0\u4f9b\u5176\u4ed6\u793a\u4f8b\u4f86\u6eff\u8db3\u60a8\u7684\u7528\u4f8b\u3002\n\u793a\u4f8b\u61c9\u5177\u6709\u5982\u4e0b\u67b6\u69cb\uff1a\n```\n{\u00a0 \"toolUse\": {\u00a0 \u00a0 \"tool\": \"projects/PROJECT_ID/locations/LOCATION_ID/agents/AGENT_ID/tools/df-code-interpreter-tool\",\u00a0 \u00a0 \"action\": \"generate_and_execute\",\u00a0 \u00a0 \"inputParameters\": [\u00a0 \u00a0 \u00a0 {\u00a0 \u00a0 \u00a0 \u00a0 \"name\": \"generate_and_execute input\",\u00a0 \u00a0 \u00a0 \u00a0 \"value\": \"4 + 4\"\u00a0 \u00a0 \u00a0 }\u00a0 \u00a0 ],\u00a0 \u00a0 \"outputParameters\": [\u00a0 \u00a0 \u00a0 {\u00a0 \u00a0 \u00a0 \u00a0 \"name\": \"generate_and_execute output\",\u00a0 \u00a0 \u00a0 \u00a0 \"value\": {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"output_files\": [\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"name\": \"\",\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"contents\": \"\"\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 }\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 ],\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"execution_result\": \"8\",\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"execution_error\": \"\",\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"generated_code\": \"GENERATED_CODE\"\u00a0 \u00a0 \u00a0 \u00a0 }\u00a0 \u00a0 \u00a0 }\u00a0 \u00a0 ]\u00a0 }}\n```\n## \u81ea\u5b9a\u7fa9\u5de5\u5177\n\u4ee5\u4e0b\u90e8\u5206\u4ecb\u7d39\u4e86\u81ea\u5b9a\u7fa9\u5de5\u5177\u3002\n### OpenAPI \u5de5\u5177\nplaybook \u4ee3\u7406\u53ef\u4ee5\u901a\u904e\u63d0\u4f9b [OpenAPI](https://www.openapis.org/) \u67b6\u69cb\uff0c\u4f7f\u7528 OpenAPI \u5de5\u5177\u9023\u63a5\u5230\u5916\u90e8 API\u3002\u9ed8\u8a8d\u60c5\u6cc1\u4e0b\uff0cPlaybook \u4ee3\u7406\u5c07\u4ee3\u8868\u60a8\u8abf\u7528\u8a72 API\u3002\u6216\u8005\uff0c\u60a8\u4e5f\u53ef\u4ee5\u5728 [\u5ba2\u6236\u7aef](#client-side) \u57f7\u884c OpenAPI \u5de5\u5177\u3002\n\u793a\u4f8b\u67b6\u69cb\uff1a\n```\nopenapi: 3.0.0info:\u00a0 title: Simple Pets API\u00a0 version: 1.0.0servers:\u00a0 - url: 'https://api.pet-service-example.com/v1'paths:\u00a0 /pets/{petId}:\u00a0 \u00a0 get:\u00a0 \u00a0 \u00a0 summary: Return a pet by ID.\u00a0 \u00a0 \u00a0 operationId: getPet\u00a0 \u00a0 \u00a0 parameters:\u00a0 \u00a0 \u00a0 \u00a0 - in: path\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 name: petId\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 required: true\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 description: Pet id\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 schema:\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 type: integer\u00a0 \u00a0 \u00a0 responses:\u00a0 \u00a0 \u00a0 \u00a0 200:\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 description: OK\u00a0 /pets:\u00a0 \u00a0 get:\u00a0 \u00a0 \u00a0 summary: List all pets\u00a0 \u00a0 \u00a0 operationId: listPets\u00a0 \u00a0 \u00a0 parameters:\u00a0 \u00a0 \u00a0 \u00a0 - name: petName\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 in: query\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 required: false\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 description: Pet name\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 schema:\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 type: string\u00a0 \u00a0 \u00a0 \u00a0 - name: label\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 in: query\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 description: Pet label\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 style: form\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 explode: true\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 required: false\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 schema:\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 type: array\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 items:\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 type: string\u00a0 \u00a0 \u00a0 \u00a0 - name: X-OWNER\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 in: header\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 description: Optional pet owner provided in the HTTP header\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 required: false\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 schema:\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 type: string\u00a0 \u00a0 \u00a0 \u00a0 - name: X-SESSION\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 in: header\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 description: Dialogflow session id\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 required: false\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 schema:\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 $ref: \"@dialogflow/sessionId\"\u00a0 \u00a0 \u00a0 responses:\u00a0 \u00a0 \u00a0 \u00a0 '200':\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 description: An array of pets\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 content:\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 application/json:\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 schema:\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 type: array\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 items:\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 $ref: '#/components/schemas/Pet'\u00a0 \u00a0 post:\u00a0 \u00a0 \u00a0 summary: Create a new pet\u00a0 \u00a0 \u00a0 operationId: createPet\u00a0 \u00a0 \u00a0 requestBody:\u00a0 \u00a0 \u00a0 \u00a0 description: Pet to add to the store\u00a0 \u00a0 \u00a0 \u00a0 required: true\u00a0 \u00a0 \u00a0 \u00a0 content:\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 application/json:\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 schema:\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 $ref: '#/components/schemas/Pet'\u00a0 \u00a0 \u00a0 responses:\u00a0 \u00a0 \u00a0 \u00a0 '201':\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 description: Pet created\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 content:\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 application/json:\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 schema:\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 $ref: '#/components/schemas/Pet'components:\u00a0 schemas:\u00a0 \u00a0 Pet:\u00a0 \u00a0 \u00a0 type: object\u00a0 \u00a0 \u00a0 required:\u00a0 \u00a0 \u00a0 \u00a0 - id\u00a0 \u00a0 \u00a0 \u00a0 - name\u00a0 \u00a0 \u00a0 properties:\u00a0 \u00a0 \u00a0 \u00a0 id:\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 type: integer\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 format: int64\u00a0 \u00a0 \u00a0 \u00a0 name:\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 type: string\u00a0 \u00a0 \u00a0 \u00a0 owner:\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 type: string\u00a0 \u00a0 \u00a0 \u00a0 label:\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 type: array\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 items:\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 type: string\n```\n\u60a8\u53ef\u4ee5\u9078\u64c7\u4f7f\u7528\u5167\u90e8\u67b6\u69cb\u5f15\u7528 `@dialogflow/sessionId` \u4f5c\u7232\u53c3\u6578\u67b6\u69cb\u985e\u578b\u3002\u4f7f\u7528\u6b64\u53c3\u6578\u67b6\u69cb\u985e\u578b\u6642\uff0c\u7576\u524d\u5c0d\u8a71\u7684 Dialogflow \u6703\u8a71 ID \u5c07\u4f5c\u7232\u53c3\u6578\u503c\u63d0\u4f9b\u3002\u4f8b\u5982\uff1a\n```\n- name: X-SESSION\u00a0 \u00a0in: header\u00a0 \u00a0description: Dialogflow session id\u00a0 \u00a0required: false\u00a0 \u00a0schema:\u00a0 \u00a0 \u00a0$ref: \"@dialogflow/sessionId\"\n```\n\u5b58\u5728\u4ee5\u4e0b\u9650\u5236\uff1a\n- \u652f\u6301\u7684\u53c3\u6578\u985e\u578b\u7232`path`\u3001`query`\u548c`header`\u3002\u5c1a\u4e0d\u652f\u6301`cookie`\u53c3\u6578\u985e\u578b\u3002\n- OpenAPI \u67b6\u69cb\u5b9a\u7fa9\u7684\u53c3\u6578\u652f\u6301\u4ee5\u4e0b\u6578\u64da\u985e\u578b\uff1a`string`\u3001`number`\u3001`integer`\u3001`boolean`\u3001`array`\u3002\u5c1a\u4e0d\u652f\u6301\u201c`object`\u201d\u985e\u578b\u3002\n- \u60a8\u76ee\u524d\u7121\u6cd5\u5728\u63a7\u5236\u6aaf\u793a\u4f8b\u7de8\u8f2f\u5668\u4e2d\u6307\u5b9a\u67e5\u8a62\u53c3\u6578\u3002\n- \u8acb\u6c42\u548c\u97ff\u61c9\u6b63\u6587\u5fc5\u9808\u7232\u7a7a\u6216 JSON\u3002\u8abf\u7528\u5916\u90e8 API \u6642\uff0c\u652f\u6301\u4ee5\u4e0b\u8eab\u4efd\u9a57\u8b49\u9078\u9805\uff1a\n- Dialogflow Service Agent \u8eab\u4efd\u9a57\u8b49- Dialogflow \u53ef\u4ee5\u4f7f\u7528 [Dialogflow Service Agent](https://cloud.google.com/iam/docs/service-agents?hl=zh-cn#dialogflow-service-agent) \u751f\u6210 [ID \u4ee4\u724c](https://cloud.google.com/docs/authentication/token-types?hl=zh-cn#id) \u6216 [\u8a2a\u554f\u4ee4\u724c](https://cloud.google.com/docs/authentication/token-types?hl=zh-cn#access) \u3002 \u7576 Dialogflow \u8abf\u7528\u5916\u90e8 API \u6642\uff0c\u4ee4\u724c\u6703\u6dfb\u52a0\u5230\u6388\u6b0a HTTP \u6a19\u982d\u4e2d\u3002\n- \u5c07 [roles/cloudfunctions.invoker](https://cloud.google.com/functions/docs/reference/iam/roles?hl=zh-cn#cloudfunctions.invoker) \u548c [roles/run.invoker](https://cloud.google.com/run/docs/reference/iam/roles?hl=zh-cn#run.invoker) \u89d2\u8272\u6388\u4e88 **service-agent-project-number@gcp-sa-dialogflow.iam.gserviceaccount.com** \u5f8c\uff0c\u60a8\u5c31\u53ef\u4ee5\u4f7f\u7528 ID \u4ee4\u724c\u8a2a\u554f Cloud Functions \u548c Cloud Run \u670d\u52d9\u3002\u5982\u679c Cloud Functions \u548c Cloud Run \u670d\u52d9\u4f4d\u65bc\u540c\u4e00 [\u8cc7\u6e90\u9805\u76ee](https://cloud.google.com/dialogflow/cx/docs/concept/multi-project?hl=zh-cn) \u4e2d\uff0c\u5247\u60a8\u7121\u9700\u984d\u5916\u7684 IAM \u6b0a\u9650\u5373\u53ef\u8abf\u7528\u5b83\u5011\u3002\n- \u5411 **service-agent-project-number@gcp-sa-dialogflow.iam.gserviceaccount.com** \u6388\u4e88\u6240\u9700\u89d2\u8272\u5f8c\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528\u8a2a\u554f\u4ee4\u724c\u8a2a\u554f\u5176\u4ed6 Google Cloud API\u3002\n- API \u5bc6\u9470- \u60a8\u53ef\u4ee5\u901a\u904e\u63d0\u4f9b\u5bc6\u9470\u540d\u7a31\u3001\u8acb\u6c42\u4f4d\u7f6e\uff08\u6a19\u982d\u6216\u67e5\u8a62\u5b57\u7b26\u4e32\uff09\u548c API \u5bc6\u9470\u4f86\u914d\u7f6e API \u5bc6\u9470\u8eab\u4efd\u9a57\u8b49\uff0c\u4ee5\u4fbf Dialogflow \u5728\u8acb\u6c42\u4e2d\u50b3\u905e API \u5bc6\u9470\u3002\n- OAuth- \u670d\u52d9\u5668\u5230\u670d\u52d9\u5668\u8eab\u4efd\u9a57\u8b49\u652f\u6301 OAuth \u5ba2\u6236\u7aef\u6191\u64da\u6d41\u7a0b\u3002\u9700\u8981\u5728 Dialogflow \u4e2d\u914d\u7f6e\u4f86\u81ea OAuth \u63d0\u4f9b\u65b9\u7684\u5ba2\u6236\u7aef ID\u3001\u5ba2\u6236\u7aef\u5bc6\u9470\u548c\u4ee4\u724c\u7aef\u9ede\u3002Dialogflow \u6703\u4ea4\u63db OAuth \u8a2a\u554f\u4ee4\u724c\uff0c\u4e26\u5c07\u5176\u50b3\u5165\u8acb\u6c42\u7684 auth \u6a19\u982d\u4e2d\u3002\n- \u5c0d\u65bc\u5176\u4ed6 OAuth \u6d41\u7a0b\uff0c\u60a8\u9700\u8981\u4f7f\u7528\u51fd\u6578\u5de5\u5177\u8207\u60a8\u81ea\u5df1\u7684\u767b\u9304\u754c\u9762\u96c6\u6210\uff0c\u4ee5\u4ea4\u63db\u4ee4\u724c\u3002\n- \u96d9\u5411 TLS \u8eab\u4efd\u9a57\u8b49- \u8acb\u53c3\u95b1 [\u96d9\u5411 TLS \u8eab\u4efd\u9a57\u8b49](https://cloud.google.com/dialogflow/cx/docs/concept/mtls?hl=zh-cn) \u6587\u6a94\u3002\n- \u81ea\u5b9a\u7fa9 CA \u8b49\u66f8- \u8acb\u53c3\u95b1 [\u81ea\u5b9a\u7fa9 CA \u8b49\u66f8](https://cloud.google.com/dialogflow/cx/docs/concept/custom-ca?hl=zh-cn) \u6587\u6a94\u3002\n### \u6578\u64da\u5b58\u5132\u5340\u5de5\u5177\nplaybook \u4ee3\u7406\u53ef\u4ee5\u4f7f\u7528\u6578\u64da\u5b58\u5132\u5340\u5de5\u5177\u56de\u7b54\u6700\u7d42\u7528\u6236\u5728\u60a8\u7684 [\u6578\u64da\u5b58\u5132\u5340](https://cloud.google.com/dialogflow/vertex/docs/concept/data-store?hl=zh-cn) \u4e2d\u63d0\u51fa\u7684\u554f\u984c\u3002\u60a8\u53ef\u4ee5\u7232\u6bcf\u7a2e\u5de5\u5177\u8a2d\u7f6e\u4e00\u500b\u6bcf\u7a2e\u985e\u578b\u7684\u6578\u64da\u5b58\u5132\u5340\uff0c\u8a72\u5de5\u5177\u5c07\u67e5\u8a62\u6bcf\u500b\u6578\u64da\u5b58\u5132\u5340\u4ee5\u67e5\u627e\u7b54\u6848\u3002 \u9ed8\u8a8d\u60c5\u6cc1\u4e0b\uff0cPlaybook \u4ee3\u7406\u5c07\u4ee3\u8868\u60a8\u8abf\u7528\u6578\u64da\u5b58\u5132\u5340\u5de5\u5177\u3002\u6216\u8005\uff0c\u60a8\u4e5f\u53ef\u4ee5\u5728 [\u5ba2\u6236\u7aef](#client-side) \u57f7\u884c\u6578\u64da\u5b58\u5132\u5340\u5de5\u5177\u3002\n\u6578\u64da\u5b58\u5132\u5340\u985e\u578b\u53ef\u4ee5\u662f\u4ee5\u4e0b\u985e\u578b\u4e4b\u4e00\uff1a\n- `PUBLIC_WEB`\uff1a\u5305\u542b\u516c\u958b Web \u5167\u5bb9\u7684\u6578\u64da\u5b58\u5132\u5340\u3002\n- `UNSTRUCTURED`\uff1a\u5305\u542b\u975e\u7d50\u69cb\u5316\u79c1\u5bc6\u6578\u64da\u7684\u6578\u64da\u5b58\u5132\u5340\u3002\n- `STRUCTURED`\uff1a\u5305\u542b\u7d50\u69cb\u5316\u6578\u64da\uff08\u4f8b\u5982\u5e38\u898b\u554f\u984c\u89e3\u7b54\uff09\u7684\u6578\u64da\u5b58\u5132\u5340\u3002\n\u4ee5\u4e0b\u793a\u4f8b\u5c55\u793a\u77ad\u5982\u4f55\u5f15\u7528\u6578\u64da\u5b58\u5132\u5340\uff1a\n```\n\"dataStoreConnections\": [\u00a0 {\u00a0 \u00a0 \"dataStoreType\": \"PUBLIC_WEB\",\u00a0 \u00a0 \"dataStore\": \"projects/PROJECT_NUMBER/locations/LOCATION_ID/collections/default_collection/dataStores/DATASTORE_ID\"\u00a0 },\u00a0 {\u00a0 \u00a0 \"dataStoreType\": \"UNSTRUCTURED\",\u00a0 \u00a0 \"dataStore\": \"projects/PROJECT_NUMBER/locations/LOCATION_ID/collections/default_collection/dataStores/DATASTORE_ID\"\u00a0 },\u00a0 {\u00a0 \u00a0 \"dataStoreType\": \"STRUCTURED\",\u00a0 \u00a0 \"dataStore\": \"projects/PROJECT_NUMBER/locations/LOCATION_ID/collections/default_collection/dataStores/DATASTORE_ID\"\u00a0 }]\n```\n\u6578\u64da\u5b58\u5132\u5340\u5de5\u5177\u97ff\u61c9\u9084\u53ef\u80fd\u5305\u542b\u6709\u95dc\u7528\u65bc\u751f\u6210\u97ff\u61c9\u7684\u5167\u5bb9\u4f86\u6e90\u7684\u7247\u6bb5\u3002Playbook \u4ee3\u7406\u53ef\u4ee5\u9032\u4e00\u6b65\u8aaa\u660e\u5982\u4f55\u5f9e\u6578\u64da\u5b58\u5132\u5340\u7e7c\u7e8c\u56de\u7b54\uff0c\u6216\u5728\u6c92\u6709\u56de\u7b54\u6642\u5982\u4f55\u97ff\u61c9\u3002\u9019\u4e9b\u793a\u4f8b\u53ef\u7528\u65bc\u9032\u4e00\u6b65\u589e\u5f37 Playbook \u4ee3\u7406\u7684\u884c\u7232\u3002\u8a72\u793a\u4f8b\u61c9\u5177\u6709\u4ee5\u4e0b\u67b6\u69cb\uff1a\n```\n{\u00a0 \"toolUse\": {\u00a0 \u00a0 \"tool\": \"projects/PROJECT_ID/locations/LOCATION_ID/agents/AGENT_ID/tools/TOOL_ID\",\u00a0 \u00a0 \"action\": \"TOOL_DISPLAY_NAME\",\u00a0 \u00a0 \"inputParameters\": [\u00a0 \u00a0 \u00a0 {\u00a0 \u00a0 \u00a0 \u00a0 \"name\": \"TOOL_DISPLAY_NAME input\",\u00a0 \u00a0 \u00a0 \u00a0 \"value\": {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"query\": \"QUERY\"\u00a0 \u00a0 \u00a0 \u00a0 }\u00a0 \u00a0 \u00a0 }\u00a0 \u00a0 ],\u00a0 \u00a0 \"outputParameters\": [\u00a0 \u00a0 \u00a0 {\u00a0 \u00a0 \u00a0 \u00a0 \"name\": \"TOOL_DISPLAY_NAME output\",\u00a0 \u00a0 \u00a0 \u00a0 \"value\": {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"answer\": \"ANSWER\",\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"snippets\": [\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"title\": \"TITLE\",\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"text\": \"TEXT_FROM_DATASTORE\",\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"uri\": \"URI_OF_DATASTORE\"\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 }\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 ]\u00a0 \u00a0 \u00a0 \u00a0 }\u00a0 \u00a0 \u00a0 }\u00a0 \u00a0 ]\u00a0 }}\n```\n### \u51fd\u6578\u5de5\u5177\n\u5982\u679c\u60a8\u7684\u5ba2\u6236\u7aef\u4ee3\u78bc\u53ef\u4ee5\u8a2a\u554f\u67d0\u9805\u529f\u80fd\uff0c\u4f46 OpenAPI \u5de5\u5177\u7121\u6cd5\u8a2a\u554f\u8a72\u529f\u80fd\uff0c\u90a3\u9ebc\u60a8\u53ef\u4ee5\u4f7f\u7528\u51fd\u6578\u5de5\u5177\u3002 \u51fd\u6578\u5de5\u5177\u59cb\u7d42\u5728\u5ba2\u6236\u7aef\u57f7\u884c\uff0c\u800c\u4e0d\u662f\u7531 playbook \u4ee3\u7406\u57f7\u884c\u3002\n\u5177\u9ad4\u904e\u7a0b\u5982\u4e0b\uff1a\n- \u60a8\u7684\u5ba2\u6236\u7aef\u4ee3\u78bc\u6703\u767c\u9001\u6aa2\u6e2c\u610f\u5716\u8acb\u6c42\u3002\n- Playbook \u4ee3\u7406\u6aa2\u6e2c\u9700\u8981\u51fd\u6578\u5de5\u5177\uff0c\u4e26\u4e14\u6aa2\u6e2c\u610f\u5716\u97ff\u61c9\u5305\u542b\u5de5\u5177\u7684\u540d\u7a31\u4ee5\u53ca\u8f38\u5165\u53c3\u6578\u3002\u6b64\u6703\u8a71\u5c07\u66ab\u505c\uff0c\u76f4\u5230\u6536\u5230\u53e6\u4e00\u500b\u5305\u542b\u5de5\u5177\u7d50\u679c\u7684\u6aa2\u6e2c\u610f\u5716\u8acb\u6c42\u3002\n- \u60a8\u7684\u5ba2\u6236\u7aef\u4ee3\u78bc\u8abf\u7528\u8a72\u5de5\u5177\u3002\n- \u60a8\u7684\u5ba2\u6236\u7aef\u4ee3\u78bc\u6703\u767c\u9001\u53e6\u4e00\u500b\u6aa2\u6e2c\u610f\u5716\u8acb\u6c42\uff0c\u8a72\u8acb\u6c42\u4ee5\u8f38\u51fa\u53c3\u6578\u7684\u5f62\u5f0f\u63d0\u4f9b\u5de5\u5177\u7d50\u679c\u3002\n\u4ee5\u4e0b\u793a\u4f8b\u5c55\u793a\u4e86\u51fd\u6578\u5de5\u5177\u7684\u8f38\u5165\u548c\u8f38\u51fa\u67b6\u69cb\uff1a\n```\n{\u00a0 \"type\": \"object\",\u00a0 \"properties\": {\u00a0 \u00a0 \"location\": {\u00a0 \u00a0 \u00a0 \"type\": \"string\",\u00a0 \u00a0 \u00a0 \"description\": \"The city and state, for example, San Francisco, CA\"\u00a0 \u00a0 }\u00a0 },\u00a0 \"required\": [\u00a0 \u00a0 \"location\"\u00a0 ]}\n```\n```\n{\u00a0 \"type\": \"object\",\u00a0 \"properties\": {\u00a0 \u00a0 \"temperature\": {\u00a0 \u00a0 \u00a0 \"type\": \"number\",\u00a0 \u00a0 \u00a0 \"description\": \"The temperature\"\u00a0 \u00a0 }\u00a0 }}\n```\n\u4ee5\u4e0b\u793a\u4f8b\u986f\u793a\u4e86\u4f7f\u7528 REST \u7684\u521d\u59cb\u6aa2\u6e2c\u610f\u5716\u8acb\u6c42\u548c\u97ff\u61c9\uff1a\n```\nHTTP method and URL:\nPOST https://REGION_ID-dialogflow.googleapis.com/v3/projects/PROJECT_ID/locations/LOCATION_ID/agents/AGENT_ID/sessions/SESSION_ID:detectIntent\n{\n \"queryInput\": {\n \"text\": {\n  \"text\": \"what is the weather in Mountain View\"\n },\n \"languageCode\": \"en\"\n }\n}\n```\n```\n{\u00a0 \"queryResult\": {\u00a0 \u00a0 \"text\": \"what is the weather in Mountain View\",\u00a0 \u00a0 \"languageCode\": \"en\",\u00a0 \u00a0 \"responseMessages\": [\u00a0 \u00a0 \u00a0 {\u00a0 \u00a0 \u00a0 \u00a0 \"source\": \"VIRTUAL_AGENT\",\u00a0 \u00a0 \u00a0 \u00a0 \"toolCall\": {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"tool\": \"<tool-resource-name>\",\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"action\": \"get-weather-tool\",\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"inputParameters\": {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"location\": \"Mountain View\"\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 }\u00a0 \u00a0 \u00a0 \u00a0 }\u00a0 \u00a0 \u00a0 }\u00a0 \u00a0 ]\u00a0 }}\n```\n\u4ee5\u4e0b\u793a\u4f8b\u5c55\u793a\u4e86\u7b2c\u4e8c\u500b\u6aa2\u6e2c\u610f\u5716\u8acb\u6c42\uff0c\u8a72\u8acb\u6c42\u63d0\u4f9b\u4e86\u5de5\u5177\u7d50\u679c\uff1a\n```\n{\u00a0 \"queryInput\": {\u00a0 \u00a0 \"toolCallResult\": {\u00a0 \u00a0 \u00a0 \"tool\": \"<tool-resource-name>\",\u00a0 \u00a0 \u00a0 \"action\": \"get-weather-tool\",\u00a0 \u00a0 \u00a0 \"outputParameters\": {\u00a0 \u00a0 \u00a0 \u00a0 \"temperature\": 28.0\u00a0 \u00a0 \u00a0 }\u00a0 \u00a0 },\u00a0 \u00a0 \"languageCode\": \"en\"\u00a0 }}\n```\n### \u5ba2\u6236\u7aef\u57f7\u884c\n\u8207\u51fd\u6578\u5de5\u5177\u4e00\u6a23\uff0cOpenAPI \u548c\u6578\u64da\u5b58\u5132\u5340\u5de5\u5177\u53ef\u4ee5\u5728\u5ba2\u6236\u7aef\u57f7\u884c\uff0c\u65b9\u6cd5\u662f\u5728\u8207\u6703\u8a71\u4ea4\u4e92\u6642\u61c9\u7528 API \u66ff\u63db\u3002\n\u4f8b\u5982\uff1a\n```\nDetectIntentRequest {\u00a0 ...\u00a0 query_params {\u00a0 \u00a0 playbook_state_override {\u00a0 \u00a0 \u00a0 playbook_execution_mode: ALWAYS_CLIENT_EXECUTION\u00a0 \u00a0 }\u00a0 }\u00a0 ...}\n```\n\u5177\u9ad4\u904e\u7a0b\u5982\u4e0b\uff1a\n- \u60a8\u7684\u5ba2\u6236\u7aef\u4ee3\u78bc\u6703\u767c\u9001\u4e00\u500b\u6307\u5b9a\u5ba2\u6236\u7aef\u57f7\u884c\u7684\u6aa2\u6e2c intent \u8acb\u6c42\u3002\n- Playbook \u4ee3\u7406\u6aa2\u6e2c\u9700\u8981\u67d0\u500b\u5de5\u5177\uff0c\u4e26\u4e14\u6aa2\u6e2c\u610f\u5716\u97ff\u61c9\u5305\u542b\u8a72\u5de5\u5177\u7684\u540d\u7a31\u4ee5\u53ca\u8f38\u5165\u53c3\u6578\u3002\u6b64\u6703\u8a71\u5c07\u66ab\u505c\uff0c\u76f4\u5230\u6536\u5230\u53e6\u4e00\u500b\u5305\u542b\u5de5\u5177\u7d50\u679c\u7684\u6aa2\u6e2c\u610f\u5716\u8acb\u6c42\u3002\n- \u60a8\u7684\u5ba2\u6236\u7aef\u4ee3\u78bc\u8abf\u7528\u8a72\u5de5\u5177\u3002\n- \u60a8\u7684\u5ba2\u6236\u7aef\u4ee3\u78bc\u6703\u767c\u9001\u53e6\u4e00\u500b\u6aa2\u6e2c\u610f\u5716\u8acb\u6c42\uff0c\u8a72\u8acb\u6c42\u4ee5\u8f38\u51fa\u53c3\u6578\u7684\u5f62\u5f0f\u63d0\u4f9b\u5de5\u5177\u7d50\u679c\u3002", "guide": "Dialogflow"}