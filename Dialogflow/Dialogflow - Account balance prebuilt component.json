{"title": "Dialogflow - Account balance prebuilt component", "url": "https://cloud.google.com/dialogflow/cx/docs/concept/prebuilt-component/account-balance", "abstract": "# Dialogflow - Account balance prebuilt component\nThe account balance [prebuilt component](/dialogflow/cx/docs/concept/prebuilt-component) checks a customer's authentication level, then provides account balance information to an authenticated customer. If the customer has multiple accounts, the component confirms the specific account the customer would like to retrieve account balance for. This component uses the [Authentication](/dialogflow/cx/docs/concept/prebuilt-component/authentication) prebuilt component to authenticate users.\n", "content": "## Limitations\nIn addition to the [common prebuilt component limitations](/dialogflow/cx/docs/concept/prebuilt-component#limits) , this prebuilt component has the following limitations:\n- This component does not encrypt any data.## Sample dialogs\nThe following sample dialogs demonstrate common scenarios handled by this prebuilt component. The sample dialogs demonstrate behavior when the component is called via telephony, which triggers the Default Welcome Intent and the first agent response at the start of the conversation.\n### Single account\nEnd-user has a single account and is provided with the account balance.\n| User input | Agent response                            |\n|-------------:|:---------------------------------------------------------------------------------------------------------------------------|\n|   nan | Agent authenticates user using Authentication prebuilt component               |\n|   nan | Thank you, you have been successfully authenticated.                  |\n|   nan | Please wait while we are fetching your account details. Your balance associated with the account ending in 4567 is $50.00. |\n### Multiple accounts\nEnd-user has multiple accounts; agent requests and confirms the last four digits of the account number and provides the account balance for that account.\n| User input | Agent response                                                 |\n|:-------------|:----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|\n| nan   | Agent authenticates user using Authentication prebuilt component                                    |\n| nan   | Thank you, you have been successfully authenticated.                                       |\n| nan   | Please wait while we are fetching your account details. We have found that there are 2 accounts associated with your number. Can you please help us with the last 4 digits of the account you are referring to? |\n| 2002   | nan                                                    |\n| nan   | The last four digits of the account number that we got are 2002, is that correct?                                |\n| yes   | nan                                                    |\n| nan   | Your balance associated with the account number ending with 2002 is $5000.                                  |\n### Multiple accounts with context\nEnd-user has multiple accounts, the referred account number is retained from previous intent, and is provided with the account balance.\n| User input | Agent response                                          |\n|:-------------|:--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|\n| nan   | Please wait while we are fetching your account details. We have found that there are 3 accounts associated with your number. Are you looking for the account number ending with 4567? |\n| Yes   | nan                                             |\n| nan   | Your balance associated with the account number ending with 4567 is $50.                            |\n## Naming conventions\nThis prebuilt component uses the following naming conventions:\n| Feature     | Format            | Example                 |\n|:--------------------------|:------------------------------------------------------|:------------------------------------------------------------------------|\n| Flow      | [Component Name]          | Account Balance               |\n| Component Specific Intent | prebuilt_components_[component_name]_[intent_name] | prebuilt_components_account_number_collection_four_digit_account_number |\n| Webhook     | prebuilt_components_[component_name]:[webhook_action] | prebuilt_components_account_balance:get_account_balance     |\n## Input parameters\nInput parameters are parameters that are used to configure certain behaviors of the component. The parameters will be used by one or more conditions within the flow to determine how the component should behave. Flow-scoped parameters must be set on the start page of the component as described below. Session-scoped parameters may be set either by a calling flow, or on the start page of this component.\nThis prebuilt component accepts the following input parameters:\n| Parameter Name         | Description                                                                          | Input Format |\n|:--------------------------------------------------|:-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:---------------|\n| $session.params.auth_level      | (optional) Indicates the authentication level of the caller.                                                              | integer  |\n| $session.params.auth_level_req     | Indicates the level of authentication needed before a user can access their account balance. This value is configured in the parameter presets of the page entry fulfillment in the check auth level page. By default this value is 1.                   | integer  |\n| $session.params.account_auth_enabled    | Indicates whether the user should be authenticated as an account holder as described in Authentication types. This value is configured in the parameter presets of the page entry fulfillment in the check auth level page. By default this value is true.              | boolean  |\n| $session.params.card_auth_enabled     | Indicates whether the user should be authenticated as a card holder as described in Authentication types. This value is configured in the parameter presets of the page entry fulfillment in the check auth level page. By default this value is false.               | boolean  |\n| $session.params.phone_number      | (optional) Customer's registered phone number used for authentication.                                                           | string   |\n| $session.params.account_count      | (optional) Number of accounts associated with the authenticated user.                                                           | integer  |\n| $session.params.last_four_digit_of_account_number | (optional) Last four digits of the customer account number for which the balance needs to be provided. If the customer has a single account, this information is retrieved automatically post authentication. If the customer has multiple accounts, the specific account number is collected from the customer. | string   |\n| $flow.max_retry_acc_number      | Specifies the number of retries allowed when collecting the last four digits of the end-user's account number. The default value is 3                                           | integer  |\n## Output parameters\nOutput parameters are session parameters that will remain active after exiting the component. These parameters contain important information collected by the component. This prebuilt component provides values for the following output parameters:\n| Parameter Name     | Description                                                                                                                                                                           | Output Format |\n|:----------------------------------|:-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:----------------|\n| auth_level      | Indicates the authentication level of the caller.                                                                                                                                                                  | integer   |\n| phone_number      | User's local phone number, without the country code, used to identify the user.                                                                                                                                                          | string   |\n| account_count      | The number of accounts associated with the registered telephone number. These accounts include self-accounts and accounts for which the user has power of attorney.                                                                                                                                     | integer   |\n| last_four_digit_of_account_number | If a user has a single account, the last four digits of the account number are returned. If a user has more than one account, the value of this parameter is the last four digits of the account number the user selected to receive account balance information for.                                                                                                             | string   |\n| transfer_reason     | This parameter indicates the reason the flow exited, if it was not successful. The returned value is one of: agent: the end-user requested a human agent at some point during the conversation. denial_of_information: the end-user declined to share information requested by the component. max_no_input: the conversation reached the maximum number of retries for no-input events. See no-input built-in events. max_no_match: the conversation reached the maximum number of retries for no-match events. See no-match built-in events. webhook_error: a webhook error occurred. See webhook.error built-in event. webhook_not_found: a webhook URL was unreachable. See webhook.error.not-found built-in event. | string   |\n## Basic setup\nTo set up this prebuilt component:\n- [Import the prebuilt component](/dialogflow/cx/docs/concept/prebuilt-component#import) .\n- Configure the provided [flexible webhooks](/dialogflow/cx/docs/concept/webhook#flexible) with configuration describing your Dialogflow-external services, see Webhook setup below.## Webhook setup\nIn order to use this component, you will need to configure the included [flexible webhooks](/dialogflow/cx/docs/concept/webhook#flexible) to retrieve needed information from your external services.\n### Authentication\nIf you have not previously configured external services required for authentication, you will need to configure them to enable authentication of users for this component. See [Authentication webhook setup](/dialogflow/cx/docs/concept/prebuilt-component/authentication#webhook-setup) for detailed instructions.\n### Validate account\nThe `prebuilt_components_account_services:validate_account` webhook is used by the component to verify that an account exists based on the user's registered phone number and the last four digits of the account number provided. The webhook also returns the account balance, if an account exists.\nThe following parameters are provided by the component as inputs to the API request.\n| Parameter Name         | Description                           | Input Format |\n|:--------------------------------------------------|:-----------------------------------------------------------------------------------------------------------------------|:---------------|\n| $session.params.phone_number      | User's local phone number, without the country code, used to identify the user.          | string   |\n| $session.params.last_four_digit_of_account_number | The last four digits of the account number the user selected and confirmed to receive account balance information for. | string   |\nThe following parameters are pulled from the API response to be used by the component.\n| Parameter Name | Description                        | Output Format |\n|:-----------------|:----------------------------------------------------------------------------------------------------------|:----------------|\n| account_found | Indicates whether an account with the provided last four digits exists for the user's registered account. | boolean   |\n| balance   | The amount of the current balance on the account, if it exists.           | number   |### Complete\nYour agent and its webhooks should now be set up and ready to test.", "guide": "Dialogflow"}