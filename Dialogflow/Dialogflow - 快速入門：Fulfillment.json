{"title": "Dialogflow - \u5feb\u901f\u5165\u9580\uff1aFulfillment", "url": "https://cloud.google.com/dialogflow/es/docs/quick/fulfillment?hl=zh-cn", "abstract": "# Dialogflow - \u5feb\u901f\u5165\u9580\uff1aFulfillment\n\u672c\u6307\u5357\u4ecb\u7d39\u5982\u4f55\u4f7f\u7528 [fulfillment](https://cloud.google.com/dialogflow/docs/fulfillment-overview?hl=zh-cn) \u5c07\u4ee3\u7406\u8207\u670d\u52d9\u96c6\u6210\u3002\u901a\u904e\u96c6\u6210\u670d\u52d9\uff0c\u60a8\u53ef\u4ee5\u6839\u64da\u6700\u7d42\u7528\u6236\u7684\u8868\u8ff0\u4f86\u57f7\u884c\u64cd\u4f5c\uff0c\u4e26\u5c07\u52d5\u614b\u97ff\u61c9\u767c\u9001\u56de\u6700\u7d42\u7528\u6236\u3002\n**\u6ce8\u610f** \uff1a\u5982\u679c\u60a8\u4f7f\u7528\u7684\u662f Google \u52a9\u7406\uff0c\u8acb\u67e5\u770b [Google \u52a9\u7406](https://cloud.google.com/dialogflow/es/docs/integrations/aog?hl=zh-cn) \u9801\u9762\u4e0a\u7684\u9078\u9805\u3002\n", "content": "## \u6e96\u5099\u5de5\u4f5c\n\u5982\u679c\u60a8\u4e0d\u6253\u7b97\u4f7f\u7528 fulfillment\uff0c\u5247\u53ef\u4ee5\u8df3\u904e\u6b64\u5feb\u901f\u5165\u9580\u3002\n\u9019\u4e9b\u6b65\u9a5f\u6703\u4f7f\u7528 [Cloud Functions](https://cloud.google.com/functions/docs?hl=zh-cn) \uff0c\u4e26\u5047\u5b9a\u60a8\u5177\u5099\u57fa\u672c\u7684 Node.js \u77e5\u8b58\u3002\u5982\u679c\u8981\u4f7f\u7528\u81ea\u5df1\u7684\u670d\u52d9\u5668\u6216\u5176\u4ed6\u8a9e\u8a00\u4f86\u5275\u5efa fulfillment\uff0c\u8acb\u53c3\u95b1\u66f4\u8a73\u7d30\u7684 [fulfillment \u6587\u6a94](https://cloud.google.com/dialogflow/docs/fulfillment-overview?hl=zh-cn) \u3002\n\u5728\u95b1\u8b80\u672c\u6307\u5357\u4e4b\u524d\uff0c\u8acb\u5148\u5b8c\u6210\u4ee5\u4e0b\u4e8b\u9805\uff1a\n- \u95b1\u8b80 [Dialogflow \u57fa\u790e\u77e5\u8b58](https://cloud.google.com/dialogflow/docs/basics?hl=zh-cn) \u3002\n- \u57f7\u884c [\u8a2d\u7f6e\u6b65\u9a5f](https://cloud.google.com/dialogflow/docs/quick/setup?hl=zh-cn) \u3002\n- \u57f7\u884c [\u69cb\u5efa\u4ee3\u7406](https://cloud.google.com/dialogflow/docs/quick/build-agent?hl=zh-cn) \u5feb\u901f\u5165\u9580\u6307\u5357\u4e2d\u7684\u6b65\u9a5f\u3002\u4ee5\u4e0b\u6b65\u9a5f\u5c07\u7e7c\u7e8c\u8655\u7406\u540c\u4e00\u4ee3\u7406\u3002\u5982\u679c\u60a8\u4e0d\u518d\u64c1\u6709\u8a72\u4ee3\u7406\uff0c\u5247\u53ef\u4ee5\u4e0b\u8f09 [build-agent-quickstart.zip](https://cloud.google.com/static/dialogflow/es/docs/data/build-agent-quickstart.zip?hl=zh-cn) \u4e26 [\u5c0e\u5165\u6587\u4ef6](https://cloud.google.com/dialogflow/docs/agents-settings?hl=zh-cn#export) \u3002## \u5167\u5d4c\u7de8\u8f2f\u5668\nDialogflow \u63a7\u5236\u6aaf\u7684\u5167\u7f6e\u4ee3\u78bc\u7de8\u8f2f\u5668\uff0c\u4e5f\u88ab\u7a31\u7232\u5167\u5d4c\u7de8\u8f2f\u5668 [](https://cloud.google.com/dialogflow/docs/fulfillment-inline-editor?hl=zh-cn) \uff0c\u53ef\u7528\u65bc\u5275\u5efa fulfillment \u4ee3\u78bc\u4e26\u5c07\u4ee3\u78bc\u90e8\u7f72\u5230 [Cloud Functions](https://cloud.google.com/functions/docs?hl=zh-cn) \u4e2d\u3002Cloud Functions \u6703\u7522\u751f\u76f8\u95dc\u8cbb\u7528\uff0c\u4f46\u8a72\u670d\u52d9 [\u6bcf\u6708\u6709\u5927\u91cf\u7684\u514d\u8cbb\u8abf\u7528\u6b21\u6578](https://cloud.google.com/functions/pricing?hl=zh-cn) \u3002\u8acb\u6ce8\u610f\uff0c\u60a8\u4ecd\u5fc5\u9808\u8a3b\u518a\u4e26\u63d0\u4f9b\u6709\u6548\u7684\u7d50\u7b97\u8cec\u865f\u3002\u60a8\u96a8\u6642\u53ef\u4ee5\u53d6\u6d88\u3002\n\u521d\u6b21\u5553\u7528\u5167\u5d4c\u7de8\u8f2f\u5668\u6642\uff0cNode.js fulfillment \u4ee3\u78bc\u6703\u9810\u586b\u5145\u91dd\u5c0d\u6240\u6709\u4ee3\u7406\u5747\u5305\u542b\u7684 [\u9ed8\u8a8d\u610f\u5716](https://cloud.google.com/dialogflow/docs/intents-default?hl=zh-cn) \u7684\u9ed8\u8a8d\u8655\u7406\u7a0b\u5e8f\u3002\u8a72\u4ee3\u78bc\u4e2d\u9084\u6703\u5305\u542b\u8a3b\u91cb\u6027\u8aaa\u660e\uff0c\u4ee5\u4fbf\u65bc\u60a8\u77ad\u89e3\u5982\u4f55\u7232\u958b\u767c\u8005\u5b9a\u7fa9\u7684\u610f\u5716\u6dfb\u52a0\u8655\u7406\u7a0b\u5e8f\u3002\n\u5167\u5d4c\u7de8\u8f2f\u5668\u9069\u7528\u65bc\u7c21\u55ae\u7684 fulfillment \u6e2c\u8a66\u548c\u539f\u578b\u8a2d\u8a08\u3002 \u5982\u60f3\u69cb\u5efa\u751f\u7522\u61c9\u7528\uff0c\u8acb\u5148\u5275\u5efa\u4e00\u500b [\u7db2\u7d61\u9264\u5b50\u670d\u52d9](https://cloud.google.com/dialogflow/docs/fulfillment-webhook?hl=zh-cn) \u3002\n## \u4f7f\u7528\u5167\u5d4c\u7de8\u8f2f\u5668\u5553\u7528\u548c\u90e8\u7f72 fulfillment\n\u5982\u9700\u4f7f\u7528\u5167\u5d4c\u7de8\u8f2f\u5668\u5553\u7528\u548c\u90e8\u7f72\u9ed8\u8a8d fulfillment \u4ee3\u78bc\uff0c\u8acb\u57f7\u884c\u4ee5\u4e0b\u64cd\u4f5c\uff1a\n- \u9ede\u64ca\u5de6\u5074\u908a\u6b04\u83dc\u55ae\u4e2d\u7684 **Fulfillment** \u3002\n- \u5c07 **\u5167\u5d4c\u7de8\u8f2f\u5668** \u5207\u63db\u7232 **\u5df2\u5553\u7528** \u3002\n- \u5982\u679c\u6c92\u6709 [\u5728\u8a2d\u7f6e\u6b65\u9a5f\u4e2d\u5553\u7528\u7d50\u7b97\u529f\u80fd](https://cloud.google.com/dialogflow/docs/quick/setup?hl=zh-cn#billing) \uff0c\u5247\u7cfb\u7d71\u6703\u63d0\u793a\u60a8\u7acb\u5373\u5553\u7528\u7d50\u7b97\u529f\u80fd\u3002Cloud Functions \u6703\u7522\u751f\u76f8\u95dc\u8cbb\u7528\uff0c\u4f46\u8a72\u670d\u52d9 [\u6bcf\u6708\u6709\u5927\u91cf\u7684\u514d\u8cbb\u8abf\u7528\u6b21\u6578](https://cloud.google.com/functions/pricing?hl=zh-cn) \u3002\u8acb\u6ce8\u610f\uff0c\u60a8\u4ecd\u5fc5\u9808\u8a3b\u518a\u4e26\u63d0\u4f9b\u7d50\u7b97\u8cec\u865f\u3002\u60a8\u96a8\u6642\u53ef\u4ee5\u53d6\u6d88\u8a02\u95b1\u3002\n- \u9ede\u64ca\u8868\u55ae\u5e95\u90e8\u7684 **\u90e8\u7f72** \uff0c\u7136\u5f8c\u7b49\u5f85\u5c0d\u8a71\u6846\u6307\u793a\u5df2\u90e8\u7f72\u8a72\u6620\u50cf\u3002\n\u60a8\u5fc5\u9808\u7232\u6bcf\u500b\u9700\u8981\u4f7f\u7528 fulfillment \u7684\u610f\u5716\u5553\u7528 fulfillment\u3002\u5982\u9700\u7232\u9ed8\u8a8d\u6b61\u8fce\u610f\u5716\u5553\u7528 fulfillment\uff0c\u8acb\u57f7\u884c\u4ee5\u4e0b\u64cd\u4f5c\uff1a\n- \u9ede\u64ca\u5de6\u5074\u908a\u6b04\u83dc\u55ae\u4e2d\u7684 **\u610f\u5716** (Intents)\u3002\n- \u9ede\u64ca **\u9ed8\u8a8d\u6b61\u8fce\u610f\u5716** \u3002\n- \u5411\u4e0b\u6efe\u52d5\u5230 **Fulfillment** \u90e8\u5206\u4e26\u5c07 **\u7232\u6b64\u610f\u5716\u5553\u7528\u7db2\u7d61\u9264\u5b50\u8abf\u7528** (Enable webhook call for this intent) \u5207\u63db\u7232\u958b\u5553\u3002 **\u6ce8\u610f** \uff1a\u5553\u7528 fulfillment \u6703\u8986\u84cb\u5728\u610f\u5716\u7684 **\u97ff\u61c9** (Responses) \u90e8\u5206\u4e2d\u8a2d\u7f6e\u7684\u97ff\u61c9\u3002\u5982\u679c fulfillment \u5931\u6557\uff0c\u7cfb\u7d71\u5c07\u4f7f\u7528 **\u97ff\u61c9** \u90e8\u5206\u4e2d\u7684\u689d\u76ee\u3002\n- \u9ede\u64ca **\u4fdd\u5b58** \u6309\u9215\u4e26\u7b49\u5230 **\u4ee3\u7406\u8a13\u7df4** (Agent Training) \u7a97\u53e3\u6307\u793a\u8a13\u7df4\u5df2\u5b8c\u6210\u7232\u6b62\u3002\n\u73fe\u5728\uff0c\u60a8\u53ef\u4ee5\u5728\u6a21\u64ec\u5668\u4e2d\u6e2c\u8a66\u60a8\u7684 fulfillment\u3002\u5728\u6a21\u64ec\u5668\u4e2d\u8f38\u5165 `Hi` \uff0c\u5f97\u5230\u7684\u97ff\u61c9\u7232 `Welcome to my agent!` \u3002\u6b64\u97ff\u61c9\u662f\u901a\u904e\u525b\u525b\u90e8\u7f72\u7684 fulfillment \u7db2\u7d61\u9264\u5b50\u767c\u9001\u7684\u3002\u5177\u9ad4\u800c\u8a00\uff0c\u97ff\u61c9\u4f86\u81ea\u4ee5\u4e0b\u4ee3\u78bc\uff1a\n```\nfunction welcome(agent) {\n agent.add(`Welcome to my agent!`);\n}\n```\n## \u5275\u5efa\u81ea\u5b9a\u7fa9 fulfillment \u8655\u7406\u7a0b\u5e8f\n\u4e0a\u8ff0\u6b65\u9a5f\u4f7f\u7528\u9ed8\u8a8d\u5167\u5d4c\u7de8\u8f2f\u5668\u4ee3\u78bc\u63d0\u4f9b\u7684\u8655\u7406\u7a0b\u5e8f\u3002\u5982\u9700\u5275\u5efa\u81ea\u5b9a\u7fa9\u8655\u7406\u7a0b\u5e8f\uff0c\u8acb\u57f7\u884c\u4ee5\u4e0b\u64cd\u4f5c\uff1a\n- \u7232\u60a8\u5728\u5148\u524d\u6b65\u9a5f\u4e2d\u5275\u5efa\u7684`get-agent-name`\u610f\u5716\u5553\u7528 fulfillment\u3002\n- \u9ede\u64ca\u5de6\u5074\u908a\u6b04\u83dc\u55ae\u4e2d\u7684 **Fulfillment** \uff0c\u7136\u5f8c\u6aa2\u67e5\u5167\u5d4c\u7de8\u8f2f\u5668\u4e2d\u7684\u4ee3\u78bc\u3002\n- \u627e\u5230\u4ee5\u4e0b\u884c\uff1a```\nexports.dialogflowFirebaseFulfillment = functions.https.onRequest((request, response) => {\n````onRequest` \u51fd\u6578\u6703\u8655\u7406\u4f86\u81ea Dialogflow \u7684\u6240\u6709\u8acb\u6c42\u3002\u5728\u6b64\u51fd\u6578\u7684\u4ee3\u78bc\u5167\uff0c\u5b9a\u7fa9\u4e86\u7279\u5b9a\u7684\u8655\u7406\u7a0b\u5e8f\u51fd\u6578\u3002\u5339\u914d\u95dc\u806f\u7684\u610f\u5716\u6642\uff0c\u7cfb\u7d71\u5c07\u8abf\u7528\u9019\u4e9b\u8655\u7406\u7a0b\u5e8f\u51fd\u6578\u3002\u4f8b\u5982\uff0c\u4e0a\u4e00\u90e8\u5206\u4e2d\u4f7f\u7528\u7684\u51fd\u6578\u662f `function welcome(agent)` \u3002\n- \u5728\u73fe\u6709\u8655\u7406\u7a0b\u5e8f\u4e0b\u65b9\uff0c\u7232 `get-agent-name` \u610f\u5716\u6dfb\u52a0\u4ee5\u4e0b\u51fd\u6578\uff1a```\nfunction getAgentNameHandler(agent) {\u00a0 agent.add('From fulfillment: My name is Dialogflow!');}\n```\n- \u5728\u8655\u7406\u7a0b\u5e8f\u51fd\u6578\u5b9a\u7fa9\u4e0b\u65b9\uff0c\u4f7f\u7528\u4e86 `intentMap.set()` \u8abf\u7528\u3002\u9019\u4e9b\u8abf\u7528\u6703\u6309\u540d\u7a31\u5c07\u7279\u5b9a\u8655\u7406\u7a0b\u5e8f\u8207\u610f\u5716\u76f8\u95dc\u806f\u3002\u4f8b\u5982\uff0c `intentMap.set('Default Welcome Intent', welcome)` \u6703\u5c07 `welcome` \u8655\u7406\u7a0b\u5e8f\u8207\u540d\u7232 `Default Welcome Intent` \u7684\u610f\u5716\u76f8\u95dc\u806f\u3002\n- \u5728\u73fe\u6709 `intentMap.set` \u8abf\u7528\u4e0b\u65b9\uff0c\u7232 `get-agent-name` \u610f\u5716\u6dfb\u52a0\u4ee5\u4e0b\u884c\uff1a```\nintentMap.set('get-agent-name', getAgentNameHandler);\n```\n- \u9ede\u64ca\u8868\u55ae\u5e95\u90e8\u7684 **\u90e8\u7f72** \u3002\n- \u5728\u6a21\u64ec\u5668\u4e2d\u8f38\u5165 `What's your name?` \u3002 `From fulfillment: My name is Dialogflow!` \u97ff\u61c9\u5f9e\u65b0\u8655\u7406\u7a0b\u5e8f\u767c\u9001\u3002## \u8a2a\u554f\u53c3\u6578\u503c\n\u5728\u524d\u9762\u7684\u6b65\u9a5f\u4e2d\uff0c\u60a8\u5275\u5efa\u4e86 `set-language` \u610f\u5716\u4f86\u6a19\u8b58\u4eba\u985e\u548c\u7de8\u7a0b\u8a9e\u8a00\u3002\u8a72\u610f\u5716\u4f7f\u7528 `language` \u548c `language-programming` \u53c3\u6578\u3002\u5728\u6b64\u90e8\u5206\u4e2d\uff0c\u60a8\u53ef\u4ee5\u5728 fulfillment \u8655\u7406\u7a0b\u5e8f\u4e2d\u8a2a\u554f\u9019\u4e9b\u53c3\u6578\u7684\u503c\u3002\n\u5982\u9700\u6dfb\u52a0\u6b64\u8655\u7406\u7a0b\u5e8f\uff0c\u8acb\u57f7\u884c\u4ee5\u4e0b\u64cd\u4f5c\uff1a\n- \u7232`set-language`\u610f\u5716\u5553\u7528 fulfillment\u3002\n- \u9ede\u64ca\u5de6\u5074\u908a\u6b04\u83dc\u55ae\u4e2d\u7684 **Fulfillment** \u3002\n- \u985e\u4f3c\u65bc\u4e0a\u8ff0\u6b65\u9a5f\uff0c\u6dfb\u52a0\u4ee5\u4e0b\u8655\u7406\u7a0b\u5e8f\u548c `intentMap` \u8abf\u7528\uff1a```\nfunction languageHandler(agent) {\u00a0 \u00a0 const language = agent.parameters.language;\u00a0 \u00a0 const programmingLanguage = agent.parameters['language-programming'];\u00a0 \u00a0 if (language) {\u00a0 \u00a0 \u00a0 \u00a0 agent.add(`From fulfillment: Wow! I didn't know you knew ${language}`);\u00a0 \u00a0 } else if (programmingLanguage) {\u00a0 \u00a0 \u00a0 \u00a0 agent.add(`From fulfillment: ${programmingLanguage} is cool`);\u00a0 \u00a0 } else {\u00a0 \u00a0 \u00a0 \u00a0 agent.add(`From fulfillment: What language do you know?`);\u00a0 \u00a0 }}\n``````\nintentMap.set('set-language', languageHandler);\n```\n- \u9ede\u64ca **\u90e8\u7f72** \u3002\n\u8a72\u8655\u7406\u7a0b\u5e8f\u6703\u6aa2\u7d22\u53c3\u6578 `language` \u548c `language-programming` \uff0c\u4e26\u5c07\u5176\u5b58\u5132\u5728\u8b8a\u91cf\u4e2d\u3002\u5b83\u5f9e `agent.parameters` \u7279\u6027\u4e2d\u6aa2\u7d22\u9019\u4e9b\u503c\uff0c\u8a72\u7279\u6027\u662f\u4e00\u500b\u5c0d\u8c61\uff0c\u5305\u542b\u6700\u7d42\u7528\u6236\u5728\u5176\u8acb\u6c42\u4e2d\u6307\u5b9a\u7684\u6240\u6709\u53c3\u6578\u540d\u7a31\u548c\u503c\u3002\n\u5982\u8981\u8a66\u7528\u6b64\u529f\u80fd\uff0c\u8acb\u5728\u6a21\u64ec\u5668\u4e2d\u8f38\u5165 `I know how to speak German` \u3002", "guide": "Dialogflow"}