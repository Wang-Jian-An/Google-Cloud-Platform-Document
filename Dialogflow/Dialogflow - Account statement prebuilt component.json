{"title": "Dialogflow - Account statement prebuilt component", "url": "https://cloud.google.com/dialogflow/cx/docs/concept/prebuilt-component/account-statement", "abstract": "# Dialogflow - Account statement prebuilt component\nThe account statement [prebuilt component](/dialogflow/cx/docs/concept/prebuilt-component) checks a customer's [authentication level](/dialogflow/cx/docs/concept/prebuilt-component/authentication#authentication-levels) , then sends the account statement for a specified period of time to an authenticated customer. If the customer has multiple accounts, the component confirms the specific account the customer would like to retrieve an account statement for. This component uses the [Authentication](/dialogflow/cx/docs/concept/prebuilt-component/authentication) prebuilt component to authenticate users and uses a customized version of [Date of birth collection](/dialogflow/cx/docs/concept/prebuilt-component/date-of-birth-collection) to collect start and end dates for the statement period.\n", "content": "## Limitations\nIn addition to the [common prebuilt component limitations](/dialogflow/cx/docs/concept/prebuilt-component#limits) , this prebuilt component has the following limitations:\n- This component does not encrypt any data.## Sample dialogs\nThe following sample dialogs demonstrate common scenarios handled by this prebuilt component. The sample dialogs demonstrate behavior when the component is called via telephony, which triggers the Default Welcome Intent and the first agent response at the start of the conversation.\n### Single account\nEnd-user has a single account. The agent collects the statement start and end dates, whether the user would like to encrypt the statement, and sends the account statement to the user.\n| User input | Agent response                                                                               |\n|:-------------|:-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|\n| nan   | Agent authenticates user using Authentication prebuilt component                                                                   |\n| nan   | Thank you, you have been successfully authenticated.                                                                      |\n| nan   | Please wait while we are fetching your account details. We have found an account number ending with 1001 associated with your number. Please provide the account statement start date, starting with the month, followed by day and then year. Please note that the account statement period will be provided only for the last 90 days. |\n| nan   | Agent collects statement start date using Date of birth prebuilt component                                                                |\n| nan   | Great, we have collected your statement start date. Please provide the account statement end date, starting with the month, followed by day and then year. Please note that the account statement period will be provided only for the last 90 days.                      |\n| nan   | Agent collects statement end date using Date of birth prebuilt component                                                                 |\n| nan   | Thank you. Please confirm if you are looking for the account statement between 2023-07-12 to 2023-07-24?                                                         |\n| Yes   | nan                                                                                  |\n| nan   | Please wait while we are fetching your statement details. We found transactions from 2023-07-12 to 2023-07-24. Would you like to receive it via email, SMS or WhatsApp?                                         |\n| SMS   | nan                                                                                  |\n| nan   | Do you want to encrypt the document before we share it with you?                                                                   |\n| No thanks | nan                                                                                  |\n| nan   | You will receive the statement within 15 minutes on your registered mobile.                                                                |\n### Multiple accounts\nEnd-user has multiple accounts; the agent confirms which account the user is requesting an account statement for. The agent collects the statement start and end dates, whether the user would like to encrypt the statement, and sends the account statement to the user.\n| User input | Agent response                                                          |\n|:-------------|:-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|\n| nan   | Agent authenticates user using Authentication prebuilt component                                              |\n| nan   | Thank you, you have been successfully authenticated.                                                 |\n| nan   | Please wait while we are fetching your account details. We have found that there are 2 accounts associated with your number. Can you please help us with the last 4 digits of the account you are referring to?          |\n| 2002   | nan                                                             |\n| nan   | The last four digits of the account number that we got are 2002, is that correct?                                         |\n| yes   | nan                                                             |\n| nan   | Please provide the account statement start date, starting with the month, followed by day and then year. Please note that the account statement period will be provided only for the last 90 days.             |\n| nan   | Agent collects statement start date using Date of birth prebuilt component                                           |\n| nan   | Great, we have collected your statement start date. Please provide the account statement end date, starting with the month, followed by day and then year. Please note that the account statement period will be provided only for the last 90 days. |\n| nan   | Agent collects statement end date using Date of birth prebuilt component                                            |\n| nan   | Thank you. Please confirm if you are looking for the account statement between 2023-07-18 to 2023-07-22?                                    |\n| Yes   | nan                                                             |\n| nan   | Please wait while we are fetching your statement details. We found transactions from 2023-07-18 to 2023-07-22. Would you like to receive it via email, SMS or WhatsApp?                    |\n| WhatsApp  | nan                                                             |\n| nan   | Do you want to encrypt the document before we share it with you?                                              |\n| Yes   | nan                                                             |\n| nan   | Password details will be shared on your registered WhatsApp. You will receive the statement within 15 minutes on your registered WhatsApp.                           |\n## Naming conventions\nThis prebuilt component uses the following naming conventions:\n| Feature     | Format            | Example                 |\n|:--------------------------|:------------------------------------------------------|:------------------------------------------------------------------------|\n| Flow      | [Component Name]          | Account Statement              |\n| Component Specific Intent | prebuilt_components_[component_name]_[intent_name] | prebuilt_components_account_number_collection_four_digit_account_number |\n| Entity Type    | prebuilt_components_[component_name]_[entity_type] | prebuilt_components_account_statement_channelall      |\n| Webhook     | prebuilt_components_[component_name]:[webhook_action] | prebuilt_components_account_statement:request_statement     |\n## Input parameters\nInput parameters are parameters that are used to configure certain behaviors of the component. The parameters will be used by one or more conditions within the flow to determine how the component should behave. Flow-scoped parameters must be set on the start page of the component as described below. Session-scoped parameters may be set either by a calling flow, or on the start page of this component.\nThis prebuilt component accepts the following input parameters:\n| Parameter Name         | Description                                                                          | Input Format |\n|:--------------------------------------------------|:-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:---------------|\n| $session.params.auth_level      | (optional) Indicates the authentication level of the caller.                                                              | integer  |\n| $session.params.auth_level_req     | Indicates the level of authentication needed before a user can access their account statement. This value is configured in the parameter presets of the page entry fulfillment in the check auth level page. By default this value is 1.                   | integer  |\n| $session.params.account_auth_enabled    | Indicates whether the user should be authenticated as an account holder as described in Authentication types. This value is configured in the parameter presets of the page entry fulfillment in the check auth level page. By default this value is true.               | boolean  |\n| $session.params.card_auth_enabled     | Indicates whether the user should be authenticated as a card holder as described in Authentication types. This value is configured in the parameter presets of the page entry fulfillment in the check auth level page. By default this value is false.               | boolean  |\n| $session.params.phone_number      | (optional) Customer's registered phone number used for authentication.                                                            | string   |\n| $session.params.account_count      | (optional) Number of accounts associated with the authenticated user.                                                            | integer  |\n| $session.params.last_four_digit_of_account_number | (optional) Last four digits of the customer account number for which the statement needs to be provided. If the customer has a single account, this information is retrieved automatically post authentication. If the customer has multiple accounts, the specific account number is collected from the customer. | string   |\n| $session.params.account_statement_max_days  | Specifies the maximum number of days before the current date allowed for a statement start date. By default, this value is -90, indicating that statement start dates may start no more than 90 days before the current date. This parameter is configured in the start page true route.       | integer  |\n| $flow.max_retry_count        | Specifies the number of retries allowed when prompting the end-user to provide a valid statement end date. The default value is 3.                                             | integer  |\n| $flow.max_retry_confirm_period_counter   | Specifies the number of retries allowed when confirming the statement period with the end-user. The default value is 3.                                               | integer  |\n| $flow.max_retry_statement_counter     | Specifies the number of retries allowed when the provided statement period does not retrieve any transactions. The default value is 3.                                            | integer  |\n## Output parameters\nOutput parameters are session parameters that will remain active after exiting the component. These parameters contain important information collected by the component. This prebuilt component provides values for the following output parameters:\n| Parameter Name     | Description                                                                                                                                                                           | Output Format |\n|:----------------------------------|:-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:----------------|\n| auth_level      | Indicates the authentication level of the caller.                                                                                                                                                                  | integer   |\n| phone_number      | User's local phone number, without the country code, used to identify the user.                                                                                                                                                          | string   |\n| account_count      | The number of accounts associated with the registered telephone number. These accounts include self-accounts and accounts for which the user has power of attorney.                                                                                                                                     | integer   |\n| last_four_digit_of_account_number | If a user has a single account, the last four digits of the account number are returned. If a user has more than one account, the value of this parameter is the last four digits of the account number the user selected to receive account statement information for.                                                                                                            | string   |\n| transfer_reason     | This parameter indicates the reason the flow exited, if it was not successful. The returned value is one of: agent: the end-user requested a human agent at some point during the conversation. denial_of_information: the end-user declined to share information requested by the component. max_no_input: the conversation reached the maximum number of retries for no-input events. See no-input built-in events. max_no_match: the conversation reached the maximum number of retries for no-match events. See no-match built-in events. webhook_error: a webhook error occurred. See webhook.error built-in event. webhook_not_found: a webhook URL was unreachable. See webhook.error.not-found built-in event. | string   |\n## Basic setup\nTo set up this prebuilt component:\n- [Import the prebuilt component](/dialogflow/cx/docs/concept/prebuilt-component#import) .\n- Configure the provided [flexible webhooks](/dialogflow/cx/docs/concept/webhook#flexible) with configuration describing your Dialogflow-external services, see Webhook setup below.## Webhook setup\nIn order to use this component, you will need to configure the included [flexible webhooks](/dialogflow/cx/docs/concept/webhook#flexible) to retrieve needed information from your external services.\n### Authentication\nIf you have not previously configured external services required for authentication, you will need to configure them to enable authentication of users for this component. See [Authentication webhook setup](/dialogflow/cx/docs/concept/prebuilt-component/authentication#webhook-setup) for detailed instructions.\n### Validate account\nThe `prebuilt_components_account_services:validate_account` webhook is used by the component to verify that an account exists based on the user's registered phone number and the last four digits of the account number provided. The webhook also returns the account balance, if an account exists.\nThe following parameters are provided by the component as inputs to the API request.\n| Parameter Name         | Description                            | Input Format |\n|:--------------------------------------------------|:-------------------------------------------------------------------------------------------------------------------------|:---------------|\n| $session.params.phone_number      | User's local phone number, without the country code, used to identify the user.           | string   |\n| $session.params.last_four_digit_of_account_number | The last four digits of the account number the user selected and confirmed to receive account statement information for. | string   |\nThe following parameters are pulled from the API response to be used by the component.\n| Parameter Name | Description                        | Output Format |\n|:-----------------|:----------------------------------------------------------------------------------------------------------|:----------------|\n| account_found | Indicates whether an account with the provided last four digits exists for the user's registered account. | boolean   |\n| balance   | The amount of the current balance on the account, if it exists.           | number   |### Get transactions\nThe `prebuilt_components_account_statement:get_transactions` webhook is used by the component to retrieve the transactions for an account given the user's registered phone number, the last four digits of the account number, and the statement period.\nThe following parameters are provided by the component as inputs to the API request.\n| Parameter Name         | Description                                             | Input Format |\n|:--------------------------------------------------|:---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:---------------|\n| $session.params.phone_number      | User's local phone number, without the country code, used to identify the user.                            | string   |\n| $session.params.last_four_digit_of_account_number | The last four digits of the account number the user selected and confirmed to receive account statement information for.                  | string   |\n| $flow.statement_start_date      | The requested statement start date in \"YYYY-MM-DD\" format.                                 | string   |\n| $flow.statement_end_date       | (optional) The requested statement start date in \"YYYY-MM-DD\" format. If no value is provided by the user or caller declines to provide an end date, the value defaults to the current date. | string   |\nThe following parameters are pulled from the API response to be used by the component.\n| Parameter Name  | Description                    | Output Format |\n|:-------------------|:------------------------------------------------------------------------------------------|:----------------|\n| transactions_count | The number of transactions found for the specified account in the given statement period. | integer   |### Request statement\nThe `prebuilt_components_account_statement:request_statement` webhook is used by the component to send a statement for an account to a selected channel given the user's registered phone number, the last four digits of the account number, and the statement period.\nThe following parameters are provided by the component as inputs to the API request.\n| Parameter Name         | Description                                                                             | Input Format |\n|:--------------------------------------------------|:-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:---------------|\n| $session.params.phone_number      | User's local phone number, without the country code, used to identify the user.                                                            | string   |\n| $session.params.last_four_digit_of_account_number | The last four digits of the account number the user selected and confirmed to receive account statement information for.                                                  | string   |\n| $flow.statement_start_date      | The requested statement start date in \"YYYY-MM-DD\" format.                                                                  | string   |\n| $flow.statement_end_date       | (optional) The requested statement start date in \"YYYY-MM-DD\" format. If no value is provided by the user or caller declines to provide an end date, the value defaults to the current date.                                 | string   |\n| $flow.channel_medium        | The channel the user has selected to receive the message on. Valid values are defined by the prebuilt_components_account_statement_channelphn and prebuilt_components_account_statement_channelall custom entities, depending on whether the user has a registered email. By default email, mobile and WhatsApp are supported. | string   |\n| $flow.encryption_status       | Indicates whether the user wants the document encrypted before sending to the specified channel. If no value is provided by the user or caller declines to provide an end date, the value defaults to true.                             | boolean  |### Complete\nYour agent and its webhooks should now be set up and ready to test.", "guide": "Dialogflow"}