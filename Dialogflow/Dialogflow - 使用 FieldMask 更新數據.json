{"title": "Dialogflow - \u4f7f\u7528 FieldMask \u66f4\u65b0\u6578\u64da", "url": "https://cloud.google.com/dialogflow/cx/docs/how/field-mask?hl=zh-cn", "abstract": "# Dialogflow - \u4f7f\u7528 FieldMask \u66f4\u65b0\u6578\u64da\n\u4f7f\u7528 API \u66f4\u65b0\u4ee3\u7406\u6578\u64da\u6642\uff0c\u60a8\u53ef\u4ee5\u9078\u64c7\u8986\u84cb\u6574\u500b\u6578\u64da\u985e\u578b\u6216\u50c5\u8986\u84cb\u6578\u64da\u985e\u578b\u7684\u7279\u5b9a\u5b57\u6bb5\u3002\u901a\u5e38\u60c5\u6cc1\u4e0b\uff0c\u6700\u597d\u8986\u84cb\u7279\u5b9a\u5b57\u6bb5\uff0c\u4ee5\u514d\u56e0\u610f\u5916\u8986\u84cb\u6240\u6709\u6578\u64da\u3002\u5982\u8981\u8986\u84cb\u7279\u5b9a\u5b57\u6bb5\uff0c\u8acb\u7232\u66f4\u65b0\u8acb\u6c42\u63d0\u4f9b [FieldMask](https://developers.google.com/protocol-buffers/docs/reference/google.protobuf?hl=zh-cn#fieldmask) \u3002\n\u4ee5\u4e0b\u793a\u4f8b\u5c55\u793a\u77ad\u5982\u4f55\u63d0\u4f9b `FieldMask` \u4ee5\u66f4\u65b0 `Intent` \u985e\u578b\u7684\u986f\u793a\u540d\u3002\n\u5728\u4f7f\u7528\u4efb\u4f55\u8acb\u6c42\u6578\u64da\u4e4b\u524d\uff0c\u8acb\u5148\u9032\u884c\u4ee5\u4e0b\u66ff\u63db\uff1a- \uff1a\u60a8\u7684 Google Cloud \u9805\u76ee ID\n- \uff1a\u60a8\u7684\u4ee3\u7406 ID\n- \uff1a\u60a8\u7684 [\u5340\u57df ID](https://cloud.google.com/dialogflow/cx/docs/concept/region?hl=zh-cn) \n- \uff1a\u60a8\u7684\u610f\u5716 ID\n- \uff1a\u6240\u9700\u7684\u986f\u793a\u540d\nHTTP \u65b9\u6cd5\u548c\u7db2\u5740\uff1a\n```\nPATCH https://REGION_ID-dialogflow.googleapis.com/v3/projects/PROJECT_ID/locations/REGION_ID/agents/AGENT_ID/intents/INTENT_ID?updateMask=displayName\n```\n\u8acb\u6c42 JSON \u6b63\u6587\uff1a\n```\n{\n \"displayName\": \"DISPLAY_NAME\"\n}\n```\n\u5982\u9700\u767c\u9001\u60a8\u7684\u8acb\u6c42\uff0c\u8acb\u5c55\u958b\u4ee5\u4e0b\u9078\u9805\u4e4b\u4e00\uff1a\u60a8\u61c9\u8a72\u6536\u5230\u985e\u4f3c\u4ee5\u4e0b\u5167\u5bb9\u7684 JSON \u97ff\u61c9\uff1a\n```\n{\n \"name\": \"projects/PROJECT_ID/locations/REGION_ID/agents/AGENT_ID/intents/INTENT_ID\",\n \"displayName\": \"DISPLAY_NAME\",\n ...\n}\n```\n\u8981\u5411 Dialogflow \u9032\u884c\u8eab\u4efd\u9a57\u8b49\uff0c\u8acb\u8a2d\u7f6e\u61c9\u7528\u9ed8\u8a8d\u6191\u64da\u3002  \u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [\u7232\u672c\u5730\u958b\u767c\u74b0\u5883\u8a2d\u7f6e\u8eab\u4efd\u9a57\u8b49](https://cloud.google.com/docs/authentication/provide-credentials-adc?hl=zh-cn#local-dev) \u3002\n [\u5728 GitHub \u4e0a\u67e5\u770b](https://github.com/GoogleCloudPlatform/java-docs-samples/blob/HEAD/dialogflow-cx/src/main/java/dialogflow/cx/UpdateIntent.java) \n```\nimport com.google.cloud.dialogflow.cx.v3.Intent;import com.google.cloud.dialogflow.cx.v3.Intent.Builder;import com.google.cloud.dialogflow.cx.v3.IntentsClient;import com.google.cloud.dialogflow.cx.v3.UpdateIntentRequest;import com.google.protobuf.FieldMask;import java.io.IOException;public class UpdateIntent {\u00a0 public static void main(String[] args) throws IOException {\u00a0 \u00a0 // TODO(developer): Replace these variables before running the sample.\u00a0 \u00a0 String projectId = \"my-project-id\";\u00a0 \u00a0 String agentId = \"my-agent-id\";\u00a0 \u00a0 String intentId = \"my-intent-id\";\u00a0 \u00a0 String location = \"my-location\";\u00a0 \u00a0 String displayName = \"my-display-name\";\u00a0 \u00a0 updateIntent(projectId, agentId, intentId, location, displayName);\u00a0 }\u00a0 // DialogFlow API Update Intent sample.\u00a0 public static void updateIntent(\u00a0 \u00a0 \u00a0 String projectId, String agentId, String intentId, String location, String displayName)\u00a0 \u00a0 \u00a0 throws IOException {\u00a0 \u00a0 // Note: close() needs to be called on the IntentsClient object to clean up resources\u00a0 \u00a0 // such as threads. In the example below, try-with-resources is used,\u00a0 \u00a0 // which automatically calls close().\u00a0 \u00a0 try (IntentsClient client = IntentsClient.create()) {\u00a0 \u00a0 \u00a0 String intentPath =\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"projects/\"\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 + projectId\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 + \"/locations/\"\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 + location\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 + \"/agents/\"\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 + agentId\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 + \"/intents/\"\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 + intentId;\u00a0 \u00a0 \u00a0 Builder intentBuilder = client.getIntent(intentPath).toBuilder();\u00a0 \u00a0 \u00a0 intentBuilder.setDisplayName(displayName);\u00a0 \u00a0 \u00a0 FieldMask fieldMask = FieldMask.newBuilder().addPaths(\"display_name\").build();\u00a0 \u00a0 \u00a0 Intent intent = intentBuilder.build();\u00a0 \u00a0 \u00a0 UpdateIntentRequest request =\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 UpdateIntentRequest.newBuilder()\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 .setIntent(intent)\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 .setLanguageCode(\"en\")\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 .setUpdateMask(fieldMask)\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 .build();\u00a0 \u00a0 \u00a0 // Make API request to update intent using fieldmask\u00a0 \u00a0 \u00a0 Intent response = client.updateIntent(request);\u00a0 \u00a0 \u00a0 System.out.println(response);\u00a0 \u00a0 }\u00a0 }}\n```\u8981\u5411 Dialogflow \u9032\u884c\u8eab\u4efd\u9a57\u8b49\uff0c\u8acb\u8a2d\u7f6e\u61c9\u7528\u9ed8\u8a8d\u6191\u64da\u3002  \u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [\u7232\u672c\u5730\u958b\u767c\u74b0\u5883\u8a2d\u7f6e\u8eab\u4efd\u9a57\u8b49](https://cloud.google.com/docs/authentication/provide-credentials-adc?hl=zh-cn#local-dev) \u3002\n [\u5728 GitHub \u4e0a\u67e5\u770b](https://github.com/GoogleCloudPlatform/nodejs-docs-samples/blob/HEAD/dialogflow-cx/update-intent.js) \n```\nconst {IntentsClient} = require('@google-cloud/dialogflow-cx');const intentClient = new IntentsClient();//TODO(developer): Uncomment these variables before running the sample.// \u00a0const projectId = 'your-project-id';// \u00a0const agentId = 'your-agent-id';// \u00a0const intentId = 'your-intent-id';// \u00a0const location = 'your-location';// \u00a0const displayName = 'your-display-name';async function updateIntent() {\u00a0 const agentPath = intentClient.projectPath(projectId);\u00a0 const intentPath = `${agentPath}/locations/${location}/agents/${agentId}/intents/${intentId}`;\u00a0 //Gets the intent from intentPath\u00a0 const intent = await intentClient.getIntent({name: intentPath});\u00a0 intent[0].displayName = displayName;\u00a0 //Specifies what is being updated\u00a0 const updateMask = {\u00a0 \u00a0 paths: ['display_name'],\u00a0 };\u00a0 const updateIntentRequest = {\u00a0 \u00a0 intent: intent[0],\u00a0 \u00a0 updateMask,\u00a0 \u00a0 languageCode: 'en',\u00a0 };\u00a0 //Send the request for update the intent.\u00a0 const result = await intentClient.updateIntent(updateIntentRequest);\u00a0 console.log(result);}updateIntent();\n```\u8981\u5411 Dialogflow \u9032\u884c\u8eab\u4efd\u9a57\u8b49\uff0c\u8acb\u8a2d\u7f6e\u61c9\u7528\u9ed8\u8a8d\u6191\u64da\u3002  \u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [\u7232\u672c\u5730\u958b\u767c\u74b0\u5883\u8a2d\u7f6e\u8eab\u4efd\u9a57\u8b49](https://cloud.google.com/docs/authentication/provide-credentials-adc?hl=zh-cn#local-dev) \u3002\n [\u5728 GitHub \u4e0a\u67e5\u770b](https://github.com/GoogleCloudPlatform/python-docs-samples/blob/HEAD/dialogflow-cx/update_intent.py) \n```\nfrom google.cloud.dialogflowcx_v3.services.intents import IntentsClientfrom google.protobuf import field_mask_pb2def update_intent(project_id, agent_id, intent_id, location, displayName):\u00a0 \u00a0 intents_client = IntentsClient()\u00a0 \u00a0 intent_name = intents_client.intent_path(project_id, location, agent_id, intent_id)\u00a0 \u00a0 intent = intents_client.get_intent(request={\"name\": intent_name})\u00a0 \u00a0 intent.display_name = displayName\u00a0 \u00a0 update_mask = field_mask_pb2.FieldMask(paths=[\"display_name\"])\u00a0 \u00a0 response = intents_client.update_intent(intent=intent, update_mask=update_mask)\u00a0 \u00a0 return response\n``", "content": "`", "guide": "Dialogflow"}