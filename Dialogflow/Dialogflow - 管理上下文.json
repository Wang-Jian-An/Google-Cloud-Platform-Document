{"title": "Dialogflow - \u7ba1\u7406\u4e0a\u4e0b\u6587", "url": "https://cloud.google.com/dialogflow/es/docs/contexts-manage?hl=zh-cn", "abstract": "# Dialogflow - \u7ba1\u7406\u4e0a\u4e0b\u6587\n\u5728\u5927\u591a\u6578\u60c5\u6cc1\u4e0b\uff0c\u60a8\u53ef\u5728\u8a2d\u8a08\u6642\uff08\u69cb\u5efa\u4ee3\u7406\u6642\uff09\u914d\u7f6e\u4e0a\u4e0b\u6587\u3002 \u4f8b\u5982\uff0c\u7576\u60a8\u6709\u201c\u6211\u60f3\u5c07\u62ab\u85a9\u6dfb\u52a0\u5230\u6211\u7684\u8cfc\u7269\u8eca\u4e2d\u201d\u4e4b\u985e\u7684\u57f9\u8a13\u77ed\u8a9e\u7684\u6642\u5019\u3002\n\u5728\u67d0\u4e9b\u9ad8\u7d1a\u5834\u666f\u4e2d\uff0c\u60a8\u53ef\u80fd\u9084\u9700\u8981\u7de8\u5beb\u4ee3\u78bc\uff0c\u4ee5\u4fbf\u5728\u904b\u884c\u6642\uff08\u5be6\u6642\u6703\u8a71\u671f\u9593\uff09\u7372\u53d6\u548c\u8a2d\u7f6e\u67d0\u4e9b\u4e0a\u4e0b\u6587\u3002 \u4f8b\u5982\uff0c\u60a8\u6aa2\u6e2c\u5230\u4e86\u8a2d\u5099\u4f4d\u7f6e\uff0c\u4e26\u5c07\u5176\u6dfb\u52a0\u5230\u4e86\u4e0a\u4e0b\u6587\u4e2d\uff0c\u4ee5\u4fbf\u7a0d\u5f8c\u5f15\u7528\u8a72\u4f4d\u7f6e\u3002\n\u672c\u6587\u6a94\u4ecb\u7d39\u5982\u4f55\u4f7f\u7528 [Dialogflow \u63a7\u5236\u6aaf](https://cloud.google.com/dialogflow/docs/console?hl=zh-cn) \u53ca [API](https://cloud.google.com/dialogflow/docs/api-overview?hl=zh-cn) \u6216 [fulfillment](https://cloud.google.com/dialogflow/docs/fulfillment-overview?hl=zh-cn) \uff0c\u5728\u8a2d\u8a08\u6642\u548c\u904b\u884c\u6642\u7372\u53d6\u548c\u8a2d\u7f6e\u4e0a\u4e0b\u6587\u3002\n", "content": "## \u4e0a\u4e0b\u6587\u547d\u540d\n\u4ee5\u4e0b\u898f\u5247\u9069\u7528\u65bc\u5c0d\u4e0a\u4e0b\u6587\u9032\u884c\u547d\u540d\uff1a\n| \u898f\u5247         | \u793a\u4f8b       |\n|:--------------------------------------|:--------------------------------|\n| \u4f7f\u7528\u5b57\u6bcd\u6578\u5b57\u540d\u7a31\u3002     | mycontext1      |\n| \u4f7f\u7528 - \u6216 _ \u4ee3\u66ff\u7a7a\u683c\u3002    | my-context-1     |\n| \u540d\u7a31\u4e0d\u5340\u5206\u5927\u5c0f\u5beb\u3002     | Abc123 \u548c abc123 \u8996\u7232\u7b49\u6548\u540d\u7a31\u3002 |\n| \u4f7f\u7528 API \u6642\uff0c\u6240\u6709\u4e0a\u4e0b\u6587\u540d\u7a31\u5747\u7232\u5c0f\u5beb\u3002 | abc123       |\n## \u8a2d\u8a08\u6642\u8a2d\u7f6e\u4e0a\u4e0b\u6587\n- \u8f49\u5230 [Dialogflow ES \u63a7\u5236\u6aaf](https://dialogflow.cloud.google.com?hl=zh-cn) \u3002\n- \u9078\u64c7\u4e00\u500b\u4ee3\u7406\u3002\n- \u5728\u5de6\u5074\u908a\u6b04\u83dc\u55ae\u4e2d\u9078\u64c7 **\u610f\u5716** (Intents)\u3002\n- \u5c55\u958b\u610f\u5716\u6578\u64da\u7684 **\u4e0a\u4e0b\u6587** \u90e8\u5206\u3002\n- \u9ede\u64ca\u610f\u5716\u6578\u64da\u4e2d\u7684 **\u6dfb\u52a0\u8f38\u51fa\u4e0a\u4e0b\u6587** (Add output context) \u6216 **\u6dfb\u52a0\u8f38\u5165\u4e0a\u4e0b\u6587** (Add input context) \u5b57\u6bb5\u3002\n- \u8f38\u5165\u4e0a\u4e0b\u6587\u7684\u540d\u7a31\uff0c\u7136\u5f8c\u6309 **Return** \u3002\n- \u5c0d\u65bc\u8f38\u51fa\u4e0a\u4e0b\u6587\uff0c\u53ef\u4ee5\u9078\u64c7\u9ede\u64ca\u6709\u6548\u671f\u5713\u5708\u66f4\u6539\u6709\u6548\u671f\u3002\n- \u6839\u64da\u9700\u8981\u6dfb\u52a0\u66f4\u591a\u4e0a\u4e0b\u6587\u3002\n- \u9ede\u64ca **\u4fdd\u5b58** \u3002\n\u8acb\u53c3\u95b1 [\u610f\u5716\u53c3\u8003](https://cloud.google.com/dialogflow/docs/reference/common-types?hl=zh-cn#intents) \u3002\n## \u904b\u884c\u6642\u8a2d\u7f6e\u4e0a\u4e0b\u6587\n\u7576\u60a8\u7684\u7db2\u7d61\u9264\u5b50\u670d\u52d9\u767c\u9001 [WebhookResponse](https://cloud.google.com/dialogflow/docs/reference/common-types?hl=zh-cn#webhookresponse) \u5f8c\uff0c\u8acb\u5c07 `outputContexts` \u5b57\u6bb5\u8a2d\u7f6e\u7232\u6240\u9700\u7684\u6d3b\u8e8d\u4e0a\u4e0b\u6587\u3002\n [Sessions](https://cloud.google.com/dialogflow/docs/reference/common-types?hl=zh-cn#sessions) \u985e\u578b `detectIntent` \u8abf\u7528\u7684\u8acb\u6c42\u5305\u542b `queryParameters.contexts` \u5b57\u6bb5\uff0c\u7528\u65bc\u8a2d\u7f6e\u6d3b\u8e8d\u4e0a\u4e0b\u6587\u3002\n\u4ee5\u4e0b\u662f `detectIntent` \u8acb\u6c42\u7684 REST JSON \u793a\u4f8b\uff1a\n`POST https://dialogflow.googleapis.com/v2/{session=projects/*/agent/sessions/*}:detectIntent`\n```\n{\n \"queryInput\": {\n \"text\": {\n  \"languageCode\": \"en-US\",\n  \"text\": \"I would like to add pizza to my shopping cart.\"\n }\n },\n \"queryParams\": {\n \"contexts\": [{\n  \"name\": \"projects/project-id/agent/sessions/session-id/contexts/product-chosen\",\n  \"lifespanCount\": 5,\n  \"parameters\": {\n   \"product\": \"Pizza\",\n   \"device-location\" \"@52.3377871,4.8698096,17z\"\n  }\n  }]\n }\n}\n```\n\u60a8\u4e5f\u53ef\u4ee5\u96a8\u6642\u5c0d [Contexts](https://cloud.google.com/dialogflow/docs/reference/common-types?hl=zh-cn#contexts) \u985e\u578b\u8abf\u7528 create\u3001delete \u548c update \u65b9\u6cd5\u3002\n## \u904b\u884c\u6642\u7372\u53d6\u4e0a\u4e0b\u6587\n\u7db2\u7d61\u9264\u5b50\u670d\u52d9\u6536\u5230 [WebhookRequest](https://cloud.google.com/dialogflow/docs/reference/common-types?hl=zh-cn#webhookrequest) \u5f8c\uff0c `queryResult.outputContexts` \u5b57\u6bb5\u5c07\u5305\u542b\u76f8\u61c9\u6d3b\u8e8d\u4e0a\u4e0b\u6587\u3002\n\u5c0d [Sessions](https://cloud.google.com/dialogflow/docs/reference/common-types?hl=zh-cn#sessions) \u985e\u578b `detectIntent` \u8abf\u7528\u7684\u97ff\u61c9\u5305\u542b `queryResult.outputContexts` \u5b57\u6bb5\uff0c\u63d0\u4f9b\u76f8\u61c9\u6d3b\u8e8d\u4e0a\u4e0b\u6587\u7684\u5217\u8868\u3002\n\u4ee5\u4e0b\u662f `detectIntent` \u97ff\u61c9\u7684 REST JSON \u793a\u4f8b\uff1a\n```\n{\n \"responseId\": \"response-id\",\n \"queryResult\": {\n \"queryText\": \"I would like to add pizza to my shopping cart.\",\n \"parameters\": {\n  \"product\": \"pizza\"\n },\n \"allRequiredParamsPresent\": true,\n \"fulfillmentText\": \"The product has been added.\",\n \"fulfillmentMessages\": [  {\n  \"text\": {\n   \"text\": [   \"The product has been added.\"\n   ]\n  }\n  }\n ],\n \"outputContexts\": [  {\n  \"name\": \"projects/project-id/agent/sessions/session-id/contexts/product-chosen\",\n  \"lifespanCount\": 5,\n  \"parameters\": {\n   \"product\": \"Pizza\",\n   \"device-location\" \"@52.3377871,4.8698096,17z\"\n  }\n  }\n ],\n \"intent\": {\n  \"name\": \"projects/project-id/agent/intents/intent-id\",\n  \"displayName\": \"buy-product\"\n },\n \"intentDetectionConfidence\": 0.8057143,\n \"languageCode\": \"en\",\n }\n}\n```\n\u60a8\u4e5f\u53ef\u4ee5\u96a8\u6642\u5c0d [Contexts](https://cloud.google.com/dialogflow/docs/reference/common-types?hl=zh-cn#contexts) \u985e\u578b\u8abf\u7528 get \u548c list \u65b9\u6cd5\u3002", "guide": "Dialogflow"}