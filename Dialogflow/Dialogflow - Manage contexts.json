{"title": "Dialogflow - Manage contexts", "url": "https://cloud.google.com/dialogflow/es/docs/contexts-manage", "abstract": "# Dialogflow - Manage contexts\nIn most cases, you configure contexts at design-time (when you are building an agent). For example, when you have a training phrase like: \"I would like to add pizza to my shopping cart.\"\nIn some advanced scenarios, you may also want to write code that gets and sets some contexts at runtime (during a live conversation). An example could be, you detected a device location and you have added it to the context, so you can refer to the location at a later moment.\nThis document describes how to get and set contexts at design-time and runtime by using the [Dialogflow Console](/dialogflow/docs/console) , [the API](/dialogflow/docs/api-overview) , or [fulfillment](/dialogflow/docs/fulfillment-overview) .\n", "content": "## Context naming\nThe following rules apply to naming contexts:\n| Rule            | Examples          |\n|:----------------------------------------------------|:---------------------------------------------|\n| Use alphanumeric names.        | mycontext1         |\n| Use - or _ instead of spaces.      | my-context-1         |\n| Names are not case sensitive.      | Abc123 and abc123 are considered equivalent. |\n| All context names are lowercase when using the API. | abc123          |\n## Set contexts at design-time\n- Go to the [Dialogflow ES Console](https://dialogflow.cloud.google.com) .\n- Select an agent.\n- Select **Intents** in the left sidebar menu.\n- Expand the **Contexts** section of the intent data.\n- Click the **Add output context** or **Add input context** field in intent data.\n- Enter a name for the context and press **Return** .\n- For output contexts, optionally click the lifespan circle and change the lifespan.\n- Add more contexts as needed.\n- Click **Save** .\nSee the [Intents reference](/dialogflow/docs/reference/common-types#intents) .\n## Set contexts at runtime\nWhen your webhook service sends a [WebhookResponse](/dialogflow/docs/reference/common-types#webhookresponse) , set the `outputContexts` field to desired active contexts.\nThe request for a [Sessions](/dialogflow/docs/reference/common-types#sessions) type `detectIntent` call contains a `queryParameters.contexts` field, which is used to set active contexts.\nThe following is a REST JSON example of a `detectIntent` request:\n`POST https://dialogflow.googleapis.com/v2/{session=projects/*/agent/sessions/*}:detectIntent`\n```\n{\n \"queryInput\": {\n \"text\": {\n  \"languageCode\": \"en-US\",\n  \"text\": \"I would like to add pizza to my shopping cart.\"\n }\n },\n \"queryParams\": {\n \"contexts\": [{\n  \"name\": \"projects/project-id/agent/sessions/session-id/contexts/product-chosen\",\n  \"lifespanCount\": 5,\n  \"parameters\": {\n   \"product\": \"Pizza\",\n   \"device-location\" \"@52.3377871,4.8698096,17z\"\n  }\n  }]\n }\n}\n```\nAt any time, you can also call the create, delete, and update methods on the [Contexts](/dialogflow/docs/reference/common-types#contexts) type.\n## Get contexts at runtime\nWhen your webhook service receives a [WebhookRequest](/dialogflow/docs/reference/common-types#webhookrequest) , the `queryResult.outputContexts` field contains the active contexts.\nThe response to a [Sessions](/dialogflow/docs/reference/common-types#sessions) type `detectIntent` call contains a `queryResult.outputContexts` field, which provides the list of active contexts.\nThe following is a REST JSON example of a `detectIntent` response:\n```\n{\n \"responseId\": \"response-id\",\n \"queryResult\": {\n \"queryText\": \"I would like to add pizza to my shopping cart.\",\n \"parameters\": {\n  \"product\": \"pizza\"\n },\n \"allRequiredParamsPresent\": true,\n \"fulfillmentText\": \"The product has been added.\",\n \"fulfillmentMessages\": [  {\n  \"text\": {\n   \"text\": [   \"The product has been added.\"\n   ]\n  }\n  }\n ],\n \"outputContexts\": [  {\n  \"name\": \"projects/project-id/agent/sessions/session-id/contexts/product-chosen\",\n  \"lifespanCount\": 5,\n  \"parameters\": {\n   \"product\": \"Pizza\",\n   \"device-location\" \"@52.3377871,4.8698096,17z\"\n  }\n  }\n ],\n \"intent\": {\n  \"name\": \"projects/project-id/agent/intents/intent-id\",\n  \"displayName\": \"buy-product\"\n },\n \"intentDetectionConfidence\": 0.8057143,\n \"languageCode\": \"en\",\n }\n}\n```\nAt any time, you can also call the get and list methods on the [Contexts](/dialogflow/docs/reference/common-types#contexts) type.", "guide": "Dialogflow"}