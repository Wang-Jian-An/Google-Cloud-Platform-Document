{"title": "Dialogflow - Input and output contexts", "url": "https://cloud.google.com/dialogflow/es/docs/contexts-input-output", "abstract": "# Dialogflow - Input and output contexts\nInput and output contexts are applied to [intents](/dialogflow/docs/intents-overview) . They work together to control conversation flow:\n- [Output contexts](#output_contexts) controlcontexts. When an intent is matched, any configured output contexts for that intent become active.\n- [Input contexts](#input_contexts) control intent matching. While contexts are active, Dialogflow is more likely to match intents that are configured with input contexts that are a subset of currently active contexts.\nWith contexts, you can:\n- Control the order of intent matching.\n- Create context-specific intents with the same training phrases.\nFor example, consider the following intents:\n| Intent name  | Training phrases   | Parameters | Input contexts | Output contexts | Response        |\n|:----------------|:--------------------------|:-------------|:-----------------|:------------------|:---------------------------------------|\n| pet-init  | \"What do they look like?\" | -   | -    | -     | \"What kind of pet do you like?\"  |\n| pet-select-dogs | \"I like dogs\"    | -   | -    | dogs    | \"What do you want to know about dogs?\" |\n| pet-select-cats | \"I like cats\"    | -   | -    | cats    | \"What do you want to know about cats?\" |\n| dog-show  | \"What do they look like?\" | -   | dogs    | -     | \"Here is a picture of a dog.\"   |\n| cat-show  | \"What do they look like?\" | -   | cats    | -     | \"Here is a picture of a cat.\"   |\nWhen the end-user says `I like dogs` :\n- The`pet-select-dogs`intent is matched.\n- The output context is`dogs`, so it becomes the active context.\nWhen the end-user says `I like cats` :\n- The`pet-select-cats`intent is matched.\n- The output context is`cats`, so it becomes the active context.\nWhen the end-user says `What do they look like?` :\n- If`dogs`is the active context:- The`dog-show`intent is matched.\n- The end-user is shown a dog picture.\n- If`cats`is the active context:- The`cat-show`intent is matched.\n- The end-user is shown a cat picture.\n- If there is no active context:- The`pet-init`intent is matched.\n- The end-user is asked what kind of pet they like.\n", "content": "## Output contexts\nMultiple output contexts can be applied to an intent. When an intent is matched, any output contexts applied to the intent become active.\n### Parameter references for active contexts\nWhen an intent with output context is matched, its collected parameter values can serve as temporary storage with [parameter references for active contexts](/dialogflow/docs/intents-actions-parameters#context) . These values can be accessed during future intent matching, for as long as the context remains active.\nFor example, consider the following variation of the pet example above:\n| Intent name | Training phrases    | Parameters | Input contexts | Output contexts | Response         |\n|:--------------|:-----------------------------|:-------------|:-----------------|:------------------|:------------------------------------------|\n| pet-init  | \"What do they look like?\" | -   | -    | -     | \"What kind of pet do you like?\"   |\n| pet-select | \"I like dogs\", \"I like cats\" | pet   | -    | pet-chosen  | \"What do you want to know about $pet?\" |\n| pet-show  | \"What do they look like?\" | -   | pet-chosen  | -     | \"Here is a picture of a #pet-chosen.pet.\" |\nWhen the end-user says `I like dogs` or `I like cats` :\n- The`pet-select`intent is matched.\n- The`pet` [parameter](/dialogflow/docs/intents-actions-parameters) is set to the chosen pet type.\n- The output context is`pet-chosen`, so it becomes the active context.\nWhen the end-user says `What do they look like?` :\n- If`pet-chosen`is the active context:- The`pet-show`intent is matched.\n- If the end-user selected`dogs`in the prior conversational turn, the end-user is shown a dog picture.\n- If the end-user selected`cats`in the prior conversational turn, the end-user is shown a cat picture.\n- If there is no active context:- The`pet-init`intent is matched.\n- The end-user is asked to select a pet type.\n### Lifespan\nEach active context has a lifespan that defines the number of conversational turns for which the context remains active. The default lifespan is five conversational turns for normal intents and two conversational turns for [follow-up intents](/dialogflow/docs/contexts-follow-up-intents) . You can override the default lifespan for any contexts. In addition, all contexts expire after 20 minutes of becoming active. When an intent is matched with an output context that is already active, the lifespan and expiration timer are reset.\nFor example, consider the following intent descriptions for a pet information agent:\n| Intent name | Training phrases               | Parameters | Input contexts | Output contexts   | Response                 |\n|:--------------|:---------------------------------------------------------------------------|:-------------|:-----------------|:--------------------------|:-------------------------------------------------------------------------|\n| pet-init  | \"What do they look like?\", \"What do they sound like?\", \"How big are they?\" | -   | -    | -       | \"What kind of pet do you like?\"           |\n| pet-select | \"I like dogs\", \"I like cats\"            | pet   | -    | pet-chosen (lifespan = 2) | \"What do you want to know about $pet?\"         |\n| pet-show  | \"What do they look like?\"             | -   | pet-chosen  | -       | \"Here is a picture of a #pet-chosen.pet. What else do you want to know?\" |\n| pet-audio  | \"What do they sound like?\"             | -   | pet-chosen  | -       | \"Here is a #pet-chosen.pet sound. What else do you want to know?\"  |\n| pet-size  | \"How big are they?\"              | -   | pet-chosen  | -       | \"Here is a #pet-chosen.pet size chart. What else do you want to know?\" |\nThe following table shows an example dialogue for this pet information agent, which illustrates the lifespan of the `pet-chosen` context:\n| Turn | Dialog                       | Explanation                            |\n|-------:|:------------------------------------------------------------------------------------------------|:---------------------------------------------------------------------------------------------------------------------------|\n|  1 | Agent: What kind of pet do you like?               | The pet-init intent is matched.                       |\n|  2 | User: I like cats. Agent: What do you want to know about cats?         | The pet-select intent is matched. The pet-chosen output context becomes the active context.        |\n|  3 | User: What do they look like? Agent: Here is a picture of a cat. What else do you want to know? | The pet-show intent has a pet-chosen input context, so it is matched. The pet-chosen context has been active for 1 turn. |\n|  4 | User: What do they sound like? Agent: Here is a cat sound. What else do you want to know?  | The pet-audio intent has a pet-chosen input context, so it is matched. The pet-chosen context has been active for 2 turns. |\n|  5 | User: How big are they? Agent: What kind of pet do you like?         | The pet-init intent is matched again, because the pet-chosen context is no longer active.         |\n## Input contexts\nWhile contexts are active, Dialogflow is more likely to match intents that are configured with input contexts that correspond to the currently active contexts. The detailed intent matching rules are as follows:\n- An intent's input context list must be a subset of the currently active context list in order to be matched. This also applies to intents with no input contexts.\n- For intents that satisfy rule #1, those with an input context list that most closely match the currently active context list are more likely to be matched.\nFor example:\n- Intents with no input contexts can be matched at any time.\n- When no contexts are active, only intents with no input contexts can be matched.\n- If contexts \"A\" and \"B\" are active, an intent with \"A\" and \"C\" input contexts cannot be matched.\n- If contexts \"A\", \"B\", and \"C\" are active, an intent with \"A\" and \"B\" input contexts can be matched.\n- If contexts \"A\" and \"B\" are active, an intent with \"A\" and \"B\" input contexts is more likely to be matched than an intent with no input context or an intent with just \"A\" for an input context.", "guide": "Dialogflow"}