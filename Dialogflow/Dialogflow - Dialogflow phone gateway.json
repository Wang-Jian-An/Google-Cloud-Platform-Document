{"title": "Dialogflow - Dialogflow phone gateway", "url": "https://cloud.google.com/dialogflow/es/docs/integrations/phone-gateway", "abstract": "# Dialogflow - Dialogflow phone gateway\n**    Beta     ** This product or feature is subject to the \"Pre-GA Offerings Terms\" in the General Service Terms section   of the [Service Specific Terms](/terms/service-terms#1) .     Pre-GA products and features are available \"as is\" and might have limited support.    For more information, see the [launch stage descriptions](/products#product-launch-stages) .\nThe Dialogflow phone gateway feature provides a telephone interface to your agent. It is used to build conversational IVR (interactive voice response) solutions that integrate with the rest of your call center network. Currently, you can select a telephone number hosted by Google.\nFor phone gateway pricing and quota information, see the [Pricing](/dialogflow/pricing) and [Quotas and Limits](/dialogflow/quotas) pages.\n", "content": "## Limitations\n### Language support\nThis integration only supports use of one language per agent.\nIf [enhanced speech models](/dialogflow/docs/data-logging) is enabled for the agent, this integration only supports the following languages:\n- English (en)\n- English - US (en-US)\nIf enhanced speech models is disabled for the agent, see the **Phone** column on the [Language reference](/dialogflow/docs/reference/language) page for the list of supported languages.\n### Phone number support\nOnly US phone numbers are supported, both for incoming calls and for call transfers.\n## Before you begin\nYou should do the following before reading this guide:\n- Read [Dialogflow basics](/dialogflow/docs/basics) .\n- Perform [setup steps](/dialogflow/docs/quick/setup) .## Create an agent\nIf you have not already created an agent, create one now:- Go to the [Dialogflow ES Console](https://dialogflow.cloud.google.com) .\n- If requested, sign in to the Dialogflow Console.  See [Dialogflow console overview](/dialogflow/docs/console) for more information.\n- Click **Create Agent** in the left sidebar menu.  (If you already have other agents, click the agent name,  scroll to the bottom and click **Create new agent** .)\n- Enter your agent's name, default language, and default time zone.\n- If you have already created a project, enter that project.  If you want to allow the Dialogflow Console to create the project,  select **Create a new Google project** .\n- Click the **Create** button.## Import the example file to your agent\nThe steps in this guide make assumptions about your agent, so you need to [import](/dialogflow/docs/agents-settings#export) an agent prepared for this guide. When importing, these steps use the option, which overwrites all agent settings, intents, and entities.\nTo import the file, follow these steps:\n- Download the [telephony-bot.zip](/static/dialogflow/es/docs/data/telephony-bot.zip) file.\n- Go to the [Dialogflow ES Console](https://dialogflow.cloud.google.com) .\n- Select your agent.\n- Click the  settingsbutton  next to the agent name.\n- Select the **Export and Import** tab.\n- Select **Restore From Zip** and follow instructions to restore the zip file that you downloaded.## Enable beta features\nEnsure that beta features are enabled:\n- Go to the [Dialogflow ES Console](https://dialogflow.cloud.google.com) .\n- Select an agent.\n- Click the settingsbutton next to the agent's name.\n- Scroll down while on the **General** tab and ensure that **Beta Features** is enabled.\n- If you have made changes, click **Save** .## Set up a phone gateway\nTo set up your gateway, follow these steps:\n- Select a provider:- Go to the [Dialogflow ES Console](https://dialogflow.cloud.google.com) .\n- Select your agent.\n- Click **Integrations** .\n- Click **Dialogflow Phone Gateway** .\n- Configure Phone Gateway:- Select the language.\n- Select the country code for the telephone number.\n- Optional. Select preferred area codes.\n- Click **Next** .\n- Select a number:- Choose a telephone number from the list.\n- Click **Create** .\n- Completion:- The gateway is now active.\n- Optionally change the [environment](/dialogflow/docs/agents-versions) .\n- Save the displayed telephone number and close the dialog window. You can click the **Dialogflow Phone Gateway** integrations button again to retrieve this information.\n## Call the telephone number\nYou can now call the number and follow the simple voice prompts. The interactions are defined in your agent.\n**Note:** There are [quotas and limits](/dialogflow/quotas) for this feature. If you receive a busy signal or the call drops, you may have exceeded your quota.\n**Note:** If you decide to delete your agent but keep using your GCP project, disable the Phone Gateway integration before the agent deletion.\n## Examine the intents\nNow that you have a working phone gateway agent, let's look at the intents you imported. This will help you understand how to build your own phone gateway agents.\n### Welcome the caller\nWhen you called the number, the agent greeted you and provided a list of options. Follow these steps to see how this was configured:\n- Go to the [Dialogflow ES Console](https://dialogflow.cloud.google.com) .\n- Select your agent.\n- Click **Intents** .\n- Click **Default Welcome Intent** .\n- Scroll down to the **Events** section. Notice that both **Welcome (WELCOME)** and **Telephony Welcome (TELEPHONY_WELCOME)** [events](/dialogflow/docs/events-overview) are present, which means that all types of welcome events will trigger this intent. As an alternative, you could create separate intents, each dedicated to a specific welcome event.\n- Scroll down to the **Responses** section and click the **DIALOGFLOW PHONE GATEWAY** tab.\n- Notice that the **Synthesize speech** response contains the welcome message you heard when calling the number.\n### Response to test command\nAfter you responded with \"test\", the agent presented a new list of options. Follow these steps to see how this was configured:\n- Click **Intents** .\n- Click **Test Telephony Intent** .\n- Scroll down to the **Responses** section and click the **DIALOGFLOW PHONE GATEWAY** tab.\n- Note that the **Synthesize speech** response contains the response you heard after you said \"test\".\n### Setting context\nAfter saying \"test\", there are two possible commands you can make: \"transfer\" or \"terminate\". This is not a limitation of phone gateway agents; it is just how this intent is defined. The intents associated with these commands are provided with [context](/dialogflow/docs/contexts-overview) . Follow these steps to see how this was configured:\n- Scroll to the **Context** section at the top.\n- Notice the **TestTelephonyIntent-followup** output context.\n- Click **Intents** .\n- Click the expansion button next to **Test Telephony Intent** .\n- Click **Test Telephony Intent - Terminate** \n- Scroll to the **Context** section at the top.\n- Notice the **TestTelephonyIntent-followup** input context.\n### Terminate the call\nWhen you responded with \"terminate\", the agent said \"goodbye\" and terminated the call. Follow these steps to see how this was configured:\n- Scroll down to the **Training phrases** section and note the phrases used to terminate the call.\n- Scroll down to the **Responses** section and click the **DIALOGFLOW PHONE GATEWAY** tab.\n- Notice that the **Synthesize speech** response contains \"goodbye\".\n- Notice that **Set this intent as end of conversation** is enabled. If this is enabled, Dialogflow terminates the phone call after playing all other audio prompts.\n**Note:** If you are using [fulfillment](/dialogflow/docs/fulfillment-overview) , you can terminate a call by setting the `end_interaction` field of the [WebhookResponse](/dialogflow/docs/reference/rpc/google.cloud.dialogflow.v2beta1#webhookresponse) message.\n## Phone gateway rich response messages\nThe intents for this example use [rich response messages](/dialogflow/docs/intents-rich-messages) for phone gateway responses. These are the types that you can use:\n- [Play audio](/dialogflow/docs/intents-rich-messages#audio) : Plays the supplied audio file. Specify the URI to a Cloud Storage object containing the audio to play. For example, 'gs://bucket/object'. The object must contain a single channel (mono) of linear PCM audio (2 bytes / sample) at 8kHz.\n- [Synthesize speech](/dialogflow/docs/intents-rich-messages#tts) : Synthesizes the supplied text to audio and plays it. Alternatively, you can enable **Use response from the DEFAULT tab as the first response** , which will use the default response to synthesize a speech response. If you only define default responses, and you do not enable **Use response from the DEFAULT tab as the first response** , only the text populated in`QueryResult.fulfillment_text`(populated with a randomly selected text response), is synthesized to audio.\n- [Transfer call](/dialogflow/docs/intents-rich-messages#transfer) : Transfers the caller to another number. The time duration spent on the transferred call is included in the total call duration, and Dialogflow [charges](/dialogflow/pricing) are applied until the call is ended.\n**Note:** When you add a rich message, you can hover over the **?** button to get more information about the message and its inputs.\n## Agent settings\nYou can control various aspects of speech synthesis. See [the agent speech settings](/dialogflow/docs/agents-settings#speech) .\n## Use the Dialogflow simulator\nWhen testing or experimenting with a phone gateway agent, you don't need to make a phone call. You can interact with the agent and receive audio responses via the [Dialogflow simulator](/dialogflow/docs/console#simulator) :\n- Type \"hello\" and press the return key\n- Change **Default Response** to **DIALOGFLOW PHONE GATEWAY** \n- Click the **Play Audio** button to hear the agent response\n- Continue the conversation with the agent## Toll-free numbers\nYou can request a phone number with an 833 area code. Note that toll-free numbers are [priced higher](/dialogflow/pricing) .\n## Events\nThe following [events](/dialogflow/docs/events-overview) are invoked by this integration:\n| Event    | Description                   |\n|:------------------|:-------------------------------------------------------------------------------------|\n| TELEPHONY_WELCOME | Triggered when someone calls the phone number associated with your Dialogflow agent. |\n## Agent warmup\nWhen an end-user calls a Dialogflow Phone Gateway agent, Dialogflow starts by loading the agent for a quick response to the initial end-user utterance. While the agent is loading, the phone keeps ringing. Dialogflow accomplishes this by sending a detect intent request to your agent. The text of this request is `TELEPHONY_WARMUP` .\n## Retrieve caller phone number\nYou can retrieve the `caller_id` value from the `OriginalDetectIntentRequest.payload` field in the [webhook request](/dialogflow/es/docs/fulfillment-webhook#webhook_request) if you use the Dialogflow Essentials [edition](/dialogflow/docs/editions#cmp) . In the Dialogflow Trial edition, the `caller_id` value is redacted.", "guide": "Dialogflow"}