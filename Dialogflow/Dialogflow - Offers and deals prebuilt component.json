{"title": "Dialogflow - Offers and deals prebuilt component", "url": "https://cloud.google.com/dialogflow/cx/docs/concept/prebuilt-component/offers-and-deals", "abstract": "# Dialogflow - Offers and deals prebuilt component\nThe offers and deals [prebuilt component](/dialogflow/cx/docs/concept/prebuilt-component) checks whether the caller is a registered user. If the user has a registered account, the component can provide information about user-specific offers and deals. The user can also get details on general offers and deals or report issues with a specific coupon code. This component uses the [Alphanumeric collection](/dialogflow/cx/docs/concept/prebuilt-component/alphanumeric-collection) prebuilt component to collect coupon codes. The component also uses [Generators](/dialogflow/cx/docs/concept/generative/generators) for post-call summarization, FAQs, and offer details.\n", "content": "## Limitations\nIn addition to the [common prebuilt component limitations](/dialogflow/cx/docs/concept/prebuilt-component#limits) , this prebuilt component has the following limitations:\n- This component does not encrypt any data.## Sample dialogs\nThe following sample dialogs demonstrate common scenarios handled by this prebuilt component. The sample dialogs demonstrate behavior when the component is called using telephony, which triggers the Default Welcome Intent and the first agent response at the start of the conversation.\n### User-specific and general offers and deals\nEnd-user has been previously authenticated. The user asks for their latest offers and the agent presents a list of offers specific to the user. The user asks some questions about the offers, then asks for offers in a specific category. The agent presents the list of offers in the category. The agent offers to send the offer details to the user and the user declines.\n| User input           | Agent response                                                                                  |\n|:---------------------------------------------------|:-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|\n| nan            | Welcome! Would you like to explore our latest offers or are you experiencing any issues with a specific coupon code?                                                         |\n| I want to see the latest offers     | nan                                                                                     |\n| nan            | To confirm, you are looking for offers. Is that correct?                                                                        |\n| yes            | nan                                                                                     |\n| nan            | We found the following offers for you, here are the details: Offer 1: Get 5% off on apparels, use code APPARELS5, valid until 2024-03-28. Offer 2: Get 15% off on grocery, use code GROCERY500, valid until 2024-03-28.8. Hope you find these offers interesting. Do you have any queries about offers or deals that we can answer for you?   |\n| Is there a purchase minimum for the grocery offer? | nan                                                                                     |\n| nan            | Yes, there is a minimum purchase value of 10 to avail the 15% off on grocery. Use code GROCERY500 to redeem this offer, valid until 2024-03-28. We hope to be able to provide you with the details you require. Do you have any queries about offers or deals that we can answer for you?               |\n| Do you have any offers for electronics?   | nan                                                                                     |\n| nan            | Certainly! Here are the offer details: Offer 1: Enjoy 5% off on electronics, use code ELECTRIC5, valid until 2024-03-28. Offer 2: Get 15% off on electronics, use code ELECTRIC15, valid until 2024-03-28. We hope to be able to provide you with the details you require. Do you have any queries about offers or deals that we can answer for you? |\n| No I'm done          | nan                                                                                     |\n| nan            | Do you want offer details to be shared on your registered mobile or email?                                                                   |\n| No thanks           | nan                                                                                     |\n| nan            | Thank you for calling.                                                                                |\n### Issue with a coupon code\nEnd-user has been previously authenticated. The user mentions that they have an issue with a coupon code. The agent collects the coupon code and provides the user with details about the coupon code redemption. The user confirms that they are having an issue with the coupon code and the agent submits a ticket to report the issue.\n| User input       | Agent response                                                      |\n|:-------------------------------------|:-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|\n| nan         | Welcome! Would you like to explore our latest offers or are you experiencing any issues with a specific coupon code?                            |\n| I'm having issues with a coupon code | nan                                                        |\n| nan         | To confirm, you are looking for coupon codes. Is that correct?                                          |\n| yes         | nan                                                        |\n| nan         | We're sorry to hear that. Could you please share the coupon code you're using?                                      |\n| nan         | Agent collects the coupon code using Alphanumeric collection prebuilt component                                     |\n| nan         | The offer code APPARELS5 associated with apparels needed minimum purchase value of 100$ and valid till 2024-03-28, please ensure the conditions such as minimum purchase requirement are met. Is this information helpful for you? |\n| no         | nan                                                        |\n| nan         | Please specify the issue you are experiencing. You may say something like my coupon code isn't working, code is not working in my area.                       |\n| coupon code isn't working   | nan                                                        |\n| nan         | To confirm, the coupon code issue provided is coupon code isn't working. Is this correct?                                   |\n| yes         | nan                                                        |\n| nan         | We've raised a ticket to report your issue. Thank you for calling.                                         |\n## Naming conventions\nThis prebuilt component uses the following naming conventions:\n| Feature  | Format            | Example             |\n|:------------|:------------------------------------------------------|:--------------------------------------------------------|\n| Flow  | [Component Name]          | Offers and Deals          |\n| Entity Type | prebuilt_components_[component_name]_[entity_type] | prebuilt_components_offers_and_deals_category   |\n| Webhook  | prebuilt_components_[component_name]:[webhook_action] | prebuilt_components_offers_and_deals:get_offers_details |\n## Input parameters\nInput parameters are parameters that are used to configure certain behaviors of the component. The parameters will be used by one or more conditions within the flow to determine how the component should behave. Flow-scoped parameters must be set on the start page of the component. Session-scoped parameters may be set either by a calling flow, or on the start page of this component.\nThis prebuilt component accepts the following input parameters:\n| Parameter Name    | Description                    | Input Format |\n|:-----------------------------|:-------------------------------------------------------------------------------------------|:---------------|\n| $session.params.phone_number | (optional) User's local phone number, without the country code, used to identify the user. | string   |\nThis prebuilt component allows the following optional parameters to configure the behavior of the component, including retries.\n| Parameter Name       | Description                                          | Format |\n|:------------------------------------------|:--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:---------|\n| $flow.max_retry_concern_type    | Specifies the number of retries allowed when selecting whether the user would like to hear offers or report an issue with a coupon code. The default value is 2.    | integer |\n| $flow.max_retry_offers_category   | Specifies the number of retries allowed when providing a category to hear offers for. The default value is 2.                 | integer |\n| $flow.max_retry_another_coupon_code  | Specifies the number of retries allowed when providing the specific coupon code the user is having an issue with. The default value is 2.          | integer |\n| $flow.max_retry_coupon_code_issue_counter | Specifies the number of retries allowed when providing the issue the user is having with a coupon code. The default value is 2.             | integer |\n| $flow.max_retry_message_confirm_channel | Specifies the number of retries allowed when providing a channel to receive offer details on. The default value is 2.               | integer |\n| $flow.valid_coupon_code_status   | Specifies the value of the coupon_code_status field returned by the get_coupon_code_details webhook indicating that the coupon code is valid. The default value is \"valid\".  | string |\n| $flow.invalid_coupon_code_status   | Specifies the value of the coupon_code_status field returned by the get_coupon_code_details webhook indicating that the coupon code is invalid. The default value is \"invalid\". | string |\n| $flow.expired_coupon_code_status   | Specifies the value of the coupon_code_status field returned by the get_coupon_code_details webhook indicating that the coupon code is expired. The default value is \"expired\". | string |\n## Output parameters\nOutput parameters are session parameters that will remain active after exiting the component. These parameters contain important information collected by the component. This prebuilt component provides values for the following output parameters:\n| Parameter Name | Description                                                                                                                                                                           | Output Format |\n|:-----------------|:-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:----------------|\n| phone_number  | User's local phone number, without the country code, used to identify the user.                                                                                                                                                          | string   |\n| transfer_reason | This parameter indicates the reason the flow exited, if it was not successful. The returned value is one of: agent: the end-user requested a human agent at some point during the conversation. denial_of_information: the end-user declined to share information requested by the component. max_no_input: the conversation reached the maximum number of retries for no-input events. See no-input built-in events. max_no_match: the conversation reached the maximum number of retries for no-match events. See no-match built-in events. webhook_error: a webhook error occurred. See webhook.error built-in event. webhook_not_found: a webhook URL was unreachable. See webhook.error.not-found built-in event. | string   |\n## Generators\nThis component uses [Generators](/dialogflow/cx/docs/concept/generative/generators) to enable specific parts of the conversation.\n### Summarization\nThe `Summarization` generator is used to generate a post-call summary describing the conversation handled by the component.\n### General FAQ\nThe `General FAQ` generator is used to handle frequently-asked questions related to discounts, sales, purchases, and loyalty programs.\n### User-specific offer details\nThe `User-specific offer details` generator is used to provide details about user-specific offers based on the information provided by the `get_offers_details` [webhook](/dialogflow/cx/docs/concept/prebuilt-component/offers-and-deals#webhook-setup) .\n### Offers and deals details\nThe `Offers and deals details` generator is used to provide details about general offers and deals based on the information provided by the `get_offers_details` [webhook](/dialogflow/cx/docs/concept/prebuilt-component/offers-and-deals#webhook-setup) . The user can ask about offers in a specific category or ask for more detail about specific offers.\n### Offers and deals FAQ\nThe `Offers and deals FAQ` generator is used to handle frequently-asked questions related to offers and deals.\n### Discount and promo code FAQ\nThe `Discount and promo code FAQ` is used to handle frequently-asked questions related to discounts and promotional codes.## Basic setup\nTo set up this prebuilt component:\n- [Import the prebuilt component](/dialogflow/cx/docs/concept/prebuilt-component#import) .\n- Configure the provided [flexible webhooks](/dialogflow/cx/docs/concept/webhook#flexible) with configuration describing your Dialogflow-external services, see Webhook setup.## Webhook setup\nIn order to use this component, you will need to configure the included [flexible webhooks](/dialogflow/cx/docs/concept/webhook#flexible) to retrieve needed information from your external services.\n### Get offers details\nThe `prebuilt_components_offers_and_deals:get_offers_details` webhook is used by the component to retrieve details about user-specific and general offers.\nThe following parameters are provided by the component as inputs to the API request.\n| Parameter Name    | Description         | Input Format |\n|:-----------------------------|:--------------------------------------------|:---------------|\n| $session.params.phone_number | Phone number to retrieve offer details for. | string   |\nThe following parameters are pulled from the API response to be used by the component.\n| Parameter Name | Description                                                                                                                 | Output Format |\n|:-----------------|:-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:----------------|\n| active_category | List of offer categories available to the user. Valid values are defined by the prebuilt_components_offers_and_deals_category entity.                                                                                   | List (string) |\n| user_email  | Email registered to the provided account, used to send offer details.                                                                                                   | string   |\n| user_offer  | List of user-specific offer details. Each element of the list represents a single offer, with key-value pairs describing different attributes of the offer, for example {\"valid_from\": \"2024-01-29\", \"sale_type\": \"none\", \"valid_until\": \"2024-03-28\", \"offer_id\": \"G5E0M2D7A6Y4W9S\", \"discount_value\": \"5%\", \"coupon_code\": \"ELECTRIC5\", \"is_redeem_allowed\": \"true\", \"minimum_order_value\": \"1000\", \"maximum_discount_amount\": \"200\", \"offer_category_name\": \"electronics\"}. | List (object) |\n| all_offers  | List of general offer details. Each element of the list represents a single offer, following the same format as the user_offer field.                                                                                   | List (object) |### Get coupon code details\nThe `prebuilt_components_offers_and_deals:get_coupon_code_details` webhook is used by the component to retrieve details about a specific coupon code that a user has reported issues with.\nThe following parameters are provided by the component as inputs to the API request.\n| Parameter Name    | Description          | Input Format |\n|:-----------------------------|:-------------------------------------------------|:---------------|\n| $flow.coupon_code   | Coupon code to retrieve details for.    | string   |\n| $session.params.phone_number | Phone number associated with the user's account. | string   |\nThe following parameters are pulled from the API response to be used by the component.\n| Parameter Name  | Description                                          | Output Format |\n|:--------------------|:----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:----------------|\n| offer_id   | Offer ID for the coupon code.                                      | string   |\n| offer_category_name | Category for the coupon code. Valid values are defined by the prebuilt_components_offers_and_deals_category entity.                | string   |\n| coupon_code_status | Status of the coupon code. Valid values are defined by the $flow.valid_coupon_code_status, $flow.invalid_coupon_code_status, and $flow.valid_coupon_code_status input parameters. | string   |\n| valid_until   | Date the coupon code is valid until, in YYYY-MM-DD format.                              | string   |\n| minimum_order_value | Minimum order value for the coupon code.                                   | string   |### Send message\nThe `prebuilt_components_offers_and_deals:send_message` webhook is used by the component to send a message containing offer details to the user's selected channel.\nThe following parameters are provided by the component as inputs to the API request.\n| Parameter Name    | Description                                | Input Format |\n|:-----------------------------|:-------------------------------------------------------------------------------------------------------------------------------------------|:---------------|\n| $session.params.phone_number | User's local phone number, without the country code, used to identify the user.               | string   |\n| $flow.confirmation_channel | Channel the user has selected to receive offer details on. Valid values are defined by the prebuilt_components_channel_email_phone entity. | string   |### Raise ticket\nThe `prebuilt_components_offers_and_deals:raise_ticket` webhook is used by the component to submit a ticket reporting a user issue with a coupon code.\nThe following parameters are provided by the component as inputs to the API request.\n| Parameter Name    | Description                  | Input Format |\n|:-----------------------------|:--------------------------------------------------------------------------------|:---------------|\n| $session.params.phone_number | User's local phone number, without the country code, used to identify the user. | string   |\n| $flow.coupon_code   | Coupon code the user has reported an issue for.         | string   |\n| $flow.offer_id    | Offer ID for the provided coupon code.           | string   |\n| $flow.coupon_code_issue  | User's provided issue for the coupon code.          | string   |### Complete\nYour agent and its webhooks should now be set up and ready to test.", "guide": "Dialogflow"}