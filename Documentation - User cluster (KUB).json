{"title": "Documentation - User cluster (KUB)", "url": "https://cloud.google.com/distributed-cloud/hosted/docs/latest/gdch/overview", "abstract": "# Documentation - User cluster (KUB)\n| 0     | 1                                     |\n|:-------------------|:----------------------------------------------------------------------------------------------------------------------------------------------------|\n| Workload location | Root only workloads                                 |\n| Audit log source | Kubernetes audit logs                                |\n| Audited operations | NodePoolClaim data changes AddressPoolClaim data changes SubnetClaim data changes CIDRClaim data changes Cluster data changes NodePool data changes |\n", "content": "## NodePoolClaim data changes (CRUD operations)\n| ('Fields in the log entry that contain audit information', 'Audit metadata') | ('Fields in the log entry that contain audit information', 'Audit field name') | ('Fields in the log entry that contain audit information', 'Value')                                                             |\n|:-------------------------------------------------------------------------------|:---------------------------------------------------------------------------------|:----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|\n| User or service identity              | user.username                 | For example, \"user\":{ \u00a0\"username\":\"system:serviceaccount:kube-system: anthos-cluster-operator-1.13.2\" }                                                    |\n| Target (Fields and values that call the API)         | requestURI                  | \"requestURI\":\"/apis/baremetal.cluster.gke.io/v1/ namespaces/org-1/nodepoolclaims/admin-control-plane-node-pool/ status\"                                                |\n| Action (Fields containing the performed operation)        | verb                    | \"verb\":\"update\"                                                                          |\n| Event timestamp                | requestReceivedTimestamp               | For example, \"requestReceivedTimestamp\":\"2022-11-18T23:15:22.882546Z\"                                                             |\n| Source of action                | sourceIPs                  | For example, \"sourceIPs\":[\"10.253.128.74\"]                                                                   |\n| Outcome                  | stage                   | For example, \"stage\":\"ResponseComplete\"                                                                    |\n| Other fields                 | kind objectRef                 | For example, \"kind\": \"Event\", \"objectRef\": { \"resource\": \"nodepoolclaims\", \"namespace\": \"org-1\", \"subresource\": \"status\", \"name\": \"admin-control-plane-node-pool\", \"apiVersion\": \"v1\", \"apiGroup\": \"baremetal.cluster.gke.io\", \"resourceVersion\": \"878163\", \"uid\": \"b2e1bec0-0f7c-4a57-869b-3fcb969ba7e2\" } |\n**Example log**\n```\n{\u00a0 \"responseStatus\": {\u00a0 \u00a0 \"metadata\": {},\u00a0 \u00a0 \"code\": 200\u00a0 },\u00a0 \"_gdch_cluster\": \"root-admin\",\u00a0 \"sourceIPs\": [\u00a0 \u00a0 \"10.253.128.74\"\u00a0 ],\u00a0 \"annotations\": {\u00a0 \u00a0 \"authorization.k8s.io/reason\": \"RBAC: allowed by ClusterRoleBinding \\\u00a0 \u00a0 \"operator-rolebinding-1.13.2\\\u00a0 \u00a0 \"of ClusterRole \\\"anthos-baremetal-operator-1.13.2\\\" \u00a0 \u00a0 to ServiceAccount \\\"anthos-cluster-operator-1.13.2/kube-system\\\"\",\u00a0 \u00a0 \"authorization.k8s.io/decision\": \"allow\"\u00a0 },\u00a0 \"requestReceivedTimestamp\": \"2022-11-23T23:19:42.690064Z\",\u00a0 \"stageTimestamp\": \"2022-11-23T23:19:42.695372Z\",\u00a0 \"_gdch_fluentbit_pod\": \"anthos-audit-logs-forwarder-4hlmv\",\u00a0 \"apiVersion\": \"audit.k8s.io/v1\",\u00a0 \"level\": \"Metadata\",\u00a0 \"user\": {\u00a0 \u00a0 \"extra\": {\u00a0 \u00a0 \u00a0 \"authentication.kubernetes.io/pod-name\": [\u00a0 \u00a0 \u00a0 \u00a0 \"anthos-cluster-operator-1.13.2-bc6b7467d-22z88\"\u00a0 \u00a0 \u00a0 ],\u00a0 \u00a0 \u00a0 \"authentication.kubernetes.io/pod-uid\": [\u00a0 \u00a0 \u00a0 \u00a0 \"004e1b37-6d4d-4959-b77d-0e69dce5ef4a\"\u00a0 \u00a0 \u00a0 ]\u00a0 \u00a0 },\u00a0 \u00a0 \"groups\": [\u00a0 \u00a0 \u00a0 \"system:serviceaccounts\",\u00a0 \u00a0 \u00a0 \"system:serviceaccounts:kube-system\",\u00a0 \u00a0 \u00a0 \"system:authenticated\"\u00a0 \u00a0 ],\u00a0 \u00a0 \"username\": \"system:serviceaccount:kube-system:anthos-cluster-operator-1.13.2\",\u00a0 \u00a0 \"uid\": \"4ebfd4f7-f371-4c40-9f88-ea0709a7039e\"\u00a0 },\u00a0 \"stage\": \"ResponseComplete\",\u00a0 \"requestURI\": \"/apis/baremetal.cluster.gke.io/v1/namespaces/org-1/\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0nodepoolclaims/admin-control-plane-node-pool/status\",\u00a0 \"kind\": \"Event\",\u00a0 \"objectRef\": {\u00a0 \u00a0 \"resource\": \"nodepoolclaims\",\u00a0 \u00a0 \"namespace\": \"org-1\",\u00a0 \u00a0 \"subresource\": \"status\",\u00a0 \u00a0 \"name\": \"admin-control-plane-node-pool\",\u00a0 \u00a0 \"apiVersion\": \"v1\",\u00a0 \u00a0 \"apiGroup\": \"baremetal.cluster.gke.io\",\u00a0 \u00a0 \"resourceVersion\": \"878163\",\u00a0 \u00a0 \"uid\": \"b2e1bec0-0f7c-4a57-869b-3fcb969ba7e2\"\u00a0 },\u00a0 \"verb\": \"update\",\u00a0 \"userAgent\": \"operator/v0.0.0 (linux/amd64) kubernetes/$Format\",\u00a0 \"auditID\": \"0539ea3a-b858-4a43-b516-812fc7e80dbd\",\u00a0 \"_gdch_service_name\": \"apiserver\"}\n```\n## AddressPoolClaim data changes (CRUD operations)\n| ('Fields in the log entry that contain audit information', 'Audit metadata') | ('Fields in the log entry that contain audit information', 'Audit field name') | ('Fields in the log entry that contain audit information', 'Value')                                 |\n|:-------------------------------------------------------------------------------|:---------------------------------------------------------------------------------|:----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|\n| User or service identity              | user.username                 | For example, \"user\":{ \u00a0\"username\":\"system:serviceaccount: gpc-system:root-admin-controller-sa\" }                         |\n| Target (Fields and values that call the API)         | requestURI                  | \"requestURI\":\"/apis/system.private.gdc.goog/VERSION/ namespaces/org-1/addresspoolclaims/admin-control-plane-node-pool? fieldManager=Organization&force=true\"          |\n| Action (Fields containing the performed operation)        | verb                    | \"verb\":\"patch\"                                              |\n| Event timestamp                | requestReceivedTimestamp               | For example, \"requestReceivedTimestamp\":\"2022-11-23T23:24:13.087516Z\"                                |\n| Source of action                | sourceIPs                  | For example, \"sourceIPs\":[\"10.128.3.197\"]                                       |\n| Outcome                  | stage                   | For example, \"stage\":\"ResponseComplete\"                                        |\n| Other fields                 | kind objectRef                 | For example, \"objectRef\": { \"namespace\": \"org-1\", \"name\": \"admin-control-plane-node-pool\", \"apiGroup\": \"system.private.gdc.goog\", \"apiVersion\": \"VERSION\", \"resource\": \"addresspoolclaims\" } |\n**Example log**\n```\n{\u00a0 \"_gdch_cluster\": \"root-admin\",\u00a0 \"requestReceivedTimestamp\": \"2022-11-23T23:24:13.087516Z\",\u00a0 \"userAgent\": \"root-admin-cm/v0.0.0 (linux/amd64) kubernetes/$Format\",\u00a0 \"kind\": \"Event\",\u00a0 \"_gdch_fluentbit_pod\": \"anthos-audit-logs-forwarder-4hlmv\",\u00a0 \"apiVersion\": \"audit.k8s.io/v1\",\u00a0 \"level\": \"Metadata\",\u00a0 \"auditID\": \"3e46bf8d-fc26-4b43-85fe-34f1f55a0398\",\u00a0 \"requestURI\": \"/apis/system.private.gdc.goog/VERSION/namespaces/org-1/\u00a0 \u00a0 addresspoolclaims/admin-control-plane-node-pool?\u00a0 \u00a0 fieldManager=Organization&force=true\",\u00a0 \"stage\": \"ResponseComplete\",\u00a0 \"user\": {\u00a0 \u00a0 \"groups\": [\u00a0 \u00a0 \u00a0 \"system:serviceaccounts\",\u00a0 \u00a0 \u00a0 \"system:serviceaccounts:gpc-system\",\u00a0 \u00a0 \u00a0 \"system:authenticated\"\u00a0 \u00a0 ],\u00a0 \u00a0 \"extra\": {\u00a0 \u00a0 \u00a0 \"authentication.kubernetes.io/pod-name\": [\u00a0 \u00a0 \u00a0 \u00a0 \"root-admin-controller-55b54bc95c-wjnwm\"\u00a0 \u00a0 \u00a0 ],\u00a0 \u00a0 \u00a0 \"authentication.kubernetes.io/pod-uid\": [\u00a0 \u00a0 \u00a0 \u00a0 \"915f7dcd-e8cb-4a1a-9c53-4b8e2751cf03\"\u00a0 \u00a0 \u00a0 ]\u00a0 \u00a0 },\u00a0 \u00a0 \"username\": \"system:serviceaccount:gpc-system:root-admin-controller-sa\",\u00a0 \u00a0 \"uid\": \"1ddfb03e-0dd5-42df-b8cb-c53a504d9026\"\u00a0 },\u00a0 \"verb\": \"patch\",\u00a0 \"responseStatus\": {\u00a0 \u00a0 \"metadata\": {},\u00a0 \u00a0 \"code\": 200\u00a0 },\u00a0 \"objectRef\": {\u00a0 \u00a0 \"namespace\": \"org-1\",\u00a0 \u00a0 \"name\": \"admin-control-plane-node-pool\",\u00a0 \u00a0 \"apiGroup\": \"system.private.gdc.goog\",\u00a0 \u00a0 \"apiVersion\": \"VERSION\",\u00a0 \u00a0 \"resource\": \"addresspoolclaims\"\u00a0 },\u00a0 \"sourceIPs\": [\u00a0 \u00a0 \"10.128.3.197\"\u00a0 ],\u00a0 \"annotations\": {\u00a0 \u00a0 \"authorization.k8s.io/reason\": \"RBAC: allowed by ClusterRoleBinding \\\u00a0 \u00a0 \"root-admin-rootadmin-controllers-rolebinding\\\" of ClusterRole \\\u00a0 \u00a0 \"root-admin-rootadmin-controllers-role\\\" to ServiceAccount \\\"root-admin-controller-sa/\u00a0 \u00a0 gpc-system\\\"\",\u00a0 \u00a0 \"authorization.k8s.io/decision\": \"allow\"\u00a0 },\u00a0 \"stageTimestamp\": \"2022-11-23T23:24:13.100163Z\",\u00a0 \"_gdch_service_name\": \"apiserver\"}\n```\n## SubnetClaim data changes (CRUD operations)\n| ('Fields in the log entry that contain audit information', 'Audit metadata') | ('Fields in the log entry that contain audit information', 'Audit field name') | ('Fields in the log entry that contain audit information', 'Value')               |\n|:-------------------------------------------------------------------------------|:---------------------------------------------------------------------------------|:-----------------------------------------------------------------------------------------------------------------------------|\n| User or service identity              | user.username                 | For example, \"user\":{ \u00a0\"username\":\"system:serviceaccount: gatekeeper-system:gatekeeper-admin\" }       |\n| Target (Fields and values that call the API)         | requestURI                  | \"requestURI\":\"/apis/system.private.gdc.goog/ VERSION/subnetclaims?limit=500\"            |\n| Action (Fields containing the performed operation)        | verb                    | \"verb\":\"list\"                            |\n| Event timestamp                | requestReceivedTimestamp               | For example, \"requestReceivedTimestamp\":\"2022-11-23T23:25:32.726387Z\"              |\n| Source of action                | sourceIPs                  | For example, \"sourceIPs\":[\"10.253.129.191\"]                     |\n| Outcome                  | stage                   | For example, \"stage\":\"ResponseComplete\"                      |\n| Other fields                 | kind objectRef                 | For example, \"objectRef\": { \"resource\": \"subnetclaims\", apiVersion\": \"VERSION\", \"apiGroup\": \"system.private.gdc.goog\" } |\n**Example log**\n```\n{\u00a0 \"_gdch_cluster\": \"root-admin\",\u00a0 \"_gdch_fluentbit_pod\": \"anthos-audit-logs-forwarder-gc5d7\",\u00a0 \"stageTimestamp\": \"2022-11-23T23:25:32.733616Z\",\u00a0 \"responseStatus\": {\u00a0 \u00a0 \"code\": 200,\u00a0 \u00a0 \"metadata\": {}\u00a0 },\u00a0 \"objectRef\": {\u00a0 \u00a0 \"resource\": \"subnetclaims\",\u00a0 \u00a0 \"apiVersion\": \"VERSION\",\u00a0 \u00a0 \"apiGroup\": \"system.private.gdc.goog\"\u00a0 },\u00a0 \"auditID\": \"b611ebea-4c30-4962-9283-c5dcc95c6e13\",\u00a0 \"verb\": \"list\",\u00a0 \"kind\": \"Event\",\u00a0 \"annotations\": {\u00a0 \u00a0 \"authorization.k8s.io/reason\": \"RBAC: allowed by ClusterRoleBinding \\\"gatekeeper-manager-rolebinding\\\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0\" of ClusterRole \\\"gatekeeper-manager-role\\\" to ServiceAccount \\\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0\"gatekeeper-admin/gatekeeper-system\\\"\",\u00a0 \u00a0 \"authorization.k8s.io/decision\": \"allow\"\u00a0 },\u00a0 \"user\": {\u00a0 \u00a0 \"extra\": {\u00a0 \u00a0 \u00a0 \"authentication.kubernetes.io/pod-name\": [\u00a0 \u00a0 \u00a0 \u00a0 \"gatekeeper-audit-b765495d8-4znjd\"\u00a0 \u00a0 \u00a0 ],\u00a0 \u00a0 \u00a0 \"authentication.kubernetes.io/pod-uid\": [\u00a0 \u00a0 \u00a0 \u00a0 \"9e515f53-15bf-4570-9c57-2f53e0b69a5d\"\u00a0 \u00a0 \u00a0 ]\u00a0 \u00a0 },\u00a0 \u00a0 \"uid\": \"d5dc180d-1bca-4d84-885d-a871e0b6d5a2\",\u00a0 \u00a0 \"groups\": [\u00a0 \u00a0 \u00a0 \"system:serviceaccounts\",\u00a0 \u00a0 \u00a0 \"system:serviceaccounts:gatekeeper-system\",\u00a0 \u00a0 \u00a0 \"system:authenticated\"\u00a0 \u00a0 ],\u00a0 \u00a0 \"username\": \"system:serviceaccount:gatekeeper-system:gatekeeper-admin\"\u00a0 },\u00a0 \"stage\": \"ResponseComplete\",\u00a0 \"userAgent\": \"gatekeeper/v3.7.0 (linux/amd64) 3ba8e93/2021-11-15T20:59:44Z\",\u00a0 \"requestURI\": \"/apis/system.private.gdc.goog/VERSION/subnetclaims?limit=500\",\u00a0 \"requestReceivedTimestamp\": \"2022-11-23T23:25:32.726387Z\",\u00a0 \"sourceIPs\": [\u00a0 \u00a0 \"10.253.129.191\"\u00a0 ],\u00a0 \"level\": \"Metadata\",\u00a0 \"apiVersion\": \"audit.k8s.io/v1\",\u00a0 \"_gdch_service_name\": \"apiserver\"}\n```\n## CIDRClaim data changes (CRUD operations)\n| ('Fields in the log entry that contain audit information', 'Audit metadata') | ('Fields in the log entry that contain audit information', 'Audit field name') | ('Fields in the log entry that contain audit information', 'Value')                |\n|:-------------------------------------------------------------------------------|:---------------------------------------------------------------------------------|:---------------------------------------------------------------------------------------------------------------------------------|\n| User or service identity              | user.username                 | For example, \"user\":{ \u00a0\"username\":\"system:serviceaccount: gatekeeper-system:gatekeeper-admin\" }        |\n| Target (Fields and values that call the API)         | requestURI                  | \"requestURI\":\"/apis/baremetal.cluster.gke.io/ VERSION/addonconfigurations?limit=500\"           |\n| Action (Fields containing the performed operation)        | verb                    | \"verb\":\"list\"                             |\n| Event timestamp                | requestReceivedTimestamp               | For example, \"requestReceivedTimestamp\":\"2022-11-23T23:29:31.952355Z\"               |\n| Source of action                | sourceIPs                  | For example, \"sourceIPs\":[\"10.253.129.191\"]                      |\n| Outcome                  | stage                   | For example, \"stage\":\"ResponseComplete\"                       |\n| Other fields                 | kind objectRef                 | For example, \"objectRef\": { \"apiGroup\": \"dr.private.gdc.goog\", \"resource\": \"cidrclaimallocations\", \"apiVersion\": \"VERSION\" } |\n**Example log**\n```\n{\u00a0 \"_gdch_cluster\": \"root-admin\",\u00a0 \"_gdch_fluentbit_pod\": \"anthos-audit-logs-forwarder-gc5d7\",\u00a0 \"objectRef\": {\u00a0 \u00a0 \"apiGroup\": \"dr.private.gdc.goog\",\u00a0 \u00a0 \"resource\": \"cidrclaimallocations\",\u00a0 \u00a0 \"apiVersion\": \"VERSION\"\u00a0 },\u00a0 \"responseStatus\": {\u00a0 \u00a0 \"metadata\": {},\u00a0 \u00a0 \"code\": 200\u00a0 },\u00a0 \"annotations\": {\u00a0 \u00a0 \"authorization.k8s.io/decision\": \"allow\",\u00a0 \u00a0 \"authorization.k8s.io/reason\": \"RBAC: allowed by ClusterRoleBinding \\\"gatekeeper-manager-rolebinding\\\" of ClusterRole \\\"gatekeeper-manager-role\\\" to ServiceAccount \\\"gatekeeper-admin/gatekeeper-system\\\"\"\u00a0 },\u00a0 \"stageTimestamp\": \"2022-11-23T23:26:28.165121Z\",\u00a0 \"kind\": \"Event\",\u00a0 \"level\": \"Metadata\",\u00a0 \"auditID\": \"a21c62ab-6f86-4898-a719-0970e89a031c\",\u00a0 \"user\": {\u00a0 \u00a0 \"groups\": [\u00a0 \u00a0 \u00a0 \"system:serviceaccounts\",\u00a0 \u00a0 \u00a0 \"system:serviceaccounts:gatekeeper-system\",\u00a0 \u00a0 \u00a0 \"system:authenticated\"\u00a0 \u00a0 ],\u00a0 \u00a0 \"extra\": {\u00a0 \u00a0 \u00a0 \"authentication.kubernetes.io/pod-name\": [\u00a0 \u00a0 \u00a0 \u00a0 \"gatekeeper-audit-b765495d8-4znjd\"\u00a0 \u00a0 \u00a0 ],\u00a0 \u00a0 \u00a0 \"authentication.kubernetes.io/pod-uid\": [\u00a0 \u00a0 \u00a0 \u00a0 \"9e515f53-15bf-4570-9c57-2f53e0b69a5d\"\u00a0 \u00a0 \u00a0 ]\u00a0 \u00a0 },\u00a0 \u00a0 \"username\": \"system:serviceaccount:gatekeeper-system:gatekeeper-admin\",\u00a0 \u00a0 \"uid\": \"d5dc180d-1bca-4d84-885d-a871e0b6d5a2\"\u00a0 },\u00a0 \"stage\": \"ResponseComplete\",\u00a0 \"apiVersion\": \"audit.k8s.io/v1\",\u00a0 \"requestURI\": \"/apis/dr.private.gdc.goog/VERSION/cidrclaimallocations?limit=500\",\u00a0 \"requestReceivedTimestamp\": \"2022-11-23T23:26:28.159646Z\",\u00a0 \"verb\": \"list\",\u00a0 \"sourceIPs\": [\u00a0 \u00a0 \"10.253.129.191\"\u00a0 ],\u00a0 \"userAgent\": \"gatekeeper/v3.7.0 (linux/amd64) 3ba8e93/2021-11-15T20:59:44Z\",\u00a0 \"_gdch_service_name\": \"apiserver\"}\n```\n## Cluster data changes (CRUD operations)\n| ('Fields in the log entry that contain audit information', 'Audit metadata') | ('Fields in the log entry that contain audit information', 'Audit field name') | ('Fields in the log entry that contain audit information', 'Value')                 |\n|:-------------------------------------------------------------------------------|:---------------------------------------------------------------------------------|:-------------------------------------------------------------------------------------------------------------------------------------|\n| User or service identity              | user.username                 | For example, \"user\":{ \u00a0\"username\":\"system:serviceaccount: gatekeeper-system:gatekeeper-admin\" }         |\n| Target (Fields and values that call the API)         | requestURI                  | \"requestURI\":\"/apis/baremetal.cluster.gke.io/ VERSION/addonconfigurations?limit=500\"            |\n| Action (Fields containing the performed operation)        | verb                    | \"verb\":\"list\"                              |\n| Event timestamp                | requestReceivedTimestamp               | For example, \"requestReceivedTimestamp\":\"2022-11-23T23:29:31.952355Z\"                |\n| Source of action                | sourceIPs                  | For example, \"sourceIPs\":[\"10.253.129.191\"]                       |\n| Outcome                  | stage                   | For example, \"stage\":\"ResponseComplete\"                        |\n| Other fields                 | kind objectRef                 | For example, \"objectRef\": { \"apiGroup\": \"baremetal.cluster.gke.io\", \"resource\": \"addonconfigurations\", \"apiVersion\": \"VERSION\" } |\n**Example log**\n```\n{\u00a0 \"sourceIPs\": [\u00a0 \u00a0 \"10.253.129.191\"\u00a0 ],\u00a0 \"stageTimestamp\": \"2022-11-23T23:29:31.952355Z\",\u00a0 \"_gdch_fluentbit_pod\": \"anthos-audit-logs-forwarder-gc5d7\",\u00a0 \"_gdch_cluster\": \"root-admin\",\u00a0 \"userAgent\": \"gatekeeper/v3.7.0 (linux/amd64) 3ba8e93/2021-11-15T20:59:44Z\",\u00a0 \"stage\": \"RequestReceived\",\u00a0 \"auditID\": \"3f05e001-38f0-431e-8cc2-61d00d992b6d\",\u00a0 \"kind\": \"Event\",\u00a0 \"level\": \"Metadata\",\u00a0 \"apiVersion\": \"audit.k8s.io/v1\",\u00a0 \"requestURI\": \"/apis/baremetal.cluster.gke.io/VERSION/addonconfigurations?limit=500\",\u00a0 \"requestReceivedTimestamp\": \"2022-11-23T23:29:31.952355Z\",\u00a0 \"verb\": \"list\",\u00a0 \"user\": {\u00a0 \u00a0 \"extra\": {\u00a0 \u00a0 \u00a0 \"authentication.kubernetes.io/pod-name\": [\u00a0 \u00a0 \u00a0 \u00a0 \"gatekeeper-audit-b765495d8-4znjd\"\u00a0 \u00a0 \u00a0 ],\u00a0 \u00a0 \u00a0 \"authentication.kubernetes.io/pod-uid\": [\u00a0 \u00a0 \u00a0 \u00a0 \"9e515f53-15bf-4570-9c57-2f53e0b69a5d\"\u00a0 \u00a0 \u00a0 ]\u00a0 \u00a0 },\u00a0 \u00a0 \"uid\": \"d5dc180d-1bca-4d84-885d-a871e0b6d5a2\",\u00a0 \u00a0 \"groups\": [\u00a0 \u00a0 \u00a0 \"system:serviceaccounts\",\u00a0 \u00a0 \u00a0 \"system:serviceaccounts:gatekeeper-system\",\u00a0 \u00a0 \u00a0 \"system:authenticated\"\u00a0 \u00a0 ],\u00a0 \u00a0 \"username\": \"system:serviceaccount:gatekeeper-system:gatekeeper-admin\"\u00a0 },\u00a0 \"objectRef\": {\u00a0 \u00a0 \"apiGroup\": \"baremetal.cluster.gke.io\",\u00a0 \u00a0 \"resource\": \"addonconfigurations\",\u00a0 \u00a0 \"apiVersion\": \"VERSION\"\u00a0 },\u00a0 \"_gdch_service_name\": \"apiserver\"}\n```\n## NodePool data changes (CRUD operations)\n| ('Fields in the log entry that contain audit information', 'Audit metadata') | ('Fields in the log entry that contain audit information', 'Audit field name') | ('Fields in the log entry that contain audit information', 'Value')             |\n|:-------------------------------------------------------------------------------|:---------------------------------------------------------------------------------|:----------------------------------------------------------------------------------------------------------------------|\n| User or service identity              | user.username                 | For example, \"user\":{ \u00a0\"username\":\"system:serviceaccount: kube-system:lifecycle-controllers-manager\" }    |\n| Target (Fields and values that call the API)         | requestURI                  | \"requestURI\":\"/apis/baremetal.cluster.gke.io/v1/nodepools\"               |\n| Action (Fields containing the performed operation)        | verb                    | \"verb\":\"list\"                           |\n| Event timestamp                | requestReceivedTimestamp               | For example, \"requestReceivedTimestamp\":\"2022-11-23T23:29:31.952355Z\"             |\n| Source of action                | sourceIPs                  | For example, \"sourceIPs\":[\"2022-11-23T23:28:41.742117Z\"]                |\n| Outcome                  | stage                   | For example, \"stage\":\"ResponseComplete\"                    |\n| Other fields                 | kind objectRef                 | For example, \"objectRef\": { \"apiGroup\": \"baremetal.cluster.gke.io\", \"resource\": \"nodepools\", \"apiVersion\": \"v1\" } |\n**Example log**\n```\n{\u00a0 \"requestURI\": \"/apis/baremetal.cluster.gke.io/v1/nodepools\",\u00a0 \"_gdch_cluster\": \"root-admin\",\u00a0 \"sourceIPs\": [\u00a0 \u00a0 \"10.253.130.147\"\u00a0 ],\u00a0 \"stageTimestamp\": \"2022-11-23T23:28:41.746854Z\",\u00a0 \"responseStatus\": {\u00a0 \u00a0 \"metadata\": {},\u00a0 \u00a0 \"code\": 200\u00a0 },\u00a0 \"annotations\": {\u00a0 \u00a0 \"authorization.k8s.io/reason\": \"RBAC: allowed by ClusterRoleBinding \\\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"lifecycl-controllers-manager-rolebinding\\\" \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 of ClusterRole \\\"lifecycle-controllers-manager\\\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \" to ServiceAccount \\\"lifecycle-controllers-manager/kube-system\\\"\",\u00a0 \u00a0 \"authorization.k8s.io/decision\": \"allow\"\u00a0 },\u00a0 \"requestReceivedTimestamp\": \"2022-11-23T23:28:41.742117Z\",\u00a0 \"userAgent\": \"manager/v0.0.0 (linux/amd64) kubernetes/$Format\",\u00a0 \"kind\": \"Event\",\u00a0 \"auditID\": \"c916fab1-a10b-4df8-b680-71ccb5d339ac\",\u00a0 \"user\": {\u00a0 \u00a0 \"extra\": {\u00a0 \u00a0 \u00a0 \"authentication.kubernetes.io/pod-uid\": [\u00a0 \u00a0 \u00a0 \u00a0 \"0b1e3b51-8bdb-4527-8a34-1ae7577cf0aa\"\u00a0 \u00a0 \u00a0 ],\u00a0 \u00a0 \u00a0 \"authentication.kubernetes.io/pod-name\": [\u00a0 \u00a0 \u00a0 \u00a0 \"lifecycle-controllers-manager-7495f9dd99-bfvdg\"\u00a0 \u00a0 \u00a0 ]\u00a0 \u00a0 },\u00a0 \u00a0 \"groups\": [\u00a0 \u00a0 \u00a0 \"system:serviceaccounts\",\u00a0 \u00a0 \u00a0 \"system:serviceaccounts:kube-system\",\u00a0 \u00a0 \u00a0 \"system:authenticated\"\u00a0 \u00a0 ],\u00a0 \u00a0 \"username\": \"system:serviceaccount:kube-system:lifecycle-controllers-manager\",\u00a0 \u00a0 \"uid\": \"c84957dc-f483-41c4-b0e1-1a2c9cb93dda\"\u00a0 },\u00a0 \"stage\": \"ResponseComplete\",\u00a0 \"_gdch_fluentbit_pod\": \"anthos-audit-logs-forwarder-4hlmv\",\u00a0 \"verb\": \"list\",\u00a0 \"apiVersion\": \"audit.k8s.io/v1\",\u00a0 \"level\": \"Metadata\",\u00a0 \"objectRef\": {\u00a0 \u00a0 \"apiGroup\": \"baremetal.cluster.gke.io\",\u00a0 \u00a0 \"resource\": \"nodepools\",\u00a0 \u00a0 \"apiVersion\": \"v1\"\u00a0 },\u00a0 \"_gdch_service_name\": \"apiserver\"}\n```", "guide": "Documentation"}