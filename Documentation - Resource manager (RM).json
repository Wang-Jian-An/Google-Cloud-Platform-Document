{"title": "Documentation - Resource manager (RM)", "url": "https://cloud.google.com/distributed-cloud/hosted/docs/latest/gdch/overview", "abstract": "# Documentation - Resource manager (RM)\n| 0     | 1                                              |\n|:-------------------|:---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|\n| Workload location | Root and organization workloads                                      |\n| Audit log source | Kubernetes audit logs                                         |\n| Audited operations | KRM API Management Plane Audit Logs (Project) KRM API Management Plane Audit Logs (Project RBAC - ProjectRole) KRM API Management Plane Audit Logs (Project RBAC - ProjectRoleBinding) |\n", "content": "## KRM API Management Plane Audit Logs (Project)\n| ('Fields in the log entry that contain audit information', 'Audit metadata') | ('Fields in the log entry that contain audit information', 'Audit field name') | ('Fields in the log entry that contain audit information', 'Value')                                                  |\n|:-------------------------------------------------------------------------------|:---------------------------------------------------------------------------------|:---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|\n| User or service identity              | username                   | For example, \"username\":system:serviceaccount:gpc-system:fleet-admin-controller\"                                               |\n| Target (Fields and values that call the API)         | requestURI                  | \"apis/resourcemanager.gdc.goog/v1/namespaces/ gpc-system/projects/istio-system                                               |\n| Action (Fields containing the performed operation)        | verb                    | \"verb\":\"update\"                                                               |\n| Event timestamp                | requestReceivedTimestamp               | For example, \"requestReceivedTimestamp\": \"2022-12-22T15:46:41.028873Z\"                                                 |\n| Source of action                | sourceIPs                  | For example, \"sourceIPs\":[\"10.253.128.178\"],                                                        |\n| Outcome                  | stage                   | For example, \"stage\": \"ResponseComplete\"                                                         |\n| Other fields                 | kind objectRef                 | For example, \"kind\": \"Event\", \"objectRef\": { \"name\": \"istio-system\", \"apiVersion\": \"v1\", \"apiGroup\": \"resourcemanager.gdc.goog\", \"resourceVersion\": \"7812139\", \"resource\": \"projects\", \"uid\": \"7d3a3bb1-a0be-4c5c-980b-f9cd3632f6e3\", \"namespace\": \"gpc-system\" }, |\n**Example log**\n```\n{\u00a0 \u00a0 \"stage\": \"ResponseComplete\",\u00a0 \u00a0 \"apiVersion\": \"audit.k8s.io/v1\",\u00a0 \u00a0 \"objectRef\": {\u00a0 \u00a0 \u00a0 \"name\": \"istio-system\",\u00a0 \u00a0 \u00a0 \"apiVersion\": \"v1\",\u00a0 \u00a0 \u00a0 \"apiGroup\": \"resourcemanager.gdc.goog\",\u00a0 \u00a0 \u00a0 \"resourceVersion\": \"7812139\",\u00a0 \u00a0 \u00a0 \"resource\": \"projects\",\u00a0 \u00a0 \u00a0 \"uid\": \"7d3a3bb1-a0be-4c5c-980b-f9cd3632f6e3\",\u00a0 \u00a0 \u00a0 \"namespace\": \"gpc-system\"\u00a0 \u00a0 },\u00a0 \u00a0 \"requestReceivedTimestamp\": \"2022-12-22T15:46:41.028873Z\",\u00a0 \u00a0 \"sourceIPs\": [\u00a0 \u00a0 \u00a0 \"10.253.128.178\"\u00a0 \u00a0 ],\u00a0 \u00a0 \"annotations\": {\u00a0 \u00a0 \u00a0 \"authorization.k8s.io/decision\": \"allow\",\u00a0 \u00a0 \u00a0 \"authorization.k8s.io/reason\": \"RBAC: allowed by ClusterRoleBinding \\\"fleet-admin-common-controller\\\" of ClusterRole \\\"fleet-admin-common-controllers-role\\\" to ServiceAccount \\\"fleet-admin-controller/gpc-system\\\"\",\u00a0 \u00a0 \u00a0 \"mutation.webhook.admission.k8s.io/round_0_index_5\": \"{\\\"configuration\\\":\\\"gatekeeper-mutating-webhook-configuration\\\",\\\"webhook\\\":\\\"mutation.gatekeeper.sh\\\",\\\"mutated\\\":false}\"\u00a0 \u00a0 },\u00a0 \u00a0 \"_gdch_cluster\": \"root-admin\",\u00a0 \u00a0 \"_gdch_fluentbit_pod\": \"anthos-audit-logs-forwarder-t4rld\",\u00a0 \u00a0 \"user\": {\u00a0 \u00a0 \u00a0 \"uid\": \"da8e839f-eca4-4a96-9058-94fa4202824f\",\u00a0 \u00a0 \u00a0 \"extra\": {\u00a0 \u00a0 \u00a0 \u00a0 \"authentication.kubernetes.io/pod-uid\": [\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"09335650-82b0-451c-83e2-f8157e9d518c\"\u00a0 \u00a0 \u00a0 \u00a0 ],\u00a0 \u00a0 \u00a0 \u00a0 \"authentication.kubernetes.io/pod-name\": [\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"fleet-admin-controller-75dbdf7659-ccfrn\"\u00a0 \u00a0 \u00a0 \u00a0 ]\u00a0 \u00a0 \u00a0 },\u00a0 \u00a0 \u00a0 \"groups\": [\u00a0 \u00a0 \u00a0 \u00a0 \"system:serviceaccounts\",\u00a0 \u00a0 \u00a0 \u00a0 \"system:serviceaccounts:gpc-system\",\u00a0 \u00a0 \u00a0 \u00a0 \"system:authenticated\"\u00a0 \u00a0 \u00a0 ],\u00a0 \u00a0 \u00a0 \"username\": \"system:serviceaccount:gpc-system:fleet-admin-controller\"\u00a0 \u00a0 },\u00a0 \u00a0 \"stageTimestamp\": \"2022-12-22T15:46:41.119767Z\",\u00a0 \u00a0 \"kind\": \"Event\",\u00a0 \u00a0 \"verb\": \"update\",\u00a0 \u00a0 \"requestURI\": \"/apis/resourcemanager.gdc.goog/v1/namespaces/gpc-system/projects/istio-system\",\u00a0 \u00a0 \"responseStatus\": {\u00a0 \u00a0 \u00a0 \"metadata\": {},\u00a0 \u00a0 \u00a0 \"code\": 200\u00a0 \u00a0 },\u00a0 \u00a0 \"userAgent\": \"fleet-admin-cm/v0.0.0 (linux/amd64) kubernetes/$Format\",\u00a0 \u00a0 \"auditID\": \"5aeaeab6-7371-4b63-8355-b4469e1440bb\",\u00a0 \u00a0 \"level\": \"Metadata\",\u00a0 \u00a0 \"_gdch_service_name\": \"apiserver\",\u00a0 \u00a0 \"_gdch_tenant_id\": \"infra-obs\"\u00a0 }\n```\n## KRM API Management Plane Audit Logs (Project RBAC - ProjectRole)\n| ('Fields in the log entry that contain audit information', 'Audit metadata') | ('Fields in the log entry that contain audit information', 'Audit field name') | ('Fields in the log entry that contain audit information', 'Value')                                                               |\n|:-------------------------------------------------------------------------------|:---------------------------------------------------------------------------------|:------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|\n| User or service identity              | username                   | For example, \"username\": \"system:serviceaccount: gpc-system:fleet-admin-controller\"                                                           |\n| Target (Fields and values that call the API)         | requestURI                  | \"requestURI\":\"/apis/resourcemanager.gdc.goog/ v1/namespaces/vm-prober-system-obs-system/ projectroles/service-now-admin/status\"                                                |\n| Action (Fields containing the performed operation)        | verb                    | \"verb\":\"update\"                                                                            |\n| Event timestamp                | requestReceivedTimestamp               | For example, \"requestReceivedTimestamp\": \"2022-12-21T23:36:45.808663Z\"                                                              |\n| Source of action                | sourceIPs                  | For example, \"sourceIPs\":[\"10.253.128.178\"]                                                                     |\n| Outcome                  | stage                   | For example, \"stage\": \"ResponseComplete\"                                                                      |\n| Other fields                 | kind objectRef                 | For example, \"kind\": \"Event\", \"objectRef\": { \"apiVersion\": \"v1\", \"namespace\": \"vm-prober-system-obs-system\", \"resourceVersion\": \"5573513\", \"apiGroup\": \"resourcemanager.gdc.goog\", \"resource\": \"projectroles\", \"name\": \"service-now-admin\", \"subresource\": \"status\", \"uid\": \"c220806d-a708-4e42-8a2c-8442b6a74038\" }, |\n**Example log**\n```\n{\u00a0 \u00a0 \"verb\": \"update\",\u00a0 \u00a0 \"responseStatus\": {\u00a0 \u00a0 \u00a0 \"metadata\": {},\u00a0 \u00a0 \u00a0 \"code\": 200\u00a0 \u00a0 },\u00a0 \u00a0 \"objectRef\": {\u00a0 \u00a0 \u00a0 \"apiVersion\": \"v1\",\u00a0 \u00a0 \u00a0 \"namespace\": \"vm-prober-system-obs-system\",\u00a0 \u00a0 \u00a0 \"resourceVersion\": \"5573513\",\u00a0 \u00a0 \u00a0 \"apiGroup\": \"resourcemanager.gdc.goog\",\u00a0 \u00a0 \u00a0 \"resource\": \"projectroles\",\u00a0 \u00a0 \u00a0 \"name\": \"service-now-admin\",\u00a0 \u00a0 \u00a0 \"subresource\": \"status\",\u00a0 \u00a0 \u00a0 \"uid\": \"c220806d-a708-4e42-8a2c-8442b6a74038\"\u00a0 \u00a0 },\u00a0 \u00a0 \"apiVersion\": \"audit.k8s.io/v1\",\u00a0 \u00a0 \"sourceIPs\": [\u00a0 \u00a0 \u00a0 \"10.253.128.178\"\u00a0 \u00a0 ],\u00a0 \u00a0 \"kind\": \"Event\",\u00a0 \u00a0 \"requestURI\": \"/apis/resourcemanager.gdc.goog/v1/namespaces/vm-prober-system-obs-system/projectroles/service-now-admin/status\",\u00a0 \u00a0 \"auditID\": \"e40537d8-0e49-4f34-85b3-f6bb5c373a58\",\u00a0 \u00a0 \"_gdch_cluster\": \"root-admin\",\u00a0 \u00a0 \"annotations\": {\u00a0 \u00a0 \u00a0 \"authorization.k8s.io/decision\": \"allow\",\u00a0 \u00a0 \u00a0 \"authorization.k8s.io/reason\": \"RBAC: allowed by ClusterRoleBinding \\\"fleet-admin-controller\\\" of ClusterRole \\\"fleet-admin-controller\\\" to ServiceAccount \\\"fleet-admin-controller/gpc-system\\\"\"\u00a0 \u00a0 },\u00a0 \u00a0 \"stageTimestamp\": \"2022-12-21T23:36:45.814414Z\",\u00a0 \u00a0 \"_gdch_fluentbit_pod\": \"anthos-audit-logs-forwarder-t4rld\",\u00a0 \u00a0 \"level\": \"Metadata\",\u00a0 \u00a0 \"stage\": \"ResponseComplete\",\u00a0 \u00a0 \"userAgent\": \"fleet-admin-cm/v0.0.0 (linux/amd64) kubernetes/$Format\",\u00a0 \u00a0 \"requestReceivedTimestamp\": \"2022-12-21T23:36:45.808663Z\",\u00a0 \u00a0 \"user\": {\u00a0 \u00a0 \u00a0 \"extra\": {\u00a0 \u00a0 \u00a0 \u00a0 \"authentication.kubernetes.io/pod-name\": [\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"fleet-admin-controller-75dbdf7659-ccfrn\"\u00a0 \u00a0 \u00a0 \u00a0 ],\u00a0 \u00a0 \u00a0 \u00a0 \"authentication.kubernetes.io/pod-uid\": [\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"09335650-82b0-451c-83e2-f8157e9d518c\"\u00a0 \u00a0 \u00a0 \u00a0 ]\u00a0 \u00a0 \u00a0 },\u00a0 \u00a0 \u00a0 \"groups\": [\u00a0 \u00a0 \u00a0 \u00a0 \"system:serviceaccounts\",\u00a0 \u00a0 \u00a0 \u00a0 \"system:serviceaccounts:gpc-system\",\u00a0 \u00a0 \u00a0 \u00a0 \"system:authenticated\"\u00a0 \u00a0 \u00a0 ],\u00a0 \u00a0 \u00a0 \"username\": \"system:serviceaccount:gpc-system:fleet-admin-controller\",\u00a0 \u00a0 \u00a0 \"uid\": \"da8e839f-eca4-4a96-9058-94fa4202824f\"\u00a0 \u00a0 },\u00a0 \u00a0 \"_gdch_service_name\": \"apiserver\",\u00a0 \u00a0 \"_gdch_tenant_id\": \"infra-obs\"\u00a0 }\n```\n## KRM API Management Plane Audit Logs (Project RBAC - ProjectRoleBinding)\n| ('Fields in the log entry that contain audit information', 'Audit metadata') | ('Fields in the log entry that contain audit information', 'Audit field name') | ('Fields in the log entry that contain audit information', 'Value')                    |\n|:-------------------------------------------------------------------------------|:---------------------------------------------------------------------------------|:--------------------------------------------------------------------------------------------------------------------------------------------------|\n| User or service identity              | username                   | For example, \"username\": \"system:serviceaccount: gatekeeper-system:gatekeeper-admin\"                |\n| Target (Fields and values that call the API)         | requestURI                  | \"/apis/resourcemanager.gdc.goog/ v1/projectrolebindings?limit=500\"                    |\n| Action (Fields containing the performed operation)        | verb                    | \"verb\":\"list\"                                  |\n| Event timestamp                | requestReceivedTimestamp               | For example, \"requestReceivedTimestamp\": \"2022-12-06T23:03:32.904478Z\"                   |\n| Source of action                | sourceIPs                  | For example, \"sourceIPs\":[\"10.253.165.69\"],                          |\n| Outcome                  | stage                   | For example, \"stage\": \"RequestReceived\"                           |\n| Other fields                 | kind objectRef                 | For example, \"kind\": \"Event\", \"objectRef\": { \"resource\": \"projectrolebindings\", \"apiVersion\": \"v1\", \"apiGroup\": \"resourcemanager.gdc.goog\" }, |\n**Example log**\n```\n{\u00a0 \"verb\": \"list\",\u00a0 \"_gdch_fluentbit_pod\": \"anthos-audit-logs-forwarder-t4rld\",\u00a0 \"userAgent\": \"gatekeeper/v3.7.0 (linux/amd64) 3ba8e93/2021-11-15T20:59:44Z\",\u00a0 \"objectRef\": {\u00a0 \u00a0 \"apiVersion\": \"v1\",\u00a0 \u00a0 \"resource\": \"projectrolebindings\",\u00a0 \u00a0 \"apiGroup\": \"resourcemanager.gdc.goog\"\u00a0 },\u00a0 \"sourceIPs\": [\u00a0 \u00a0 \"10.253.128.219\"\u00a0 ],\u00a0 \"responseStatus\": {\u00a0 \u00a0 \"code\": 200,\u00a0 \u00a0 \"metadata\": {}\u00a0 },\u00a0 \"kind\": \"Event\",\u00a0 \"stage\": \"ResponseComplete\",\u00a0 \"annotations\": {\u00a0 \u00a0 \"authorization.k8s.io/decision\": \"allow\",\u00a0 \u00a0 \"authorization.k8s.io/reason\": \"RBAC: allowed by ClusterRoleBinding \\\"gatekeeper-manager-rolebinding\\\" of ClusterRole \\\"gatekeeper-manager-role\\\" to ServiceAccount \\\"gatekeeper-admin/gatekeeper-system\\\"\"\u00a0 },\u00a0 \"requestURI\": \"/apis/resourcemanager.gdc.goog/v1/projectrolebindings?limit=500\",\u00a0 \"user\": {\u00a0 \u00a0 \"uid\": \"d23f8b07-b318-47fb-a81d-9932e81c3be8\",\u00a0 \u00a0 \"groups\": [\u00a0 \u00a0 \u00a0 \"system:serviceaccounts\",\u00a0 \u00a0 \u00a0 \"system:serviceaccounts:gatekeeper-system\",\u00a0 \u00a0 \u00a0 \"system:authenticated\"\u00a0 \u00a0 ],\u00a0 \u00a0 \"extra\": {\u00a0 \u00a0 \u00a0 \"authentication.kubernetes.io/pod-uid\": [\u00a0 \u00a0 \u00a0 \u00a0 \"86ab2ec3-93ae-49b6-9feb-cadae6d014c4\"\u00a0 \u00a0 \u00a0 ],\u00a0 \u00a0 \u00a0 \"authentication.kubernetes.io/pod-name\": [\u00a0 \u00a0 \u00a0 \u00a0 \"gatekeeper-audit-54d846f776-z6bzn\"\u00a0 \u00a0 \u00a0 ]\u00a0 \u00a0 },\u00a0 \u00a0 \"username\": \"system:serviceaccount:gatekeeper-system:gatekeeper-admin\"\u00a0 },\u00a0 \"stageTimestamp\": \"2022-12-21T23:11:57.899640Z\",\u00a0 \"auditID\": \"e8d0d02b-f309-4127-8cdb-e93a39ebaea7\",\u00a0 \"apiVersion\": \"audit.k8s.io/v1\",\u00a0 \"level\": \"Metadata\",\u00a0 \"_gdch_cluster\": \"root-admin\",\u00a0 \"requestReceivedTimestamp\": \"2022-12-21T23:11:57.897447Z\",\u00a0 \"_gdch_service_name\": \"apiserver\",\u00a0 \"_gdch_tenant_id\": \"infra-obs\"}\n```", "guide": "Documentation"}