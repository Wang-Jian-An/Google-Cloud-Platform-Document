{"title": "Compute Engine - Troubleshoot creating, updating and deleting VMs", "url": "https://cloud.google.com/compute/docs/instances", "abstract": "# Compute Engine - Troubleshoot creating, updating and deleting VMs\n", "content": "## Errors when creating VMs\nIf you can't create a VM instance, it might be due to one of the issues that's described in this section.\n### Insufficient quota\nA quota error occurs when a resource request exceeds your quota.\n**Error messages:**\n```\nRESOURCE_NAME creation failed:\nQuota QUOTA_NAME exceeded. Limit: QUOTA_LIMIT in region REGION\n```\n```\nRESOURCE_NAME creation failed:\nQuota QUOTA_NAME exceeded. Limit: QUOTA_LIMIT in zone ZONE\n```\n```\nResource exhausted (HTTP 429): QUOTA_EXCEEDED\n```\n**Resolution:** Request a higher quota limit. For more information, see [Requesting an increase in quota](/compute/quotas#requesting_additional_quota) .\n### Simultaneous resource mutation or creation operations\nIf you update more than one resource at a time, for example, modifying secondary ranges in a subnetwork and creating a VM at the same time, you might see a `not ready` error.\n**Error message** :\n```\nThe resource 'projects/PROJECT/regions/REGION/subnetworks/default' is not ready\n```\n**Resolution** : To resolve this issue, try the following:\n- [Wait for operations to be done](/compute/docs/api/best-practices#wait-for-operations) before creating new requests.\n- [Retry operations with exponential backoff](/compute/docs/api/best-practices#retry-with-exponential-backoff) .\n- [Poll operations](/compute/docs/api/how-tos/api-requests-responses#polling_operations) to check their completion status.\n### Resource availability\nThe following are examples of common resource errors that you might encounter when you request new Compute Engine resources or create new reservations:\n```\nZONE_RESOURCE_POOL_EXHAUSTED\n```\n```\nZONE_RESOURCE_POOL_EXHAUSTED_WITH_DETAILS\n```\n```\nThe zone 'projects/PROJECT_ID/zones/ZONE' does not have enough resources available to fulfill the request.\nTry a different zone, or try again later.\n```\n```\nA VM_TYPE_AND_SIZE VM instance with RESOURCE_ATTACHMENT is currently unavailable in the ZONE zone.\nCapacity changes frequently, so try your request in a different zone, with a different VM hardware\nconfiguration, or at a later time. For more options, see troubleshooting documentation.\n```\n```\nA VM_TYPE_AND_SIZE VM instance with RESOURCE_ATTACHMENT is currently unavailable in the ZONE zone, because of REASON.\nConsider trying your request in the ZONE zone(s), which currently has capacity to accommodate your request.\nIf you cannot move your VM to ZONE, review the REASON failure resolution instructions available in troubleshooting documentation, then try your request again.\nIf your workload can't accommodate the suggested resolution, try your request with a different VM hardware configuration or at a later time.\n```\nTo learn how to resolve resource errors, see [Troubleshooting resource availability errors](/compute/docs/troubleshooting/troubleshooting-resource-availability) .\n### Zone availability\nIf you receive a `notFound` or `does not exist in zone` error when requesting new resources, it means that the zone you are requesting the resource in does not offer the resource or machine type that you have requested.\n**Error messages** :\n```\nnotFound\n```\n```\ndoes not exist in zone\n```\n**Resolution** : See [Regions and zones](/compute/docs/regions-zones) to find out which features are available in each zone.\n### Rate exceeded for resource type\nThe following error occurs when you create more than one disk or VM from a snapshot in a ten minute period.\n**Error message** :\n```\n\"code\": \"RESOURCE_OPERATION_RATE_EXCEEDED\",\n\"message\": \"Operation rate exceeded for resource 'projects/project-id/zones/zone-id/disks/disk-name'. Too frequent operations from the source resource.\"\n```\n**Resolution** :\nTo create multiple disks from a snapshot, use the snapshot to create an image then create your disks from the image:\n- [Create an image from the snapshot](/compute/docs/images/create-delete-deprecate-private-images#create_image) .\n- [Create disks from the image](/compute/docs/disks/create-root-persistent-disks) .\nFor non-boot disks, follow the instructions to [create persistent disks from the image](/compute/docs/disks/add-persistent-disk) and use the following steps:\n- In the Google Cloud console, select **Image** as the disk **Source type** .\n- With the gcloud CLI, use the [image flag](/sdk/gcloud/reference/compute/disks/create#--image) .\n- If using REST, use the [sourceImage parameter](/compute/docs/reference/rest/v1/disks/insert) .\nFor more information about backing up and replicating your persistent disk data, see [Data protection options](/compute/docs/disks/data-protection) .\n### Insufficient permissions\nIf you receive a `permission` error when you try to create a VM, you don't have the necessary IAM permissions to create a VM.\n**Error message** :\n```\nError: googleapi: Error 403: Google Compute Engine: Required 'compute.regions.get' permission for 'projects/PROJECT_ID/regions/REGION'., forbidden\n```\n**Resolution** : Ask your organization administrator to grant you access to create VMs. For more information, see [Granting access to Compute Engine resources](/compute/docs/access/managing-access-to-resources#bind-member) .\n### Resource names\nIf you receive a `resource already exists` error when you try to create a resource, your creation request failed because you specified a non-unique name for the resource for the specified location and project.\n**Error messages** :\n```\nThe resource 'projects/PROJECT_NAME/zones/ZONE/RESOURCE_TYPE/RESOURCE_NAME' already exists\"\n```\n```\nThe resource 'projects/PROJECT_NAME/regions/REGION/RESOURCE_TYPE/RESOURCE_NAME' already exists\"\n```\n**Resolution** : Retry your creation request with a [unique resource name](/compute/docs/naming-resources#name_uniqueness) .\n### Network interfaces\nIf you receive a `Too many network interfaces` error when creating a VM, your request exceeded the network interface limit for the VM's machine type.\n**Error messages** :\n```\nInvalid value for field 'resource': \".\nToo many network interfaces. The maximum number of network interfaces allowed for this machine type is NUMBER.\n```\n```\nInvalid value for field 'resource.networkInterfaces': \".\nToo many network interfaces. The maximum number of network interfaces allowed for this machine type is NUMBER.\n```\n**Resolution** : To learn about how the maximum number of network interfaces is calculated for different machine types, see [Maximum number of network interfaces](/vpc/docs/create-use-multiple-interfaces#max-interfaces) .\n### Constraint violated\nIf you receive a `Constraint violated` error when creating a VM, your request violated one or more [organization policy constraints](/resource-manager/docs/organization-policy/org-policy-constraints#constraints-for-specific-services) .\n**Error message** :\nFor example, if your organization restricts Shared VPC subnetworks, you might get the following error:\n```\nConstraint constraints/compute.CONSTRAINT violated for projects/PROJECT_ID.\nUsing the PARAMETER projects/PROJECT_ID/regions/REGION/CONSTRAINTPROJECT_ID is not allowed.\n```\n**Resolution** : Contact your organization administrator.\n### Required CPU platform\nIf you receive a `required CPU platform` error, the CPU platform you specified in the creation request isn't supported by the specified machine type.\n**Error message** :\n```\nCould not fetch resource:\n- The selected machine type (MACHINE_TYPE) has a required CPU platform of REQUIRED_CPU_PLATFORM.\nThe minimum CPU platform must match this, but was SPECIFIED_CPU_PLATFORM.\n```\n**Resolution** :\n- To learn about which CPU platform your machine type supports, review [CPU platforms](/compute/docs/cpu-platforms) .\n- Retry your request with a supported CPU platform.\n### Creation failed\nThe following error might occur when you try to create a VM:\n```\nInstance 'Instance-name' creation failed: Internal error. Please try again or contact Google Support.\n(Code: NUMERIC_CODE)\n```\nThis error can occur for several reasons. The following is a common cause of this error:\n- You tried to create a VM that has gVNIC enabled on a [memory-optimized machine type](/compute/docs/machine-types#memory-optimized_machine_type_family) .gVNIC isn't supported on memory-optimized machine types. For more information about gVNIC, see [Using Google Virtual NIC](/compute/docs/networking/using-gvnic) .\n### Mismatched reservation properties\nIf you receive a `No available resources in specified reservations` error when creating a VM, the properties of the VM and the [specific reservation](/compute/docs/instances/reservations-overview#consumption-type) that the VM is targeting for consumption aren't matching.\n**Error message** :\n```\nInvalid value for field 'resource.reservationAffinity':\n- No available resources in specified reservations [RESERVATION_NAME].\n```\n**Resolution** : Try one of the following:\n- If the VM doesn't match the reservation's properties, modify the VM until its properties match the reservation's properties. Then, try creating the VM again.\n- If the VM has the right properties, but doesn't match the reservation's properties, you can't change the reservation. Instead, do one of the following:- When creating the VM, target a different specific reservation.You can create a new specific reservation with matching properties if you don't already have one with the correct properties. If you no longer need the previous specific reservation, then you can [delete it](/compute/docs/instances/reservations-delete) so you are no longer paying for those reserved resources.\n- When creating the VM, target any matching reservation.If there is a reservation configured for automatic consumption that has properties that match the VM, then the new VM consumes that reservation. Otherwise, the VM is still created, but without consuming any of your reserved resources.\nFor more information, see [Test that VM properties match a reservation](/compute/docs/instances/reservations-consume#test-properties-match) .\n### Service account access denied\nThe following error might appear in Cloud Audit Logs when you create VMs using a service account:\n**Error message** :\n```\nSERVICE_ACCOUNT_ACCESS_DENIED\n```\n**Resolution** : This error appears when the service account that is used to create a VM doesn't have the Identity and Access Management role to access the new VM's service account.\nGrant the [roles/iam.serviceAccountUser role](/compute/docs/access/iam#the_serviceaccountuser_role) to the service account that is creating the VM. You can either grant this role at the [project-level](/iam/docs/impersonating-service-accounts#impersonate-parent-level) , which would give the service account that is creating VMs access to all service accounts created in the project, or you can grant this role [only on the service account for the new VM](/iam/docs/impersonating-service-accounts#iam-service-accounts-grant-role-sa-console) .\n### Unknown error\nThe following error might occur when you try to create a VM:\n```\nRequest failed with unknown error\n```\nThis error can occur for several reasons. The following is a common cause of this error:\n- You tried to [create a new VM from an existing VM](/compute/docs/instances/create-vm-from-similar-instance) but you don't have read-access to the existing VM's boot disk image.To resolve this issue, contact the owner of the boot disk, and ask them to [share the existing VM's image with you](/compute/docs/images/managing-access-custom-images#share-images-between-organization) .\n### Free Trial\nIf you try to create a Windows VM during a [Free Trial of Google Cloud](/free/docs/gcp-free-tier#free-trial) you receive an error.\n**Error message** :\n```\nWindows VM instances are not included with free trial. To use them first enable billing on your account.\n```\n**Resolution** : Windows Server images aren't included in the Free Trial. [Upgrade to a paid Cloud Billing account](/free/docs/gcp-free-tier#how-to-upgrade) .\n### VM doesn't start\nIf a Linux VM that uses a startup script doesn't start after it was created, it might be related to an issue connecting to the metadata server.\nThis issue can last for up to seven minutes due to a transient network issue that resolves on its own. If the issue does not resolve itself after seven minutes, recreate the VM.\n## Errors when updating VMs\nIf you can't update a VM instance, it might be due to the following issue.\n### Error when changing the machine type\nThe following error might occur when you try to change the machine type of a VM:\n```\nInvalid value for field 'resource.sourceMachineImage': Updating 'sourceMachineImage' is not supported\n```\n**Resolution:**\n- Make sure that your VM supports the processor of the new machine type. For more information about the processors supported by different machine types, see [Machine family comparison](/compute/docs/machine-types#machine_type_comparison) .\n- Try to [change the machine type](/compute/docs/instances/changing-machine-type-of-stopped-instance#changing_a_machine_type) by using the Google Cloud CLI.## Errors when deleting VMs\nThis section describes errors you might encounter when you try to delete a VM.\n### Error deleting a VM when an attached disk has instant snapshots\nThe following errors might appear when you try to delete a VM and its attached disks if any of the VM's disks has instant snapshots.\n- ```\nInvalid resource usage: 'Auto delete disk with existing instant snapshot cannot be deleted.'.\n```\n- ```\nERROR: (gcloud.compute.disks.delete) Could not fetch resource:\nThe disk resource 'projects/<PROJECT_NAME/zones/<ZONE>/disks/<DISK_NAME>' is already being used by\n'projects/<PROJECT_NAME>/zones/<ZONE>/instantSnapshots/<INSTANT_SNAPSHOT_NAME>'\n```\n**Resolution**\nTo resolve the issue, choose one of the following options:\n- Delete the VM without deleting the attached disks:- Disable automatic disk deletion by following the steps in [Set the auto-delete state of a disk](/compute/docs/disks/modify-persistent-disk#updateautodelete) for each disk attached to the instance.\n- Delete the instance.\n- Delete the instance and the attached disks:- For each disk, [delete all its instant snapshots](/compute/docs/disks/create-instant-snapshots#delete_an_instant_snapshot) .\n- Delete the instance.", "guide": "Compute Engine"}