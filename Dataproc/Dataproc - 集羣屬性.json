{"title": "Dataproc - \u96c6\u7fa3\u5c6c\u6027", "url": "https://cloud.google.com/dataproc/docs/concepts/configuring-clusters/cluster-properties?hl=zh-cn", "abstract": "# Dataproc - \u96c6\u7fa3\u5c6c\u6027\n", "content": "## Apache Hadoop YARN\u3001HDFS\u3001Spark \u4ee5\u53ca\u76f8\u95dc\u5c6c\u6027\n\u5b89\u88dd\u5728 Dataproc \u96c6\u7fa3\u4e0a\u7684\u958b\u6e90\u7d44\u4ef6\u5305\u542b\u8a31\u591a\u914d\u7f6e\u6587\u4ef6\u3002\u4f8b\u5982\uff0cApache Spark \u548c Apache Hadoop \u5177\u6709\u4e00\u4e9b XML \u548c\u7d14\u6587\u672c\u914d\u7f6e\u6587\u4ef6\u3002\u60a8\u53ef\u4ee5\u5728\u5275\u5efa\u96c6\u7fa3\u6642\u4f7f\u7528 [gcloud dataproc clusters create](https://cloud.google.com/sdk/gcloud/reference/dataproc/clusters/create?hl=zh-cn) \u547d\u4ee4\u7684 `\u2011\u2011properties` \u6a19\u8a8c\u4f86\u4fee\u6539\u8a31\u591a\u5e38\u7528\u914d\u7f6e\u6587\u4ef6\u3002\n### \u683c\u5f0f\u8a2d\u7f6e\n`gcloud dataproc clusters create --properties` \u6a19\u8a8c\u63a5\u53d7\u4ee5\u4e0b\u5b57\u7b26\u4e32\u683c\u5f0f\uff1a\n```\nfile_prefix1:property1=value1,file_prefix2:property2=value2,...\n```\n- \u6620\u5c04\u5230\u9810\u5b9a\u7fa9\u7684\u914d\u7f6e\u6587\u4ef6\uff08\u5982\u4e0b\u8868\u6240\u793a\uff09\uff0c \u6620\u5c04\u5230\u8a72\u6587\u4ef6\u4e2d\u7684\u5c6c\u6027\u3002\n- \u7528\u65bc\u5206\u9694\u591a\u500b\u96c6\u7fa3\u5c6c\u6027\u7684\u9ed8\u8a8d\u5206\u9694\u7b26\u662f\u82f1\u6587\u9017\u865f (,)\u3002\u4f46\u662f\uff0c\u5982\u679c\u5c6c\u6027\u503c\u4e2d\u5305\u542b\u82f1\u6587\u9017\u865f\uff0c\u5247\u5fc5\u9808\u901a\u904e\u5728\u5c6c\u6027\u5217\u8868\u958b\u982d\u6307\u5b9a\u201c^ ^\u201d\u4f86\u66f4\u6539\u5206\u9694\u7b26\uff08\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [gcloud \u4e3b\u984c\u8f49\u7fa9](https://cloud.google.com/sdk/gcloud/reference/topic/escaping?hl=zh-cn) \uff09\u3002- \u4f7f\u7528\u201c#\u201d\u5206\u9694\u7b26\u7684\u793a\u4f8b\uff1a```\n--properties ^#^file_prefix1:property1=part1,part2#file_prefix2:property2=value2\n```\n### \u793a\u4f8b\n\u5982\u9700\u66f4\u6539 `spark-defaults.conf` \u6587\u4ef6\u4e2d\u7684 `spark.master` \u8a2d\u7f6e\uff0c\u8acb\u6dfb\u52a0\u4ee5\u4e0b `gcloud dataproc clusters create --properties` \u6a19\u8a8c\uff1a\n```\n--properties 'spark:spark.master=spark://example.com'\n```\n\u5229\u7528\u9017\u865f\u5206\u9694\u7b26\uff0c\u60a8\u53ef\u4ee5\u4e00\u6b21\u6027\u66f4\u6539\u4e00\u500b\u6216\u591a\u500b\u914d\u7f6e\u6587\u4ef6\u4e2d\u7684\u591a\u500b\u5c6c\u6027\u3002\u6bcf\u500b\u5c6c\u6027\u90fd\u5fc5\u9808\u4ee5\u5b8c\u6574\u7684 `file_prefix:property=value` \u683c\u5f0f\u6307\u5b9a\u3002\u4f8b\u5982\uff0c\u5982\u9700\u66f4\u6539 `spark-defaults.conf` \u6587\u4ef6\u4e2d\u7684 `spark.master` \u8a2d\u7f6e\u548c `hdfs-site.xml` \u6587\u4ef6\u4e2d\u7684 `dfs.hosts` \u8a2d\u7f6e\uff0c\u8acb\u5728\u5275\u5efa\u96c6\u7fa3\u6642\u4f7f\u7528\u4ee5\u4e0b `--properties` \u6a19\u8a8c\uff1a\n```\n--properties 'spark:spark.master=spark://example.com,hdfs:dfs.hosts=/foo/bar/baz'\n```\u8981\u5c07 `spark.executor.memory` \u8a2d\u7f6e\u7232 `10g` \uff0c\u8acb\u5728 [clusters.create](https://cloud.google.com/dataproc/docs/reference/rest/v1/projects.regions.clusters/create?hl=zh-cn) \u8acb\u6c42\u7684 [SoftwareConfig](https://cloud.google.com/static/dataproc/docs/reference/rest/v1/ClusterConfig?hl=zh-cn#SoftwareConfig.FIELDS.properties) \u90e8\u5206\u63d2\u5165\u4ee5\u4e0b `properties` \u8a2d\u7f6e\uff1a\n```\n\"properties\": {\n \"spark:spark.executor.memory\": \"10g\"\n}\n```\n\u5982\u9700\u67e5\u770b\u5982\u4f55\u69cb\u5efa Dataproc API \u96c6\u7fa3 REST \u8acb\u6c42\u7684 JSON \u6b63\u6587\uff0c\u4e00\u500b\u7c21\u55ae\u7684\u65b9\u6cd5\u662f\u4f7f\u7528 `--log-http` \u6a19\u8a18\u5553\u52d5\u7b49\u6548\u7684 `gcloud` \u547d\u4ee4\u3002\u4ee5\u4e0b\u662f\u4e00\u500b\u793a\u4f8b `gcloud dataproc clusters create` \u547d\u4ee4\uff0c\u8a72\u547d\u4ee4\u4f7f\u7528 `--properties spark:spark.executor.memory=10g` \u6a19\u8a8c\u8a2d\u7f6e\u96c6\u7fa3\u5c6c\u6027\u3002stdout \u65e5\u8a8c\u986f\u793a\u4e86\u751f\u6210\u7684 REST \u8acb\u6c42\u6b63\u6587\uff08 `properties` \u4ee3\u78bc\u6bb5\u5982\u4e0b\u6240\u793a\uff09\uff1a\n```\ngcloud dataproc clusters create my-cluster \\\n\u00a0\u00a0\u00a0\u00a0--region=region \\\n\u00a0\u00a0\u00a0\u00a0--properties=spark:spark.executor.memory=10g \\\n\u00a0\u00a0\u00a0\u00a0--log-http \\\n\u00a0\u00a0\u00a0\u00a0other args ...\n```\n **\u8f38\u51fa\uff1a** \n```\n...\n== body start ==\n{\"clusterName\": \"my-cluster\", \"config\": {\"gceClusterConfig\": ...\n\"masterConfig\": {... \"softwareConfig\": {\"properties\": {\"spark:spark.executor.memory\": \"10g\"}},\n...\n== body end ==\n...\n```\n\u5982\u679c\u60a8\u4e0d\u5e0c\u671b\u547d\u4ee4\u751f\u6548\uff0c\u8acb\u5728 JSON \u6b63\u6587\u51fa\u73fe\u5728\u8f38\u51fa\u4e2d\u5f8c **\u78ba\u4fdd\u53d6\u6d88\u8a72\u547d\u4ee4** \u3002\u8981\u66f4\u6539 `spark-defaults.conf` \u6587\u4ef6\u4e2d\u7684 `spark.master` \u8a2d\u7f6e\uff0c\u8acb\u6309\u4ee5\u4e0b\u6b65\u9a5f\u64cd\u4f5c\uff1a- \u5728 Google Cloud \u63a7\u5236\u6aaf\u4e2d\uff0c\u6253\u958b Dataproc \u7684 [\u5275\u5efa\u96c6\u7fa3](https://console.cloud.google.com/dataproc/clustersAdd?hl=zh-cn) \u9801\u9762\u3002\u9ede\u64ca\u201c\u81ea\u5b9a\u7fa9\u96c6\u7fa3\u201d\u9762\u677f\uff0c\u7136\u5f8c\u6efe\u52d5\u5230\u201c\u96c6\u7fa3\u5c6c\u6027\u201d\u90e8\u5206\u3002\n- \u9ede\u64ca **+ \u6dfb\u52a0\u5c6c\u6027** \u3002\u5728\u201c\u524d\u7db4\u201d\u5217\u8868\u4e2d\u9078\u64c7 **spark** \uff0c\u7136\u5f8c\u5728\u201c\u9375\u201d\u5b57\u6bb5\u6dfb\u52a0\u201cspark.master\u201d\u4e26\u5728\u201c\u503c\u201d\u5b57\u6bb5\u4e2d\u6dfb\u52a0\u8a2d\u7f6e\u3002\n### \u96c6\u7fa3\u8207\u4f5c\u696d\u5c6c\u6027\n\u7576\u60a8\u5275\u5efa\u96c6\u7fa3\u6642\uff0c\u7cfb\u7d71\u6703\u5728\u96c6\u7fa3\u7d1a\u5225\u61c9\u7528 Apache Hadoop YARN\u3001HDFS\u3001Spark \u548c\u5176\u4ed6\u6587\u4ef6\u524d\u7db4\u5c6c\u6027\u3002\u5275\u5efa\u96c6\u7fa3\u540e\uff0c\u9019\u4e9b\u5c6c\u6027\u7121\u6cd5\u61c9\u7528\u65bc\u96c6\u7fa3\u3002\u4e0d\u904e\uff0c\u5176\u4e2d\u8a31\u591a\u5c6c\u6027\u4e5f\u53ef\u61c9\u7528\u65bc\u7279\u5b9a\u4f5c\u696d\u3002 **\u5c07\u5c6c\u6027\u61c9\u7528\u65bc\u4f5c\u696d\u6642\uff0c\u4e0d\u4f7f\u7528\u6587\u4ef6\u524d\u7db4** \u3002\n\u4ee5\u4e0b\u793a\u4f8b\u5c07 Spark \u4f5c\u696d\u7684 Spark \u57f7\u884c\u5668\u5167\u5b58\u8a2d\u7f6e\u7232 4g\uff08\u7701\u7565\u4e86 `spark:` \u524d\u7db4\uff09\u3002\n```\ngcloud dataproc jobs submit spark \\\n\u00a0\u00a0\u00a0\u00a0--region=region \\\n\u00a0\u00a0\u00a0\u00a0--properties=spark.executor.memory=4g \\\n\u00a0\u00a0\u00a0\u00a0... other args ...\n```\n\u60a8\u53ef\u4ee5\u4f7f\u7528 `gcloud dataproc jobs submit` `` `--properties-file` \u6a19\u8a8c\u5728\u6587\u4ef6\u4e2d\u63d0\u4ea4\u4f5c\u696d\u5c6c\u6027\uff08\u4f8b\u5982\uff0c\u5982\u9700\u67e5\u770b Hadoop \u4f5c\u696d\u63d0\u4ea4\u7684 [--properties-file](https://cloud.google.com/sdk/gcloud/reference/dataproc/jobs/submit/hadoop?hl=zh-cn#--properties-file) \u8aaa\u660e\uff0c\u8acb\u53c3\u95b1\u6b64\u985e\uff09\u3002\n```\ngcloud dataproc jobs submit JOB_TYPE \\\n\u00a0\u00a0\u00a0\u00a0--region=region \\\n\u00a0\u00a0\u00a0\u00a0--properties-file=PROPERTIES_FILE \\\n\u00a0\u00a0\u00a0\u00a0... other args ...\n```\n`` \u662f\u4e00\u7d44\u4ee5\u63db\u884c\u7b26\u5206\u9694\u7684 `key` = `value` \u5c0d\u3002\u8981\u8a2d\u7f6e\u7684\u5c6c\u6027\u662f `key` \uff0c\u800c\u8981\u8a2d\u7f6e\u8a72\u5c6c\u6027\u7684\u503c\u7232 `value` \u3002\u6709\u95dc\u5c6c\u6027\u6587\u4ef6\u683c\u5f0f\u7684\u8a73\u7d30\u8aaa\u660e\uff0c\u8acb\u53c3\u95b1 [java.util.Properties](https://docs.oracle.com/javase/7/docs/api/java/util/Properties.html#load(java.io.Reader) \u985e\u3002\n\u4ee5\u4e0b\u662f\u4e00\u500b\u5c6c\u6027\u6587\u4ef6\u793a\u4f8b\uff0c\u60a8\u53ef\u4ee5\u5728\u63d0\u4ea4 Dataproc \u4f5c\u696d\u6642\u5c07\u5176\u50b3\u905e\u7d66 `--properties-file` \u6a19\u8a8c\u3002\n```\n dataproc:conda.env.config.uri=gs://some-bucket/environment.yaml\n spark:spark.history.fs.logDirectory=gs://some-bucket\n spark:spark.eventLog.dir=gs://some-bucket\n capacity-scheduler:yarn.scheduler.capacity.root.adhoc.capacity=5\n```\n### \u6587\u4ef6\u524d\u7db4\u5c6c\u6027\u8868\n| \u6587\u4ef6\u524d\u7db4   | \u6587\u4ef6      | \u6587\u4ef6\u7528\u9014        |\n|:-------------------|:--------------------------|:--------------------------------------|\n| capacity-scheduler | capacity-scheduler.xml | Hadoop YARN \u5bb9\u91cf\u8abf\u5ea6\u7a0b\u5e8f\u914d\u7f6e   |\n| core    | core-site.xml    | Hadoop \u5e38\u898f\u914d\u7f6e      |\n| distcp    | distcp-default.xml  | Hadoop \u5206\u4f48\u5f0f\u8907\u88fd\u914d\u7f6e     |\n| flink    | flink-conf.yaml   | Flink \u914d\u7f6e       |\n| flink-log4j  | log4j.properties   | Log4j \u8a2d\u7f6e\u6587\u4ef6      |\n| hadoop-env   | hadoop-env.sh    | Hadoop \u7279\u5b9a\u74b0\u5883\u8b8a\u91cf     |\n| hadoop-log4j  | log4j.properties   | Log4j \u8a2d\u7f6e\u6587\u4ef6      |\n| hbase    | hbase-site.xml   | HBase \u914d\u7f6e       |\n| hbase-log4j  | log4j.properties   | Log4j \u8a2d\u7f6e\u6587\u4ef6      |\n| hdfs    | hdfs-site.xml    | Hadoop HDFS \u914d\u7f6e      |\n| hive    | hive-site.xml    | Hive \u914d\u7f6e        |\n| hive-log4j2  | hive-log4j2.properties | Log4j \u8a2d\u7f6e\u6587\u4ef6      |\n| Hudi    | hudi-default.conf   | Hudi \u914d\u7f6e        |\n| mapred    | mapred-site.xml   | Hadoop MapReduce \u914d\u7f6e     |\n| mapred-env   | mapred-env.sh    | Hadoop MapReduce \u7279\u5b9a\u74b0\u5883\u8b8a\u91cf   |\n| pig    | pig.properties   | Pig \u914d\u7f6e        |\n| pig-log4j   | log4j.properties   | Log4j \u8a2d\u7f6e\u6587\u4ef6      |\n| presto    | config.properties   | Presto \u914d\u7f6e       |\n| presto-jvm   | jvm.config    | Presto \u7279\u5b9a\u7684 JVM \u914d\u7f6e    |\n| spark    | spark-defaults.conf  | Spark \u914d\u7f6e       |\n| spark-env   | spark-env.sh    | Spark \u7279\u5b9a\u74b0\u5883\u8b8a\u91cf     |\n| spark-log4j  | log4j.properties   | Log4j \u8a2d\u7f6e\u6587\u4ef6      |\n| tez    | tez-site.xml    | Tez \u914d\u7f6e        |\n| webcat-log4j  | webhcat-log4j2.properties | Log4j \u8a2d\u7f6e\u6587\u4ef6      |\n| yarn    | yarn-site.xml    | Hadoop YARN \u914d\u7f6e      |\n| yarn-env   | yarn-env.sh    | Hadoop YARN \u7279\u5b9a\u74b0\u5883\u8b8a\u91cf    |\n| zeppelin   | zeppelin-site.xml   | Zeppelin \u914d\u7f6e       |\n| zeppelin-env  | zeppelin-env.sh   | Zeppelin \u7279\u5b9a\u74b0\u5883\u8b8a\u91cf\uff08\u50c5\u9650\u53ef\u9078\u7d44\u4ef6\uff09 |\n| zeppelin-log4j  | log4j.properties   | Log4j \u8a2d\u7f6e\u6587\u4ef6      |\n| zookeeper   | zoo.cfg     | Zookeeper \u914d\u7f6e      |\n| zookeeper-log4j | log4j.properties   | Log4j \u8a2d\u7f6e\u6587\u4ef6      |\n**\u5099\u8a3b**\n- \u6709\u4e9b\u5c6c\u6027\u662f\u9810\u7559\u5c6c\u6027\uff0c\u4e0d\u80fd\u88ab\u66ff\u63db\uff0c\u56e0\u7232\u5b83\u5011\u6703\u5f71\u97ff Dataproc \u96c6\u7fa3\u7684\u529f\u80fd\u3002\u5982\u679c\u60a8\u5617\u8a66\u66f4\u6539\u9810\u7559\u5c6c\u6027\uff0c\u5247\u5728\u5275\u5efa\u96c6\u7fa3\u6642\uff0c\u60a8\u5c07\u6536\u5230\u932f\u8aa4\u6d88\u606f\u3002\n- \u60a8\u53ef\u4ee5\u6307\u5b9a\u591a\u9805\u66f4\u6539\uff0c\u53ea\u9700\u7528\u9017\u865f\u5206\u9694\u6bcf\u9805\u66f4\u6539\u5373\u53ef\u3002\n- `--properties`\u6a19\u8a18\u4e0d\u80fd\u4fee\u6539\u4e0a\u9762\u672a\u986f\u793a\u7684\u914d\u7f6e\u6587\u4ef6\u3002\n- \u7cfb\u7d71\u6703\u5148\u61c9\u7528\u5c0d\u5c6c\u6027\u505a\u51fa\u7684\u66f4\u6539\uff0c **\u7136\u5f8c** \u518d\u5553\u52d5\u96c6\u7fa3\u4e0a\u7684\u5b88\u8b77\u9032\u7a0b\u3002\n- \u5982\u679c\u6307\u5b9a\u7684\u5c6c\u6027\u5b58\u5728\uff0c\u5b83\u5c07\u88ab\u66f4\u65b0\u3002\u5982\u679c\u6307\u5b9a\u7684\u5c6c\u6027\u4e0d\u5b58\u5728\uff0c\u5b83\u5c07\u88ab\u6dfb\u52a0\u5230\u914d\u7f6e\u6587\u4ef6\u4e2d\u3002\n[](None)\n## Dataproc \u670d\u52d9\u5c6c\u6027\n\u672c\u90e8\u5206\u5217\u51fa\u7684\u5c6c\u6027\u7279\u5b9a\u65bc Dataproc\u3002\u9019\u4e9b\u5c6c\u6027\u53ef\u7528\u65bc\u9032\u4e00\u6b65\u914d\u7f6e Dataproc \u96c6\u7fa3\u7684\u529f\u80fd\u3002\n**\u6ce8\u610f** \uff1a\u9019\u4e9b\u96c6\u7fa3\u5c6c\u6027\u662f\u5728\u5275\u5efa\u96c6\u7fa3\u6642\u6307\u5b9a\u7684\u3002\u5275\u5efa\u96c6\u7fa3\u540e\uff0c\u7121\u6cd5\u6307\u5b9a\u6216\u66f4\u65b0\u5b83\u5011\u3002\n### \u683c\u5f0f\u8a2d\u7f6e\n`gcloud dataproc clusters create --properties` \u6a19\u8a8c\u63a5\u53d7\u4ee5\u4e0b\u5b57\u7b26\u4e32\u683c\u5f0f\uff1a\n```\nproperty_prefix1:property1=value1,property_prefix2:property2=value2,...\n```\n- \u7528\u65bc\u5206\u9694\u591a\u500b\u96c6\u7fa3\u5c6c\u6027\u7684\u9ed8\u8a8d\u5206\u9694\u7b26\u662f\u82f1\u6587\u9017\u865f (,)\u3002\u4f46\u662f\uff0c\u5982\u679c\u5c6c\u6027\u503c\u4e2d\u5305\u542b\u82f1\u6587\u9017\u865f\uff0c\u5247\u5fc5\u9808\u901a\u904e\u5728\u5c6c\u6027\u5217\u8868\u958b\u982d\u6307\u5b9a\u201c^ ^\u201d\u4f86\u66f4\u6539\u5206\u9694\u7b26\uff08\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [gcloud \u4e3b\u984c\u8f49\u7fa9](https://cloud.google.com/sdk/gcloud/reference/topic/escaping?hl=zh-cn) \uff09\u3002- \u4f7f\u7528\u201c#\u201d\u5206\u9694\u7b26\u7684\u793a\u4f8b\uff1a```\n--properties ^#^property_prefix1:property1=part1,part2#property_prefix2:property2=value2\n```**\u793a\u4f8b\uff1a**\n\u5275\u5efa\u96c6\u7fa3\u4e26\u5c07 [\u589e\u5f37\u7684\u9748\u6d3b\u6027\u6a21\u5f0f](https://cloud.google.com/dataproc/docs/concepts/configuring-clusters/flex?hl=zh-cn) \u8a2d\u7f6e\u7232 Spark \u4e3b\u5de5\u4f5c\u5668\u91cd\u6392\u3002\n```\ngcloud dataproc jobs submit spark \\\n\u00a0\u00a0\u00a0\u00a0--region=region \\\n\u00a0\u00a0\u00a0\u00a0--properties=dataproc:efm.spark.shuffle=primary-worker \\\n\u00a0\u00a0\u00a0\u00a0... other args ...\n```\n### Dataproc \u670d\u52d9\u5c6c\u6027\u8868\n| \u5c6c\u6027\u524d\u7db4 | \u5c6c\u6027               | \u503c          | \u8aaa\u660e                                                                                                                                             |\n|:-----------|:---------------------------------------------------------------|:------------------------------------------|:--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|\n| dataproc | agent.process.threads.job.min         | number         | Dataproc \u5728\u7dda\u7a0b\u6c60\u4e2d\u4f75\u767c\u904b\u884c\u7528\u6236\u4f5c\u696d\u9a45\u52d5\u7a0b\u5e8f\u3002\u8a72\u5c6c\u6027\u63a7\u5236\u7dda\u7a0b\u6c60\u4e2d\u6700\u5c0f\u7dda\u7a0b\u6578\u4ee5\u5be6\u73fe\u5feb\u901f\u5553\u52d5\uff0c\u5373\u4f7f\u6c92\u6709\u4f5c\u696d\u6b63\u5728\u904b\u884c\u4e5f\u662f\u5982\u6b64\uff08\u9ed8\u8a8d\u503c\uff1a10\uff09\u3002                                                                                                             |\n| dataproc | agent.process.threads.job.max         | number         | Dataproc \u5728\u7dda\u7a0b\u6c60\u4e2d\u4f75\u767c\u904b\u884c\u7528\u6236\u4f5c\u696d\u9a45\u52d5\u7a0b\u5e8f\u3002\u8a72\u5c6c\u6027\u63a7\u5236\u7dda\u7a0b\u6c60\u4e2d\u7684\u7dda\u7a0b\u6578\u91cf\u4e0a\u9650\uff0c\u5f9e\u800c\u9650\u5236\u6700\u5927\u4f75\u767c\u7528\u6236\u4f5c\u696d\u6578\u3002\u63d0\u9ad8\u8a72\u503c\u4ee5\u63d0\u9ad8\u4f75\u767c\u6027\uff08\u9ed8\u8a8d\u503c\uff1a100\uff09\u3002                                                                                                          |\n| dataproc | am.primary_only            | true \u6216 false        | \u5c07\u6b64\u5c6c\u6027\u8a2d\u7f6e\u7232 true \u53ef\u9632\u6b62\u61c9\u7528\u4e3b\u5be6\u4f8b\u5728 Dataproc \u96c6\u7fa3\u6436\u4f54\u5f0f\u5de5\u4f5c\u5668\u4e0a\u904b\u884c\u3002\u6ce8\u610f\uff1a\u6b64\u529f\u80fd\u50c5\u9069\u7528\u65bc Dataproc 1.2 \u53ca\u66f4\u9ad8\u7248\u672c\u3002\u9ed8\u8a8d\u503c\u7232 false\u3002                                                                                                            |\n| dataproc | conda.env.config.uri           | gs://<path>        | Conda \u74b0\u5883\u914d\u7f6e\u6587\u4ef6\u5728 Cloud Storage \u4e2d\u7684\u4f4d\u7f6e\u3002\u7cfb\u7d71\u5c07\u6839\u64da\u6b64\u6587\u4ef6\u5275\u5efa\u4e26\u6fc0\u6d3b\u65b0\u7684 Conda \u74b0\u5883\u3002\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1\u4f7f\u7528\u8207 Conda \u76f8\u95dc\u7684\u96c6\u7fa3\u5c6c\u6027\u3002\uff08\u9ed8\u8a8d\u503c\uff1aempty\uff09\u3002                                                                                                       |\n| dataproc | conda.packages             | Conda \u8edf\u4ef6\u5305        | \u6b64\u5c6c\u6027\u4ee5\u82f1\u6587\u9017\u865f\u5206\u9694\u7684\u5217\u8868\u5f62\u5f0f\u986f\u793a\uff0c\u5217\u8868\u4e2d\u5305\u542b\u8981\u5728 base Conda \u74b0\u5883\u4e2d\u5b89\u88dd\u7684\u7279\u5b9a\u7248\u672c\u7684 Conda \u8edf\u4ef6\u5305\u3002\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1\u4f7f\u7528\u8207 Conda \u76f8\u95dc\u7684\u96c6\u7fa3\u5c6c\u6027\u3002\uff08\u9ed8\u8a8d\u503c\uff1aempty\uff09\u3002                                                                                                    |\n| dataproc | dataproc.allow.zero.workers         | true \u6216 false        | \u5728 Dataproc clusters.create API \u8acb\u6c42\u4e2d\u5c07 SoftwareConfig \u5c6c\u6027\u8a2d\u7f6e\u7232 true\uff0c\u4ee5\u5275\u5efa\u55ae\u7bc0\u9ede\u96c6\u7fa3\uff0c\u5c07\u9ed8\u8a8d\u7684\u5de5\u4f5c\u5668\u6578\u91cf\u5f9e 2 \u66f4\u6539\u7232 0\uff0c\u4e26\u5c07\u5de5\u4f5c\u5668\u7d44\u4ef6\u653e\u7f6e\u5728\u4e3b\u5be6\u4f8b\u4e3b\u6a5f\u4e0a\u3002\u60a8\u4e5f\u53ef\u4ee5\u901a\u904e Google Cloud \u63a7\u5236\u6aaf\u6216 Google Cloud CLI \u5275\u5efa\u55ae\u7bc0\u9ede\u96c6\u7fa3\uff0c\u53ea\u9700\u5c07\u5de5\u4f5c\u5668\u6578\u91cf\u8a2d\u7f6e\u7232 0 \u5373\u53ef\u3002                                                                              |\n| dataproc | dataproc.alpha.master.nvdimm.size.gb       | 1500-6500         | \u8a2d\u7f6e\u503c\u6703\u5275\u5efa\u5177\u6709 Intel Optane DC \u6301\u4e45\u5b58\u5132\u5668\u7684 Dataproc \u4e3b\u5be6\u4f8b\u3002\u6ce8\u610f\uff1aOptane \u865b\u64ec\u6a5f\u53ea\u80fd\u5728 us-central1-f \u5340\u57df\u4e2d\u5275\u5efa\uff0c\u53ea\u6709 n1-highmem-96-aep \u6a5f\u5668\u985e\u578b\uff0c\u4e14\u53ea\u80fd\u5728\u767d\u540d\u55ae\u9805\u76ee\u4e2d\u5275\u5efa\u3002                                                                                                  |\n| dataproc: | dataproc.alpha.worker.nvdimm.size.gb       | 1500-6500         | \u8a2d\u7f6e\u503c\u6703\u5275\u5efa\u5177\u6709 Intel Optane DC \u6301\u4e45\u5b58\u5132\u5668\u7684 Dataproc \u5de5\u4f5c\u5668\u3002\u6ce8\u610f\uff1aOptane \u865b\u64ec\u6a5f\u53ea\u80fd\u5728 us-central1-f \u5340\u57df\u4e2d\u5275\u5efa\uff0c\u53ea\u6709 n1-highmem-96-aep \u6a5f\u5668\u985e\u578b\uff0c\u4e14\u53ea\u80fd\u5728\u767d\u540d\u55ae\u9805\u76ee\u4e2d\u5275\u5efa\u3002                                                                                                  |\n| dataproc: | dataproc.await-new-workers-service-registration    | true \u6216 false        | \u6b64\u5c6c\u6027\u9069\u7528\u65bc 2.0.49 \u7248\u53ca\u66f4\u9ad8\u7248\u672c\u7684\u5716\u7247\u3002\u9ed8\u8a8d\u503c\u7232 false\u3002\u5c07\u6b64\u5c6c\u6027\u8a2d\u7f6e\u7232 true \u53ef\u5728\u96c6\u7fa3\u5275\u5efa\u6216\u96c6\u7fa3\u7e31\u5411\u64f4\u5bb9\u671f\u9593\u7b49\u5f85\u65b0\u7684\u4e3b\u8981\u5de5\u4f5c\u5668\u8a3b\u518a\u670d\u52d9\u4e3b\u8981\u5de5\u4f5c\u5668\uff0c\u4f8b\u5982 HDFS NameNode \u548c YARN ResourceManager\uff08\u50c5\u76e3\u63a7 HDFS \u548c YARN \u670d\u52d9\uff09\u3002\u8a2d\u7f6e\u7232 true \u6642\uff0c\u5982\u679c\u65b0 worker \u7121\u6cd5\u8a3b\u518a\u5230 Service\uff0c\u7cfb\u7d71\u6703\u7232\u8a72 worker \u5206\u914d FAILED \u72c0\u614b\u3002\u5982\u679c\u96c6\u7fa3\u6b63\u5728\u7e31\u5411\u64f4\u5bb9\uff0c\u5247\u6703\u79fb\u9664\u5931\u6557\u7684\u5de5\u4f5c\u5668\u3002\u5982\u679c\u6b63\u5728\u5275\u5efa\u96c6\u7fa3\uff0c\u4e26\u4e14\u5df2\u5728 gcloud \u547d\u4ee4\u6216 API \u96c6\u7fa3\u5275\u5efa\u8acb\u6c42\u4e2d\u6307\u5b9a\u4e86 gcloud dataproc clusters create --action-on-failed-primary-workers=DELETE \u6a19\u8a8c\u6216 API actionOnFailedPrimaryWorkers=DELETE \u5b57\u6bb5\uff0c\u5247\u7cfb\u7d71\u6703\u79fb\u9664\u5931\u6557\u7684\u5de5\u4f5c\u5668\u3002 |\n| dataproc: | dataproc.beta.secure.multi-tenancy.user.mapping    | user-to-service account mappings   | \u6b64\u5c6c\u6027\u63a5\u53d7\u7528\u6236\u5230\u670d\u52d9\u8cec\u865f\u7684\u6620\u5c04\u5217\u8868\u3002\u6620\u5c04\u7684\u7528\u6236\u53ef\u4ee5\u4ee5\u9694\u96e2\u7684\u7528\u6236\u8eab\u4efd\u5c07\u4ea4\u4e92\u5f0f\u5de5\u4f5c\u8ca0\u8f09\u63d0\u4ea4\u5230\u96c6\u7fa3\uff08\u8acb\u53c3\u95b1\u57fa\u65bc Dataproc \u670d\u52d9\u8cec\u865f\u7684\u5b89\u5168\u591a\u79df\u6236\uff09\u3002                                                                                                           |\n| dataproc: | dataproc.cluster.caching          | true \u6216 false        | \u5553\u7528\u96c6\u7fa3\u7de9\u5b58\u5f8c\uff0c\u96c6\u7fa3\u6703\u7de9\u5b58 Spark \u4f5c\u696d\u8a2a\u554f\u7684 Cloud Storage \u6578\u64da\uff0c\u4ee5\u4fbf\u5728\u4e0d\u5f71\u97ff\u4e00\u81f4\u6027\u7684\u60c5\u6cc1\u4e0b\u63d0\u9ad8\u4f5c\u696d\u6027\u80fd\u3002\uff08\u9ed8\u8a8d\u503c\uff1afalse\uff09\u3002                                                                                                               |\n| dataproc | dataproc.cluster-ttl.consider-yarn-activity     | true \u6216 false        | \u5c0d\u65bc\u6620\u50cf\u7248\u672c 1.4.64+\u30011.5.39+ \u548c 2.0.13+\uff0c\u6b64\u5c6c\u6027\u7684\u9ed8\u8a8d\u503c true \u6703\u5c0e\u81f4\u5728\u96c6\u7fa3\u9810\u5b9a\u522a\u9664\u529f\u80fd\u78ba\u5b9a\u96c6\u7fa3\u7a7a\u9592\u6642\u9593\u6642\uff0c\u9664\u4e86\u8003\u616e Dataproc Jobs API \u6d3b\u52d5\u4e4b\u5916\uff0c\u9084\u6703\u8003\u616e YARN \u6d3b\u52d5\u3002\u5982\u679c\u7232\u6620\u50cf\u7248\u672c 1.4.64+\u30011.5.39+ \u548c 2.0.13+ \u8a2d\u7f6e\u7232 false\uff0c\u6216\u4f7f\u7528\u7248\u672c\u865f\u8f03\u4f4e\u7684\u6620\u50cf\uff0c\u5247\u50c5\u8003\u616e Dataproc Jobs API \u6d3b\u52d5\u3002\u5c0d\u65bc\u6620\u50cf\u7248\u672c 1.4.64+\u30011.5.39+\u30012.0.13+\uff0c\u9ed8\u8a8d\u503c\u7232 true\u3002                                                           |\n| dataproc | dataproc.conscrypt.provider.enable        | true \u6216 false        | \u5553\u7528\uff08true\uff09\u6216\u505c\u7528\uff08false\uff09Conscrypt\u4f5c\u7232\u4e3b\u8981 Java \u5b89\u5168\u63d0\u4f9b\u7a0b\u5e8f\u3002\u6ce8\u610f\uff1a\u9ed8\u8a8d\u60c5\u6cc1\u4e0b\uff0cDataproc 1.2 \u548c\u66f4\u9ad8\u7248\u672c\u4e2d\u5553\u7528\u4e86 Conscrypt\uff0c\u4f46\u5728 1.0/1.1 \u7248\u672c\u4e2d\u505c\u7528\u4e86\u6b64\u7d44\u4ef6\u3002                                                                                                      |\n| dataproc | dataproc.cooperative.multi-tenancy.user.mapping    | user-to-service account mappings   | \u6b64\u5c6c\u6027\u63a1\u7528\u4ee5\u9017\u865f\u5206\u9694\u7684\u7528\u6236\u5230\u670d\u52d9\u8cec\u865f\u6620\u5c04\u5217\u8868\u3002\u5982\u679c\u4f7f\u7528\u6b64\u5c6c\u6027\u96c6\u5275\u5efa\u96c6\u7fa3\uff0c\u7576\u7528\u6236\u63d0\u4ea4\u4f5c\u696d\u6642\uff0c\u96c6\u7fa3\u5c07\u5728\u901a\u904e Cloud Storage \u9023\u63a5\u5668\u8a2a\u554f Cloud Storage \u6642\u5617\u8a66\u6a21\u64ec\u76f8\u61c9\u7684\u670d\u52d9\u8cec\u865f\u3002\u6b64\u529f\u80fd\u9700\u8981 Cloud Storage \u9023\u63a5\u5668\u7248\u672c 2.1.4 \u6216\u66f4\u9ad8\u7248\u672c\u3002\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 Dataproc \u5408\u4f5c\u591a\u79df\u6236\u3002\uff08\u9ed8\u8a8d\uff1aempty\uff09\u3002                                                                        |\n| dataproc | dataproc:hudi.version           | Hudi \u7248\u672c         | \u8a2d\u7f6e\u8207\u53ef\u9078\u7684 Dataproc Hudi \u7d44\u4ef6\u642d\u914d\u4f7f\u7528\u7684 Hudi \u7248\u672c\u3002\u6ce8\u610f\uff1a\u6b64\u7248\u672c\u7531 Dataproc \u8a2d\u7f6e\u7232\u8207\u96c6\u7fa3\u6620\u50cf\u7248\u672c\u517c\u5bb9\u3002\u5982\u679c\u662f\u7528\u6236\u8a2d\u7f6e\u7684\uff0c\u7576\u6307\u5b9a\u7684\u7248\u672c\u8207\u96c6\u7fa3\u6620\u50cf\u4e0d\u517c\u5bb9\u6642\uff0c\u96c6\u7fa3\u5275\u5efa\u53ef\u80fd\u6703\u5931\u6557\u3002                                                                                                   |\n| dataproc | dataproc.lineage.enabled          | true          | \u5728 Dataproc \u96c6\u7fa3\u4e2d\u7232 Spark \u4f5c\u696d\u5553\u7528\u6578\u64da\u6cbf\u8972\u3002                                                                                                                                   |\n| dataproc | dataproc.localssd.mount.enable         | true \u6216 false        | \u662f\u5426\u5c07\u672c\u5730 SSD \u639b\u8f09\u7232 Hadoop/Spark \u81e8\u6642\u76ee\u9304\u548c HDFS \u6578\u64da\u76ee\u9304\uff08\u9ed8\u8a8d\u503c\uff1atrue\uff09\u3002                                                                                                                           |\n| dataproc | dataproc.logging.stackdriver.enable       | true \u6216 false        | \u5553\u7528\uff08true\uff09\u6216\u505c\u7528\uff08false\uff09Cloud Logging\uff08\u9ed8\u8a8d\u503c\uff1atrue\uff09\u3002\u5982\u9700\u77ad\u89e3\u76f8\u95dc\u8cbb\u7528\uff0c\u8acb\u53c3\u95b1 Cloud Logging \u50f9\u683c\u3002                                                                                                                    |\n| dataproc | dataproc.logging.stackdriver.job.driver.enable     | true \u6216 false        | \u5728 Cloud Logging \u4e2d\u5553\u7528 (true) \u6216\u505c\u7528 (false) Dataproc \u4f5c\u696d\u9a45\u52d5\u7a0b\u5e8f\u65e5\u8a8c\u3002\u8acb\u53c3\u95b1 Dataproc \u4f5c\u696d\u8f38\u51fa\u548c\u65e5\u8a8c\uff08\u9ed8\u8a8d\u503c\uff1afalse\uff09\u3002                                                                                                               |\n| dataproc | dataproc.logging.stackdriver.job.yarn.container.enable   | true \u6216 false        | \u5728 Cloud Logging \u4e2d\u5553\u7528\uff08true\uff09\u6216\u505c\u7528\uff08false\uff09YARN \u5bb9\u5668\u65e5\u8a8c\u3002\u8acb\u53c3\u95b1 Spark \u4f5c\u696d\u8f38\u51fa\u9078\u9805\u3002\uff08\u9ed8\u8a8d\uff1afalse\uff09\u3002                                                                                                                    |\n| dataproc | dataproc.master.custom.init.actions.mode      | RUN_BEFORE_SERVICES \u6216 RUN_AFTER_SERVICES | \u5c0d\u65bc 2.0 \u53ca\u66f4\u9ad8\u7248\u672c\u7684\u6620\u50cf\u96c6\u7fa3\uff0c\u5982\u679c\u8a2d\u7f6e\u7232 RUN_AFTER_SERVICES\uff0c\u5247\u4e3b\u5be6\u4f8b\u4e0a\u7684\u521d\u59cb\u5316\u64cd\u4f5c\u5c07\u5728\u521d\u59cb\u5316 HDFS \u4ee5\u53ca\u4f9d\u8cf4\u65bc HDFS \u7684\u6240\u6709\u670d\u52d9\u4e4b\u5f8c\u518d\u904b\u884c\u3002\u4f9d\u8cf4\u65bc HDFS \u7684\u670d\u52d9\u793a\u4f8b\u5305\u62ec\uff1aHBase\u3001Hive Server2\u3001Ranger\u3001Solr \u4ee5\u53ca Spark \u548c MapReduce \u6b77\u53f2\u8a18\u9304\u670d\u52d9\u5668\u3002\uff08\u9ed8\u8a8d\u503c\uff1aRUN_BEFORE_SERVICES\uff09\u3002                                                                          |\n| dataproc | dataproc.monitoring.stackdriver.enable       | true \u6216 false        | \u5553\u7528 (true) \u6216\u505c\u7528 (false) Monitoring \u4ee3\u7406\uff08\u9ed8\u8a8d\u503c\uff1afalse\uff09\u3002\u6b64\u5c6c\u6027\u5df2\u68c4\u7528\u3002\u8acb\u53c3\u95b1\u5553\u7528\u81ea\u5b9a\u7fa9\u6307\u6a19\u6536\u96c6\uff0c\u4ee5\u5728 Monitoring \u4e2d\u5553\u7528 Dataproc OSS \u6307\u6a19\u6536\u96c6\u529f\u80fd\u3002                                                                                                        |\n| dataproc | dataproc.scheduler.driver-size-mb        | number         | \u5e73\u5747\u9a45\u52d5\u7a0b\u5e8f\u5167\u5b58\u4f54\u7528\u91cf\uff0c\u7528\u65bc\u78ba\u5b9a\u96c6\u7fa3\u5c07\u904b\u884c\u7684\u4f75\u767c\u4f5c\u696d\u6578\u4e0a\u9650\u3002\u9ed8\u8a8d\u503c\u7232 1GB\u3002\u8f03\u5c0f\u7684\u503c\uff08\u5982 256\uff09\u53ef\u80fd\u9069\u7528\u65bc Spark \u4f5c\u696d\u3002                                                                                                                 |\n| dataproc | dataproc.scheduler.job-submission-rate       | number         | \u5982\u679c\u8d85\u904e\u6b64\u901f\u7387\uff0c\u5247\u4f5c\u696d\u6703\u53d7\u5230\u9650\u5236\u3002\u9ed8\u8a8d\u901f\u7387\u7232 1.0 QPS\u3002                                                                                                                                |\n| dataproc | dataproc.scheduler.max-concurrent-jobs       | number         | \u4f75\u767c\u4f5c\u696d\u6578\u4e0a\u9650\u3002\u5982\u679c\u5728\u5275\u5efa\u96c6\u7fa3\u6642\u672a\u8a2d\u7f6e\u6b64\u503c\uff0c\u5247\u4f75\u767c\u4f5c\u696d\u6578\u4e0a\u9650\u8a08\u7232 max((masterMemoryMb - 3584) / masterMemoryMbPerJob, 5)\u3002masterMemoryMb \u7531\u4e3b\u865b\u64ec\u6a5f\u7684\u6a5f\u5668\u985e\u578b\u78ba\u5b9a\u3002masterMemoryMbPerJob \u9ed8\u8a8d\u7232 1024\uff0c\u4e0d\u904e\u60a8\u53ef\u4ee5\u5728\u5275\u5efa\u96c6\u7fa3\u6642\u4f7f\u7528 dataproc:dataproc.scheduler.driver-size-mb \u96c6\u7fa3\u5c6c\u6027\u5c0d\u5176\u9032\u884c\u914d\u7f6e\u3002                                                                      |\n| dataproc | dataproc.scheduler.max-memory-used        | number         | \u53ef\u4ee5\u4f7f\u7528\u7684\u6700\u5927 RAM \u5bb9\u91cf\u3002\u5982\u679c\u7576\u524d\u7528\u91cf\u9ad8\u65bc\u6b64\u95be\u503c\uff0c\u5247\u7121\u6cd5\u5b89\u6392\u65b0\u4f5c\u696d\u3002\u9ed8\u8a8d\u503c\u7232 0.9 (90%)\u3002\u5982\u679c\u8a2d\u7f6e\u7232 1.0\uff0c\u7cfb\u7d71\u6703\u505c\u7528\u4e3b\u5167\u5b58\u5229\u7528\u7387\u4f5c\u696d\u9650\u5236\u3002                                                                                                            |\n| dataproc | dataproc.scheduler.min-free-memory.mb       | number         | Dataproc \u4f5c\u696d\u9a45\u52d5\u7a0b\u5e8f\u5728\u96c6\u7fa3\u4e0a\u5b89\u6392\u5176\u4ed6\u4f5c\u696d\u6240\u9700\u7684\u6700\u5c0f\u53ef\u7528\u5167\u5b58\u91cf\uff08\u4ee5\u5146\u5b57\u7bc0\u7232\u55ae\u4f4d\uff09\u3002\u9ed8\u8a8d\u503c\u7232 256 MB\u3002                                                                                                                     |\n| dataproc | dataproc.snap.enabled           | true \u6216 false        | \u5553\u7528\u6216\u505c\u7528 Ubuntu Snap \u5b88\u8b77\u7a0b\u5e8f\u3002\u9ed8\u8a8d\u503c\u7232 true\u3002\u5982\u679c\u8a2d\u7f6e\u7232 false\uff0c\u5247\u6620\u50cf\u4e2d\u9810\u5b89\u88dd\u7684 Snap \u8edf\u4ef6\u5305\u4e0d\u6703\u53d7\u5230\u5f71\u97ff\uff0c\u4f46\u81ea\u52d5\u5237\u65b0\u6703\u88ab\u505c\u7528\u3002\u9069\u7528\u65bc 1.4.71\u30011.5.46\u30012.0.20 \u53ca\u66f4\u9ad8\u7248\u672c\u7684 Ubuntu \u6620\u50cf\u3002                                                                                                |\n| dataproc | dataproc.worker.custom.init.actions.mode      | RUN_BEFORE_SERVICES      | \u5c0d\u65bc 2.0 \u7248\u4e4b\u524d\u7684\u6620\u50cf\u96c6\u7fa3\uff0c\u672a\u8a2d\u7f6e RUN_BEFORE_SERVICES\uff0c\u4f46\u7528\u6236\u53ef\u4ee5\u5728\u5275\u5efa\u96c6\u7fa3\u6642\u8a2d\u7f6e\u3002\u5c0d\u65bc 2.0+ \u6620\u50cf\u96c6\u7fa3\uff0c\u8a2d\u7f6e\u7232 RUN_BEFORE_SERVICES\uff0c\u4e26\u4e14\u8a72\u5c6c\u6027\u7121\u6cd5\u50b3\u905e\u7d66\u96c6\u7fa3\uff08\u7528\u6236\u4e0d\u80fd\u66f4\u6539\u6b64\u5c6c\u6027\uff09\u3002\u5982\u9700\u77ad\u89e3\u6b64\u8a2d\u7f6e\u7684\u5f71\u97ff\uff0c\u8acb\u53c3\u95b1\u91cd\u8981\u6ce8\u610f\u4e8b\u9805\u548c\u6307\u5357 - \u521d\u59cb\u5316\u8655\u7406\u3002                                                                                  |\n| dataproc | dataproc.yarn.orphaned-app-terality.enable      | true \u6216 false        | \u9ed8\u8a8d\u503c\u7232 true\u3002\u8a2d\u7f6e\u7232 false \u53ef\u9632\u6b62 Dataproc \u7d42\u6b62\u201c\u5b64\u7acb\u7684\u201dYARN \u61c9\u7528\u3002\u5982\u679c\u63d0\u4ea4 YARN \u61c9\u7528\u7684\u4f5c\u696d\u9a45\u52d5\u7a0b\u5e8f\u5df2\u7d93\u9000\u51fa\uff0cDataproc \u6703\u5c07\u8a72 YARN \u61c9\u7528\u8996\u7232\u5b64\u7acb\u61c9\u7528\u3002\u8b66\u544a\uff1a\u5982\u679c\u60a8\u4f7f\u7528 Spark \u96c6\u7fa3\u6a21\u5f0f (spark.submit.deployMode=cluster) \u4e26\u8a2d\u7f6e spark.yarn.submit.waitAppCompletion=false\uff0cSpark \u9a45\u52d5\u7a0b\u5e8f\u6703\u9000\u51fa\uff0c\u800c\u4e0d\u6703\u7b49\u5f85 YARN \u61c9\u7528\u5b8c\u6210\uff1b\u5728\u672c\u4f8b\u4e2d\uff0c\u8acb\u8a2d\u7f6e dataproc:dataproc.yarn.orphaned-app-termination.enable=false\u3002\u5982\u679c\u60a8\u63d0\u4ea4 Hive \u4f5c\u696d\uff0c\u9084\u8981\u5c07\u6b64\u5c6c\u6027\u8a2d\u7f6e\u7232 false\u3002                                |\n| dataproc | efm.spark.shuffle            | primary-worker       | \u5982\u679c\u8a2d\u7f6e\u7232 primary-worker\uff0cSpark Shuffle \u6578\u64da\u5c07\u5beb\u5165\u4e3b\u8981\u5de5\u4f5c\u5668\u201d\u3002\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 Dataproc \u589e\u5f37\u7684\u9748\u6d3b\u6a21\u5f0f\u3002                                                                                                                  |\n| dataproc | job.history.to-gcs.enabled          | true \u6216 false        | \u5141\u8a31\u5c07 MapReduce \u548c Spark \u6b77\u53f2\u8a18\u9304\u6587\u4ef6\u6301\u4e45\u5b58\u5132\u5230 Dataproc \u81e8\u6642\u5b58\u5132\u5340\u4e2d\uff08\u5c0d\u65bc\u5716\u7247\u7248\u672c 1.5+\uff0c\u9ed8\u8a8d\u503c\u7232 true\uff09\u3002\u7528\u6236\u53ef\u4ee5\u901a\u904e\u4ee5\u4e0b\u5c6c\u6027\u8986\u84cb\u4f5c\u696d\u6b77\u53f2\u8a18\u9304\u6587\u4ef6\u6301\u4e45\u6027\u7684\u4f4d\u7f6e\uff1amapreduce.jobhistory.done-dir\u3001mapreduce.jobhistory.intermediate-done-dir\u3001spark.eventLog.dir \u548c spark.history.fs.logDirectory\u5982\u9700\u77ad\u89e3\u8207 Dataproc \u4f5c\u696d\u6b77\u53f2\u8a18\u9304\u548c\u4e8b\u4ef6\u6587\u4ef6\u95dc\u806f\u7684\u9019\u4e9b\u5c6c\u6027\u548c\u5176\u4ed6\u96c6\u7fa3\u5c6c\u6027\uff0c\u8acb\u53c3\u95b1 Dataproc Persistent History Server\u3002                                         |\n| dataproc | jobs.file-backed-output.enable         | true \u6216 false        | \u914d\u7f6e Dataproc \u4f5c\u696d\uff0c\u4f7f\u5176\u8f38\u51fa\u50b3\u9001\u5230 /var/log/google-dataproc-job \u76ee\u9304\u4e2d\u7684\u81e8\u6642\u6587\u4ef6\u3002\u5fc5\u9808\u8a2d\u7f6e\u7232 true \u624d\u80fd\u5728 Cloud Logging \u4e2d\u5553\u7528\u4f5c\u696d\u9a45\u52d5\u7a0b\u5e8f\u65e5\u8a8c\u8a18\u9304\uff08\u9ed8\u8a8d\u503c\uff1atrue\uff09\u3002                                                                                                     |\n| dataproc | jupyter.listen.all.interfaces         | true \u6216 false        | \u7232\u4e86\u964d\u4f4e\u901a\u904e\u4e0d\u5b89\u5168\u7684\u7b46\u8a18\u672c\u670d\u52d9\u5668 API \u57f7\u884c\u9060\u7a0b\u4ee3\u78bc\u7684\u98a8\u96aa\uff0c\u6620\u50cf\u7248\u672c 1.3+ \u7684\u9ed8\u8a8d\u8a2d\u7f6e\u7232 false\uff1b\u7576\u5553\u7528\u7d44\u4ef6\u7db2\u95dc\u6642\uff0c\u8a72\u8a2d\u7f6e\u5c07\u9023\u63a5\u9650\u5236\u7232 localhost (127.0.0.1)\uff08\u5c0d\u65bc 2.0+ \u6620\u50cf\uff0c\u4e0d\u9700\u8981\u6fc0\u6d3b\u7d44\u4ef6\u7db2\u95dc\uff09\u3002\u901a\u904e\u5c07\u6b64\u5c6c\u6027\u8a2d\u7f6e\u7232 true \u4ee5\u5141\u8a31\u6240\u6709\u9023\u63a5\uff0c\u53ef\u4ee5\u66ff\u63db\u6b64\u9ed8\u8a8d\u8a2d\u7f6e\u3002                                                                                |\n| dataproc | jupyter.notebook.gcs.dir          | gs://<dir-path>       | Cloud Storage \u4e2d\u7528\u65bc\u4fdd\u5b58 Jupyter \u7b46\u8a18\u672c\u7684\u4f4d\u7f6e\u3002                                                                                                                                  |\n| dataproc | kerberos.beta.automatic-config.enable       | true \u6216 false        | \u8a2d\u7f6e\u7232 true \u6642\uff0c\u7528\u6236\u7121\u9700\u4f7f\u7528 --kerberos-root-principal-password \u548c --kerberos-kms-key-uri \u6a19\u8a8c\uff08\u9ed8\u8a8d\u503c\uff1afalse\uff09\u6307\u5b9a Kerberos Root \u4e3b\u8cec\u865f\u5bc6\u78bc\u3002\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1\u901a\u904e Kerberos \u5553\u7528 Hadoop \u5b89\u5168\u6a21\u5f0f\u3002                                                                                            |\n| dataproc | kerberos.cross-realm-trust.admin-server      | hostname/address       | \u9060\u7a0b\u7ba1\u7406\u670d\u52d9\u5668\uff08\u901a\u5e38\u8207 KDC \u670d\u52d9\u5668\u76f8\u540c\uff09\u7684\u4e3b\u6a5f\u540d/\u5730\u5740\u3002                                                                                                                                |\n| dataproc | kerberos.cross-realm-trust.kdc         | hostname/address       | \u9060\u7a0b KDC \u7684\u4e3b\u6a5f\u540d/\u5730\u5740\u3002                                                                                                                                        |\n| dataproc | kerberos.cross-realm-trust.realm        | realm name        | \u57df\u540d\u7531\u5927\u5beb\u7684 ASCII \u5b57\u7b26\u4e32\u69cb\u6210\u3002\u6b64\u57df\u540d\u901a\u5e38\u8207 DNS \u57df\u540d\uff08\u5927\u5beb\uff09\u76f8\u540c\u3002\u793a\u4f8b\uff1a\u5982\u679c\u6a5f\u5668\u547d\u540d\u7232\u201cmachine-id.example.west-coast.mycompany.com\u201d\uff0c\u5247\u95dc\u806f\u7684\u57df\u53ef\u6307\u5b9a\u7232\u201cEXAMPLE.WEST-COAST.MYCOMPANY.COM\u201d\u3002                                                                                               |\n| dataproc | kerberos.cross-realm-trust.shared-password.uri     | gs://<dir-path>       | KMS \u52a0\u5bc6\u5171\u4eab\u5bc6\u78bc\u5728 Cloud Storage \u4e2d\u7684\u4f4d\u7f6e\u3002                                                                                                                                   |\n| dataproc | kerberos.kdc.db.key.uri          | gs://<dir-path>       | \u5305\u542b KDC \u6578\u64da\u5eab\u4e3b\u5bc6\u9470\u7684 KMS \u52a0\u5bc6\u6587\u4ef6\u5728 Cloud Storage \u4e2d\u7684\u4f4d\u7f6e\u3002                                                                                                                              |\n| dataproc | kerberos.key.password.uri          | gs://<dir-path>       | \u5305\u542b\u5bc6\u9470\uff08\u5bc6\u9470\u5eab\u6587\u4ef6\u4e2d\uff09\u5bc6\u78bc\u7684 KMS \u52a0\u5bc6\u6587\u4ef6\u5728 Cloud Storage \u4e2d\u7684\u4f4d\u7f6e\u3002                                                                                                                            |\n| dataproc | kerberos.keystore.password.uri         | gs://<dir-path>       | \u5305\u542b\u5bc6\u9470\u5eab\u5bc6\u78bc\u7684 KMS \u52a0\u5bc6\u6587\u4ef6\u5728 Cloud Storage \u4e2d\u7684\u4f4d\u7f6e\u3002                                                                                                                                |\n| dataproc | kerberos.keystore.uri1           | gs://<dir-path>       | \u5305\u542b\u96c6\u7fa3\u7bc0\u9ede\u6240\u4f7f\u7528\u7684\u901a\u914d\u7b26\u8b49\u66f8\u548c\u79c1\u9470\u7684\u5bc6\u9470\u5eab\u6587\u4ef6\u5728 Cloud Storage \u4e2d\u7684\u4f4d\u7f6e\u3002                                                                                                                           |\n| dataproc | kerberos.kms.key.uri           | KMS key URI        | \u7528\u65bc\u89e3\u5bc6\u6839\u5bc6\u78bc\u7684 KMS \u5bc6\u9470\u7684 URI\uff0c\u4f8b\u5982 projects/project-id/locations/region/keyRings/key-ring/cryptoKeys/key\uff08\u8acb\u53c3\u95b1\u5bc6\u9470\u8cc7\u6e90 ID\uff09\u3002                                                                                                             |\n| dataproc | kerberos.root.principal.password.uri       | gs://<dir-path>       | Kerberos root \u4e3b\u9ad4\u7684 KMS \u52a0\u5bc6\u5bc6\u78bc\u5728 Cloud Storage \u4e2d\u7684\u4f4d\u7f6e\u3002                                                                                                                               |\n| dataproc | kerberos.tgt.lifetime.hours         | hours          | \u7968\u64da\u6388\u6b0a\u7968\u64da\u7684\u6700\u9577\u9031\u671f\u6642\u9593\u3002                                                                                                                                       |\n| dataproc | kerberos.truststore.password.uri        | gs://<dir-path>       | \u5305\u542b\u4fe1\u4efb\u5eab\u6587\u4ef6\u5bc6\u78bc\u7684 KMS \u52a0\u5bc6\u6587\u4ef6\u5728 Cloud Storage \u4e2d\u7684\u4f4d\u7f6e\u3002                                                                                                                               |\n| dataproc | kerberos.truststore.uri2          | gs://<dir-path>       | \u5305\u542b\u53d7\u4fe1\u8b49\u66f8\u7684 KMS \u52a0\u5bc6\u4fe1\u4efb\u5eab\u6587\u4ef6\u5728 Cloud Storage \u4e2d\u7684\u4f4d\u7f6e\u3002                                                                                                                               |\n| dataproc | pip.packages             | Pip \u8edf\u4ef6\u5305        | \u6b64\u5c6c\u6027\u4ee5\u82f1\u6587\u9017\u865f\u5206\u9694\u7684\u5217\u8868\u5f62\u5f0f\u986f\u793a\uff0c\u5217\u8868\u4e2d\u5305\u542b\u8981\u5728 base Conda \u74b0\u5883\u4e2d\u5b89\u88dd\u7684\u7279\u5b9a\u7248\u672c\u7684 Pip \u8edf\u4ef6\u5305\u3002\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1\u8207 Conda \u76f8\u95dc\u7684\u96c6\u7fa3\u5c6c\u6027\u3002\uff08\u9ed8\u8a8d\u503c\uff1aempty\uff09\u3002                                                                                                      |\n| dataproc | ranger.kms.key.uri            | KMS key URI        | \u7528\u65bc\u89e3\u5bc6 Ranger \u7ba1\u7406\u54e1\u7528\u6236\u5bc6\u78bc\u7684 KMS \u5bc6\u9470\u7684 URI\uff0c\u4f8b\u5982 projects/project-id/locations/region/keyRings/key-ring/cryptoKeys/key\uff08\u8acb\u53c3\u95b1\u5bc6\u9470\u8cc7\u6e90 ID\uff09\u3002                                                                                                         |\n| dataproc | ranger.admin.password.uri          | gs://<dir-path>       | Ranger \u7ba1\u7406\u54e1\u7528\u6236\u7684 KMS \u52a0\u5bc6\u5bc6\u78bc\u5728 Cloud Storage \u4e2d\u7684\u4f4d\u7f6e\u3002                                                                                                                               |\n| dataproc | ranger.db.admin.password.uri         | gs://<dir-path>       | Ranger \u6578\u64da\u5eab\u7ba1\u7406\u54e1\u7528\u6236\u7684 KMS \u52a0\u5bc6\u5bc6\u78bc\u5728 Cloud Storage \u4e2d\u7684\u4f4d\u7f6e\u3002                                                                                                                              |\n| dataproc | ranger.cloud-sql.instance.connection.name      | cloud sql instance connection name  | Cloud SQL \u5be6\u4f8b\u7684\u9023\u63a5\u540d\u7a31\uff0c\u4f8b\u5982 project-id:region:name.                                                                                                                                |\n| dataproc | ranger.cloud-sql.root.password.uri        | gs://<dir-path>       | Cloud SQL \u5be6\u4f8b\u7684\u6839\u7528\u6236\u7684 KMS \u52a0\u5bc6\u5bc6\u78bc\u5728 Cloud Storage \u4e2d\u7684\u4f4d\u7f6e\u3002                                                                                                                              |\n| dataproc | ranger.cloud-sql.use-private-ip        | true \u6216 false        | \u96c6\u7fa3\u5be6\u4f8b\u548c Cloud SQL \u5be6\u4f8b\u4e4b\u9593\u7684\u901a\u4fe1\u662f\u5426\u61c9\u901a\u904e\u5c08\u7528 IP\u9032\u884c\uff08\u9ed8\u8a8d\u503c\u7232 false\uff09\u3002                                                                                                                           |\n| dataproc | solr.gcs.path             | gs://<dir-path>       | \u7528\u4f5c Solr \u4e3b\u76ee\u9304\u7684 Cloud Storage \u8def\u5f91\u3002                                                                                                                                    |\n| dataproc | startup.component.service-binding-timeout.hadoop-hdfs-namenode | seconds         | \u5728\u78ba\u5b9a\u6210\u529f\u5553\u52d5\u4e4b\u524d\uff0cDataproc \u5553\u52d5\u8173\u672c\u5c07\u7b49\u5f85 hadoop-hdfs-namenode \u7d81\u5b9a\u5230\u7aef\u53e3\u7684\u6642\u9593\u3002\u6700\u5927\u53ef\u8b58\u5225\u503c\u7232 1800 \u79d2 (30 \u5206\u9418)\u3002                                                                                                                 |\n| dataproc | startup.component.service-binding-timeout.hive-metastore  | seconds         | \u5728\u78ba\u5b9a\u5176\u5553\u52d5\u6210\u529f\u4e4b\u524d\uff0cDataproc \u5553\u52d5\u8173\u672c\u7b49\u5f85 Hive-Metastore \u670d\u52d9\u7d81\u5b9a\u5230\u7aef\u53e3\u7684\u6642\u9593\u3002\u6700\u5927\u53ef\u8b58\u5225\u503c\u7232 1800 \u79d2 (30 \u5206\u9418)\u3002                                                                                                                 |\n| dataproc | startup.component.service-binding-timeout.hive-server2   | seconds         | \u5728\u78ba\u5b9a\u5176\u5553\u52d5\u6210\u529f\u4e4b\u524d\uff0cDataproc \u5553\u52d5\u8173\u672c\u7b49\u5f85 hive-server2 \u7d81\u5b9a\u5230\u7aef\u53e3\u7684\u6642\u9593\u3002\u6700\u5927\u53ef\u8b58\u5225\u503c\u7232 1800 \u79d2 (30 \u5206\u9418)\u3002                                                                                                                   |\n| dataproc | user-attribution.enabled          | true \u6216 false        | \u5c07\u6b64\u5c6c\u6027\u8a2d\u7f6e\u7232 true \u53ef\u5c07 Dataproc \u4f5c\u696d\u8207\u63d0\u4ea4\u8a72\u4f5c\u696d\u7684\u7528\u6236\u7684\u8eab\u4efd\u5c0d\u61c9\u8d77\u4f86\uff08\u9ed8\u8a8d\u503c\u7232 false\uff09\u3002                                                                                                                       |\n| dataproc | yarn.docker.enable            | true \u6216 false        | \u8a2d\u7f6e\u7232 true \u4ee5\u5553\u7528 YARN \u4e0a\u7684 Dataproc Docker \u529f\u80fd\uff08\u9ed8\u8a8d\u503c\u7232 false\uff09\u3002                                                                                                                             |\n| dataproc | yarn.docker.image            | docker image        | \u5553\u7528 Dataproc Docker on YARN \u529f\u80fd (dataproc:yarn.docker.enable=true) \u6642\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528\u6b64\u53ef\u9078\u5c6c\u6027\u4f86\u6307\u5b9a Docker \u6620\u50cf\uff08\u4f8b\u5982 dataproc:yarn.docker.image=gcr.io/project-id/image:1.0.1\uff09\u3002\u5982\u679c\u6307\u5b9a\uff0c\u5247\u7cfb\u7d71\u6703\u5728\u5275\u5efa\u96c6\u7fa3\u671f\u9593\u4e0b\u8f09\u8a72\u6620\u50cf\u4e26\u5c07\u5176\u7de9\u5b58\u5728\u96c6\u7fa3\u7684\u6240\u6709\u7bc0\u9ede\u4e0a\u3002                                                                               |\n| dataproc | yarn.log-aggregation.enabled         | true \u6216 false        | \u5141\u8a31\uff08true\uff09\u5728\u96c6\u7fa3\u7684 temp bucket \u4e0a\u5553\u7528 YARN \u65e5\u8a8c\u96c6\u5408\u3002\u5b58\u5132\u6876\u540d\u7a31\u7684\u683c\u5f0f\u5982\u4e0b\uff1adataproc-temp-<REGION>-<PROJECT_NUMBER>-<RANDOM_STRING>\u3002\uff08\u5c0d\u65bc\u5716\u7247\u7248\u672c 1.5+\uff0c\u9ed8\u8a8d\u503c\u7232 true\uff09\u3002\u6ce8\u610f\uff1a\u96c6\u7fa3\u88ab\u522a\u9664\u6642\uff0c\u8a72\u96c6\u7fa3\u7684\u81e8\u6642\u5b58\u5132\u6876\u4e0d\u6703\u88ab\u522a\u9664\u3002\u7528\u6236\u9084\u53ef\u4ee5\u901a\u904e\u8986\u84cb yarn.nodemanager.remote-app-log-dir YARN \u5c6c\u6027\u4f86\u8a2d\u7f6e\u5f59\u7e3d\u7684 YARN \u65e5\u8a8c\u4f4d\u7f6e\u3002                                                               |\n| Knox  | gateway.host             | ip address        | \u7232\u4e86\u964d\u4f4e\u901a\u904e\u4e0d\u5b89\u5168\u7684\u7b46\u8a18\u672c\u670d\u52d9\u5668 API \u57f7\u884c\u9060\u7a0b\u4ee3\u78bc\u7684\u98a8\u96aa\uff0c\u6620\u50cf\u7248\u672c 1.3+ \u7684\u9ed8\u8a8d\u8a2d\u7f6e\u7232 127.0.0.1\uff0c\u7576\u5553\u7528\u7d44\u4ef6\u7db2\u95dc\u6642\uff0c\u8a72\u8a2d\u7f6e\u5c07\u9023\u63a5\u9650\u5236\u7232 localhost\u3002\u9ed8\u8a8d\u8a2d\u7f6e\u53ef\u4ee5\u66ff\u63db\uff0c\u4f8b\u5982\uff0c\u5c07\u6b64\u5c6c\u6027\u8a2d\u7f6e\u7232 0.0.0.0 \u4ee5\u5141\u8a31\u6240\u6709\u9023\u63a5\u3002                                                                                          |\n| zeppelin | zeppelin.notebook.gcs.dir          | gs://<dir-path>       | Cloud Storage \u4e2d\u7528\u65bc\u4fdd\u5b58 Zeppelin \u7b46\u8a18\u672c\u7684\u4f4d\u7f6e\u3002                                                                                                                                  |\n| zeppelin | zeppelin.server.addr           | ip address        | \u7232\u4e86\u964d\u4f4e\u901a\u904e\u4e0d\u5b89\u5168\u7684\u7b46\u8a18\u672c\u670d\u52d9\u5668 API \u57f7\u884c\u9060\u7a0b\u4ee3\u78bc\u7684\u98a8\u96aa\uff0c\u6620\u50cf\u7248\u672c 1.3+ \u7684\u9ed8\u8a8d\u8a2d\u7f6e\u7232 127.0.0.1\uff0c\u7576\u5553\u7528\u7d44\u4ef6\u7db2\u95dc\u6642\uff0c\u8a72\u8a2d\u7f6e\u5c07\u9023\u63a5\u9650\u5236\u7232 localhost\u3002\u6b64\u9ed8\u8a8d\u8a2d\u7f6e\u53ef\u4ee5\u66ff\u63db\uff0c\u4f8b\u5982\uff0c\u5c07\u6b64\u5c6c\u6027\u8a2d\u7f6e\u7232 0.0.0.0 \u4ee5\u5141\u8a31\u6240\u6709\u9023\u63a5\u3002                                                                                          |\n**1** \u5bc6\u9470\u5eab\u6587\u4ef6\uff1a\u5bc6\u9470\u5eab\u6587\u4ef6\u5305\u542b SSL \u8b49\u66f8\u3002\u6587\u4ef6\u61c9\u7232 Java KeyStore (JKS) \u683c\u5f0f\u3002\u5728\u8907\u88fd\u5230\u865b\u64ec\u6a5f\u6642\uff0c\u5176\u5c07\u91cd\u547d\u540d\u7232 `keystore.jks` \u3002 SSL \u8b49\u66f8\u61c9\u7232\u9069\u7528\u65bc\u96c6\u7fa3\u4e2d\u6bcf\u500b\u7bc0\u9ede\u7684\u901a\u914d\u7b26\u8b49\u66f8\u3002\n**2** \u4fe1\u4efb\u5eab\u6587\u4ef6\uff1a\u4fe1\u4efb\u5eab\u6587\u4ef6\u61c9\u7232 Java KeyStore (JKS) \u683c\u5f0f\u3002\u5728\u8907\u88fd\u5230\u865b\u64ec\u6a5f\u6642\uff0c\u5176\u5c07\u91cd\u547d\u540d\u7232 `truststore.jks` \u3002", "guide": "Dataproc"}