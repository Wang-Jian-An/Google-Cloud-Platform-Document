{"title": "Dataproc - Dataproc Confidential Compute", "url": "https://cloud.google.com/dataproc/docs/concepts/configuring-clusters/confidential-compute", "abstract": "# Dataproc - Dataproc Confidential Compute\nYou can create a Dataproc cluster that uses [Compute Engine Confidential VMs](/confidential-computing/confidential-vm/docs/about-cvm) to provide inline memory encryption. Confidential VMs use the [N2D machine type](/compute/docs/machine-types#machine_family_categories) (with AMD Secure Encrypted Virtualization (SEV)).\n", "content": "## Create a cluster with confidential VMs\nTo create a Dataproc cluster that uses confidential VMs, use the `gcloud dataproc clusters create` command with the [--confidential-compute](/sdk/gcloud/reference/dataproc/clusters/create#--confidential-compute) , flag.\nRequirements:- The master and worker instances must use the [N2D machine type](/compute/docs/machine-types#machine_family_categories) (with AMD Secure Encrypted Virtualization (SEV)).\n- The cluster must use one of the [supported Ubuntu images](/dataproc/docs/concepts/versioning/dataproc-versions#ubuntu_images) .\n- The cluster must be created in a region and Compute Engine zone that supports   the **AMD EPYC Rome** CPU (N2D machine type) used by confidential VMs (see the **CPUs** column in [Available regions and zones](/compute/docs/regions-zones#available) ).  You can run the following command to list the CPUs supported in a  Compute Engine zone:```\ngcloud compute zones describe ZONE_NAME --format=\"value(availableCpuPlatforms)\"\n  \n```\n```\ngcloud dataproc clusters create cluster-name \\ \u00a0\n\u00a0\u00a0\u00a0\u00a0--confidential-compute \\ \u00a0\n\u00a0\u00a0\u00a0\u00a0--image-version=Ubuntu image version \\\n\u00a0\u00a0\u00a0\u00a0--region=region with zone that supports the AMD EPYC Rome CPU \\\n\u00a0\u00a0\u00a0\u00a0--zone=zone within the region that supports the AMD EPYC Rome CPU \\\n\u00a0\u00a0\u00a0\u00a0--master-machine-type=N2D machine type \\ \u00a0\n\u00a0\u00a0\u00a0\u00a0--worker-machine-type=N2D machine type\" \\ \u00a0\n\u00a0\u00a0\u00a0\u00a0other args ...\n```To create a Dataproc cluster that uses confidential VMs, include the [ConfidentialInstanceConfig](/dataproc/docs/reference/rest/v1/ClusterConfig#confidentialinstanceconfig) as part of a [clusters.create](/dataproc/docs/reference/rest/v1/projects.regions.clusters/create) request. Set `enableConfidentialCompute` to `true` .\nRequirements:- `masterConfig.machineTypeUri``masterConfig.machineTypeUri,`and, if applicable,`secondaryWorkerConfig.machineTypeUri:`Master and worker    instances must use the [N2D machine type](/compute/docs/machine-types#machine_family_categories) (with AMD Secure Encrypted Virtualization (SEV)).\n- `softwareConfig.imageVersion:`The cluster must use one of the [supported Ubuntu images](/dataproc/docs/concepts/versioning/dataproc-versions#ubuntu_images) .\n- `gceClusterConfig.zoneUri:`The cluster must be created in   a Compute Engine zone that supports the N2D **AMD EPYC Rome** CPU used by confidential VMs (see the **CPUs** column in [Available regions and zones](/compute/docs/regions-zones#available) ).  You can run the following command to list the CPUs supported in a  Compute Engine zone:```\ngcloud beta compute zones describe \"ZONE_NAME --format=\"value(availableCpuPlatforms)\"\n  \n```", "guide": "Dataproc"}