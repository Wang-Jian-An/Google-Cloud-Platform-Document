{"title": "Dataproc - \u5728 Dataproc \u4e0a\u7de8\u5beb\u4e26\u904b\u884c Spark Scala \u4f5c\u696d", "url": "https://cloud.google.com/dataproc/docs/tutorials/spark-scala?hl=zh-cn", "abstract": "# Dataproc - \u5728 Dataproc \u4e0a\u7de8\u5beb\u4e26\u904b\u884c Spark Scala \u4f5c\u696d\n\u672c\u6559\u7a0b\u4ecb\u7d39\u4e86\u5275\u5efa Spark Scala \u4f5c\u696d\u4e26\u5c07\u8a72\u4f5c\u696d\u63d0\u4ea4\u5230 Dataproc \u96c6\u7fa3\u7684\u4e0d\u540c\u65b9\u6cd5\uff0c\u5176\u4e2d\u5305\u62ec\u5982\u4f55\u57f7\u884c\u4ee5\u4e0b\u64cd\u4f5c\uff1a\n- \u4f7f\u7528 [Scala REPL](https://docs.scala-lang.org/overviews/) \uff08Read-Evaluate-Print-Loop \u6216\u4ea4\u4e92\u5f0f\u89e3\u91cb\u5668\uff09\u6216 [SBT](http://www.scala-sbt.org/index.html) \u69cb\u5efa\u5de5\u5177\uff0c\u901a\u904e\u547d\u4ee4\u884c\u5728\u672c\u5730\u6a5f\u5668\u4e0a\u7de8\u5beb\u548c\u7de8\u8b6f Spark Scala\u201cHello World\u201d\u61c9\u7528\n- \u5c07\u7d93\u904e\u7de8\u8b6f\u7684 Scala \u985e\u6253\u5305\u6210\u4e00\u500b\u5305\u542b\u6e05\u55ae\u7684 jar \u6587\u4ef6\n- \u5c07 Scala jar \u63d0\u4ea4\u5230\u5728 Dataproc \u96c6\u7fa3\u4e0a\u904b\u884c\u7684 Spark \u4f5c\u696d\n- \u5f9e Google Cloud \u63a7\u5236\u6aaf\u6aa2\u67e5 Scala \u4f5c\u696d\u8f38\u51fa\n\u672c\u6559\u7a0b\u9084\u5411\u60a8\u5c55\u793a\u77ad\u5982\u4f55\u57f7\u884c\u4ee5\u4e0b\u64cd\u4f5c\uff1a\n- \u4f7f\u7528 `spark-shell` REPL \u76f4\u63a5\u5728 Dataproc \u96c6\u7fa3\u4e0a\u7de8\u5beb\u548c\u904b\u884c Spark Scala\u201cWordCount\u201dmapreduce \u4f5c\u696d\n- \u5728\u96c6\u7fa3\u4e0a\u904b\u884c\u9810\u5148\u5b89\u88dd\u7684 Apache Spark \u548c Hadoop \u793a\u4f8b\n\u8acb\u6ce8\u610f\uff0c\u96d6\u7136\u672c\u6559\u7a0b\u4e2d\u7684\u547d\u4ee4\u884c\u793a\u4f8b\u5047\u8a2d\u4f7f\u7528\u7684\u662f Linux \u7d42\u7aef\u74b0\u5883\uff0c\u4f46\u8a31\u591a\u6216\u5927\u591a\u6578\u793a\u4f8b\u4e5f\u53ef\u4ee5\u5728 macOS \u6216 Windows \u7d42\u7aef\u7a97\u53e3\u4e2d\u7de8\u5beb\u904b\u884c\u3002\n", "content": "## \u8a2d\u7f6e Google Cloud Platform \u9805\u76ee\n\u5982\u679c\u60a8\u5c1a\u672a\u5c0d\u9805\u76ee\u9032\u884c\u8a2d\u7f6e\uff0c\u8acb\u6309\u4ee5\u4e0b\u6b65\u9a5f\u9032\u884c\u64cd\u4f5c\uff1a\n- [\u8a2d\u7f6e\u9805\u76ee](https://cloud.google.com/dataproc/docs/guides/setup-project?hl=zh-cn) \n- [\u5275\u5efa Cloud Storage \u5b58\u5132\u6876](https://console.cloud.google.com/project/_/storage?hl=zh-cn) \n- [\u5275\u5efa Dataproc \u96c6\u7fa3](https://cloud.google.com/dataproc/docs/guides/create-cluster?hl=zh-cn) ## \u5728\u672c\u5730\u7de8\u5beb\u548c\u7de8\u8b6f Scala \u4ee3\u78bc\n\u4f5c\u7232\u672c\u6559\u7a0b\u7684\u4e00\u500b\u7c21\u55ae\u7df4\u7fd2\uff0c\u8acb\u5728\u958b\u767c\u6a5f\u5668\u4e0a\u672c\u5730\u4f7f\u7528 [Scala REPL](http://docs.scala-lang.org/overviews/repl/overview.html) \u6216 [SBT](http://www.scala-sbt.org/index.html) \u547d\u4ee4\u884c\u754c\u9762\u7de8\u5beb\u201cHello World\u201dScala \u61c9\u7528\u3002\n- [\u4f7f\u7528 Scala](#use_scala) \n- [\u4f7f\u7528 SBT](#use_sbt) \n### \u4f7f\u7528 Scala\n- \u5f9e [Scala \u5b89\u88dd](http://www.scala-lang.org/download/install.html) \u9801\u9762\u4e0b\u8f09 Scala \u4e8c\u9032\u5236\u6587\u4ef6\n- \u5982 [Scala \u5b89\u88dd](http://www.scala-lang.org/download/install.html) \u8aaa\u660e\u4e2d\u6240\u793a\u90a3\u6a23\uff0c\u89e3\u58d3\u7e2e\u8a72\u6587\u4ef6\uff0c\u8a2d\u7f6e `SCALA_HOME` \u74b0\u5883\u8b8a\u91cf\uff0c\u4e26\u5c07\u5176\u6dfb\u52a0\u5230\u60a8\u7684\u8def\u5f91\u4e2d\u3002\u4f8b\u5982\uff1a```\nexport SCALA_HOME=/usr/local/share/scala\nexport PATH=$PATH:$SCALA_HOME/\n```\n- \u5553\u52d5 Scala REPL```\n$ scala\nWelcome to Scala version ...\nType in expressions to have them evaluated.\nType :help for more information.\nscala>\n```\n- \u5c07 `HelloWorld` \u4ee3\u78bc\u8907\u88fd\u4e26\u7c98\u8cbc\u5230 Scala REPL \u4e2d```\nobject HelloWorld {\u00a0 def main(args: Array[String]): Unit = {\u00a0 \u00a0 println(\"Hello, world!\")\u00a0 }}\n```\n- \u4fdd\u5b58 `HelloWorld.scala` \u4e26\u9000\u51fa REPL```\nscala> :save HelloWorld.scala\nscala> :q\n```\n- \u4f7f\u7528 `scalac` \u9032\u884c\u7de8\u8b6f```\n$ scalac HelloWorld.scala\n```\n- \u5217\u51fa\u5df2\u7de8\u8b6f\u7684 `.class` \u6587\u4ef6```\n$ ls HelloWorld*.class\nHelloWorld$.class HelloWorld.class\n```\n### \u4f7f\u7528 SBT\n- [\u4e0b\u8f09 SBT](http://www.scala-sbt.org/) \n- [\u5275\u5efa\u4e00\u500b\u201cHelloWorld\u201d\u9805\u76ee](http://www.scala-sbt.org/0.12.4/docs/Getting-Started/Hello.html) \uff0c\u5982\u4e0b\u6240\u793a```\n$ mkdir hello\n$ cd hello\n$ echo \\\n'object HelloWorld {def main(args: Array[String]) = println(\"Hello, world!\")}' > \\\nHelloWorld.scala\n```\n- \u5275\u5efa\u4e00\u500b `sbt.build` \u914d\u7f6e\u6587\u4ef6\uff0c\u4ee5\u5c07 `artifactName` \uff08\u60a8\u5c07\u5728\u4e0b\u9762\u751f\u6210\u7684 [jar \u6587\u4ef6](https://docs.oracle.com/javase/tutorial/deployment/jar/basicsindex.html) \u7684\u540d\u7a31\uff09\u8a2d\u7f6e\u7232\u201cHelloWorld.jar\u201d\uff08\u8acb\u53c3\u95b1 [\u4fee\u6539\u9ed8\u8a8d\u5de5\u4ef6](http://www.scala-sbt.org/0.12.2/docs/Detailed-Topics/Artifacts.html#modifying-default-artifacts) \uff09```\necho \\\n'artifactName := { (sv: ScalaVersion, module: ModuleID, artifact: Artifact) =>\n\"HelloWorld.jar\" }' > \\\nbuild.sbt\n```\n- \u5553\u52d5 SBT \u4e26\u904b\u884c\u4ee3\u78bc```\n$ sbt\n[info] Set current project to hello ...\n> run\n... Compiling 1 Scala source to .../hello/target/scala-.../classes...\n... Running HelloWorld\nHello, world!\n[success] Total time: 3 s ...\n```\n- \u5c07\u4ee3\u78bc\u6253\u5305\u6210\u5e36\u6709 [\u6307\u5b9a\u4e86\u4e3b\u985e\u5165\u53e3\u9ede](https://docs.oracle.com/javase/tutorial/deployment/jar/appman.html) ( `HelloWorld` ) \u7684\u6e05\u55ae\u7684 [ jar \u6587\u4ef6](https://docs.oracle.com/javase/tutorial/deployment/jar/basicsindex.html) \uff0c\u7136\u5f8c\u9000\u51fa```\n> package\n... Packaging .../hello/target/scala-.../HelloWorld.jar ...\n... Done packaging.\n[success] Total time: ...\n> exit\n```## \u5275\u5efa jar\n\u4f7f\u7528 `SBT` \u6216\u4f7f\u7528 [jar](https://docs.oracle.com/javase/tutorial/deployment/jar/build.html) \u547d\u4ee4\u5275\u5efa [jar \u6587\u4ef6](https://docs.oracle.com/javase/tutorial/deployment/jar/basicsindex.html) \u3002\n**\u4e0b\u8f09 Java\uff1f** \u7232\u4e86\u80fd\u5920\u904b\u884c [jar](https://docs.oracle.com/javase/8/docs/technotes/tools/unix/jar.html) \u547d\u4ee4\uff0c\u60a8\u7684\u6a5f\u5668\u4e0a\u5fc5\u9808\u5b89\u88dd Java SE\uff08\u6a19\u6e96\u7248\uff09JRE\uff08Java \u904b\u884c\u6642\u74b0\u5883\uff09- \u8acb\u53c3\u95b1 [Java SE \u4e0b\u8f09](http://www.oracle.com/technetwork/java/javase/downloads/index.html) \u3002### \u4f7f\u7528 SBT \u5275\u5efa jar\nSBT [\u8edf\u4ef6\u5305](http://www.scala-sbt.org/0.13/docs/Command-Line-Reference.html) \u547d\u4ee4\u53ef\u5275\u5efa jar \u6587\u4ef6\uff08\u8acb\u53c3\u95b1 [\u4f7f\u7528 SBT](#use_sbt) \uff09\u3002\n### \u624b\u52d5\u5275\u5efa jar\n- \u5c07\u76ee\u9304 (`cd`) \u66f4\u6539\u7232\u5305\u542b\u5df2\u7de8\u8b6f\u7684`HelloWorld*.class`\u6587\u4ef6\u7684\u76ee\u9304\uff0c\u7136\u5f8c\u904b\u884c\u4ee5\u4e0b\u547d\u4ee4\u5c07\u985e\u6587\u4ef6\u6253\u5305\u5230\u5728\u6e05\u55ae [\u6307\u5b9a\u4e86\u4e3b\u985e\u5165\u53e3\u9ede](https://docs.oracle.com/javase/tutorial/deployment/jar/appman.html) (`HelloWorld`) \u7684 jar \u4e2d\u3002```\n$ jar cvfe HelloWorld.jar HelloWorld HelloWorld*.class\nadded manifest\nadding: HelloWorld$.class(in = 637) (out= 403)(deflated 36%)\nadding: HelloWorld.class(in = 586) (out= 482)(deflated 17%)\n```\u89e3\u58d3\u7e2e\u4e26\u6aa2\u67e5 jar \u7684\u6e05\u55ae (`MANIFEST.MF`) \u5f8c\uff0c\u60a8\u6703\u767c\u73fe\u5b83\u5217\u51fa\u4e86`HelloWorld`\u4e3b\u985e\u5165\u53e3\u9ede\uff1a```\nManifest-Version: ...\nCreated-By: ...\nMain-Class: HelloWorld\n```## \u5c07 jar \u8907\u88fd\u5230 Cloud Storage\n- \u4f7f\u7528`gsutil`\u547d\u4ee4\u5c07 jar \u8907\u88fd\u5230\u9805\u76ee\u4e2d\u7684 Cloud Storage [\u5b58\u5132\u6876](https://cloud.google.com/storage/docs/buckets?hl=zh-cn) \n\u5c07\u5b58\u5132\u6876\u540d\u7a31\u50b3\u905e\u7d66`gsutil`\u6642\uff0c\u8acb\u78ba\u4fdd\u50c5\u5728`gs://`\u524d\u7db4\u5f8c\u9762\u6307\u5b9a\u5b58\u5132\u6876\u540d\u7a31\u3002\u4f8b\u5982\uff0c\u5982\u679c\u9805\u76ee\u5305\u542b\u201cmy-most-unique-bucket-name\u201d\u5b58\u5132\u6876\uff08\u5982\u4ee5\u4e0b [Google Cloud \u63a7\u5236\u6aaf Storage \u700f\u89bd\u5668](https://console.cloud.google.com/storage/browser?hl=zh-cn) \u5c4f\u5e55\u622a\u5716\u4e2d\u6240\u793a\uff09\uff0c\u4ee5\u4e0b\u547d\u4ee4\u5c07\u5217\u51fa\u8a72\u5b58\u5132\u6876\u7684\u5167\u5bb9\uff1a```\ngsutil ls gs://my-most-unique-bucket-name\n```\n```\n$ gsutil cp HelloWorld.jar gs://<bucket-name>/\nCopying file://HelloWorld.jar [Content-Type=application/java-archive]...\nUploading gs://bucket-name/HelloWorld.jar:   1.46 KiB/1.46 KiB\n```\n## \u5c07 jar \u63d0\u4ea4\u5230 Dataproc Spark \u4f5c\u696d\n- \u4f7f\u7528 [Google Cloud \u63a7\u5236\u6aaf](https://console.cloud.google.com/dataproc/jobs/jobsSubmit?hl=zh-cn) \u5c07 jar \u6587\u4ef6\u63d0\u4ea4\u5230\u60a8\u7684 Dataproc Spark \u4f5c\u696d\u3002\u6309\u5982\u4e0b\u6240\u793a\uff0c\u586b\u5beb **\u63d0\u4ea4\u4f5c\u696d** \u9801\u9762\u4e0a\u7684\u5b57\u6bb5\uff1a- \uff1a\u5f9e\u96c6\u7fa3\u5217\u8868\u4e2d\u9078\u64c7\u96c6\u7fa3\u540d\u7a31\n- \uff1aSpark\n- \u4e3b\u985e\u6216 jar \uff1a\u6307\u5b9a HelloWorld jar ( `gs://your-bucket-name/HelloWorld.jar` ) \u7684 Cloud Storage URI \u8def\u5f91\u3002\u5982\u679c jar \u4e0d\u5305\u542b\u6307\u5b9a\u4e86\u4ee3\u78bc\u5165\u53e3\u9ede\uff08\u201cMain-Class: HelloWorld\u201d\uff09\u7684\u6e05\u55ae\uff0c\u5247\u201c\u4e3b\u985e\u6216 jar\u201d\u5b57\u6bb5\u61c9\u8072\u660e\u4e3b\u985e\u7684\u540d\u7a31\uff08\u201cHelloWorld\u201d\uff09\uff0c\u800c\u60a8\u61c9\u4f7f\u7528 jar \u6587\u4ef6\u7684 URI \u8def\u5f91 ( `gs://your-bucket-name/HelloWorld.jar` ) \u586b\u5beb\u201cJar \u6587\u4ef6\u201d\u5b57\u6bb5\u3002\n- \u9ede\u64ca **\u63d0\u4ea4** \u4ee5\u5553\u52d5\u4f5c\u696d\u3002\u4f5c\u696d\u5553\u52d5\u5f8c\uff0c\u6703\u88ab\u6dfb\u52a0\u5230\u4f5c\u696d\u5217\u8868\u4e2d\u3002\n- \u9ede\u64ca\u201c\u4f5c\u696d ID\u201d\u4ee5\u6253\u958b **\u4f5c\u696d** \u9801\u9762\uff0c\u60a8\u53ef\u4ee5\u5728\u8a72\u9801\u9762\u4e2d\u67e5\u770b\u4f5c\u696d\u7684\u9a45\u52d5\u7a0b\u5e8f\u8f38\u51fa\u3002## \u4f7f\u7528\u96c6\u7fa3\u7684 spark-shell REPL \u7de8\u5beb\u4e26\u904b\u884c Spark Scala \u4ee3\u78bc\n\u5efa\u8b70\u60a8\u76f4\u63a5\u5728\u81ea\u5df1\u7684 Dataproc \u96c6\u7fa3\u4e0a\u958b\u767c Scala \u61c9\u7528\u3002Hadoop \u548c Spark \u9810\u5148\u5b89\u88dd\u5728 Dataproc \u96c6\u7fa3\u4e0a\uff0c\u4e26\u4e14\u5b83\u5011\u914d\u7f6e\u4e86 Cloud Storage \u9023\u63a5\u5668\uff0c\u8a72\u9023\u63a5\u5668\u5141\u8a31\u60a8\u7684\u4ee3\u78bc\u76f4\u63a5\u5f9e Cloud Storage \u8b80\u53d6\u6578\u64da\u4e26\u5c07\u6578\u64da\u5beb\u5165 Cloud Storage\u3002\n\u6b64\u793a\u4f8b\u5411\u60a8\u5c55\u793a\u77ad\u5982\u4f55\u901a\u904e SSH \u9023\u63a5\u5230\u9805\u76ee\u7684 Dataproc \u96c6\u7fa3\u4e3b\u7bc0\u9ede\uff0c\u7136\u5f8c\u4f7f\u7528 [spark-shell](http://spark.apache.org/docs/latest/quick-start.html#interactive-analysis-with-the-spark-shell) REPL \u5275\u5efa\u4e26\u904b\u884c Scala wordcount mapreduce \u61c9\u7528\u3002\n- \u901a\u904e SSH \u9023\u63a5\u5230 Dataproc \u96c6\u7fa3\u7684\u4e3b\u7bc0\u9ede- \u5728 Google Cloud \u63a7\u5236\u6aaf\u4e2d\uff0c\u8f49\u5230\u9805\u76ee\u7684 Dataproc [\u96c6\u7fa3](https://console.cloud.google.com/project/_/dataproc/clusters&tab=vm-instances?hl=zh-cn) \u9801\u9762\uff0c\u7136\u5f8c\u9ede\u64ca\u96c6\u7fa3\u7684\u540d\u7a31\u3002\n- \u5728\u96c6\u7fa3\u8a73\u60c5\u9801\u9762\u4e0a\uff0c\u9078\u64c7 **\u865b\u64ec\u6a5f\u5be6\u4f8b** \u6a19\u7c64\u9801\uff0c\u7136\u5f8c\u9ede\u64ca\u96c6\u7fa3\u540d\u7a31\u884c\u53f3\u5074\u7684 SSH \u9078\u9805\u3002\u6b64\u6642\u6703\u5728\u4e3b\u7bc0\u9ede\u4e0a\u7684\u4e3b\u76ee\u9304\u6253\u958b\u4e00\u500b\u700f\u89bd\u5668\u7a97\u53e3\n- \u5553\u52d5 `spark-shell` ```\n$ spark-shell\n...\nUsing Scala version ...\nType in expressions to have them evaluated.\nType :help for more information.\n...\nSpark context available as sc.\n...\nSQL context available as sqlContext.\nscala>\n```\n- \u5f9e\u4f4d\u65bc\u516c\u5171 Cloud Storage \u4e2d\u7684\u838e\u58eb\u6bd4\u4e9e\u4f5c\u54c1\u6587\u672c\u7247\u6bb5\u5275\u5efa [RDD](http://spark.apache.org/docs/latest/rdd-programming-guide.html#resilient-distributed-datasets-rdds) \uff08\u5f48\u6027\u5206\u4f48\u5f0f\u6578\u64da\u96c6\uff09\u838e\u58eb\u6bd4\u4e9e\u4f5c\u54c1\u6587\u672c\u7247\u6bb5\uff1a```\nWhat's in a name? That which we call a rose\nBy any other name would smell as sweet.\n``````\nscala> val text_file = sc.textFile(\"gs://pub/shakespeare/rose.txt\")\n```\n- \u91dd\u5c0d\u8a72\u6587\u672c\u904b\u884c\u5b57\u6578\u7d71\u8a08 mapreduce\uff0c\u7136\u5f8c\u986f\u793a `wordcounts` \u7d50\u679c```\nscala> val wordCounts = text_file.flatMap(line => line.split(\" \")).map(word =>\n(word, 1)).reduceByKey((a, b) => a + b)\nscala> wordCounts.collect\n... Array((call,1), (What's,1), (sweet.,1), (we,1), (as,1), (name?,1), (any,1), (other,1),\n(rose,1), (smell,1), (name,1), (a,2), (would,1), (in,1), (which,1), (That,1), (By,1))\n```\n- \u5c07\u8a08\u6578\u4fdd\u5b58\u5230 Cloud Storage \u4e2d\u7684 `<bucket-name>/wordcounts-out` \uff0c\u7136\u5f8c\u9000\u51fa `scala-shell` ```\nscala> wordCounts.saveAsTextFile(\"gs://<bucket-name>/wordcounts-out/\")\nscala> exit\n```\n- \u4f7f\u7528 `gsutil` \u5217\u51fa\u8f38\u51fa\u6587\u4ef6\u4e26\u986f\u793a\u6587\u4ef6\u5167\u5bb9```\n$ gsutil ls gs://bucket-name/wordcounts-out/\ngs://spark-scala-demo-bucket/wordcounts-out/\ngs://spark-scala-demo-bucket/wordcounts-out/_SUCCESS\ngs://spark-scala-demo-bucket/wordcounts-out/part-00000\ngs://spark-scala-demo-bucket/wordcounts-out/part-00001\n```\n- \u6aa2\u67e5 `gs://<bucket-name>/wordcounts-out/part-00000` \u5167\u5bb9```\n$ gsutil cat gs://bucket-name/wordcounts-out/part-00000\n(call,1)\n(What's,1)\n(sweet.,1)\n(we,1)\n(as,1)\n(name?,1)\n(any,1)\n(other,1)\n```## \u904b\u884c\u9810\u5148\u5b89\u88dd\u7684\u793a\u4f8b\u4ee3\u78bc\nDataproc \u4e3b\u7bc0\u9ede\u5305\u542b\u5177\u6709\u6a19\u6e96 Apache Hadoop \u548c Spark \u793a\u4f8b\u7684\u53ef\u904b\u884c jar \u6587\u4ef6\u3002\n| Jar \u985e\u578b | Master node /usr/lib/ location     | GitHub \u4f86\u6e90 | Apache \u6587\u6a94 |\n|:-----------|:-----------------------------------------------|:--------------|:---------------|\n| Hadoop  | hadoop-mapreduce/hadoop-mapreduce-examples.jar | \u4f86\u6e90\u93c8\u63a5  | MapReduce \u6559\u7a0b |\n| Spark  | spark/lib/spark-examples.jar     | \u4f86\u6e90\u93c8\u63a5  | Spark \u793a\u4f8b  |\n### \u901a\u904e\u547d\u4ee4\u884c\u5411\u96c6\u7fa3\u63d0\u4ea4\u793a\u4f8b\n\u60a8\u53ef\u4ee5\u4f7f\u7528 Google Cloud CLI `gcloud` \u547d\u4ee4\u884c\u5de5\u5177\u5f9e\u672c\u5730\u958b\u767c\u6a5f\u5668\u63d0\u4ea4\u793a\u4f8b\uff08\u8acb\u53c3\u95b1 [\u4f7f\u7528 Google Cloud \u63a7\u5236\u6aaf](https://cloud.google.com/dataproc/docs/guides/submit-job?hl=zh-cn#using_the_console_name) \u5f9e Google Cloud \u63a7\u5236\u6aaf\u63d0\u4ea4\u4f5c\u696d\uff09\u3002\n```\ngcloud dataproc jobs submit hadoop --cluster=cluster-name \\\n\u00a0\u00a0\u00a0\u00a0--region=region \\\n\u00a0\u00a0\u00a0\u00a0--jars=file:///usr/lib/hadoop-mapreduce/hadoop-mapreduce-examples.jar \\\n\u00a0\u00a0\u00a0\u00a0--class=org.apache.hadoop.examples.WordCount \\\n\u00a0\u00a0\u00a0\u00a0-- URI of input file URI of output file\n```\n```\ngcloud dataproc jobs submit spark --cluster=cluster-name \\\n\u00a0\u00a0\u00a0\u00a0--region=region \\\n\u00a0\u00a0\u00a0\u00a0--jars=file:///usr/lib/spark/examples/jars/spark-examples.jar \\\n\u00a0\u00a0\u00a0\u00a0--class=org.apache.spark.examples.JavaWordCount \\\n\u00a0\u00a0\u00a0\u00a0-- URI of input file\n```\n## \u95dc\u9589\u96c6\u7fa3\n\u7232\u907f\u514d\u4e0d\u65b7\u7522\u751f\u8cbb\u7528\uff0c\u8acb\u95dc\u9589\u672c\u6559\u7a0b\u4f7f\u7528\u7684\u96c6\u7fa3\u4e26\u522a\u9664 Cloud Storage \u8cc7\u6e90\uff08Cloud Storage \u5b58\u5132\u6876\u548c\u6587\u4ef6\uff09\u3002\n\u8981\u95dc\u9589\u96c6\u7fa3\uff0c\u8acb\u904b\u884c\u4ee5\u4e0b\u547d\u4ee4\uff1a\n```\ngcloud dataproc clusters delete cluster-name \\\n\u00a0\u00a0\u00a0\u00a0--region=region\n```\n\u8981\u522a\u9664 Cloud Storage jar \u6587\u4ef6\uff0c\u8acb\u904b\u884c\u4ee5\u4e0b\u547d\u4ee4\uff1a\n```\ngsutil rm gs://bucket-name/HelloWorld.jar\n```\n\u60a8\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u522a\u9664\u5b58\u5132\u6876\u53ca\u5176\u6240\u6709\u6587\u4ef6\u593e\u548c\u6587\u4ef6\uff1a\n```\ngsutil rm -r gs://bucket-name/\n```\n## \u5f8c\u7e8c\u6b65\u9a5f\n- \u95b1\u8b80 [\u5728 Dataproc \u4e0a\u7ba1\u7406 Apache Spark \u61c9\u7528\u7684 Java \u4f9d\u8cf4\u9805](https://cloud.google.com/dataproc/docs/guides/manage-spark-dependencies?hl=zh-cn) \u3002\n- \u8acb\u53c3\u95b1 [Spark \u4f5c\u696d\u5fae\u8abf\u63d0\u793a](https://cloud.google.com/dataproc/docs/support/spark-job-tuning?hl=zh-cn)", "guide": "Dataproc"}