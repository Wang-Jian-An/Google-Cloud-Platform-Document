{"title": "Dataproc - Dataproc \u6a5f\u5bc6\u8a08\u7b97", "url": "https://cloud.google.com/dataproc/docs/concepts/configuring-clusters/confidential-compute?hl=zh-cn", "abstract": "# Dataproc - Dataproc \u6a5f\u5bc6\u8a08\u7b97\n\u60a8\u53ef\u4ee5\u5275\u5efa\u4f7f\u7528 [Compute Engine \u6a5f\u5bc6\u865b\u64ec\u6a5f](https://cloud.google.com/confidential-computing/confidential-vm/docs/about-cvm?hl=zh-cn) \u4f86\u63d0\u4f9b\u5167\u5d4c\u5167\u5b58\u52a0\u5bc6\u7684 Dataproc \u96c6\u7fa3\u3002\u6a5f\u5bc6\u865b\u64ec\u6a5f\u4f7f\u7528 [N2D \u6a5f\u5668\u985e\u578b](https://cloud.google.com/compute/docs/machine-types?hl=zh-cn#machine_family_categories) \uff08\u642d\u914d AMD Secure Encrypted Virtualization (SEV)\uff09\u3002\n", "content": "## \u5275\u5efa\u5177\u6709\u6a5f\u5bc6\u865b\u64ec\u6a5f\u7684\u96c6\u7fa3\n\u5982\u9700\u5275\u5efa\u4f7f\u7528\u6a5f\u5bc6\u865b\u64ec\u6a5f\u7684 Dataproc \u96c6\u7fa3\uff0c\u8acb\u4f7f\u7528\u5e36\u6709 [--confidential-compute](https://cloud.google.com/sdk/gcloud/reference/dataproc/clusters/create?hl=zh-cn#--confidential-compute) \u6a19\u8a8c\u7684 `gcloud dataproc clusters create` \u547d\u4ee4\u3002\n\u8981\u6c42\uff1a- \u4e3b\u5be6\u4f8b\u548c\u5de5\u4f5c\u5668\u5be6\u4f8b\u5fc5\u9808\u4f7f\u7528 [N2D \u6a5f\u5668\u985e\u578b](https://cloud.google.com/compute/docs/machine-types?hl=zh-cn#machine_family_categories) \uff08\u642d\u914d AMD Secure Encrypted Virtualization (SEV)\uff09\u3002\n- \u96c6\u7fa3\u5fc5\u9808\u4f7f\u7528 [\u53d7\u652f\u6301\u7684 Ubuntu \u6620\u50cf](https://cloud.google.com/dataproc/docs/concepts/versioning/dataproc-versions?hl=zh-cn#ubuntu_images) \u4e4b\u4e00\u3002\n- \u5fc5\u9808\u5728\u652f\u6301\u6a5f\u5bc6\u865b\u64ec\u6a5f\u4f7f\u7528\u7684 **MD EPYC Rome** CPU\uff08N2D \u6a5f\u5668\u985e\u578b\uff09\u7684\u5730\u5340\u548c Compute Engine\u5340\u57df\u4e2d\u5275\u5efa\uff08\u8acb\u53c3\u95b1 [\u53ef\u7528\u7684\u5730\u5340\u548c\u5340\u57df](https://cloud.google.com/compute/docs/regions-zones?hl=zh-cn#available) \u4e2d\u7684 **CPU** \u5217\uff09\u3002\u60a8\u53ef\u4ee5\u904b\u884c\u4ee5\u4e0b\u547d\u4ee4\uff0c\u5217\u51fa Compute Engine \u5340\u57df\u652f\u6301\u7684 CPU\uff1a```\ngcloud compute zones describe ZONE_NAME --format=\"value(availableCpuPlatforms)\"\n  \n```\n```\ngcloud dataproc clusters create cluster-name \\ \u00a0\n\u00a0\u00a0\u00a0\u00a0--confidential-compute \\ \u00a0\n\u00a0\u00a0\u00a0\u00a0--image-version=Ubuntu image version \\\n\u00a0\u00a0\u00a0\u00a0--region=region with zone that supports the AMD EPYC Rome CPU \\\n\u00a0\u00a0\u00a0\u00a0--zone=zone within the region that supports the AMD EPYC Rome CPU \\\n\u00a0\u00a0\u00a0\u00a0--master-machine-type=N2D machine type \\ \u00a0\n\u00a0\u00a0\u00a0\u00a0--worker-machine-type=N2D machine type\" \\ \u00a0\n\u00a0\u00a0\u00a0\u00a0other args ...\n```\u5982\u9700\u5275\u5efa\u4f7f\u7528\u6a5f\u5bc6\u865b\u64ec\u6a5f\u7684 Dataproc \u96c6\u7fa3\uff0c\u8acb\u5c07 [ConfidentialInstanceConfig](https://cloud.google.com/dataproc/docs/reference/rest/v1/ClusterConfig?hl=zh-cn#confidentialinstanceconfig) \u5305\u62ec\u7232 [clusters.create](https://cloud.google.com/dataproc/docs/reference/rest/v1/projects.regions.clusters/create?hl=zh-cn) \u8acb\u6c42\u7684\u4e00\u90e8\u5206\u3002\u5c07 `enableConfidentialCompute` \u8a2d\u7f6e\u7232 `true` \u3002\n\u8981\u6c42\uff1a- `masterConfig.machineTypeUri``masterConfig.machineTypeUri,`\u548c`secondaryWorkerConfig.machineTypeUri:`\uff08\u5982\u679c\u9069\u7528\uff09\u4e3b\u5be6\u4f8b\u548c\u5de5\u4f5c\u5668\u5be6\u4f8b\u5fc5\u9808\u4f7f\u7528 [N2D \u6a5f\u5668\u985e\u578b](https://cloud.google.com/compute/docs/machine-types?hl=zh-cn#machine_family_categories) \uff08\u642d\u914d AMD Secure Encrypted Virtualization (SEV)\uff09\u3002\n- `softwareConfig.imageVersion:`\u96c6\u7fa3\u5fc5\u9808\u4f7f\u7528 [\u53d7\u652f\u6301\u7684 Ubuntu \u6620\u50cf](https://cloud.google.com/dataproc/docs/concepts/versioning/dataproc-versions?hl=zh-cn#ubuntu_images) \u4e4b\u4e00\u3002\n- `gceClusterConfig.zoneUri:`\u96c6\u7fa3\u5fc5\u9808\u5728\u652f\u6301\u6a5f\u5bc6\u865b\u64ec\u6a5f\u4f7f\u7528\u7684 N2D **AMD EPYC Rome** CPU \u7684 Compute Engine \u5340\u57df\u4e2d\u5275\u5efa\uff08\u8acb\u53c3\u95b1 [\u53ef\u7528\u7684\u5730\u5340\u548c\u5340\u57df](https://cloud.google.com/compute/docs/regions-zones?hl=zh-cn#available) \u4e2d\u7684 **CPU** \u5217\uff09\u3002\u60a8\u53ef\u4ee5\u904b\u884c\u4ee5\u4e0b\u547d\u4ee4\uff0c\u5217\u51fa Compute Engine \u5340\u57df\u652f\u6301\u7684 CPU\uff1a```\ngcloud beta compute zones describe \"ZONE_NAME --format=\"value(availableCpuPlatforms)\"\n  \n```", "guide": "Dataproc"}