{"title": "Dataproc - Dataproc \u53ef\u9078 Docker \u7d44\u4ef6", "url": "https://cloud.google.com/dataproc/docs/concepts/components/docker?hl=zh-cn", "abstract": "# Dataproc - Dataproc \u53ef\u9078 Docker \u7d44\u4ef6\n\u4f7f\u7528 [\u53ef\u9078\u7d44\u4ef6](https://cloud.google.com/dataproc/docs/concepts/components/overview?hl=zh-cn#available_optional_components) \u529f\u80fd\u5275\u5efa Dataproc \u96c6\u7fa3\u6642\uff0c\u60a8\u53ef\u4ee5\u5b89\u88dd\u5176\u4ed6\u7d44\u4ef6\uff0c\u4f8b\u5982 Docker\u3002\u672c\u9801\u9762\u4ecb\u7d39\u4e86 Docker \u7d44\u4ef6\u3002\nDataproc \u7d44\u4ef6\u6703\u5728\u6bcf\u500b\u96c6\u7fa3\u7bc0\u9ede\u4e0a\u5b89\u88dd\u4e00\u500b [Docker \u5b88\u8b77\u7a0b\u5e8f](https://docs.docker.com/get-started/overview/#the-docker-daemon) \uff0c\u4e26\u5728\u6bcf\u500b\u7bc0\u9ede\u4e0a\u5275\u5efa\u4e00\u500b Linux \u7528\u6236\u201cdocker\u201d\u548c\u4e00\u500b Linux \u7d44\u201cdocker\u201d\u4ee5\u904b\u884c Docker \u5b88\u8b77\u7a0b\u5e8f\u3002\u6b64\u7d44\u4ef6\u9084\u6703\u5275\u5efa\u4e00\u500b\u201cdocker\u201d [systemd](https://docs.docker.com/config/daemon/systemd/) \u670d\u52d9\u4ee5\u904b\u884c [dockerd](https://docs.docker.com/engine/reference/commandline/dockerd/) \u670d\u52d9\u3002\u5efa\u8b70\u60a8\u4f7f\u7528 `systemd` \u670d\u52d9\u4f86\u7ba1\u7406 Docker \u670d\u52d9\u7684\u751f\u547d\u9031\u671f\u3002\n", "content": "## \u5b89\u88dd\u7d44\u4ef6\n\u5728\u5275\u5efa Dataproc \u96c6\u7fa3\u6642\u5b89\u88dd\u7d44\u4ef6\u3002 \u53ef\u4ee5\u5c07 Docker \u7d44\u4ef6\u5b89\u88dd\u5728\u4f7f\u7528 Dataproc **\u6620\u50cf\u7248\u672c 1.5 \u6216\u66f4\u9ad8\u7248\u672c** \u5275\u5efa\u7684\u96c6\u7fa3\u4e0a\u3002\n\u5982\u9700\u67e5\u770b\u6bcf\u500b Dataproc \u6620\u50cf\u7248\u672c\u4e2d\u5305\u542b\u7684\u7d44\u4ef6\u7248\u672c\uff0c\u8acb\u53c3\u95b1 [\u652f\u6301\u7684 Dataproc \u7248\u672c](https://cloud.google.com/dataproc/docs/concepts/versioning/dataproc-versions?hl=zh-cn#supported_cloud_dataproc_versions) \u3002\n\u5982\u9700\u5275\u5efa\u5305\u542b Docker \u7d44\u4ef6\u7684 Dataproc \u96c6\u7fa3\uff0c\u8acb\u4f7f\u7528\u5e36\u6709 `--optional-components` \u6a19\u8a8c\u7684 [gcloud dataproc clusters create](https://cloud.google.com/sdk/gcloud/reference/dataproc/clusters/create?hl=zh-cn)  \u547d\u4ee4\u3002\n```\ngcloud dataproc clusters create cluster-name \\\n\u00a0\u00a0\u00a0\u00a0--optional-components=DOCKER \\\n\u00a0\u00a0\u00a0\u00a0--region=region \\\n\u00a0\u00a0\u00a0\u00a0--image-version=1.5 \\\n\u00a0\u00a0\u00a0\u00a0... other flags\n```\u53ef\u4ee5\u901a\u904e Dataproc API \u4f7f\u7528 [SoftwareConfig.Component](https://cloud.google.com/dataproc/docs/reference/rest/v1/ClusterConfig?hl=zh-cn#Component) \u5c07 Docker \u7d44\u4ef6\u6307\u5b9a\u7232 [clusters.create](https://cloud.google.com/dataproc/docs/reference/rest/v1/projects.regions.clusters/create?hl=zh-cn) \u8acb\u6c42\u7684\u4e00\u90e8\u5206\u3002\n- \u5553\u7528\u7d44\u4ef6\u3002- \u5728 Google Cloud \u63a7\u5236\u6aaf\u4e2d\uff0c\u6253\u958b Dataproc \u7684 [\u5275\u5efa\u96c6\u7fa3](https://console.cloud.google.com/dataproc/clustersAdd?hl=zh-cn) \u9801\u9762\u3002\u9078\u4e2d\u201c\u8a2d\u7f6e\u96c6\u7fa3\u201d\u9762\u677f\u3002\n- \u5728\u7d44\u4ef6\u90e8\u5206\u4e2d\u57f7\u884c\u4ee5\u4e0b\u64cd\u4f5c\uff1a\n- \u5728\u53ef\u9078\u7d44\u4ef6\u4e0b\uff0c\u9078\u64c7 Docker \u548c\u5176\u4ed6\u53ef\u9078\u7d44\u4ef6\u5b89\u88dd\u5728\u96c6\u7fa3\u4e0a\u3002## \u5728 YARN \u4e0a\u5553\u7528 Docker\n\u8acb\u53c3\u95b1 [\u4f7f\u7528 YARN \u4e0a\u7684 Docker \u81ea\u5b9a\u7fa9 Spark \u4f5c\u696d\u904b\u884c\u6642\u74b0\u5883](https://cloud.google.com/dataproc/docs/guides/dataproc-docker-yarn?hl=zh-cn) \uff0c\u4ee5\u5c07\u81ea\u5b9a\u7fa9 Docker \u6620\u50cf\u8207 YARN \u7d50\u5408\u4f7f\u7528\u3002\n## Docker \u65e5\u8a8c\u8a18\u9304\n\u9ed8\u8a8d\u60c5\u6cc1\u4e0b\uff0cDataproc Docker \u7d44\u4ef6\u901a\u904e [\u8a2d\u7f6e gcplogs driver](https://cloud.google.com/community/tutorials/docker-gcplogs-driver?hl=zh-cn#setting_the_default_logging_driver) \u5c07\u65e5\u8a8c\u5beb\u5165 Cloud Logging\uff0c\u8acb\u53c3\u95b1 [\u67e5\u770b\u65e5\u8a8c](https://cloud.google.com/community/tutorials/docker-gcplogs-driver?hl=zh-cn#viewing_your_logs) \u3002\n## Docker \u8a3b\u518a\u8868\n\u9664\u4e86\u9ed8\u8a8d\u7684 Docker \u8a3b\u518a\u8868\u5916\uff0cDataproc Docker \u7d44\u4ef6\u9084\u6703\u5c07 Docker \u914d\u7f6e\u7232\u4f7f\u7528 Container Registry\u3002Docker \u5c07\u4f7f\u7528 Docker \u6191\u64da\u5e6b\u52a9\u7a0b\u5e8f\u5411 Container Registry \u9032\u884c\u8eab\u4efd\u9a57\u8b49\u3002\n## \u4f7f\u7528 Kerberos \u96c6\u7fa3\u4e0a\u7684 Docker \u7d44\u4ef6\n\u53ef\u4ee5\u5c07 Docker \u53ef\u9078\u7d44\u4ef6\u5b89\u88dd\u5728 [\u5df2\u5553\u7528 Kerberos \u5b89\u5168](https://cloud.google.com/dataproc/docs/concepts/configuring-clusters/security?hl=zh-cn#enabling_hadoop_secure_mode_via_kerberos) \u7684\u60c5\u6cc1\u4e0b\u6240\u5275\u5efa\u7684\u96c6\u7fa3\u4e0a\u3002\nDocker \u4e0d\u5c6c\u65bc Hadoop \u751f\u614b\u7cfb\u7d71\uff0c\u4e26\u4e14\u672a\u88ab Hadoop \u670d\u52d9\u8b58\u5225\u3002\u5982\u679c\u60a8\u904b\u884c\u8207 Hadoop \u670d\u52d9\u76f4\u63a5\u901a\u4fe1\u7684\u5bb9\u5668\uff0c\u5247\u8a72\u5bb9\u5668\u5fc5\u9808\u5177\u6709\u6240\u9700\u7684 Kerberos keytab \u6587\u4ef6\u548c\u6191\u64da\u3002", "guide": "Dataproc"}