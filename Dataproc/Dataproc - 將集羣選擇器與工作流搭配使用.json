{"title": "Dataproc - \u5c07\u96c6\u7fa3\u9078\u64c7\u5668\u8207\u5de5\u4f5c\u6d41\u642d\u914d\u4f7f\u7528", "url": "https://cloud.google.com/dataproc/docs/concepts/workflows/cluster-selectors?hl=zh-cn", "abstract": "# Dataproc - \u5c07\u96c6\u7fa3\u9078\u64c7\u5668\u8207\u5de5\u4f5c\u6d41\u642d\u914d\u4f7f\u7528\n\u4f5c\u7232\u5728 [\u53d7\u7ba1\u96c6\u7fa3](https://cloud.google.com/dataproc/docs/concepts/workflows/using-workflows?hl=zh-cn#configuring_or_selecting_a_cluster) \u4e0a\u904b\u884c\u5de5\u4f5c\u6d41\u7684\u66ff\u4ee3\u65b9\u6cd5\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528\u96c6\u7fa3\u9078\u64c7\u5668\u7232\u5de5\u4f5c\u6d41\u9078\u64c7\u73fe\u6709\u96c6\u7fa3\u3002\u5728\u5de5\u4f5c\u6d41\u7d50\u675f\u6642\uff0c\u7cfb\u7d71\u4e0d\u6703\u522a\u9664\u9078\u5b9a\u7684\u96c6\u7fa3\u3002\n\u9078\u64c7\u5668\u6307\u5b9a\u4e00\u500b\u6216\u591a\u500b [Dataproc \u7528\u6236\u6a19\u7c64](https://cloud.google.com/dataproc/docs/concepts/labels?hl=zh-cn) \u3002\u5c0d\u65bc\u5176\u6a19\u7c64\u8207\u6240\u6709\u9078\u64c7\u5668\u6a19\u7c64\u5339\u914d\u7684\u5de5\u4f5c\u6d41\u4f86\u8aaa\uff0c\u8207\u5176\u4f4d\u65bc\u540c\u4e00 [\u5730\u5340](https://cloud.google.com/compute/docs/regions-zones?hl=zh-cn#available) \u7684\u96c6\u7fa3\u53ef\u4ee5\u904b\u884c\u5de5\u4f5c\u6d41\u4f5c\u696d\u3002\u5982\u679c\u591a\u500b\u96c6\u7fa3\u8207\u9078\u64c7\u5668\u5339\u914d\uff0cDataproc \u5c07\u9078\u64c7\u53ef\u7528 YARN \u5167\u5b58\u6700\u591a\u7684\u96c6\u7fa3\u3002\n", "content": "## \u5c07\u96c6\u7fa3\u9078\u64c7\u5668\u6dfb\u52a0\u5230\u6a21\u677f\u4e2d\n\u60a8\u53ef\u4ee5\u4f7f\u7528 Google Cloud CLI \u6216 Dataproc API \u5c07\u96c6\u7fa3\u9078\u64c7\u5668\u6dfb\u52a0\u5230\u5de5\u4f5c\u6d41\u6a21\u677f\u3002\n```\ngcloud dataproc workflow-templates set-cluster-selector template-id \\\n\u00a0\u00a0\u00a0\u00a0--region=region \\\n\u00a0\u00a0\u00a0\u00a0--cluster-labels=name=value[[,name=value]...]\n```\n\u8acb\u53c3\u95b1\n [WorkflowTemplatePlacement.ClusterSelector](https://cloud.google.com/dataproc/docs/reference/rest/v1/projects.locations.workflowTemplates?hl=zh-cn#clusterselector) \n\u3002\u6b64\u5b57\u6bb5\u662f\u4f7f\u7528\n [workflowTemplates.create](https://cloud.google.com/dataproc/docs/reference/rest/v1/projects.regions.workflowTemplates/create?hl=zh-cn) \n\u6216\n [workflowTemplates.update](https://cloud.google.com/dataproc/docs/reference/rest/v1/projects.regions.workflowTemplates/update?hl=zh-cn) \n\u8acb\u6c42\u63d0\u4ea4\u7684\u5df2\u5b8c\u6210\u7684\n [WorkflowTemplate](https://cloud.google.com/dataproc/docs/reference/rest/v1/projects.regions.workflowTemplates?hl=zh-cn#resource-workflowtemplate) \n\u7684\u4e00\u90e8\u5206\u3002\n\u60a8\u53ef\u4ee5\u5728 Google Cloud \u63a7\u5236\u6aaf\u7684 Dataproc [\u5de5\u4f5c\u6d41](https://console.cloud.google.com/dataproc/workflows/instances?hl=zh-cn) \u9801\u9762\u4e2d\u67e5\u770b\u73fe\u6709\u5de5\u4f5c\u6d41\u6a21\u677f\u548c\u5be6\u4f8b\u5316\u7684\u5de5\u4f5c\u6d41\u3002\n## \u4f7f\u7528\u81ea\u52d5\u61c9\u7528\u7684\u6a19\u7c64\n\u60a8\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u4efb\u4e00 [\u81ea\u52d5\u61c9\u7528\u7684\u96c6\u7fa3\u6a19\u7c64](https://cloud.google.com/dataproc/docs/concepts/labels?hl=zh-cn#automatically-applied_labels) \u5c07\u96c6\u7fa3\u9078\u64c7\u5668\u6307\u5411\u73fe\u6709\u96c6\u7fa3\uff1a\n- `goog-dataproc-cluster-name`\n- `goog-dataproc-cluster-uuid`\n**\u4f8b\u5982\uff1a**\n```\ngcloud dataproc workflow-templates set-cluster-selector template-id \\\n\u00a0\u00a0\u00a0\u00a0--region=region \\\n\u00a0\u00a0\u00a0\u00a0--cluster-labels=goog-dataproc-cluster-name=my-cluster\n```\n## \u5f9e\u96c6\u7fa3\u6c60\u4e2d\u9078\u64c7\n\u60a8\u53ef\u4ee5\u8b93 Dataproc \u5f9e\u96c6\u7fa3\u6c60\u4e2d\u9078\u64c7\u96c6\u7fa3\u3002 \u96c6\u7fa3\u6c60\u53ef\u4ee5\u4f7f\u7528\u6a19\u7c64\u9032\u884c\u5b9a\u7fa9\u3002\n**\u793a\u4f8b** \uff1a\n```\ngcloud dataproc clusters create cluster-1 --labels cluster-pool=pool-1 \\\n\u00a0\u00a0\u00a0\u00a0--region=region\ngcloud dataproc clusters create cluster-2 --labels cluster-pool=pool-1 \\\n\u00a0\u00a0\u00a0\u00a0--region=region\ngcloud dataproc clusters create cluster-3 --labels cluster-pool=pool-2 \\\n\u00a0\u00a0\u00a0\u00a0--region=region\n```\n\u5275\u5efa\u96c6\u7fa3\u540e...\n```\ngcloud dataproc workflow-templates create my-template \\\n\u00a0\u00a0\u00a0\u00a0--region=region\ngcloud dataproc workflow-templates set-cluster-selector my-template \\\n\u00a0\u00a0\u00a0\u00a0--region=region \\\n\u00a0\u00a0\u00a0\u00a0--cluster-labels=cluster-pool=pool-1\n```\n\u5de5\u4f5c\u6d41\u6703\u5728 cluster-1 \u6216 cluster-2 \u4e0a\u904b\u884c\uff0c\u4f46\u4e0d\u6703\u5728 cluster-3 \u4e0a\u904b\u884c\u3002", "guide": "Dataproc"}