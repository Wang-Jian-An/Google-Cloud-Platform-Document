{"title": "Dataproc - Dataproc Auto Zone placement", "url": "https://cloud.google.com/dataproc/docs/concepts/configuring-clusters/auto-zone", "abstract": "# Dataproc - Dataproc Auto Zone placement\nWhen you create a Dataproc cluster, cluster resources use a [regional endpoints](/dataproc/docs/concepts/regional-endpoints) based on [Compute Engine zones](/compute/docs/regions-zones/regions-zones#available) . When you choose a region, you can select a zone within that region, or you can omit the zone to have the Dataproc Auto Zone feature select a zone for you in the region you choose. Once a zone is selected, all nodes for that cluster will be deployed to that zone.\n", "content": "## Auto Zone and resource reservations\nAuto Zone prioritizes creating a cluster in a zone with [resource reservations](/compute/docs/instances/reservations-overview) , as follows:\n- If requested cluster resources can be fully satisfied by reserved, plus, if necessary, on-demand resources in a zone, Auto Zone will consume the reserved and on-demand resources, and create the cluster in that zone.\n- Auto Zone prioritizes zones for selection according to total CPU core ( `vCPU` ) reservations in a zone. **Example:** A cluster creation request specifies 20 `n2-standard-2` and 1 `n2-standard-64` (40 + 64 `vCPUs` requested). Auto Zone will prioritize the following zones for selection according to the total vCPU reservations available in the zone:- `zone-c`available reservations: 3`n2-standard-2`and 1`n2-standard-64`(70`vCPUs`)\n- `zone-b`available reservations: 1`n2-standard-64`(64`vCPUs`)\n- `zone-a` available reservations: 25 `n2-standard-2` (50 `vCPUs` )Assuming each of the above zones has additional on-demand `vCPU` and other resources sufficient to satisfy the cluster request, Auto Zone will select `zone-c` for cluster creation.\n- If requested cluster resources cannot be fully satisfied by reserved plus on-demand resources in a zone, Auto Zone will create the cluster in a zone that is most likely to satisfy the request using on-demand resources.## Using Auto Zone placement\nTo create a Dataproc cluster that uses Auto Zone placement:\n- In the Google Cloud console, open the Dataproc [Create a Dataproc cluster on Compute Engine](https://console.cloud.google.com/dataproc/clustersAdd) page. The **Set up cluster** panel is selected.\n- In the **Location** section:- Select a **Region** for your cluster.\n- Under **Zone** , select \"Any\".To create a Dataproc cluster that uses Auto Zone placement, use the [gcloud dataproc clusters create](/sdk/gcloud/reference/dataproc/clusters/create) command. Set the `--region` flag to a region, and omit the `--zone` flag (or leave the flag empty: `--zone=` or `zone=\"\"` ).\n **Note:** If you ran the`gcloud config set compute/` ``command to set a default zone, you must supply the`--zone=`or`zone=\"\"`flag to`gcloud dataproc clusters create`in order to enable the Auto Zone feature. [Power Shell](https://docs.microsoft.com/en-us/powershell/) users must surround the empty quotes with single quotes:`--zone='\"\"'`.\n```\ngcloud dataproc clusters create cluster-name \\\n\u00a0\u00a0\u00a0\u00a0--region=region \\\n\u00a0\u00a0\u00a0\u00a0--zone=\"\" \\\n\u00a0\u00a0\u00a0\u00a0other args ...\n```To create a Dataproc cluster that uses Auto Zone placement, construct a JSON [clusters.create](/dataproc/docs/reference/rest/v1/projects.regions.clusters/create) API request, leaving the [gceClusterConfig.zoneUri](/dataproc/docs/reference/rest/v1/ClusterConfig#GceClusterConfig) field empty. In the REST endpoint, `https://dataproc.googleapis.com/v1/projects/` `` `/regions/` `` `/clusters` , insert a region name. Dataproc Auto Zone will choose a zone for the cluster within the specified region.\n **Use short resource names with Auto Zone placement** : When specifying a resource URI, such as [machineTypeUri](/dataproc/docs/reference/rest/v1/ClusterConfig#InstanceGroupConfig) or [acceleratorTypeUri](/dataproc/docs/reference/rest/v1/ClusterConfig#acceleratorconfig) , in an Auto Zone placement REST API cluster creation request, use a short resource name without a zone specification, for example, \"n1-standard-2\" or \"nvidia-tesla-k80\".", "guide": "Dataproc"}