{"title": "Dataproc - Dataproc Spark \u6027\u80fd\u589e\u5f37\u529f\u80fd", "url": "https://cloud.google.com/dataproc/docs/guides/performance-enhancements?hl=zh-cn", "abstract": "# Dataproc - Dataproc Spark \u6027\u80fd\u589e\u5f37\u529f\u80fd\n\u672c\u6587\u6a94\u4ecb\u7d39\u5982\u4f55\u5553\u7528 Dataproc Spark \u6027\u80fd\u589e\u5f37\u529f\u80fd\uff0c\u4ee5\u5e6b\u52a9 Dataproc Spark \u4f5c\u696d\u5728\u66f4\u77ed\u7684\u6642\u9593\u5167\u8655\u7406\u66f4\u591a\u7684\u6578\u64da\uff0c\u4e26\u964d\u4f4e\u8cbb\u7528\u3002\nDataproc Spark \u6027\u80fd\u589e\u5f37\u529f\u80fd\u5305\u62ec\uff1a\n- Spark \u512a\u5316\u5668\u589e\u5f37\u529f\u80fd\uff1a- \u7de8\u5beb\u512a\u5316\u5668\u898f\u5247\uff0c\u6539\u5584 Spark \u8a08\u5283\n- \u6539\u9032\u4e86 Dataproc BigQuery \u9023\u63a5\u5668\u5728 Spark \u4f5c\u696d\u4e2d\u4f7f\u7528\u6642\u7684\u6027\u80fd\n- Spark Execution \u589e\u5f37\u529f\u80fd\uff1a- Spark \u57f7\u884c\u5f15\u64ce\u6539\u9032**\u5176\u4ed6 Dataproc \u6027\u80fd\u6539\u9032** \uff1a\u8acb\u53c3\u95b1 Dataproc [\u96c6\u7fa3\u7de9\u5b58](https://cloud.google.com/dataproc/docs/concepts/cluster-caching?hl=zh-cn) \uff0c\u77ad\u89e3\u5982\u4f55\u6e1b\u5c11\u8a2a\u554f Cloud Storage \u4e2d\u7684\u6578\u64da\u6240\u82b1\u8cbb\u7684\u6642\u9593\u3002\n**\u6ce8\u610f** \uff1a\u4f7f\u7528 2.0.69+\u30012.1.17+ \u548c\u66f4\u9ad8\u6620\u50cf\u7248\u672c\u5275\u5efa\u7684 Compute Engine \u4e0a\u7684 Dataproc \u63d0\u4f9b\u4e86\u4ee5\u4e0b\u90e8\u5206\u4e2d\u4ecb\u7d39\u7684\u589e\u5f37\u529f\u80fd\u3002\n", "content": "## \u5982\u4f55\u5553\u7528 Dataproc Spark \u6027\u80fd\u589e\u5f37\u529f\u80fd\n\u5728 Compute Engine \u96c6\u7fa3\u4e0a\u5275\u5efa Dataproc \u6216\u5c07 Spark \u4f5c\u696d\u63d0\u4ea4\u5230\u96c6\u7fa3\u6642\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528 Google Cloud \u63a7\u5236\u6aaf\u3001Google Cloud CLI \u548c Dataproc API \u4f86\u5553\u7528 Dataproc Spark \u6027\u80fd\u589e\u5f37\u529f\u80fd\u3002\n### \u5275\u5efa\u96c6\u7fa3\u6642\u5553\u7528\u589e\u5f37\u529f\u80fd\u5275\u5efa Dataproc \u96c6\u7fa3\u6642\uff0c\u8acb\u57f7\u884c\u4ee5\u4e0b\u6b65\u9a5f\u4ee5\u5553\u7528 Spark \u512a\u5316\u548c\u57f7\u884c\u589e\u5f37\u529f\u80fd\u3002\u5553\u7528\u7684\u589e\u5f37\u529f\u80fd\u5c0d\u63d0\u4ea4\u5230\u96c6\u7fa3\u7684\u6240\u6709 Spark \u4f5c\u696d\u4ecd\u7136\u6709\u6548\uff0c\u9664\u975e\u60a8\u5728\u63d0\u4ea4\u4f5c\u696d\u6642\u7232\u7279\u5b9a\u4f5c\u696d\u505c\u7528\u9019\u4e9b\u589e\u5f37\u529f\u80fd\u3002\u9ed8\u8a8d\u60c5\u6cc1\u4e0b\uff0cDataproc \u96c6\u7fa3\u4e0a\u6703\u505c\u7528 Dataproc Spark \u6027\u80fd\u589e\u5f37\u529f\u80fd\u3002\n **\u6ce8\u610f** \uff1a\u5982\u9700\u7232\u4f5c\u696d\u5553\u7528 Dataproc \u6027\u80fd\u589e\u5f37\u529f\u80fd\uff0c\u5fc5\u9808\u4f7f\u7528 2.0.69+ \u548c 2.1.17+ \u548c\u66f4\u9ad8\u7248\u672c\u7684\u6620\u50cf\u5275\u5efa\u4f5c\u696d\u96c6\u7fa3\u3002\u5728 Google Cloud \u63a7\u5236\u6aaf\u4e2d\u6253\u958b **\u5728 Compute Engine \u4e0a\u5275\u5efa Dataproc \u96c6\u7fa3** \u9801\u9762\u6642\uff0c **\u8a2d\u7f6e\u96c6\u7fa3** \u9762\u677f\u4e0a\u7684 **\u7248\u672c\u63a7\u5236** \u90e8\u5206\u6703\u5217\u51fa\u7528\u65bc\u5275\u5efa\u96c6\u7fa3\u7684\u9ed8\u8a8d **\u6620\u50cf\u985e\u578b\u548c\u7248\u672c** \u3002\u9ed8\u8a8d\u60c5\u6cc1\u4e0b\uff0c\u63a7\u5236\u6aaf\u4f7f\u7528\u6b64\u6620\u50cf\u7248\u672c\u7684\u6700\u65b0\u6b21\u8981\u7248\u672c\uff08\u8acb\u53c3\u95b1 [\u9ed8\u8a8d Dataproc \u6620\u50cf\u7248\u672c](https://cloud.google.com/dataproc/docs/concepts/versioning/dataproc-version-clusters?hl=zh-cn#default_dataproc_image_version) \uff09\u3002\n- \u5728 Google Cloud \u63a7\u5236\u6aaf\u4e2d\uff0c\u6253\u958b Dataproc [\u5275\u5efa\u96c6\u7fa3](https://console.cloud.google.com/dataproc/clustersAdd?hl=zh-cn) \u9801\u9762\u3002\n- \u5728 **\u5275\u5efa Dataproc \u96c6\u7fa3** \u8868\u55ae\u4e0a\uff0c\u9ede\u64ca **Compute Engine \u4e0a\u7684\u96c6\u7fa3** \u884c\u4e2d\u7684 **\u5275\u5efa** \u3002\n- \u5728 **\u5728 Compute Engine \u4e0a\u5275\u5efa Dataproc \u96c6\u7fa3** \u9801\u9762\u4e0a\uff0c\u9ede\u64ca **\u81ea\u5b9a\u7fa9\u96c6\u7fa3** \u9762\u677f\uff0c\u7136\u5f8c\u6efe\u52d5\u5230 **\u96c6\u7fa3\u5c6c\u6027** \u90e8\u5206\u3002- \u5982\u9700\u5553\u7528 Spark \u512a\u5316\u589e\u5f37\u529f\u80fd\uff0c\u8acb\u57f7\u884c\u4ee5\u4e0b\u64cd\u4f5c\uff1a- \u9ede\u64ca **+ \u6dfb\u52a0\u5c6c\u6027** \u3002\n- \u5728 **\u524d\u7db4** \u5217\u8868\u4e2d\u9078\u64c7 **spark** \uff0c\u7136\u5f8c\u5728 **\u9375** \u5b57\u6bb5\u4e2d\u6dfb\u52a0\u201cspark.dataproc.enhanced.optimize.enabled\u201d\u4e26\u5728 **\u503c** \u5b57\u6bb5\u4e2d\u6dfb\u52a0\u201ctrue\u201d\u3002\n- \u5982\u9700\u5553\u7528 Spark \u57f7\u884c\u589e\u5f37\u529f\u80fd\uff0c\u8acb\u57f7\u884c\u4ee5\u4e0b\u64cd\u4f5c\uff1a- \u9ede\u64ca **+ \u6dfb\u52a0\u5c6c\u6027** \u3002\n- \u5728 **\u524d\u7db4** \u5217\u8868\u4e2d\u9078\u64c7 **spark** \uff0c\u7136\u5f8c\u5728 **\u9375** \u5b57\u6bb5\u4e2d\u6dfb\u52a0\u201cspark.dataproc.enhanced.execution.enabled\u201d\uff0c\u4e26\u5728 **\u503c** \u5b57\u6bb5\u4e2d\u6dfb\u52a0\u201ctrue\u201d\u3002\n- \u586b\u5beb\u6216\u78ba\u8a8d\u5176\u4ed6\u96c6\u7fa3\u5275\u5efa\u5b57\u6bb5\uff0c\u7136\u5f8c\u9ede\u64ca **\u5275\u5efa** \u3002\n### \u63d0\u4ea4\u4f5c\u696d\u6642\u5553\u7528\u589e\u5f37\u529f\u80fd\u57f7\u884c\u4ee5\u4e0b\u6b65\u9a5f\u4f86\u7232 Spark \u4f5c\u696d\u5553\u7528 Spark \u512a\u5316\u548c\u57f7\u884c\u589e\u5f37\u529f\u80fd\u3002\u9ed8\u8a8d\u60c5\u6cc1\u4e0b\uff0c\u7cfb\u7d71\u6703\u5c0d Spark \u4f5c\u696d\u505c\u7528 Dataproc Spark \u6027\u80fd\u589e\u5f37\u529f\u80fd\uff0c\u9664\u975e\u60a8\u5728\u5275\u5efa\u4f5c\u696d\u96c6\u7fa3\u6216\u7232\u7279\u5b9a\u4f5c\u696d\u5553\u7528\u9019\u4e9b\u589e\u5f37\u529f\u80fd\u6642\u5553\u7528\u9019\u4e9b\u589e\u5f37\u529f\u80fd\u3002\n **\u6ce8\u610f** \uff1a\u5982\u9700\u7232\u4f5c\u696d\u5553\u7528 Dataproc \u6027\u80fd\u589e\u5f37\u529f\u80fd\uff0c\u4f5c\u696d\u96c6\u7fa3\u5fc5\u9808\u662f\u4f7f\u7528 2.0.69+ \u548c 2.1.17+ \u548c\u66f4\u9ad8\u6620\u50cf\u7248\u672c\u5275\u5efa\u7684\u3002- \u5728 Google Cloud \u63a7\u5236\u6aaf\u4e2d\uff0c\u6253\u958b Dataproc [\u4f5c\u696d](https://console.cloud.google.com/dataproc/jobs?hl=zh-cn) \u9801\u9762\u3002\n- \u5728 **\u4f5c\u696d** \u9801\u9762\u4e0a\uff0c\u9ede\u64ca **\u63d0\u4ea4\u4f5c\u696d** \uff0c\u7136\u5f8c\u6efe\u52d5\u5230\u4f5c\u696d **\u5c6c\u6027** \u90e8\u5206\u3002- \u5982\u9700\u5553\u7528 Spark \u512a\u5316\u589e\u5f37\u529f\u80fd\uff0c\u8acb\u57f7\u884c\u4ee5\u4e0b\u64cd\u4f5c\uff1a- \u9ede\u64ca **+ \u6dfb\u52a0\u5c6c\u6027** \u3002 \u5728 **\u9375** \u5b57\u6bb5\u4e2d\u6dfb\u52a0\u201cspark.dataproc.enhanced.optimize.enabled\u201d\uff0c\u4e26\u5728 **\u503c** \u5b57\u6bb5\u4e2d\u6dfb\u52a0\u201ctrue\u201d\u3002\n- \u5982\u9700\u5553\u7528 Spark \u57f7\u884c\u589e\u5f37\u529f\u80fd\uff0c\u8acb\u57f7\u884c\u4ee5\u4e0b\u64cd\u4f5c\uff1a- \u9ede\u64ca **+ \u6dfb\u52a0\u5c6c\u6027** \u3002\n- \u5728 **\u9375** \u5b57\u6bb5\u4e2d\u6dfb\u52a0\u201cspark.dataproc.enhanced.execution.enabled\u201d\uff0c\u4e26\u5728 **\u503c** \u5b57\u6bb5\u4e2d\u6dfb\u52a0\u201ctrue\u201d\u3002\n- \u586b\u5beb\u6216\u78ba\u8a8d\u5176\u4ed6\u4f5c\u696d\u63d0\u4ea4\u5b57\u6bb5\uff0c\u7136\u5f8c\u9ede\u64ca **\u63d0\u4ea4** \u3002### \u5275\u5efa\u96c6\u7fa3\u6642\u5553\u7528\u589e\u5f37\u529f\u80fd\u5275\u5efa Dataproc \u96c6\u7fa3\u6642\uff0c\u8acb\u57f7\u884c\u4ee5\u4e0b\u6b65\u9a5f\u4ee5\u5553\u7528 Spark \u512a\u5316\u548c\u57f7\u884c\u589e\u5f37\u529f\u80fd\u3002\u5553\u7528\u7684\u589e\u5f37\u529f\u80fd\u5c0d\u63d0\u4ea4\u5230\u96c6\u7fa3\u7684\u6240\u6709 Spark \u4f5c\u696d\u4ecd\u7136\u6709\u6548\uff0c\u9664\u975e\u60a8\u5728\u63d0\u4ea4\u4f5c\u696d\u6642\u7232\u7279\u5b9a\u4f5c\u696d\u505c\u7528\u9019\u4e9b\u589e\u5f37\u529f\u80fd\u3002\u9ed8\u8a8d\u60c5\u6cc1\u4e0b\uff0cDataproc \u96c6\u7fa3\u4e0a\u6703\u505c\u7528 Dataproc Spark \u6027\u80fd\u589e\u5f37\u529f\u80fd\u3002- \u5728\u7d42\u7aef\u7a97\u53e3\u6216 [Cloud Shell](https://console.cloud.google.com/?cloudshell=true%22&hl=zh-cn) \u4e2d\u672c\u5730\u904b\u884c\u4ee5\u4e0b [gcloud dataproc clusters create](https://cloud.google.com/sdk/gcloud/reference/dataproc/clusters/create?hl=zh-cn) \u547d\u4ee4\u3002```\ngcloud dataproc clusters create CLUSTER_NAME \\\n\u00a0\u00a0\u00a0\u00a0--project=PROJECT_ID \\\n\u00a0\u00a0\u00a0\u00a0--region=REGION \\\n\u00a0\u00a0\u00a0\u00a0--image-version=IMAGE \\\n\u00a0\u00a0\u00a0\u00a0--properties=PROPERTIES\n```\u5099\u8a3b\uff1a- \uff1a\u96c6\u7fa3\u540d\u7a31\uff0c\u5728\u9805\u76ee\u4e2d\u5fc5\u9808\u662f\u552f\u4e00\u7684\u3002\u540d\u7a31\u5fc5\u9808\u4ee5\u5c0f\u5beb\u5b57\u6bcd\u958b\u982d\uff0c\u6700\u591a\u53ef\u4ee5\u5305\u542b 51 \u500b\u5c0f\u5beb\u5b57\u6bcd\u3001\u6578\u5b57\u548c\u9023\u5b57\u7b26\u3002\u4f46\u4e0d\u80fd\u4ee5\u9023\u5b57\u7b26\u7d50\u5c3e\u3002\u5df2\u522a\u9664\u7684\u96c6\u7fa3\u7684\u540d\u7a31\u53ef\u4ee5\u91cd\u8907\u4f7f\u7528\u3002\n- \uff1a\u8981\u8207\u96c6\u7fa3\u95dc\u806f\u7684\u9805\u76ee\u3002\n- \uff1a\u96c6\u7fa3\u6240\u5728\u7684 [Compute Engine \u5340\u57df](https://cloud.google.com/compute/docs/regions-zones?hl=zh-cn#available) \uff0c\u4f8b\u5982`us-central1`\u3002- \u60a8\u53ef\u4ee5\u6dfb\u52a0\u53ef\u9078\u7684`--zone=` ``\u6a19\u8a8c\uff0c\u4ee5\u6307\u5b9a\u5340\u57df\u5167\u7684\u4e00\u500b\u5730\u5340\uff0c\u4f8b\u5982`us-central1-a`\u3002\u5982\u679c\u60a8\u672a\u6307\u5b9a\u5730\u5340\uff0c\u5247 Dataproc [\u81ea\u52d5\u9078\u64c7\u5730\u5340](https://cloud.google.com/dataproc/docs/concepts/configuring-clusters/auto-zone?hl=zh-cn) \u529f\u80fd\u6703\u9078\u64c7\u5177\u6709\u6307\u5b9a\u5340\u57df\u7684\u5730\u5340\u3002\n- \uff1aDataproc \u6620\u50cf\u7248\u672c`2.0.69+`\u548c`2.1.17+`\u53ca\u66f4\u9ad8\u7248\u672c\u5747\u63d0\u4f9b Dataproc Spark \u512a\u5316\u5668\u548c\u57f7\u884c\u6027\u80fd\u589e\u5f37\u529f\u80fd\u3002\u5982\u679c\u7701\u7565\u6b64\u6a19\u8a8c\uff0cDataproc \u5c07\u7232\u96c6\u7fa3\u9078\u64c7\u9ed8\u8a8d Dataproc on Compute Engine \u6620\u50cf\u7684\u6700\u65b0\u6b21\u8981\u7248\u672c\uff08\u8acb\u53c3\u95b1 [\u9ed8\u8a8d Dataproc \u6620\u50cf\u7248\u672c](https://cloud.google.com/dataproc/docs/concepts/versioning/dataproc-version-clusters?hl=zh-cn#default_dataproc_image_version) \uff09\u3002\n- :- \u5982\u9700\u5553\u7528 Spark \u512a\u5316\u589e\u5f37\u529f\u80fd\uff0c\u8acb\u6307\u5b9a\u4ee5\u4e0b\u5167\u5bb9\uff1a\n```\nspark:spark.dataproc.enhanced.optimizer.enabled=true\n```- \u5982\u9700\u5553\u7528 Spark \u57f7\u884c\u589e\u5f37\u529f\u80fd\uff0c\u8acb\u6307\u5b9a\u4ee5\u4e0b\u5167\u5bb9\uff1a\n```\nspark:spark.dataproc.enhanced.execution.enabled=true\n```- \u5982\u9700\u5553\u7528 Spark \u512a\u5316\u548c\u57f7\u884c\u589e\u5f37\u529f\u80fd\uff0c\u8acb\u6307\u5b9a\u4ee5\u4e0b\u5167\u5bb9\uff1a\n```\nspark:spark.dataproc.enhanced.optimizer.enabled=true,spark:spark.dataproc.enhanced.execution.enabled=true\n```\n### \u63d0\u4ea4\u4f5c\u696d\u6642\u5553\u7528\u589e\u5f37\u529f\u80fd\u57f7\u884c\u4ee5\u4e0b\u6b65\u9a5f\u4f86\u7232 Spark \u4f5c\u696d\u5553\u7528 Spark \u512a\u5316\u548c\u57f7\u884c\u589e\u5f37\u529f\u80fd\u3002\u9ed8\u8a8d\u60c5\u6cc1\u4e0b\uff0c\u7cfb\u7d71\u6703\u5c0d Spark \u4f5c\u696d\u505c\u7528 Dataproc Spark \u6027\u80fd\u589e\u5f37\u529f\u80fd\uff0c\u9664\u975e\u60a8\u5728\u5275\u5efa\u4f5c\u696d\u96c6\u7fa3\u6216\u7232\u7279\u5b9a\u4f5c\u696d\u5553\u7528\u9019\u4e9b\u589e\u5f37\u529f\u80fd\u6642\u5553\u7528\u9019\u4e9b\u589e\u5f37\u529f\u80fd\u3002\n **\u6ce8\u610f** \uff1a\u5982\u9700\u7232\u4f5c\u696d\u5553\u7528 Dataproc \u6027\u80fd\u589e\u5f37\u529f\u80fd\uff0c\u4f5c\u696d\u96c6\u7fa3\u5fc5\u9808\u662f\u4f7f\u7528 2.0.69+ \u548c 2.1.17+ \u548c\u66f4\u9ad8\u6620\u50cf\u7248\u672c\u5275\u5efa\u7684\u3002- \u5728\u7d42\u7aef\u7a97\u53e3\u6216 [Cloud Shell](https://console.cloud.google.com/?cloudshell=true%22&hl=zh-cn) \u4e2d\uff0c\u672c\u5730\u904b\u884c\u4ee5\u4e0b [gcloud dataproc \u4f5c\u696d\u63d0\u4ea4](https://cloud.google.com/sdk/gcloud/reference/dataproc/jobs/submit?hl=zh-cn) \u547d\u4ee4\u3002```\ngcloud dataproc jobs submit SPARK_JOB_TYPE \\\n\u00a0\u00a0\u00a0\u00a0--cluster=CLUSTER_NAME \\\n\u00a0\u00a0\u00a0\u00a0--region=REGION \\\n\u00a0\u00a0\u00a0\u00a0--properties=PROPERTIES\n```\u5099\u8a3b\uff1a- \uff1a\u6307\u5b9a`spark`\u3001`pyspark`\u3001`spark-sql`\u6216`spark-r`\u3002\n- \uff1a\u5c07\u5728\u5176\u4e2d\u904b\u884c\u4f5c\u696d\u7684\u4f5c\u696d\u7684\u540d\u7a31\u3002\n- \uff1a\u96c6\u7fa3\u6240\u5728\u7684\u5340\u57df\u3002\n- :- \u5982\u9700\u5553\u7528 Spark \u512a\u5316\u589e\u5f37\u529f\u80fd\uff0c\u8acb\u6307\u5b9a\u4ee5\u4e0b\u5167\u5bb9\uff1a\n```\nspark.dataproc.enhanced.optimizer.enabled=true\n```- \u5982\u9700\u5553\u7528 Spark \u57f7\u884c\u589e\u5f37\u529f\u80fd\uff0c\u8acb\u6307\u5b9a\u4ee5\u4e0b\u5167\u5bb9\uff1a\n```\nspark.dataproc.enhanced.execution.enabled=true\n```- \u5982\u9700\u5553\u7528 Spark \u512a\u5316\u548c\u57f7\u884c\u589e\u5f37\u529f\u80fd\uff0c\u8acb\u6307\u5b9a\u4ee5\u4e0b\u5167\u5bb9\uff1a\n```\nspark.dataproc.enhanced.optimizer.enabled=true,spark.dataproc.enhanced.execution.enabled\n```\n### \u5275\u5efa\u96c6\u7fa3\u6642\u5553\u7528\u589e\u5f37\u529f\u80fd\u5275\u5efa Dataproc \u96c6\u7fa3\u6642\uff0c\u8acb\u57f7\u884c\u4ee5\u4e0b\u6b65\u9a5f\u4ee5\u5553\u7528 Spark \u512a\u5316\u548c\u57f7\u884c\u589e\u5f37\u529f\u80fd\u3002\u5553\u7528\u7684\u589e\u5f37\u529f\u80fd\u5c0d\u63d0\u4ea4\u5230\u96c6\u7fa3\u7684\u6240\u6709 Spark \u4f5c\u696d\u4ecd\u7136\u6709\u6548\uff0c\u9664\u975e\u60a8\u5728\u63d0\u4ea4\u4f5c\u696d\u6642\u7232\u7279\u5b9a\u4f5c\u696d\u505c\u7528\u9019\u4e9b\u589e\u5f37\u529f\u80fd\u3002\u9ed8\u8a8d\u60c5\u6cc1\u4e0b\uff0cDataproc \u96c6\u7fa3\u4e0a\u6703\u505c\u7528 Dataproc Spark \u6027\u80fd\u589e\u5f37\u529f\u80fd\u3002\n **\u6ce8\u610f** \uff1a\u5982\u9700\u7232\u4f5c\u696d\u5553\u7528 Dataproc \u6027\u80fd\u589e\u5f37\u529f\u80fd\uff0c\u8acb\u4f7f\u7528\u6620\u50cf\u7248\u672c 2.0.69+ \u548c 2.1.17+ \u548c\u66f4\u9ad8\u7248\u672c\u4f86\u5275\u5efa\u4f5c\u696d\u96c6\u7fa3\u3002\u5982\u679c\u60a8\u672a\u5728 `clusters.create` \u8acb\u6c42\u4e2d\u6307\u5b9a [SoftwareConfig.imageVersion](https://cloud.google.com/dataproc/docs/reference/rest/v1/ClusterConfig?hl=zh-cn#softwareconfig) \uff0cDataproc \u5c07\u7232\u96c6\u7fa3\u9078\u64c7\u9ed8\u8a8d Dataproc on Compute Engine \u6620\u50cf\u7684\u6700\u65b0\u6b21\u8981\u7248\u672c\uff08\u8acb\u53c3\u95b1 [\u9ed8\u8a8d Dataproc \u6620\u50cf\u7248\u672c](https://cloud.google.com/dataproc/docs/concepts/versioning/dataproc-version-clusters?hl=zh-cn#default_dataproc_image_version) \uff09\u3002- \u5c07\u4ee5\u4e0b [SoftwareConfig.properties](https://cloud.google.com/static/dataproc/docs/reference/rest/v1/ClusterConfig?hl=zh-cn#SoftwareConfig.FIELDS.properties) \u6307\u5b9a\u7232 [clusters.create](https://cloud.google.com/dataproc/docs/reference/rest/v1/projects.regions.clusters/create?hl=zh-cn) \u8acb\u6c42\u7684\u4e00\u90e8\u5206\uff1a- \u5982\u9700\u5553\u7528 Spark \u512a\u5316\u589e\u5f37\u529f\u80fd\uff0c\u8acb\u6307\u5b9a\u4ee5\u4e0b\u5167\u5bb9\uff1a\n```\n\"spark:spark.dataproc.enhanced.optimizer.enabled\": \"true\"\n```- \u5982\u9700\u5553\u7528 Spark \u57f7\u884c\u589e\u5f37\u529f\u80fd\uff0c\u8acb\u6307\u5b9a\u4ee5\u4e0b\u5167\u5bb9\uff1a\n```\n\"spark:spark.dataproc.enhanced.execution.enabled\": \"true\"\n```- \u5982\u9700\u5553\u7528 Spark \u512a\u5316\u548c\u57f7\u884c\u589e\u5f37\u529f\u80fd\uff0c\u8acb\u6307\u5b9a\u4ee5\u4e0b\u5167\u5bb9\uff1a\n```\n\"spark:spark.dataproc.enhanced.optimizer.enabled\": \"true\",\"spark:spark.dataproc.enhanced.execution.enabled\": \"true\"\n```\n### \u63d0\u4ea4\u4f5c\u696d\u6642\u5553\u7528\u589e\u5f37\u529f\u80fd\u57f7\u884c\u4ee5\u4e0b\u6b65\u9a5f\u4f86\u7232 Spark \u4f5c\u696d\u5553\u7528 Spark \u512a\u5316\u548c\u57f7\u884c\u589e\u5f37\u529f\u80fd\u3002\u9ed8\u8a8d\u60c5\u6cc1\u4e0b\uff0c\u7cfb\u7d71\u6703\u5c0d Spark \u4f5c\u696d\u505c\u7528 Dataproc Spark \u6027\u80fd\u589e\u5f37\u529f\u80fd\uff0c\u9664\u975e\u60a8\u5728\u5275\u5efa\u4f5c\u696d\u96c6\u7fa3\u6216\u7232\u7279\u5b9a\u4f5c\u696d\u5553\u7528\u9019\u4e9b\u589e\u5f37\u529f\u80fd\u6642\u5553\u7528\u9019\u4e9b\u589e\u5f37\u529f\u80fd\u3002\n **\u6ce8\u610f** \uff1a\u5982\u9700\u7232\u4f5c\u696d\u5553\u7528 Dataproc \u6027\u80fd\u589e\u5f37\u529f\u80fd\uff0c\u4f5c\u696d\u96c6\u7fa3\u5fc5\u9808\u662f\u4f7f\u7528 2.0.69+ \u548c 2.1.17+ \u548c\u66f4\u9ad8\u6620\u50cf\u7248\u672c\u5275\u5efa\u7684\u3002- \u5728 [jobs.submit](https://cloud.google.com/dataproc/docs/reference/rest/v1/projects.regions.jobs/submit?hl=zh-cn) \u8acb\u6c42\u4e2d\u7232 [SparkJob](https://cloud.google.com/dataproc/docs/reference/rest/v1/SparkJob?hl=zh-cn) \u3001 [PySparkJob](https://cloud.google.com/dataproc/docs/reference/rest/v1/PySparkJob?hl=zh-cn) \u3001 [SparkSqlJob](https://cloud.google.com/dataproc/docs/reference/rest/v1/SparkSqlJob?hl=zh-cn) \u6216 [SparkRJob](https://cloud.google.com/dataproc/docs/reference/rest/v1/SparkRJob?hl=zh-cn) \u6307\u5b9a\u4ee5\u4e0b `properties` \uff1a- \u5982\u9700\u5553\u7528 Spark \u512a\u5316\u589e\u5f37\u529f\u80fd\uff0c\u8acb\u6307\u5b9a\u4ee5\u4e0b\u5167\u5bb9\uff1a\n```\n\"spark.dataproc.enhanced.optimizer.enabled=true\"\n```- \u5982\u9700\u5553\u7528 Spark \u57f7\u884c\u589e\u5f37\u529f\u80fd\uff0c\u8acb\u6307\u5b9a\u4ee5\u4e0b\u5167\u5bb9\uff1a\n```\n\"spark.dataproc.enhanced.execution.enabled=true\"\n```- \u5982\u9700\u5553\u7528 Spark \u512a\u5316\u548c\u57f7\u884c\u589e\u5f37\u529f\u80fd\uff0c\u8acb\u6307\u5b9a\u4ee5\u4e0b\u5167\u5bb9\uff1a\n```\n\"spark.dataproc.enhanced.execution.enabled=true,spark.dataproc.enhanced.optimizer.enabled=true\"\n```\n**\u6ce8\u610f** \uff1a\u60a8\u53ef\u4ee5\u9ede\u64ca Google Cloud \u63a7\u5236\u6aaf [\u5728 Compute Engine \u4e0a\u5275\u5efa Dataproc \u96c6\u7fa3](https://console.cloud.google.com/dataproc/clustersAdd?hl=zh-cn) \u9801\u9762\u5de6\u5074\u9762\u677f\u5e95\u90e8\u7684 **\u7b49\u6548\u547d\u4ee4\u884c** \u6216 **\u7b49\u6548 REST** \uff0c\u8b93\u63a7\u5236\u6aaf\u69cb\u5efa\u4e00\u500b\u7b49\u6548\u7684`gcloud`\u5de5\u5177\u547d\u4ee4\u6216 API REST \u8acb\u6c42\uff0c\u60a8\u53ef\u4ee5\u5f9e\u547d\u4ee4\u884c\u6216\u4ee3\u78bc\u4e2d\u4f7f\u7528\u8a72\u8acb\u6c42\u6216 API REST \u8acb\u6c42\u4f86\u5275\u5efa\u96c6\u7fa3\u3002", "guide": "Dataproc"}