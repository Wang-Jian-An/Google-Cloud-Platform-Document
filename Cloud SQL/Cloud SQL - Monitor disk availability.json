{"title": "Cloud SQL - Monitor disk availability", "url": "https://cloud.google.com/sql/docs/postgres/using-ood-recommender", "abstract": "# Cloud SQL - Monitor disk availability\nThe Cloud SQL out-of-disk [recommender](/recommender/docs/overview) proactively generates recommendations that help you reduce the risk of downtime that might be caused by your instances running out of disk space. You can apply these recommendations when a Cloud SQL instance is trending toward a storage limit. This page describes how this recommender works and how to use it.\n", "content": "## How it works\nThe Cloud SQL out-of-disk recommender analyzes the storage utilization trend over the last 30 days. When an instance is trending toward a limit where it's likely to run out of space within the next 1 to 30 days, the recommender generates related recommendations to manually increase the storage capacity, set the storage capacity to automatically increase, or free up space.\n## Pricing\nThe Cloud SQL out-of-disk recommender is included in the [Standard Google Cloud support package](/recommender/pricing) .\n## Before you begin\nBefore you can view recommendations and insights, do the following:\n- To get the permissions to view and work with insights and recommendations, ensure that you have the required [roles](/sql/docs/postgres/project-access-control#roles) .| Tasks     | Roles                    |\n|:----------------------|:------------------------------------------------------------------------------------|\n| View recommendations | One of these roles: recommender.cloudsqlViewer or cloudsql.viewer.     |\n| Apply recommendations | One of these roles: recommender.cloudsqlAdmin, cloudsql.editor, or cloudsql.admin. |For more information about roles, see [understanding roles](/iam/docs/understanding-roles) and [granting IAM permissions](/iam/docs/granting-changing-revoking-access) .\n- Enable the Recommender API. [Enable the API](https://console.cloud.google.com/flows/enableapi?apiid=recommender.googleapis.com) \n## List out-of-disk recommendations\nYou can list out-of-disk instance recommendations by using the Google Cloud console, `gcloud` , or the Recommender API.\nOut-of-disk recommendations are shown only if you have instances that are nearing disk capacity.\nTo list out-of-disk recommendations by using the Google Cloud console, follow these steps:- Go to the **Cloud SQL Instances** page. [Go to Cloud SQL Instances](https://console.cloud.google.com/sql/instances) \n- Click **View all** on the out-of-disk recommendations banner.\nAlternatively, follow these steps:- Go to the **Recommendation Hub** . See also [Getting started with Recommendation Hub](/recommender/docs/recommendation-hub/identify-configuration-problems) . [Go to the Recommendation Hub](https://console.cloud.google.com/home/recommendations/) \n- In the **Prevent Downtime for SQL instances** card, click **View all** .\nTo list out-of-disk recommendations by using `gcloud` , run the [gcloud recommender recommendations list](/sdk/gcloud/reference/recommender/recommendations/list) command as follows:\n```\ngcloud recommender recommendations list \\\n--project=PROJECT_ID \\\n--location=LOCATION \\\n--recommender=google.cloudsql.instance.RECOMMENDER\n```\nReplace the following:- ``: Your project ID\n- ``: A region, such as`us-central1`\n- ``: The ID of the recommender as`OutOfDiskRecommender`.\nTo list out-of-disk recommendations by using the [Recommendations API](/recommender/docs/using-api) , call the [recommendations.list](/recommender/docs/reference/rest/v1beta1/projects.locations.recommenders.recommendations/list) method as follows:\n```\nGET https://recommender.googleapis.com/v1beta1/projects/PROJECT-ID/locations/LOCATION/recommenders/google.cloudsql.instance.RECOMMENDER/recommendations\n```\nReplace the following:- ``: Your project ID.\n- ``: A region, such as`us-central1`.\n- ``: The ID of the recommender as`OutOfDiskRecommender`.## View insights and detailed recommendations\nYou can view insights and detailed recommendations about instances that are nearly out of disk space by using the Google Cloud console, `gcloud` , or the Recommender API.\nTo view insights and detailed recommendations about instances that are nearly out of disk space by using the Google Cloud console, click the recommendation button in the list of instances.\nTo view insights and detailed recommendations about instances that are nearly out of disk space by using `gcloud` , run the [gcloud recommender insights list](/sdk/gcloud/reference/recommender/insights/list) command as follows:\n```\ngcloud recommender insights list \\\n--project=PROJECT_ID \\\n--location=LOCATION \\\n--insight-type=google.cloudsql.instance.INSIGHT_TYPE\n```\nReplace the following:- ``: Your project ID.\n- ``: A region, such as`us-central1`.\n- ``: The ID of the insight type as`DiskUsageTrendInsight`.\nTo view insights and detailed recommendations about instances that are nearly out of disk space by using the [Recommendations API](/recommender/docs/using-api) , call the [insights.list](/recommender/docs/reference/rest/v1beta1/projects.locations.insightTypes.insights/list) method as follows:\n```\nGET https://recommender.googleapis.com/v1beta1/projects/PROJECT-ID/locations/LOCATION/insightTypes/google.cloudsql.instance.INSIGHT_TYPE/insights\n```\nReplace the following:- ``: Your project ID.\n- ``: A region, such as`us-central1`.\n- ``: The ID of the insight type as`DiskUsageTrendInsight`.\nThe following table lists the insight and recommendation that the Cloud SQL out-of-disk recommender generates. The subtypes are visible in the `gcloud` and API results.\n| Insight                                    | Recommendation                          |\n|:------------------------------------------------------------------------------------------------------------------------------------------------------|:--------------------------------------------------------------------------------------------------------------------|\n| Based on the current storage use trend, the instance is likely to run out of disk space, which can result in downtime. Subtype: TRENDING_OUT_OF_DISK | Enable auto grow, manually increase storage capacity, or free up disk space. Subtype: ENABLE_AUTO_STORAGE_INCREASE |\n## Apply recommendations\nEvaluate the recommendations carefully and do any of the following:\n- To examine the recommendation, click **View instance** .A banner appears at the top of the page providing a recommendation. [Edit](/sql/docs/postgres/edit-instance) the instance, if required, to [manually increase](/sql/docs/postgres/instance-settings#storage-capacity-2ndgen) the storage capacity and set the storage capacity to [automatically increase](/sql/docs/postgres/instance-settings#storage-capacity-2ndgen) . Alternatively, delete data to free up space.\n- To dismiss the recommendation so that it's de-emphasized and appears dimmed, click **Dismiss** .\n- To close the panel without applying or dismissing the recommendation, click **Cancel** .## What's next\n- [Reduce idle Cloud SQL instances](/sql/docs/postgres/recommender-sql-idle) \n- [Reduce overprovisioned Cloud SQL instances](/sql/docs/postgres/recommender-sql-overprovisioned) \n- [Blog: Maximize your Cloud ROI](https://cloud.google.com/blog/products/management-tools/active-assist-comes-to-google-cloud) \n- [Blog: Do more with less](https://cloud.google.com/blog/products/databases/reduce-cloud-sql-costs-with-optimizations-by-active-assist) \n- [Google Cloud recommenders](/recommender/docs/recommenders)", "guide": "Cloud SQL"}