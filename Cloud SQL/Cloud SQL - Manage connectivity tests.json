{"title": "Cloud SQL - Manage connectivity tests", "url": "https://cloud.google.com/sql/docs/postgres/manage-connectivity-tests", "abstract": "# Cloud SQL - Manage connectivity tests\n[Connectivity Tests](/network-intelligence-center/docs/connectivity-tests/concepts/overview) is a diagnostics tool that lets you check connectivity between network endpoints. It analyzes your configuration and, in some cases, performs [live data plane analysis](/network-intelligence-center/docs/connectivity-tests/concepts/overview#live-data-plane) between the endpoints. An endpoint is a source or destination of network traffic, such as a Cloud SQL instance.\nUse the Connectivity Tests tool for any of the following purposes:\n- To verify connectivity between a Cloud SQL instance and another resource, such as a Virtual Machine (VM), or between a [read replica](/sql/docs/postgres/replication#read-replicas) instance and a primary instance.\n- To troubleshoot any connectivity issues associated with different types of source and destination settings.\n- To determine whether there's an issue in your VPC network that's used for the Cloud SQL-related resources.\nConfiguration errors that the tool can diagnose include connectivity to a Cloud SQL instance blocked by:\n- VPC firewall rules, hierarchical firewall policies, and global network firewall policies\n- A routing issue (for example, an incorrect route to a destination network is used or no dynamic routes are available)\n- An issue associated with VPC peering between your VPC network and the Google-managed service network\n- The instance not running\n- An incorrect port or protocol being used by the [Cloud SQL Auth Proxy](/sql/docs/postgres/sql-proxy#how-works) to access the instance\n- A failure occurring with [authorized networks](https://cloud.google.com/sql/docs/postgres/authorize-networks) set up for the instance\nFor more information about the Connectivity Tests tool, see [Connectivity Tests overview](/network-intelligence-center/docs/connectivity-tests/concepts/overview) .\n**Note:** The Connectivity Tests tool is used to manually troubleshoot and debug any networking issues. If you want automated network connectivity troubleshooting, use Network Analyzer. For more information about Network Analyzer, see [Network Analyzer overview](/network-intelligence-center/docs/network-analyzer/overview) . For more information about insights associated with Network Analyzer, see [Cloud SQL connectivity insights](/network-intelligence-center/docs/network-analyzer/insights/managed-services/cloud-sql-private-ip) .The procedures on this page explain how to use the Google Cloud console to manage connectivity tests. You can also manage these tests by using [](/sdk/gcloud/reference/network-management/connectivity-tests)  [gcloud CLI](/sdk/gcloud) or the [Cloud SQL Admin API](/network-intelligence-center/docs/connectivity-tests/reference/networkmanagement/rest/v1/projects.locations.global.connectivityTests) .\n", "content": "## Before you begin\n- [Enable the Network Management API](/network-intelligence-center/docs/connectivity-tests/reference/enable-api) . You must enable this API so that you can run connectivity tests.\n- Make sure you assign the [Network Management Admin](/network-intelligence-center/docs/connectivity-tests/concepts/access-control#networkmanagement-roles) role and associated permissions to  your user account. [ Go to the IAM page](https://console.cloud.google.com/iam-admin/iam) ## Create a connectivity test\nTo create a connectivity test, follow these steps:\n- In the Google Cloud console, go to the **Cloud SQL Instances** page. [Go to Cloud SQL Instances](https://console.cloud.google.com/sql) \n- Click the Cloud SQL instance for which you want to create a connectivity test.If no instances appear on the page, [create an instance](/sql/docs/postgres/create-instance) .\n- From the side navigation menu, click **Connections** .\n- Click the **Connectivity tests** tab, and then click **Create** .\n- In the **Test name** field, enter a name for the test.The test name can contain lowercase letters, numbers, and hyphens only.\n- From the **Protocol** list, select a protocol for the test.\n- If this Cloud SQL instance is the source for the test, do the following:- In the **Source** region, click the **Current Cloud SQL instance** option.\n- In the **Destination** region, click **Other** , and then specify information about the endpoint for the destination.\n- If the instance is the destination for the test, do the following:- In the **Source** region, click **Other** , and then specify information about the source's endpoint.\n- In the **Destination** region, click the **Current Cloud SQL instance** option.\n- In the **Destination port** field, enter a port for the destination.\n- Click **Create** .\nAfter the test finishes, the **Connectivity tests** tab loads and displays a list of configured tests.\n## View information about a connectivity test\nHigh-level information about a connectivity test that you can view includes the following information:\n- Name, protocol, source, and destination for the test.\n- Google Cloud projects associated with the source and destination.\n- Port reserved for the destination.\n- Last date and time that the test was run.\n- Result of the data plane analysis check that signifies how many packets of data were transmitted from the source to the destination.\n- Result of the configuration analysis check that signifies whether a connection can be established between the source and destination so that packets of data can be transferred to the destination.\n- [Details about the test](#view-detailed-info) .\nIn addition to viewing high-level information about a connectivity test, you can click a test to see additional information about the results of the test, including the following information:\n- One-way latency values associated with the [live data plane analysis](/network-intelligence-center/docs/connectivity-tests/concepts/overview#live-data-plane) check.\n- Detailed information about the configuration analysis check. This information includes the status of the check, Cloud SQL instance, and so on.\n- REST API response for the connectivity test being run.\n### View high-level and detailed information\nTo view high-level and detailed information a connectivity test, follow these steps:\n- In the Google Cloud console, go to the **Cloud SQL Instances** page. [Go to Cloud SQL Instances](https://console.cloud.google.com/sql) \n- Click the Cloud SQL instance for which you want to view information about a connectivity test.\n- From the side navigation menu, click **Connections** .\n- Click the **Connectivity tests** tab. High-level information about all tests associated with the instance appears.\n- Click a test about which you want to view detailed information.The **Connectivity test details** page appears. On this page, you can view the overall result and result cards for each Google Cloud resource in the testing path. You can click a link to the details page for some Google Cloud resources, such as VM instances or routes. If the test contains multiple traces, you can select a trace from the Trace result list.If the test is [eligible](/network-intelligence-center/docs/connectivity-tests/concepts/overview#supported-dynamic-configs) for data plane analysis, you can view the packet loss and latency metrics.To interpret the test results, see [Configuration analysis states](/network-intelligence-center/docs/connectivity-tests/concepts/state-tables) .\n- To view detailed information about the configuration analysis check, in the **Last configuration analysis result** section, click **View** .\n- To view the REST API response for the test, scroll to the bottom of the page, and then click **Equivalent REST** .## Modify a connectivity test\nTo modify a connectivity test, follow these steps:\n- In the Google Cloud console, go to the **Cloud SQL Instances** page. [Go to Cloud SQL Instances](https://console.cloud.google.com/sql) \n- Click the Cloud SQL instance for which you want to modify a connectivity test.\n- From the side navigation menu, click **Connections** .\n- Click the **Connectivity tests** tab.\n- Click the test that you want to modify.\n- On the **Connectivity test details** page, click **Edit** .\n- Modify the test. You can modify the protocol, source and destination endpoints, and destination port.\n- Click **Save** .## Test connectivity\nYou can test connectivity to a Cloud SQL instance with [Private Service Connect](/sql/docs/postgres/about-private-service-connect) enabled. To test inbound connectivity to the instance, set the IP address of the Private Service Connect endpoint that's used to connect to the instance to be the destination IP address.\nUse the [gcloud network-management connectivity-tests create](/sdk/gcloud/reference/network-management/connectivity-tests/create) command to create a connectivity test for a Cloud SQL instance with Private Service Connect enabled.\n```\ngcloud network-management connectivity-tests create CONNECTIVITY_TEST_NAME \\--source-instance=SOURCE_INSTANCE \\--destination-cloud-sql-instance=DESTINATION_CLOUD_SQL_INSTANCE \\--destination-network=DESTINATION_NETWORK \\--destination-port=DESTINATION_PORT \\--protocol=tcp\n```\nMake the following replacements:- : the name of the connectivity test.\n- : the URI for the Compute Engine instance where the source IP address is located (for example,`projects/myproject/zones/myzone/instances/myinstance`).\n- : the URL for the Cloud SQL instance (for example,`projects/myproject/instances/myinstance`).\n- : the URI for the VPC network where the destination IP address is located (for example,`projects/myproject/global/networks/mynetwork`).\n- : the port number reserved for the instance. For Cloud SQL for PostgreSQL instances, the port number is`5432`.## Run connectivity tests again\nIf you change the network configuration of resources associated with a connectivity test and want to see the results for the latest configuration, you can run a test again. You can rerun one or more tests at the same time.\nA connectivity test is based on a snapshot of the network configuration at the time that the test is run. Running a test again overwrites the previous test's results. If you want to keep older results, create a new test.\nTo run one or more connectivity tests again, follow these steps:\n- In the Google Cloud console, go to the **Cloud SQL Instances** page. [Go to Cloud SQL Instances](https://console.cloud.google.com/sql) \n- Click the Cloud SQL instance for which you want to run connectivity tests again.\n- From the side navigation menu, click **Connections** .\n- Click the **Connectivity tests** tab.\n- Select the check box next to each test that you want to run again.\n- Click **Rerun** .\n- In the dialog box, click **Rerun** .## Delete connectivity tests\nIf you no longer need a connectivity test, delete it. You can delete one or more tests at the same time.\nTo delete connectivity tests, follow these steps:\n- In the Google Cloud console, go to the **Cloud SQL Instances** page. [Go to Cloud SQL Instances](https://console.cloud.google.com/sql) \n- Click the Cloud SQL instance for which you want to delete connectivity tests.\n- From the side navigation menu, click **Connections** .\n- Click the **Connectivity tests** tab.\n- Select the check box next to each test that you want to delete.\n- Click **Delete** .\n- In the dialog box, click **Delete** .\nBy deleting a connectivity test, it won't take up quota and you won't be billed for it in the future.\n## Troubleshoot\nFor more information about troubleshooting common issues with connectivity tests, see [Troubleshoot Connectivity Tests](/network-intelligence-center/docs/connectivity-tests/support/troubleshooting) .\n## What's next\n- [Connectivity Tests overview](/network-intelligence-center/docs/connectivity-tests/concepts/overview) \n- [Cloud SQL connectivity insights](/network-intelligence-center/docs/network-analyzer/insights/managed-services/cloud-sql-private-ip) \n- [Create and run Connectivity Tests](/network-intelligence-center/docs/connectivity-tests/how-to/running-connectivity-tests) \n- [Network Analyzer overview](/network-intelligence-center/docs/network-analyzer/overview)", "guide": "Cloud SQL"}