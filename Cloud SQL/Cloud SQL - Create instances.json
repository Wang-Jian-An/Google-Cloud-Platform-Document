{"title": "Cloud SQL - Create instances", "url": "https://cloud.google.com/sql/docs/postgres/create-instance", "abstract": "# Cloud SQL - Create instances\nThis page describes how to create a Cloud SQL for PostgreSQL instance.\n**Note:** This page contains features related to Cloud SQL editions. For more information about Cloud SQL editions, see [Introduction to Cloud SQL editions](/sql/docs/postgres/editions-intro) .\nFor detailed information about all instance settings, see [Instance settings](/sql/docs/postgres/instance-settings) .\nA newly-created instance has a `postgres` database.\n", "content": "## Before you begin\n- Make sure you have the Cloud SQL Admin and Compute Viewer roles on  your user account. [ Go to the IAM page](https://console.cloud.google.com/iam-admin/iam) [Learn more](/sql/docs/postgres/roles-and-permissions) about roles and permissions.\n**Note:** By default, you can have up to 1000 instances per project except in some cases, where you might have a limit of 100. [File a support case](https://support.google.com/googlecloud/answer/1041916) to request an increase.\n## Create a PostgreSQL instance\n- In the Google Cloud console, go to the **Cloud SQL Instances** page. [Go to Cloud SQL Instances](https://console.cloud.google.com/sql) \n- Click **Create instance** .\n- On the **Choose your database engine** panel of the **Create an instance** page, click **Choose PostgreSQL** .\n- In the **Instance ID** field of the **Instance info** pane, enter  an ID for your instance.Don't include sensitive or personally identifiable information  in your instance name.You do not need to include the project ID in the instance name. This is done automatically where appropriate (for example, in the log files).\n- Enter a password for the`postgres`user.\n- To see the password in clear text, click the **Show password** icon.\n- You can either enter the password manually or click\n- **Generate** \n- to have Cloud SQL create a password for you automatically.\n- Optional: Configure a password policy for the instance as follows:- Select the **Enable password policies** checkbox.Note: When you enable a password policy, statements   that create users or change user passwords can cause additional   latency due to password policy verification.\n- Click the **Set password policy** button, set one or more of   the following options, and click **Save** .- **Minimum length** : Specifies the minimum number of characters that   the password must have.\n- **Password complexity** : Checks if the password is a  combination of lowercase, uppercase, numeric, and non-alphanumeric  characters.\n- **Restrict password reuse** : Specifies the number of previous passwords that you can't reuse.\n- **Disallow username** : Prevents the use of the username in the password.\n- **Set password change interval** : Specifies the minimum number of hours   after which you can change the password.\n- Note: When you deselect the **Enable password policies** checkbox, the password policy parameters are reset.\n- Select the database version for your instance: PostgreSQL 15 (default), PostgreSQL 14,PostgreSQL  13, PostgreSQL 12, PostgreSQL 11, PostgreSQL 10, or PostgreSQL  9.6.The database version can't be edited after the instance has been created.Note: Only PostgreSQL 12 and later are compatible with Cloud SQL Enterprise Plus edition.\n- Select the Cloud SQL edition for your instance:`Enterprise`or`Enterprise plus`. For more information about Cloud SQL editions, see [Introduction to Cloud SQL editions](/sql/docs/postgres/editions-intro) .\n- In the **Choose region and zonal availability** section, select the region  and zone for your instance.  Region availability might be different based on your  Cloud SQL edition. For more information, see [About instance settings](/sql/docs/postgres/instance-settings) .Place your instance in the same region as the resources that   access it. The region you select can't be modified in the future. In most   cases, you don't need to specify a zone. **Note: ** If there is a resource location   constraint on your organization policy, you must select one of the   regions that the organization policy allows. You see a message about   Resource Location Restriction in the **Choose region and zonal\n  availability** section if a   constraint exists. [Learn more](/resource-manager/docs/organization-policy/defining-locations) .If you are configuring your instance for [high availability](/sql/docs/postgres/high-availability) ,   you can select both a primary and secondary zone.The following conditions apply when the secondary zone is used during   instance creation:- The zones default to`Any`for the primary zone and`Any (different from primary)`for the secondary zone.\n- If both the primary and secondary zones are specified, they must    be distinct zones.\n- In the **Customize your instance** section, update settings for your  instance.  Begin by clicking **SHOW CONFIGURATION OPTIONS** to display the groups  of settings. Then, expand desired groups to review and customize settings.  A **Summary** of all the options you select is shown on the right.  Customizing these instance settings is optional. Defaults are assigned in  every case where no customizations are made.The following table is a quick reference to instance settings. For more   details about each setting, see the [instance settings](/sql/docs/postgres/instance-settings) page.| Setting         | Notes                                                                                                              |\n|:-------------------------------------------|:------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|\n| nan          | nan                                                                                                               |\n| Machine type        | Machine type                                                                                                            |\n| Machine type        | Select from Shared core or Dedicated core. For Shared core, each machine type is classified by the number of CPUs (cores) and amount of memory for your instance.                                                                       |\n| Cores          | The number of vCPUs for your instance. Learn more.                                                                                                   |\n| Memory          | The amount of memory for your instance, in GBs. Learn more.                                                                                                |\n| Custom          | For the Dedicated core machine type, instead of selecting a predefined configuration, select the Custom button to create an instance with a custom configuration. When you select this option, you need to select the number of cores and amount of memory for your instance. Learn more.                                        |\n| Storage         | Storage                                                                                                              |\n| Storage type        | Determines whether your instance uses SSD or HDD storage. Learn more.                                                                                              |\n| Storage capacity       | The amount of storage provisioned for the instance. Learn more.                                                                                               |\n| Enable automatic storage increases   | Determines whether Cloud SQL automatically provides more storage for your instance when free space runs low. Learn more.                                                                                 |\n| Encryption         | Encryption                                                                                                             |\n| Google-managed encryption     | The default option.                                                                                                           |\n| Customer key-managed encryption key (CMEK) | Select to use your key with Google Cloud Key Management Service. Learn more.                                                                                            |\n| Connections        | Connections                                                                                                             |\n| Private IP         | Adds a private IP address for your instance. To enable connecting to the instance, additional configuration is required. Optionally, you can specify an allocated IP range for your instances to use for connections. Expand Show allocated IP range option. Select an IP range from the drop-down menu. Your instance can have both a public and a private IP address. Learn more about using private IP. Learn more about allocated IP address ranges. |\n| Public IP         | Adds a public IP address for your instance. You can then add authorized networks to connect to the instance. Your instance can have both a public and a private IP address. Learn more about using public IP.                                                            |\n| Authorized networks      | Add the name for the new network and the Network address. Learn more.                                                                                              |\n| Private path for Google Cloud services  | By selecting this check box, you allow other Google Cloud services, such as BigQuery, to access data in Cloud SQL and make queries against this data over a private connection. This check box is enabled only if you select the Private IP check box, and you add or select an authorized network to create a private connection.                              |\n| Data protection       | Data protection                                                                                                            |\n| Automate backups       | The window of time when you would like backups to start. Learn more.                                                                                              |\n| Choose where to store your backups   | Select Multi-region for most use cases. If you need to store backups in a specific region, for example, if there are regulatory reasons to do so, select Region and select your region from the Location drop-down menu.                                                         |\n| nan          | nan                                                                                                               |\n| Choose how many automated backups to store | The number of automated backups you would like to retain (from 1 to 365 days). Learn more.                                                                                        |\n| Enable point-in-time recovery    | Enables point-in-time recovery and write-ahead logging. Learn more.                                                                                              |\n| Enable deletion protection     | Determines whether to protect an instance against accidental deletion. Learn more.                                                                                           |\n| Choose how many days of logs to retain  | Configure write-ahead log retention from 1 to 7 days. The default setting is 7 days. Learn more.                                                                                       |\n| Maintenance        | Maintenance                                                                                                             |\n| Preferred window       | Determines a one-hour window when Cloud SQL can perform disruptive maintenance on your instance. If you do not set the window, then disruptive maintenance can be done at any time. Learn more.                                                               |\n| Order of updates       | Your preferred timing for instance updates, relative to other instances in the same project. Learn more.                                                                                     |\n| Flags          | Flags                                                                                                              |\n| ADD FLAG         | You can use database flags to control settings and parameters for your instance. Learn more.                                                                                        |\n| Labels          | Labels                                                                                                              |\n| ADD LABEL         | Add a key and value for each label that you add. You use labels to help organize your instances.                                                                                       |\n| Data cache         | Data cache                                                                                                             |\n| Enable data cache (optional)    | Enables data cache for Cloud SQL for PostgreSQL Enterprise Plus edition instances. For more information about data cache, see data cache.                                                                             |\n- Click **Create Instance** .Note: It might take a few minutes to create your instance. However,  you can [view information about the instance](/sql/docs/mysql/instance-info) while it's being created.\nFor information about installing and getting started with the [gcloud CLI](/sdk/gcloud) , see [Installing gcloud CLI](/sdk/downloads) . For information about starting Cloud Shell, see the [Cloud Shell documentation](/shell/docs/starting-cloud-shell) .- Use the [gcloud sql instances create](/sdk/gcloud/reference/sql/instances/create) command to create the instance:For Cloud SQL Enterprise Plus edition instances:```\ngcloud sql instances create INSTANCE_NAME \\--database-version=POSTGRES_14 \\--region=REGION \\--zone=ZONE \\--tier=TIER \\--edition=ENTERPRISE_PLUS\n```For Cloud SQL Enterprise edition instances:```\ngcloud sql instances create INSTANCE_NAME \\--database-version=POSTGRES_14 \\--cpu=NUMBER_CPUS \\--memory=MEMORY_SIZE \\--region=REGION \\--zone=ZONE\n```Or, alternatively, you can use the`--tier`flag if you choose db-f1-micro or db-g1-small as the machine type:```\ngcloud sql instances create INSTANCE_NAME \\--tier=API_TIER_STRING \\--region=REGION\n```There are restrictions on the values for vCPUs and memory size:- vCPUs must be either 1 or an even number between 2 and 96.\n- Memory must be:- 0.9 to 6.5 GB per vCPU\n- A multiple of 256 MB\n- At least 3.75 GB (3840 MB)For example, the following string creates a Cloud SQL Enterprise edition instance with two vCPUs and 7,680 MB of memory:```\ngcloud sql instances create myinstance \\--database-version=POSTGRES_14 \\--cpu=2 \\--memory=7680MB \\--region=us-central1\n```The following string creates a Cloud SQL Enterprise edition instance with four cores:```\ngcloud sql instances create myinstance \\--database-version=POSTGRES_14 \\--tier=db-perf-optimized-N-4 \\--edition=ENTERPRISE_PLUS \\--region=us-central1\n```See [Custom instance configuration](#machine-types) for more information about how to size`--cpu`and`--memory`.The default value for is `us-central1` .Do not include sensitive or personally identifiable information  in your instance name; it is externally visible. You do not need to include the project ID in the instance name. This is done automatically where appropriate (for example, in the log files).If you are creating an instance for [high availability](/sql/docs/postgres/high-availability) , you can specify both the primary and secondary zones, using the `--zone` and `--secondary-zone` parameters. The following conditions apply when the secondary zone is used during instance creation or edit:- The zones must be valid zones.\n- If the secondary zone is specified, the primary must also be specified.\n- If the primary and secondary zones are specified, they must be distinct  zones.\n- If the primary and secondary zones are specified, they must belong to  the same region.\nYou can add more parameters to determine other instance settings:| Setting         | Parameter                          | Notes                                                                                                                                                                                                                                                        |\n|:-----------------------------------------|:-----------------------------------------------------------------------------------------------------------------|:------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|\n| Required parameters      | Required parameters                        | Required parameters                                                                                                                                                                                                                                                     |\n| Database version       | --database-version                        | The database version, which is based on your Cloud SQL edition.                                                                                                                                                                                                                                         |\n| Region         | --region                           | See valid values. Note: Some organizations use an organization policy to restrict resource locations. If this type of policy affects your project, you can only select regions the organization policy allows. In the Location drop-down menu in the Console, the locations that are not allowed are unavailable. Learn more.                                                                                                                                                                         |\n| Set password policy      | Set password policy                        | Set password policy                                                                                                                                                                                                                                                     |\n| Enable password policy     | --enable-password-policy                       | Enables the password policy when used. By default, the password policy is disabled. When disabled using the --clear-password-policy parameter, the other password policy parameters are reset. Note: When you enable a password policy, statements that create users or change user passwords can cause additional latency due to password policy verification.                                                                                                                                                                 |\n| Minimum length       | --password-policy-min-length                      | Specifies the minimum number of characters that the password must have.                                                                                                                                                                                                                                        |\n| Password complexity      | --password-policy-complexity                      | Enables the password complexity check to ensure that the password contains one of each of these types of characters: lowercase, uppercase, numeric, and non-alphanumeric. Set the value to COMPLEXITY_DEFAULT.                                                                                                                                                                                                     |\n| Restrict password reuse     | --password-policy-reuse-interval                     | Specifies the number of previous passwords that you can't reuse.                                                                                                                                                                                                                                         |\n| Disallow username      | --password-policy-disallow-username-substring                 | Prevents the use of the username in the password. Use the --no-password-policy-disallow-username-substring parameter to disable the check.                                                                                                                                                                                                                      |\n| Set password change interval    | --password-policy-password-change-interval                  | Specifies the minimum duration after which you can change the password, for example, 2m for 2 minutes.                                                                                                                                                                                                                                |\n| Connectivity        | Connectivity                          | Connectivity                                                                                                                                                                                                                                                      |\n| Private IP        | --network --no-assign-ip (optional) --allocated-ip-range-name (optional) --enable-google-private-path (optional) | --network: Specifies the name of the VPC network you want to use for this instance. Private services access must already be configured for the network. Available only for the beta command (gcloud beta sql instances create). --no-assign-ip: Instance will only have a private IP address. --allocated-ip-range-name: If specified, sets a range name for which an IP range is allocated. For example, google-managed-services-default. The range name should comply with RFC-1035 and be within 1-63 characters. (gcloud alpha sql instances create). --enable-google-private-path: If you use this parameter, then you allow other Google Cloud services, such as BigQuery, to access data in Cloud SQL and make queries against this data over a private connection. This parameter is valid only if: You use the --no-assign-ip parameter. You use the --network parameter to specify the name of the VPC network that you want to use to create a private connection. Learn more about configuring private IP. |\n| Public IP        | --authorized-networks                       | For public IP connections, only connections from authorized networks can connect to your instance. Learn more.                                                                                                                                                                                                                             |\n| SSL Enforcement       | --ssl-mode --require-ssl                       | The ssl-mode parameter enforces the SSL/TLS enforcement for the connections. For more information, see Settings for Cloud SQL for PostgreSQL. The require-ssl parameter determines whether SSL connections over IP are enforced or not. require-ssl is a legacy parameter. Use ssl-mode instead. For more information, see IpConfiguration.                                                                                                                                                                     |\n| Machine type and storage     | Machine type and storage                       | Machine type and storage                                                                                                                                                                                                                                                   |\n| Machine type        | --tier                           | Used to specify a shared-core instance (db-f1-micro or db-g1-small). For a custom instance configuration, use the --cpu or --memory parameters instead. See Custom instance configuration.                                                                                                                                                                                                          |\n| Storage type        | --storage-type                         | Determines whether your instance uses SSD or HDD storage. Learn more.                                                                                                                                                                                                                                        |\n| Storage capacity       | --storage-size                         | The amount of storage provisioned for the instance, in GB. Learn more.                                                                                                                                                                                                                                        |\n| Automatic storage increase    | --storage-auto-increase                       | Determines whether Cloud SQL automatically provides more storage for your instance when free space runs low. Learn more.                                                                                                                                                                                                                           |\n| Automatic storage increase limit   | --storage-auto-increase-limit                     | Determines how large Cloud SQL can automatically grow storage. Available only for the beta command (gcloud beta sql instances create). Learn more.                                                                                                                                                                                                                    |\n| Data cache (optional)     | --enable-data-cache                        | Enables or deactivates the data cache for instances. For more information, see data cache.                                                                                                                                                                                                                                   |\n| Automatic backups and high availability | Automatic backups and high availability                   | Automatic backups and high availability                                                                                                                                                                                                                                                |\n| High availability      | --availability-type                        | For a highly-available instance, set to REGIONAL. Learn more.                                                                                                                                                                                                                                          |\n| Secondary zone       | --secondary-zone                         | If you're creating an instance for high availability, you can specify both the primary and secondary zones using the --zone and --secondary-zone parameters. The following restrictions apply when the secondary zone is used during instance creation or edit: The zones must be valid zones. If the secondary zone is specified, the primary must also be specified. If the primary and secondary zones are specified, they must be distinct zones. If the primary and secondary zones are specified, they must belong to the same region.                                                                                                                    |\n| Automatic backups      | --backup-start-time                        | The window of time when you would like backups to start. Learn more.                                                                                                                                                                                                                                        |\n| Retention settings for automated backups | --retained-backups-count                       | The number of automated backups to retain. Learn more.                                                                                                                                                                                                                                            |\n| Point-in-time recovery     | --enable-point-in-time recovery                     | Enables point-in-time recovery and write-ahead logging. Learn more.                                                                                                                                                                                                                                        |\n| Retention settings for binary logging | --retained-transaction-log-days                     | The number of days to retain write-ahead logs for point-in-time recovery.Learn more.                                                                                                                                                                                                                                    |\n| Add database flags      | Add database flags                        | Add database flags                                                                                                                                                                                                                                                     |\n| Database flags       | --database-flags                         | You can use database flags to control settings and parameters for your instance. Learn more about database flags.                                                                                                                                                                                                                            |\n| Maintenance schedule      | Maintenance schedule                        | Maintenance schedule                                                                                                                                                                                                                                                    |\n| Maintenance window      | --maintenance-window-day, --maintenance-window-hour                | Determines a one-hour window when Cloud SQL can perform disruptive maintenance on your instance. If you do not set the window, then disruptive maintenance can be done at any time. Learn more.                                                                                                                                                                                                         |\n| Maintenance timing      | --maintenance-release-channel                     | Your preferred timing for instance updates, relative to other instances in the same project. Use preview for earlier updates, and production for later updates. Learn more.                                                                                                                                                                                                              |\n- Note the automatically assigned IP address.If you are not using the Cloud SQL Auth Proxy, you will use this address as the  host address that your applications or tools use to connect to the  instance.\n- Set the password for the`postgres`user:```\ngcloud sql users set-password postgres \\--instance=INSTANCE_NAME \\--password=PASSWORD\n```\nTo create an instance, use a [Terraform resource](https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/sql_database_instance) .\n [  cloud_sql/postgres_instance_pvp/main.tf ](https://github.com/terraform-google-modules/terraform-docs-samples/blob/main/cloud_sql/postgres_instance_pvp/main.tf) [View on GitHub](https://github.com/terraform-google-modules/terraform-docs-samples/blob/main/cloud_sql/postgres_instance_pvp/main.tf) \n```\nresource \"google_sql_database_instance\" \"postgres_pvp_instance_name\" {\n name    = \"postgres-pvp-instance-name\"\n region   = \"asia-northeast1\"\n database_version = \"POSTGRES_14\"\n root_password = \"abcABC123!\"\n settings {\n tier = \"db-custom-2-7680\"\n password_validation_policy {\n  min_length     = 6\n  reuse_interval    = 2\n  complexity     = \"COMPLEXITY_DEFAULT\"\n  disallow_username_substring = true\n  password_change_interval = \"30s\"\n  enable_password_policy  = true\n }\n }\n # set `deletion_protection` to true, will ensure that one cannot accidentally delete this instance by\n # use of Terraform whereas `deletion_protection_enabled` flag protects this instance at the GCP level.\n deletion_protection = false\n}\n```To apply your Terraform configuration in a Google Cloud project, complete the steps in the following sections.## Prepare Cloud Shell\n- Launch [Cloud Shell](https://shell.cloud.google.com/) .\n- Set the default Google Cloud project  where you want to apply your Terraform configurations.You only need to run this command once per project, and you can run it in any directory.```\nexport GOOGLE_CLOUD_PROJECT=PROJECT_ID\n```Environment variables are overridden if you set explicit values in the Terraform  configuration file.\n## Prepare the directoryEach Terraform configuration file must have its own directory (also called a ).- In [Cloud Shell](https://shell.cloud.google.com/) , create a directory and a new  file within that directory. The filename must have the`.tf`extension\u2014for example`main.tf`. In this  tutorial, the file is referred to as`main.tf`.```\nmkdir DIRECTORY && cd DIRECTORY && touch main.tf\n```\n- If you are following a tutorial, you can copy the sample code in each section or step.Copy the sample code into the newly created `main.tf` .Optionally, copy the code from GitHub. This is recommended  when the Terraform snippet is part of an end-to-end solution.\n- Review and modify the sample parameters to apply to your environment.\n- Save your changes.\n- Initialize Terraform. You only need to do this once per directory.```\nterraform init\n```Optionally, to use the latest Google provider version, include the `-upgrade` option:```\nterraform init -upgrade\n```\n## Apply the changes\n- Review the configuration and verify that the resources that Terraform is going to create or  update match your expectations:```\nterraform plan\n```Make corrections to the configuration as necessary.\n- Apply the Terraform configuration by running the following command and entering`yes`at the prompt:```\nterraform apply\n```Wait until Terraform displays the \"Apply complete!\" message.\n- [Open your Google Cloud project](https://console.cloud.google.com/) to view  the results. In the Google Cloud console, navigate to your resources in the UI to make sure  that Terraform has created or updated them.\n **Note:** Terraform samples typically assume that the required APIs are enabled in your Google Cloud project.To delete your changes, do the following:- To disable deletion protection, in your Terraform configuration file set the`deletion_protection`argument to`false`.```\ndeletion_protection = \"false\"\n```\n- Apply the updated Terraform configuration by running the following command and    entering`yes`at the prompt:```\nterraform apply\n```\n- Remove resources previously applied with your Terraform configuration by running the following command and entering `yes` at the prompt:```\nterraform destroy\n```\nThis example creates an instance. Some optional parameters, such as  backups and binary logging are also included.  For a complete list of parameters for this call, see the [Instances:insert](/sql/docs/postgres/admin-api/rest/v1/instances/insert) page. For information about instance settings, including valid values for region, see [Instance settings](/sql/docs/postgres/instance-settings#settings-2ndgen) .\nDo not include sensitive or personally identifiable information in your instance ID; it is externally visible. You do not need to include the project ID in the instance name. This is done automatically where appropriate (for example, in the log files).\nBefore using any of the request data, make the following replacements:- : your project ID\n- : your instance ID\n- : the region\n- : enum string of the database version.  For example:`POSTGRES_13`\n- : the password for the root user\n- : enum string of the machine (tier) type, as:`db-custom-[CPUS]-[MEMORY_MBS]`\n- : your Cloud SQL edition\n- : (optional) set to`true`to enable data cache for your instance\n- : Specify the name of the Virtual Private Cloud (VPC) network that  you want to use for this instance. Private services access must already be configured for the  network.\n- : For public IP connections, specify the connections from authorized  networks that can connect to your instance.\n **Note:** For the `ipv4Enabled` parameter, set the value to `true` if you're using a public IP address for your instance or `false` if your instance has a private IP address.If you set the `enablePrivatePathForGoogleCloudServices` parameter to `true` ,  then you allow other Google Cloud services, such as BigQuery, to access data in  Cloud SQL and make queries against this data over a private connection. By setting this parameter to `false` , other Google Cloud services can't access data in Cloud SQL over a private connection.\nTo set a password policy while creating an instance, include the [passwordValidationPolicy](/sql/docs/postgres/admin-api/rest/v1/instances#passwordValidationPolicy) object in the request.  Set the following parameters, as required:- `enablePasswordPolicy`: Enables the password policy when set to`true`.To remove the password policy, you can use a `PATCH` request with `null` as the value for `enablePasswordPolicy` .   In this case, the other password policy parameters are reset. **Note:** When you enable a password policy, statements   that create users or change user passwords can cause additional   latency due to password policy verification.\n- `minLength`: Specifies the minimum number of characters that   the password must have.\n- `complexity`: Checks if the password is a  combination of lowercase, uppercase, numeric, and non-alphanumeric  characters. The default value is`COMPLEXITY_DEFAULT`.\n- `reuseInterval`: Specifies the number of previous passwords that you can't reuse.\n- `disallowUsernameSubstring`: Prevents the use of the username in the password   when set to`true`.\n- `passwordChangeInterval`: Specifies the minimum duration after which you can   change the password. The value is in seconds with up to nine fractional digits,   terminated by`s`. For example,`3.5s`.\nHTTP method and URL:\n```\nPOST https://sqladmin.googleapis.com/v1/projects/PROJECT_ID/instances\n```\nRequest JSON body:\n```\n{\n \"name\": \"INSTANCE_ID\",\n \"region\": \"REGION\",\n \"databaseVersion\": \"DATABASE_VERSION\",\n \"rootPassword\": \"PASSWORD\",\n \"settings\": {\n \"tier\": \"MACHINE_TYPE\",\n \"edition\": \"EDITION_TYPE\",\n \"dataCacheConfig\" = {\n  \"dataCacheEnabled\": DATA_CACHE_ENABLED\n },\n \"backupConfiguration\": {\n  \"enabled\": true\n },\n \"passwordValidationPolicy\": {\n  \"enablePasswordPolicy\": true\n  \"minLength\": \"MIN_LENGTH\",\n  \"complexity\": COMPLEXITY_DEFAULT,\n  \"reuseInterval\": \"REUSE_INTERVAL\",\n  \"disallowUsernameSubstring\": \"DISALLOW_USERNAME_SUBSTRING\",\n  \"passwordChangeInterval\": \"PASSWORD_CHANGE_INTERVAL\"\n }\n \"ipConfiguration\": {\n  \"privateNetwork\": \"PRIVATE_NETWORK\",\n  \"authorizedNetworks\": [AUTHORIZED_NETWORKS],\n  \"ipv4Enabled\": false,\n  \"enablePrivatePathForGoogleCloudServices\": true\n }\n }\n}\n```\nTo send your request, expand one of these options:You should receive a JSON response similar to the following:\n```\n{\n \"kind\": \"sql#operation\",\n \"targetLink\": \"https://sqladmin.googleapis.com/v1/projects/PROJECT_ID/instances/INSTANCE_ID\",\n \"status\": \"PENDING\",\n \"user\": \"user@example.com\",\n \"insertTime\": \"2019-09-25T22:19:33.735Z\",\n \"operationType\": \"CREATE\",\n \"name\": \"OPERATION_ID\",\n \"targetId\": \"INSTANCE_ID\",\n \"selfLink\": \"https://sqladmin.googleapis.com/v1/projects/PROJECT_ID/operations/OPERATION_ID\",\n \"targetProject\": \"PROJECT_ID\"\n}\n```\nThe response is a [long-running operation](/sql/docs/mysql/admin-api/rest/v1/operations) , which might take a few minutes to complete.Retrieve the automatically assigned IPv4 address for the new instance:\nBefore using any of the request data, make the following replacements:- : your project ID\n- : instance ID created in prior step\nHTTP method and URL:\n```\nGET https://sqladmin.googleapis.com/v1/projects/project-id/instances/instance-id\n```\nTo send your request, expand one of these options:You should receive a JSON response similar to the following:\n```\n{\n \"kind\": \"sql#instance\",\n \"state\": \"RUNNABLE\",\n \"databaseVersion\": \"MYSQL_8_0_18\",\n \"settings\": {\n \"authorizedGaeApplications\": [],\n \"tier\": \"db-f1-micro\",\n \"kind\": \"sql#settings\",\n \"pricingPlan\": \"PER_USE\",\n \"replicationType\": \"SYNCHRONOUS\",\n \"activationPolicy\": \"ALWAYS\",\n \"ipConfiguration\": {\n  \"authorizedNetworks\": [],\n  \"ipv4Enabled\": true\n },\n \"locationPreference\": {\n  \"zone\": \"us-west1-a\",\n  \"kind\": \"sql#locationPreference\"\n },\n \"dataDiskType\": \"PD_SSD\",\n \"backupConfiguration\": {\n  \"startTime\": \"18:00\",\n  \"kind\": \"sql#backupConfiguration\",\n  \"enabled\": true,\n  \"binaryLogEnabled\": true\n },\n \"settingsVersion\": \"1\",\n \"storageAutoResizeLimit\": \"0\",\n \"storageAutoResize\": true,\n \"dataDiskSizeGb\": \"10\"\n },\n \"etag\": \"--redacted--\",\n \"ipAddresses\": [ {\n  \"type\": \"PRIMARY\",\n  \"ipAddress\": \"10.0.0.1\"\n }\n ],\n \"serverCaCert\": {\n ...\n },\n \"instanceType\": \"CLOUD_SQL_INSTANCE\",\n \"project\": \"project-id\",\n \"serviceAccountEmailAddress\": \"redacted@gcp-sa-cloud-sql.iam.gserviceaccount.com\",\n \"backendType\": \"SECOND_GEN\",\n \"selfLink\": \"https://sqladmin.googleapis.com/v1/projects/project-id/instances/instance-id\",\n \"connectionName\": \"project-id:region:instance-id\",\n \"name\": \"instance-id\",\n \"region\": \"us-west1\",\n \"gceZone\": \"us-west1-a\"\n}\n```\nLook for the `ipAddress` field in the response.This example creates an instance. Some optional parameters, such as  backups and binary logging are also included.  For a complete list of parameters for this call, see the [instances:insert](/sql/docs/postgres/admin-api/rest/v1beta4/instances/insert) page. For information about instance settings, including valid values for  region, see [Instance settings](/sql/docs/postgres/instance-settings#settings-2ndgen) \nDo not include sensitive or personally identifiable information  in your instance ID; it is externally visible. You do not need to include the project ID in the instance name. This is done automatically where appropriate (for example, in the log files).\nBefore using any of the request data, make the following replacements:- : your project ID\n- : your instance ID\n- : the region\n- : enum string of the database version.  For example:`POSTGRES_13`\n- : the password for the root user\n- : enum string of the machine (tier) type, as:`db-custom-[CPUS]-[MEMORY_MBS]`\n- : your Cloud SQL edition\n- : (optional) set to`true`to enable data cache for your instance\nTo set a password policy while creating an instance, include the [passwordValidationPolicy](/sql/docs/postgres/admin-api/rest/v1/instances#passwordValidationPolicy) object in the request.  Set the following parameters, as required:- `enablePasswordPolicy`: Enables the password policy when set to`true`.To remove the password policy, you can use a `PATCH` request with `null` as the value for `enablePasswordPolicy` .   In this case, the other password policy parameters are reset. **Note:** When you enable a password policy, statements   that create users or change user passwords can cause additional   latency due to password policy verification.\n- `minLength`: Specifies the minimum number of characters that   the password must have.\n- `complexity`: Checks if the password is a  combination of lowercase, uppercase, numeric, and non-alphanumeric  characters. The default value is`COMPLEXITY_DEFAULT`.\n- `reuseInterval`: Specifies the number of previous passwords that you can't reuse.\n- `disallowUsernameSubstring`: Prevents the use of the username in the password   when set to`true`.\n- `passwordChangeInterval`: Specifies the minimum duration after which you can   change the password. The value is in seconds with up to nine fractional digits,   terminated by`s`. For example,`3.5s`.\nHTTP method and URL:\n```\nPOST https://sqladmin.googleapis.com/sql/v1beta4/projects/PROJECT_ID/instances\n```\nRequest JSON body:\n```\n{\n \"name\": \"INSTANCE_ID\",\n \"region\": \"REGION\",\n \"databaseVersion\": \"DATABASE_VERSION\",\n \"rootPassword\": \"PASSWORD\",\n \"settings\": {\n \"tier\": \"MACHINE_TYPE\",\n \"edition\": \"EDITION_TYPE\",\n \"dataCacheConfig\" = {\n  \"dataCacheEnabled\": DATA_CACHE_ENABLED\n },\n \"backupConfiguration\": {\n  \"enabled\": true\n },\n \"passwordValidationPolicy\": {\n  \"enablePasswordPolicy\": true\n  \"minLength\": \"MIN_LENGTH\",\n  \"complexity\": COMPLEXITY_DEFAULT,\n  \"reuseInterval\": \"REUSE_INTERVAL\",\n  \"disallowUsernameSubstring\": \"DISALLOW_USERNAME_SUBSTRING\",\n  \"passwordChangeInterval\": \"PASSWORD_CHANGE_INTERVAL\"\n }\n }\n}\n```\nTo send your request, expand one of these options:You should receive a JSON response similar to the following:\n```\n{\n \"kind\": \"sql#operation\",\n \"targetLink\": \"https://sqladmin.googleapis.com/sql/v1beta4/projects/PROJECT_ID/instances/INSTANCE_ID\",\n \"status\": \"PENDING\",\n \"user\": \"user@example.com\",\n \"insertTime\": \"2020-01-01T19:13:21.834Z\",\n \"operationType\": \"CREATE\",\n \"name\": \"OPERATION_ID\",\n \"targetId\": \"INSTANCE_ID\",\n \"selfLink\": \"https://sqladmin.googleapis.com/sql/v1beta4/projects/PROJECT_ID/operations/OPERATION_ID\",\n \"targetProject\": \"PROJECT_ID\"\n}\n```\nThe response is a [long-running operation](/sql/docs/mysql/admin-api/rest/v1beta4/operations) ,  which might take a few minutes to complete.Retrieve the automatically assigned IPv4 address for the new instance:\nBefore using any of the request data, make the following replacements:- : your project ID\n- : instance ID created in prior step\nHTTP method and URL:\n```\nGET https://sqladmin.googleapis.com/sql/v1beta4/projects/project-id/instances/instance-id\n```\nTo send your request, expand one of these options:You should receive a JSON response similar to the following:\n```\n{\n \"kind\": \"sql#instance\",\n \"state\": \"RUNNABLE\",\n \"databaseVersion\": \"MYSQL_8_0_18\",\n \"settings\": {\n \"authorizedGaeApplications\": [],\n \"tier\": \"db-f1-micro\",\n \"kind\": \"sql#settings\",\n \"pricingPlan\": \"PER_USE\",\n \"replicationType\": \"SYNCHRONOUS\",\n \"activationPolicy\": \"ALWAYS\",\n \"ipConfiguration\": {\n  \"authorizedNetworks\": [],\n  \"ipv4Enabled\": true\n },\n \"locationPreference\": {\n  \"zone\": \"us-west1-a\",\n  \"kind\": \"sql#locationPreference\"\n },\n \"dataDiskType\": \"PD_SSD\",\n \"backupConfiguration\": {\n  \"startTime\": \"18:00\",\n  \"kind\": \"sql#backupConfiguration\",\n  \"enabled\": true,\n  \"binaryLogEnabled\": true\n },\n \"settingsVersion\": \"1\",\n \"storageAutoResizeLimit\": \"0\",\n \"storageAutoResize\": true,\n \"dataDiskSizeGb\": \"10\"\n },\n \"etag\": \"--redacted--\",\n \"ipAddresses\": [ {\n  \"type\": \"PRIMARY\",\n  \"ipAddress\": \"10.0.0.1\"\n }\n ],\n \"serverCaCert\": {\n ...\n },\n \"instanceType\": \"CLOUD_SQL_INSTANCE\",\n \"project\": \"project-id\",\n \"serviceAccountEmailAddress\": \"redacted@gcp-sa-cloud-sql.iam.gserviceaccount.com\",\n \"backendType\": \"SECOND_GEN\",\n \"selfLink\": \"https://sqladmin.googleapis.com/sql/v1beta4/projects/project-id/instances/instance-id\",\n \"connectionName\": \"project-id:region:instance-id\",\n \"name\": \"instance-id\",\n \"region\": \"us-west1\",\n \"gceZone\": \"us-west1-a\"\n}\n```\nLook for the `ipAddress` field in the response.\n[underlying REST API request](/sql/docs/postgres/admin-api/rest/v1beta4/instances/insert)\n[APIs Explorer on the instances:insert page](/sql/docs/postgres/admin-api/rest/v1beta4/instances/insert)\n## Custom instance configurations\nDetermines memory and virtual cores available to your Cloud SQL  instance. Machine type availability is determined by your Cloud SQL edition.\nFor workloads that require real-time processing, such as online transaction processing  (OLTP), make sure that your instance has enough memory to contain the  entire working set. However, there are other factors that can impact  memory requirements, such as number of active connections, and internal  overhead processes. You should perform load testing to avoid performance issues in  your production environment.\nWhen you configure your instance, select enough memory and vCPUs to handle  your workload, and upgrade as your workload increases. A machine  configuration with insufficient vCPUs could lose its SLA coverage.  For more information,  see [Operational guidelines](/sql/docs/mysql/operational-guidelines) .\n**Machine types for Cloud SQL Enterprise Plus edition instances**\nFor [Cloud SQL Enterprise Plus edition](/sql/docs/postgres/editions-intro) instances, machine types are predefined as follows:\n| Enterprise plus machine type | vCPUs | Memory (GB) | Local SSD |\n|:-------------------------------|--------:|--------------:|------------:|\n| db-perf-optimized-N-2   |  2 |   16 |   375 |\n| db-perf-optimized-N-4   |  4 |   32 |   375 |\n| db-perf-optimized-N-8   |  8 |   64 |   375 |\n| db-perf-optimized-N-16   |  16 |   128 |   750 |\n| db-perf-optimized-N-32   |  32 |   256 |  1500 |\n| db-perf-optimized-N-48   |  48 |   384 |  3000 |\n| db-perf-optimized-N-64   |  64 |   512 |  6000 |\n| db-perf-optimized-N-80   |  80 |   640 |  6000 |\n| db-perf-optimized-N-96   |  96 |   768 |  6000 |\n| db-perf-optimized-N-128  |  128 |   864 |  9000 |\n**Machine types for Cloud SQL Enterprise edition instances**\nFor [Cloud SQL Enterprise edition](/sql/docs/postgres/editions-intro) instances, you can also create custom instance configurations using the [gcloud sql instances create](/sdk/gcloud/reference/sql/instances/create) command. Custom instance configurations let you select the amount of memory and CPUs that your instance needs. This flexibility lets you choose the appropriate VM shape for your workload.\nMachine type names use the following format: `db-custom-` `` `-` ``\nReplace the first placeholder with the number of CPUs in the machine, and the second placeholder with the amount of memory in the machine.\nFor example, if your machine name is `db-custom` , and your machine has 1 CPU and 3840 MB of RAM, then the format for the machine would be `db-custom-1-3840` .\nWhen selecting the number of CPUs and amount of memory, there are some restrictions on the configuration you choose:- vCPUs must be either 1 or an even number between 2 and 96.\n- Memory must be:- 0.9 to 6.5 GB per vCPU\n- A multiple of 256 MB\n- At least 3.75 GB (3840 MB)\nThe following table lists the names of each legacy machine type, the number of CPUs and RAM for each machine type, and the resultant string for the machine type.\nYou can create the equivalent machine type by specifying the equivalent CPU and RAM in the Google Cloud console, by using the gcloud CLI, or by specifying `db-custom-` `` `-` `` in the API.\n**Note:** The strings for the machine types aren't a complete list of the possible VM shapes that you can use.\n| Legacy machine type | vCPUs | Memory (MBs) | db-custom-CPU-RAM string (API tier string) |\n|:----------------------|--------:|---------------:|:---------------------------------------------|\n| db-n1-standard-1  |  1 |   3840 | db-custom-1-3840        |\n| db-n1-standard-2  |  2 |   7680 | db-custom-2-7680        |\n| db-n1-standard-4  |  4 |   15360 | db-custom-4-15360       |\n| db-n1-standard-8  |  8 |   30720 | db-custom-8-30720       |\n| db-n1-standard-16  |  16 |   61440 | db-custom-16-61440       |\n| db-n1-standard-32  |  32 |   122880 | db-custom-32-122880       |\n| db-n1-standard-64  |  64 |   245760 | db-custom-64-245760       |\n| db-n1-standard-96  |  96 |   368640 | db-custom-96-368640       |\n| db-n1-highmem-2  |  2 |   13312 | db-custom-2-13312       |\n| db-n1-highmem-4  |  4 |   26624 | db-custom-4-26624       |\n| db-n1-highmem-8  |  8 |   53248 | db-custom-8-53248       |\n| db-n1-highmem-16  |  16 |   106496 | db-custom-16-106496       |\n| db-n1-highmem-32  |  32 |   212992 | db-custom-32-212992       |\n| db-n1-highmem-64  |  64 |   425984 | db-custom-64-425984       |\n| db-n1-highmem-96  |  96 |   638976 | db-custom-96-638976       |\n## Troubleshoot\n| Issue                                     | Troubleshooting                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     |\n|:------------------------------------------------------------------------------------------------------------------------------------------------------|:--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|\n| Error message: Failed to create subnetwork. Couldn't find free blocks in allocated IP ranges. Please allocate new ranges for this service provider. | There are no more available addresses in the allocated IP range. There can be several possible scenarios: The size of the allocated IP range for the private service connection is smaller than /24. The size of the allocated IP range for the private service connection is too small for the number of Cloud SQL instances. The requirement on the size of allocated IP range will be larger if instances are created in multiple regions. See allocated range size To resolve this issue, you can either expand the existing allocated IP range or allocate an additional IP range to the private service connection. For more information, see Allocate an IP address range. If you used the --allocated-ip-range-name flag while creating the Cloud SQL instance, you may only expand the specified IP range. If you're allocating a new range, take care that the allocation doesn't overlap with any existing allocations. After creating a new IP range, update the vpc peering with the following command: gcloud services vpc-peerings update \\ --service=servicenetworking.googleapis.com \\ --ranges=OLD_RESERVED_RANGE_NAME,NEW_RESERVED_RANGE_NAME \\ --network=VPC_NETWORK \\ --project=PROJECT_ID \\ --force If you're expanding an existing allocation, take care to increase only the allocation range and not decrease it. For example, if the original allocation was 10.0.10.0/24, then make the new allocation at least 10.0.10.0/23. In general, if starting from a /24 allocation, decrementing the /mask by 1 for each condition (additional instance type group, additional region) is a good rule of thumb. For example, if trying to create both instance type groups on the same allocation, going from /24 to /23 is enough. After expanding an existing IP range, update the vpc peering with following command: gcloud services vpc-peerings update \\ --service=servicenetworking.googleapis.com \\ --ranges=RESERVED_RANGE_NAME \\ --network=VPC_NETWORK \\ --project=PROJECT_ID |\n| Error message: Failed to create subnetwork. Router status is temporarily unavailable. Please try again later. Help Token: [token-ID].    | Try to create the Cloud SQL instance again.                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |\n## What's next\n- [Create a PostgreSQL database on the instance](/sql/docs/postgres/create-manage-databases) .\n- [Create PostgreSQL users on the instance](/sql/docs/postgres/create-manage-users) .\n- [Secure and control access to the instance](/sql/docs/postgres/instance-access-control) .\n- [Connect to the instance with a PostgreSQL client](/sql/docs/postgres/connect-admin-ip) .\n- [Import data into the database](/sql/docs/postgres/import-export) .", "guide": "Cloud SQL"}