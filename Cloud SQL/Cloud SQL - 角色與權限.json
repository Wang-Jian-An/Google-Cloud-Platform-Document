{"title": "Cloud SQL - \u89d2\u8272\u8207\u6b0a\u9650", "url": "https://cloud.google.com/sql/docs/postgres/roles-and-permissions?hl=zh-cn", "abstract": "# Cloud SQL - \u89d2\u8272\u8207\u6b0a\u9650\n\u672c\u9801\u9762\u4ecb\u7d39\u4e86 Identity and Access Management (IAM) \u89d2\u8272\u548c\u6b0a\u9650\u4ee5\u53ca\u5b83\u5011\u5982\u4f55\u8207 Cloud SQL \u5be6\u4f8b\u914d\u5408\u4f7f\u7528\u3002\n", "content": "## \u7c21\u4ecb\n\u672c\u9801\u9762\u91cd\u9ede\u4ecb\u7d39\u4e86\u8207 Cloud SQL \u76f8\u95dc\u7684 IAM \u529f\u80fd\u3002\u5982\u9700\u77ad\u89e3 IAM \u53ca\u5176\u529f\u80fd\u7684\u8a73\u7d30\u8aaa\u660e\uff0c\u8acb\u53c3\u95b1 [Identity and Access Management](https://cloud.google.com/iam?hl=zh-cn) \uff0c\u5c24\u5176\u61c9\u53c3\u95b1 [\u7ba1\u7406 IAM \u653f\u7b56](https://cloud.google.com/iam/docs/granting-changing-revoking-access?hl=zh-cn) \u90e8\u5206\u3002 \u85c9\u52a9 IAM\uff0c\u60a8\u53ef\u4ee5\u63a7\u5236\u8ab0\u6709\u6b0a\u8a2a\u554f\u60a8\u7684 Google Cloud \u9805\u76ee\u4e2d\u7684\u8cc7\u6e90 \u3002\u60a8\u61c9\u7528\u65bc\u8cc7\u6e90\u7684\u4e00\u7d44\u8a2a\u554f\u898f\u5247\u7a31\u7232 IAM \u653f\u7b56 \u3002\u61c9\u7528\u65bc\u9805\u76ee\u7684 IAM \u653f\u7b56\u5b9a\u7fa9\u4e86\u7528\u6236\u53ef\u4ee5\u5c0d\u9805\u76ee\u4e2d\u7684\u6240\u6709\u8cc7\u6e90\u57f7\u884c\u7684\u64cd\u4f5c\u3002\n\u6210\u54e1\u6307\u7684\u662f IAM \u9069\u7528\u7684\u201c\u8ab0\u201d\u3002\u6210\u54e1\u53ef\u4ee5\u662f\u500b\u4eba\u7528\u6236\u3001\u7fa3\u7d44\u3001\u7db2\u57df\uff0c\u751a\u81f3\u662f\u5168\u9ad4\u516c\u8846\u3002\u6210\u54e1\u6703\u88ab\u5206\u914d\u89d2\u8272 \uff0c\u9019\u4e9b\u89d2\u8272\u4f7f\u6210\u54e1\u80fd\u5920\u5728 Cloud SQL \u4ee5\u53ca\u6574\u500b Google Cloud \u4e2d\u57f7\u884c\u64cd\u4f5c\u3002\u6bcf\u500b\u89d2\u8272\u90fd\u662f\u4e00\u500b\u6216\u591a\u500b\u6b0a\u9650\u7684\u96c6\u5408\u3002 \u6b0a\u9650\u662f IAM \u7684\u57fa\u672c\u55ae\u4f4d\uff1a\u6bcf\u500b\u6b0a\u9650\u5141\u8a31\u60a8\u57f7\u884c\u4e00\u7a2e\u7279\u5b9a\u7684\u64cd\u4f5c\u3002\u5982\u9700\u67e5\u770b Cloud SQL \u4e2d\u6240\u6709\u89d2\u8272\u548c\u6b0a\u9650\u7684\u5b8c\u6574\u5217\u8868\uff0c\u8acb\u53c3\u95b1 [Cloud SQL \u4e2d\u7684 IAM \u89d2\u8272](https://cloud.google.com/sql/docs/postgres/iam-roles?hl=zh-cn) \u548c [Cloud SQL \u4e2d\u7684 IAM \u6b0a\u9650](https://cloud.google.com/sql/docs/postgres/iam-permissions?hl=zh-cn) \u3002\n\u7576\u60a8\u4f7f\u7528\u8cec\u865f\u9023\u63a5\u5230 Cloud SQL \u5be6\u4f8b\u6642\uff0c\u8cec\u865f\u5fc5\u9808\u5177\u6709 **Cloud SQL > Client** \u89d2\u8272 ( `roles/cloudsql.client` )\uff0c\u8a72\u89d2\u8272\u64c1\u6709\u9023\u63a5\u6240\u9700\u7684 [\u6b0a\u9650](https://cloud.google.com/sql/docs/postgres/iam-permissions?hl=zh-cn) \u3002\n\u60a8\u53ef\u4ee5\u5728\u63a7\u5236\u6aaf\u7684 [IAM \u548c\u7ba1\u7406 > IAM](https://console.developers.google.com/iam-admin/iam?hl=zh-cn) \u9801\u9762\u4e2d\u5411\u8cec\u865f\u6dfb\u52a0\u89d2\u8272\uff0c\u4e26\u5728 [IAM \u548c\u7ba1\u7406 > \u89d2\u8272](https://console.developers.google.com/iam-admin/roles?hl=zh-cn) \u9801\u9762\u4e2d\u67e5\u770b\u54ea\u4e9b\u6b0a\u9650\u5c6c\u65bc\u54ea\u4e9b\u89d2\u8272\u3002\nCloud SQL \u4f7f\u7528\u670d\u52d9\u8cec\u865f\u5728 Cloud SQL \u548c\u5176\u4ed6 Google Cloud \u7522\u54c1\u4e4b\u9593\u9032\u884c\u8eab\u4efd\u9a57\u8b49\u3002\u670d\u52d9\u8cec\u865f\u4ee5 JSON \u683c\u5f0f\u63d0\u4f9b `credentials` \uff0c\u60a8\u53ef\u4ee5\u5f9e\u63a7\u5236\u6aaf\u9032\u884c\u4e0b\u8f09\uff0c\u4e26\u5728\u5404\u7a2e\u5834\u666f\u4e2d\u4f7f\u7528\u4ee5\u9032\u884c\u8eab\u4efd\u9a57\u8b49\u3002\n[docker \u5bb9\u5668](https://cloud.google.com/sql/docs/postgres/connect-docker?hl=zh-cn#connect-client)\n## Cloud SQL Auth \u4ee3\u7406\u6240\u9700\u7684 Cloud SQL \u89d2\u8272\u548c\u6b0a\u9650\n\u5982\u679c\u60a8\u8981\u4f7f\u7528 [Cloud SQL Auth \u4ee3\u7406](https://cloud.google.com/sql/docs/postgres/connect-auth-proxy?hl=zh-cn#create-service-account) \u5f9e Compute Engine \u5be6\u4f8b\u9023\u63a5\u5230 Cloud SQL \u5be6\u4f8b\uff0c\u5247\u53ef\u4ee5\u4f7f\u7528\u8207\u8a72 Compute Engine \u5be6\u4f8b\u95dc\u806f\u7684\u9ed8\u8a8d Compute Engine \u670d\u52d9\u8cec\u865f\u3002\n\u8207\u9023\u63a5\u5230 Cloud SQL \u5be6\u4f8b\u7684\u6240\u6709\u8cec\u865f\u4e00\u6a23\uff0c\u6b64\u670d\u52d9\u8cec\u865f\u5fc5\u9808\u5177\u6709 **Cloud SQL > Client** \u89d2\u8272\u3002\n## \u7121\u670d\u52d9\u5668\u65b9\u6848\u6240\u9700\u7684 Cloud SQL \u89d2\u8272\u548c\u6b0a\u9650\n[\u7121\u670d\u52d9\u5668\u65b9\u6848](https://cloud.google.com/serverless-options?hl=zh-cn)\n[App Engine](https://cloud.google.com/sql/docs/postgres/connect-app-engine?hl=zh-cn)\n[Cloud Functions](https://cloud.google.com/sql/docs/postgres/connect-functions?hl=zh-cn)\n[Cloud Run](https://cloud.google.com/sql/docs/postgres/connect-run?hl=zh-cn)\n\u4f7f\u7528\u670d\u52d9\u8cec\u865f\u53ef\u6388\u6b0a\u901a\u904e\u9019\u4e9b\u65b9\u6848\u9032\u884c\u8a2a\u554f\u3002\u670d\u52d9\u8cec\u865f\u53ef\u6388\u4e88\u5c0d\u7279\u5b9a\u9805\u76ee\u4e2d\u6240\u6709 Cloud SQL \u7684\u8a2a\u554f\u6b0a\u9650\u3002\u7576\u60a8\u5275\u5efa\u61c9\u7528\u6216 Cloud Functions \u51fd\u6578\u6642\uff0c\u6b64\u670d\u52d9\u6703\u7232\u60a8\u5275\u5efa\u6b64\u8cec\u865f\u3002\u60a8\u53ef\u4ee5\u901a\u904e\u76f8\u61c9\u7684\u5f8c\u7db4\u5728 [IAM \u548c\u7ba1\u7406 > IAM](https://console.developers.google.com/iam-admin/iam?hl=zh-cn) \u9801\u9762\u4e0a\u627e\u5230\u8a72\u8cec\u865f\uff1a\n| \u7121\u670d\u52d9\u5668\u65b9\u6848 | \u670d\u52d9\u8cec\u865f\u5f8c\u7db4          |\n|:----------------|:-------------------------------------------------|\n| App Engine  | @gae-api-prod.google.com.iam.gserviceaccount.com |\n| Cloud Functions | @appspot.gserviceaccount.com      |\n| Cloud Run  | compute@developer.gserviceaccount.com   |\n**Cloud SQL > Client**\n**\u6ce8\u610f** \uff1a\u5982\u679c\u670d\u52d9\u8cec\u865f\u9023\u63a5\u5230\u5be6\u4f8b\u6642\u986f\u793a`The caller does not have permission Connection matched pg_hba.conf line 20: \"local all +cloudsqliamuser cloudsql-iam-user\"`\u932f\u8aa4\u6d88\u606f\uff0c\u8acb\u5c07 **Cloud SQL Instance User** \u89d2\u8272\u6dfb\u52a0\u5230\u8a72\u8cec\u865f\u3002\n## Cloud Storage \u6240\u9700\u7684 Cloud SQL \u89d2\u8272\u548c\u6b0a\u9650\nCloud SQL \u4e2d\u7684\u5c0e\u5165\u548c\u5c0e\u51fa\u529f\u80fd\u53ef\u642d\u914d\u4f7f\u7528\u3002\u5c0e\u51fa\u5167\u5bb9\u53ef\u4ee5\u5beb\u5165 Cloud Storage\uff0c\u4e5f\u53ef\u4ee5\u5f9e Cloud Storage \u4e2d\u8b80\u53d6\u5c0e\u5165\u7684\u5167\u5bb9\u3002\u56e0\u6b64\uff0c\u7528\u65bc\u57f7\u884c\u9019\u4e9b\u64cd\u4f5c\u7684\u670d\u52d9\u8cec\u865f\u9700\u8981\u540c\u6642\u5177\u5099\u5c0d Cloud Storage \u7684\u8b80\u5beb\u6b0a\u9650\uff1a\n- \u5982\u9700\u5411 Cloud Storage \u5c0e\u5165\u6578\u64da\u4ee5\u53ca\u5f9e Cloud Storage \u5c0e\u51fa\u6578\u64da\uff0cCloud SQL \u5be6\u4f8b\u7684\u670d\u52d9\u8cec\u865f\u5fc5\u9808\u5728\u9805\u76ee\u4e2d\u8a2d\u7f6e`storage.objectAdmin`IAM \u89d2\u8272\u3002\u60a8\u53ef\u4ee5\u5728 Google Cloud \u63a7\u5236\u6aaf\u7684\u5be6\u4f8b **\u6982\u89bd** \u9801\u9762\u4e0a\u627e\u5230\u5be6\u4f8b\u7684\u670d\u52d9\u8cec\u865f\u540d\u7a31\u3002\n- \u60a8\u53ef\u4ee5\u4f7f\u7528` [gsutiliam](https://cloud.google.com/storage/docs/gsutil/commands/iam?hl=zh-cn) `\u547d\u4ee4\u5411\u670d\u52d9\u8cec\u865f\u6388\u4e88\u8a72\u5b58\u5132\u5206\u5340\u7684\u6b64 [IAM \u89d2\u8272](https://cloud.google.com/storage/docs/access-control/iam-roles?hl=zh-cn) \u3002\n- \u5982\u9700\u6709\u95dc\u8a2d\u7f6e IAM \u89d2\u8272\u548c\u6b0a\u9650\u7684\u5e6b\u52a9\uff0c\u8acb\u53c3\u95b1 [\u4f7f\u7528 IAM \u6b0a\u9650](https://cloud.google.com/storage/docs/access-control/using-iam-permissions?hl=zh-cn) \u3002\n- \u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1\u9069\u7528\u65bc Cloud Storage \u7684 [IAM](https://cloud.google.com/storage/docs/access-control/iam?hl=zh-cn) \u3002\n## \u8a2a\u554f\u5c08\u7528 Cloud SQL \u5be6\u4f8b\u7684\u6b0a\u9650\n\u7576\u5176\u4ed6 Google Cloud \u670d\u52d9\uff08\u4f8b\u5982 BigQuery\uff09\u9700\u8981\u8207\u60a8\u7684 Cloud SQL \u5be6\u4f8b\u901a\u4fe1\u4ee5\u8a2a\u554f\u6578\u64da\u4e26\u901a\u904e\u5c08\u7528\u9023\u63a5\u5c0d\u6b64\u6578\u64da\u9032\u884c\u67e5\u8a62\u6642\uff0c\u8a72\u670d\u52d9\u6703\u4f7f\u7528 [\u5167\u90e8\u8def\u5f91](https://cloud.google.com/sql/docs/postgres/instance-settings?hl=zh-cn#private-path) \uff0c\u800c\u4e0d\u662f Virtual Private Cloud (VPC) \u5167\u7684\u5c08\u7528 IP \u5730\u5740\u3002\u6d41\u91cf\u7121\u6cd5\u901a\u904e\u4efb\u4f55 VPC \u7d1a\u914d\u7f6e\u3001\u9632\u706b\u7246\u898f\u5247\u3001\u8def\u7531\u653f\u7b56\u6216\u5c0d\u7b49\u4e92\u9023\u5207\u65b7\u9032\u884c\u63a7\u5236\u6216\u9650\u5236\u3002\n\u800c\u662f Cloud SQL \u5728\u60a8\u7684\u5be6\u4f8b\u4e0a\u63d0\u4f9b\u914d\u7f6e\u6a19\u8a8c\uff0c\u4ee5\u63a7\u5236\u662f\u5426\u7232\u8a2a\u554f\u6578\u64da\u5eab\u7684\u5176\u4ed6 Google Cloud \u670d\u52d9\u958b\u5553\u6216\u95dc\u9589\u6b64\u5167\u90e8\u8def\u5f91\u3002\n### \u63a7\u5236\u548c\u64a4\u92b7\u6b0a\u9650\n\u7576\u5176\u4ed6 Google Cloud \u670d\u52d9\uff08\u4f8b\u5982 BigQuery\uff09\u5617\u8a66\u8a2a\u554f\u60a8\u7684\u5c08\u7528 Cloud SQL \u5be6\u4f8b\u6642\uff0c\u5b83\u5fc5\u9808\u63d0\u4f9b\u5177\u6709 ` [cloudsql.instances.connect](https://cloud.google.com/iam/docs/permissions-reference?hl=zh-cn) ` IAM \u6b0a\u9650\u7684\u5408\u6cd5\u8eab\u4efd\u3002\n\u901a\u5e38\uff0c\u670d\u52d9\u53ef\u4ee5\u901a\u904e\u5169\u7a2e\u65b9\u5f0f\u4f86\u5be6\u73fe\u6b64\u76ee\u7684\uff1a\n- \u8f49\u767c\u7528\u6236\u7684\u6191\u64da\u3002\u670d\u52d9\u53ef\u4ee5\u5c07\u7528\u6236\u7684 IAM \u8eab\u4efd\u8f49\u767c\u5230 Cloud SQL\uff0c\u4ee5\u8a55\u4f30\u8a2a\u554f\u5be6\u4f8b\u7684\u6b0a\u9650\u3002\u5728\u9019\u7a2e\u60c5\u6cc1\u4e0b\uff0c\u7528\u6236\u5fc5\u9808\u5177\u6709\u8db3\u5920\u7684 IAM \u6b0a\u9650\uff0c\u624d\u80fd\u4f7f Cloud SQL \u6210\u529f\u9023\u63a5\u3002\n- \u4f7f\u7528\u670d\u52d9\u8cec\u865f\u3002BigQuery \u7b49\u670d\u52d9\u53ef\u4ee5\u4f7f\u7528\u9810\u914d\u7f6e\u7684\u670d\u52d9\u8cec\u865f\u9023\u63a5\u5230 Cloud SQL \u5be6\u4f8b\u3002\u5728\u9019\u7a2e\u60c5\u6cc1\u4e0b\uff0c\u670d\u52d9\u8cec\u865f\u5fc5\u9808\u5177\u6709\u8db3\u5920\u7684 IAM \u6b0a\u9650\u3002\u4f8b\u5982\uff0c\u5c0d\u65bc BigQuery \u8207 Cloud SQL \u4e4b\u9593\u7684\u806f\u5408\u9023\u63a5\uff0c\u5728\u6fc0\u6d3b BigQuery Connection API \u5f8c\uff0c\u7cfb\u7d71\u6703\u5275\u5efa\u4e00\u500b\u540d\u7232 `service-{PROJECT_NUMBER}@gcp-sa-bigqueryconnection.iam.gserviceaccount.com` \u7684\u670d\u52d9\u8cec\u865f\u3002\u6b64\u670d\u52d9\u8cec\u865f\u5177\u6709\u5169\u9805 Cloud SQL \u6b0a\u9650\uff1a ` [cloudsql.instances.connect](https://cloud.google.com/iam/docs/permissions-reference?hl=zh-cn) ` \u548c ` [cloudsql.instances.get](https://cloud.google.com/iam/docs/permissions-reference?hl=zh-cn) ` \u3002BigQuery \u6703\u4f7f\u7528\u9019\u4e9b\u6b0a\u9650\u901a\u904e [\u5167\u90e8\u8def\u5f91](https://cloud.google.com/sql/docs/postgres/instance-settings?hl=zh-cn#private-path) \u8a2a\u554f\u5c08\u7528 Cloud SQL \u5be6\u4f8b\u3002\n\u5982\u9700\u63a7\u5236\u8ab0\u53ef\u4ee5\u4f7f\u7528\u6b64\u5167\u90e8\u8def\u5f91\u7684\u6b0a\u9650\uff0c\u60a8\u53ef\u4ee5\u6388\u4e88\u548c\u64a4\u92b7 Google Cloud \u670d\u52d9\uff08\u4f8b\u5982 BigQuery\uff09\u7528\u65bc\u9023\u63a5\u5230 Cloud SQL \u5be6\u4f8b\u7684\u7528\u6236 IAM \u8eab\u4efd\u7684 IAM \u6b0a\u9650\u3002\u5982\u9700\u8a73\u7d30\u77ad\u89e3\u5982\u4f55\u5728 BigQuery \u4e2d\u6388\u4e88\u548c\u64a4\u92b7\u6b0a\u9650\uff0c\u8acb\u53c3\u95b1 [\u8a2d\u7f6e\u5c0d Cloud SQL \u7684\u8a2a\u554f\u6b0a\u9650](https://cloud.google.com/bigquery/docs/cloud-sql-federated-queries?hl=zh-cn#access-sql) \u3002\n## \u5176\u4ed6\u5834\u666f\u6240\u9700\u7684 Cloud SQL \u89d2\u8272\u548c\u6b0a\u9650\nCloud SQL \u53ef\u8207\u5176\u4ed6 Google Cloud \u7522\u54c1\u548c\u5de5\u5177\u9032\u884c\u4ea4\u4e92\u3002\u9019\u4e9b\u4ea4\u4e92\u9084\u9700\u8981\u7279\u5b9a\u89d2\u8272\u548c\u6b0a\u9650\uff0c\u5177\u9ad4\u89d2\u8272\u548c\u6b0a\u9650\u56e0\u5834\u666f\u800c\u7570\u3002Cloud SQL \u6587\u6a94\u7232\u4ee5\u4e0b\u60c5\u6cc1\u63d0\u4f9b\u4e86\u8a73\u7d30\u7684\u8981\u6c42\u4fe1\u606f\uff1a\n- [\u5f9e\u5916\u90e8\u61c9\u7528\u9023\u63a5\u5230 Cloud SQL](https://cloud.google.com/sql/docs/postgres/connect-overview?hl=zh-cn) \u3002\n- [\u4f7f\u7528\u5ba2\u6236\u7ba1\u7406\u7684\u52a0\u5bc6\u5bc6\u9470 (CMEK)](https://cloud.google.com/sql/docs/postgres/configure-cmek?hl=zh-cn) \u3002\n- [\u7528\u65bc\u7ba1\u7406 VPC Service Controls \u7684 IAM \u89d2\u8272](https://cloud.google.com/vpc-service-controls/docs/access-control?hl=zh-cn) \u3002\n- \u7232\u4e86\u5f9e\u5728 Google Kubernetes Engine \u4e2d\u904b\u884c\u7684\u61c9\u7528\u9023\u63a5\u5230 Cloud SQL \u5be6\u4f8b\uff0c\u60a8\u9700\u8981\u7232 [\u670d\u52d9\u8cec\u865f](https://cloud.google.com/sql/docs/postgres/connect-auth-proxy?hl=zh-cn#create-service-account) \u7684 JSON \u5bc6\u9470\u6587\u4ef6\u5275\u5efa [Secret](https://cloud.google.com/sql/docs/postgres/connect-kubernetes-engine?hl=zh-cn#secrets) \u3002\n## \u5c07 IAM \u7528\u65bc\u9805\u76ee\n\u4ee5\u4e0b\u5404\u90e8\u5206\u4ecb\u7d39\u77ad\u5982\u4f55\u5728\u9805\u76ee\u4e2d\u5b8c\u6210\u57fa\u672c\u7684 IAM \u4efb\u52d9\u3002\n\u60a8\u5fc5\u9808\u5177\u5099 `resourcemanager.projects.getIamPolicy` \u548c `resourcemanager.projects.setIamPolicy` IAM \u6b0a\u9650\u624d\u80fd\u5b8c\u6210\u4ee5\u4e0b\u4efb\u52d9\u3002\n### \u5c07\u6210\u54e1\u6dfb\u52a0\u5230\u9805\u76ee\u7d1a\u653f\u7b56\n\u5982\u9700\u67e5\u770b\u8207 Cloud SQL \u95dc\u806f\u7684\u89d2\u8272\u5217\u8868\uff0c\u8acb\u53c3\u95b1 [IAM \u89d2\u8272](https://cloud.google.com/sql/docs/postgres/iam-roles?hl=zh-cn) \u3002\n- \u8f49\u5230 Google Cloud \u63a7\u5236\u6aaf\u4e2d\u7684 [IAM \u548c\u7ba1\u7406](https://console.cloud.google.com/iam-admin?hl=zh-cn) \u9801\u9762\n- \u5728\u9802\u6b04\u7684\u9805\u76ee\u4e0b\u62c9\u83dc\u55ae\u4e2d\uff0c\u9078\u64c7\u8981\u6dfb\u52a0\u6210\u54e1\u7684\u9805\u76ee\u3002\n- \u9ede\u64ca **\u6dfb\u52a0** \u3002\u7cfb\u7d71\u6703\u986f\u793a **\u5411\u9805\u76ee\u6dfb\u52a0\u6210\u54e1\uff0c\u89d2\u8272** \u5c0d\u8a71\u6846\u3002\n- \u5728 **\u65b0\u6210\u54e1** \u5b57\u6bb5\u4e2d\uff0c\u6307\u5b9a\u60a8\u8981\u6388\u4e88\u8a2a\u554f\u6b0a\u9650\u7684\u5be6\u9ad4\u7684\u540d\u7a31\u3002\n- \u5728 **\u9078\u64c7\u89d2\u8272** \u4e0b\u62c9\u83dc\u55ae\u4e2d\uff0c\u5411\u6210\u54e1\u6388\u4e88\u9069\u7576\u7684\u89d2\u8272\u3002 \u60a8\u53ef\u4ee5\u5728 **\u9805\u76ee** \u548c **Cloud SQL** \u5b50\u83dc\u55ae\u4e2d\u627e\u5230\u5f71\u97ff Cloud SQL \u8cc7\u6e90\u7684\u89d2\u8272\u3002\n- \u9ede\u64ca **\u4fdd\u5b58** \u3002\n\u9805\u76ee\u7d1a IAM \u653f\u7b56\u901a\u904e `gcloud` \u547d\u4ee4\u9032\u884c\u7ba1\u7406\uff0c\u8a72\u547d\u4ee4\u662f Google Cloud SDK \u7684\u4e00\u90e8\u5206\u3002\u5982\u9700\u6dfb\u52a0\u9805\u76ee\u7d1a\u653f\u7b56\uff0c\u8acb\u4f7f\u7528 [gcloud beta projects add-iam-policy-binding](https://cloud.google.com/sdk/gcloud/reference/beta/projects/add-iam-policy-binding?hl=zh-cn) \u3002\n### \u67e5\u770b\u9805\u76ee\u7684 IAM \u653f\u7b56\n- \u8f49\u5230 Google Cloud \u63a7\u5236\u6aaf\u4e2d\u7684 [IAM \u548c\u7ba1\u7406](https://console.cloud.google.com/iam-admin?hl=zh-cn) \u9801\u9762\n- \u5728\u9802\u6b04\u7684\u9805\u76ee\u4e0b\u62c9\u83dc\u55ae\u4e2d\uff0c\u9078\u64c7\u8981\u67e5\u770b\u7684\u653f\u7b56\u6240\u5c6c\u7684\u9805\u76ee\u3002\n- \u67e5\u770b\u9805\u76ee\u6b0a\u9650\u7684\u65b9\u6cd5\u6709\u5169\u7a2e\uff1a\n- \u6309 **\u6210\u54e1\u67e5\u770b** \uff1a\u67e5\u770b\u8207\u5404\u500b\u6210\u54e1\u76f8\u95dc\u806f\u7684 **\u89d2\u8272** \u5217\uff0c\u77ad\u89e3\u5404\u6210\u54e1\u5177\u6709\u54ea\u4e9b\u89d2\u8272\u3002\n- \u6309 **\u89d2\u8272** \u67e5\u770b\uff1a\u4f7f\u7528\u8207\u5404\u500b\u89d2\u8272\u76f8\u95dc\u806f\u7684\u4e0b\u62c9\u5217\u8868\uff0c\u67e5\u770b\u54ea\u4e9b\u6210\u54e1\u5177\u6709\u6b64\u89d2\u8272\u3002\n\u9805\u76ee\u7d1a IAM \u653f\u7b56\u901a\u904e `gcloud` \u547d\u4ee4\u9032\u884c\u7ba1\u7406\uff0c\u8a72\u547d\u4ee4\u662f Google Cloud SDK \u7684\u4e00\u90e8\u5206\u3002\u5982\u9700\u67e5\u770b\u9805\u76ee\u7684 IAM \u653f\u7b56\uff0c\u8acb\u4f7f\u7528 [gcloud beta projects get-iam-policy](https://cloud.google.com/sdk/gcloud/reference/beta/projects/get-iam-policy?hl=zh-cn) \u547d\u4ee4\u3002\n### \u5f9e\u9805\u76ee\u7d1a\u653f\u7b56\u4e2d\u79fb\u9664\u6210\u54e1\n- \u8f49\u5230 Google Cloud \u63a7\u5236\u6aaf\u4e2d\u7684 [IAM \u548c\u7ba1\u7406](https://console.cloud.google.com/iam-admin?hl=zh-cn) \u9801\u9762\n- \u5728\u9802\u6b04\u7684\u9805\u76ee\u4e0b\u62c9\u83dc\u55ae\u4e2d\uff0c\u9078\u64c7\u8981\u79fb\u9664\u6210\u54e1\u7684\u9805\u76ee\u3002\n- \u78ba\u4fdd\u60a8\u6b63\u5728\u6309 **\u6210\u54e1** \u67e5\u770b\u6b0a\u9650\uff0c\u4e26\u9078\u64c7\u8981\u79fb\u9664\u7684\u6210\u54e1\u3002\n- \u9ede\u64ca **\u79fb\u9664** \u3002\n- \u5728\u51fa\u73fe\u7684\u758a\u52a0\u7a97\u53e3\u4e2d\uff0c\u9ede\u64ca **\u78ba\u8a8d** \u3002\n\u9805\u76ee\u7d1a IAM \u653f\u7b56\u901a\u904e `gcloud` \u547d\u4ee4\u9032\u884c\u7ba1\u7406\uff0c\u8a72\u547d\u4ee4\u662f Google Cloud SDK \u7684\u4e00\u90e8\u5206\u3002\u5982\u9700\u79fb\u9664\u9805\u76ee\u7d1a\u653f\u7b56\uff0c\u8acb\u4f7f\u7528 [gcloud beta projects remove-iam-policy-binding](https://cloud.google.com/sdk/gcloud/reference/beta/projects/remove-iam-policy-binding?hl=zh-cn) \u3002\n**\u91cd\u8981\u63d0\u793a** \uff1a\u64a4\u6d88\u8a2a\u554f\u6b0a\u9650\u7684\u64cd\u4f5c\u901a\u5e38\u9700\u8981\u5927\u7d04\u4e00\u5206\u9418\u624d\u80fd\u751f\u6548\u3002\u5728\u67d0\u4e9b\u60c5\u6cc1\u4e0b\uff0c\u53ef\u80fd\u9700\u8981\u66f4\u9577\u6642\u9593\u3002\u5982\u679c\u60a8\u79fb\u9664\u67d0\u7528\u6236\u7684\u8a2a\u554f\u6b0a\u9650\uff0c\u6b64\u66f4\u6539\u6703\u7acb\u5373\u53cd\u6620\u5728\u5143\u6578\u64da\u4e2d\uff1b\u4f46\u662f\uff0c\u77ed\u6642\u9593\u5167\u8a72\u7528\u6236\u53ef\u80fd\u4ecd\u7136\u80fd\u5920\u8a2a\u554f\u8a72\u5c0d\u8c61\u3002\n## \u6700\u4f73\u505a\u6cd5\n\u8207\u4efb\u4f55\u5176\u4ed6\u7ba1\u7406\u8a2d\u7f6e\u4e00\u6a23\uff0c\u60a8\u5fc5\u9808\u5c0d IAM \u9032\u884c\u4e3b\u52d5\u7ba1\u7406\u4ee5\u4f7f\u4e4b\u751f\u6548\u3002\u5728\u4f7f\u5176\u4ed6\u7528\u6236\u53ef\u4ee5\u8a2a\u554f\u8cc7\u6e90\u4e4b\u524d\uff0c\u8acb\u78ba\u4fdd\u60a8\u77e5\u9053\u60a8\u5e0c\u671b\u9019\u4e9b\u4eba\u4e2d\u7684\u6bcf\u500b\u4eba\u626e\u6f14\u4ec0\u9ebc\u89d2\u8272\u3002\u4e00\u6bb5\u6642\u9593\u5f8c\uff0c\u5982\u679c\u9805\u76ee\u7ba1\u7406\u3001\u4f7f\u7528\u6a21\u5f0f\u548c\u7d44\u7e54\u6240\u6709\u6b0a\u767c\u751f\u8b8a\u5316\uff0c\u60a8\u53ef\u80fd\u9700\u8981\u4fee\u6539\u9805\u76ee\u7684 IAM \u8a2d\u7f6e\uff08\u7279\u5225\u662f\u7576\u60a8\u5728\u5927\u578b\u7d44\u7e54\u4e2d\u6216\u9762\u5c0d\u5927\u898f\u6a21\u7528\u6236\u7684\u60c5\u6cc1\u4e0b\u7ba1\u7406 Cloud SQL \u6642\uff09\u3002\u5728\u8a55\u4f30\u548c\u898f\u5283\u8a2a\u554f\u6b0a\u9650\u63a7\u5236\u8a2d\u7f6e\u6642\uff0c\u8acb\u8b39\u8a18\u4ee5\u4e0b\u6700\u4f73\u505a\u6cd5\uff1a\n- **\u6388\u4e88\u8a2a\u554f\u6b0a\u9650\u6642\uff0c\u8acb\u9075\u5faa\u6700\u5c0f\u6b0a\u9650\u539f\u5247\u3002**  [\u6700\u5c0f\u6b0a\u9650\u539f\u5247](https://en.wikipedia.org/wiki/Principle_of_least_privilege) \u662f\u95dc\u65bc\u6388\u4e88\u5c0d\u8cc7\u6e90\u7684\u8a2a\u554f\u6b0a\u9650\u7684\u4e00\u9805\u5b89\u5168\u6e96\u5247\u3002\u5982\u679c\u6839\u64da\u6700\u5c0f\u6b0a\u9650\u539f\u5247\u6388\u4e88\u8a2a\u554f\u6b0a\u9650\uff0c\u5247\u50c5\u5c07\u7232\u7528\u6236\u6388\u4e88\u5b8c\u6210\u5206\u914d\u5230\u7684\u4efb\u52d9\u6240\u9700\u7684\u8a2a\u554f\u6b0a\u9650\u3002\n- **\u907f\u514d\u5411\u964c\u751f\u4eba\u6388\u4e88\u5177\u6709 setIamPolicy \u6b0a\u9650\u7684\u89d2\u8272\u3002** \u6388\u4e88 `setIamPolicy` \u6b0a\u9650\u5f8c\uff0c\u7372\u5f97\u6388\u6b0a\u7684\u7528\u6236\u53ef\u4ee5\u66f4\u6539\u6b0a\u9650\u548c\u63a7\u5236\u6578\u64da\u3002\u53ea\u6709\u5728\u60a8\u5e0c\u671b\u5c07\u5c0d\u8c61\u548c\u5b58\u5132\u5206\u5340\u7684\u7ba1\u7406\u63a7\u5236\u6b0a\u59d4\u8a17\u7d66\u4ed6\u4eba\u6642\uff0c\u60a8\u624d\u61c9\u4f7f\u7528\u5177\u6709 `setIamPolicy` \u6b0a\u9650\u7684\u89d2\u8272\u3002\n- **\u8acb\u78ba\u4fdd\u5c07\u60a8\u8cc7\u6e90\u7684\u7ba1\u7406\u63a7\u5236\u6b0a\u59d4\u8a17\u7d66\u4ed6\u4eba\u3002** \u5982\u679c\u5177\u6709\u7ba1\u7406\u54e1\u6b0a\u9650\u7684\u67d0\u500b\u4eba\u96e2\u958b\u4e86\u7fa3\u7d44\uff0c\u5247\u60a8\u61c9\u78ba\u4fdd\u60a8\u7684\u8cc7\u6e90\u4ecd\u53ef\u7531\u5176\u4ed6\u5718\u968a\u6210\u54e1\u7ba1\u7406\u3002\u5be6\u73fe\u6b64\u76ee\u7684\u7684\u5169\u7a2e\u5e38\u7528\u65b9\u6cd5\u5982\u4e0b\uff1a- \u5c07\u9805\u76ee\u7684 **Cloud SQL Admin** \u89d2\u8272\u5206\u914d\u7d66\u7fa3\u7d44\uff08\u800c\u4e0d\u662f\u500b\u4eba\uff09\u3002\n- \u5c07\u9805\u76ee\u7684 **Cloud SQL Admin** \u89d2\u8272\u5206\u914d\u7d66\u81f3\u5c11\u5169\u500b\u4eba\u3002\n## \u5f8c\u7e8c\u6b65\u9a5f\n- \u8a73\u7d30\u77ad\u89e3\u5982\u4f55 [\u63a7\u5236\u8a2a\u554f\u6b0a\u9650](https://cloud.google.com/sql/docs/postgres/instance-access-control?hl=zh-cn)", "guide": "Cloud SQL"}