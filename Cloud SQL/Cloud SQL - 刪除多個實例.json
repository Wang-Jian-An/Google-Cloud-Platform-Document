{"title": "Cloud SQL - \u522a\u9664\u591a\u500b\u5be6\u4f8b", "url": "https://cloud.google.com/sql/docs/postgres/delete-instance?hl=zh-cn", "abstract": "# Cloud SQL - \u522a\u9664\u591a\u500b\u5be6\u4f8b\n\u672c\u9801\u9762\u4ecb\u7d39\u5982\u4f55\u522a\u9664 Cloud SQL \u5be6\u4f8b\u3002\n**\u8b66\u544a** \uff1a\u522a\u9664\u67d0\u500b\u5be6\u4f8b\u6642\uff0c\u8a72\u5be6\u4f8b\u4e0a\u7684\u6240\u6709\u6578\u64da\uff08\u5305\u62ec\u5099\u4efd\uff09\u90fd\u6703\u6c38\u4e45\u4e1f\u5931\u3002\u5982\u9700\u4fdd\u7559\u6578\u64da\uff0c\u8acb\u5728\u522a\u9664\u5be6\u4f8b\u4e4b\u524d\u5c07\u5176 [\u5c0e\u51fa\u5230 Cloud Storage](https://cloud.google.com/sql/docs/postgres/import-export?hl=zh-cn) \u3002Cloud SQL Admin \u89d2\u8272\u5177\u6709\u522a\u9664\u5be6\u4f8b\u7684\u6b0a\u9650\u3002\u7232\u9632\u6b62\u610f\u5916\u522a\u9664\uff0c\u8acb\u50c5\u5728\u9700\u8981\u6642\u6388\u4e88\u6b64\u89d2\u8272\u3002 \u6b64\u5916\uff0c\u8acb\u8003\u616e [\u522a\u9664\u4fdd\u8b77](https://cloud.google.com/sql/docs/postgres/deletion-protection?hl=zh-cn) \u3002\n\u5982\u679c\u60a8\u8a08\u5283\u522a\u9664\u5be6\u4f8b\uff0c\u8acb\u6ce8\u610f\u4ee5\u4e0b\u4e8b\u9805\uff1a\n- \u53ea\u8981\u5be6\u4f8b\u5177\u6709\u4efb\u4f55\u526f\u672c\uff0c\u60a8\u5c31\u4e0d\u80fd\u522a\u9664\u8a72\u5be6\u4f8b\u3002\u5fc5\u9808\u5148\u522a\u9664\u6240\u6709\u526f\u672c\u3002\u60a8\u53ef\u4ee5\u901a\u904e\u5275\u5efa\u526f\u672c\u4f86\u964d\u4f4e\u610f\u5916\u522a\u9664\u5be6\u4f8b\u7684\u5e7e\u7387\uff1b\u526f\u672c\u5fc5\u9808\u5728\u5176\u4e3b\u5be6\u4f8b\u4e4b\u524d\u522a\u9664\u3002\n- \u522a\u9664\u67d0\u5be6\u4f8b\u5f8c\uff0c\u8a72\u5be6\u4f8b\u53ef\u80fd\u4ecd\u7136\u986f\u793a\u5728\u9805\u76ee\u4e2d\uff0c\u5927\u5c0f\u7232\u201c\u672a\u77e5\u201d\uff0c\u4f46\u5176\u72c0\u614b\u7232\u201c\u6b63\u5728\u522a\u9664\u201d\u3002\u9019\u662f\u6b63\u5e38\u7684\uff0c\u800c\u4e14\u5728\u77ed\u6642\u9593\u5f8c\u8a72\u5be6\u4f8b\u6703\u5b8c\u5168\u6d88\u5931\u3002\n- \u5b8c\u5168\u522a\u9664\u8207\u5be6\u4f8b\u76f8\u95dc\u7684\u5e95\u5c64\u8cc7\u6e90\u53ef\u80fd\u9700\u8981\u9577\u9054\u4e00\u9031\u6642\u9593\uff0c\u4f46\u53ea\u8b80\u526f\u672c\u9664\u5916\uff0c\u901a\u5e38\u6703\u5728\u5e7e\u5206\u9418\u5167\u522a\u9664\u3002\n- \u60a8\u53ef\u4ee5\u7acb\u5373\u91cd\u65b0\u4f7f\u7528\u5df2\u522a\u9664\u7684\u5be6\u4f8b\u540d\u7a31\u4f86\u5275\u5efa\u65b0\u5be6\u4f8b\u3002\n- \u5982\u679c\u7232\u5be6\u4f8b\u5553\u7528\u4e86 [\u522a\u9664\u4fdd\u8b77](https://cloud.google.com/sql/docs/postgres/deletion-protection?hl=zh-cn) \uff0c\u5247\u5fc5\u9808\u5148\u5c07\u5176\u505c\u7528\uff0c\u7136\u5f8c\u624d\u80fd\u522a\u9664\u8a72\u5be6\u4f8b\u3002", "content": "## \u6240\u9700\u6b0a\u9650\n\u9ed8\u8a8d\u60c5\u6cc1\u4e0b\uff0c\u53ea\u6709\u5177\u6709 `Cloud SQL Admin` ( `roles/cloudsql.admin` ) \u6216 `Owner` ( `roles/owner` ) \u89d2\u8272\u7684\u7528\u6236\u6216\u670d\u52d9\u8cec\u865f\u6709\u6b0a\u522a\u9664 Cloud SQL \u5be6\u4f8b ( `cloudsql.instances.delete` )\u3002\n\u60a8\u9084\u53ef\u4ee5\u7232\u5305\u542b `cloudsql.instances.delete` \u6b0a\u9650\u7684\u7528\u6236\u6216\u670d\u52d9\u8cec\u865f\u5b9a\u7fa9 [IAM \u81ea\u5b9a\u7fa9\u89d2\u8272](https://cloud.google.com/iam/docs/understanding-custom-roles?hl=zh-cn) \u3002IAM \u81ea\u5b9a\u7fa9\u89d2\u8272 [\u652f\u6301](https://cloud.google.com/iam/docs/custom-roles-permissions-support?hl=zh-cn) \u6b64\u6b0a\u9650\u3002\n## \u522a\u9664\u5be6\u4f8b\n\u60a8\u53ef\u4ee5\u4f7f\u7528 [](https://cloud.google.com/sdk/gcloud?hl=zh-cn)  [gcloud CLI](https://cloud.google.com/sdk/gcloud?hl=zh-cn) \u6216 API \u522a\u9664 Cloud SQL \u5be6\u4f8b\u3002\n**\u6ce8\u610f** \uff1a\u5728\u522a\u9664\u5be6\u4f8b\u4e4b\u524d\uff0c\u8acb\u78ba\u8a8d\u6b64\u64cd\u4f5c\u662f\u5b89\u5168\u7684\u3002\u7136\u5f8c\uff0c\u78ba\u8a8d\u5df2\u7232\u5be6\u4f8b\u505c\u7528 [\u522a\u9664\u4fdd\u8b77](https://cloud.google.com/sql/docs/postgres/deletion-protection?hl=zh-cn) \u3002\u5982\u679c\u60a8\u522a\u9664\u5553\u7528\u4e86 [Private Service Connect](https://cloud.google.com/sql/docs/postgres/about-private-service-connect?hl=zh-cn) \u7684\u5be6\u4f8b\uff0c\u5247\u6703\u767c\u751f\u4ee5\u4e0b\u64cd\u4f5c\uff1a- \u7cfb\u7d71\u6703\u81ea\u52d5\u79fb\u9664 [\u670d\u52d9\u9023\u63a5](https://cloud.google.com/sql/docs/postgres/about-private-service-connect?hl=zh-cn#service-attachment) \u3002\u4f46\u4e0d\u6703\u81ea\u52d5\u522a\u9664\u6307\u5411\u670d\u52d9\u9023\u63a5\u7684 [Private Service Connect \u7aef\u9ede](https://cloud.google.com/sql/docs/postgres/about-private-service-connect?hl=zh-cn#psc-endpoint) \u3002\u901a\u904e\u5217\u51fa\u8207\u7aef\u9ede\u95dc\u806f\u7684\u8f49\u767c\u898f\u5247\uff0c\u60a8\u53ef\u4ee5\u770b\u5230\u8a72\u898f\u5247\u7684\u72c0\u614b\u7232`CLOSED`\u3002\u6536\u5230\u6b64\u72c0\u614b\u5f8c\uff0c\u60a8\u53ef\u4ee5\u522a\u9664\u7aef\u9ede\u3002\n- \u60a8\u6703\u770b\u5230\u8207\u7aef\u9ede\u7684\u9023\u63a5\u8d85\u6642\u3002\n\u7232\u907f\u514d\u7522\u751f\u984d\u5916\u8cbb\u7528\uff0c\u6211\u5011\u5f37\u70c8\u5efa\u8b70\u60a8\u522a\u9664\u76f8\u61c9\u7684 [DNS \u5340\u57df](https://cloud.google.com/dns/docs/dns-overview?hl=zh-cn#zones) \u548c [DNS \u8a18\u9304](https://cloud.google.com/dns/docs/dns-overview?hl=zh-cn#records) \u3002\n- \u5728 Google Cloud \u63a7\u5236\u6aaf\u4e2d\uff0c\u8f49\u5230 **Cloud SQL \u5be6\u4f8b** \u9801\u9762\u3002 [\u8f49\u5230\u201cCloud SQL \u5be6\u4f8b\u201d](https://console.cloud.google.com/sql?hl=zh-cn) \n- \u5982\u9700\u6253\u958b\u5be6\u4f8b\u7684 **\u6982\u89bd** \u9801\u9762\uff0c\u8acb\u9ede\u64ca\u5be6\u4f8b\u540d\u7a31\u3002\n- \u9ede\u64ca **\u522a\u9664** \u3002\n- \u5728 **\u522a\u9664\u6578\u64da\u5eab\u5be6\u4f8b** \u5c0d\u8a71\u6846\u4e2d\uff0c\u9ede\u64ca **\u78ba\u5b9a** \u3002\n\u82e5\u8981\u522a\u9664\u5be6\u4f8b\uff0c\u8acb\u4f7f\u7528 [gcloud sql instances delete](https://cloud.google.com/sdk/gcloud/reference/sql/instances/delete?hl=zh-cn) \u547d\u4ee4\uff1a\n```\ngcloud sql instances delete INSTANCE_NAME \\--project=PROJECT_ID\n```\n\u9032\u884c\u4ee5\u4e0b\u66ff\u63db\uff1a- \uff1a\u5be6\u4f8b\u7684\u540d\u7a31\n- \uff1a\u5305\u542b\u5f85\u522a\u9664\u5be6\u4f8b\u7684 Google Cloud \u9805\u76ee\u7684 ID \u6216 [\u9805\u76ee\u7de8\u865f](https://cloud.google.com/resource-manager/docs/creating-managing-projects?hl=zh-cn#identifying_projects) \n\u5728\u4f7f\u7528\u4efb\u4f55\u8acb\u6c42\u6578\u64da\u4e4b\u524d\uff0c\u8acb\u5148\u9032\u884c\u4ee5\u4e0b\u66ff\u63db\uff1a- \uff1a\u5305\u542b\u5f85\u522a\u9664\u5be6\u4f8b\u7684 Google Cloud \u9805\u76ee\u7684 ID \u6216 [\u9805\u76ee\u7de8\u865f](https://cloud.google.com/resource-manager/docs/creating-managing-projects?hl=zh-cn#identifying_projects) \n- \uff1a\u5be6\u4f8b\u7684\u540d\u7a31\nHTTP \u65b9\u6cd5\u548c\u7db2\u5740\uff1a\n```\nDELETE https://sqladmin.googleapis.com/v1/projects/PROJECT_ID/instances/INSTANCE_NAME\n```\n\u5982\u9700\u767c\u9001\u60a8\u7684\u8acb\u6c42\uff0c\u8acb\u5c55\u958b\u4ee5\u4e0b\u9078\u9805\u4e4b\u4e00\uff1a\u60a8\u61c9\u8a72\u6536\u5230\u985e\u4f3c\u4ee5\u4e0b\u5167\u5bb9\u7684 JSON \u97ff\u61c9\uff1a\n```\n{\n \"kind\": \"sql#operation\",\n \"targetLink\": \"https://sqladmin.googleapis.com/v1/projects/PROJECT_ID/instances/INSTANCE_NAME\",\n \"status\": \"PENDING\",\n \"user\": \"user@example.com\",\n \"insertTime\": \"2020-01-15T00:10:22.078Z\",\n \"operationType\": \"DELETE\",\n \"name\": \"OPERATION_ID\",\n \"targetId\": \"INSTANCE_NAME\",\n \"selfLink\": \"https://sqladmin.googleapis.com/v1/projects/PROJECT_ID/operations/OPERATION_ID\",\n \"targetProject\": \"PROJECT_ID\"\n}\n```\n\u5982\u9700\u77ad\u89e3\u5982\u4f55\u7232\u6b64\u4efb\u52d9\u69cb\u5efa\n [\u5e95\u5c64 REST API \u8acb\u6c42](https://cloud.google.com/sql/docs/postgres/admin-api/rest/v1beta4/instances/delete?hl=zh-cn) \n\uff0c\u8acb\u53c3\u95b1\n [instances:delete \u9801\u9762\u4e0a\u7684 APIs Explorer](https://cloud.google.com/sql/docs/postgres/admin-api/rest/v1beta4/instances/delete?hl=zh-cn) \n\u3002\n\u5728\u4f7f\u7528\u4efb\u4f55\u8acb\u6c42\u6578\u64da\u4e4b\u524d\uff0c\u8acb\u5148\u9032\u884c\u4ee5\u4e0b\u66ff\u63db\uff1a- \uff1a\u5305\u542b\u5f85\u522a\u9664\u5be6\u4f8b\u7684 Google Cloud \u9805\u76ee\u7684 ID \u6216 [\u9805\u76ee\u7de8\u865f](https://cloud.google.com/resource-manager/docs/creating-managing-projects?hl=zh-cn#identifying_projects) \n- \uff1a\u5be6\u4f8b\u7684\u540d\u7a31\nHTTP \u65b9\u6cd5\u548c\u7db2\u5740\uff1a\n```\nDELETE https://sqladmin.googleapis.com/sql/v1beta4/projects/PROJECT_ID/instances/INSTANCE_NAME\n```\n\u5982\u9700\u767c\u9001\u60a8\u7684\u8acb\u6c42\uff0c\u8acb\u5c55\u958b\u4ee5\u4e0b\u9078\u9805\u4e4b\u4e00\uff1a\u60a8\u61c9\u8a72\u6536\u5230\u985e\u4f3c\u4ee5\u4e0b\u5167\u5bb9\u7684 JSON \u97ff\u61c9\uff1a\n```\n{\n \"kind\": \"sql#operation\",\n \"targetLink\": \"https://sqladmin.googleapis.com/sql/v1beta4/projects/PROJECT_ID/instances/INSTANCE_NAME\",\n \"status\": \"PENDING\",\n \"user\": \"user@example.com\",\n \"insertTime\": \"2020-01-15T00:10:22.078Z\",\n \"operationType\": \"DELETE\",\n \"name\": \"OPERATION_ID\",\n \"targetId\": \"INSTANCE_NAME\",\n \"selfLink\": \"https://sqladmin.googleapis.com/sql/v1beta4/projects/PROJECT_ID/operations/OPERATION_ID\",\n \"targetProject\": \"PROJECT_ID\"\n}\n```\n\u5982\u9700\u77ad\u89e3\u5982\u4f55\u7232\u6b64\u4efb\u52d9\u69cb\u5efa\n [\u5e95\u5c64 REST API \u8acb\u6c42](https://cloud.google.com/sql/docs/postgres/admin-api/rest/v1beta4/instances/delete?hl=zh-cn) \n\uff0c\u8acb\u53c3\u95b1\n [instances:delete \u9801\u9762\u4e0a\u7684 APIs Explorer](https://cloud.google.com/sql/docs/postgres/admin-api/rest/v1beta4/instances/delete?hl=zh-cn) \n\u3002", "guide": "Cloud SQL"}