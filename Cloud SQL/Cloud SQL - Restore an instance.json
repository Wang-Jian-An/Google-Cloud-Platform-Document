{"title": "Cloud SQL - Restore an instance", "url": "https://cloud.google.com/sql/docs/postgres/backup-recovery/restoring", "abstract": "# Cloud SQL - Restore an instance\nThis page describes how to restore your instance from a backup.\nFor information, best practices, and requirements for restore operations, see [Overview of restoring an instance](/sql/docs/postgres/backup-recovery/restore) .\n**Note:** This procedure restarts the instance. See [How long are instances shut down during restart?](https://cloud.google.com/sql/docs/postgres/faq.md#shutdown)\n", "content": "## Restore an instance from a backup\nYou can use a backup to restore the same instance the backup was taken from, or you can use a backup to restore a different instance in the same project.\n### Restore to a different instance\nWhen you restore from a backup to a different instance, you update the data on the target instance to the state of the source instance when you took the backup. For more information, see [General tips about performing a restore](/sql/docs/postgres/backup-recovery/restore#tips-restore) and [Tips and requirements for restoring to a different instance](/sql/docs/postgres/backup-recovery/restore#tips-restore-different-instance) .\nIf you need a list of backups for the project and can't view them on the instance overview page due to an outage, you can use the `backupRuns.list` API with a wildcard ( `-` ). The wildcard option retrieves a list of all backups across all instances in the project. For more information, see [Viewing backups during an outage](/sql/docs/postgres/backup-recovery/backing-up#backuplist) .\nWarning: The restore process overwrites all the current data on the instance, including previous point-in-time recovery logs. Overwritten data cannot be recovered.\n- In the Google Cloud console, go to the **Cloud SQL Instances** page. [Go to Cloud SQL Instances](https://console.cloud.google.com/sql) \n- If the target instance has any read replicas,  use the more actions menuon the far right side  to delete them.\n- To open the **Overview** page of an instance, click the instance name.\n- Select **Backups** from the SQL navigation menu.\n- Find the backup you want to restore from, and select **Restore** .\n- In the **Restore an instance from a backup** page, confirm that you selected the correct backup in **Review backup details** .\n- In **Choose restore destination** , select **Overwrite an\n  existing instance** .\n- From the **Instance** drop-down menu, select the instance you want  to use for the restore. The instance that you select and all of its data are overwritten.\n- To confirm your selection, enter the name of the instance to be overwritten in the **Destination instance ID** field.\n- To start the restore process, click **Restore** .\n- Check the status of the restore operation by going to the **Operations** tab of the target instance.\n- After the restore operation completes, recreate any replicas you deleted  previously.\n- Describe theinstance to see whether it has any replicas:```\ngcloud sql instances describe TARGET_INSTANCE_NAME\n```Note any instances listed in `replicaNames` .\n- Delete all replicas:```\ngcloud sql instances delete REPLICA_NAME\n```Repeat for each replica.\n- List the backups for the source instance:```\ngcloud sql backups list \\--instance SOURCE_INSTANCE_NAME\n```\n- Find the backup you want to use and record its`ID`value. **Note:** Select a backup that is marked`SUCCESSFUL`.\n- Restore from the specified backup to the target instance:```\ngcloud sql backups restore BACKUP_ID \\--restore-instance=TARGET_INSTANCE_NAME \\--backup-instance=SOURCE_INSTANCE_NAME\u00a0 \u00a0 \n```\n- After the restore completes, recreate any replicas you deleted previously.\n- List all replicas for theinstance.Before using any of the request data, make the following replacements:- : The project ID\n- : The instance ID\nHTTP method and URL:\n```\nGET https://sqladmin.googleapis.com/v1/projects/project-id/instances/instance-id?fields=replicaNames\n```\nTo send your request, expand one of these options:You should receive a JSON response similar to the following:\n- Delete all replicas.Before using any of the request data, make the following replacements:- : The project ID\n- : The replica ID\nHTTP method and URL:\n```\nDELETE https://sqladmin.googleapis.com/v1/projects/project-id/instances/replica-id\n```\nTo send your request, expand one of these options:You should receive a JSON response similar to the following:Repeat for each replica.\n- List the backups for theinstance to get the ID of the   backup you want to use.Before using any of the request data, make the following replacements:- : The project ID\n- : The instance ID\nHTTP method and URL:\n```\nGET https://sqladmin.googleapis.com/v1/projects/project-id/instances/instance-id/backupRuns\n```\nTo send your request, expand one of these options:You should receive a JSON response similar to the following:-OR-  If your instance is in a region that is having an outage, list all the  backups in a project:Before using any of the request data, make the following replacements:- : The project ID\n- : The instance ID, or`-`for a list of all backups in the project\nHTTP method and URL:\n```\nGET https://sqladmin.googleapis.com/v1/projects/project-id/instances/-/backupRuns\n```\nTo send your request, expand one of these options:You should receive a JSON response similar to the following:Find the backup for the instance you need to restore.\n- Restore the target instance from the backup.Before using any of the request data, make the following replacements:- : The project ID\n- : The target instance ID\n- : The source instance ID\n- The backup ID\nHTTP method and URL:\n```\nPOST https://sqladmin.googleapis.com/v1/projects/project-id/instances/target-instance-id/restoreBackup\n```\nRequest JSON body:\n```\n{\n \"restoreBackupContext\":\n {\n \"backupRunId\": backup-id,\n \"instanceId\": \"source-instance-id\"\n }\n}\n```\nTo send your request, expand one of these options:You should receive a JSON response similar to the following:\n- After the restore operation completes, recreate any replicas you deleted  previously.\n- List all replicas for theinstance.Before using any of the request data, make the following replacements:- : The project ID\n- : The instance ID\nHTTP method and URL:\n```\nGET https://sqladmin.googleapis.com/sql/v1beta4/projects/project-id/instances/instance-id?fields=replicaNames\n```\nTo send your request, expand one of these options:You should receive a JSON response similar to the following:\n- Delete all replicas.Before using any of the request data, make the following replacements:- : The project ID\n- : The replica ID\nHTTP method and URL:\n```\nDELETE https://sqladmin.googleapis.com/sql/v1beta4/projects/project-id/instances/replica-id\n```\nTo send your request, expand one of these options:You should receive a JSON response similar to the following:Repeat for each replica.\n- List the backups for theinstance to get the ID of the   backup you want to use.Before using any of the request data, make the following replacements:- : The project ID\n- : The instance ID\nHTTP method and URL:\n```\nGET https://sqladmin.googleapis.com/sql/v1beta4/projects/project-id/instances/instance-id/backupRuns\n```\nTo send your request, expand one of these options:You should receive a JSON response similar to the following:\n- Restore the target instance from the backup.Before using any of the request data, make the following replacements:- : The project ID\n- : The target instance ID\n- : The source instance ID\n- The backup ID\nHTTP method and URL:\n```\nPOST https://sqladmin.googleapis.com/sql/v1beta4/projects/project-id/instances/target-instance-id/restoreBackup\n```\nRequest JSON body:\n```\n{\n \"restoreBackupContext\":\n {\n \"backupRunId\": backup-id,\n \"instanceId\": \"source-instance-id\"\n }\n}\n```\nTo send your request, expand one of these options:You should receive a JSON response similar to the following:\n- After the restore operation completes, recreate any replicas you deleted  previously.\n### Restore to the same instance\nWhen you restore from a backup to the same instance, you return the data on that instance to the state of when you took the backup. For information about restoring an instance, see [General tips about performing a restore](/sql/docs/postgres/backup-recovery/restore#tips-restore) .\nWarning: The restore process overwrites all the current data on the instance, including previous point-in-time recovery logs. Overwritten data cannot be recovered. This restore process is not recommended for production.\n- In the Google Cloud console, go to the **Cloud SQL Instances** page. [Go to Cloud SQL Instances](https://console.cloud.google.com/sql) \n- If the target instance has any read replicas,  use the more actions menuat the far right side  to delete them.\n- To open the **Overview** page of an instance, click the instance name.\n- Select **Backups** from the SQL navigation menu.\n- Find the backup you want to use, and select **Restore** .\n- In the **Restore an instance from a backup** page, confirm that you selected the correct backup in **Review backup details** .\n- In **Choose restore destination** , select **Overwrite the\n  source instance** .Check that the name of the source instance   is specified in   parentheses.\n- To confirm your selection, enter the instance name in the **Destination instance ID** field.\n- To start the restore process, click **Restore** .\n- Check the status of the restore operation by going to the **Operations** page of the instance.\n- After the restore operation completes, recreate any replicas you deleted in the first step.\n- Describe the instance to see whether it has any replicas:```\ngcloud sql instances describe INSTANCE_NAME\n```Note any instances listed in `replicaNames` .\n- Delete all replicas:```\ngcloud sql instances delete REPLICA_NAME\n```Repeat for all replicas.\n- List the backups for the instance:```\ngcloud sql backups list --instance INSTANCE_NAME\n```\n- Find the backup you want to use and record its`ID`value. **Note:** Select a backup that is marked`SUCCESSFUL`.\n- Restore the instance from the specified backup:```\ngcloud sql backups restore BACKUP_ID \\--restore-instance=INSTANCE_NAME\n```\n- After the restore operation completes, recreate any replicas you deleted in  the first step.\n- List the backups for the instance to get the id of the backup you want to use.Before using any of the request data, make the following replacements:- : The project ID\n- : The instance ID\nHTTP method and URL:\n```\nGET https://sqladmin.googleapis.com/v1/projects/project-id/instances/instance-id/backupRuns\n```\nTo send your request, expand one of these options:You should receive a JSON response similar to the following:\n- Restore the instance from the backup.Before using any of the request data, make the following replacements:- : The project ID\n- : The instance ID\n- The backup ID\nHTTP method and URL:\n```\nPOST https://sqladmin.googleapis.com/v1/projects/project-id/instances/instance-id/restoreBackup\n```\nRequest JSON body:\n```\n{\n \"restoreBackupContext\":\n {\n \"backupRunId\": \"backup-id\",\n }\n}\n```\nTo send your request, expand one of these options:You should receive a JSON response similar to the following:\n- After the restore operation completes, recreate any replicas you deleted  previously.\n- List the backups for the instance to get the id of the backup you want to use.Before using any of the request data, make the following replacements:- : The project ID\n- : The instance ID\nHTTP method and URL:\n```\nGET https://sqladmin.googleapis.com/sql/v1beta4/projects/project-id/instances/instance-id/backupRuns\n```\nTo send your request, expand one of these options:You should receive a JSON response similar to the following:\n- Restore the instance from the backup.Before using any of the request data, make the following replacements:- : The project ID\n- : The instance ID\n- The backup ID\nHTTP method and URL:\n```\nPOST https://sqladmin.googleapis.com/sql/v1beta4/projects/project-id/instances/instance-id/restoreBackup\n```\nRequest JSON body:\n```\n{\n \"restoreBackupContext\":\n {\n \"backupRunId\": \"backup-id\",\n }\n}\n```\nTo send your request, expand one of these options:You should receive a JSON response similar to the following:\n- After the restore operation completes, recreate any replicas you deleted  previously.\n### Restore to an instance in another project\nYou can use the `project` parameter to restore data to an instance in a different project than the one where the backup was taken. When using the `project` parameter, call `restoreBackup` in the project and on the instance you want to restore data to. When you restore from a backup to a different instance, you update the data on the target instance to the state of the source instance when you took the backup.\nThe user restoring to a different project must have the `cloudsql.instances.restoreBackup` permission for the target project and the `cloudsql.backupRuns.get` permission for the source instance. These permissions are included in the `Cloud SQL Admin` role.\nWarning: The restore process overwrites all the current data on the instance, including previous point-in-time recovery logs. Overwritten data cannot be recovered.\nTo restore data to an instance in a different project:\nTo obtain the `backupId` , run the following.\nBefore using any of the request data, make the following replacements:- : The project ID\n- : The instance ID\nHTTP method and URL:\n```\nGET https://sqladmin.googleapis.com/v1/projects/project-id/instances/instance-id/backupRuns\n```\nTo send your request, expand one of these options:You should receive a JSON response similar to the following:Restore the backup to an instance in a different project:\nBefore using any of the request data, make the following replacements:- : The source project ID\n- : The target project ID\n- : The target instance ID\n- : The source instance ID\n- The backup ID\nHTTP method and URL:\n```\nPOST https://sqladmin.googleapis.com/v1/projects/target-project-id/instances/target-instance-id/restoreBackup\n```\nRequest JSON body:\n```\n{\n \"restoreBackupContext\":\n {\n \"backupRunId\": backup-id,\n \"project\": \"source-project-id\",\n \"instanceId\": \"source-instance-id\"\n }\n}\n```\nTo send your request, expand one of these options:You should receive a JSON response similar to the following:\nFor more information about the\n`project`\nproperty, see\n [restoreBackup](https://cloud.google.com/sql/docs/mysql/admin-api/rest/v1/instances/restoreBackup) \nTo obtain the\n`backupId`\n, run the following.\nBefore using any of the request data, make the following replacements:- : The project ID\n- : The instance ID\nHTTP method and URL:\n```\nGET https://sqladmin.googleapis.com/sql/v1beta4/projects/project-id/instances/instance-id/backupRuns\n```\nTo send your request, expand one of these options:You should receive a JSON response similar to the following:Restore the backup to an instance in a different project:\nBefore using any of the request data, make the following replacements:- : The source project ID\n- : The target project ID\n- : The target instance ID\n- : The source instance ID\n- The backup ID\nHTTP method and URL:\n```\nPOST https://sqladmin.googleapis.com/sql/v1beta4/projects/target-project-id/instances/target-instance-id/restoreBackup\n```\nRequest JSON body:\n```\n{\n \"restoreBackupContext\":\n {\n \"backupRunId\": backup-id,\n \"project\": \"source-project-id\",\n \"instanceId\": \"source-instance-id\"\n }\n}\n```\nTo send your request, expand one of these options:You should receive a JSON response similar to the following:\nFor more information about the\n`project`\nproperty, see\n [restoreBackup](https://cloud.google.com/sql/docs/mysql/admin-api/rest/v1beta4/instances/restoreBackup)\n## Perform a point-in-time recovery\nTo perform a point-in-time recovery, see [Point-in-time recovery](/sql/docs/postgres/backup-recovery/pitr#pitr) .\n## What's next\n- [Learn more about restoring](/sql/docs/postgres/backup-recovery/restore) .\n- [Learn more about backing up your data](/sql/docs/postgres/backup-recovery/backups) .\n- [See how to backup your data](/sql/docs/postgres/backup-recovery/backing-up) .", "guide": "Cloud SQL"}