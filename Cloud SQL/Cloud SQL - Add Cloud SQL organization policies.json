{"title": "Cloud SQL - Add Cloud SQL organization policies", "url": "https://cloud.google.com/sql/docs/postgres/org-policy/configure-org-policy", "abstract": "# Cloud SQL - Add Cloud SQL organization policies\nThis page describes how to add organization policies on Cloud SQL instances, to put restrictions on Cloud SQL at the project, folder, or organization level. For an overview, see [Cloud SQL organization policies](/sql/docs/postgres/org-policy/org-policy) .\n", "content": "## Before you begin\n- Add the **Organization Policy Administrator** role  ( [roles/orgpolicy.policyAdmin](/iam/docs/understanding-roles#organization-policy-roles) )  to your user or service account from the **IAM & Admin** page. [Go to the IAM accounts page](https://console.cloud.google.com/iam-admin/iam) \n- See [Restrictions](/sql/docs/postgres/org-policy/org-policy#restrictions) before performing this procedure.\n## Add the connection organization policy\nFor an overview see [Connection organization policies](/sql/docs/postgres/org-policy/org-policy#connection-organization-policy) .\nTo add a connection organization policy:\n- Go to the **Organization policies** page. [Go to the Organization policies page](https://console.cloud.google.com/iam-admin/orgpolicies) \n- Click projects dropdown menu in the top tab, and then select the project, folder, or organization that requires the organization policy. The **Organization policies** page displays a list of organization policy constraints that are available.\n- Filter for the constraint `name` or `display_name` .- To disable access to or from the Internet:```\nname: \"constraints/sql.restrictPublicIp\"display_name: \"Restrict Public IP access on Cloud SQL instances\"\n```\n- To disable access from the internet when IAM authentication is missing (this does not affect access using Private IP):```\nname: \"constraints/sql.restrictAuthorizedNetworks\"display_name: \"Restrict Authorized Networks on Cloud SQL instances\"\n```\n- Select the policy **Name** from the list.\n- Click **Edit** .\n- Click **Customize** .\n- Click **Add rule** .\n- Under **Enforcement** , click **On** .\n- Click **Save** .## Add the CMEK organization policy\n**    Preview     ** This product or feature is subject to the \"Pre-GA Offerings Terms\" in the General Service Terms section   of the [Service Specific Terms](/terms/service-terms#1) .     Pre-GA products and features are available \"as is\" and might have limited support.    For more information, see the [launch stage descriptions](/products#product-launch-stages) .\nFor an overview see [Customer-managed encryption keys organization policies](/sql/docs/postgres/org-policy/org-policy#cmek-organization-policy) .\nTo add a CMEK organization policy:\n- Go to the **Organization policies** page. [Go to the Organization policies page](https://console.cloud.google.com/iam-admin/orgpolicies) \n- Click projects dropdown menu in the top tab, and then select the project, folder, or organization that requires the organization policy. The **Organization policies** page displays a list of organization policy constraints that are available.\n- Filter for the constraint `name` or `display_name` .- To put service names in a DENY list to ensure that CMEK is used in the resources for that service:```\nname: \"constraints/gcp.restrictNonCmekServices\"display_name: \"Restrict which services may create resources without CMEK\"\n```You must add `sqladmin.googleapis.com` to the list of restricted services with Deny.\n- To put project IDs in an ALLOW list to ensure that only keys from an instance of Cloud KMS within that project are used for CMEK.```\nname: \"constraints/gcp.restrictCmekCryptoKeyProjects\"display_name: \"Restrict which projects may supply KMS CryptoKeys for CMEK\"\n```\n- Select the policy **Name** from the list.\n- Click **Edit** .\n- Click **Customize** .\n- Click **Add rule** .\n- Under **Policy values** , click **Custom** .\n- For `constraints/gcp.restrictNonCmekServices` : a. Under **Policy types** , select **Deny** . b. Under **Custom values** , enter `sqladmin.googleapis.com` .For `constraints/gcp.restrictCmekCryptoKeyProjects` : a. Under **Policy types** , select **Allow** . b. Under **Custom values** , enter the resource using the following format: `under:organizations/ORGANIZATION_ID` , `under:folders/FOLDER_ID` , or `projects/PROJECT_ID` .\n- Click **Done** .\n- Click **Save** .## What's next\n- Learn about [Organization policies](/sql/docs/postgres/org-policy/org-policy) .\n- Learn about how [private IP](/sql/docs/postgres/private-ip) works with Cloud SQL.\n- Learn how to [configure private IP](/sql/docs/postgres/configure-private-ip) for Cloud SQL.\n- Learn about the [organization policy service](/resource-manager/docs/organization-policy/overview) .\n- Learn about [organization policy constraints](/resource-manager/docs/organization-policy/understanding-constraints) .", "guide": "Cloud SQL"}