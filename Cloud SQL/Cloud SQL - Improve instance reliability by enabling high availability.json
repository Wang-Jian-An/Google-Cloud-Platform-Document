{"title": "Cloud SQL - Improve instance reliability by enabling high availability", "url": "https://cloud.google.com/sql/docs/postgres/recommender-enable-ha", "abstract": "# Cloud SQL - Improve instance reliability by enabling high availability\n**    Preview     ** This feature is subject to the \"Pre-GA Offerings Terms\" in the General Service Terms section   of the [Service Specific Terms](/terms/service-terms#1) .     Pre-GA features are available \"as is\" and might have limited support.    For more information, see the [launch stage descriptions](/products#product-launch-stages) .\nThe Cloud SQL enable-high-availability [recommender](/recommender/docs/overview) proactively generates recommendations that help you bring your important instances within SLA by providing data redundancy. This might be helpful during a zonal outage or when an instance runs out of memory.\nThis page describes the Cloud SQL enable-high-availability recommender, how this recommender works, and how to use it.\n", "content": "## How it works\nThe Cloud SQL enable-high-availability recommender analyzes the instance metadata. If the instance is configured similar to instances that support important workloads but doesn't have high availability enabled, then Cloud SQL recommends that you enable high availability for 99.5% availability SLA, or migrate to Cloud SQL Enterprise Plus edition with high availability for 99.99% availability SLA.\n**Note:** Recommendations are generated daily.\n## Pricing\nThe Cloud SQL enable-high-availability recommender is available free of cost to all Google Cloud customers. For more information, see [Recommender pricing](/recommender/pricing) .\n## Before you begin\nBefore you can view recommendations and insights, do the following:\n- To get the permissions to view and work with insights and recommendations, ensure that you have the required [Identity and Access Management (IAM) roles](/sql/docs/postgres/project-access-control#roles) .| Tasks     | Roles                    |\n|:----------------------|:------------------------------------------------------------------------------------|\n| View recommendations | One of these roles: recommender.cloudsqlViewer or cloudsql.viewer.     |\n| Apply recommendations | One of these roles: recommender.cloudsqlAdmin, cloudsql.editor, or cloudsql.admin. |For more information about IAM roles, see [IAM basic and predefined roles reference](/iam/docs/understanding-roles) and [Manage access to projects, folders, and organizations](/iam/docs/granting-changing-revoking-access) .\n- Enable the Recommender API. [Enable the API](https://console.cloud.google.com/flows/enableapi?apiid=recommender.googleapis.com) \n## List enable-high-availability recommendations\nTo list enable-high-availability recommendations by using the Google Cloud console, follow these steps:- Go to the **Recommendation Hub** . [Go to the Recommendation Hub](https://console.cloud.google.com/home/recommendations/) For more information, see [Getting started with Recommendation Hub](/recommender/docs/recommendation-hub/identify-configuration-problems) .\n- In the **Improve reliability on Cloud SQL instances** card, click **View all** .\nTo list enable-high-availability recommendations by using gcloud CLI, run the [gcloud recommender recommendations list](/sdk/gcloud/reference/recommender/recommendations/list) command as follows:\n```\ngcloud recommender recommendations list \\\n--project=PROJECT_ID \\\n--location=LOCATION \\\n--recommender=google.cloudsql.instance.ReliabilityRecommender \\\n--filter=recommenderSubtype=ENABLE_HIGH_AVAILABILITY\n```\nReplace the following:- ``: Your project ID.\n- ``: A region where your instances are located, such as`us-central1`.\nTo list enable-high-availability recommendations by using the [Recommendations API](/recommender/docs/using-api) , call the [recommendations.list](/recommender/docs/reference/rest/v1beta1/projects.locations.recommenders.recommendations/list) method as follows:\n```\nGET https://recommender.googleapis.com/v1beta1/projects/PROJECT-ID/locations/LOCATION/recommenders/google.cloudsql.instance.ReliabilityRecommender/recommendations\n```\nReplace the following:- ``: Your project ID.\n- ``: A region where your instances are located, such as`us-central1`.## View insights and detailed recommendations\nTo view insights and detailed recommendations about instances that are configured similar to instances that support important workloads but don't have high availability enabled, click the recommendation link in the list of instances.\nTo view insights and detailed recommendations about instances that are configured similar to instances that support important workloads but don't have high availability enabled, run the [gcloud recommender insights list](/sdk/gcloud/reference/recommender/insights/list) command as follows:\n```\ngcloud recommender insights list \\\n--project=PROJECT_ID \\\n--location=LOCATION \\\n--insight-type=google.cloudsql.instance.ReliabilityInsight \\\n--filter=insightSubtype=CRITICAL_INSTANCE_HIGH_AVAILABILITY_NOT_ENABLED\n```\nReplace the following:- ``: Your project ID.\n- ``: A region where your instances are located, such as`us-central1`.\nTo view insights and detailed recommendations about instances that are configured similar to instances that support important workloads but don't have high availability enabled by using the [Recommendations API](/recommender/docs/using-api) , call the [insights.list](/recommender/docs/reference/rest/v1beta1/projects.locations.insightTypes.insights/list) method as follows:\n```\nGET https://recommender.googleapis.com/v1beta1/projects/PROJECT-ID/locations/LOCATION/insightTypes/google.cloudsql.instance.ReliabilityInsight/insights\n```\nReplace the following:- ``: Your project ID.\n- ``: A region where your instances are located, such as`us-central1`.\nThe following table lists the insight and recommendation that the Cloud SQL enable-high-availability recommender generates. The subtypes are visible in the gcloud CLI and API results.\n| Insight                                                          | Recommendation                                                                                             |\n|:-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|\n| This instance isn't highly available, even though it's configured similarly to instances that support important workloads. Single zone instances are more susceptible to downtime. Subtype: CRITICAL_INSTANCE_HIGH_AVAILABILITY_NOT_ENABLED | Enable high availability for 99.5% availability SLA, or migrate to Cloud SQL Enterprise Plus edition with high availability for even higher 99.99% availability SLA. Enabling high availability will make your instance multi-zonal, which replicates your data within a region to protect against zonal outages, limit downtime and improve recovery time. Subtype: ENABLE_HIGH_AVAILABILITY |\n## Apply recommendation\nEvaluate the recommendation carefully and do any of the following:\n- To examine the instance, click **View instance** and do any of the following:- Configure high availability on your instance. For more information, see [Enable and disable high availability](/sql/docs/postgres/configure-ha#console_1) . **Caution:** Once you start the high availability configuration on an instance, you can't stop it. This operation restarts the instance and can lead to an increase in cost and a brief downtime. It typically takes only a few minutes for the configuration and the restart operation to complete. However, if the instance has a large disk or load, then it might take up to an hour.\n- Migrate to the Cloud SQL Enterprise Plus edition. For more information, see [Introduction to Cloud SQL editions](https://cloud.google.com/sql/docs/editions-intro) .\n- To dismiss the recommendation, click **Dismiss** .\n- To close the panel without applying or dismissing the recommendation, click **Cancel** .## What's next\n- [Google Cloud recommenders](/recommender/docs/recommenders) \n- [Blog: Maximize your Cloud ROI](https://cloud.google.com/blog/products/management-tools/active-assist-comes-to-google-cloud) \n- [Blog: Do more with less](https://cloud.google.com/blog/products/databases/reduce-cloud-sql-costs-with-optimizations-by-active-assist)", "guide": "Cloud SQL"}