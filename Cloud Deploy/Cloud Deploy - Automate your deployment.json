{"title": "Cloud Deploy - Automate your deployment", "url": "https://cloud.google.com/deploy/docs/automation", "abstract": "# Cloud Deploy - Automate your deployment\nThis document is an overview of deploy automation.\nYou can configure Cloud Deploy to automatically perform release-related and rollout-related tasks for a given delivery pipeline. These tasks include [release promotion](/deploy/docs/automation-rules#configuring_a_promoterelease_automation_rule) and [phase advancement](/deploy/docs/automation-rules#configuring_an_advancerollout_automation_rule) .\n[Learn more](/deploy/docs/automation-resource) about the resources used for release automation in Cloud Deploy.\n[Learn more](/deploy/docs/automation-rules) about how to set up the rules that define how these automations work.\n", "content": "## Actions you can automate\nIn Cloud Deploy, you can automate the following release and rollout activities:\n- Promote a releaseYou can configure Cloud Deploy to promote your release automatically, upon a successful rollout to a target. For example, if you have three targets, `dev` , `staging` , and `prod` , you can configure an automation such that the release is promoted to `prod` , without further human interaction, upon a successful deployment into `staging` .\n- Advance a rolloutYou can configure Cloud Deploy to advance a rollout from one [phase](/deploy/docs/deployment-strategies/manage-rollout#phases) to the next, after a successful rollout to the previous target. Phase advancement is available only in targets that use a [canary deployment strategy](/deploy/docs/deployment-strategies/canary) .## How does automation work?\nEach automation is tied to the delivery pipeline for which it's used. You can't share an automation across multiple delivery pipelines.\nThe following is the general process for configuration and execution of an automation:\n- You [configure an Automation](/deploy/docs/config-files#automation_definitions) This automation is associated with one delivery pipeline.\n- You register that automation using `gcloud deploy apply` .This creates the [Automation resource](/deploy/docs/automation-resource#the_automation_resource) .\n- You invoke the delivery pipeline associated with this automation by [creating a release](/deploy/docs/deploying-application#invoke_your_delivery_pipeline_to_create_a_release) .\n- The rollout is successful into at least one target.\n- In the target that this automation is configured for...If the automation is `promoteRelease` :- Execution waits for the rollout to succeed into the source target. The source target is the `selector.target` configured for the automation, not in the `AutomationRule` .\n- If there is a `wait` time configured, execution waits for that time also.\n- The release is automatically promoted to the next target in the pipeline progression, or to a specific target, [if indicated](/deploy/docs/automation-rules#promoterelease_rule) .\nIf the automation is `advanceRollout` and the target uses a canary deployment strategy:- Execution waits for the identified [source phase](/deploy/docs/automation-rules#advancerollout_rule) , if there is one.The `sourcePhase` property is optional, and if no source phases are specified, each phase in the rollout is advanced automatically. The automatic phase advancement happens when the source phase is `IN_PROGRESS` , subject to `wait` time.\n- If there is a `wait` time configured, execution waits for that time also.When you're automating a canary deployment, you use this wait time to specify the duration of each canary phase.\n- The rollout is automatically advanced from that source phase to the next phase in the rollout.\n- If there's an additional source phase, it's treated the same, including the same wait time, if applicable.\n### Automation resources\nThere are two Cloud Deploy resources that are specifically for automation:\n- AutomationAn `Automation` is a child resource of a delivery pipeline, and it includes the following information:- A pointer to the target or targets for which the automation is used\n- The rule or rules that govern what the automation does and how it does it\nConfiguration for the Automation resource is described in the document [About the automation resource](/deploy/docs/automation-resource) .When you run `gcloud deploy apply` against a file that includes an automation configuration ( `kind: Automation` ), Cloud Deploy creates an [automation resource](/deploy/docs/automation-resource#the_automation_resource) , which associates a delivery pipeline and a target or targets with one or more [automation rules](/deploy/docs/automation-rules) .\n- Automation runThe `AutomationRun` is an instance of an automation. It's a pointer to its corresponding Automation resource, plus information about the rollout that spawned it, and other metadata.The automation run is created when an automation is triggered.\n[Learn more about automation resources](/deploy/docs/automation-resource) .\n### Automation rules\nAn automation rule defines an action that can be taken on your delivery pipeline automatically, as well as details about how the automation is to be performed.\n[Learn more about automation rules](/deploy/docs/automation-rules) .\n### Identity and Access Management roles and permissions required\nIn addition to the permissions you need to run any Cloud Deploy delivery pipeline, and to perform the tasks to be automated (like advancing a rollout), there are several permissions that are needed in order to perform certain operations on the `Automation` and `AutomationRun` resources:\n- `clouddeploy.automations.create`\n- `clouddeploy.automations.delete`\n- `clouddeploy.automations.get`\n- `clouddeploy.automations.list`\n- `clouddeploy.automations.update`\n- `clouddeploy.automationRuns.cancel`\n- `clouddeploy.automationRuns.get`\n- `clouddeploy.automationRuns.list`\nSee [IAM roles and permissions](/deploy/docs/iam-roles-permissions) For more information, including which Cloud Deploy [roles including these permissions](/deploy/docs/iam-roles-permissions#predefined_roles) .\n## Create an automation\nYou can create an automation, including using any of the [available automation rules](/deploy/docs/automation-rules#available_automation_rules) , by configuring an automation, then creating the automation resource using `gcloud deploy apply`\nSee the following section (Configuring automation), and [Configuring automation rules](/deploy/docs/automation-rules#configuring_automation_rules) .\n### Configuring automation\nSee the [Configuration file schema](/deploy/docs/config-files#automation_definitions) for details on how to configure the [Automation resource](/deploy/docs/automation-resource#the_automation_resource) .\n### Automation rule configuration\nIn addition to this automation configuration, you specify [automation rules](/deploy/docs/automation-rules) . Configuration is different for each of the available rules.\nSee [Using automation rules](/deploy/docs/automation-rules) for descriptions of each of the available rules.\n## Suspend an automation\nYou can suspend an existing resource without deleting it. This can be useful for testing an automation without affecting the delivery pipeline. When you suspend an automation, the automation isn't run, but [platform logs](/deploy/docs/platform-logs) are still generated.\n- In the [Automation configuration](/deploy/docs/config-files#automation_definitions) , Update the `suspended` property to `true` .\n- Run `gcloud deploy apply` against that configuration file.\n- [Platform logs](/sdeploy/docs/platform-logs) are still generated when the automation is instantiated, even if it's suspended. You can use this to test and debug the automation without affecting the delivery pipeline.## What's next\n- Try the [quickstart: Automate release creation and rollout advancement](/deploy/docs/deploy-app-automation) .\n- [Learn more](/deploy/docs/automation-rules) about Cloud Deploy automation rules.\n- [Learn more](/deploy/docs/automation-resource) about Cloud Deploy automation resources.\n- See the [configuration file schema documentation](/deploy/docs/config-files#automation_definitions) for details on the automation configuration files.", "guide": "Cloud Deploy"}