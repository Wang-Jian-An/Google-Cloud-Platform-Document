{"title": "Apigee - Reference", "url": "https://cloud.google.com/apigee/docs/api-platform/get-started/what-apigee", "abstract": "# Apigee - Reference\nThe `apigee-remote-service-cli` Command Line Interface (CLI) helps you provision and manage Apigee Adapter for Envoy.\n", "content": "## Binding commands\nBinding associates a service deployed to the Istio mesh with an Apigee API product. The CLI lets you create, remove, and list bindings.\n### Add a binding\nAdds a remote target binding to an API product.\nFor Apigee hybrid:\n```\napigee-remote-service-cli bindings add [service_name] [product_name] -o [organization] -e [environment] -t [token]\n```\n| Parameters  | Type | Description                                                                   |\n|:---------------|:-------|:--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|\n| -c, --config | String | (Required) The path to the Apigee Remote Service config file. Tip: When you specify this option, you can omit most other command parameters. See Using the --config option.                           |\n| -e, --env  | String | (Required) An environment in your organization.                                                          |\n| -h, --help  | nan | Displays help for the command parameters.                                                            |\n| --insecure  | nan | Allow insecure server connections when using SSL                                                          |\n| --legacy  | nan | Set this flag if you are using Apigee Cloud. It sets the management and runtime URLs for Edge Cloud.                                             |\n| --opdk   | nan | Set this flag if you are using Apigee for Private Cloud.                                                        |\n| -o, --org  | String | (Required) An Apigee organization. You must be an org administrator.                                                     |\n| -p, --password | String | (Required for basic authentication only) Your Apigee password. You can optionally specify the password in a .netrc file. If you do so, then you are not required to provide your password on the command line. See also Using .netrc for credentials.        |\n| -r, --runtime | String | Apigee runtime base URL (required for hybrid or opdk).                                                        |\n| -t, --token | String | (Required for OAuth token authentication only) An OAuth or SAML token that you generate from your Apigee account information. For information on generating tokens, see Obtaining an OAuth 2.0 access token and SAML overview.              |\n| -u, --username | String | (Required for basic authentication only) Your Apigee username (typically an email address). You can optionally specify the username in a .netrc file. If you do so, then you are not required to provide your username on the command line. See also Using .netrc for credentials. |\n| -v, --verbose | nan | (Optional) Produces verbose output.                                                             |\n```\n./apigee-remote-service-cli bindings add httpbin.org envoy-test -o myorg -e test -u user@example.com -c config.yaml -p xxxxxx\nproduct envoy-test is now bound to: httpbin.org\n```\n### List bindings\nList all API products that are bound to the Remote Service.\n| Parameters  | Type | Description                                                                   |\n|:---------------|:-------|:--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|\n| -c, --config | String | (Required) The path to the Apigee Remote Service config file. Tip: When you specify this option, you can omit most other command parameters. See Using the --config option.                           |\n| -e, --env  | String | (Required) An environment in your organization.                                                          |\n| -h, --help  | nan | Displays help for the command parameters.                                                            |\n| --insecure  | nan | Allow insecure server connections when using SSL                                                          |\n| --legacy  | nan | Set this flag if you are using Apigee Cloud. It sets the management and runtime URLs for Edge Cloud.                                             |\n| --opdk   | nan | Set this flag if you are using Apigee for Private Cloud.                                                        |\n| -o, --org  | String | (Required) An Apigee organization. You must be an org administrator.                                                     |\n| -p, --password | String | (Required for basic authentication only) Your Apigee password. You can optionally specify the password in a .netrc file. If you do so, then you are not required to provide your password on the command line. See also Using .netrc for credentials.        |\n| -r, --runtime | String | Apigee runtime base URL (required for hybrid or opdk).                                                        |\n| -t, --token | String | (Required for OAuth token authentication only) An OAuth or SAML token that you generate from your Apigee account information. For information on generating tokens, see Obtaining an OAuth 2.0 access token and SAML overview.              |\n| -u, --username | String | (Required for basic authentication only) Your Apigee username (typically an email address). You can optionally specify the username in a .netrc file. If you do so, then you are not required to provide your username on the command line. See also Using .netrc for credentials. |\n| -v, --verbose | nan | (Optional) Produces verbose output.                                                             |\n```\napigee-remote-service-cli bindings list -o myorg -e test -u user@example.com -c config.yaml -p abc123\nPI Products\n============\nBound\n----envoy-test:\n Quota: 5 requests every 1 minute\n Target bindings:\n httpbin.org\n Paths:\nhttpbin:\n Quota: 5 requests every 1 minute\n Target bindings:\n httpbin.org\n Paths:\n /httpbin\n /\nUnbound\n------product-1:\n Quota: 100 requests every 1 hour\nproduct-2:\n Quota: 1000 requests every 1 month\nproduct-3:\nproduct-4:\n```\n### Remove a binding\nRemove the binding of Remote Service for Envoy from an API product.\nFor Apigee hybrid:\n```\napigee-remote-service-cli bindings remove [service_name] [product_name] -o [organization] -e [environment] -t [token]\n```\n| Parameters  | Type | Description                                                                   |\n|:---------------|:-------|:--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|\n| -c, --config | String | (Required) The path to the Apigee Remote Service config file. Tip: When you specify this option, you can omit most other command parameters. See Using the --config option.                           |\n| -e, --env  | String | (Required) An environment in your organization.                                                          |\n| -h, --help  | nan | Displays help for the command parameters.                                                            |\n| --insecure  | nan | Allow insecure server connections when using SSL                                                          |\n| --legacy  | nan | Set this flag if you are using Apigee Cloud. It sets the management and runtime URLs for Edge Cloud.                                             |\n| --opdk   | nan | Set this flag if you are using Apigee for Private Cloud.                                                        |\n| -o, --org  | String | (Required) An Apigee organization. You must be an org administrator.                                                     |\n| -p, --password | String | (Required for basic authentication only) Your Apigee password. You can optionally specify the password in a .netrc file. If you do so, then you are not required to provide your password on the command line. See also Using .netrc for credentials.        |\n| -r, --runtime | String | Apigee runtime base URL (required for hybrid or opdk).                                                        |\n| -t, --token | String | (Required for OAuth token authentication only) An OAuth or SAML token that you generate from your Apigee account information. For information on generating tokens, see Obtaining an OAuth 2.0 access token and SAML overview.              |\n| -u, --username | String | (Required for basic authentication only) Your Apigee username (typically an email address). You can optionally specify the username in a .netrc file. If you do so, then you are not required to provide your username on the command line. See also Using .netrc for credentials. |\n| -v, --verbose | nan | (Optional) Produces verbose output.                                                             |\n```\n./apigee-remote-service-cli bindings remove httpbin.org envoy-test -o myorg -e test -u user@example.com -c config.yaml -p xxxxxx\nproduct envoy-test is no longer bound to: httpbin.org\n```\n## Help command\nOnline help is provided for all `apigee-remote-service-cli` commands. Just type:\n```\napigee-remote-service-cli help\n```\nFor help on any command, type:\n```\napigee-remote-service-cli [command] help\n```\nFor example:\n```\napigee-remote-service-cli provision help\n```\n## Provision command\nThe `apigee-remote-service-cli provision` command installs a proxy in your Apigee organization, sets up a certificate, and generates credentials that you'll need to configure the Apigee Adapter for Envoy.\n| Parameters    | Type | Description                                                                      |\n|:--------------------------|:-------|:-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|\n| -c, --config    | String | Path to Apigee Remote Service config file. Tip: When you specify this option, you can omit most other command parameters. See Using the --config option.                                  |\n| -e, --environment   | String | (Required) An environment in your organization.                                                             |\n| -f, --force-proxy-install | nan | (Optional) Forces the remote-service proxy to be re-installed if it is already installed in your org. UPGRADE NOTE: If you are upgrading to v1.0-beta.4 or a later version, you must include the --force-proxy-install flag to replace the existing remote service proxy deployed on Apigee. |\n| -h, --help    | nan | Displays help for the command parameters.                                                              |\n| -k, --key     | String | Specifies the key returned from the apigee-remote-service-cli provision command.                                                    |\n| --legacy     | nan | Apigee Edge (sets management and runtime URL)                                                             |\n| -m, --management   | String | (Required if you are on Apigee Private Cloud) Your Apigee management base URL. Default: https://api.enterprise.apigee.com                                          |\n| -n, --namespace   | String | emit configuration as an Envoy ConfigMap in the specified namespace.                                                        |\n| --opdk     | String | Apigee OPDK.                                                                      |\n| -o, --organization  | String | (Required) Your Apigee organization. You must be an org administrator.                                                       |\n| -p, --password   | String | (Required for basic authentication only) Your Apigee password. You can optionally specify the password in a .netrc file. If you do so, then you are not required to provide your password on the command line. See also Using .netrc for credentials.           |\n| --rotate-int    | int | If n > 0, generate new private key and keep n public keys (hybrid only)                                                       |\n| -r, --runtime    | String | Apigee runtime base URL (required for hybrid or opdk)                                                           |\n| -s, --secret    | String | Specifies the secret returned from the apigee-remote-service-cli provision command.                                                    |\n| --strength    | int | (Optional) Specifies the encryption strength for SSL certificates used in provisioning the adapter. Default 2048                                            |\n| -t, --token    | String | (Hybrid only) Apigee OAuth or SAML token.                                                              |\n| -u, --username   | String | (Required for basic authentication only) Your Apigee username (typically an email address). You can optionally specify the username in a .netrc file. See also Using .netrc for credentials.                         |\n| -v, --verbose    | nan | (Optional) Produces verbose output.                                                                |\n| --virtual-hosts   | String | Overrides the default virtual hosts.                                                                |\n| --years     | int | (Optional) The number of years before the SSL certificate used in the provisioning expires. Default: 1                                               |\nBe sure to capture the output of the `provision` command in a file, which is used as input for other Apigee Adapter for Envoy operations.\nApigee hybrid example:\n```\napigee-remote-service-cli provision --organization $ORG --environment $ENV --runtime $RUNTIME --namespace $NAMESPACE --token $TOKEN > config.yaml\n```\n## Token commands\nYou can use a JWT token to make authenticated API proxy calls instead of using an API key. The token commands let you create, inspect, and rotate JWT tokens for this purpose.\n### Create a JWT token\n[Using JWT based authentication](/apigee/docs/api-platform/envoy-adapter/v1.0.x/operation#using-jwt-based-authentication)\n```\napigee-remote-service-cli token create -c [config_file] --id [consumer_key] --secret [consumer_secret] -r [runtime] -o [org] -e [env]\n```\n| Parameters | Type | Description                                         |\n|:--------------|:-------|:-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------|\n| -c, --config | String | (Required) The path to the Apigee Remote Service config file. Tip: When you specify this option, you can omit most other command parameters. See Using the --config option. |\n| -e, --env  | String | (Required) An environment in your organization.                                |\n| -h, --help | nan | Displays help for the command parameters.                                 |\n| --insecure | nan | Allow insecure server connections when using SSL.                               |\n| -o, --org  | String | (Required) An Apigee organization. You must be an org administrator.                           |\n| -r, --runtime | String | Apigee runtime base URL (required only for hybrid or opdk).                             |\n| -v, --verbose | nan | (Optional) Produces verbose output.                                   |\n```\napigee-remote-service-cli token create -o myorg -e test -i YUmlZAcBKNsTAelJqPZFl3sh58ObATX9 -s icTARgaKHqvUH1dq -c config.yaml\n```\n```\neyJraWQiOiIxIiwidHlwIjoiSldUIiwiYWxnIjoiUlMyNTYifQ.eyJhY2Nlc3NfdG9rZW4iOiJ0a2tlVzVKQTY2a0pZYTB4bFV1cVBsUW1BMU43IiwiYXVkIjoiaXN0aW8iLCJuYmYiOjE1MzAxMzg1OTEsImFwaV9wcm9kdWN0X2xpc3QiOlsiaXN0aW8tcHJvZHVjdCJdLCJhcHBsaWNhdGlvbl9uYW1lIjoiaXN0aW8tYXBwIiwiZGV2ZWxvcGVyX2VtYWlsIjoicFluZ2Zsb3lkQGdvb2dsZS5jb20iLCJpc3MiOiJodHRwczovL2FwaWdlZXNlYXJjaC10ZXN0LmFwaWdlZS5uZXQvaXN0aW8tYXV0aC90b2tlbiIsImV4cCI6MTUzMDEzOTQ5MSwiaWF0IjoxNTMwMTM4NTkxLCJqdGkiOiIxODgzMzViZi0wMmE4LTRjZGUsOGFkOS0yMWJmNDZjNmRjZDkiLCJjbGllbnRfaWQiOiJZVW1sWkFjQktOc1RBZWxKcVBZRmwzc2g1OE9iQVRYOSJ9.AL7pKSTmond-NSPRNNHVbIzTdAnZjOXcjQ-BbOJ_8lsQvF7PuiOUrGIhY5XTcJusisKgbCdtIxBl8Wq1EiQ_fKnUc3JYYOqzpTB5bGoFy0Yqbfu96dneuWyzgZnoQBkqwZkbQTIg7WNTGx1TJX-UTePvBPxAefiAbaEUcigX9tTsXPoRJZOTrm7IOeKpxpB_gQYkxQtV1_NbERxjTPyMbHdMWal9_xRVzSt7mpTGudMN9OR-VtQ1uXA67GOqhZWcOzq57qImOiCMbaoKnKUADevyWjX_VscN5ZZUtzQUQhTrmv8aR69-uVhMIPKp9juMyYKaYn2IsYZEeCWfhfV45Q\n```\n### Inspect a JWT token\n[Inspect a token](/apigee/docs/api-platform/envoy-adapter/v1.0.x/operation#inspect-a-token)\n```\napigee-remote-service-cli token inspect -o [organization] -e [environment] -f [token_file] --runtime [host_alias]\n```\n| Parameters | Type | Description                                         |\n|:--------------|:-------|:-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------|\n| -c, --config | String | (Required) The path to the Apigee Remote Service config file. Tip: When you specify this option, you can omit most other command parameters. See Using the --config option. |\n| -e, --env  | String | (Required) An environment in your organization.                                |\n| -h, --help | nan | Displays help for the command parameters.                                 |\n| --insecure | nan | Allow insecure server connections when using SSL.                               |\n| -o, --org  | String | (Required) An Apigee organization. You must be an org administrator.                           |\n| -r, --runtime | String | Apigee runtime base URL (required only for hybrid or opdk).                             |\n| -v, --verbose | nan | (Optional) Produces verbose output.                                   |\n```\napigee-remote-service-cli token inspect -c config.yaml <<< $TOKEN\n```\n```\n{\n\t\"aud\": [\t\t\"remote-service-client\"\n\t],\n\t\"exp\": 1591741549,\n\t\"iat\": 1591740649,\n\t\"iss\": \"https://apigee-docs-test.apigee.net/remote-service/token\",\n\t\"jti\": \"99325d2e-6440-4278-9f7f-b252a1a79e53\",\n\t\"nbf\": 1591740649,\n\t\"access_token\": \"VfzpXzBGAQ07po0bPMKY4JgQjus\",\n\t\"api_product_list\": [\t\t\"httpbin\"\n\t],\n\t\"application_name\": \"httpbin\",\n\t\"client_id\": \"GYDGHy5TRpV8AejXCOlreP7dPVepA8H\",\n\t\"developer_email\": \"user@example.com\",\n\t\"scope\": \"\"\n}\nverifying...\ntoken ok.\n```\n### Rotate a JWT token\n| Parameters | Type | Description                                         |\n|:--------------|:-------|:-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------|\n| -c, --config | String | (Required) The path to the Apigee Remote Service config file. Tip: When you specify this option, you can omit most other command parameters. See Using the --config option. |\n| -e, --env  | String | (Required) An environment in your organization.                                |\n| -h, --help | nan | Displays help for the command parameters.                                 |\n| --insecure | nan | Allow insecure server connections when using SSL                                |\n| --truncate | int | Number of certs to keep in jwks (default 2)                                 |\n| -o, --org  | String | (Required) An Apigee organization. You must be an org administrator.                           |\n| -r, --runtime | String | Apigee runtime base URL (required for hybrid or opdk).                              |\n| -v, --verbose | nan | (Optional) Produces verbose output.                                   |\n```\napigee-remote-service-cli token rotate-cert -c config.yaml -o myorg -e test -k 2e238ffa15dc5ab6a1e97868e7581f6c60ddb8575478582c256d8b7e5b2677a8 -s 51058077223fa7b683c3bea845c5cca138340d1d5583922b6d465f9f918a4b08\n```\n```\ncertificate successfully rotated\n```\n## Using .netrc for credentials\n`apigee-remote-service-cli`\n`username`\n`password`\n`.netrc`\n`api.enterprise.apigee.com`\n`management`\n`http://192.162.55.100`\n## Version command\nPrint the CLI version.\n```\napigee-remote-service-cli version\n```\n## \n Using the --config command option\n`--config`\n`provision`\n- organization\n- environment\n- runtime\n- management\n- insecure\n- namespace\n- legacy\n- opdk\nFor example, you could execute the `provision` command like this:\n```\napigee-remote-service-cli provision --config='old-config.yaml' > new-config.yaml\n```\n## \n Configuration file\nThis section shows an example configuration file with all of the available options.\n```\nglobal:\n temp_dir: /tmp/apigee-istio\n keep_alive_max_connection_age: 10m\n api_address: :5000\n metrics_address: :5001\n tls:\n cert_file: tls.crt\n key_file: tls.key\ntenant:\n internal_api: https://istioservices.apigee.net/edgemicro\n remote_service_api: https://org-test.apigee.net/remote-service\n org_name: org\n env_name: env\n key: mykey\n secret: mysecret\n client_timeout: 30s\n allow_unverified_ssl_cert: false\nproducts:\n refresh_rate: 2m\nanalytics:\n legacy_endpoint: false\n file_limit: 1024\n send_channel_size: 10\n collection_interval: 10s\n fluentd_endpoint: apigee-udca-myorg-test.apigee.svc.cluster.local:20001\n tls:\n ca_file: /opt/apigee/tls/ca.crt\n cert_file: /opt/apigee/tls/tls.crt\n key_file: /opt/apigee/tls/tls.key\n allow_unverified_ssl_cert: false\nauth:\n api_key_claim: claim\n api_key_cache_duration: 30m\n api_key_header: x-api-key\n api_target_header: :authority\n reject_unauthorized: true\n jwks_poll_interval: 0s\n```", "guide": "Apigee"}