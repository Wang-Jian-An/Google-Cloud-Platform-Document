{"title": "IAM - \u9077\u79fb\u5230 Service Account Credentials API", "url": "https://cloud.google.com/iam/docs/migrating-to-credentials-api?hl=zh-cn", "abstract": "# IAM - \u9077\u79fb\u5230 Service Account Credentials API\n[Service Account Credentials API](https://cloud.google.com/iam/docs/reference/credentials/rest?hl=zh-cn) \u7528\u65bc\u7232 Identity and Access Management (IAM) \u670d\u52d9\u8cec\u865f\u5275\u5efa\u77ed\u671f\u6709\u6548\u7684\u6191\u64da\u3002\u60a8\u9084\u53ef\u4ee5\u4f7f\u7528\u6b64 API \u7232 JSON Web \u4ee4\u724c (JWT) \u4ee5\u53ca\u5305\u542b\u5176\u4ed6\u985e\u578b\u4ee4\u724c\u7684\u4e8c\u9032\u5236\u6578\u64da\u7684 blob \u7c3d\u540d\u3002\n[IAM API](https://cloud.google.com/iam/docs/reference/rest?hl=zh-cn) \u4e5f\u5305\u542b\u7528\u65bc\u7232 JWT \u548c\u4e8c\u9032\u5236 blob \u7c3d\u540d\u7684\u65b9\u6cd5\u3002\u81ea 2020 \u5e74 7 \u6708 1 \u65e5\u8d77\uff0cREST API \u4e2d\u4ee5\u53ca IAM API \u7684\u6240\u6709 [\u5ba2\u6236\u7aef\u5eab](https://cloud.google.com/iam/docs/write-policy-client-libraries?hl=zh-cn) \u4e2d\u6703\u68c4\u7528\u9019\u4e9b\u65b9\u6cd5\u3002\u6b64\u5916\uff0c\u5982\u679c\u60a8\u4f7f\u7528 Google Cloud CLI \u7232 JWT \u7c3d\u540d\uff0c\u5247\u53ef\u80fd\u9700\u8981\u5411 JWT \u8072\u660e\u96c6\u6dfb\u52a0\u65b0\u8072\u660e\u3002\u60a8\u4ecd\u7136\u53ef\u4ee5\u4f7f\u7528\u5df2\u68c4\u7528\u7684\u65b9\u6cd5\uff0c\u4f46\u5b83\u5011\u4e0d\u652f\u6301 [HTTP \u8acb\u6c42\u6279\u8655\u7406](https://developers.google.com/people/v1/batch?hl=zh-cn) \u7b49\u9ad8\u7d1a\u529f\u80fd\u3002\u6211\u5011\u5efa\u8b70\u60a8\u6539\u7528 Service Account Credentials API\u3002\n\u8207 IAM API \u76f8\u6bd4\uff0cService Account Credentials API \u53ef\u8b93\u60a8\u66f4\u9748\u6d3b\u5730\u8a2d\u7f6e\u5df2\u7c3d\u540d JWT \u7684\u5230\u671f\u6642\u9593\u3002\u6b64\u5916\uff0cService Account Credentials API \u9084\u6dfb\u52a0\u4e86\u591a\u500b\u65b0\u7684 API \u65b9\u6cd5\uff0c\u4ee5\u751f\u6210\u6a21\u64ec\u4ee4\u724c\u3002\n\u672c\u9801\u9762\u4ecb\u7d39\u77ad\u5982\u4f55\u66f4\u65b0\u73fe\u6709\u4ee3\u78bc\u4ee5\u4f7f\u7528 Service Account Credentials API\u3002\u5982\u679c\u60a8\u5c0d\u9019\u9805\u8b8a\u66f4\u6709\u4efb\u4f55\u53cd\u994b\uff0c\u53ef\u4ee5 [\u586b\u5beb\u53cd\u994b\u8868\u55ae](https://docs.google.com/forms/d/e/1FAIpQLScbtyMsPmVVHZjM2QH0jQLy3bteyd306EjJyW7OtU4Zeg-9yw/viewform?hl=zh-cn) \u3002\u60a8\u9084\u53ef\u4ee5\u4f7f\u7528\u96fb\u5b50\u90f5\u4ef6\u5730\u5740 [iam-sign-deprecation-public@google.com](mailto:iam-sign-deprecation-public@google.com) \u4f86\u8acb\u6c42\u652f\u6301\u4e26\u63d0\u4f9b\u8a73\u7d30\u7684\u53cd\u994b\u3002\n", "content": "## \u6e96\u5099\u5de5\u4f5c\n- Titles in dynamic includes are not used anywhere, and we should avoid paying to translate them\u5553\u7528 Service Account Credentials API\u3002 [\u5553\u7528 API](https://console.cloud.google.com/flows/enableapi?apiid=iamcredentials.googleapis.com&%3Bredirect=https%3A%2F%2Fconsole.cloud.google.com&hl=zh-cn) ## \u5553\u7528\u5be9\u8988\u65e5\u8a8c\n\u5982\u679c\u60a8\u5e0c\u671b\u91dd\u5c0d\u7232 JWT \u548c blob \u7c3d\u540d\u7684\u8acb\u6c42\u63a5\u6536 [\u5be9\u8988\u65e5\u8a8c](https://cloud.google.com/iam/docs/audit-logging?hl=zh-cn) \uff0c\u5247\u5fc5\u9808\u7232 IAM API [\u5553\u7528\u6578\u64da\u8a2a\u554f\u5be9\u8988\u65e5\u8a8c](https://cloud.google.com/logging/docs/audit/configure-data-access?hl=zh-cn) \u3002\u7232 IAM API \u5553\u7528\u6578\u64da\u8a2a\u554f\u5be9\u8988\u65e5\u8a8c\u4e5f\u6703\u7232 Service Account Credentials API \u5553\u7528\u9019\u4e9b\u5be9\u8988\u65e5\u8a8c\u3002\n\u9019\u5169\u500b API \u751f\u6210\u7684\u65e5\u8a8c\u689d\u76ee\u4e4b\u9593\u5b58\u5728\u4e00\u4e9b\u986f\u8457\u5dee\u7570\uff1a\n| \u5be9\u8988\u65e5\u8a8c\u689d\u76ee\u4e4b\u9593\u7684\u5dee\u7570 | \u5be9\u8988\u65e5\u8a8c\u689d\u76ee\u4e4b\u9593\u7684\u5dee\u7570.1                                                                                    |\n|:-------------------------|:----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|\n| \u65b9\u6cd5\u540d\u7a31     | IAM API \u65b9\u6cd5\u540d\u7a31 (protoPayload.methodName) \u662f\u4ee5\u4e0b\u540d\u7a31\u4e4b\u4e00\uff1a google.iam.admin.v1.SignBlob google.iam.admin.v1.SignJwt Service Account Credentials API \u65b9\u6cd5\u540d\u7a31\u662f\u4ee5\u4e0b\u540d\u7a31\u4e4b\u4e00\uff1a SignBlob SignJwt                                         |\n| \u8acb\u6c42\u985e\u578b     | IAM API \u8acb\u6c42\u985e\u578b (protoPayload.request.@type) \u662f\u4ee5\u4e0b\u985e\u578b\u4e4b\u4e00\uff1a type.googleapis.com/google.iam.admin.v1.SignBlobRequest type.googleapis.com/google.iam.admin.v1.SignJwtRequest Service Account Credentials API \u8acb\u6c42\u985e\u578b\u662f\u4ee5\u4e0b\u985e\u578b\u4e4b\u4e00\uff1a type.googleapis.com/google.iam.credentials.v1.SignBlobRequest type.googleapis.com/google.iam.credentials.v1.SignJwtRequest |\n| \u670d\u52d9\u540d\u7a31     | IAM API \u670d\u52d9\u540d\u7a31 (protoPayload.serviceName) \u662f iam.googleapis.com\u3002 Service Account Credentials API \u670d\u52d9\u540d\u7a31\u662f iamcredentials.googleapis.com\u3002                                                      |\n\u6578\u64da\u8a2a\u554f\u5be9\u8988\u65e5\u8a8c\u6703\u8a08\u5165\u60a8\u6bcf\u6708\u7684\u514d\u8cbb\u65e5\u8a8c\u8a18\u9304\u6578\u64da\u6ce8\u5165\u914d\u984d\u3002\u5982\u679c\u8d85\u51fa\u6b64\u914d\u984d\uff0c\u60a8\u5c07\u9700\u8981\u652f\u4ed8\u65e5\u8a8c\u6ce8\u5165\u8cbb\u7528\u3002\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [Google Cloud Observability \u7684\u50f9\u683c](https://cloud.google.com/stackdriver/pricing?hl=zh-cn) \u3002\n## \u9077\u79fb\u7528\u65bc\u7232 JWT \u7c3d\u540d\u7684\u4ee3\u78bc\n\u672c\u90e8\u5206\u4ecb\u7d39\u77ad\u5982\u4f55\u5c07\u7528\u65bc\u7232 JWT \u7c3d\u540d\u7684\u4ee3\u78bc\u9077\u79fb\u5230 Service Account Credentials API\u3002\n### \u4f7f\u7528 REST API \u7232 JWT \u7c3d\u540d\n\u4e0b\u8868\u5c55\u793a\u4e86 [\u4f7f\u7528 IAM REST API \u7232 JWT \u7c3d\u540d](https://cloud.google.com/iam/docs/reference/rest/v1/projects.serviceAccounts/signJwt?hl=zh-cn) \u8207 [\u4f7f\u7528 Service Account Credentials API \u7232 JWT \u7c3d\u540d](https://cloud.google.com/iam/docs/reference/credentials/rest/v1/projects.serviceAccounts/signJwt?hl=zh-cn) \u4e4b\u9593\u7684\u5dee\u7570\u3002\u8acb\u66f4\u65b0\u60a8\u7684\u4ee3\u78bc\u4ee5\u53cd\u6620\u9019\u4e9b\u5dee\u7570\uff1a\n| \u4e0d\u540c JWT \u7c3d\u540d\u65b9\u5f0f\u7684\u5dee\u7570 | \u4e0d\u540c JWT \u7c3d\u540d\u65b9\u5f0f\u7684\u5dee\u7570.1                                                                                                                                             |\n|:--------------------------|:----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|\n| HTTP \u7aef\u9ede     | IAM API IAM API \u4f7f\u7528\u4ee5\u4e0b HTTP \u65b9\u6cd5\u548c\u7aef\u9ede\uff1a POST https://iam.googleapis.com/v1/projects/project-id/serviceAccounts/sa-email:signJwt \u5728\u6b64\u7db2\u5740\u4e2d\uff0cproject-id \u662f\u9805\u76ee ID\uff0csa-email \u662f\u670d\u52d9\u8cec\u865f\u7684\u96fb\u5b50\u90f5\u4ef6\u5730\u5740\u3002 POST https://iam.googleapis.com/v1/projects/-/serviceAccounts/sa-email:signJwt \u5728\u6b64\u7db2\u5740\u4e2d\uff0c\u901a\u914d\u7b26 - \u66ff\u63db\u7684\u662f\u9805\u76ee ID\uff0csa-email \u662f\u670d\u52d9\u8cec\u865f\u7684\u96fb\u5b50\u90f5\u4ef6\u5730\u5740\u3002 Service Account Credentials API \u4f7f\u7528\u4ee5\u4e0b HTTP \u65b9\u6cd5\u548c\u7aef\u9ede\u3002\u8acb\u52ff\u5c07\u901a\u914d\u7b26\u66ff\u63db\u7232\u9805\u76ee ID\uff1a POST https://iamcredentials.googleapis.com/v1/projects/-/serviceAccounts/sa-email:signJwt \u5728\u6b64\u7db2\u5740\u4e2d\uff0csa-email \u662f\u670d\u52d9\u8cec\u865f\u7684\u96fb\u5b50\u90f5\u4ef6\u5730\u5740\u3002 |\n| \u8acb\u6c42\u6b63\u6587     | IAM API \u8acb\u6c42\u6b63\u6587\u4e2d\u5305\u542b\u4e00\u500b payload \u5b57\u6bb5\u3002\u5b83\u7684\u503c\u662f\u9700\u8981\u7c3d\u540d\u7684 JWT \u8f09\u8377\u3002\u8f09\u8377\u5fc5\u9808\u662f JSON \u5c0d\u8c61\uff0c\u5e8f\u5217\u5316\u7232\u5305\u542b JWT \u8072\u660e\u96c6\u7684\u5b57\u7b26\u4e32\u3002 \u5982\u679c\u60a8\u63d0\u4f9b\u5230\u671f\u6642\u9593 (exp) \u8072\u660e\uff0c\u5247\u5b83\u4e0d\u5f97\u9577\u65bc\u672a\u4f86\u7684 12 \u5c0f\u6642\u3002\u5982\u679c\u60a8\u7701\u7565 exp \u8072\u660e\uff0c\u7cfb\u7d71\u6703\u81ea\u52d5\u6dfb\u52a0\u8a72\u8072\u660e\u4e26\u5c07\u5176\u8a2d\u7f6e\u7232\u672a\u4f86 1 \u5c0f\u6642\u3002 Service Account Credentials API \u8acb\u6c42\u6b63\u6587\u4e2d\u5305\u542b\u4e00\u500b payload \u5b57\u6bb5\uff0c\u9664\u5230\u671f\u6642\u9593 (exp) \u8072\u660e\u7684\u884c\u7232\u4ee5\u5916\uff0c\u8207 IAM API \u4e2d\u7684\u8a72\u5b57\u6bb5\u5b8c\u5168\u76f8\u540c\uff1a \u5982\u679c\u60a8\u63d0\u4f9b exp \u8072\u660e\uff0c\u5247\u5b83\u4e0d\u5f97\u9577\u65bc\u672a\u4f86\u7684 12 \u5c0f\u6642\u3002 \u5982\u679c\u60a8\u7701\u7565 exp \u8072\u660e\uff0c\u7cfb\u7d71\u4e0d\u6703\u81ea\u52d5\u6dfb\u52a0\u8a72\u8072\u660e\u3002\u5982\u679c\u60a8\u4f7f\u7528\u5df2\u7c3d\u540d\u7684 JWT \u5411 Google API \u6216\u9700\u8981 exp \u8072\u660e\u7684\u5176\u4ed6 API \u9032\u884c\u8eab\u4efd\u9a57\u8b49\uff0c\u5247\u5fc5\u9808\u63d0\u4f9b\u8a72\u8072\u660e\u3002    |\n| \u97ff\u61c9\u6b63\u6587     | \u9019\u5169\u500b API \u5728\u97ff\u61c9\u6b63\u6587\u4e2d\u4f7f\u7528\u76f8\u540c\u7684\u5b57\u6bb5\u3002                                                                                                                                         |\n### \u4f7f\u7528\u5ba2\u6236\u7aef\u5eab\u7232 JWT \u7c3d\u540d\nService Account Credentials API \u7684\u5ba2\u6236\u7aef\u5eab\u8207 IAM API \u7684\u5ba2\u6236\u7aef\u5eab\u662f\u76f8\u4e92\u7368\u7acb\u7684\u3002\n\u5982\u9700\u4f7f\u7528 Service Account Credentials API\uff0c\u8acb\u5c07\u5176\u5ba2\u6236\u7aef\u5eab\u6dfb\u52a0\u5230\u60a8\u7684\u61c9\u7528\uff0c\u7136\u5f8c\u66f4\u65b0\u60a8\u7684\u4ee3\u78bc\u4ee5\u4f7f\u7528\u65b0\u7684\u5ba2\u6236\u7aef\u5eab\uff1a\n\u5c07 [C# \u7248 Service Account Credentials \u5ba2\u6236\u7aef\u5eab](https://developers.google.com/api-client-library/dotnet/apis/iamcredentials/v1/?hl=zh-cn) \u6dfb\u52a0\u5230\u60a8\u7684\u61c9\u7528\u3002\u4f7f\u7528 [SignJwt() \u65b9\u6cd5](https://googleapis.dev/dotnet/Google.Apis.IAMCredentials.v1/latest/api/Google.Apis.IAMCredentials.v1.ProjectsResource.ServiceAccountsResource.html) \u751f\u6210\u7c3d\u540d\u3002\n\u670d\u52d9\u8cec\u865f\u7684\u540d\u7a31\u5fc5\u9808\u4f7f\u7528\u901a\u914d\u7b26 `-` \u4f86\u8868\u793a\u9805\u76ee ID\uff1a\n \u6709\u6548 \uff1a\u63a1\u7528\u901a\u914d\u7b26\u7684\u540d\u7a31\n```\nprojects/-/serviceAccounts/my-service-account@my-project.iam.gserviceaccount.com\n```\n \u7121\u6548 \uff1a\u63a1\u7528\u9805\u76ee ID \u7684\u540d\u7a31\n```\nprojects/my-project/serviceAccounts/my-service-account@my-project.iam.gserviceaccount.com\n```\n\u5982\u679c\u60a8\u4e0d\u518d\u4f7f\u7528 [C# \u7248 IAM \u5ba2\u6236\u7aef\u5eab](https://developers.google.com/api-client-library/dotnet/apis/iam/v1/?hl=zh-cn) \uff0c\u53ef\u4ee5\u5c07\u5176\u5f9e\u61c9\u7528\u4e2d\u79fb\u9664\u3002\u5c07 [Go \u7248 Service Account Credentials \u5ba2\u6236\u7aef\u5eab](https://pkg.go.dev/cloud.google.com/go/iam/credentials/apiv1?tab=doc) \u6dfb\u52a0\u5230\u60a8\u7684\u61c9\u7528\u3002\u4f7f\u7528 [IamCredentialsClient.SignJwt() function](https://pkg.go.dev/cloud.google.com/go/iam/credentials/apiv1?tab=doc#IamCredentialsClient.SignJwt) \u751f\u6210\u7c3d\u540d\u3002\n\u670d\u52d9\u8cec\u865f\u7684\u540d\u7a31\u5fc5\u9808\u4f7f\u7528\u901a\u914d\u7b26 `-` \u4f86\u8868\u793a\u9805\u76ee ID\uff1a\n \u6709\u6548 \uff1a\u63a1\u7528\u901a\u914d\u7b26\u7684\u540d\u7a31\n```\nprojects/-/serviceAccounts/my-service-account@my-project.iam.gserviceaccount.com\n```\n \u7121\u6548 \uff1a\u63a1\u7528\u9805\u76ee ID \u7684\u540d\u7a31\n```\nprojects/my-project/serviceAccounts/my-service-account@my-project.iam.gserviceaccount.com\n```\n\u5982\u679c\u60a8\u4e0d\u518d\u4f7f\u7528 [Go \u7248 IAM \u5ba2\u6236\u7aef\u5eab](https://pkg.go.dev/google.golang.org/api/iam/v1?tab=doc) \uff0c\u53ef\u4ee5\u5c07\u5176\u5f9e\u61c9\u7528\u4e2d\u79fb\u9664\u3002\u5c07 [Java \u7248 Service Account Credentials \u5ba2\u6236\u7aef\u5eab](https://github.com/googleapis/java-iamcredentials) \u6dfb\u52a0\u5230\u60a8\u7684\u61c9\u7528\u3002\u4f7f\u7528 [IamCredentialsClient#signJwt() \u65b9\u6cd5](https://cloud.google.com/java/docs/reference/google-cloud-iamcredentials/latest/com.google.cloud.iam.credentials.v1.IamCredentialsClient?hl=zh-cn#com_google_cloud_iam_credentials_v1_IamCredentialsClient_signJwt_com_google_cloud_iam_credentials_v1_ServiceAccountName_java_util_List_java_lang_String__java_lang_String_) \u751f\u6210\u7c3d\u540d\u3002\n\u670d\u52d9\u8cec\u865f\u7684\u540d\u7a31\u5fc5\u9808\u4f7f\u7528\u901a\u914d\u7b26 `-` \u4f86\u8868\u793a\u9805\u76ee ID\uff1a\n \u6709\u6548 \uff1a\u63a1\u7528\u901a\u914d\u7b26\u7684\u540d\u7a31\n```\nprojects/-/serviceAccounts/my-service-account@my-project.iam.gserviceaccount.com\n```\n \u7121\u6548 \uff1a\u63a1\u7528\u9805\u76ee ID \u7684\u540d\u7a31\n```\nprojects/my-project/serviceAccounts/my-service-account@my-project.iam.gserviceaccount.com\n```\n\u5982\u679c\u60a8\u4e0d\u518d\u4f7f\u7528 [Java \u7248 IAM \u5ba2\u6236\u7aef\u5eab](https://github.com/googleapis/google-api-java-client-services/tree/master/clients/google-api-services-iam/v1) \uff0c\u53ef\u4ee5\u5c07\u5176\u5f9e\u61c9\u7528\u4e2d\u79fb\u9664\u3002\u5c07 [Node.js \u7248 Service Account Credentials \u5ba2\u6236\u7aef\u5eab](https://github.com/googleapis/google-api-nodejs-client/tree/master/src/apis/iamcredentials) \u6dfb\u52a0\u5230\u60a8\u7684\u61c9\u7528\u3002\u4f7f\u7528 [signJwt() \u65b9\u6cd5](https://googleapis.dev/nodejs/googleapis/latest/iamcredentials/classes/Resource$Projects$Serviceaccounts.html#signJwt) \u751f\u6210\u7c3d\u540d\u3002\n\u670d\u52d9\u8cec\u865f\u7684\u540d\u7a31\u5fc5\u9808\u4f7f\u7528\u901a\u914d\u7b26 `-` \u4f86\u8868\u793a\u9805\u76ee ID\uff1a\n \u6709\u6548 \uff1a\u63a1\u7528\u901a\u914d\u7b26\u7684\u540d\u7a31\n```\nprojects/-/serviceAccounts/my-service-account@my-project.iam.gserviceaccount.com\n```\n \u7121\u6548 \uff1a\u63a1\u7528\u9805\u76ee ID \u7684\u540d\u7a31\n```\nprojects/my-project/serviceAccounts/my-service-account@my-project.iam.gserviceaccount.com\n```\n\u5982\u679c\u60a8\u4e0d\u518d\u4f7f\u7528 [Node.js \u7248 IAM \u5ba2\u6236\u7aef\u5eab](https://github.com/googleapis/google-api-nodejs-client/tree/master/src/apis/iam) \uff0c\u53ef\u4ee5\u5c07\u5176\u5f9e\u61c9\u7528\u4e2d\u79fb\u9664\u3002\u5c07 [PHP \u7248 Service Account Credentials \u5ba2\u6236\u7aef\u5eab](https://github.com/googleapis/google-api-php-client-services/tree/master/src/IAMCredentials) \u6dfb\u52a0\u5230\u60a8\u7684\u61c9\u7528\u3002\u4f7f\u7528 [signJwt() \u65b9\u6cd5](https://github.com/googleapis/google-api-php-client-services/blob/master/src/IAMCredentials/Resource/ProjectsServiceAccounts.php) \u751f\u6210\u7c3d\u540d\u3002\n\u670d\u52d9\u8cec\u865f\u7684\u540d\u7a31\u5fc5\u9808\u4f7f\u7528\u901a\u914d\u7b26 `-` \u4f86\u8868\u793a\u9805\u76ee ID\uff1a\n \u6709\u6548 \uff1a\u63a1\u7528\u901a\u914d\u7b26\u7684\u540d\u7a31\n```\nprojects/-/serviceAccounts/my-service-account@my-project.iam.gserviceaccount.com\n```\n \u7121\u6548 \uff1a\u63a1\u7528\u9805\u76ee ID \u7684\u540d\u7a31\n```\nprojects/my-project/serviceAccounts/my-service-account@my-project.iam.gserviceaccount.com\n```\n\u5982\u679c\u60a8\u4e0d\u518d\u4f7f\u7528 [PHP \u7248 IAM \u5ba2\u6236\u7aef\u5eab](https://github.com/googleapis/google-api-php-client-services/tree/master/src/Iam) \uff0c\u53ef\u4ee5\u5c07\u5176\u5f9e\u61c9\u7528\u4e2d\u79fb\u9664\u3002\u5c07 [Python \u7248 Service Account Credentials \u5ba2\u6236\u7aef\u5eab](https://cloud.google.com/python/docs/reference/iam/latest/google.cloud.iam_credentials_v1.services.iam_credentials?hl=zh-cn) \u6dfb\u52a0\u5230\u60a8\u7684\u61c9\u7528\u3002\u4f7f\u7528 [sign_jwt() \u65b9\u6cd5](https://cloud.google.com/python/docs/reference/iam/latest/google.cloud.iam_credentials_v1.services.iam_credentials.IAMCredentialsAsyncClient?hl=zh-cn#google_cloud_iam_credentials_v1_services_iam_credentials_IAMCredentialsAsyncClient_sign_jwt) \u751f\u6210\u7c3d\u540d\u3002\n\u670d\u52d9\u8cec\u865f\u7684\u540d\u7a31\u5fc5\u9808\u4f7f\u7528\u901a\u914d\u7b26 `-` \u4f86\u8868\u793a\u9805\u76ee ID\uff1a\n \u6709\u6548 \uff1a\u63a1\u7528\u901a\u914d\u7b26\u7684\u540d\u7a31\n```\nprojects/-/serviceAccounts/my-service-account@my-project.iam.gserviceaccount.com\n```\n \u7121\u6548 \uff1a\u63a1\u7528\u9805\u76ee ID \u7684\u540d\u7a31\n```\nprojects/my-project/serviceAccounts/my-service-account@my-project.iam.gserviceaccount.com\n```\n\u5982\u679c\u60a8\u4e0d\u4f7f\u7528 [iam_credentials \u5ba2\u6236\u7aef\u5eab](https://cloud.google.com/python/docs/reference/iam/latest/google.cloud.iam_credentials_v1.services.iam_credentials?hl=zh-cn) \uff0c\u53ef\u4ee5\u5c07\u5176\u5f9e\u61c9\u7528\u4e2d\u79fb\u9664\u3002\u5c07 [Ruby \u7248 Service Account Credentials \u5ba2\u6236\u7aef\u5eab](https://github.com/googleapis/google-api-ruby-client/tree/master/generated/google-apis-iamcredentials_v1) \u6dfb\u52a0\u5230\u60a8\u7684\u61c9\u7528\u3002\u4f7f\u7528 [sign_service_account_jwt() \u65b9\u6cd5](https://github.com/googleapis/google-api-ruby-client/blob/master/generated/google-apis-iamcredentials_v1/lib/google/apis/iamcredentials_v1/service.rb) \u751f\u6210\u7c3d\u540d\u3002\n\u670d\u52d9\u8cec\u865f\u7684\u540d\u7a31\u5fc5\u9808\u4f7f\u7528\u901a\u914d\u7b26 `-` \u4f86\u8868\u793a\u9805\u76ee ID\uff1a\n \u6709\u6548 \uff1a\u63a1\u7528\u901a\u914d\u7b26\u7684\u540d\u7a31\n```\nprojects/-/serviceAccounts/my-service-account@my-project.iam.gserviceaccount.com\n```\n \u7121\u6548 \uff1a\u63a1\u7528\u9805\u76ee ID \u7684\u540d\u7a31\n```\nprojects/my-project/serviceAccounts/my-service-account@my-project.iam.gserviceaccount.com\n```\n\u5982\u679c\u60a8\u4e0d\u518d\u4f7f\u7528 [Ruby \u7248 IAM \u5ba2\u6236\u7aef\u5eab](https://github.com/googleapis/google-api-ruby-client/tree/master/generated/google-apis-iam_v1) \uff0c\u53ef\u4ee5\u5c07\u5176\u5f9e\u61c9\u7528\u4e2d\u79fb\u9664\u3002\n## \u9077\u79fb\u7528\u65bc\u7232\u4e8c\u9032\u5236 blob \u7c3d\u540d\u7684\u4ee3\u78bc\n\u672c\u90e8\u5206\u4ecb\u7d39\u77ad\u5982\u4f55\u5c07\u7528\u65bc\u7232\u4e8c\u9032\u5236 blob \u7c3d\u540d\u7684\u4ee3\u78bc\u9077\u79fb\u5230 Service Account Credentials API\u3002\n### \u4f7f\u7528 REST API \u7232\u4e8c\u9032\u5236 blob \u7c3d\u540d\n\u4e0b\u8868\u5c55\u793a\u4e86 [\u4f7f\u7528 IAM REST API \u7232\u4e8c\u9032\u5236 blob \u7c3d\u540d](https://cloud.google.com/iam/docs/reference/rest/v1/projects.serviceAccounts/signBlob?hl=zh-cn) \u8207 [\u4f7f\u7528 Service Account Credentials API \u7232\u4e8c\u9032\u5236 blob \u7c3d\u540d](https://cloud.google.com/iam/docs/reference/credentials/rest/v1/projects.serviceAccounts/signBlob?hl=zh-cn) \u4e4b\u9593\u7684\u5dee\u7570\u3002 \u8acb\u66f4\u65b0\u60a8\u7684\u4ee3\u78bc\u4ee5\u53cd\u6620\u9019\u4e9b\u5dee\u7570\uff1a\n| \u4e0d\u540c\u4e8c\u9032\u5236 blob \u7c3d\u540d\u65b9\u5f0f\u7684\u5dee\u7570 | \u4e0d\u540c\u4e8c\u9032\u5236 blob \u7c3d\u540d\u65b9\u5f0f\u7684\u5dee\u7570.1                                                                                                                                            |\n|:---------------------------------|:-------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|\n| HTTP \u7aef\u9ede      | IAM API IAM API \u4f7f\u7528\u4ee5\u4e0b HTTP \u65b9\u6cd5\u548c\u7aef\u9ede\uff1a POST https://iam.googleapis.com/v1/projects/project-id/serviceAccounts/sa-email:signBlob \u5728\u6b64\u7db2\u5740\u4e2d\uff0cproject-id \u662f\u9805\u76ee ID\uff0csa-email \u662f\u670d\u52d9\u8cec\u865f\u7684\u96fb\u5b50\u90f5\u4ef6\u5730\u5740\u3002 POST https://iam.googleapis.com/v1/projects/-/serviceAccounts/sa-email:signBlob \u5728\u6b64\u7db2\u5740\u4e2d\uff0c\u901a\u914d\u7b26 - \u66ff\u63db\u7684\u662f\u9805\u76ee ID\uff0csa-email \u662f\u670d\u52d9\u8cec\u865f\u7684\u96fb\u5b50\u90f5\u4ef6\u5730\u5740\u3002 Service Account Credentials API \u4f7f\u7528\u4ee5\u4e0b HTTP \u65b9\u6cd5\u548c\u7aef\u9ede\u3002\u8acb\u52ff\u5c07\u901a\u914d\u7b26\u66ff\u63db\u7232\u9805\u76ee ID\uff1a POST https://iamcredentials.googleapis.com/v1/projects/-/serviceAccounts/sa-email:signBlob \u5728\u6b64\u7db2\u5740\u4e2d\uff0csa-email \u662f\u670d\u52d9\u8cec\u865f\u7684\u96fb\u5b50\u90f5\u4ef6\u5730\u5740\u3002 |\n| \u8acb\u6c42\u6b63\u6587       | IAM API \u8acb\u6c42\u6b63\u6587\u4e2d\u5305\u542b\u4e00\u500b bytesToSign \u5b57\u6bb5\u3002\u5b83\u7684\u503c\u662f\u4e00\u500b base64 \u7de8\u78bc\u7684\u5b57\u7b26\u4e32\uff0c\u8868\u793a\u9700\u8981\u7c3d\u540d\u7684\u4e8c\u9032\u5236 blob\u3002 Service Account Credentials API \u8acb\u6c42\u6b63\u6587\u4e2d\u5305\u542b\u4e00\u500b payload \u5b57\u6bb5\uff0c\u5176\u503c\u8207 IAM API \u4e2d bytesToSign \u5b57\u6bb5\u7684\u503c\u76f8\u540c\u3002                                                                                              |\n| \u97ff\u61c9\u6b63\u6587       | IAM API \u97ff\u61c9\u6b63\u6587\u4e2d\u5305\u542b\u4e00\u500b keyId \u5b57\u6bb5\uff08\u6a19\u8b58\u7528\u65bc\u7232 blob \u7c3d\u540d\u7684\u5bc6\u9470\uff09\u548c\u4e00\u500b signature \u5b57\u6bb5\uff08\u5305\u542b\u8868\u793a\u7c3d\u540d\u7684 base64 \u7de8\u78bc\u7684\u5b57\u7b26\u4e32\uff09\u3002 Service Account Credentials API \u97ff\u61c9\u6b63\u6587\u4e2d\u5305\u542b\u4e00\u500b keyId \u5b57\u6bb5\uff08\u8207 IAM API \u4e2d\u7684 keyId \u5b57\u6bb5\u5b8c\u5168\u76f8\u540c\uff09\u548c\u4e00\u500b signedBlob \u5b57\u6bb5\uff08\u8207 IAM API \u4e2d\u7684 signature \u5b57\u6bb5\u5b8c\u5168\u76f8\u540c\uff09\u3002 \u6ce8\u610f\uff1asignedBlob \u5b57\u6bb5\u50c5\u5305\u542b\u7c3d\u540d\uff0c\u4e0d\u5305\u542b\u539f\u59cb blob\u3002                                                             |\n### \u4f7f\u7528\u5ba2\u6236\u7aef\u5eab\u7232\u4e8c\u9032\u5236 blob \u7c3d\u540d\nService Account Credentials API \u7684\u5ba2\u6236\u7aef\u5eab\u8207 IAM API \u7684\u5ba2\u6236\u7aef\u5eab\u662f\u76f8\u4e92\u7368\u7acb\u7684\u3002\n\u5982\u9700\u4f7f\u7528 Service Account Credentials API\uff0c\u8acb\u5c07\u5176\u5ba2\u6236\u7aef\u5eab\u6dfb\u52a0\u5230\u60a8\u7684\u61c9\u7528\uff0c\u7136\u5f8c\u66f4\u65b0\u60a8\u7684\u4ee3\u78bc\u4ee5\u4f7f\u7528\u65b0\u7684\u5ba2\u6236\u7aef\u5eab\uff1a\n**\u5982\u679c\u60a8\u4f7f\u7528 Cloud Storage C++ \u5ba2\u6236\u7aef\u5eab\u7232 blob \u7c3d\u540d** \uff08\u76f4\u63a5\u4f7f\u7528\u6216\u7528\u4f5c\u5176\u4ed6\u5ba2\u6236\u7aef\u5eab\u7684\u4f9d\u8cf4\u9805\uff09\uff1a\n\u8acb\u5347\u7d1a\u5230 [google-cloud-cpp](https://github.com/googleapis/google-cloud-cpp/tree/master/google/cloud/storage) 0.9.0 \u7248\u6216\u66f4\u9ad8\u7248\u672c\u3002\n **\u5982\u679c\u60a8\u4f7f\u7528\u5176\u4ed6\u5ba2\u6236\u7aef\u5eab\u7232 blob \u7c3d\u540d** \uff1a\n\u8acb\u8207 [iam-sign-deprecation-public@google.com](mailto:iam-sign-deprecation-public@google.com) \u806f\u7e6b\u4ee5\u5c0b\u6c42\u652f\u6301\u3002 **\u5982\u679c\u60a8\u4f7f\u7528 C# \u7248 IAM \u5ba2\u6236\u7aef\u5eab** \uff08\u76f4\u63a5\u4f7f\u7528\u6216\u7528\u4f5c\u5176\u4ed6\u5ba2\u6236\u7aef\u5eab\u7684\u4f9d\u8cf4\u9805\uff09\uff1a\n\u5c07 [C# \u7248 Service Account Credentials \u5ba2\u6236\u7aef\u5eab](https://developers.google.com/api-client-library/dotnet/apis/iamcredentials/v1/?hl=zh-cn) \u6dfb\u52a0\u5230\u60a8\u7684\u61c9\u7528\u3002\u4f7f\u7528 [SignBlob() \u65b9\u6cd5](https://googleapis.dev/dotnet/Google.Apis.IAMCredentials.v1/latest/api/Google.Apis.IAMCredentials.v1.ProjectsResource.ServiceAccountsResource.html) \u751f\u6210\u7c3d\u540d\u3002\n\u670d\u52d9\u8cec\u865f\u7684\u540d\u7a31\u5fc5\u9808\u4f7f\u7528\u901a\u914d\u7b26 `-` \u4f86\u8868\u793a\u9805\u76ee ID\uff1a\n \u6709\u6548 \uff1a\u63a1\u7528\u901a\u914d\u7b26\u7684\u540d\u7a31\n```\nprojects/-/serviceAccounts/my-service-account@my-project.iam.gserviceaccount.com\n```\n \u7121\u6548 \uff1a\u63a1\u7528\u9805\u76ee ID \u7684\u540d\u7a31\n```\nprojects/my-project/serviceAccounts/my-service-account@my-project.iam.gserviceaccount.com\n```\n\u5982\u679c\u60a8\u4e0d\u518d\u4f7f\u7528 [C# \u7248 IAM \u5ba2\u6236\u7aef\u5eab](https://developers.google.com/api-client-library/dotnet/apis/iam/v1/?hl=zh-cn) \uff0c\u53ef\u4ee5\u5c07\u5176\u5f9e\u61c9\u7528\u4e2d\u79fb\u9664\u3002\n **\u5982\u679c\u60a8\u4f7f\u7528 Firebase Admin DotNet SDK** \uff08\u76f4\u63a5\u4f7f\u7528\u6216\u7528\u4f5c\u5176\u4ed6\u5ba2\u6236\u7aef\u5eab\u7684\u4f9d\u8cf4\u9805\uff09\uff1a\n\u8acb\u5347\u7d1a\u5230 [firebase-admin-dotnet](https://github.com/firebase/firebase-admin-dotnet) 1.17.1 \u7248\u6216\u66f4\u9ad8\u7248\u672c\u3002\n **\u5982\u679c\u60a8\u4f7f\u7528\u5176\u4ed6\u5ba2\u6236\u7aef\u5eab\u7232 blob \u7c3d\u540d** \uff1a\n\u8acb\u8207 [iam-sign-deprecation-public@google.com](mailto:iam-sign-deprecation-public@google.com) \u806f\u7e6b\u4ee5\u5c0b\u6c42\u652f\u6301\u3002 **\u5982\u679c\u60a8\u4f7f\u7528 Go \u7248 IAM \u5ba2\u6236\u7aef\u5eab** \uff08\u76f4\u63a5\u4f7f\u7528\u6216\u7528\u4f5c\u5176\u4ed6\u5ba2\u6236\u7aef\u5eab\u7684\u4f9d\u8cf4\u9805\uff09\uff1a\n\u5c07 [Go \u7248 Service Account Credentials \u5ba2\u6236\u7aef\u5eab](https://pkg.go.dev/cloud.google.com/go/iam/credentials/apiv1?tab=doc) \u6dfb\u52a0\u5230\u60a8\u7684\u61c9\u7528\u3002\u4f7f\u7528 [IamCredentialsClient.SignBlob() function](https://pkg.go.dev/cloud.google.com/go/iam/credentials/apiv1?tab=doc#IamCredentialsClient.SignBlob) \u751f\u6210\u7c3d\u540d\u3002\n\u670d\u52d9\u8cec\u865f\u7684\u540d\u7a31\u5fc5\u9808\u4f7f\u7528\u901a\u914d\u7b26 `-` \u4f86\u8868\u793a\u9805\u76ee ID\uff1a\n \u6709\u6548 \uff1a\u63a1\u7528\u901a\u914d\u7b26\u7684\u540d\u7a31\n```\nprojects/-/serviceAccounts/my-service-account@my-project.iam.gserviceaccount.com\n```\n \u7121\u6548 \uff1a\u63a1\u7528\u9805\u76ee ID \u7684\u540d\u7a31\n```\nprojects/my-project/serviceAccounts/my-service-account@my-project.iam.gserviceaccount.com\n```\n\u5982\u679c\u60a8\u4e0d\u518d\u4f7f\u7528 [Go \u7248 IAM \u5ba2\u6236\u7aef\u5eab](https://pkg.go.dev/google.golang.org/api/iam/v1?tab=doc) \uff0c\u53ef\u4ee5\u5c07\u5176\u5f9e\u61c9\u7528\u4e2d\u79fb\u9664\u3002\n **\u5982\u679c\u60a8\u4f7f\u7528 Firebase Admin Go SDK** \uff08\u76f4\u63a5\u4f7f\u7528\u6216\u7528\u4f5c\u5176\u4ed6\u5ba2\u6236\u7aef\u5eab\u7684\u4f9d\u8cf4\u9805\uff09\uff1a\n\u8acb\u5347\u7d1a\u5230 [firebase-admin-go](https://github.com/firebase/firebase-admin-go) 4.1.0 \u7248\u6216\u66f4\u9ad8\u7248\u672c\u3002\n **\u5982\u679c\u60a8\u4f7f\u7528\u5176\u4ed6\u5ba2\u6236\u7aef\u5eab\u7232 blob \u7c3d\u540d** \uff1a\n\u8acb\u8207 [iam-sign-deprecation-public@google.com](mailto:iam-sign-deprecation-public@google.com) \u806f\u7e6b\u4ee5\u5c0b\u6c42\u652f\u6301\u3002 **\u5982\u679c\u60a8\u4f7f\u7528 Java \u7248 IAM \u5ba2\u6236\u7aef\u5eab** \uff08\u76f4\u63a5\u4f7f\u7528\u6216\u7528\u4f5c\u5176\u4ed6\u5ba2\u6236\u7aef\u5eab\u7684\u4f9d\u8cf4\u9805\uff09\uff1a\n\u5c07 [Java \u7248 Service Account Credentials \u5ba2\u6236\u7aef\u5eab](https://github.com/googleapis/java-iamcredentials) \u6dfb\u52a0\u5230\u60a8\u7684\u61c9\u7528\u3002\u4f7f\u7528 [IamCredentialsClient#signBlob() \u65b9\u6cd5](https://cloud.google.com/java/docs/reference/google-cloud-iamcredentials/latest/com.google.cloud.iam.credentials.v1.IamCredentialsClient?hl=zh-cn#com_google_cloud_iam_credentials_v1_IamCredentialsClient_signBlob_java_lang_String_java_util_List_java_lang_String__com_google_protobuf_ByteString_) \u751f\u6210\u7c3d\u540d\u3002\n\u670d\u52d9\u8cec\u865f\u7684\u540d\u7a31\u5fc5\u9808\u4f7f\u7528\u901a\u914d\u7b26 `-` \u4f86\u8868\u793a\u9805\u76ee ID\uff1a\n \u6709\u6548 \uff1a\u63a1\u7528\u901a\u914d\u7b26\u7684\u540d\u7a31\n```\nprojects/-/serviceAccounts/my-service-account@my-project.iam.gserviceaccount.com\n```\n \u7121\u6548 \uff1a\u63a1\u7528\u9805\u76ee ID \u7684\u540d\u7a31\n```\nprojects/my-project/serviceAccounts/my-service-account@my-project.iam.gserviceaccount.com\n```\n\u5982\u679c\u60a8\u4e0d\u518d\u4f7f\u7528 [Java \u7248 IAM \u5ba2\u6236\u7aef\u5eab](https://github.com/googleapis/google-api-java-client-services/tree/master/clients/google-api-services-iam/v1) \uff0c\u53ef\u4ee5\u5c07\u5176\u5f9e\u61c9\u7528\u4e2d\u79fb\u9664\u3002\n **\u5982\u679c\u60a8\u4f7f\u7528 Java \u7248 Google \u8eab\u4efd\u9a57\u8b49\u5eab** \uff08\u76f4\u63a5\u4f7f\u7528\u6216\u7528\u4f5c\u5176\u4ed6\u5ba2\u6236\u7aef\u5eab\u7684\u4f9d\u8cf4\u9805\uff09\uff1a\n\u8acb\u5347\u7d1a\u5230 [google-auth-library-java](https://github.com/googleapis/google-auth-library-java) 0.14.0 \u7248\u6216\u66f4\u9ad8\u7248\u672c\u3002\n **\u5982\u679c\u60a8\u4f7f\u7528 Firebase Admin Java SDK** \uff08\u76f4\u63a5\u4f7f\u7528\u6216\u7528\u4f5c\u5176\u4ed6\u5ba2\u6236\u7aef\u5eab\u7684\u4f9d\u8cf4\u9805\uff09\uff1a\n\u8acb\u5347\u7d1a\u5230 [firebase-admin-java](https://github.com/firebase/firebase-admin-java) 7.0.1 \u7248\u6216\u66f4\u9ad8\u7248\u672c\u3002\n **\u5982\u679c\u60a8\u4f7f\u7528\u5176\u4ed6\u5ba2\u6236\u7aef\u5eab\u7232 blob \u7c3d\u540d** \uff1a\n\u8acb\u8207 [iam-sign-deprecation-public@google.com](mailto:iam-sign-deprecation-public@google.com) \u806f\u7e6b\u4ee5\u5c0b\u6c42\u652f\u6301\u3002 **\u5982\u679c\u60a8\u4f7f\u7528 Node.js \u7248 IAM \u5ba2\u6236\u7aef\u5eab** \uff08\u76f4\u63a5\u4f7f\u7528\u6216\u7528\u4f5c\u5176\u4ed6\u5ba2\u6236\u7aef\u5eab\u7684\u4f9d\u8cf4\u9805\uff09\uff1a\n\u5c07 [Node.js \u7248 Service Account Credentials \u5ba2\u6236\u7aef\u5eab](https://github.com/googleapis/google-api-nodejs-client/tree/master/src/apis/iamcredentials) \u6dfb\u52a0\u5230\u60a8\u7684\u61c9\u7528\u3002\u4f7f\u7528 [signBlob() \u65b9\u6cd5](https://googleapis.dev/nodejs/googleapis/latest/iamcredentials/classes/Resource$Projects$Serviceaccounts.html#signBlob) \u751f\u6210\u7c3d\u540d\u3002\n\u670d\u52d9\u8cec\u865f\u7684\u540d\u7a31\u5fc5\u9808\u4f7f\u7528\u901a\u914d\u7b26 `-` \u4f86\u8868\u793a\u9805\u76ee ID\uff1a\n \u6709\u6548 \uff1a\u63a1\u7528\u901a\u914d\u7b26\u7684\u540d\u7a31\n```\nprojects/-/serviceAccounts/my-service-account@my-project.iam.gserviceaccount.com\n```\n \u7121\u6548 \uff1a\u63a1\u7528\u9805\u76ee ID \u7684\u540d\u7a31\n```\nprojects/my-project/serviceAccounts/my-service-account@my-project.iam.gserviceaccount.com\n```\n\u5982\u679c\u60a8\u4e0d\u518d\u4f7f\u7528 [Node.js \u7248 IAM \u5ba2\u6236\u7aef\u5eab](https://github.com/googleapis/google-api-nodejs-client/tree/master/src/apis/iam) \uff0c\u53ef\u4ee5\u5c07\u5176\u5f9e\u61c9\u7528\u4e2d\u79fb\u9664\u3002\n **\u5982\u679c\u60a8\u4f7f\u7528 Node.js \u7248 Google \u8eab\u4efd\u9a57\u8b49\u5eab** \uff08\u76f4\u63a5\u4f7f\u7528\u6216\u7528\u4f5c\u5176\u4ed6\u5ba2\u6236\u7aef\u5eab\u7684\u4f9d\u8cf4\u9805\uff09\uff1a\n\u8acb\u5347\u7d1a\u5230 [google-auth-library-nodejs](https://github.com/googleapis/google-auth-library-nodejs) 6.0.0 \u7248\u6216\u66f4\u9ad8\u7248\u672c\u3002\n **\u5982\u679c\u60a8\u4f7f\u7528 Firebase Admin Node.js SDK** \uff08\u76f4\u63a5\u4f7f\u7528\u6216\u7528\u4f5c\u5176\u4ed6\u5ba2\u6236\u7aef\u5eab\u7684\u4f9d\u8cf4\u9805\uff09\uff1a\n\u8acb\u5347\u7d1a\u5230 [firebase-admin-node](https://github.com/firebase/firebase-admin-node) 8.13.0 \u7248\u6216\u66f4\u9ad8\u7248\u672c\u3002\n **\u5982\u679c\u60a8\u4f7f\u7528\u5176\u4ed6\u5ba2\u6236\u7aef\u5eab\u7232 blob \u7c3d\u540d** \uff1a\n\u8acb\u8207 [iam-sign-deprecation-public@google.com](mailto:iam-sign-deprecation-public@google.com) \u806f\u7e6b\u4ee5\u5c0b\u6c42\u652f\u6301\u3002 **\u5982\u679c\u60a8\u4f7f\u7528 PHP \u7248 IAM \u5ba2\u6236\u7aef\u5eab** \uff08\u76f4\u63a5\u4f7f\u7528\u6216\u7528\u4f5c\u5176\u4ed6\u5ba2\u6236\u7aef\u5eab\u7684\u4f9d\u8cf4\u9805\uff09\uff1a\n\u5c07 [PHP \u7248 Service Account Credentials \u5ba2\u6236\u7aef\u5eab](https://github.com/googleapis/google-api-php-client-services/tree/master/src/IAMCredentials) \u6dfb\u52a0\u5230\u60a8\u7684\u61c9\u7528\u3002\u4f7f\u7528 [signBlob() \u65b9\u6cd5](https://github.com/googleapis/google-api-php-client-services/blob/master/src/IAMCredentials/Resource/ProjectsServiceAccounts.php) \u751f\u6210\u7c3d\u540d\u3002\n\u670d\u52d9\u8cec\u865f\u7684\u540d\u7a31\u5fc5\u9808\u4f7f\u7528\u901a\u914d\u7b26 `-` \u4f86\u8868\u793a\u9805\u76ee ID\uff1a\n \u6709\u6548 \uff1a\u63a1\u7528\u901a\u914d\u7b26\u7684\u540d\u7a31\n```\nprojects/-/serviceAccounts/my-service-account@my-project.iam.gserviceaccount.com\n```\n \u7121\u6548 \uff1a\u63a1\u7528\u9805\u76ee ID \u7684\u540d\u7a31\n```\nprojects/my-project/serviceAccounts/my-service-account@my-project.iam.gserviceaccount.com\n```\n\u5982\u679c\u60a8\u4e0d\u518d\u4f7f\u7528 [PHP \u7248 IAM \u5ba2\u6236\u7aef\u5eab](https://github.com/googleapis/google-api-php-client-services/tree/master/src/Iam) \uff0c\u53ef\u4ee5\u5c07\u5176\u5f9e\u61c9\u7528\u4e2d\u79fb\u9664\u3002\n **\u5982\u679c\u60a8\u4f7f\u7528 PHP \u7248 Google \u8eab\u4efd\u9a57\u8b49\u5eab** \uff08\u76f4\u63a5\u4f7f\u7528\u6216\u7528\u4f5c\u5176\u4ed6\u5ba2\u6236\u7aef\u5eab\u7684\u4f9d\u8cf4\u9805\uff09\uff1a\n\u8acb\u5347\u7d1a\u5230 [google-auth-library-php](https://github.com/googleapis/google-auth-library-php) 1.5.0 \u7248\u6216\u66f4\u9ad8\u7248\u672c\u3002\n **\u5982\u679c\u60a8\u4f7f\u7528\u5176\u4ed6\u5ba2\u6236\u7aef\u5eab\u7232 blob \u7c3d\u540d** \uff1a\n\u8acb\u8207 [iam-sign-deprecation-public@google.com](mailto:iam-sign-deprecation-public@google.com) \u806f\u7e6b\u4ee5\u5c0b\u6c42\u652f\u6301\u3002 **\u5982\u679c\u60a8\u4f7f\u7528 Python \u7248 IAM \u5ba2\u6236\u7aef\u5eab** \uff08\u76f4\u63a5\u4f7f\u7528\u6216\u7528\u4f5c\u5176\u4ed6\u5ba2\u6236\u7aef\u5eab\u7684\u4f9d\u8cf4\u9805\uff09\uff1a\n\u5c07 [Python \u7248 Service Account Credentials \u5ba2\u6236\u7aef\u5eab](https://cloud.google.com/python/docs/reference/iam/latest/google.cloud.iam_credentials_v1.services.iam_credentials?hl=zh-cn) \u6dfb\u52a0\u5230\u60a8\u7684\u61c9\u7528\u3002\u4f7f\u7528 [sign_blob() \u65b9\u6cd5](https://cloud.google.com/python/docs/reference/iam/latest/google.cloud.iam_credentials_v1.services.iam_credentials.IAMCredentialsAsyncClient?hl=zh-cn#google_cloud_iam_credentials_v1_services_iam_credentials_IAMCredentialsAsyncClient_sign_blob) \u751f\u6210\u7c3d\u540d\u3002\n\u670d\u52d9\u8cec\u865f\u7684\u540d\u7a31\u5fc5\u9808\u4f7f\u7528\u901a\u914d\u7b26 `-` \u4f86\u8868\u793a\u9805\u76ee ID\uff1a\n \u6709\u6548 \uff1a\u63a1\u7528\u901a\u914d\u7b26\u7684\u540d\u7a31\n```\nprojects/-/serviceAccounts/my-service-account@my-project.iam.gserviceaccount.com\n```\n \u7121\u6548 \uff1a\u63a1\u7528\u9805\u76ee ID \u7684\u540d\u7a31\n```\nprojects/my-project/serviceAccounts/my-service-account@my-project.iam.gserviceaccount.com\n```\n\u5982\u679c\u60a8\u4e0d\u4f7f\u7528 [iam_credentials \u5ba2\u6236\u7aef\u5eab](https://cloud.google.com/python/docs/reference/iam/latest/google.cloud.iam_credentials_v1.services.iam_credentials?hl=zh-cn) \uff0c\u53ef\u4ee5\u5c07\u5176\u5f9e\u61c9\u7528\u4e2d\u79fb\u9664\u3002\n **\u5982\u679c\u60a8\u4f7f\u7528 Python \u7248 Google \u8eab\u4efd\u9a57\u8b49\u5eab** \uff08\u76f4\u63a5\u4f7f\u7528\u6216\u7528\u4f5c\u5176\u4ed6\u5ba2\u6236\u7aef\u5eab\u7684\u4f9d\u8cf4\u9805\uff09\uff1a\n\u8acb\u5347\u7d1a\u5230 [google-auth-library-python](https://github.com/googleapis/google-auth-library-python) 1.21.2 \u7248\u6216\u66f4\u9ad8\u7248\u672c\u3002\n **\u5982\u679c\u60a8\u4f7f\u7528\u9069\u7528\u65bc Cloud Storage \u7684 Python \u5ba2\u6236\u7aef** \uff08\u76f4\u63a5\u4f7f\u7528\u6216\u7528\u4f5c\u5176\u4ed6\u5ba2\u6236\u7aef\u5eab\u7684\u4f9d\u8cf4\u9805\uff09\uff1a\n\u8acb\u5347\u7d1a\u5230 [python-storage](https://github.com/googleapis/python-storage) 1.30.0 \u7248\u6216\u66f4\u9ad8\u7248\u672c\u3002\n **\u5982\u679c\u60a8\u4f7f\u7528\u5176\u4ed6\u5ba2\u6236\u7aef\u5eab\u7232 blob \u7c3d\u540d** \uff1a\n\u8acb\u8207 [iam-sign-deprecation-public@google.com](mailto:iam-sign-deprecation-public@google.com) \u806f\u7e6b\u4ee5\u5c0b\u6c42\u652f\u6301\u3002 **\u5982\u679c\u60a8\u4f7f\u7528 Ruby \u7248 IAM \u5ba2\u6236\u7aef\u5eab** \uff08\u76f4\u63a5\u4f7f\u7528\u6216\u7528\u4f5c\u5176\u4ed6\u5ba2\u6236\u7aef\u5eab\u7684\u4f9d\u8cf4\u9805\uff09\uff1a\n\u5c07 [Ruby \u7248 Service Account Credentials \u5ba2\u6236\u7aef\u5eab](https://github.com/googleapis/google-api-ruby-client/tree/master/generated/google-apis-iamcredentials_v1) \u6dfb\u52a0\u5230\u60a8\u7684\u61c9\u7528\u3002\u4f7f\u7528 [sign_service_account_blob() \u65b9\u6cd5](https://github.com/googleapis/google-api-ruby-client/blob/master/generated/google-apis-iamcredentials_v1/lib/google/apis/iamcredentials_v1/service.rb) \u751f\u6210\u7c3d\u540d\u3002\n\u670d\u52d9\u8cec\u865f\u7684\u540d\u7a31\u5fc5\u9808\u4f7f\u7528\u901a\u914d\u7b26 `-` \u4f86\u8868\u793a\u9805\u76ee ID\uff1a\n \u6709\u6548 \uff1a\u63a1\u7528\u901a\u914d\u7b26\u7684\u540d\u7a31\n```\nprojects/-/serviceAccounts/my-service-account@my-project.iam.gserviceaccount.com\n```\n \u7121\u6548 \uff1a\u63a1\u7528\u9805\u76ee ID \u7684\u540d\u7a31\n```\nprojects/my-project/serviceAccounts/my-service-account@my-project.iam.gserviceaccount.com\n```\n\u5982\u679c\u60a8\u4e0d\u518d\u4f7f\u7528 [Ruby \u7248 IAM \u5ba2\u6236\u7aef\u5eab](https://github.com/googleapis/google-api-ruby-client/tree/master/generated/google-apis-iam_v1) \uff0c\u53ef\u4ee5\u5c07\u5176\u5f9e\u61c9\u7528\u4e2d\u79fb\u9664\u3002\n **\u5982\u679c\u60a8\u4f7f\u7528\u5176\u4ed6\u5ba2\u6236\u7aef\u5eab\u7232 blob \u7c3d\u540d** \uff1a\n\u8acb\u8207 [iam-sign-deprecation-public@google.com](mailto:iam-sign-deprecation-public@google.com) \u806f\u7e6b\u4ee5\u5c0b\u6c42\u652f\u6301\u3002\n## \u9077\u79fb\u4f7f\u7528 gcloud CLI \u7684\u4ee3\u78bc\nGoogle Cloud CLI \u63d0\u4f9b\u4e86\u4f7f\u7528 IAM API \u7232 JWT \u548c\u4e8c\u9032\u5236 blob \u7c3d\u540d\u7684\u547d\u4ee4\uff0c\u5305\u62ec\uff1a\n- [gcloud beta iam service-accounts sign-jwt](https://cloud.google.com/sdk/gcloud/reference/beta/iam/service-accounts/sign-jwt?hl=zh-cn) \n- [gcloud iam service-accounts sign-blob](https://cloud.google.com/sdk/gcloud/reference/iam/service-accounts/sign-blob?hl=zh-cn) \n\u6211\u5011\u5c07\u65bc 2021 \u5e74 7 \u6708 1 \u65e5\u7576\u5929\u6216\u4e4b\u5f8c\u66f4\u65b0\u9019\u4e9b\u547d\u4ee4\uff0c\u4f7f\u5176\u4f7f\u7528 Service Account Credentials API\u3002\u6b64\u9805\u66f4\u6539\u4e0d\u6703\u5f71\u97ff\u7528\u65bc\u7232 blob \u7c3d\u540d\u7684\u547d\u4ee4\u3002\n**\u5982\u679c\u60a8\u4f7f\u7528 gcloud CLI \u4f86\u7232 JWT \u7c3d\u540d\uff0c\u5247\u5fc5\u9808\u5728 2021 \u5e74 7 \u6708 1 \u65e5\u4e4b\u524d\u57f7\u884c\u4ee5\u4e0b\u6b65\u9a5f\uff1a**\n- \u6aa2\u67e5\u60a8\u662f\u5426\u5728 JWT \u8072\u660e\u96c6\u4e2d\u6dfb\u52a0\u4e86\u5230\u671f\u6642\u9593 ( `exp` ) \u8072\u660e\u3002\u5982\u679c\u60a8\u5df2\u6dfb\u52a0\u8a72\u8072\u660e\uff0c\u5247\u7121\u9700\u9032\u884c\u4efb\u4f55\u66f4\u6539\u3002\u60a8\u53ef\u4ee5\u8df3\u904e\u5176\u9918\u6b65\u9a5f\u3002\u5982\u679c\u60a8\u672a\u6dfb\u52a0\u8a72\u8072\u660e\uff0c\u8acb\u7e7c\u7e8c\u57f7\u884c\u4e0b\u4e00\u6b65\u3002\n- \u6aa2\u67e5\u60a8\u662f\u5426\u4f7f\u7528\u5df2\u7c3d\u540d\u7684 JWT \u5411 Google API \u6216\u9700\u8981 `exp` \u8072\u660e\u7684\u5176\u4ed6 API \u9032\u884c\u8eab\u4efd\u9a57\u8b49\u3002\u5982\u679c\u60a8\u7701\u7565\u8a72\u8072\u660e\uff0cIAM API \u6703\u81ea\u52d5\u5c07\u5176\u8a2d\u7f6e\u7232\u672a\u4f86 1 \u5c0f\u6642\u3002\u76f8\u53cd\uff0cService Account Credentials API \u4e0d\u6703\u81ea\u52d5\u8a2d\u7f6e\u6b64\u5b57\u6bb5\u3002\u5982\u679c\u60a8\u78ba\u5b9a\u4e0d\u9700\u8981 `exp` \u8072\u660e\uff0c\u5247\u7121\u9700\u9032\u884c\u4efb\u4f55\u66f4\u6539\u3002\u60a8\u53ef\u4ee5\u8df3\u904e\u5176\u9918\u6b65\u9a5f\u3002\u5982\u679c\u60a8\u77e5\u9053\u81ea\u5df1\u9700\u8981 `exp` \u8072\u660e\uff0c\u6216\u4e0d\u78ba\u5b9a\u662f\u5426\u9700\u8981\uff0c\u8acb\u7e7c\u7e8c\u57f7\u884c\u4e0b\u4e00\u6b65\u3002\n- \u66f4\u65b0\u7528\u65bc\u5275\u5efa JWT \u7684\u4ee3\u78bc\uff0c\u4ee5\u4fbf\u5b83\u5c07 `exp` \u8072\u660e\u6dfb\u52a0\u5230 JWT \u8072\u660e\u96c6\u4e2d\u3002`exp` \u8072\u660e\u6700\u9577\u53ef\u4ee5\u8a2d\u7f6e\u7232\u672a\u4f86\u7684 1 \u5c0f\u6642\u3002## \u67e5\u770b\u914d\u984d\nService Account Credentials API \u7684\u914d\u984d\u7368\u7acb\u65bc IAM API \u7684\u914d\u984d\u3002\u5982\u679c\u60a8\u7372\u5f97\u4e86\u66f4\u591a\u7684\u914d\u984d\u4f86\u4f7f\u7528 IAM API \u7232 JWT \u548c blob \u7c3d\u540d\uff0c\u60a8\u53ef\u80fd\u4e5f\u9700\u8981\u7232 Service Account Credentials API \u7533\u8acb\u589e\u52a0\u914d\u984d\u3002\n**\u6ce8\u610f** \uff1a\u5927\u591a\u6578 Google Cloud \u5ba2\u6236\u4f7f\u7528\u9ed8\u8a8d\u914d\u984d\u4f86\u7232 JWT \u548c blob \u7c3d\u540d\u3002\u5982\u679c\u60a8\u4f7f\u7528\u7684\u662f\u9ed8\u8a8d\u914d\u984d\uff0c\u5247\u7121\u9700\u95b1\u8b80\u6b64\u90e8\u5206\u3002\n\u5c0d\u65bc\u9019\u5169\u500b API\uff0c\u5982\u9700\u67e5\u770b\u60a8\u7684\u914d\u984d\u548c\u5be6\u969b\u4f7f\u7528\u91cf\uff0c\u4e26\u5728\u5fc5\u8981\u6642\u7533\u8acb\u589e\u52a0\u914d\u984d\uff0c\u8acb\u57f7\u884c\u4ee5\u4e0b\u64cd\u4f5c\uff1a\n- \u5728 Google Cloud \u63a7\u5236\u6aaf\u4e2d\uff0c\u8f49\u5230 **\u914d\u984d** \u9801\u9762\u3002 [\u8f49\u5230\u201c\u914d\u984d\u201d\u9801\u9762](https://console.cloud.google.com/projectselector/iam-admin/quotas?hl=zh-cn) \n- \u9078\u64c7\u4e00\u500b\u9805\u76ee\u3002\u60a8\u53ef\u4ee5\u9ede\u64ca\u8fd1\u671f\u7684\u9805\u76ee\uff0c\u4e5f\u53ef\u4ee5\u9ede\u64ca **\u9078\u64c7\u9805\u76ee** \u4ee5\u641c\u7d22\u6240\u6709\u9805\u76ee\u3002\n- \u5728\u8868\u683c\u4e0a\u65b9\u7684 **\u904e\u6ffe\u8868** \u6587\u672c\u6846\u4e2d\uff0c\u8f38\u5165 `Sign requests per minute` \uff0c\u7136\u5f8c\u9078\u64c7\u986f\u793a\u7684\u503c\u3002\n- \u5728 **\u904e\u6ffe\u8868** \u6587\u672c\u6846\u4e2d\uff0c\u5f9e\u4e0b\u62c9\u5217\u8868\u4e2d\u9078\u64c7 **\u6216** \u3002\n- \u5728 **\u904e\u6ffe\u8868** \u6587\u672c\u6846\u4e2d\uff0c\u8f38\u5165 `Generate credentials` \uff0c\u7136\u5f8c\u9078\u64c7\u986f\u793a\u7684\u503c\u3002Google Cloud \u63a7\u5236\u6aaf\u6703\u986f\u793a\u904e\u53bb\u4e00\u5206\u9418\u5167\u7232 JWT \u548c blob \u7c3d\u540d\u7684 API \u7684\u7576\u524d\u4f7f\u7528\u91cf\uff1b\u904e\u53bb 7 \u5929\u6bcf\u5206\u9418\u7684\u5cef\u503c\u4f7f\u7528\u91cf\uff1b\u4ee5\u53ca\u60a8\u7684\u7576\u524d\u914d\u984d\uff08\u986f\u793a\u5728 **\u4e0a\u9650** \u5217\u4e2d\uff09\u3002\n- \u6bd4\u8f03\u8868\u4e2d\u6bcf\u4e00\u884c\u7684\u914d\u984d\uff0c\u4e26\u78ba\u4fdd\u60a8\u7684 Service Account Credentials API \u7684\u914d\u984d\u9ad8\u65bc IAM API 7 \u5929\u7684\u5cef\u503c\u4f7f\u7528\u91cf\u3002\n- \u53ef\u9078\uff1a\u5982\u679c\u60a8\u7684 Service Account Credentials API \u7684\u914d\u984d\u904e\u4f4e\uff0c\u8acb\u9078\u4e2d Service Account Credentials API \u5c0d\u61c9\u7684\u8907\u9078\u6846\uff0c\u7136\u5f8c\u9ede\u64ca **\u4fee\u6539\u914d\u984d** \u3002\u586b\u5beb\u8868\u55ae\u4ee5\u7533\u8acb\u589e\u52a0\u914d\u984d\u3002\n- \u8acb\u5c0d\u60a8\u4f7f\u7528 IAM API \u7232 JWT \u548c blob \u7c3d\u540d\u7684\u6bcf\u500b\u9805\u76ee\uff0c\u91cd\u8907\u4e0a\u8ff0\u6b65\u9a5f\u3002## \u5f8c\u7e8c\u6b65\u9a5f\n- \u77ad\u89e3\u5982\u4f55\u4f7f\u7528 Service Account Credentials REST API [\u5275\u5efa\u5df2\u7c3d\u540d\u7684 JWT](https://cloud.google.com/iam/docs/creating-short-lived-service-account-credentials?hl=zh-cn#sa-credentials-jwt) \u6216 [\u5275\u5efa\u5df2\u7c3d\u540d\u7684\u4e8c\u9032\u5236 blob](https://cloud.google.com/iam/docs/creating-short-lived-service-account-credentials?hl=zh-cn#sa-credentials-blob) \u3002\n- \u8a73\u7d30\u77ad\u89e3 [\u7528\u65bc Service Account Credentials API \u7684 REST API](https://cloud.google.com/iam/docs/reference/credentials/rest?hl=zh-cn) \u3002\n- \u77ad\u89e3 [IAM \u7684\u914d\u984d\u548c\u9650\u5236](https://cloud.google.com/iam/quotas?hl=zh-cn) \u3002", "guide": "IAM"}