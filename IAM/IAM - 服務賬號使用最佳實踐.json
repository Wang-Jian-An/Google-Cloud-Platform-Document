{"title": "IAM - \u670d\u52d9\u8cec\u865f\u4f7f\u7528\u6700\u4f73\u5be6\u8e10", "url": "https://cloud.google.com/iam/docs/best-practices-service-accounts?hl=zh-cn", "abstract": "# IAM - \u670d\u52d9\u8cec\u865f\u4f7f\u7528\u6700\u4f73\u5be6\u8e10\n\u670d\u52d9\u8cec\u865f\u4ee3\u8868\u975e\u4eba\u985e\u7528\u6236\u3002\u5b83\u5011\u65e8\u5728\u7528\u65bc\u5de5\u4f5c\u8ca0\u8f09\uff08\u4f8b\u5982\u81ea\u5b9a\u7fa9\u61c9\u7528\uff09\u5728\u6c92\u6709\u6700\u7d42\u7528\u6236\u53c3\u8207\u7684\u60c5\u6cc1\u4e0b\u8a2a\u554f\u8cc7\u6e90\u6216\u57f7\u884c\u64cd\u4f5c\u7684\u5834\u666f\u3002\n\u670d\u52d9\u8cec\u865f\u8207\u666e\u901a\u7528\u6236\u8cec\u865f\u5b58\u5728\u4ee5\u4e0b\u5340\u5225\uff1a\n- \u670d\u52d9\u8cec\u865f\u6c92\u6709\u5bc6\u78bc\uff0c\u4e0d\u80fd\u7528\u65bc\u57fa\u65bc\u700f\u89bd\u5668\u7684\u767b\u9304\u3002\n- \u670d\u52d9\u8cec\u865f\u4f5c\u7232\u5c6c\u65bc Google Cloud \u9805\u76ee\u7684\u8cc7\u6e90\u5275\u5efa\u548c\u7ba1\u7406\u3002\u76f8\u6bd4\u4e4b\u4e0b\uff0c\u7528\u6236\u5728 Cloud Identity \u6216 Google Workspace \u8cec\u865f\u4e2d\u9032\u884c\u7ba1\u7406\u3002\n- \u9019\u4e9b\u8cec\u865f\u5c08\u7528\u65bc Google Cloud\u3002\u76f8\u6bd4\u4e4b\u4e0b\uff0c\u5728 Cloud Identity \u6216 Google Workspace \u4e2d\u7ba1\u7406\u7684\u7528\u6236\u53ef\u8de8\u591a\u500b Google \u7522\u54c1\u548c\u670d\u52d9\u958b\u5c55\u5de5\u4f5c\u3002\n- \u5b83\u5011\u5373\u662f\u8cc7\u6e90\uff0c\u53c8\u662f [\u4e3b\u8cec\u865f](https://cloud.google.com/docs/authentication?hl=zh-cn#principal) \uff1a- \u4f5c\u7232\u4e3b\u8cec\u865f\uff0c\u670d\u52d9\u8cec\u865f\u53ef\u4ee5\u88ab\u6388\u4e88\u5c0d\u8cc7\u6e90\uff08\u4f8b\u5982 Cloud Storage \u5b58\u5132\u6876\uff09\u7684\u8a2a\u554f\u6b0a\u9650\u3002\n- \u4f5c\u7232\u8cc7\u6e90\uff0c\u670d\u52d9\u8cec\u865f\u53ef\u4ee5\u88ab\u8a2a\u554f\uff0c\u4e26\u4e14\u53ef\u80fd\u6703\u88ab\u5176\u4ed6\u4e3b\u8cec\u865f\uff08\u4f8b\u5982\u7528\u6236\u6216\u7fa3\u7d44\uff09 [\u6a21\u64ec](https://cloud.google.com/iam/docs/service-account-impersonation?hl=zh-cn) \u3002\u96d6\u7136\u670d\u52d9\u8cec\u865f\u662f\u4e00\u7a2e\u6709\u7528\u7684\u5de5\u5177\uff0c\u4f46\u670d\u52d9\u8cec\u865f\u4e5f\u53ef\u80fd\u88ab\u6feb\u7528\uff0c\u4e3b\u8981\u6709\u4ee5\u4e0b\u5e7e\u7a2e\u65b9\u5f0f\uff1a\n- **\u63d0\u5347\u6b0a\u9650** \uff1a\u4e0d\u6cd5\u5206\u5b50\u53ef\u80fd\u6703\u901a\u904e\u6a21\u64ec\u670d\u52d9\u8cec\u865f\u800c\u8a2a\u554f\u4ed6\u5011\u7121\u6b0a\u8a2a\u554f\u7684\u8cc7\u6e90\u3002\n- **\u4eff\u5192** \uff1a\u4e0d\u6cd5\u5206\u5b50\u53ef\u80fd\u6703\u4f7f\u7528\u670d\u52d9\u8cec\u865f\u6a21\u64ec\u4f86\u6a21\u7cca\u5176\u8eab\u4efd\u3002\n- **\u4e0d\u53ef\u5426\u8a8d\u6027** \uff1a\u4e0d\u6cd5\u5206\u5b50\u53ef\u80fd\u6703\u4f7f\u7528\u670d\u52d9\u8cec\u865f\u4ee3\u8868\u5176\u57f7\u884c\u64cd\u4f5c\uff0c\u4ee5\u6b64\u4f86\u96b1\u85cf\u5176\u8eab\u4efd\u548c\u64cd\u4f5c\u3002\u5728\u67d0\u4e9b\u60c5\u6cc1\u4e0b\uff0c\u53ef\u80fd\u7121\u6cd5\u8ddf\u8e64\u4e0d\u6cd5\u5206\u5b50\u7684\u9019\u4e9b\u64cd\u4f5c\u3002\n- **\u4fe1\u606f\u62ab\u9732** \uff1a\u4e0d\u6cd5\u5206\u5b50\u53ef\u80fd\u6703\u5f9e\u5b58\u5728\u7684\u67d0\u4e9b\u670d\u52d9\u8cec\u865f\u6d3e\u751f\u6709\u95dc\u57fa\u790e\u67b6\u69cb\u3001\u61c9\u7528\u6216\u9032\u7a0b\u7684\u4fe1\u606f\u3002\n\u7232\u5e6b\u52a9\u4fdd\u8b77\u670d\u52d9\u8cec\u865f\uff0c\u8acb\u8003\u616e\u5176\u96d9\u91cd\u6027\u8cea\uff1a\n- \u7531\u65bc\u670d\u52d9\u8cec\u865f\u662f\u4e3b\u8cec\u865f\uff0c\u56e0\u6b64\u60a8\u5fc5\u9808\u9650\u5236\u5176\u6b0a\u9650\uff0c\u4ee5\u964d\u4f4e\u88ab\u76dc\u7528\u670d\u52d9\u8cec\u865f\u53ef\u80fd\u9020\u6210\u7684\u6f5b\u5728\u5371\u5bb3\u3002\n- \u7531\u65bc\u670d\u52d9\u8cec\u865f\u662f\u4e00\u7a2e\u8cc7\u6e90\uff0c\u56e0\u6b64\u60a8\u5fc5\u9808\u9632\u6b62\u5b83\u88ab\u76dc\u7528\u3002\n\u672c\u6307\u5357\u4ecb\u7d39\u7ba1\u7406\u3001\u4f7f\u7528\u548c\u4fdd\u8b77\u670d\u52d9\u8cec\u865f\u7684\u6700\u4f73\u5be6\u8e10\u3002\n[](None)  [](None)  [](None)\n", "content": "## \u9078\u64c7\u4f55\u6642\u4f7f\u7528\u670d\u52d9\u8cec\u865f\n\u4e26\u975e\u6bcf\u7a2e\u5834\u666f\u90fd\u9700\u8981\u670d\u52d9\u8cec\u865f\u4f86\u8a2a\u554f Google Cloud \u670d\u52d9\uff0c\u4e26\u4e14\u8a31\u591a\u5834\u666f\u53ef\u4ee5\u4f7f\u7528\u6bd4\u4f7f\u7528\u670d\u52d9\u8cec\u865f\u5bc6\u9470\u66f4\u5b89\u5168\u7684\u65b9\u6cd5\u9032\u884c\u8eab\u4efd\u9a57\u8b49\u3002\u6211\u5011\u5efa\u8b70\u60a8\u5118\u53ef\u80fd\u907f\u514d\u4f7f\u7528\u670d\u52d9\u8cec\u865f\u5bc6\u9470\u3002\n\u7576\u60a8\u4f7f\u7528 Google Cloud CLI\u3001Cloud \u5ba2\u6236\u7aef\u5eab\u3001\u652f\u6301 [\u61c9\u7528\u9ed8\u8a8d\u6191\u64da (ADC)](https://cloud.google.com/docs/authentication/application-default-credentials?hl=zh-cn) \u7684\u5de5\u5177\uff08\u5982 Terraform \u6216 REST \u8acb\u6c42\uff09\u8a2a\u554f Google Cloud \u670d\u52d9\u6642\uff0c\u8acb\u4f7f\u7528\u4e0b\u5716\u4f86\u5e6b\u52a9\u60a8\u9078\u64c7\u8eab\u4efd\u9a57\u8b49\u65b9\u6cd5\uff1a\n\u6b64\u5716\u5c07\u5f15\u5c0e\u60a8\u5b8c\u6210\u4ee5\u4e0b\u554f\u984c\uff1a\n- \u60a8\u662f\u5426\u5728\u55ae\u7528\u6236\u958b\u767c\u74b0\u5883\uff08\u4f8b\u5982\u60a8\u81ea\u5df1\u7684\u5de5\u4f5c\u7ad9\u3001Cloud Shell \u6216\u865b\u64ec\u684c\u9762\u754c\u9762\uff09\u4e2d\u904b\u884c\u4ee3\u78bc\uff1f- \u5982\u679c\u662f\uff0c\u8acb\u7e7c\u7e8c\u56de\u7b54\u554f\u984c 4\u3002\n- \u5982\u679c\u4e0d\u662f\uff0c\u8acb\u7e7c\u7e8c\u56de\u7b54\u554f\u984c 2\u3002\n- \u60a8\u662f\u5426\u5728 Google Cloud \u4e2d\u904b\u884c\u4ee3\u78bc\uff1f- \u5982\u679c\u662f\uff0c\u8acb\u7e7c\u7e8c\u56de\u7b54\u554f\u984c 3\u3002\n- \u5982\u679c\u4e0d\u662f\uff0c\u8acb\u7e7c\u7e8c\u56de\u7b54\u554f\u984c 5\u3002\n- \u60a8\u662f\u5426\u5728 Google Kubernetes Engine \u6216 GKE Enterprise \u4e2d\u904b\u884c\u5bb9\u5668\uff1f- \u5982\u679c\u662f\uff0c\u8acb\u4f7f\u7528 [\u9069\u7528\u65bc GKE \u7684\u5de5\u4f5c\u8ca0\u8f09\u8eab\u4efd\u806f\u5408](https://cloud.google.com/kubernetes-engine/docs/how-to/workload-identity?hl=zh-cn#authenticating_to) \u5c07\u670d\u52d9\u8cec\u865f\u95dc\u806f\u5230 Kubernetes pod\u3002\n- \u5982\u679c\u4e0d\u662f\uff0c\u8acb [\u5c07\u670d\u52d9\u8cec\u865f\u9644\u52a0](https://cloud.google.com/iam/docs/attach-service-accounts?hl=zh-cn#attaching-to-resources) \u5230\u8cc7\u6e90\u3002\n- \u60a8\u7684\u4f7f\u7528\u5834\u666f\u662f\u5426\u9700\u8981\u670d\u52d9\u8cec\u865f\uff1f\u4f8b\u5982\uff0c\u60a8\u5e0c\u671b\u5728\u6240\u6709\u74b0\u5883\u4e2d\u7232\u60a8\u7684\u61c9\u7528\u4e00\u81f4\u5730\u914d\u7f6e\u8eab\u4efd\u9a57\u8b49\u548c\u6388\u6b0a\u3002- \u5982\u679c\u4e0d\u662f\uff0c\u8acb [\u4f7f\u7528\u7528\u6236\u6191\u64da\u9032\u884c\u8eab\u4efd\u9a57\u8b49](https://cloud.google.com/docs/authentication/provide-credentials-adc?hl=zh-cn#local-user-cred) \u3002\n- \u5982\u679c\u662f\uff0c\u8acb [\u4f7f\u7528\u7528\u6236\u6191\u64da\u6a21\u64ec\u670d\u52d9\u8cec\u865f](https://cloud.google.com/docs/authentication/use-service-account-impersonation?hl=zh-cn) \u3002\n- \u60a8\u7684\u5de5\u4f5c\u8ca0\u8f09\u662f\u5426\u901a\u904e\u652f\u6301 [\u5de5\u4f5c\u8ca0\u8f09\u8eab\u4efd\u806f\u5408](https://cloud.google.com/iam/docs/workload-identity-federation?hl=zh-cn#providers) \u7684\u5916\u90e8\u8eab\u4efd\u63d0\u4f9b\u65b9\u9032\u884c\u8eab\u4efd\u9a57\u8b49\uff1f- \u5982\u679c\u662f\uff0c\u8acb [\u914d\u7f6e\u5de5\u4f5c\u8ca0\u8f09\u8eab\u4efd\u806f\u5408](https://cloud.google.com/iam/docs/workload-identity-federation-with-other-clouds?hl=zh-cn) \uff0c\u4ee5\u5141\u8a31\u5728\u672c\u5730\u6216\u5176\u4ed6\u96f2\u63d0\u4f9b\u5546\u4e0a\u904b\u884c\u7684\u61c9\u7528\u4f7f\u7528\u670d\u52d9\u8cec\u865f\u3002\n- \u5982\u679c\u4e0d\u662f\uff0c\u8acb [\u5275\u5efa\u670d\u52d9\u8cec\u865f\u5bc6\u9470](https://cloud.google.com/docs/authentication/provide-credentials-adc?hl=zh-cn#local-key) \u3002[](None)\n## \u7ba1\u7406\u670d\u52d9\u8cec\u865f\n\u670d\u52d9\u8cec\u865f\u8207\u666e\u901a\u7528\u6236\u8cec\u865f\u7684\u5340\u5225\u4e0d\u50c5\u5728\u65bc\u4f7f\u7528\u65b9\u6cd5\uff0c\u9084\u5728\u65bc\u7ba1\u7406\u65b9\u6cd5\u3002\u4ee5\u4e0b\u90e8\u5206\u63d0\u4f9b\u4e86\u7ba1\u7406\u670d\u52d9\u8cec\u865f\u7684\u6700\u4f73\u505a\u6cd5\u3002\n**\u6700\u4f73\u505a\u6cd5** \uff1a [\u5c07\u670d\u52d9\u8cec\u865f\u4f5c\u7232\u8cc7\u6e90\u7ba1\u7406](#manage-like-a-resource) \u3002 [\u5275\u5efa\u55ae\u4e00\u7528\u9014\u7684\u670d\u52d9\u8cec\u865f](#single-purpose) \u3002 [\u9075\u5faa\u547d\u540d\u548c\u6587\u6a94\u6163\u4f8b](#naming-convention) \u3002 [\u8b58\u5225\u4e26\u505c\u7528\u672a\u4f7f\u7528\u7684\u670d\u52d9\u8cec\u865f](#identify-unused-accounts) \u3002 [\u505c\u7528\u672a\u4f7f\u7528\u7684\u670d\u52d9\u8cec\u865f\uff0c\u7136\u5f8c\u518d\u5c07\u5176\u522a\u9664](#disable-before-delete) \u3002\n### \u5c07\u670d\u52d9\u8cec\u865f\u4f5c\u7232\u8cc7\u6e90\u7ba1\u7406\n\u5e38\u898f\u7528\u6236\u8cec\u865f\u901a\u5e38\u6839\u64da\u7d44\u7e54\u7684\u201cjoiner-mover-leaver\u201d \u6d41\u7a0b\u9032\u884c\u7ba1\u7406\uff1a\u54e1\u5de5\u52a0\u5165\u6642\uff0c\u7cfb\u7d71\u6703\u7232\u4ed6\u5011\u5275\u5efa\u65b0\u7684\u7528\u6236\u8cec\u865f\u3002\u7576\u54e1\u5de5\u8abf\u52d5\u90e8\u9580\u6642\uff0c\u5176\u7528\u6236\u8cec\u865f\u6703\u66f4\u65b0\u3002\u7576\u54e1\u5de5\u96e2\u958b\u516c\u53f8\u6642\uff0c\u4ed6\u5011\u7684\u7528\u6236\u8cec\u865f\u6703\u88ab\u66ab\u505c\u6216\u522a\u9664\u3002\n\u76f8\u6bd4\u4e4b\u4e0b\uff0c\u670d\u52d9\u8cec\u865f\u4e0d\u8207\u4efb\u4f55\u7279\u5b9a\u54e1\u5de5\u95dc\u806f\u3002\u800c\u662f\u6700\u597d\u5c07\u670d\u52d9\u8cec\u865f\u8996\u7232\u8cc7\u6e90\uff08\u5c6c\u65bc\u5176\u4ed6\u8cc7\u6e90\u6216\u662f\u5176\u4ed6\u8cc7\u6e90\u7684\u4e00\u90e8\u5206\uff09\uff0c\u4f8b\u5982\u7279\u5b9a\u865b\u64ec\u6a5f\u5be6\u4f8b\u6216\u61c9\u7528\u3002\n\u8981\u6709\u6548\u5730\u7ba1\u7406\u670d\u52d9\u8cec\u865f\uff0c\u8acb\u4e0d\u8981\u5b64\u7acb\u5730\u770b\u5f85\u670d\u52d9\u8cec\u865f\uff0c\u800c\u61c9\u5728\u5176\u95dc\u806f\u8cc7\u6e90\u7684\u80cc\u666f\u4e2d\u9032\u884c\u8003\u91cf\uff0c\u4e26\u5c07\u670d\u52d9\u8cec\u865f\u53ca\u5176\u95dc\u806f\u8cc7\u6e90\u4f5c\u7232\u4e00\u500b\u6574\u9ad4\u9032\u884c\u7ba1\u7406\uff1a\u5c0d\u670d\u52d9\u8cec\u865f\u53ca\u5176\u95dc\u806f\u8cc7\u6e90\u61c9\u7528\u76f8\u540c\u7684\u9032\u7a0b\u3001\u76f8\u540c\u7684\u751f\u547d\u9031\u671f\u548c\u76f8\u540c\u7684\u5b89\u5168\u7d1a\u5225\uff0c\u4e26\u4f7f\u7528\u76f8\u540c\u7684\u5de5\u5177\u9032\u884c\u7ba1\u7406\u3002\n### \u5275\u5efa\u55ae\u4e00\u7528\u9014\u7684\u670d\u52d9\u8cec\u865f\n\u5728\u591a\u500b\u61c9\u7528\u4e4b\u9593\u5171\u4eab\u4e00\u500b\u670d\u52d9\u8cec\u865f\u53ef\u80fd\u6703\u5c0e\u81f4\u670d\u52d9\u8cec\u865f\u7684\u7ba1\u7406\u8907\u96dc\u5316\uff1a\n- \u9019\u4e9b\u61c9\u7528\u53ef\u80fd\u6709\u4e0d\u540c\u7684\u751f\u547d\u9031\u671f\u3002\u5982\u679c\u61c9\u7528\u88ab\u505c\u7528\uff0c\u60a8\u53ef\u80fd\u4e0d\u6e05\u695a\u670d\u52d9\u8cec\u865f\u662f\u5426\u53ef\u505c\u7528\uff0c\u4ee5\u53ca\u662f\u5426\u4ecd\u9700\u8981\u670d\u52d9\u8cec\u865f\u3002\n- \u96a8\u7740\u6642\u9593\u7684\u63a8\u79fb\uff0c\u61c9\u7528\u7684\u8a2a\u554f\u6b0a\u9650\u8981\u6c42\u53ef\u80fd\u6703\u6709\u6240\u4e0d\u540c\u3002\u5982\u679c\u61c9\u7528\u4f7f\u7528\u540c\u4e00\u500b\u670d\u52d9\u8cec\u865f\uff0c\u60a8\u53ef\u80fd\u9700\u8981\u5411\u670d\u52d9\u8cec\u865f\u6388\u4e88\u8d8a\u4f86\u8d8a\u591a\u7684\u8cc7\u6e90\u7684\u8a2a\u554f\u6b0a\u9650\uff0c\u5c0e\u81f4\u589e\u52a0\u7e3d\u9ad4\u98a8\u96aa\u3002\n- Cloud Audit Logs \u5305\u542b\u57f7\u884c\u66f4\u6539\u6216\u8a2a\u554f\u6578\u64da\u7684\u670d\u52d9\u8cec\u865f\u7684\u540d\u7a31\uff0c\u4f46\u4e0d\u6703\u986f\u793a\u4f7f\u7528\u8a72\u670d\u52d9\u8cec\u865f\u7684\u61c9\u7528\u7684\u540d\u7a31\u3002\u5982\u679c\u591a\u500b\u61c9\u7528\u5171\u4eab\u4e00\u500b\u670d\u52d9\u8cec\u865f\uff0c\u60a8\u53ef\u80fd\u7121\u6cd5\u5c07\u6d3b\u52d5\u8ffd\u6eaf\u5230\u6b63\u78ba\u7684\u61c9\u7528\u3002\n\u5177\u9ad4\u800c\u8a00\uff0c\u4e00\u4e9b Google Cloud \u670d\u52d9\uff08\u5305\u62ec App Engine \u548c Compute Engine\uff09\u6703\u5275\u5efa\u9ed8\u8a8d\u5177\u6709\u9805\u76ee\u7684 Editor \u89d2\u8272 ( `roles/editor` ) \u7684 [\u9ed8\u8a8d\u670d\u52d9\u8cec\u865f](https://cloud.google.com/iam/docs/service-account-types?hl=zh-cn#default) \u3002\u7576\u60a8\u5275\u5efa Compute Engine \u865b\u64ec\u6a5f (VM) \u5be6\u4f8b\u7b49\u8cc7\u6e90\u6642\uff0c\u5982\u679c\u60a8\u672a\u6307\u5b9a\u670d\u52d9\u8cec\u865f\uff0c\u5247\u8a72\u8cc7\u6e90\u53ef\u4ee5\u81ea\u52d5\u4f7f\u7528\u9ed8\u8a8d\u670d\u52d9\u8cec\u865f\u3002\u96d6\u7136\u9ed8\u8a8d\u670d\u52d9\u8cec\u865f\u53ef\u8b93\u60a8\u66f4\u8f15\u9b06\u5730\u4e0a\u624b\uff0c\u4f46\u5728\u591a\u500b\u61c9\u7528\u4e4b\u9593\u5171\u4eab\u6b64\u985e\u6709\u5f71\u97ff\u529b\u7684\u670d\u52d9\u8cec\u865f\u7684\u98a8\u96aa\u975e\u5e38\u9ad8\u3002\n\u60a8\u53ef\u4ee5\u63a1\u53d6\u4ee5\u4e0b\u6b65\u9a5f\u4f86\u907f\u514d\u9019\u4e9b\u60c5\u6cc1\uff1a\n- \u7232\u6bcf\u500b\u61c9\u7528\u5275\u5efa\u5c08\u7528\u670d\u52d9\u8cec\u865f\uff0c\u4e26\u907f\u514d\u4f7f\u7528\u9ed8\u8a8d\u670d\u52d9\u8cec\u865f\u3002\n- [\u4e0d\u5c0d\u9ed8\u8a8d\u670d\u52d9\u8cec\u865f\u4f7f\u7528\u81ea\u52d5\u89d2\u8272\u6388\u4e88\u529f\u80fd](#automatic-role-grants) \u3002\n- \u4f7f\u7528 Google \u7684 [\u5de5\u5177\u77ad\u89e3\u670d\u52d9\u8cec\u865f\u4f7f\u7528\u60c5\u6cc1](https://cloud.google.com/policy-intelligence/docs/service-account-usage-tools?hl=zh-cn) \uff0c\u9019\u6709\u52a9\u65bc\u60a8\u76e3\u63a7\u4f7f\u7528\u60c5\u6cc1\u4e26\u9632\u6b62\u670d\u52d9\u8cec\u865f\u5728\u591a\u500b\u61c9\u7528\u4e4b\u9593\u5171\u4eab\u3002\n### \u9075\u5faa\u547d\u540d\u548c\u6587\u6a94\u6163\u4f8b\n\u7232\u4e86\u5e6b\u52a9\u8ddf\u8e64\u670d\u52d9\u8207\u61c9\u7528\u6216\u8cc7\u6e90\u4e4b\u9593\u7684\u95dc\u806f\uff0c\u8acb\u5728\u5275\u5efa\u65b0\u7684\u670d\u52d9\u8cec\u865f\u6642\u9075\u5faa\u547d\u540d\u6163\u4f8b\uff1a\n- \u7232\u670d\u52d9\u8cec\u865f\u96fb\u5b50\u90f5\u4ef6\u5730\u5740\u6dfb\u52a0\u4e00\u500b\u524d\u7db4\uff0c\u4ee5\u6a19\u8b58\u8a72\u8cec\u865f\u7684\u4f7f\u7528\u65b9\u5f0f\u3002\u4f8b\u5982\uff1a\n- `vm-`\uff0c\u8868\u793a\u639b\u63a5\u5230\u865b\u64ec\u6a5f\u5be6\u4f8b\u7684\u670d\u52d9\u8cec\u865f\u3002\n- `wi-`\uff0c\u8868\u793a Workload Identity \u4f7f\u7528\u7684\u670d\u52d9\u8cec\u865f\u3002\n- `wif-`\uff0c\u8868\u793a\u5de5\u4f5c\u8ca0\u8f09\u8eab\u4efd\u806f\u5408\u4f7f\u7528\u7684\u670d\u52d9\u8cec\u865f\u3002\n- `onprem-`\uff0c\u8868\u793a\u672c\u5730\u61c9\u7528\u4f7f\u7528\u7684\u670d\u52d9\u8cec\u865f\u3002\n- \u5982\u679c\u865b\u64ec\u6a5f\u904b\u884c\u5dee\u65c5\u8cbb\u7528\u61c9\u7528\uff0c\u5247\u5728\u670d\u52d9\u8cec\u865f\u96fb\u5b50\u90f5\u4ef6\u5730\u5740\u4e2d\u5d4c\u5165\u8a72\u61c9\u7528\u7684\u540d\u7a31\uff0c\u4f8b\u5982`vm-travelexpenses@`\u3002\n- \u4f7f\u7528\u8aaa\u660e\u5b57\u6bb5\u6dfb\u52a0\u806f\u7e6b\u4eba\u3001\u6307\u5411\u76f8\u95dc\u6587\u6a94\u7684\u93c8\u63a5\u6216\u5176\u4ed6\u8aaa\u660e\u3002\n\u8acb\u52ff\u5728\u670d\u52d9\u8cec\u865f\u7684\u96fb\u5b50\u90f5\u4ef6\u5730\u5740\u4e2d\u5d4c\u5165\u654f\u611f\u4fe1\u606f\u6216\u5b57\u8a5e\u3002\n### \u8b58\u5225\u4e26\u505c\u7528\u672a\u4f7f\u7528\u7684\u670d\u52d9\u8cec\u865f\n\u5982\u679c\u4e0d\u518d\u4f7f\u7528\u67d0\u670d\u52d9\u8cec\u865f\uff0c\u8acb [\u505c\u7528\u8a72\u670d\u52d9\u8cec\u865f](https://cloud.google.com/iam/docs/service-accounts-disable-enable?hl=zh-cn#disabling) \u3002\u901a\u904e\u505c\u7528\u672a\u4f7f\u7528\u7684\u670d\u52d9\u8cec\u865f\uff0c\u53ef\u4ee5\u964d\u4f4e\u670d\u52d9\u8cec\u865f\u56e0\u4e0d\u6cd5\u5206\u5b50\u6c34\u5e73\u64f4\u6563\u6216\u6b0a\u9650\u63d0\u5347\u800c\u88ab\u6feb\u7528\u7684\u98a8\u96aa\u3002\n\u5c0d\u65bc\u8207\u7279\u5b9a\u8cc7\u6e90\uff08\u5982\u865b\u64ec\u6a5f\u5be6\u4f8b\uff09\u95dc\u806f\u7684 [\u55ae\u4e00\u7528\u9014\u7684\u670d\u52d9\u8cec\u865f](#single-purpose) \uff0c\u8acb\u5728\u505c\u7528\u6216\u522a\u9664\u95dc\u806f\u8cc7\u6e90\u5f8c\uff0c\u7acb\u5373\u505c\u7528\u8a72\u670d\u52d9\u8cec\u865f\u3002\n\u5c0d\u65bc\u7528\u65bc\u591a\u7a2e\u7528\u9014\u6216\u8de8\u591a\u500b\u8cc7\u6e90\u5171\u4eab\u7684\u670d\u52d9\u8cec\u865f\uff0c\u8981\u78ba\u5b9a\u670d\u52d9\u8cec\u865f\u662f\u5426\u4ecd\u5728\u4f7f\u7528\u5247\u66f4\u7232\u56f0\u96e3\u3002\u5728\u9019\u7a2e\u60c5\u6cc1\u4e0b\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528 [\u6d3b\u52d5\u5206\u6790\u5668](https://cloud.google.com/policy-intelligence/docs/service-account-usage-tools?hl=zh-cn#sa-authn) \u4f86\u67e5\u770b\u670d\u52d9\u8cec\u865f\u7684\u6700\u8fd1\u8eab\u4efd\u9a57\u8b49\u6d3b\u52d5\u3002\n### \u505c\u7528\u672a\u4f7f\u7528\u7684\u670d\u52d9\u8cec\u865f\uff0c\u7136\u5f8c\u518d\u5c07\u5176\u522a\u9664\n\u5982\u679c\u60a8\u522a\u9664\u4e00\u500b\u670d\u52d9\u8cec\u865f\uff0c\u7136\u5f8c\u5275\u5efa\u5177\u6709\u76f8\u540c\u540d\u7a31\u7684\u65b0\u670d\u52d9\u8cec\u865f\uff0c\u7cfb\u7d71\u6703\u7232\u65b0\u670d\u52d9\u8cec\u865f\u5206\u914d\u4e0d\u540c\u7684\u8eab\u4efd\u3002\u56e0\u6b64\uff0c\u539f\u59cb IAM \u7d81\u5b9a\u4e0d\u6703\u61c9\u7528\u65bc\u65b0\u670d\u52d9\u8cec\u865f\u3002\u76f8\u53cd\uff0c\u5982\u679c\u505c\u7528\u4e26\u91cd\u65b0\u5553\u7528\u670d\u52d9\u8cec\u865f\uff0c\u6240\u6709\u7684 IAM \u7d81\u5b9a\u4fdd\u6301\u4e0d\u8b8a\u3002\n\u7232\u907f\u514d\u610f\u5916\u4e1f\u5931 IAM \u7d81\u5b9a\uff0c\u6700\u597d\u4e0d\u8981\u7acb\u5373\u522a\u9664\u670d\u52d9\u8cec\u865f\u3002\u5982\u679c\u4e0d\u518d\u9700\u8981\u67d0\u500b\u670d\u52d9\u8cec\u865f\uff0c\u8acb\u5728\u904e\u4e00\u6bb5\u6642\u9593\u5f8c\u518d\u522a\u9664\u3002\n\u5207\u52ff\u522a\u9664\u9ed8\u8a8d\u670d\u52d9\u8cec\u865f\uff0c\u4f8b\u5982 [App Engine](https://cloud.google.com/appengine/docs/standard/python3/service-account?hl=zh-cn) \u6216 [Compute Engine \u9ed8\u8a8d\u670d\u52d9\u8cec\u865f](https://cloud.google.com/compute/docs/access/service-accounts?hl=zh-cn#default_service_account) \u3002\u9019\u4e9b\u670d\u52d9\u8cec\u865f\u53ea\u80fd\u901a\u904e\u505c\u7528\u4e26\u91cd\u65b0\u5553\u7528\u76f8\u61c9 API \u4f86\u91cd\u65b0\u5275\u5efa\uff0c\u9019\u53ef\u80fd\u6703\u7834\u58de\u60a8\u73fe\u6709\u7684\u90e8\u7f72\u3002\u5982\u679c\u60a8\u4e0d\u4f7f\u7528\u9ed8\u8a8d\u670d\u52d9\u8cec\u865f\uff0c\u505c\u7528\u5b83\u5011\u5373\u53ef\u3002\n[](None)\n## \u9650\u5236\u670d\u52d9\u8cec\u865f\u6b0a\u9650\n\u670d\u52d9\u8cec\u865f\u662f\u4e3b\u8cec\u865f\uff0c\u53ef\u4ee5\u7372\u5f97\u5c0d\u5e38\u898f\u7528\u6236\u8cec\u865f\u7b49\u8cc7\u6e90\u7684\u8a2a\u554f\u6b0a\u9650\u3002\u4f46\u662f\uff0c\u670d\u52d9\u8cec\u865f\u901a\u5e38\u6bd4\u5178\u578b\u7528\u6236\u5177\u6709\u66f4\u5927\u7684\u8a2a\u554f\u6b0a\u9650\uff0c\u53ef\u4ee5\u8a2a\u554f\u66f4\u591a\u8cc7\u6e90\u3002\u6b64\u5916\uff0c\u7576\u60a8\u56ae\u61c9\u7528\u6dfb\u52a0\u529f\u80fd\u6642\uff0c\u5176\u670d\u52d9\u8cec\u865f\u5f80\u5f80\u6703\u96a8\u7740\u6642\u9593\u7684\u63a8\u79fb\u7372\u5f97\u8d8a\u4f86\u8d8a\u591a\u7684\u8a2a\u554f\u6b0a\u9650\u3002\u60a8\u53ef\u80fd\u9084\u6703\u5fd8\u8a18\u64a4\u6d88\u4e0d\u518d\u9700\u8981\u7684\u8a2a\u554f\u6b0a\u9650\u3002\n**\u6700\u4f73\u505a\u6cd5** \uff1a [\u4e0d\u5c0d\u9ed8\u8a8d\u670d\u52d9\u8cec\u865f\u4f7f\u7528\u81ea\u52d5\u89d2\u8272\u6388\u4e88\u529f\u80fd](#automatic-role-grants) \u3002 [\u5c07\u670d\u52d9\u8cec\u865f\u95dc\u806f\u5230\u865b\u64ec\u6a5f\u5be6\u4f8b\u6642\uff0c\u8acb\u52ff\u4f9d\u8cf4\u65bc\u8a2a\u554f\u6b0a\u9650\u7bc4\u570d](#access-scopes) \u3002 [\u907f\u514d\u4f7f\u7528\u7fa3\u7d44\u5411\u670d\u52d9\u8cec\u865f\u6388\u4e88\u8cc7\u6e90\u8a2a\u554f\u6b0a\u9650](#groups) \u3002 [\u907f\u514d\u4f7f\u7528\u5168\u7db2\u57df\u6388\u6b0a\u529f\u80fd](#domain-wide-delegation) \u3002 [\u672a\u7d93\u7528\u6236\u540c\u610f\uff0c\u8acb\u52ff\u4f7f\u7528\u670d\u52d9\u8cec\u865f\u8a2a\u554f\u7528\u6236\u6578\u64da](#user-consent) \u3002 [\u4f7f\u7528 IAM Credentials API \u63d0\u5347\u81e8\u6642\u6b0a\u9650](#use-credentials-api) \u3002 [\u4f7f\u7528\u6191\u64da\u8a2a\u554f\u908a\u754c\u4f86\u7e2e\u5c0f\u8a2a\u554f\u4ee4\u724c\u6b0a\u9650\u7bc4\u570d](#downscope) \u3002 [\u4f7f\u7528\u89d2\u8272\u5efa\u8b70\u4f86\u78ba\u5b9a\u672a\u4f7f\u7528\u7684\u6b0a\u9650](#recommender) \u3002 [\u4f7f\u7528\u6a6b\u5411\u79fb\u52d5\u6578\u64da\u5206\u6790\u4f86\u9650\u5236\u6a6b\u5411\u79fb\u52d5](#lateral-movement) \u3002\n### \u4e0d\u5c0d\u9ed8\u8a8d\u670d\u52d9\u8cec\u865f\u4f7f\u7528\u81ea\u52d5\u89d2\u8272\u6388\u4e88\u529f\u80fd\n\u7576\u60a8\u9996\u6b21\u5728 Google Cloud \u9805\u76ee\u4e2d\u5553\u7528 API \u6642\uff0c\u67d0\u4e9b Google Cloud \u670d\u52d9\u6703\u5275\u5efa [\u9ed8\u8a8d\u670d\u52d9\u8cec\u865f](https://cloud.google.com/iam/docs/service-account-types?hl=zh-cn#default) \u3002\u9ed8\u8a8d\u60c5\u6cc1\u4e0b\uff0c\u9019\u4e9b\u670d\u52d9\u8cec\u865f\u6703\u88ab\u6388\u4e88 Google Cloud \u9805\u76ee\u7684 Editor \u89d2\u8272 ( `roles/editor` )\uff0c\u9019\u6a23\u4ed6\u5011\u53ef\u4ee5\u8b80\u53d6\u548c\u4fee\u6539 Google Cloud \u9805\u76ee\u4e2d\u7684\u6240\u6709\u8cc7\u6e90\u3002\u6388\u4e88\u6b64\u89d2\u8272\u662f\u7232\u4e86\u65b9\u4fbf\u60a8\u4f7f\u7528\uff0c\u4f46\u9019\u5c0d\u65bc\u670d\u52d9\u8cec\u865f\u6b63\u5e38\u5de5\u4f5c\u4e26\u4e0d\u662f\u5fc5\u9700\u7684\uff1a\u5982\u9700\u8a2a\u554f Google Cloud \u9805\u76ee\u4e2d\u7684\u8cc7\u6e90\uff0cGoogle Cloud \u670d\u52d9\u4f7f\u7528 [\u670d\u52d9\u4ee3\u7406](https://cloud.google.com/iam/docs/service-agents?hl=zh-cn) \uff0c\u800c\u4e0d\u662f\u9ed8\u8a8d\u670d\u52d9\u8cec\u865f\u3002\n\u5982\u9700\u9632\u6b62\u9ed8\u8a8d\u670d\u52d9\u8cec\u865f\u81ea\u52d5\u88ab\u6388\u4e88 Editor \u89d2\u8272\uff0c\u8acb\u7232\u60a8\u7684\u7d44\u7e54\u5553\u7528 [\u505c\u7528\u9ed8\u8a8d\u670d\u52d9\u8cec\u865f\u7684\u81ea\u52d5 IAM \u6388\u6b0a](https://cloud.google.com/resource-manager/docs/organization-policy/restricting-service-accounts?hl=zh-cn#disable_service_account_default_grants) ( `constraints/iam.automaticIamGrantsForDefaultServiceAccounts` ) \u9650\u5236\u689d\u4ef6\u3002\u5982\u9700\u5c07\u8a72\u9650\u5236\u689d\u4ef6\u61c9\u7528\u65bc\u591a\u500b Google Cloud \u9805\u76ee\uff0c\u8acb [\u5728\u6587\u4ef6\u593e\u6216\u7d44\u7e54\u7bc0\u9ede\u4e0a\u914d\u7f6e\u8a72\u9650\u5236\u689d\u4ef6](https://cloud.google.com/resource-manager/docs/organization-policy/using-constraints?hl=zh-cn#enforce_list_constraint) \u3002\u61c9\u7528\u8a72\u9650\u5236\u689d\u4ef6\u4e0d\u6703\u5f9e\u73fe\u6709\u9ed8\u8a8d\u670d\u52d9\u8cec\u865f\u4e2d\u79fb\u9664 **Editor** \u89d2\u8272\u3002\n\u5982\u679c\u60a8\u61c9\u7528\u6b64\u9650\u5236\u689d\u4ef6\uff0c\u5247\u65b0\u9805\u76ee\u4e2d\u7684\u9ed8\u8a8d\u670d\u52d9\u8cec\u865f\u5c07\u7121\u6b0a\u8a2a\u554f\u60a8\u7684 Google Cloud \u8cc7\u6e90\u3002\u60a8\u5fc5\u9808\u7232\u9ed8\u8a8d\u670d\u52d9\u8cec\u865f\u6388\u4e88\u9069\u7576\u7684\u89d2\u8272\uff0c\u4ee5\u4fbf\u5c0d\u60a8\u7684\u8cc7\u6e90\u9032\u884c\u8a2a\u554f\u3002\n### \u5c07\u670d\u52d9\u8cec\u865f\u95dc\u806f\u5230\u865b\u64ec\u6a5f\u5be6\u4f8b\u6642\uff0c\u8acb\u52ff\u4f9d\u8cf4\u65bc\u8a2a\u554f\u6b0a\u9650\u7bc4\u570d\n\u5c07\u670d\u52d9\u8cec\u865f\u9644\u52a0\u5230\u865b\u64ec\u6a5f\u5be6\u4f8b\u5f8c\uff0c\u60a8\u53ef\u4ee5 [\u6307\u5b9a\u4e00\u500b\u6216\u591a\u500b\u8a2a\u554f\u6b0a\u9650\u7bc4\u570d](https://cloud.google.com/compute/docs/access/create-enable-service-accounts-for-instances?hl=zh-cn#changeserviceaccountandscopes) \u3002\u901a\u904e\u8a2a\u554f\u6b0a\u9650\u7bc4\u570d\uff0c\u60a8\u53ef\u4ee5\u9650\u5236\u865b\u64ec\u6a5f\u53ef\u4ee5\u8a2a\u554f\u7684\u670d\u52d9\u3002\u9664\u4e86\u5141\u8a31\u653f\u7b56\u5916\uff0c\u9084\u6703\u61c9\u7528\u9019\u4e9b\u9650\u5236\u3002\n\u8a2a\u554f\u6b0a\u9650\u7bc4\u570d\u7684\u7c92\u5ea6\u8f03\u7c97\u3002\u4f8b\u5982\uff0c\u4f7f\u7528 `https://www.googleapis.com/auth/devstorage.read_only` \u7bc4\u570d\uff0c\u60a8\u53ef\u4ee5\u9650\u5236\u5c0d Cloud Storage \u53ea\u8b80\u64cd\u4f5c\u7684\u8a2a\u554f\u6b0a\u9650\uff0c\u4f46\u4e0d\u80fd\u9650\u5236\u5c0d\u7279\u5b9a\u5b58\u5132\u6876\u7684\u8a2a\u554f\u6b0a\u9650\u3002\u56e0\u6b64\uff0c\u8a2a\u554f\u6b0a\u9650\u7bc4\u570d\u4e0d\u662f\u9069\u5408\u7cbe\u7d30\u5141\u8a31\u653f\u7b56\u7684\u66ff\u4ee3\u9805\u3002\n\u5275\u5efa\u4e00\u500b [\u5c08\u7528\u670d\u52d9\u8cec\u865f](https://cloud.google.com/iam/docs/best-practices-for-using-and-managing-service-accounts?hl=zh-cn#single-purpose) \u4e26\u4f7f\u7528\u7cbe\u7d30\u5141\u8a31\u653f\u7b56\u4f86\u9650\u5236\u670d\u52d9\u8cec\u865f\u53ef\u4ee5\u8a2a\u554f\u7684\u8cc7\u6e90\uff0c\u800c\u4e0d\u662f\u4f9d\u8cf4\u65bc\u8a2a\u554f\u6b0a\u9650\u7bc4\u570d\u3002\n### \u907f\u514d\u4f7f\u7528\u7fa3\u7d44\u5411\u670d\u52d9\u8cec\u865f\u6388\u4e88\u8cc7\u6e90\u8a2a\u554f\u6b0a\u9650\n\u5728\u7d44\u7e54\u4e2d\uff0c\u591a\u500b\u54e1\u5de5\u5c65\u884c\u985e\u4f3c\u6216\u91cd\u758a\u7684\u5de5\u4f5c\u8077\u8cac\u662f\u5f88\u5e38\u898b\uff0c\u56e0\u6b64\u9700\u8981\u985e\u4f3c\u7684\u8cc7\u6e90\u8a2a\u554f\u6b0a\u9650\u3002\u85c9\u52a9\u7fa3\u7d44\uff0c\u60a8\u53ef\u4ee5\u5229\u7528\u9019\u4e9b\u985e\u4f3c\u7684\u8a2a\u554f\u6b0a\u9650\u4f86\u6e1b\u5c11\u7ba1\u7406\u958b\u92b7\u3002\n\u670d\u52d9\u8cec\u865f\u61c9\u4f9b\u61c9\u7528\u4f7f\u7528\u3002\u591a\u500b\u61c9\u7528\u5c65\u884c\u76f8\u540c\u7684\u8077\u8cac\uff0c\u56e0\u6b64\u8a2a\u554f\u6b0a\u9650\u8981\u6c42\u76f8\u540c\u6216\u985e\u4f3c\u662f\u5f88\u5c11\u898b\u7684\u60c5\u6cc1\u3002\u76f8\u53cd\uff0c\u61c9\u7528\u5f80\u5f80\u662f\u552f\u4e00\u7684\uff0c\u4e26\u4e14\u6bcf\u500b\u61c9\u7528\u9700\u8981\u8a2a\u554f\u7684\u8cc7\u6e90\u901a\u5e38\u90fd\u5404\u4e0d\u76f8\u540c\u3002\n\u4f7f\u7528\u7fa3\u7d44\u7232\u670d\u52d9\u8cec\u865f\u6388\u4e88\u5c0d\u8cc7\u6e90\u7684\u8a2a\u554f\u6b0a\u9650\u53ef\u80fd\u6703\u5c0e\u81f4\u4e00\u4e9b\u4e0d\u826f\u5f8c\u679c\uff1a\n- \u7fa3\u7d44\u6578\u6fc0\u589e\uff0c\u6bcf\u500b\u7fa3\u7d44\u53ea\u5305\u542b\u4e00\u500b\u6216\u5e7e\u500b\u670d\u52d9\u8cec\u865f\u3002\n- \u6b0a\u9650\u8513\u5ef6\uff1a\u96a8\u7740\u6642\u9593\u7684\u63a8\u79fb\uff0c\u7fa3\u7d44\u88ab\u6388\u4e88\u8d8a\u4f86\u8d8a\u591a\u7684\u8cc7\u6e90\u7684\u8a2a\u554f\u6b0a\u9650\uff0c\u4f46\u6bcf\u500b\u7fa3\u7d44\u6210\u54e1\u53ea\u9700\u8981\u4e00\u90e8\u5206\u8cc7\u6e90\u7684\u8a2a\u554f\u6b0a\u9650\u3002\n\u9664\u975e\u7fa3\u7d44\u7684\u7528\u9014\u660e\u78ba\u5b9a\u7fa9\uff0c\u5426\u5247\u6700\u597d\u907f\u514d\u4f7f\u7528\u7fa3\u7d44\uff1b\u800c\u662f\u76f4\u63a5\u7232\u670d\u52d9\u8cec\u865f\u6388\u4e88\u6240\u9700\u7684\u8cc7\u6e90\u8a2a\u554f\u6b0a\u9650\u3002\n### \u907f\u514d\u4f7f\u7528\u5168\u7db2\u57df\u6388\u6b0a\n[\u5168\u7db2\u57df\u6388\u6b0a\u529f\u80fd](https://support.google.com/a/answer/162106?hl=zh-cn#zippy=,set-up-domain-wide-delegation-for-a-client) \u4f7f\u670d\u52d9\u8cec\u865f\u80fd\u5920\u6a21\u64ec Cloud Identity \u6216 Google Workspace \u8cec\u865f\u4e2d\u7684\u4efb\u4f55\u7528\u6236\u3002\u901a\u904e\u5168\u7db2\u57df\u6388\u6b0a\u529f\u80fd\uff0c\u670d\u52d9\u8cec\u865f\u53ef\u4ee5\u5728 Google Workspace \u548c Cloud Identity \u4e2d\u57f7\u884c\u7279\u5b9a\u7ba1\u7406\u4efb\u52d9\uff0c\u4e5f\u53ef\u4ee5\u5f9e Google Cloud \u5916\u90e8\u8a2a\u554f\u4e0d\u652f\u6301\u670d\u52d9\u8cec\u865f\u7684 Google API\u3002\n\u5168\u7db2\u57df\u6388\u6b0a\u529f\u80fd\u4e0d\u6703\u9650\u5236\u670d\u52d9\u8cec\u865f\u6a21\u64ec\u7279\u5b9a\u7528\u6236\uff0c\u4f46\u5b83\u5141\u8a31\u6a21\u64ec Cloud Identity \u6216 Google Workspace \u8cec\u865f\u4e2d\u7684\u4efb\u4f55\u7528\u6236\uff08\u5305\u62ec\u8d85\u7d1a\u7528\u6236\uff09 \u3002\u56e0\u6b64\uff0c\u5141\u8a31\u670d\u52d9\u8cec\u865f\u4f7f\u7528\u5168\u7db2\u57df\u6388\u6b0a\u529f\u80fd\u53ef\u80fd\u6703\u4f7f\u670d\u52d9\u8cec\u865f\u5f88\u5bb9\u6613\u6210\u7232\u63d0\u5347\u6b0a\u9650\u653b\u64ca\u7684\u76ee\u6a19\u3002\n\u5982\u679c\u60a8\u53ef\u4ee5\u76f4\u63a5\u901a\u904e\u670d\u52d9\u8cec\u865f\u6216\u4f7f\u7528 [OAuth \u540c\u610f\u6d41\u7a0b](https://developers.google.com/identity/protocols/oauth2/web-server?hl=zh-cn) \u4f86\u5b8c\u6210\u4efb\u52d9\uff0c\u8acb\u907f\u514d\u4f7f\u7528\u5168\u7db2\u57df\u6388\u6b0a\u529f\u80fd\u3002\n\u5982\u679c\u60a8\u7121\u6cd5\u907f\u514d\u4f7f\u7528\u5168\u7db2\u57df\u6388\u6b0a\u529f\u80fd\uff0c\u8acb [\u9650\u5236\u670d\u52d9\u8cec\u865f\u53ef\u4ee5\u4f7f\u7528\u7684 OAuth \u7bc4\u570d\u96c6](https://developers.google.com/admin-sdk/directory/v1/guides/delegation?hl=zh-cn#delegate_domain-wide_authority_to_your_service_account) \u3002\u96d6\u7136 [OAuth \u7bc4\u570d](https://developers.google.com/admin-sdk/directory/v1/guides/authorizing?hl=zh-cn) \u4e0d\u6703\u9650\u5236\u670d\u52d9\u8cec\u865f\u53ef\u4ee5\u6a21\u64ec\u7684\u7528\u6236\uff0c\u4f46\u6703\u9650\u5236\u670d\u52d9\u8cec\u865f\u53ef\u4ee5\u8a2a\u554f\u7684\u7528\u6236\u6578\u64da\u985e\u578b\u3002\n### \u672a\u7d93\u7528\u6236\u540c\u610f\uff0c\u8acb\u52ff\u4f7f\u7528\u670d\u52d9\u8cec\u865f\u8a2a\u554f\u7528\u6236\u6578\u64da\n\u61c9\u7528\u53ef\u80fd\u9700\u8981\u654f\u611f\u6216\u500b\u4eba\u7528\u6236\u6578\u64da\u7684\u8a2a\u554f\u6b0a\u9650\u3002\u6b64\u985e\u6578\u64da\u793a\u4f8b\u5305\u62ec\u7528\u6236\u7684\u90f5\u7bb1\u6216\u65e5\u66c6\u3001\u5b58\u5132\u5728 Google \u96f2\u7aef\u786c\u76e4\u4e2d\u7684\u6587\u6a94\u6216\u5305\u542b\u654f\u611f\u6578\u64da\u7684 BigQuery \u6578\u64da\u96c6\u3002\n\u5982\u679c\u61c9\u7528\u57f7\u884c\u7121\u4eba\u8518\u8207\u7684\u5f8c\u81fa\u4efb\u52d9\uff08\u4f8b\u5982\u7de8\u5236\u7d22\u5f15\u6216\u6578\u64da\u6cc4\u9732\u9632\u8b77 (DLP) \u6383\u63cf\uff09\uff0c\u6216\u8005\u6700\u7d42\u7528\u6236\u672a\u4f7f\u7528 Google \u8eab\u4efd\u9032\u884c\u8eab\u4efd\u9a57\u8b49\uff0c\u5247\u4f7f\u7528\u670d\u52d9\u8cec\u865f\u8a2a\u554f\u7528\u6236\u6578\u64da\u662f\u5408\u9069\u7684\u505a\u6cd5\u3002\u5728\u61c9\u7528\u4ee3\u8868\u6700\u7d42\u7528\u6236\u57f7\u884c\u64cd\u4f5c\u7684\u6240\u6709\u5176\u4ed6\u5834\u666f\u4e2d\uff0c\u6700\u597d\u907f\u514d\u4f7f\u7528\u670d\u52d9\u8cec\u865f\u3002\n\u4f7f\u7528 [OAuth \u540c\u610f\u6d41\u7a0b](https://developers.google.com/identity/protocols/oauth2/web-server?hl=zh-cn) \u8acb\u6c42\u6700\u7d42\u7528\u6236\u7684\u540c\u610f\uff0c\u800c\u4e0d\u662f\u4f7f\u7528\u670d\u52d9\u8cec\u865f\u8a2a\u554f\u7528\u6236\u6578\u64da\uff08\u53ef\u80fd\u6703\u8f49\u63db\u4e3b\u8cec\u865f\uff09\u3002\u7136\u5f8c\uff0c\u8b93\u61c9\u7528\u4ee5\u6700\u7d42\u7528\u6236\u7684\u8eab\u4efd\u9032\u884c\u64cd\u4f5c\u3002\u4f7f\u7528 OAuth\uff08\u800c\u975e\u670d\u52d9\u8cec\u865f\uff09\u6709\u52a9\u65bc\u78ba\u4fdd\uff1a\n- \u7528\u6236\u53ef\u4ee5\u67e5\u770b\u5c07\u6388\u4e88\u61c9\u7528\u5c0d\u54ea\u4e9b\u8cc7\u6e90\u7684\u8a2a\u554f\u6b0a\u9650\uff0c\u4e26\u4e14\u53ef\u4ee5\u660e\u78ba\u8868\u793a\u6216\u62d2\u7d55\u540c\u610f\u3002\n- \u7528\u6236\u53ef\u4ee5\u96a8\u6642\u5728 [\u6211\u7684\u8cec\u865f](https://myaccount.google.com/permissions?hl=zh-cn) \u9801\u9762\u4e0a\u64a4\u6d88\u540c\u610f\u3002\n- \u60a8\u7121\u9700\u64c1\u6709\u4e00\u500b\u53ef\u4ee5\u4e0d\u53d7\u9650\u5236\u5730\u8a2a\u554f\u6240\u6709\u7528\u6236\u6578\u64da\u7684\u670d\u52d9\u8cec\u865f\u3002\n\u901a\u904e\u5141\u8a31\u61c9\u7528\u4f7f\u7528\u6700\u7d42\u7528\u6236\u6191\u64da\uff0c\u60a8\u53ef\u4ee5\u5ef6\u9072\u5c0d Google Cloud API \u7684\u6b0a\u9650\u6aa2\u67e5\u3002\u9019\u7a2e\u65b9\u6cd5\u9650\u5236\u4e86\u56e0\u7de8\u78bc\u932f\u8aa4\uff08 [\u6df7\u6dc6\u4ee3\u7406\u554f\u984c](https://www.wikipedia.org/wiki/Confused_deputy_problem) \uff09\u800c\u5c0e\u81f4\u610f\u5916\u516c\u958b\u7528\u6236\u4e0d\u61c9\u6709\u6b0a\u8a2a\u554f\u7684\u6578\u64da\u7684\u98a8\u96aa\u3002\n### \u4f7f\u7528 IAM Credentials API \u63d0\u5347\u81e8\u6642\u6b0a\u9650\n\u6709\u4e9b\u61c9\u7528\u50c5\u5728\u7279\u5b9a\u6642\u9593\u6216\u5728\u7279\u5b9a\u60c5\u6cc1\u4e0b\u9700\u8981\u7279\u5b9a\u8cc7\u6e90\u7684\u8a2a\u554f\u6b0a\u9650\u3002\u4f8b\u5982\uff1a\n- \u61c9\u7528\u5728\u5553\u52d5\u671f\u9593\u53ef\u80fd\u9700\u8981\u914d\u7f6e\u6578\u64da\u7684\u8a2a\u554f\u6b0a\u9650\uff0c\u4f46\u521d\u59cb\u5316\u5f8c\u53ef\u80fd\u6703\u4e0d\u9700\u8981\u6b64\u8a2a\u554f\u6b0a\u9650\u3002\n- \u76e3\u7ba1\u8005\u61c9\u7528\u53ef\u80fd\u6703\u5b9a\u671f\u5553\u52d5\u5f8c\u81fa\u4f5c\u696d\uff0c\u5176\u4e2d\u6bcf\u500b\u4f5c\u696d\u90fd\u6709\u4e0d\u540c\u7684\u8a2a\u554f\u6b0a\u9650\u8981\u6c42\u3002\n\u5728\u9019\u7a2e\u60c5\u6cc1\u4e0b\uff0c\u4f7f\u7528\u55ae\u500b\u670d\u52d9\u8cec\u865f\u4e26\u6388\u4e88\u5176\u5c0d\u6240\u6709\u8cc7\u6e90\u7684\u8a2a\u554f\u6b0a\u9650\u9055\u53cd\u4e86\u6700\u5c0f\u6b0a\u9650\u539f\u5247\uff1a\u5728\u4efb\u4f55\u6642\u9593\u9ede\uff0c\u61c9\u7528\u64c1\u6709\u8a2a\u554f\u6b0a\u9650\u7684\u8cc7\u6e90\u6578\u91cf\u90fd\u53ef\u80fd\u8d85\u904e\u5be6\u969b\u6240\u9700\u7684\u3002\n\u7232\u5e6b\u52a9\u78ba\u4fdd\u61c9\u7528\u7684\u4e0d\u540c\u90e8\u5206\u50c5\u6709\u6b0a\u8a2a\u554f\u6240\u9700\u7684\u8cc7\u6e90\uff0c\u8acb\u4f7f\u7528 IAM Credentials API \u9032\u884c\u81e8\u6642\u6b0a\u9650\u63d0\u5347\uff1a\n- \u7232\u61c9\u7528\u6216\u7528\u4f8b\u7684\u6bcf\u500b\u90e8\u5206\u5275\u5efa\u5c08\u7528\u670d\u52d9\u8cec\u865f\uff0c\u4e26\u53ea\u6388\u4e88\u670d\u52d9\u8cec\u865f\u5c0d\u5fc5\u8981\u8cc7\u6e90\u7684\u8a2a\u554f\u6b0a\u9650\u3002\n- \u5275\u5efa\u53e6\u4e00\u500b\u5145\u7576\u76e3\u7ba1\u8005\u7684\u670d\u52d9\u8cec\u865f\u3002\u5411\u76e3\u7ba1\u8005\u670d\u52d9\u8cec\u865f\u6388\u4e88\u5176\u4ed6\u670d\u52d9\u8cec\u865f\u7684 [Service Account Token Creator \u89d2\u8272](https://cloud.google.com/iam/docs/service-account-permissions?hl=zh-cn#token-creator-role) \uff0c\u4ee5\u4fbf\u5b83\u53ef\u4ee5\u7232\u9019\u4e9b\u670d\u52d9\u8cec\u865f\u8acb\u6c42\u77ed\u671f\u8a2a\u554f\u4ee4\u724c\u3002\n- \u62c6\u5206\u61c9\u7528\uff0c\u4f7f\u61c9\u7528\u7684\u4e00\u90e8\u5206\u5145\u7576\u4ee4\u724c\u4ee3\u7406\uff0c\u4e26\u4e14\u50c5\u8b93\u61c9\u7528\u7684\u9019\u4e00\u90e8\u5206\u4f7f\u7528\u76e3\u7ba1\u8005\u670d\u52d9\u8cec\u865f\u3002\n- \u4f7f\u7528\u4ee4\u724c\u4ee3\u7406\u56ae\u61c9\u7528\u7684\u5176\u4ed6\u90e8\u5206\u7c3d\u767c\u77ed\u671f\u6709\u6548\u7684\u670d\u52d9\u8cec\u865f\u3002\n\u5982\u9700\u5275\u5efa\u77ed\u671f\u6709\u6548\u6191\u64da\u65b9\u9762\u7684\u5e6b\u52a9\uff0c\u8acb\u53c3\u95b1 [\u7232\u670d\u52d9\u8cec\u865f\u5275\u5efa\u77ed\u671f\u6709\u6548\u6191\u64da](https://cloud.google.com/iam/docs/create-short-lived-credentials-direct?hl=zh-cn) \u3002\n### \u4f7f\u7528\u6191\u64da\u8a2a\u554f\u908a\u754c\u4f86\u7e2e\u5c0f\u8a2a\u554f\u4ee4\u724c\u6b0a\u9650\u7bc4\u570d\nGoogle \u8a2a\u554f\u4ee4\u724c\u662f\u4e0d\u8a18\u540d\u4ee4\u724c\uff0c\u9019\u610f\u5473\u7740\u5176\u4f7f\u7528\u8207\u4efb\u4f55\u7279\u5b9a\u61c9\u7528\u90fd\u7121\u95dc\u3002\u5982\u679c\u60a8\u7684\u61c9\u7528\u5c07\u8a2a\u554f\u4ee4\u724c\u50b3\u905e\u7d66\u5176\u4ed6\u61c9\u7528\uff0c\u5247\u5176\u4ed6\u61c9\u7528\u53ef\u4ee5\u6309\u7167\u8207\u60a8\u7684\u61c9\u7528\u76f8\u540c\u7684\u65b9\u5f0f\u4f86\u4f7f\u7528\u4ee4\u724c\u3002\u540c\u6a23\uff0c\u5982\u679c\u8a2a\u554f\u4ee4\u724c\u6cc4\u9732\u7d66\u4e0d\u6cd5\u5206\u5b50\uff0c\u5247\u4ed6\u5011\u53ef\u4ee5\u4f7f\u7528\u8a72\u4ee4\u724c\u4f86\u7372\u53d6\u8a2a\u554f\u6b0a\u9650\u3002\n\u7531\u65bc\u8a2a\u554f\u4ee4\u724c\u662f\u4e0d\u8a18\u540d\u4ee4\u724c\uff0c\u56e0\u6b64\u60a8\u5fc5\u9808\u9632\u6b62\u5b83\u5011\u6cc4\u9732\u6216\u986f\u793a\u7d66\u672a\u7d93\u6388\u6b0a\u65b9\u3002\u60a8\u53ef\u4ee5\u9650\u5236\u6cc4\u9732\u7684\u8a2a\u554f\u4ee4\u724c\u6388\u4e88\u8a2a\u554f\u6b0a\u9650\u7684\u8cc7\u6e90\uff0c\u5f9e\u800c\u9650\u5236\u8a72\u6cc4\u9732\u7684\u8a2a\u554f\u4ee4\u724c\u53ef\u80fd\u9020\u6210\u7684\u6f5b\u5728\u640d\u5bb3\u3002\u6b64\u904e\u7a0b\u7a31\u7232\u7e2e\u5c0f\u6b0a\u9650\u7bc4\u570d\u3002\n\u6bcf\u7576\u60a8\u5c07\u8a2a\u554f\u4ee4\u724c\u50b3\u905e\u7d66\u5176\u4ed6\u61c9\u7528\u6216\u60a8\u7684\u61c9\u7528\u7684\u4e0d\u540c\u7d44\u4ef6\u6642\uff0c\u4f7f\u7528 [\u6191\u64da\u8a2a\u554f\u908a\u754c](https://cloud.google.com/iam/docs/downscoping-short-lived-credentials?hl=zh-cn) \u53ef\u7e2e\u5c0f\u8a2a\u554f\u4ee4\u724c\u6b0a\u9650\u7bc4\u570d\u3002\u8a2d\u7f6e\u8a2a\u554f\u908a\u754c\uff0c\u4ee5\u4fbf\u4ee4\u724c\u80fd\u5920\u6388\u4e88\u8db3\u5920\u7684\u5c0d\u6240\u9700\u8cc7\u6e90\u7684\u8a2a\u554f\u6b0a\u9650\uff0c\u4f46\u4e0d\u80fd\u6388\u4e88\u66f4\u591a\u3002\n**\u6ce8\u610f** \uff1a\u50c5 Cloud Storage \u652f\u6301\u7e2e\u5c0f\u6b0a\u9650\u7bc4\u570d\u529f\u80fd\u3002\n### \u4f7f\u7528\u89d2\u8272\u5efa\u8b70\u4f86\u78ba\u5b9a\u672a\u4f7f\u7528\u7684\u6b0a\u9650\n\u9996\u6b21\u90e8\u7f72\u61c9\u7528\u6642\uff0c\u60a8\u53ef\u80fd\u4e0d\u78ba\u5b9a\u8a72\u61c9\u7528\u5be6\u969b\u9700\u8981\u7684\u89d2\u8272\u548c\u6b0a\u9650\u3002\u56e0\u6b64\uff0c\u60a8\u7232\u8a72\u61c9\u7528\u7684\u670d\u52d9\u8cec\u865f\u6388\u4e88\u7684\u6b0a\u9650\u53ef\u80fd\u5728\u6578\u91cf\u4e0a\u6703\u8d85\u51fa\u5176\u5be6\u969b\u9700\u8981\u7684\u6b0a\u9650\u3002\n\u540c\u6a23\uff0c\u61c9\u7528\u7684\u8a2a\u554f\u6b0a\u9650\u8981\u6c42\u53ef\u80fd\u6703\u96a8\u7740\u6642\u9593\u7684\u63a8\u79fb\u800c\u8b8a\u5316\uff0c\u4e26\u4e14\u60a8\u53ef\u80fd\u4e0d\u9700\u8981\u6700\u521d\u6388\u4e88\u7684\u67d0\u4e9b\u89d2\u8272\u548c\u6b0a\u9650\u3002\n\u4f7f\u7528 [\u89d2\u8272\u5efa\u8b70](https://cloud.google.com/policy-intelligence/docs/role-recommendations-overview?hl=zh-cn) \u4f86\u78ba\u5b9a\u61c9\u7528\u5be6\u969b\u4f7f\u7528\u7684\u6b0a\u9650\u4ee5\u53ca\u53ef\u80fd\u672a\u4f7f\u7528\u7684\u6b0a\u9650\u3002\u8abf\u6574\u53d7\u5f71\u97ff\u8cc7\u6e90\u7684\u5141\u8a31\u653f\u7b56\uff0c\u4ee5\u78ba\u4fdd\u50c5\u6388\u4e88\u61c9\u7528\u5be6\u969b\u9700\u8981\u7684\u8a2a\u554f\u6b0a\u9650\u3002\n### \u4f7f\u7528\u6a6b\u5411\u79fb\u52d5\u6578\u64da\u5206\u6790\u4f86\u9650\u5236\u6a6b\u5411\u79fb\u52d5\n\u6a6b\u5411\u79fb\u52d5\u662f\u6307\u4e00\u500b\u9805\u76ee\u4e2d\u7684\u670d\u52d9\u8cec\u865f\u6709\u6b0a\u6a21\u64ec\u53e6\u4e00\u500b\u9805\u76ee\u4e2d\u7684\u670d\u52d9\u8cec\u865f\u3002\u4f8b\u5982\uff0c\u670d\u52d9\u8cec\u865f\u53ef\u80fd\u662f\u5728\u9805\u76ee A \u4e2d\u5275\u5efa\u7684\uff0c\u4f46\u5177\u6709\u5728\u9805\u76ee B \u4e2d\u6a21\u64ec\u670d\u52d9\u8cec\u865f\u7684\u6b0a\u9650\u3002\n\u9019\u4e9b\u6b0a\u9650\u53ef\u80fd\u5c0e\u81f4\u9805\u76ee\u4e4b\u9593\u767c\u751f\u4e00\u7cfb\u5217\u6a21\u64ec\uff0c\u9019\u4e9b\u6a21\u64ec\u6703\u7232\u4e3b\u8cec\u865f\u6388\u4e88\u5c0d\u8cc7\u6e90\u7684\u610f\u5916\u8a2a\u554f\u6b0a\u9650\u3002\u4f8b\u5982\uff0c\u4e3b\u8cec\u865f\u53ef\u4ee5\u6a21\u64ec\u9805\u76ee A \u4e2d\u7684\u670d\u52d9\u8cec\u865f\uff0c\u7136\u5f8c\u4f7f\u7528\u8a72\u670d\u52d9\u8cec\u865f\u4f86\u6a21\u64ec\u9805\u76ee B \u4e2d\u7684\u670d\u52d9\u8cec\u865f\u3002\u5982\u679c\u9805\u76ee B \u4e2d\u7684\u670d\u52d9\u8cec\u865f\u6709\u6b0a\u6a21\u64ec\u7d44\u7e54\u4e2d\u5176\u4ed6\u9805\u76ee\u4e2d\u7684\u5176\u4ed6\u670d\u52d9\u8cec\u865f\uff0c\u5247\u4e3b\u8cec\u865f\u53ef\u4ee5\u7e7c\u7e8c\u4f7f\u7528\u670d\u52d9\u8cec\u865f\u6a21\u64ec\u5f9e\u9805\u76ee\u79fb\u52d5\u5230\u9805\u76ee\uff0c\u5f9e\u800c\u5728\u79fb\u52d5\u6642\u7372\u53d6\u6b0a\u9650\u3002\n**\u6ce8\u610f** \uff1a\u5c07\u670d\u52d9\u8cec\u865f\u5f9e\u4e00\u500b\u9805\u76ee\u95dc\u806f\u5230\u53e6\u4e00\u500b\u9805\u76ee\u4e2d\u7684\u8cc7\u6e90\u4e0d\u6703 \u9020\u6210\u6a6b\u5411\u79fb\u52d5\uff0c\u56e0\u7232\u5b83\u4e0d\u6703\u7232\u8a72\u670d\u52d9\u8cec\u865f\u6388\u4e88\u4efb\u4f55\u6a21\u64ec\u6b0a\u9650\u3002\nRecommender \u63d0\u4f9b\u4e86 [\u6a6b\u5411\u79fb\u52d5\u6578\u64da\u5206\u6790](https://cloud.google.com/policy-intelligence/docs/role-recommendations-overview?hl=zh-cn#lateral-movement-insights) \uff0c\u53ef\u5e6b\u52a9\u60a8\u7de9\u89e3\u6b64\u554f\u984c\u3002\u6a6b\u5411\u79fb\u52d5\u6578\u64da\u5206\u6790\u8b58\u5225\u5141\u8a31\u4e00\u500b\u9805\u76ee\u4e2d\u7684\u670d\u52d9\u8cec\u865f\u6a21\u64ec\u53e6\u4e00\u500b\u9805\u76ee\u4e2d\u7684\u670d\u52d9\u8cec\u865f\u7684\u89d2\u8272\u3002\u5982\u9700\u77ad\u89e3\u5982\u4f55\u76f4\u63a5\u67e5\u770b\u548c\u7ba1\u7406\u6a6b\u5411\u79fb\u52d5\u6578\u64da\u5206\u6790\uff0c\u8acb\u53c3\u95b1 [\u7ba1\u7406\u6a6b\u5411\u79fb\u52d5\u6578\u64da\u5206\u6790](https://cloud.google.com/policy-intelligence/docs/lateral-movement-insights?hl=zh-cn) \u3002\n\u4e00\u4e9b\u6a6b\u5411\u79fb\u52d5\u6578\u64da\u5206\u6790\u8207\u89d2\u8272\u5efa\u8b70\u76f8\u95dc\u806f\u3002\u60a8\u53ef\u4ee5\u61c9\u7528\u9019\u4e9b\u5efa\u8b70\uff0c\u4ee5\u6e1b\u5c11\u9805\u76ee\u9593\u7684\u6a6b\u5411\u79fb\u52d5\u3002\u5982\u9700\u77ad\u89e3\u5177\u9ad4\u65b9\u6cd5\uff0c\u8acb\u53c3\u95b1 [\u67e5\u770b\u548c\u61c9\u7528\u5efa\u8b70](https://cloud.google.com/policy-intelligence/docs/review-apply-role-recommendations?hl=zh-cn) \u3002\n## \u9632\u7bc4\u63d0\u6b0a\u5a01\u8105\n\u672a\u88ab\u6388\u4e88\u4efb\u4f55\u89d2\u8272\u3001\u7121\u6cd5\u8a2a\u554f\u4efb\u4f55\u8cc7\u6e90\u4e14\u672a [\u8207\u4efb\u4f55\u9632\u706b\u7246\u898f\u5247\u95dc\u806f](https://cloud.google.com/vpc/docs/firewalls?hl=zh-cn#serviceaccounts) \u7684\u670d\u52d9\u8cec\u865f\u901a\u5e38\u50f9\u503c\u6709\u9650\u3002\u7232\u670d\u52d9\u8cec\u865f\u6388\u4e88\u5c0d\u8cc7\u6e90\u7684\u8a2a\u554f\u6b0a\u9650\u4e4b\u5f8c\uff0c\u670d\u52d9\u8cec\u865f\u7684\u50f9\u503c\u6703\u63d0\u9ad8\uff1a\u8a72\u670d\u52d9\u8cec\u865f\u5c0d\u60a8\u66f4\u7232\u6709\u7528\uff0c\u4f46\u5b83\u4e5f\u6703\u66f4\u5bb9\u6613\u6210\u7232\u63d0\u5347\u6b0a\u9650\u653b\u64ca\u7684\u76ee\u6a19\u3002\n\u4f8b\u5982\uff0c\u5047\u8a2d\u4e00\u500b\u5c0d\u5305\u542b\u654f\u611f\u4fe1\u606f\u7684 Cloud Storage \u5b58\u5132\u6876\u5177\u6709\u5b8c\u6574\u8a2a\u554f\u6b0a\u9650\u7684\u670d\u52d9\u8cec\u865f\u3002\u5728\u9019\u7a2e\u60c5\u6cc1\u4e0b\uff0c\u8a72\u670d\u52d9\u8cec\u865f\u5be6\u969b\u4e0a\u8207 Cloud Storage \u5b58\u5132\u6876\u672c\u8eab\u4e00\u6a23\u91cd\u8981\uff1a\u4e0d\u6cd5\u5206\u5b50\u53ef\u80fd\u6703\u5617\u8a66\u63a7\u5236\u8a72\u670d\u52d9\u8cec\u865f\uff0c\u800c\u4e0d\u662f\u8a66\u5716\u76f4\u63a5\u8a2a\u554f\u5b58\u5132\u6876\u3002\u5982\u679c\u8a72\u5617\u8a66\u6210\u529f\uff0c\u4e0d\u6cd5\u5206\u5b50\u53ef\u80fd\u6703\u901a\u904e\u6a21\u64ec\u8a72\u670d\u52d9\u8cec\u865f\u4f86\u63d0\u5347\u5176\u6b0a\u9650\uff0c\u9032\u800c\u80fd\u5920\u8a2a\u554f\u5b58\u5132\u6876\u4e2d\u7684\u654f\u611f\u4fe1\u606f\u3002\n\u6d89\u53ca\u670d\u52d9\u8cec\u865f\u7684\u63d0\u5347\u6b0a\u9650\u65b9\u6cd5\u901a\u5e38\u5206\u7232\u4ee5\u4e0b\u5e7e\u500b\u985e\u5225\uff1a\n- **\u4ee5\u670d\u52d9\u8cec\u865f\u8eab\u4efd\u9032\u884c\u8eab\u4efd\u9a57\u8b49** \uff1a\u60a8\u53ef\u80fd\u7121\u610f\u4e2d\u5411\u7528\u6236\u6388\u4e88 [\u6a21\u64ec](https://cloud.google.com/iam/docs/service-account-impersonation?hl=zh-cn) \u670d\u52d9\u8cec\u865f\u6216\u7232\u670d\u52d9\u8cec\u865f [\u5275\u5efa\u670d\u52d9\u8cec\u865f\u5bc6\u9470](https://cloud.google.com/iam/docs/creating-managing-service-account-keys?hl=zh-cn) \u7684\u6b0a\u9650\u3002\u5982\u679c\u670d\u52d9\u8cec\u865f\u6bd4\u7528\u6236\u672c\u8eab\u7684\u6b0a\u9650\u66f4\u9ad8\uff0c\u5247\u7528\u6236\u53ef\u4ee5\u4ee5\u670d\u52d9\u8cec\u865f\u7684\u8eab\u4efd\u9032\u884c\u8eab\u4efd\u9a57\u8b49\uff0c\u4ee5\u63d0\u5347\u5176\u6b0a\u9650\u4e26\u7372\u53d6\u7528\u6236\u4ee5\u5176\u4ed6\u65b9\u5f0f\u7121\u6cd5\u8a2a\u554f\u7684\u8cc7\u6e90\u7684\u8a2a\u554f\u6b0a\u9650\u3002\n- **\u4f7f\u7528\u5177\u6709\u95dc\u806f\u670d\u52d9\u8cec\u865f\u7684\u8cc7\u6e90** \uff1a\u5982\u679c\u7528\u6236\u6709\u6b0a\u8a2a\u554f\u548c\u4fee\u6539\u5df2\u95dc\u806f\u670d\u52d9\u8cec\u865f\u7684 CI/CD \u6d41\u6c34\u7dda\u3001\u865b\u64ec\u6a5f\u5be6\u4f8b\u6216\u5176\u4ed6\u81ea\u52d5\u5316\u7cfb\u7d71\uff0c\u5247\u4ed6\u5011\u6216\u8a31\u53ef\u4ee5\u4f7f\u7528\u9019\u4e9b\u8cc7\u6e90\u95dc\u806f\u7684\u670d\u52d9\u8cec\u865f\u57f7\u884c\u64cd\u4f5c\u3002\u56e0\u6b64\uff0c\u5373\u4f7f\u4ed6\u5011\u7121\u6b0a\u6a21\u64ec\u670d\u52d9\u8cec\u865f\uff0c\u4ed6\u5011\u4ecd\u7136\u53ef\u4ee5\u4f7f\u7528\u670d\u52d9\u8cec\u865f\u7684\u6b0a\u9650\u4f86\u57f7\u884c\u4ed6\u5011\u7121\u6b0a\u57f7\u884c\u7684\u64cd\u4f5c\u3002\u4f8b\u5982\uff0c\u5982\u679c\u7528\u6236\u5177\u6709\u5c0d Compute Engine \u865b\u64ec\u6a5f\u5be6\u4f8b\u7684 SSH \u8a2a\u554f\u6b0a\u9650\uff0c\u5247\u53ef\u4ee5\u5c0d\u5be6\u4f8b\u904b\u884c\u4ee3\u78bc\uff0c\u4ee5\u8a2a\u554f\u5be6\u4f8b\u7684\u95dc\u806f\u670d\u52d9\u8cec\u865f\u53ef\u4ee5\u8a2a\u554f\u7684\u4efb\u4f55\u8cc7\u6e90\u3002\n- **\u5141\u8a31\u653f\u7b56\u3001\u7fa3\u7d44\u6216\u81ea\u5b9a\u7fa9\u89d2\u8272\u4fee\u6539** \uff1a\u7121\u6b0a\u8a2a\u554f\u7279\u6b0a\u670d\u52d9\u8cec\u865f\u7684\u7528\u6236\u53ef\u80fd\u4ecd\u6709\u6b0a\u4fee\u6539\u670d\u52d9\u8cec\u865f\u3001\u6240\u5c6c\u7684 Google Cloud \u9805\u76ee\u6216\u6587\u4ef6\u593e\u7684\u5141\u8a31\u653f\u7b56\u3002\u7136\u5f8c\uff0c\u7528\u6236\u53ef\u4ee5\u64f4\u5c55\u5176\u4e2d\u4e00\u500b\u5141\u8a31\u653f\u7b56\uff0c\u4ee5\uff08\u76f4\u63a5\u6216\u9593\u63a5\uff09\u5411\u81ea\u5df1\u6388\u4e88\u4ee5\u670d\u52d9\u8cec\u865f\u8eab\u4efd\u9032\u884c\u8eab\u4efd\u9a57\u8b49\u7684\u6b0a\u9650\u3002\n\u4ee5\u4e0b\u90e8\u5206\u4ecb\u7d39\u4e86\u4fdd\u8b77\u670d\u52d9\u8cec\u865f\u514d\u906d\u63d0\u5347\u6b0a\u9650\u5a01\u8105\u7684\u6700\u4f73\u505a\u6cd5\u3002\n**\u6700\u4f73\u505a\u6cd5** \uff1a [\u907f\u514d\u8b93\u7528\u6236\u6a21\u64ec\u6b0a\u9650\u9ad8\u65bc\u7528\u6236\u81ea\u8eab\u7684\u670d\u52d9\u8cec\u865f](#impersonate-privileged) \u3002 [\u907f\u514d\u8b93\u7528\u6236\u66f4\u6539\u6b0a\u9650\u9ad8\u65bc\u7528\u6236\u81ea\u8eab\u7684\u670d\u52d9\u8cec\u865f\u7684\u5141\u8a31\u653f\u7b56](#modify-privileged) \u3002 [\u4e0d\u5141\u8a31\u7528\u6236\u5275\u5efa\u6216\u4e0a\u50b3\u670d\u52d9\u8cec\u865f\u5bc6\u9470](#service-account-keys) \u3002 [\u8acb\u52ff\u5728 Google Cloud \u9805\u76ee\u6216\u6587\u4ef6\u593e\u7d1a\u5c64\u5411\u670d\u52d9\u8cec\u865f\u6388\u4e88\u8a2a\u554f\u6b0a\u9650](#project-folder-grants) \u3002 [\u8acb\u52ff\u5f9e\u95dc\u806f\u4e86\u7279\u6b0a\u670d\u52d9\u8cec\u865f\u7684\u8a08\u7b97\u8cc7\u6e90\u4e0a\u53d7\u4fdd\u8b77\u7a0b\u5ea6\u8f03\u4f4e\u7684\u4f86\u6e90\u904b\u884c\u4ee3\u78bc](#less-protected-sources) \u3002 [\u9650\u5236\u5c0d\u95dc\u806f\u4e86\u7279\u6b0a\u670d\u52d9\u8cec\u865f\u7684\u865b\u64ec\u6a5f\u7684 shell \u8a2a\u554f\u6b0a\u9650](#shell-access) \u3002 [\u5c07\u5143\u6578\u64da\u670d\u52d9\u5668\u8a2a\u554f\u6b0a\u9650\u50c5\u9650\u65bc\u6240\u9078\u7528\u6236\u548c\u9032\u7a0b](#metadata-server-access) \u3002\n### \u907f\u514d\u8b93\u7528\u6236\u4ee5\u6b0a\u9650\u9ad8\u65bc\u7528\u6236\u81ea\u8eab\u7684\u670d\u52d9\u8cec\u865f\u8eab\u4efd\u9032\u884c\u8eab\u4efd\u9a57\u8b49\n\u901a\u904e\u6a21\u64ec\u670d\u52d9\u8cec\u865f\uff0c\u7528\u6236\u53ef\u4ee5\u7372\u53d6\u5c0d\u670d\u52d9\u8cec\u865f\u53ef\u8a2a\u554f\u7684\u90e8\u5206\u6216\u5168\u90e8\u8cc7\u6e90\u7684\u8a2a\u554f\u6b0a\u9650\u3002\u5982\u679c\u670d\u52d9\u8cec\u865f\u5177\u6709\u7684\u8a2a\u554f\u6b0a\u9650\u6bd4\u7528\u6236\u5ee3\u6cdb\uff0c\u5247\u670d\u52d9\u8cec\u865f\u7684\u6b0a\u9650\u5be6\u969b\u4e0a\u9ad8\u65bc\u7528\u6236\u3002\n\u6388\u4e88\u7528\u6236\u6a21\u64ec\u6b0a\u9650\u66f4\u9ad8\u7684\u670d\u52d9\u8cec\u865f\u7684\u6b0a\u9650\u662f\u4e00\u7a2e\u7279\u610f\u8b93\u7528\u6236\u63d0\u5347\u5176\u6b0a\u9650\u7684\u65b9\u5f0f\uff0c\u9019\u985e\u4f3c\u65bc\u5728 Linux \u4e0a\u4f7f\u7528 `sudo` \u5de5\u5177\u6216\u5728 Windows \u4e0a\u4f7f\u7528\u9032\u7a0b\u63d0\u5347\u3002\u9664\u975e\u60a8\u9762\u5c0d\u5fc5\u9808\u81e8\u6642\u63d0\u5347\u6b0a\u9650\u7684\u60c5\u6cc1\uff0c\u5426\u5247\u6700\u597d\u907f\u514d\u8b93\u7528\u6236\u6a21\u64ec\u6b0a\u9650\u66f4\u9ad8\u7684\u670d\u52d9\u8cec\u865f\u3002\n\u7528\u6236\u9084\u53ef\u4ee5\u901a\u904e [\u5c07\u670d\u52d9\u8cec\u865f\u8207\u8cc7\u6e90\u95dc\u806f](https://cloud.google.com/iam/docs/attach-service-accounts?hl=zh-cn) \u4e26\u5728\u8a72\u8cc7\u6e90\u4e0a\u904b\u884c\u4ee3\u78bc\u4f86\u9593\u63a5\u7372\u53d6\u8a72\u670d\u52d9\u8cec\u865f\u7684\u6b0a\u9650\u3002\u4ee5\u9019\u7a2e\u65b9\u5f0f\u904b\u884c\u4ee3\u78bc\u4e0d\u662f\u670d\u52d9\u8cec\u865f\u6a21\u64ec\uff0c\u56e0\u7232\u5b83\u53ea\u6d89\u53ca\u4e00\u500b\u7d93\u904e\u8eab\u4efd\u9a57\u8b49\u7684\u8eab\u4efd\uff08\u670d\u52d9\u8cec\u865f\u7684\u8eab\u4efd\uff09\u3002\u4f46\u662f\uff0c\u5b83\u53ef\u4ee5\u7232\u7528\u6236\u5206\u914d\u4ed6\u5011\u4ee5\u5176\u4ed6\u65b9\u5f0f\u7121\u6cd5\u7372\u5f97\u7684\u8a2a\u554f\u6b0a\u9650\u3002\n\u4f7f\u7528\u6236\u80fd\u5920\u6a21\u64ec\u670d\u52d9\u8cec\u865f\u6216\u5c07\u670d\u52d9\u8cec\u865f\u8207\u8cc7\u6e90\u95dc\u806f\u7684\u6b0a\u9650\u5305\u62ec\uff1a\n- `iam.serviceAccounts.getAccessToken`\n- `iam.serviceAccounts.getOpenIdToken`\n- `iam.serviceAccounts.actAs`\n- `iam.serviceAccounts.implicitDelegation`\n- `iam.serviceAccounts.signBlob`\n- `iam.serviceAccounts.signJwt`\n- `iam.serviceAccountKeys.create`\n- `deploymentmanager.deployments.create`\n- `cloudbuild.builds.create`\n\u5177\u6709\u5176\u4e2d\u4e00\u4e9b\u6b0a\u9650\u7684\u89d2\u8272\u5305\u62ec\uff08\u4f46\u4e0d\u9650\u65bc\uff09\uff1a\n- Owner (`roles/owner`)\n- Editor (`roles/editor`)\n- Service Account User (`roles/iam.serviceAccountUser`)\n- Service Account Token Creator (`roles/iam.serviceAccountTokenCreator`)\n- Service Account Key Admin (`roles/iam.serviceAccountKeyAdmin`)\n- Service Account Admin (`roles/iam.serviceAccountAdmin`)\n- Workload Identity User (`roles/iam.workloadIdentityUser`)\n- Deployment Manager Editor (`roles/deploymentmanager.editor`)\n- Cloud Build Editor (`roles/cloudbuild.builds.editor`)\n\u5728\u5c07\u4e0a\u8ff0\u4efb\u4f55\u89d2\u8272\u5206\u914d\u7d66\u7528\u6236\u4e4b\u524d\uff0c\u8acb\u5148\u554f\u81ea\u5df1\uff1a\n- \u7528\u6236\u901a\u904e\u6a21\u64ec\u670d\u52d9\u8cec\u865f\u53ef\u4ee5\u7372\u53d6\u7576\u524d Google Cloud \u9805\u76ee\u5167\u90e8\u548c\u5916\u90e8\u7684\u54ea\u4e9b\u8cc7\u6e90\u7684\u8a2a\u554f\u6b0a\u9650\uff1f\n- \u6b64\u8a2a\u554f\u6b0a\u9650\u7d1a\u5225\u662f\u5426\u5408\u7406\uff1f\n- \u662f\u5426\u6709\u8db3\u5920\u7684\u4fdd\u8b77\u63aa\u65bd\u4f86\u63a7\u5236\u7528\u6236\u5728\u54ea\u4e9b\u60c5\u6cc1\u4e0b\u53ef\u4ee5\u6a21\u64ec\u670d\u52d9\u8cec\u865f\uff1f\n\u5982\u679c\u7121\u6cd5\u78ba\u8a8d\u6240\u6709\u554f\u984c\uff0c\u8acb\u52ff\u5206\u914d\u89d2\u8272\u3002\u800c\u662f\u61c9\u8003\u616e\u7232\u7528\u6236\u63d0\u4f9b\u5176\u4ed6\u6b0a\u9650\u8f03\u4f4e\u7684\u670d\u52d9\u8cec\u865f\u3002\n### \u907f\u514d\u8b93\u7528\u6236\u66f4\u6539\u6b0a\u9650\u66f4\u9ad8\u7684\u670d\u52d9\u8cec\u865f\u7684\u5141\u8a31\u653f\u7b56\n\u670d\u52d9\u8cec\u865f\u7684\u5141\u8a31\u653f\u7b56\u6703\u6355\u7372\u5141\u8a31\u4f7f\u7528\u6216\u6a21\u64ec\u670d\u52d9\u8cec\u865f\u7684\u7528\u6236\u3002\u64c1\u6709\u7279\u5b9a\u670d\u52d9\u8cec\u865f\u7684 `iam.serviceAccounts.setIamPolicy` \u6b0a\u9650\u7684\u7528\u6236\u53ef\u4ee5\u4fee\u6539\u6216\u64f4\u5c55\u5141\u8a31\u653f\u7b56\u3002\u5305\u542b\u8a72\u6b0a\u9650\u7684\u89d2\u8272\u5305\u62ec\uff1a\n- Owner (`roles/owner`)\n- Security Admin (`roles/iam.securityAdmin`)\n- Service Account Admin (`roles/iam.serviceAccountAdmin`)\n\u5177\u6709 `iam.serviceAccounts.setIamPolicy` \u6b0a\u9650\u7684\u89d2\u8272\u53ef\u8b93\u7528\u6236\u5b8c\u5168\u63a7\u5236\u670d\u52d9\u8cec\u865f\uff1a\n- \u8a72\u7528\u6236\u53ef\u4ee5\u6388\u4e88\u81ea\u5df1\u6a21\u64ec\u670d\u52d9\u8cec\u865f\u7684\u6b0a\u9650\uff0c\u9019\u6a23\u4fbf\u6709\u6b0a\u8a2a\u554f\u8207\u670d\u52d9\u8cec\u865f\u76f8\u540c\u7684\u8cc7\u6e90\u3002\n- \u8a72\u7528\u6236\u53ef\u4ee5\u5411\u5176\u4ed6\u7528\u6236\u6388\u4e88\u76f8\u540c\u6216\u985e\u4f3c\u7684\u5c0d\u8a72\u670d\u52d9\u8cec\u865f\u7684\u8a2a\u554f\u7d1a\u5225\uff1a\n\u5728\u5c07\u4e0a\u8ff0\u4efb\u4f55\u89d2\u8272\u5206\u914d\u7d66\u7528\u6236\u4e4b\u524d\uff0c\u8acb\u5148\u554f\u81ea\u5df1\u7528\u6236\u901a\u904e\u6a21\u64ec\u670d\u52d9\u8cec\u865f\u53ef\u4ee5\u7372\u53d6\u7576\u524d Google Cloud \u9805\u76ee\u5167\u90e8\u548c\u5916\u90e8\u7684\u54ea\u4e9b\u8cc7\u6e90\u7684\u8a2a\u554f\u6b0a\u9650\uff1f\u5982\u679c\u670d\u52d9\u8cec\u865f\u5177\u6709\u7684\u8a2a\u554f\u6b0a\u9650\u8d85\u51fa\u7528\u6236\uff0c\u8acb\u52ff\u5141\u8a31\u7528\u6236 [\u66f4\u6539\u670d\u52d9\u8cec\u865f\u7684\u5141\u8a31\u653f\u7b56](https://cloud.google.com/iam/docs/granting-changing-revoking-access?hl=zh-cn) \u3002\n### \u4e0d\u5141\u8a31\u7528\u6236\u5275\u5efa\u6216\u4e0a\u50b3\u670d\u52d9\u8cec\u865f\u5bc6\u9470\u3002\n\u85c9\u52a9\u670d\u52d9\u8cec\u865f\u5bc6\u9470 [](https://cloud.google.com/iam/docs/creating-managing-service-account-keys?hl=zh-cn) \uff0c\u61c9\u7528\u6216\u7528\u6236\u53ef\u4ee5\u4ee5\u670d\u52d9\u8cec\u865f\u7684\u8eab\u4efd\u9032\u884c\u8eab\u4efd\u9a57\u8b49\u3002\u8207\u5176\u4ed6\u5f62\u5f0f\u7684\u670d\u52d9\u8cec\u865f\u6a21\u64ec\u4e0d\u540c\uff0c\u4f7f\u7528\u670d\u52d9\u8cec\u865f\u5bc6\u9470\u4e0d\u9700\u8981\u4ee5\u524d\u4efb\u4f55\u5f62\u5f0f\u7684\u8eab\u4efd\u9a57\u8b49\uff0c\u5373\u64c1\u6709\u670d\u52d9\u8cec\u865f\u5bc6\u9470\u7684\u4efb\u4f55\u4eba\u90fd\u53ef\u4ee5\u4f7f\u7528\u8a72\u5bc6\u9470\u3002\n\u4f7f\u7528\u670d\u52d9\u8cec\u865f\u5bc6\u9470\u9032\u884c\u8eab\u4efd\u9a57\u8b49\u7684\u5be6\u969b\u6548\u679c\u8207\u670d\u52d9\u8cec\u865f\u6a21\u64ec\u7684\u6548\u679c\u985e\u4f3c\u3002\u5982\u679c\u7528\u6236\u6709\u6b0a\u8a2a\u554f\u670d\u52d9\u8cec\u865f\u5bc6\u9470\uff0c\u6216\u6709\u6b0a\u5275\u5efa\u65b0\u670d\u52d9\u8cec\u865f\u5bc6\u9470\uff0c\u5247\u8a72\u7528\u6236\u53ef\u4ee5\u4ee5\u670d\u52d9\u8cec\u865f\u7684\u8eab\u4efd\u9032\u884c\u8eab\u4efd\u9a57\u8b49\u4e26\u8a2a\u554f\u8a72\u670d\u52d9\u8cec\u865f\u53ef\u4ee5\u8a2a\u554f\u7684\u6240\u6709\u8cc7\u6e90\u3002\n[\u5275\u5efa](https://cloud.google.com/iam/docs/creating-managing-service-account-keys?hl=zh-cn#creating_service_account_keys) \u6216 [\u4e0a\u50b3](https://cloud.google.com/iam/docs/keys-upload?hl=zh-cn) \u670d\u52d9\u8cec\u865f\u5bc6\u9470\u9700\u8981 `iam.serviceAccountKeys.create` \u6b0a\u9650\uff0cService Account Key Admin ( `roles/iam.serviceAccountKeyAdmin` ) \u548c Service Account Key Editor ( `roles/editor` ) \u89d2\u8272\u5177\u6709\u6b64\u6b0a\u9650\u3002\n\u7232\u7528\u6236\u5206\u914d\u5305\u542b `iam.serviceAccountKeys.create` \u6b0a\u9650\u7684\u4efb\u4f55\u89d2\u8272\u4e4b\u524d\uff0c\u8acb\u8003\u616e\u9019\u6a23\u505a\u4e4b\u5f8c\u7528\u6236\u53ef\u4ee5\u901a\u904e\u6a21\u64ec\u670d\u52d9\u8cec\u865f\u4f86\u7372\u53d6\u7576\u524d Google Cloud \u9805\u76ee\u5167\u90e8\u548c\u5916\u90e8\u54ea\u4e9b\u8cc7\u6e90\u7684\u8a2a\u554f\u6b0a\u9650\u3002\u4e0d\u5141\u8a31\u7528\u6236\u7232\u6bd4\u5176\u64c1\u6709\u66f4\u591a\u6b0a\u9650\u7684\u670d\u52d9\u8cec\u865f\u5275\u5efa\u670d\u52d9\u8cec\u865f\u5bc6\u9470\u3002\n\u5982\u679c\u60a8\u7684 Google Cloud \u9805\u76ee\u5b8c\u5168\u4e0d\u9700\u8981\u670d\u52d9\u8cec\u865f\u5bc6\u9470\uff0c\u8acb\u5c0d Google Cloud \u9805\u76ee\u6216\u6240\u5c6c\u6587\u4ef6\u593e\u61c9\u7528 [\u505c\u7528\u670d\u52d9\u8cec\u865f\u5bc6\u9470\u5275\u5efa\u529f\u80fd](https://cloud.google.com/resource-manager/docs/organization-policy/restricting-service-accounts?hl=zh-cn#disable_service_account_key_creation) \u548c [\u505c\u7528\u670d\u52d9\u8cec\u865f\u5bc6\u9470\u4e0a\u50b3\u529f\u80fd](https://cloud.google.com/resource-manager/docs/organization-policy/restricting-service-accounts?hl=zh-cn#disable_service_account_key_upload) \u7d44\u7e54\u653f\u7b56\u9650\u5236\u689d\u4ef6\u3002\u9019\u4e9b\u9650\u5236\u689d\u4ef6\u6703\u963b\u6b62\u6240\u6709\u7528\u6236\u5275\u5efa\u548c\u4e0a\u50b3\u670d\u52d9\u8cec\u865f\u5bc6\u9470\uff0c\u5305\u62ec\u5177\u6709\u670d\u52d9\u8cec\u865f\u7684 `iam.serviceAccountKeys.create` \u6b0a\u9650\u7684\u7528\u6236\u3002\n### \u8acb\u52ff\u5728 Google Cloud \u9805\u76ee\u6216\u6587\u4ef6\u593e\u7d1a\u5c64\u5411\u670d\u52d9\u8cec\u865f\u6388\u4e88\u8a2a\u554f\u6b0a\u9650\n\u670d\u52d9\u8cec\u865f\u5c6c\u65bc\u8cc7\u6e90\uff0c\u662f [\u8cc7\u6e90\u5c64\u6b21\u7d50\u69cb](https://cloud.google.com/resource-manager/docs/cloud-platform-resource-hierarchy?hl=zh-cn) \u7684\u4e00\u90e8\u5206\u3002\u56e0\u6b64\uff0c\u60a8\u53ef\u4ee5\u5728\u4ee5\u4e0b\u4efb\u4f55\u7d1a\u5c64\u7ba1\u7406\u670d\u52d9\u8cec\u865f\u7684\u8a2a\u554f\u6b0a\u9650\uff1a\n- \u55ae\u500b\u670d\u52d9\u8cec\u865f\n- \u6240\u5c6c\u7684 Google Cloud \u9805\u76ee\n- Google Cloud \u9805\u76ee\u7956\u5148\u5be6\u9ad4\u4e2d\u7684\u6587\u4ef6\u593e\n- \u7d44\u7e54\u7bc0\u9ede\n\u5728 Google Cloud \u9805\u76ee\u7d1a\u5c64\u6216\u8cc7\u6e90\u5c64\u6b21\u7d50\u69cb\u7684\u66f4\u9ad8\u7d1a\u5c64\u7ba1\u7406\u8a2a\u554f\u6b0a\u9650\u6709\u52a9\u65bc\u6e1b\u5c11\u7ba1\u7406\u958b\u92b7\uff0c\u4f46\u4e5f\u53ef\u80fd\u6703\u5c0e\u81f4\u904e\u5ea6\u6388\u6b0a\u3002\u4f8b\u5982\uff0c\u5982\u679c\u60a8\u7232\u7528\u6236\u6388\u4e88 Google Cloud \u9805\u76ee\u4e2d\u7684 Service Account Token Creator \u89d2\u8272\uff0c\u5247\u7528\u6236\u53ef\u4ee5\u6a21\u64ec Google Cloud \u9805\u76ee\u4e2d\u7684\u4efb\u4f55\u670d\u52d9\u8cec\u865f\u3002\u80fd\u5920\u6a21\u64ec\u4efb\u4f55\u670d\u52d9\u8cec\u865f\u610f\u5473\u7740\u7528\u6236\u53ef\u80fd\u6703\u7372\u53d6\u9019\u4e9b\u670d\u52d9\u8cec\u865f\u53ef\u4ee5\u8a2a\u554f\u7684\u6240\u6709\u8cc7\u6e90\u7684\u8a2a\u554f\u6b0a\u9650\uff0c\u5305\u62ec\u8a72 Google Cloud \u9805\u76ee\u5916\u90e8\u7684\u8cc7\u6e90\u3002\n\u7232\u907f\u514d\u6b64\u985e\u904e\u5ea6\u6388\u6b0a\uff0c\u8acb\u52ff\u5728 Google Cloud \u9805\u76ee\u6216\u6587\u4ef6\u593e\u7d1a\u5c64\u7ba1\u7406\u670d\u52d9\u8cec\u865f\u7684\u8a2a\u554f\u6b0a\u9650\uff1b\u800c\u662f\u8981\u5206\u5225\u7ba1\u7406\u6bcf\u500b\u670d\u52d9\u8cec\u865f\u7684\u8a2a\u554f\u6b0a\u9650\u3002\n### \u8acb\u52ff\u5f9e\u95dc\u806f\u4e86\u7279\u6b0a\u670d\u52d9\u8cec\u865f\u7684\u8a08\u7b97\u8cc7\u6e90\u4e0a\u53d7\u4fdd\u8b77\u7a0b\u5ea6\u8f03\u4f4e\u7684\u4f86\u6e90\u904b\u884c\u4ee3\u78bc\n\u7576\u60a8\u5c07\u670d\u52d9\u8cec\u865f\u9644\u52a0\u5230\u8a08\u7b97\u8cc7\u6e90\uff08\u4f8b\u5982\u865b\u64ec\u6a5f\u5be6\u4f8b\u6216 Cloud Run \u61c9\u7528\uff09\u5f8c\uff0c\u5728\u8a72\u8cc7\u6e90\u4e0a\u904b\u884c\u7684\u9032\u7a0b\u53ef\u4ee5\u4f7f\u7528\u5143\u6578\u64da\u670d\u52d9\u5668\u4f86 [\u8acb\u6c42\u8a2a\u554f\u4ee4\u724c\u548c ID \u4ee4\u724c](https://cloud.google.com/compute/docs/storing-retrieving-metadata?hl=zh-cn#default) \u3002\u9019\u4e9b\u4ee4\u724c\u5141\u8a31\u9032\u7a0b\u4ee5\u670d\u52d9\u8cec\u865f\u8eab\u4efd\u9032\u884c\u8eab\u4efd\u9a57\u8b49\u4e26\u4ee3\u8868\u5176\u8a2a\u554f\u8cc7\u6e90\u3002\n\u9ed8\u8a8d\u60c5\u6cc1\u4e0b\uff0c\u4e26\u975e\u53ea\u6709\u7279\u5b9a\u9032\u7a0b\u6216\u7528\u6236\u624d\u80fd\u8a2a\u554f\u5143\u6578\u64da\u670d\u52d9\u5668\u3002\u76f8\u53cd\uff0c\u5728\u8a08\u7b97\u8cc7\u6e90\u4e0a\u57f7\u884c\u7684\u4efb\u4f55\u4ee3\u78bc\u90fd\u53ef\u4ee5\u8a2a\u554f\u5143\u6578\u64da\u670d\u52d9\u5668\u4e26\u7372\u53d6\u8a2a\u554f\u4ee4\u724c\u3002\u6b64\u985e\u4ee3\u78bc\u53ef\u80fd\u5305\u62ec\uff1a\n- \u61c9\u7528\u7684\u4ee3\u78bc\u3002\n- \u7531\u6700\u7d42\u7528\u6236\u63d0\u4ea4\u7684\u4ee3\u78bc\uff08\u5982\u679c\u60a8\u7684\u61c9\u7528\u5141\u8a31\u4efb\u4f55\u670d\u52d9\u5668\u7aef\u8173\u672c\u8a55\u4f30\uff09\u3002\n- \u5f9e\u9060\u7a0b\u6e90\u4ee3\u78bc\u5eab\u8b80\u53d6\u7684\u4ee3\u78bc\uff08\u5982\u679c\u8a08\u7b97\u8cc7\u6e90\u5c6c\u65bc CI/CD \u7cfb\u7d71\uff09\u3002\n- \u7531 Cloud Storage \u5b58\u5132\u6876\u63d0\u4f9b\u7684 [\u5553\u52d5\u548c\u95dc\u505c\u8173\u672c](https://cloud.google.com/compute/docs/startupscript?hl=zh-cn) \u3002\n- \u7531\u865b\u64ec\u6a5f\u7ba1\u7406\u5668\u5206\u914d\u7684 [\u5ba2\u6a5f\u653f\u7b56](https://cloud.google.com/compute/docs/os-config-management/create-guest-policy?hl=zh-cn) \u3002\n\u5982\u679c\u4ee3\u78bc\u662f\u7531\u7528\u6236\u63d0\u4ea4\u7684\uff0c\u6216\u8005\u662f\u5f9e\u9060\u7a0b\u5b58\u5132\u4f4d\u7f6e\u8b80\u53d6\u7684\uff0c\u5247\u60a8\u5fc5\u9808\u78ba\u4fdd\u5b83\u53ef\u4fe1\uff0c\u4e26\u4e14\u9060\u7a0b\u5b58\u5132\u4f4d\u7f6e\u81f3\u5c11\u8207\u95dc\u806f\u7684\u670d\u52d9\u8cec\u865f\u4e00\u6a23\u53d7\u4fdd\u8b77\u3002\u5982\u679c\u8207\u670d\u52d9\u8cec\u865f\u76f8\u6bd4\uff0c\u9060\u7a0b\u5b58\u5132\u4f4d\u7f6e\u53d7\u5230\u59a5\u5584\u4fdd\u8b77\u7684\u6548\u679c\u6b20\u4f73\uff0c\u5247\u4e0d\u6cd5\u5206\u5b50\u53ef\u80fd\u53ef\u4ee5\u63d0\u5347\u5176\u6b0a\u9650\u3002\u4e0d\u6cd5\u5206\u5b50\u53ef\u4ee5\u901a\u904e\u5c07\u4f7f\u7528\u670d\u52d9\u8cec\u865f\u6b0a\u9650\u7684\u60e1\u610f\u4ee3\u78bc\u6ce8\u5165\u5230\u8a72\u4f4d\u7f6e\u4f86\u5be6\u73fe\u6b64\u76ee\u7684\u3002\n### \u9650\u5236\u5c0d\u95dc\u806f\u4e86\u7279\u6b0a\u670d\u52d9\u8cec\u865f\u7684\u865b\u64ec\u6a5f\u7684 shell \u8a2a\u554f\u6b0a\u9650\n\u4e00\u4e9b\u8a08\u7b97\u8cc7\u6e90\u652f\u6301\u4ea4\u4e92\u5f0f\u8a2a\u554f\uff0c\u4e26\u4f7f\u7528\u6236\u80fd\u5920\u7372\u53d6\u5c0d\u7cfb\u7d71\u7684 shell \u8a2a\u554f\u6b0a\u9650\u3002\u4f8b\u5982\uff1a\n- Compute Engine \u53ef\u8b93\u60a8\u4f7f\u7528 SSH \u6216 RDP \u767b\u9304\u865b\u64ec\u6a5f\u5be6\u4f8b\u3002\n- Google Kubernetes Engine \u53ef\u8b93\u60a8\u4f7f\u7528 [kubectl exec](https://kubernetes.io/docs/tasks/debug/debug-application/get-shell-running-container/) \u5728 Kubernetes \u5bb9\u5668\u4e2d\u904b\u884c\u547d\u4ee4\u6216\u5553\u52d5 shell\u3002\n\u5982\u679c\u865b\u64ec\u6a5f\u5be6\u4f8b\u95dc\u806f\u4e86\u7279\u6b0a\u670d\u52d9\u8cec\u865f\uff0c\u5247\u4efb\u4f55\u5c0d\u7cfb\u7d71\u5177\u6709 shell \u8a2a\u554f\u6b0a\u9650\u7684\u7528\u6236\u90fd\u53ef\u4ee5\u4ee5\u8a72\u670d\u52d9\u8cec\u865f\u7684\u8eab\u4efd\u9032\u884c\u8eab\u4efd\u9a57\u8b49\u548c\u8a2a\u554f\u8cc7\u6e90\u3002\u7232\u9632\u6b62\u7528\u6236\u6feb\u7528\u6b64\u529f\u80fd\u4f86\u63d0\u5347\u5176\u6b0a\u9650\uff0c\u60a8\u5fc5\u9808\u78ba\u4fdd shell \u8a2a\u554f\u6b0a\u9650\u81f3\u5c11\u8207\u95dc\u806f\u7684\u670d\u52d9\u8cec\u865f\u4e00\u6a23\u53d7\u4fdd\u8b77\u3002\n\u5c0d\u65bc Linux \u5be6\u4f8b\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528 OS Login \u5f37\u5236 SSH \u8a2a\u554f\u6b0a\u9650\u6bd4\u5c0d\u95dc\u806f\u7684\u670d\u52d9\u8cec\u865f\u7684\u8a2a\u554f\u6b0a\u9650\u66f4\u5177\u9650\u5236\u6027\uff1a\u5982\u9700\u9023\u63a5\u5230\u5553\u7528\u4e86 OS Login \u7684\u865b\u64ec\u6a5f\u5be6\u4f8b\uff0c\u7528\u6236\u4e0d\u50c5\u5fc5\u9808 [\u6709\u6b0a\u4f7f\u7528 OS Login](https://cloud.google.com/compute/docs/instances/managing-instance-access?hl=zh-cn#configure_users) \uff0c\u800c\u4e14\u9084\u5fc5\u9808\u5177\u6709\u5c0d\u95dc\u806f\u7684\u670d\u52d9\u8cec\u865f\u7684 `iam.serviceAccounts.actAs` \u6b0a\u9650\u3002\n\u76f8\u540c\u7d1a\u5225\u7684\u8a2a\u554f\u6b0a\u9650\u63a7\u5236\u4e0d\u9069\u7528\u65bc\u4f7f\u7528\u57fa\u65bc\u5143\u6578\u64da\u7684\u5bc6\u9470\u7684\u865b\u64ec\u6a5f\u5be6\u4f8b\u6216 Windows \u5be6\u4f8b\uff1a\u5c07 [SSH \u5bc6\u9470\u767c\u4f48\u5230\u5143\u6578\u64da](https://cloud.google.com/compute/docs/instances/adding-removing-ssh-keys?hl=zh-cn) \u6216 [\u8acb\u6c42 Windows \u6191\u64da](https://cloud.google.com/compute/docs/instances/windows/creating-passwords-for-windows-instances?hl=zh-cn) \u9700\u8981\u865b\u64ec\u6a5f\u5be6\u4f8b\u5143\u6578\u64da\u7684\u8a2a\u554f\u6b0a\u9650\u548c\u95dc\u806f\u670d\u52d9\u8cec\u865f\u7684 `iam.serviceAccounts.actAs` \u6b0a\u9650\u3002\u4f46\u662f\uff0c\u767c\u4f48 SSH \u5bc6\u9470\u6216\u7372\u5f97 Windows \u6191\u64da\u5f8c\uff0c\u5f8c\u7e8c\u767b\u9304\u4e0d\u9700\u8981\u9032\u884c\u4efb\u4f55\u5176\u4ed6 IAM \u6b0a\u9650\u6aa2\u67e5\u3002\n\u540c\u6a23\uff0c\u5982\u679c\u865b\u64ec\u6a5f\u5be6\u4f8b\u4f7f\u7528\u81ea\u5b9a\u7fa9 Linux \u53ef\u63d2\u5165\u5f0f\u8eab\u4efd\u9a57\u8b49\u6a21\u584a\u9032\u884c\u8eab\u4efd\u9a57\u8b49\uff0c\u6216\u8005\u865b\u64ec\u6a5f\u5be6\u4f8b\u662f Active Directory \u57df\u7684\u6210\u54e1\uff0c\u5247\u7121\u6b0a\u4ee5\u670d\u52d9\u8cec\u865f\u8eab\u4efd\u9032\u884c\u8eab\u4efd\u9a57\u8b49\u7684\u7528\u6236\u53ef\u80fd\u6709\u6b0a\u767b\u9304\u3002\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [\u5728 Google Cloud \u4e0a\u904b\u884c Active Directory \u7684\u6700\u4f73\u505a\u6cd5](https://cloud.google.com/compute/docs/instances/windows/best-practices?hl=zh-cn#ad-interference) \u3002\n\u7279\u5225\u662f\u5c0d\u65bc\u4e0d\u4f7f\u7528 OS Login \u7684\u865b\u64ec\u6a5f\u5be6\u4f8b\uff0c\u8acb\u8003\u616e\u901a\u904e [Identity-Aware Proxy](https://cloud.google.com/iap/docs/using-tcp-forwarding?hl=zh-cn) \u63a7\u5236 shell \u8a2a\u554f\u6b0a\u9650\u3002\u50c5\u56ae\u61c9\u88ab\u5141\u8a31\u4ee5\u865b\u64ec\u6a5f\u5be6\u4f8b\u95dc\u806f\u7684\u670d\u52d9\u8cec\u865f\u8eab\u4efd\u9032\u884c\u8eab\u4efd\u9a57\u8b49\u7684\u7528\u6236\u6388\u4e88 IAP-Secured Tunnel User \u89d2\u8272 ( `roles/iap.tunnelResourceAccessor` )\u3002\n### \u5c07\u5143\u6578\u64da\u670d\u52d9\u5668\u8a2a\u554f\u6b0a\u9650\u50c5\u9650\u65bc\u6240\u9078\u7528\u6236\u548c\u9032\u7a0b\n\u5c07\u670d\u52d9\u8cec\u865f\u95dc\u806f\u5230\u865b\u64ec\u6a5f\u5be6\u4f8b\u5f8c\uff0c\u90e8\u7f72\u5728\u865b\u64ec\u6a5f\u4e0a\u7684\u5de5\u4f5c\u8ca0\u8f09\u53ef\u4ee5\u8a2a\u554f\u5143\u6578\u64da\u670d\u52d9\u5668\u4f86\u8acb\u6c42\u670d\u52d9\u8cec\u865f\u7684\u4ee4\u724c\u3002\u9ed8\u8a8d\u60c5\u6cc1\u4e0b\uff0c\u5c0d\u5143\u6578\u64da\u670d\u52d9\u5668\u7684\u8a2a\u554f\u6b0a\u9650\u4e0d\u50c5\u9650\u65bc\u865b\u64ec\u6a5f\u4e0a\u7684\u4efb\u4f55\u7279\u5b9a\u9032\u7a0b\u6216\u7528\u6236\uff1a\u5373\u4f7f\u662f\u4ee5\u4f4e\u6b0a\u9650\u7528\u6236\u8eab\u4efd\u904b\u884c\u7684\u9032\u7a0b\uff08\u4f8b\u5982\uff0cLinux \u4e0a\u7684 `nobody` \u6216 Windows \u4e0a\u7684 `LocalService` \uff09\uff0c\u4e5f\u53ef\u4ee5\u64c1\u6709\u5c0d\u5143\u6578\u64da\u670d\u52d9\u5668\u7684\u5b8c\u6574\u8a2a\u554f\u6b0a\u9650\uff0c\u4e26\u4e14\u53ef\u4ee5\u7372\u53d6\u670d\u52d9\u8cec\u865f\u7684\u4ee4\u724c\u3002\n\u5982\u9700\u5c07\u5143\u6578\u64da\u670d\u52d9\u5668\u8a2a\u554f\u6b0a\u9650\u50c5\u9650\u65bc\u7279\u5b9a\u7528\u6236\uff0c\u8acb\u914d\u7f6e\u5ba2\u6a5f\u64cd\u4f5c\u7cfb\u7d71\u7684\u4e3b\u6a5f\u9632\u706b\u7246\uff0c\u4ee5\u50c5\u5141\u8a31\u9019\u4e9b\u7528\u6236\u6253\u958b\u8207\u5143\u6578\u64da\u670d\u52d9\u5668\u7684\u51fa\u7ad9\u9023\u63a5\u3002\n\u5728 Linux \u4e0a\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528 `--uid-owner` \u548c `--gid-owner` \u9078\u9805\u4f86\u8a2d\u7f6e\u50c5\u61c9\u7528\u65bc\u7279\u5b9a\u7528\u6236\u6216\u7fa3\u7d44\u7684 `iptables` \u898f\u5247\u3002\u5728 Windows \u4e0a\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528 `Set-NetFirewallSecurityFilter` \u547d\u4ee4\u4f86\u81ea\u5b9a\u7fa9\u9632\u706b\u7246\u898f\u5247\uff0c\u4ee5\u5c07\u8a72\u898f\u5247\u61c9\u7528\u65bc\u9078\u5b9a\u7684\u7528\u6236\u6216\u7fa3\u7d44\u3002\n## \u9632\u7bc4\u4fe1\u606f\u6cc4\u9732\u5a01\u8105\n**\u6700\u4f73\u505a\u6cd5** \uff1a [\u907f\u514d\u5728\u670d\u52d9\u8cec\u865f\u96fb\u5b50\u90f5\u4ef6\u5730\u5740\u4e2d\u62ab\u9732\u6a5f\u5bc6\u4fe1\u606f](#email-address) \u3002\n### \u907f\u514d\u5728\u670d\u52d9\u8cec\u865f\u96fb\u5b50\u90f5\u4ef6\u5730\u5740\u4e2d\u62ab\u9732\u6a5f\u5bc6\u4fe1\u606f\n\u5982\u9700\u6388\u4e88\u670d\u52d9\u8cec\u865f\u5c0d\u53e6\u4e00\u500b Google Cloud \u9805\u76ee\u4e2d\u7684\u8cc7\u6e90\u7684\u8a2a\u554f\u6b0a\u9650\uff0c\u60a8\u53ef\u4ee5\u5411\u8a72\u8cc7\u6e90\u7684\u5141\u8a31\u653f\u7b56\u6dfb\u52a0\u89d2\u8272\u7d81\u5b9a\u3002\u8207\u8cc7\u6e90\u672c\u8eab\u4e00\u6a23\uff0c\u5141\u8a31\u653f\u7b56\u662f\u53e6\u4e00\u500b Google Cloud \u9805\u76ee\u7684\u4e00\u90e8\u5206\uff0c\u56e0\u6b64\u5176\u53ef\u898b\u6027\u4e5f\u7531\u53e6\u4e00\u500b Google Cloud \u9805\u76ee\u63a7\u5236\u3002\n\u67e5\u770b\u5141\u8a31\u653f\u7b56\u901a\u5e38\u4e0d\u88ab\u8a8d\u7232\u662f\u4e00\u7a2e\u7279\u6b0a\u64cd\u4f5c\u3002\u8a31\u591a\u89d2\u8272\u90fd\u5177\u6709\u6240\u9700\u7684 `*.getIamPolicy` \u6b0a\u9650\uff0c\u5305\u62ec\u57fa\u672c\u7684 Viewer \u89d2\u8272\u3002\n\u53ef\u4ee5\u67e5\u770b\u5141\u8a31\u653f\u7b56\u7684\u7528\u6236\u4e5f\u53ef\u4ee5\u67e5\u770b\u5df2\u88ab\u6388\u4e88\u8a72\u8cc7\u6e90\u8a2a\u554f\u6b0a\u9650\u7684\u4e3b\u8cec\u865f\u7684\u96fb\u5b50\u90f5\u4ef6\u5730\u5740\u3002\u5c0d\u65bc\u670d\u52d9\u8cec\u865f\uff0c\u96fb\u5b50\u90f5\u4ef6\u5730\u5740\u53ef\u5411\u4e0d\u6cd5\u5206\u5b50\u63d0\u4f9b\u63d0\u793a\u3002\n\u4f8b\u5982\uff0c\u5141\u8a31\u653f\u7b56\u53ef\u80fd\u5305\u542b\u91dd\u5c0d\u96fb\u5b50\u90f5\u4ef6\u5730\u5740\u7232 `jenkins@deployment-project-123.gserviceaccount.com` \u7684\u670d\u52d9\u8cec\u865f\u7684\u7d81\u5b9a\u3002\u5c0d\u65bc\u4e0d\u6cd5\u5206\u5b50\uff0c\u6b64\u96fb\u5b50\u90f5\u4ef6\u5730\u5740\u4e0d\u50c5\u6703\u986f\u793a ID \u7232 `deployment-project-123` \u7684 Google Cloud \u9805\u76ee\uff0c\u9084\u6703\u986f\u793a Google Cloud \u9805\u76ee\u904b\u884c Jenkins \u670d\u52d9\u5668\u3002\u9078\u64c7\u66f4\u901a\u7528\u7684\u540d\u7a31\uff08\u5982 `deployer@deployment-project-123.gserviceaccount.com` \uff09\uff0c\u60a8\u53ef\u4ee5\u907f\u514d\u62ab\u9732\u6709\u95dc `deployment-project-123` \u4e2d\u904b\u884c\u7684\u8edf\u4ef6\u985e\u578b\u7684\u4fe1\u606f\u3002\n\u5982\u679c\u60a8\u5411\u670d\u52d9\u8cec\u865f\u6388\u4e88\u8a2a\u554f\u63a7\u5236\u4e0d\u592a\u56b4\u683c\u7684 Google Cloud \u9805\u76ee\u4e2d\u7684\u8cc7\u6e90\uff08\u4f8b\u5982\u6c99\u76d2\u6216\u958b\u767c Google Cloud \u9805\u76ee\uff09\u7684\u8a2a\u554f\u6b0a\u9650\uff0c\u8acb\u78ba\u4fdd\u670d\u52d9\u8cec\u865f\u7684\u96fb\u5b50\u90f5\u4ef6\u5730\u5740\u4e0d\u6703\u62ab\u9732\u4efb\u4f55\u4fe1\u606f\u3002\u5c24\u5176\u662f\u8acb\u52ff\u62ab\u9732\u6a5f\u5bc6\u4fe1\u606f\u6216\u53ef\u80fd\u7232\u653b\u64ca\u8005\u63d0\u4f9b\u63d0\u793a\u7684\u4fe1\u606f\u3002\n## \u9632\u7bc4\u4e0d\u53ef\u5426\u8a8d\u6027\u5a01\u8105\n\u6bcf\u7576\u60a8\u767c\u73fe\u5f71\u97ff Google Cloud \u4e2d\u67d0\u9805\u8cc7\u6e90\u7684\u53ef\u7591\u6d3b\u52d5\u6642\uff0cCloud Audit Logs \u662f\u975e\u5e38\u91cd\u8981\u7684\u4fe1\u606f\u4f86\u6e90\uff0c\u53ef\u77ad\u89e3\u8a72\u6d3b\u52d5\u767c\u751f\u7684\u6642\u9593\u4ee5\u53ca\u53c3\u8207\u7684\u7528\u6236\u3002\n\u6bcf\u7576 Cloud Audit Logs \u6307\u793a\u670d\u52d9\u8cec\u865f\u5df2\u57f7\u884c\u67d0\u6d3b\u52d5\u6642\uff0c\u50c5\u6191\u6b64\u4fe1\u606f\u53ef\u80fd\u4e0d\u8db3\u4ee5\u91cd\u5efa\u5b8c\u6574\u7684\u4e8b\u4ef6\u93c8\uff1a\u60a8\u9084\u5fc5\u9808\u80fd\u5920\u4e86\u89e3\u54ea\u500b\u7528\u6236\u6216\u61c9\u7528\u5c0e\u81f4\u670d\u52d9\u8cec\u865f\u57f7\u884c\u6b64\u6d3b\u52d5\u3002\n\u6b64\u90e8\u5206\u5305\u542b\u6700\u4f73\u505a\u6cd5\uff0c\u53ef\u5e6b\u52a9\u60a8\u4fdd\u7559\u4e0d\u53ef\u5426\u7684\u5be9\u8988\u8ddf\u8e64\u8a18\u9304\u3002\n**\u6700\u4f73\u505a\u6cd5** \uff1a [\u50c5\u5728\u6c92\u6709\u53ef\u884c\u66ff\u4ee3\u65b9\u6848\u7684\u60c5\u6cc1\u4e0b\u4f7f\u7528\u670d\u52d9\u8cec\u865f\u5bc6\u9470](#key-non-repudiation) \u3002 [\u7232 IAM API \u5553\u7528\u6578\u64da\u8a2a\u554f\u65e5\u8a8c](#data-access-logs) \u3002 [\u78ba\u4fdd CI/CD \u6b77\u53f2\u8a18\u9304\u53ef\u8207 Cloud Audit Logs \u76f8\u95dc\u806f](#cicd-log-correlation) \u3002 [\u7232\u61c9\u7528\u7684\u55ae\u500b\u7528\u6236\u5275\u5efa\u81ea\u5b9a\u7fa9\u65e5\u8a8c\u689d\u76ee](#user-log-correlation) \u3002\n### \u53ea\u6709\u5728\u6c92\u6709\u53ef\u884c\u7684\u66ff\u4ee3\u65b9\u6848\u6642\uff0c\u624d\u4f7f\u7528\u670d\u52d9\u8cec\u865f\u5bc6\u9470\n\u5982\u679c\u60a8\u7121\u6cd5\u4f7f\u7528 [\u66f4\u5b89\u5168\u7684\u8eab\u4efd\u9a57\u8b49\u65b9\u6cd5](#choose-when-to-use) \uff0c\u5247\u53ef\u80fd\u9700\u8981\u7232\u61c9\u7528\u5275\u5efa\u670d\u52d9\u8cec\u865f\u5bc6\u9470\u3002\u4f46\u662f\uff0c\u4f7f\u7528\u670d\u52d9\u8cec\u865f\u5bc6\u9470\u9032\u884c\u8eab\u4efd\u9a57\u8b49\u6703\u7522\u751f\u4e0d\u53ef\u5426\u8a8d\u7684\u5a01\u8105\u3002Cloud Audit Logs \u6703\u5728\u670d\u52d9\u8cec\u865f\u4fee\u6539\u8cc7\u6e90\u6642\u5275\u5efa\u65e5\u8a8c\uff0c\u4f46\u5982\u679c\u8a72\u670d\u52d9\u8cec\u865f\u4f7f\u7528\u670d\u52d9\u8cec\u865f\u5bc6\u9470\u9032\u884c\u8eab\u4efd\u9a57\u8b49\uff0c\u5247\u6c92\u6709\u53ef\u9760\u7684\u65b9\u6cd5\u53ef\u4ee5\u77e5\u9053\u8ab0\u4f7f\u7528\u4e86\u5bc6\u9470\u3002\u76f8\u6bd4\u4e4b\u4e0b\uff0c\u901a\u904e [\u4f7f\u7528\u7528\u6236\u6191\u64da\u6a21\u64ec\u670d\u52d9\u8cec\u865f](https://cloud.google.com/iam/docs/audit-logging/examples-service-accounts?hl=zh-cn#auth-as-service-account) \u4f86\u4ee5\u670d\u52d9\u8cec\u865f\u8eab\u4efd\u9032\u884c\u8eab\u4efd\u9a57\u8b49\uff0c\u7cfb\u7d71\u6703\u8a18\u9304\u5145\u7576\u670d\u52d9\u8cec\u865f\u7684\u4e3b\u8cec\u865f\u3002\n\u6211\u5011\u5efa\u8b70\u901a\u904e\u5c07 [\u505c\u7528\u670d\u52d9\u8cec\u865f\u5bc6\u9470\u5275\u5efa](https://cloud.google.com/resource-manager/docs/organization-policy/restricting-service-accounts?hl=zh-cn#disable_service_account_key_creation) \u7d44\u7e54\u653f\u7b56\u9650\u5236\u689d\u4ef6\u61c9\u7528\u65bc Google Cloud \u9805\u76ee\u6216\u6240\u5c6c\u7684\u6587\u4ef6\u593e\uff0c\u9632\u6b62\u5275\u5efa\u670d\u52d9\u8cec\u865f\u5bc6\u9470\u3002\u5982\u679c\u5728\u4efb\u4f55 [\u5efa\u8b70\u7684\u66ff\u4ee3\u65b9\u6848](#choose-when-to-use) \u90fd\u7121\u6cd5\u8655\u7406\u7684\u5834\u666f\u4e0b\uff0c\u60a8\u5fc5\u9808\u4f7f\u7528\u670d\u52d9\u8cec\u865f\u5bc6\u9470\uff0c\u8acb\u7232\u653f\u7b56\u9650\u5236\u689d\u4ef6\u6388\u4e88\u4f8b\u5916\uff0c\u4f7f\u5176\u7bc4\u570d\u5118\u53ef\u80fd\u5177\u9ad4\uff0c\u4e26\u67e5\u770b [\u7ba1\u7406\u670d\u52d9\u8cec\u865f\u5bc6\u9470\u7684\u6700\u4f73\u505a\u6cd5](https://cloud.google.com/iam/docs/best-practices-for-managing-service-account-keys?hl=zh-cn) \u3002\n### \u7232 IAM API \u5553\u7528\u6578\u64da\u8a2a\u554f\u65e5\u8a8c\n\u7232\u4e86\u5e6b\u52a9\u60a8\u8b58\u5225\u548c\u4e86\u89e3\u670d\u52d9\u8cec\u865f\u6a21\u64ec\u5834\u666f\uff0cCloud Engine \u7b49\u670d\u52d9\u5728 Cloud Audit Logs \u4e2d\u5305\u542b `serviceAccountDelegationInfo` \u90e8\u5206\u3002\u672c\u90e8\u5206\u6307\u793a\u4e86 [\u670d\u52d9\u8cec\u865f\u662f\u5426\u88ab\u6a21\u64ec\u4ee5\u53ca\u88ab\u54ea\u500b\u7528\u6236\u6a21\u64ec](https://cloud.google.com/iam/docs/audit-logging/examples-service-accounts?hl=zh-cn#auth-short-lived-credentials) \u3002\n\u4e26\u975e\u6240\u6709\u670d\u52d9\u90fd\u5728\u5176 Cloud Audit Logs \u4e2d\u5305\u542b\u6a21\u64ec\u8a73\u7d30\u4fe1\u606f\u3002\u5982\u9700\u8a18\u9304\u6240\u6709\u6a21\u64ec\u4e8b\u4ef6\uff0c\u60a8\u9084\u5fc5\u9808\u7232\u4ee5\u4e0b API [\u5553\u7528\u6578\u64da\u8a2a\u554f\u65e5\u8a8c](https://cloud.google.com/logging/docs/audit/configure-data-access?hl=zh-cn) \uff1a\n- \u5305\u542b\u670d\u52d9\u8cec\u865f\u7684\u6240\u6709 Google Cloud \u9805\u76ee\u4e2d\u7684 **Identity and Access Management (IAM) API** \n- \u5305\u542b\u5de5\u4f5c\u8ca0\u8f09\u8eab\u4efd\u6c60\u7684\u6240\u6709 Google Cloud \u9805\u76ee\u4e2d\u7684 **Security Token Service API** \n\u5553\u7528\u9019\u4e9b\u65e5\u8a8c\uff0c\u53ef\u78ba\u4fdd\u6bcf\u6b21\u5728\u7528\u6236\u8acb\u6c42\u670d\u52d9\u8cec\u865f\u7684\u8a2a\u554f\u4ee4\u724c\u6216 ID \u4ee4\u724c\u6642\uff0c\u90fd\u6703\u5411 Cloud Audit Logs \u4e2d\u6dfb\u52a0\u4e00\u500b\u689d\u76ee\u3002\n### \u78ba\u4fdd CI/CD \u6b77\u53f2\u8a18\u9304\u53ef\u8207 Cloud Audit Logs \u76f8\u95dc\u806f\n\u5728\u6210\u529f\u9a57\u8b49\u4ee3\u78bc\u66f4\u6539\u4e26\u6279\u51c6\u90e8\u7f72\u5f8c\uff0cCI/CD \u7cfb\u7d71\u901a\u5e38\u6703\u4f7f\u7528\u670d\u52d9\u8cec\u865f\u57f7\u884c\u90e8\u7f72\u3002\u901a\u5e38\uff0cCI/CD \u7cfb\u7d71\u6703\u4fdd\u7559\u9032\u884c\u90e8\u7f72\u7684\u4e8b\u4ef6\u7684\u6b77\u53f2\u8a18\u9304\u3002\u6b64\u6b77\u53f2\u8a18\u9304\u53ef\u80fd\u5305\u542b\u76f8\u61c9\u4ee3\u78bc\u5be9\u8988\u3001\u63d0\u4ea4\u548c\u6d41\u6c34\u7dda\u904b\u884c\u7684 ID\uff0c\u4ee5\u53ca\u6709\u95dc\u90e8\u7f72\u6279\u51c6\u8005\u7684\u4fe1\u606f\u3002\n\u5982\u679c\u90e8\u7f72\u4fee\u6539\u4e86 Google Cloud \u4e2d\u7684\u4efb\u4f55\u8cc7\u6e90\uff0c\u5247\u76f8\u95dc\u8cc7\u6e90\u7684 [Cloud Audit Logs](https://cloud.google.com/logging/docs/audit?hl=zh-cn) \u6703\u8ddf\u8e64\u9019\u4e9b\u66f4\u6539\u3002Cloud Audit Logs \u5305\u542b\u6709\u95dc\u767c\u8d77\u66f4\u6539\u7684\u7528\u6236\u6216\u670d\u52d9\u8cec\u865f\u7684\u4fe1\u606f\u3002\u4f46\u662f\uff0c\u5728\u7531 CI/CD \u7cfb\u7d71\u89f8\u767c\u7684\u90e8\u7f72\u4e2d\uff0c\u670d\u52d9\u8cec\u865f\u672c\u8eab\u901a\u5e38\u4e0d\u8db3\u4ee5\u91cd\u5efa\u5f15\u8d77\u66f4\u6539\u7684\u6574\u500b\u4e8b\u4ef6\u93c8\u3002\n\u5982\u9700\u5728 CI/CD \u7cfb\u7d71\u548c Google Cloud \u4e2d\u5efa\u7acb\u4e00\u81f4\u7684\u5be9\u8988\u8ddf\u8e64\uff0c\u60a8\u5fc5\u9808\u78ba\u4fdd Cloud Audit Logs \u8a18\u9304\u53ef\u8207 CI/CD \u7cfb\u7d71\u6b77\u53f2\u8a18\u9304\u4e2d\u7684\u4e8b\u4ef6\u76f8\u95dc\u806f\u3002\u5982\u679c\u60a8\u5728 Cloud Audit Logs \u4e2d\u9047\u5230\u610f\u5916\u4e8b\u4ef6\uff0c\u5247\u53ef\u4ee5\u4f7f\u7528\u9019\u7a2e\u95dc\u806f\u6027\u4f86\u78ba\u5b9a\u66f4\u6539\u662f\u5426\u78ba\u5be6\u7531 CI/CD \u7cfb\u7d71\u57f7\u884c\u3001\u7232\u4f55\u57f7\u884c\u4ee5\u53ca\u7531\u8ab0\u6279\u51c6\u3002\n\u7528\u65bc\u5efa\u7acb Cloud Audit Logs \u8a18\u9304\u8207 CI/CD \u7cfb\u7d71\u6b77\u53f2\u8a18\u9304\u4e2d\u4e8b\u4ef6\u4e4b\u9593\u95dc\u806f\u7684\u65b9\u6cd5\u5305\u62ec\uff1a\n- \u8a18\u9304 CI/CD \u6d41\u6c34\u7dda\u6bcf\u6b21\u904b\u884c\u6642\u57f7\u884c\u7684 API \u8acb\u6c42\u3002\n- \u6bcf\u7576 API \u8fd4\u56de\u64cd\u4f5c ID \u6642\uff0c\u5728 CI/CD \u7cfb\u7d71\u65e5\u8a8c\u4e2d\u8a18\u9304\u8a72 ID\u3002\n- \u5411 API \u8acb\u6c42\u6dfb\u52a0 `X-Goog-Request-Reason` [HTTP \u6a19\u982d](https://cloud.google.com/apis/docs/system-parameters?hl=zh-cn#definitions) \u4e26\u50b3\u905e CI/CD \u6d41\u6c34\u7dda\u904b\u884c\u7684 ID\u3002\u5982\u679c\u60a8\u6307\u5b9a [\u8acb\u6c42\u539f\u56e0](https://registry.terraform.io/providers/hashicorp/google/latest/docs/guides/provider_reference#request_reason) \uff0cTerraform \u53ef\u4ee5\u81ea\u52d5\u6dfb\u52a0\u6b64\u6a19\u982d\u3002\u6216\u8005\uff0c\u5c07\u4fe1\u606f\u5d4c\u5165\u5230 `User-Agent` \u6a19\u982d\u4e2d\uff0c\u4ee5\u5c07\u5176\u6355\u7372\u5230 Cloud Audit Logs \u4e2d\u3002\n\u7232\u5e6b\u52a9\u78ba\u4fdd\u4e0d\u53ef\u5426\u8a8d\u6027\uff0c\u8acb\u914d\u7f6e\u65e5\u8a8c\u6587\u4ef6\u4e26\u63d0\u4ea4\u6b77\u53f2\u8a18\u9304\uff0c\u4f7f\u5176\u662f\u4e0d\u53ef\u8b8a\u7684\uff0c\u4e26\u4e14\u4e0d\u6cd5\u5206\u5b50\u7121\u6cd5\u8ffd\u6eaf\u6027\u5730\u96b1\u85cf\u5176\u8ddf\u8e64\u8a18\u9304\u3002\n### \u7232\u61c9\u7528\u7684\u55ae\u500b\u7528\u6236\u5275\u5efa\u81ea\u5b9a\u7fa9\u65e5\u8a8c\u689d\u76ee\n\u5c0d\u65bc\u7528\u6236\u4f7f\u7528\u81ea\u5b9a\u7fa9\u8eab\u4efd\u9a57\u8b49\u65b9\u6848\u9032\u884c\u8eab\u4efd\u9a57\u8b49\uff0c\u7136\u5f8c\u9593\u63a5\u8a2a\u554f Google Cloud \u61c9\u7528\u7684\u61c9\u7528\uff0c\u670d\u52d9\u8cec\u865f\u4e5f\u9069\u7528\u3002\u9019\u4e9b\u61c9\u7528\u53ef\u4ee5\u78ba\u8a8d\u7528\u6236\u5df2\u7d93\u904e\u8eab\u4efd\u9a57\u8b49\u548c\u6388\u6b0a\uff0c\u7136\u5f8c\u4f7f\u7528\u670d\u52d9\u8cec\u865f\u5411 Google Cloud \u670d\u52d9\u548c\u8cc7\u6e90\u9032\u884c\u8eab\u4efd\u9a57\u8b49\u3002\u4f46\u662f\uff0cCloud Audit Logs \u5c07\u8a18\u9304\u670d\u52d9\u8cec\u865f\u8a2a\u554f\u4e86\u8cc7\u6e90\uff0c\u800c\u4e0d\u662f\u54ea\u4f4d\u7528\u6236\u5728\u4f7f\u7528\u60a8\u7684\u61c9\u7528\u3002\n\u7232\u4e86\u5e6b\u52a9\u5c07\u8a2a\u554f\u8ffd\u6eaf\u5230\u7528\u6236\uff0c\u8acb\u8a2d\u8a08\u61c9\u7528\u908f\u8f2f\uff0c\u5728\u6bcf\u6b21\u7528\u6236\u8a2a\u554f\u8cc7\u6e90\u6642\u5beb\u5165\u81ea\u5b9a\u7fa9\u65e5\u8a8c\u689d\u76ee\uff0c\u4e26\u5c07\u81ea\u5b9a\u7fa9\u65e5\u8a8c\u689d\u76ee\u8207 Cloud Audit Logs \u95dc\u806f\u3002\n## \u5f8c\u7e8c\u6b65\u9a5f\n- \u77ad\u89e3 [\u7ba1\u7406\u670d\u52d9\u8cec\u865f\u5bc6\u9470\u7684\u6700\u4f73\u5be6\u8e10](https://cloud.google.com/iam/docs/best-practices-for-managing-service-account-keys?hl=zh-cn) \u3002\n- \u8acb\u53c3\u95b1\u6211\u5011\u7684 [\u5728\u90e8\u7f72\u6d41\u6c34\u7dda\u4e2d\u4f7f\u7528\u670d\u52d9\u8cec\u865f\u7684\u6700\u4f73\u5be6\u8e10](https://cloud.google.com/iam/docs/best-practices-for-using-service-accounts-in-deployment-pipelines?hl=zh-cn) \u3002\n- \u77ad\u89e3 [\u4f7f\u7528\u5de5\u4f5c\u8ca0\u8f09\u8eab\u4efd\u806f\u5408\u7684\u6700\u4f73\u5be6\u8e10](https://cloud.google.com/iam/docs/best-practices-for-using-workload-identity-federation?hl=zh-cn) \u3002", "guide": "IAM"}