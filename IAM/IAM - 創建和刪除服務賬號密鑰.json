{"title": "IAM - \u5275\u5efa\u548c\u522a\u9664\u670d\u52d9\u8cec\u865f\u5bc6\u9470", "url": "https://cloud.google.com/iam/docs/keys-create-delete?hl=zh-cn", "abstract": "# IAM - \u5275\u5efa\u548c\u522a\u9664\u670d\u52d9\u8cec\u865f\u5bc6\u9470\n\u672c\u9801\u9762\u4ecb\u7d39\u77ad\u5982\u4f55\u4f7f\u7528 Google Cloud \u63a7\u5236\u6aaf\u3001 [Google Cloud CLI](https://cloud.google.com/sdk/gcloud?hl=zh-cn) \u3001 [Identity and Access Management API](https://cloud.google.com/iam/docs/reference/rest?hl=zh-cn) \u6216\u67d0\u500b [Google Cloud \u5ba2\u6236\u7aef\u5eab](https://cloud.google.com/apis/docs/cloud-client-libraries?hl=zh-cn) \u4f86\u5275\u5efa\u548c\u522a\u9664\u670d\u52d9\u8cec\u865f\u5bc6\u9470\u3002\n**\u6ce8\u610f** \uff1a\u5982\u679c\u60a8\u9700\u8981\u5f9e Google Cloud \u5916\u90e8\uff08\u4f8b\u5982 Amazon Web Services (AWS) \u6216 Microsoft Azure\uff09\u904b\u884c\u7684\u5de5\u4f5c\u8ca0\u8f09\u8a2a\u554f\u8cc7\u6e90\uff0c\u8acb\u8003\u616e\u4f7f\u7528 [\u5de5\u4f5c\u8ca0\u8f09\u8eab\u4efd\u806f\u5408](https://cloud.google.com/iam/docs/workload-identity-federation?hl=zh-cn) \uff0c\u800c\u4e0d\u662f\u670d\u52d9\u8cec\u865f\u5bc6\u9470\u3002\u85c9\u52a9\u806f\u5408\uff0c\u60a8\u7684\u5de5\u4f5c\u8ca0\u8f09\u4fbf\u53ef\u4ee5\u4f7f\u7528\u77ed\u671f\u6709\u6548\u7684\u8a2a\u554f\u4ee4\u724c\u76f4\u63a5\u8a2a\u554f\u8cc7\u6e90\uff0c\u800c\u8207\u670d\u52d9\u8cec\u865f\u5bc6\u9470\u76f8\u95dc\u806f\u7684\u7dad\u8b77\u548c\u5b89\u5168\u8ca0\u64d4\u4e5f\u5f97\u4ee5\u6d88\u9664\u3002\n", "content": "## \u6e96\u5099\u5de5\u4f5c\n-   Titles in dynamic includes are not used anywhere, and we should avoid paying to translate them   \u5553\u7528 IAM API\u3002 [\u5553\u7528 API](https://console.cloud.google.com/flows/enableapi?apiid=iam.googleapis.com&%3Bredirect=https%3A%2F%2Fconsole.cloud.google.com&hl=zh-cn) \n- \u8a2d\u7f6e\u8eab\u4efd\u9a57\u8b49\u3002  Titles in dynamic includes are not used anywhere, and we should avoid paying to translate them   \u9078\u64c7\u6a19\u7c64\u9801\u4ee5\u77ad\u89e3\u60a8\u6253\u7b97\u5982\u4f55\u4f7f\u7528\u672c\u9801\u9762\u4e0a\u7684\u793a\u4f8b\uff1a\n\u7576\u60a8\u4f7f\u7528 Google Cloud \u63a7\u5236\u6aaf\u8a2a\u554f Google Cloud \u670d\u52d9\u548c API \u6642\uff0c\u7121\u9700\u8a2d\u7f6e\u8eab\u4efd\u9a57\u8b49\u3002\u60a8\u53ef\u4ee5\u5f9e\u4ee5\u4e0b\u4efb\u4e00\u958b\u767c\u74b0\u5883\u4f7f\u7528\u672c\u9801\u9762\u4e0a\u7684 gcloud CLI \u793a\u4f8b\uff1a- **Cloud Shell** \uff1a\u5982\u9700\u4f7f\u7528\u5df2\u8a2d\u7f6e gcloud CLI \u7684\u5728\u7dda\u7d42\u7aef\uff0c\u8acb\u6fc0\u6d3b Cloud Shell\u3002Cloud Shell \u6703\u8a71\u6703\u5728\u9801\u9762\u5e95\u90e8\u5553\u52d5\uff0c\u4e26\u986f\u793a\u547d\u4ee4\u884c\u63d0\u793a\u7b26\u3002\u8a72\u6703\u8a71\u53ef\u80fd\u9700\u8981\u5e7e\u79d2\u9418\u4f86\u5b8c\u6210\u521d\u59cb\u5316\u3002\n- **\u672c\u5730 shell** \uff1a\u5982\u9700\u5728\u672c\u5730\u958b\u767c\u74b0\u5883\u4e2d\u4f7f\u7528 gcloud CLI\uff0c\u8acb [\u5b89\u88dd](https://cloud.google.com/sdk/docs/install?hl=zh-cn) \u4e26 [\u521d\u59cb\u5316](https://cloud.google.com/sdk/docs/initializing?hl=zh-cn) gcloud CLI\u3002\n\u5982\u9700\u5f9e\u672c\u5730\u958b\u767c\u74b0\u5883\u4f7f\u7528\u672c\u9801\u9762\u4e0a\u7684 C++ \u793a\u4f8b\uff0c\u8acb\u5b89\u88dd\u4e26\u521d\u59cb\u5316 gcloud CLI\uff0c\u7136\u5f8c\u4f7f\u7528\u7528\u6236\u6191\u64da\u8a2d\u7f6e\u61c9\u7528\u9ed8\u8a8d\u6191\u64da\u3002- Titles in dynamic includes are not used anywhere, and we should avoid paying to translate them\n- [\u5b89\u88dd](https://cloud.google.com/sdk/docs/install?hl=zh-cn) Google Cloud CLI\u3002\n- \u5982\u9700 [\u521d\u59cb\u5316](https://cloud.google.com/sdk/docs/initializing?hl=zh-cn) gcloud CLI\uff0c\u8acb\u904b\u884c\u4ee5\u4e0b\u547d\u4ee4\uff1a```\ngcloud init\n```\n- Titles in dynamic includes are not used anywhere, and we should avoid paying to translate them\n- \u7232\u60a8\u7684 Google \u8cec\u865f\u5275\u5efa\u672c\u5730\u8eab\u4efd\u9a57\u8b49\u6191\u64da\uff1a```\ngcloud auth application-default login\n```\n\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 Google Cloud \u8eab\u4efd\u9a57\u8b49\u6587\u6a94\u4e2d\u7684 [\u7232\u672c\u5730\u958b\u767c\u74b0\u5883\u8a2d\u7f6e\u8eab\u4efd\u9a57\u8b49](https://cloud.google.com/docs/authentication/provide-credentials-adc?hl=zh-cn#local-dev) \u3002\u5982\u9700\u5f9e\u672c\u5730\u958b\u767c\u74b0\u5883\u4f7f\u7528\u672c\u9801\u9762\u4e0a\u7684 .NET \u793a\u4f8b\uff0c\u8acb\u5b89\u88dd\u4e26\u521d\u59cb\u5316 gcloud CLI\uff0c\u7136\u5f8c\u4f7f\u7528\u7528\u6236\u6191\u64da\u8a2d\u7f6e\u61c9\u7528\u9ed8\u8a8d\u6191\u64da\u3002- Titles in dynamic includes are not used anywhere, and we should avoid paying to translate them\n- [\u5b89\u88dd](https://cloud.google.com/sdk/docs/install?hl=zh-cn) Google Cloud CLI\u3002\n- \u5982\u9700 [\u521d\u59cb\u5316](https://cloud.google.com/sdk/docs/initializing?hl=zh-cn) gcloud CLI\uff0c\u8acb\u904b\u884c\u4ee5\u4e0b\u547d\u4ee4\uff1a```\ngcloud init\n```\n- Titles in dynamic includes are not used anywhere, and we should avoid paying to translate them\n- \u7232\u60a8\u7684 Google \u8cec\u865f\u5275\u5efa\u672c\u5730\u8eab\u4efd\u9a57\u8b49\u6191\u64da\uff1a```\ngcloud auth application-default login\n```\n\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 Google Cloud \u8eab\u4efd\u9a57\u8b49\u6587\u6a94\u4e2d\u7684 [\u7232\u672c\u5730\u958b\u767c\u74b0\u5883\u8a2d\u7f6e\u8eab\u4efd\u9a57\u8b49](https://cloud.google.com/docs/authentication/provide-credentials-adc?hl=zh-cn#local-dev) \u3002\u5982\u9700\u5f9e\u672c\u5730\u958b\u767c\u74b0\u5883\u4f7f\u7528\u672c\u9801\u9762\u4e0a\u7684 Go \u793a\u4f8b\uff0c\u8acb\u5b89\u88dd\u4e26\u521d\u59cb\u5316 gcloud CLI\uff0c\u7136\u5f8c\u4f7f\u7528\u7528\u6236\u6191\u64da\u8a2d\u7f6e\u61c9\u7528\u9ed8\u8a8d\u6191\u64da\u3002- Titles in dynamic includes are not used anywhere, and we should avoid paying to translate them\n- [\u5b89\u88dd](https://cloud.google.com/sdk/docs/install?hl=zh-cn) Google Cloud CLI\u3002\n- \u5982\u9700 [\u521d\u59cb\u5316](https://cloud.google.com/sdk/docs/initializing?hl=zh-cn) gcloud CLI\uff0c\u8acb\u904b\u884c\u4ee5\u4e0b\u547d\u4ee4\uff1a```\ngcloud init\n```\n- Titles in dynamic includes are not used anywhere, and we should avoid paying to translate them\n- \u7232\u60a8\u7684 Google \u8cec\u865f\u5275\u5efa\u672c\u5730\u8eab\u4efd\u9a57\u8b49\u6191\u64da\uff1a```\ngcloud auth application-default login\n```\n\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 Google Cloud \u8eab\u4efd\u9a57\u8b49\u6587\u6a94\u4e2d\u7684 [\u7232\u672c\u5730\u958b\u767c\u74b0\u5883\u8a2d\u7f6e\u8eab\u4efd\u9a57\u8b49](https://cloud.google.com/docs/authentication/provide-credentials-adc?hl=zh-cn#local-dev) \u3002\u5982\u9700\u5f9e\u672c\u5730\u958b\u767c\u74b0\u5883\u4f7f\u7528\u672c\u9801\u9762\u4e0a\u7684 Java \u793a\u4f8b\uff0c\u8acb\u5b89\u88dd\u4e26\u521d\u59cb\u5316 gcloud CLI\uff0c\u7136\u5f8c\u4f7f\u7528\u7528\u6236\u6191\u64da\u8a2d\u7f6e\u61c9\u7528\u9ed8\u8a8d\u6191\u64da\u3002- Titles in dynamic includes are not used anywhere, and we should avoid paying to translate them\n- [\u5b89\u88dd](https://cloud.google.com/sdk/docs/install?hl=zh-cn) Google Cloud CLI\u3002\n- \u5982\u9700 [\u521d\u59cb\u5316](https://cloud.google.com/sdk/docs/initializing?hl=zh-cn) gcloud CLI\uff0c\u8acb\u904b\u884c\u4ee5\u4e0b\u547d\u4ee4\uff1a```\ngcloud init\n```\n- Titles in dynamic includes are not used anywhere, and we should avoid paying to translate them\n- \u7232\u60a8\u7684 Google \u8cec\u865f\u5275\u5efa\u672c\u5730\u8eab\u4efd\u9a57\u8b49\u6191\u64da\uff1a```\ngcloud auth application-default login\n```\n\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 Google Cloud \u8eab\u4efd\u9a57\u8b49\u6587\u6a94\u4e2d\u7684 [\u7232\u672c\u5730\u958b\u767c\u74b0\u5883\u8a2d\u7f6e\u8eab\u4efd\u9a57\u8b49](https://cloud.google.com/docs/authentication/provide-credentials-adc?hl=zh-cn#local-dev) \u3002\u5982\u9700\u5f9e\u672c\u5730\u958b\u767c\u74b0\u5883\u4f7f\u7528\u672c\u9801\u9762\u4e0a\u7684 Python \u793a\u4f8b\uff0c\u8acb\u5b89\u88dd\u4e26\u521d\u59cb\u5316 gcloud CLI\uff0c\u7136\u5f8c\u4f7f\u7528\u7528\u6236\u6191\u64da\u8a2d\u7f6e\u61c9\u7528\u9ed8\u8a8d\u6191\u64da\u3002- Titles in dynamic includes are not used anywhere, and we should avoid paying to translate them\n- [\u5b89\u88dd](https://cloud.google.com/sdk/docs/install?hl=zh-cn) Google Cloud CLI\u3002\n- \u5982\u9700 [\u521d\u59cb\u5316](https://cloud.google.com/sdk/docs/initializing?hl=zh-cn) gcloud CLI\uff0c\u8acb\u904b\u884c\u4ee5\u4e0b\u547d\u4ee4\uff1a```\ngcloud init\n```\n- Titles in dynamic includes are not used anywhere, and we should avoid paying to translate them\n- \u7232\u60a8\u7684 Google \u8cec\u865f\u5275\u5efa\u672c\u5730\u8eab\u4efd\u9a57\u8b49\u6191\u64da\uff1a```\ngcloud auth application-default login\n```\n\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 Google Cloud \u8eab\u4efd\u9a57\u8b49\u6587\u6a94\u4e2d\u7684 [\u7232\u672c\u5730\u958b\u767c\u74b0\u5883\u8a2d\u7f6e\u8eab\u4efd\u9a57\u8b49](https://cloud.google.com/docs/authentication/provide-credentials-adc?hl=zh-cn#local-dev) \u3002\u5982\u9700\u5728\u672c\u5730\u958b\u767c\u74b0\u5883\u4e2d\u4f7f\u7528\u672c\u9801\u9762\u4e0a\u7684 REST API \u793a\u4f8b\uff0c\u8acb\u4f7f\u7528\u60a8\u63d0\u4f9b\u7d66 gcloud CLI \u7684\u6191\u64da\u3002- Titles in dynamic includes are not used anywhere, and we should avoid paying to translate them\n- [\u5b89\u88dd](https://cloud.google.com/sdk/docs/install?hl=zh-cn) Google Cloud CLI\uff0c\u7136\u5f8c\u901a\u904e\u904b\u884c\u4ee5\u4e0b\u547d\u4ee4 [\u521d\u59cb\u5316](https://cloud.google.com/sdk/docs/initializing?hl=zh-cn) Google Cloud CLI\uff1a\n- ```\ngcloud init\n```\n- \u77ad\u89e3 [\u670d\u52d9\u8cec\u865f\u6191\u64da](https://cloud.google.com/iam/docs/service-account-creds?hl=zh-cn) \u3002\n### \u6240\u9700\u7684\u89d2\u8272\n\u5982\u9700\u7372\u5f97\u5275\u5efa\u548c\u522a\u9664\u670d\u52d9\u8cec\u865f\u5bc6\u9470\u6240\u9700\u7684\u6b0a\u9650\uff0c\u8acb\u8b93\u7ba1\u7406\u54e1\u5411\u60a8\u6388\u4e88\u9805\u76ee\u6216\u8005\u60a8\u8981\u7ba1\u7406\u5176\u5bc6\u9470\u7684\u670d\u52d9\u8cec\u865f\u7684 [Service Account Key Admin](https://cloud.google.com/iam/docs/understanding-roles?hl=zh-cn#iam.serviceAccountKeyAdmin) ( `roles/iam.serviceAccountKeyAdmin` ) IAM \u89d2\u8272\u3002 \u5982\u9700\u8a73\u7d30\u77ad\u89e3\u5982\u4f55\u6388\u4e88\u89d2\u8272\uff0c\u8acb\u53c3\u95b1 [\u7ba1\u7406\u8a2a\u554f\u6b0a\u9650](https://cloud.google.com/iam/docs/granting-changing-revoking-access?hl=zh-cn) \u3002\n\u60a8\u4e5f\u53ef\u4ee5\u901a\u904e [\u81ea\u5b9a\u7fa9\u89d2\u8272](https://cloud.google.com/iam/docs/creating-custom-roles?hl=zh-cn) \u6216\u5176\u4ed6 [\u9810\u5b9a\u7fa9\u89d2\u8272](https://cloud.google.com/iam/docs/understanding-roles?hl=zh-cn) \u4f86\u7372\u53d6\u6240\u9700\u7684\u6b0a\u9650\u3002\n\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [\u670d\u52d9\u8cec\u865f\u89d2\u8272](https://cloud.google.com/iam/docs/understanding-roles?hl=zh-cn#service-accounts-roles) \u3002\nIAM \u57fa\u672c\u89d2\u8272\u9084\u5305\u542b\u7ba1\u7406\u670d\u52d9\u8cec\u865f\u5bc6\u9470\u7684\u6b0a\u9650\u3002\u60a8\u4e0d\u61c9\u5728\u751f\u7522\u74b0\u5883\u4e2d\u6388\u4e88\u57fa\u672c\u89d2\u8272\uff0c\u4f46\u53ef\u4ee5\u5728\u958b\u767c\u6216\u6e2c\u8a66\u74b0\u5883\u4e2d\u6388\u4e88\u9019\u4e9b\u89d2\u8272\u3002\n## \u5275\u5efa\u670d\u52d9\u8cec\u865f\u5bc6\u9470\n\u5982\u8981\u5728 Google Cloud \u4e4b\u5916\uff08\u4f8b\u5982\u5728\u5176\u4ed6\u5e73\u81fa\u4e0a\u6216\u5728\u672c\u5730\uff09\u4f7f\u7528\u670d\u52d9\u8cec\u865f\uff0c\u60a8\u5fc5\u9808\u9996\u5148\u78ba\u5b9a\u670d\u52d9\u8cec\u865f\u7684\u8eab\u4efd\u3002\u7232\u78ba\u4fdd\u5b89\u5168\u5730\u5be6\u73fe\u6b64\u76ee\u6a19\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528\u516c\u9470/\u79c1\u9470\u5c0d\u3002 \u5275\u5efa\u670d\u52d9\u8cec\u865f\u5bc6\u9470\u6642\uff0c\u516c\u5171\u90e8\u5206\u5b58\u5132\u5728 Google Cloud \u4e0a\uff0c\u800c\u4e0d\u516c\u958b\u90e8\u5206\u50c5\u4f9b\u60a8\u4f7f\u7528\u3002\u5982\u9700\u8a73\u7d30\u77ad\u89e3\u516c\u9470/\u79c1\u9470\u5c0d\uff0c\u8acb\u53c3\u95b1 [\u670d\u52d9\u8cec\u865f\u5bc6\u9470](https://cloud.google.com/iam/docs/service-account-creds?hl=zh-cn#key-types) \u3002\n**\u6ce8\u610f** \uff1a\u60a8\u53ef\u4ee5\u5275\u5efa JSON \u6216 [PKCS#12 (P12)](https://wikipedia.org/wiki/PKCS_12) \u683c\u5f0f\u7684\u670d\u52d9\u8cec\u865f\u5bc6\u9470\u3002\u9664\u975e\u7232\u4e86\u5be6\u73fe\u5411\u5f8c\u517c\u5bb9\u6027\uff0c\u5426\u5247\u4e0d\u5efa\u8b70\u4f7f\u7528 P12 \u670d\u52d9\u8cec\u865f\u5bc6\u9470\u3002\u4ee5\u4e0b\u793a\u4f8b\u4f7f\u7528 JSON \u683c\u5f0f\u3002\n\u60a8\u53ef\u4ee5\u4f7f\u7528 Google Cloud \u63a7\u5236\u6aaf\u3001gcloud CLI\u3001 [serviceAccounts.keys.create()](https://cloud.google.com/iam/reference/rest/v1/projects.serviceAccounts.keys/create?hl=zh-cn) \u65b9\u6cd5\u6216\u67d0\u7a2e [\u5ba2\u6236\u7aef\u5eab](https://cloud.google.com/apis/docs/cloud-client-libraries?hl=zh-cn) \u5275\u5efa [\u670d\u52d9\u8cec\u865f\u5bc6\u9470](https://cloud.google.com/iam/reference/rest/v1/projects.serviceAccounts.keys?hl=zh-cn) \u3002\u4e00\u500b\u670d\u52d9\u8cec\u865f\u6700\u591a\u53ef\u4ee5\u6709 10 \u500b\u5bc6\u9470\u3002\n\u9ed8\u8a8d\u60c5\u6cc1\u4e0b\uff0c\u670d\u52d9\u8cec\u865f\u5bc6\u9470\u6c38\u4e0d\u904e\u671f\u3002\u60a8\u53ef\u4ee5\u4f7f\u7528 [\u7d44\u7e54\u653f\u7b56\u9650\u5236\u689d\u4ef6](https://cloud.google.com/resource-manager/docs/organization-policy/restricting-service-accounts?hl=zh-cn#limit_key_expiry) \u4f86\u6307\u5b9a\u670d\u52d9\u8cec\u865f\u5bc6\u9470\u7684\u6709\u6548\u6642\u9577\u3002\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [\u7528\u6236\u7ba1\u7406\u7684\u5bc6\u9470\u7684\u904e\u671f\u6642\u9593](https://cloud.google.com/iam/docs/service-account-creds?hl=zh-cn#key-expiry) \u3002\n\u5728\u4e0b\u9762\u7684\u793a\u4f8b\u4e2d\uff0c `` \u662f\u60a8\u7684\u670d\u52d9\u8cec\u865f\u7684\u540d\u7a31\uff0c\u800c `` \u662f\u60a8\u7684 Google Cloud \u9805\u76ee\u7684 ID\u3002\u60a8\u53ef\u4ee5\u5f9e Google Cloud \u63a7\u5236\u6aaf\u4e2d\u7684 [\u670d\u52d9\u8cec\u865f](https://console.cloud.google.com/iam-admin/serviceaccounts/?hl=zh-cn) \u9801\u9762\u6aa2\u7d22 `` `@` `` `.iam.gserviceaccount.com` \u5b57\u7b26\u4e32\u3002\n**\u6ce8\u610f** \uff1a\u5275\u5efa\u5bc6\u9470\u5f8c\uff0c\u60a8\u53ef\u80fd\u9700\u8981\u7b49\u5f85 60 \u79d2\u6216\u66f4\u9577\u6642\u9593\u624d\u80fd\u4f7f\u7528\u8a72\u5bc6\u9470\u57f7\u884c\u53e6\u4e00\u500b\u64cd\u4f5c\u3002\u5982\u679c\u60a8\u5728\u5275\u5efa\u5bc6\u9470\u5f8c\u7acb\u5373\u5617\u8a66\u4f7f\u7528\u8a72\u5bc6\u9470\u57f7\u884c\u64cd\u4f5c\uff0c\u4f46\u6536\u5230\u932f\u8aa4\u6d88\u606f\uff0c\u5247\u53ef\u4ee5 [\u4f7f\u7528\u6307\u6578\u9000\u907f\u91cd\u8a66\u8acb\u6c42](https://cloud.google.com/iam/docs/retry-strategy?hl=zh-cn) \u3002\n- \u5728 Google Cloud \u63a7\u5236\u6aaf\u4e2d\uff0c\u8f49\u5230 **\u670d\u52d9\u8cec\u865f** \u9801\u9762\u3002 [\u8f49\u5230\u201c\u670d\u52d9\u8cec\u865f\u201d](https://console.cloud.google.com/iam-admin/serviceaccounts?walkthrough_id=iam--create-service-account-keys&start_index=1&hl=zh-cn#step_index=1) school \u5176\u9918\u6b65\u9a5f\u5c07\u81ea\u52d5\u986f\u793a\u5728 Google Cloud \u63a7\u5236\u6aaf\u4e2d\u3002\n- \u9078\u64c7\u4e00\u500b\u9805\u76ee\u3002\n- \u9ede\u64ca\u8981\u7232\u5176\u5275\u5efa\u5bc6\u9470\u7684\u670d\u52d9\u8cec\u865f\u7684\u96fb\u5b50\u90f5\u4ef6\u5730\u5740\u3002\n- \u9ede\u64ca\u6a19\u7c64\u9801\u3002\n- \u9ede\u64ca **\u6dfb\u52a0\u5bc6\u9470** \u4e0b\u62c9\u83dc\u55ae\uff0c\u7136\u5f8c\u9078\u64c7 **\u5275\u5efa\u65b0\u5bc6\u9470** \u3002\n- \u9078\u64c7 **JSON** \u4f5c\u7232 **\u5bc6\u9470\u985e\u578b** \uff0c\u7136\u5f8c\u9ede\u64ca **\u5275\u5efa** \u3002\n\u9ede\u64ca **\u5275\u5efa** \u5373\u6703\u4e0b\u8f09\u670d\u52d9\u8cec\u865f\u5bc6\u9470\u6587\u4ef6\u3002\u4e0b\u8f09\u5bc6\u9470\u6587\u4ef6\u5f8c\uff0c\u60a8\u7121\u6cd5\u518d\u6b21\u4e0b\u8f09\u3002\n\u4e0b\u8f09\u7684\u5bc6\u9470\u63a1\u7528\u4ee5\u4e0b\u683c\u5f0f\uff0c\u5176\u4e2d `` \u662f\u516c\u9470/\u79c1\u9470\u5c0d\u7684\u79c1\u9470\u90e8\u5206\uff1a\n```\n{\u00a0 \"type\": \"service_account\",\u00a0 \"project_id\": \"PROJECT_ID\",\u00a0 \"private_key_id\": \"KEY_ID\",\u00a0 \"private_key\": \"-----BEGIN PRIVATE KEY-----\\nPRIVATE_KEY\\n-----END PRIVATE KEY-----\\n\",\u00a0 \"client_email\": \"SERVICE_ACCOUNT_EMAIL\",\u00a0 \"client_id\": \"CLIENT_ID\",\u00a0 \"auth_uri\": \"https://accounts.google.com/o/oauth2/auth\",\u00a0 \"token_uri\": \"https://accounts.google.com/o/oauth2/token\",\u00a0 \"auth_provider_x509_cert_url\": \"https://www.googleapis.com/oauth2/v1/certs\",\u00a0 \"client_x509_cert_url\": \"https://www.googleapis.com/robot/v1/metadata/x509/SERVICE_ACCOUNT_EMAIL\"}\n```\n\u52d9\u5fc5\u8981\u5b89\u5168\u5b58\u5132\u5bc6\u9470\u6587\u4ef6\uff0c\u56e0\u7232\u5b83\u80fd\u5920\u4ee5\u670d\u52d9\u8cec\u865f\u7684\u8eab\u4efd\u9032\u884c\u8eab\u4efd\u9a57\u8b49\u3002\u60a8\u53ef\u4ee5\u6839\u64da\u9700\u8981\u79fb\u52d5\u4e26\u91cd\u547d\u540d\u6b64\u6587\u4ef6\u3002\n\u60a8\u53ef\u4ee5\u4f7f\u7528\u670d\u52d9\u8cec\u865f\u5bc6\u9470\u6587\u4ef6\u4f86 [\u5c07\u61c9\u7528\u4f5c\u7232\u670d\u52d9\u8cec\u865f\u9032\u884c\u8eab\u4efd\u9a57\u8b49](https://cloud.google.com/docs/authentication/provide-credentials-adc?hl=zh-cn#wlif-key) \u3002\u57f7\u884c [gcloud iam service-accounts keys create](https://cloud.google.com/sdk/gcloud/reference/iam/service-accounts/keys/create?hl=zh-cn) \u547d\u4ee4\u4f86\u5275\u5efa\u670d\u52d9\u8cec\u865f\u5bc6\u9470\u3002\n\u66ff\u63db\u4ee5\u4e0b\u503c\uff1a- ``\uff1a\u79c1\u9470\u7684\u65b0\u8f38\u51fa\u6587\u4ef6\u7684\u8def\u5f91\uff0c\u4f8b\u5982`~/sa-private-key.json`\u3002\n- ``\uff1a\u8981\u7232\u5176\u5275\u5efa\u5bc6\u9470\u7684\u670d\u52d9\u8cec\u865f\u7684\u540d\u7a31\u3002\n- ``\uff1a\u60a8\u7684 Google Cloud \u9805\u76ee ID\u3002\n```\ngcloud iam service-accounts keys create KEY_FILE \\\n --iam-account=SA_NAME@PROJECT_ID.iam.gserviceaccount.com\n```\n\u8f38\u51fa\uff1a\n```\ncreated key [e44da1202f82f8f4bdd9d92bc412d1d8a837fa83] of type [json] as\n[/usr/home/username/KEY_FILE] for\n[SA_NAME@PROJECT_ID.iam.gserviceaccount.com]\n```\n\u73fe\u5728\uff0c\u670d\u52d9\u8cec\u865f\u5bc6\u9470\u6587\u4ef6\u5df2\u4e0b\u8f09\u5230\u60a8\u7684\u6a5f\u5668\u4e0a\u3002\u4e0b\u8f09\u5bc6\u9470\u6587\u4ef6\u5f8c\uff0c\u60a8\u7121\u6cd5\u518d\u6b21\u4e0b\u8f09\u3002\n\u4e0b\u8f09\u7684\u5bc6\u9470\u63a1\u7528\u4ee5\u4e0b\u683c\u5f0f\uff0c\u5176\u4e2d `` \u662f\u516c\u9470/\u79c1\u9470\u5c0d\u7684\u79c1\u6709\u90e8\u5206\uff1a\n```\n{\u00a0 \"type\": \"service_account\",\u00a0 \"project_id\": \"PROJECT_ID\",\u00a0 \"private_key_id\": \"KEY_ID\",\u00a0 \"private_key\": \"-----BEGIN PRIVATE KEY-----\\nPRIVATE_KEY\\n-----END PRIVATE KEY-----\\n\",\u00a0 \"client_email\": \"SERVICE_ACCOUNT_EMAIL\",\u00a0 \"client_id\": \"CLIENT_ID\",\u00a0 \"auth_uri\": \"https://accounts.google.com/o/oauth2/auth\",\u00a0 \"token_uri\": \"https://oauth2.googleapis.com/token\",\u00a0 \"auth_provider_x509_cert_url\": \"https://www.googleapis.com/oauth2/v1/certs\",\u00a0 \"client_x509_cert_url\": \"https://www.googleapis.com/robot/v1/metadata/x509/SERVICE_ACCOUNT_EMAIL\"}\n```\n\u52d9\u5fc5\u8981\u5b89\u5168\u5b58\u5132\u5bc6\u9470\u6587\u4ef6\uff0c\u56e0\u7232\u5b83\u80fd\u5920\u4ee5\u670d\u52d9\u8cec\u865f\u7684\u8eab\u4efd\u9032\u884c\u8eab\u4efd\u9a57\u8b49\u3002\u60a8\u53ef\u4ee5\u6839\u64da\u9700\u8981\u79fb\u52d5\u4e26\u91cd\u547d\u540d\u6b64\u6587\u4ef6\u3002\n\u60a8\u53ef\u4ee5\u4f7f\u7528\u670d\u52d9\u8cec\u865f\u5bc6\u9470\u6587\u4ef6\u4f86 [\u5c07\u61c9\u7528\u4f5c\u7232\u670d\u52d9\u8cec\u865f\u9032\u884c\u8eab\u4efd\u9a57\u8b49](https://cloud.google.com/docs/authentication/provide-credentials-adc?hl=zh-cn#wlif-key) \u3002\u5982\u9700\u77ad\u89e3\u5982\u4f55\u5b89\u88dd\u548c\u4f7f\u7528 IAM \u5ba2\u6236\u7aef\u5eab\uff0c\u8acb\u53c3\u95b1 [IAM \u5ba2\u6236\u7aef\u5eab](https://cloud.google.com/iam/docs/reference/libraries?hl=zh-cn) \u3002\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [IAM C++ API \u53c3\u8003\u6587\u6a94](https://cloud.google.com/cpp/docs/reference/iam/latest?hl=zh-cn) \u3002\n\u5982\u9700\u5411 IAM \u9032\u884c\u8eab\u4efd\u9a57\u8b49\uff0c\u8acb\u8a2d\u7f6e\u61c9\u7528\u9ed8\u8a8d\u6191\u64da\u3002  \u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [\u6e96\u5099\u5de5\u4f5c](#before-you-begin) \u3002\n [\u5728 GitHub \u4e0a\u67e5\u770b](https://github.com/googleapis/google-cloud-cpp/blob/HEAD/google/cloud/iam/samples/iam_samples.cc) \n```\nnamespace iam = ::google::cloud::iam_admin_v1;return [](std::string const& name) {\u00a0 iam::IAMClient client(iam::MakeIAMConnection());\u00a0 auto response = client.CreateServiceAccountKey(\u00a0 \u00a0 \u00a0 name,\u00a0 \u00a0 \u00a0 google::iam::admin::v1::ServiceAccountPrivateKeyType::\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 TYPE_GOOGLE_CREDENTIALS_FILE,\u00a0 \u00a0 \u00a0 google::iam::admin::v1::ServiceAccountKeyAlgorithm::KEY_ALG_RSA_2048);\u00a0 if (!response) throw std::move(response).status();\u00a0 std::cout << \"ServiceAccountKey successfully created: \"\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 << response->DebugString() << \"\\n\"\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 << \"Please save the key in a secure location, as they cannot \"\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0\"be downloaded later\\n\";\u00a0 return response->name();}\n```\u5982\u9700\u77ad\u89e3\u5982\u4f55\u5b89\u88dd\u548c\u4f7f\u7528 IAM \u5ba2\u6236\u7aef\u5eab\uff0c\u8acb\u53c3\u95b1 [IAM \u5ba2\u6236\u7aef\u5eab](https://cloud.google.com/iam/docs/reference/libraries?hl=zh-cn) \u3002\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [IAM C# API \u53c3\u8003\u6587\u6a94](https://developers.google.com/api-client-library/dotnet/apis/iam/v1?hl=zh-cn) \u3002\n\u5982\u9700\u5411 IAM \u9032\u884c\u8eab\u4efd\u9a57\u8b49\uff0c\u8acb\u8a2d\u7f6e\u61c9\u7528\u9ed8\u8a8d\u6191\u64da\u3002  \u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [\u6e96\u5099\u5de5\u4f5c](#before-you-begin) \u3002\n [\u5728 GitHub \u4e0a\u67e5\u770b](https://github.com/GoogleCloudPlatform/dotnet-docs-samples/blob/HEAD/iam/api/ServiceAccountKeys/ServiceAccountKeysCreate.cs) \n```\nusing System;using System.Text;using Google.Apis.Auth.OAuth2;using Google.Apis.Iam.v1;using Google.Apis.Iam.v1.Data;public partial class ServiceAccountKeys{\u00a0 \u00a0 public static ServiceAccountKey CreateKey(string serviceAccountEmail)\u00a0 \u00a0 {\u00a0 \u00a0 \u00a0 \u00a0 var credential = GoogleCredential.GetApplicationDefault()\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 .CreateScoped(IamService.Scope.CloudPlatform);\u00a0 \u00a0 \u00a0 \u00a0 var service = new IamService(new IamService.Initializer\u00a0 \u00a0 \u00a0 \u00a0 {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 HttpClientInitializer = credential\u00a0 \u00a0 \u00a0 \u00a0 });\u00a0 \u00a0 \u00a0 \u00a0 var key = service.Projects.ServiceAccounts.Keys.Create(\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 new CreateServiceAccountKeyRequest(),\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"projects/-/serviceAccounts/\" + serviceAccountEmail)\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 .Execute();\u00a0 \u00a0 \u00a0 \u00a0 // The PrivateKeyData field contains the base64-encoded service account key\u00a0 \u00a0 \u00a0 \u00a0 // in JSON format.\u00a0 \u00a0 \u00a0 \u00a0 // TODO(Developer): Save the below key (jsonKeyFile) to a secure location.\u00a0 \u00a0 \u00a0 \u00a0 // \u00a0You cannot download it later.\u00a0 \u00a0 \u00a0 \u00a0 byte[] valueBytes = System.Convert.FromBase64String(key.PrivateKeyData);\u00a0 \u00a0 \u00a0 \u00a0 string jsonKeyContent = Encoding.UTF8.GetString(valueBytes);\u00a0 \u00a0 \u00a0 \u00a0 Console.WriteLine(\"Key created successfully\");\u00a0 \u00a0 \u00a0 \u00a0 return key;\u00a0 \u00a0 }}\n```\u5982\u9700\u77ad\u89e3\u5982\u4f55\u5b89\u88dd\u548c\u4f7f\u7528 IAM \u5ba2\u6236\u7aef\u5eab\uff0c\u8acb\u53c3\u95b1 [IAM \u5ba2\u6236\u7aef\u5eab](https://cloud.google.com/iam/docs/reference/libraries?hl=zh-cn) \u3002\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [IAM Go API \u53c3\u8003\u6587\u6a94](https://godoc.org/google.golang.org/genproto/googleapis/iam/admin/v1) \u3002\n\u5982\u9700\u5411 IAM \u9032\u884c\u8eab\u4efd\u9a57\u8b49\uff0c\u8acb\u8a2d\u7f6e\u61c9\u7528\u9ed8\u8a8d\u6191\u64da\u3002  \u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [\u6e96\u5099\u5de5\u4f5c](#before-you-begin) \u3002\n [\u5728 GitHub \u4e0a\u67e5\u770b](https://github.com/GoogleCloudPlatform/golang-samples/blob/HEAD/iam/snippets/service_account_keys_create.go) \n```\nimport (\u00a0 \u00a0 \u00a0 \u00a0 \"context\"\u00a0 \u00a0 \u00a0 \u00a0 // \"encoding/base64\"\u00a0 \u00a0 \u00a0 \u00a0 \"fmt\"\u00a0 \u00a0 \u00a0 \u00a0 \"io\"\u00a0 \u00a0 \u00a0 \u00a0 iam \"google.golang.org/api/iam/v1\")// createKey creates a service account key.func createKey(w io.Writer, serviceAccountEmail string) (*iam.ServiceAccountKey, error) {\u00a0 \u00a0 \u00a0 \u00a0 ctx := context.Background()\u00a0 \u00a0 \u00a0 \u00a0 service, err := iam.NewService(ctx)\u00a0 \u00a0 \u00a0 \u00a0 if err != nil {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 return nil, fmt.Errorf(\"iam.NewService: %w\", err)\u00a0 \u00a0 \u00a0 \u00a0 }\u00a0 \u00a0 \u00a0 \u00a0 resource := \"projects/-/serviceAccounts/\" + serviceAccountEmail\u00a0 \u00a0 \u00a0 \u00a0 request := &iam.CreateServiceAccountKeyRequest{}\u00a0 \u00a0 \u00a0 \u00a0 key, err := service.Projects.ServiceAccounts.Keys.Create(resource, request).Do()\u00a0 \u00a0 \u00a0 \u00a0 if err != nil {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 return nil, fmt.Errorf(\"Projects.ServiceAccounts.Keys.Create: %w\", err)\u00a0 \u00a0 \u00a0 \u00a0 }\u00a0 \u00a0 \u00a0 \u00a0 // The PrivateKeyData field contains the base64-encoded service account key\u00a0 \u00a0 \u00a0 \u00a0 // in JSON format.\u00a0 \u00a0 \u00a0 \u00a0 // TODO(Developer): Save the below key (jsonKeyFile) to a secure location.\u00a0 \u00a0 \u00a0 \u00a0 // You cannot download it later.\u00a0 \u00a0 \u00a0 \u00a0 // jsonKeyFile, _ := base64.StdEncoding.DecodeString(key.PrivateKeyData)\u00a0 \u00a0 \u00a0 \u00a0 fmt.Fprintf(w, \"Key created successfully\")\u00a0 \u00a0 \u00a0 \u00a0 return key, nil}\n```\u5982\u9700\u77ad\u89e3\u5982\u4f55\u5b89\u88dd\u548c\u4f7f\u7528 IAM \u5ba2\u6236\u7aef\u5eab\uff0c\u8acb\u53c3\u95b1 [IAM \u5ba2\u6236\u7aef\u5eab](https://cloud.google.com/iam/docs/reference/libraries?hl=zh-cn) \u3002\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [IAM Java API \u53c3\u8003\u6587\u6a94](https://developers.google.com/api-client-library/java/apis/iam/v1?hl=zh-cn) \u3002\n\u5982\u9700\u5411 IAM \u9032\u884c\u8eab\u4efd\u9a57\u8b49\uff0c\u8acb\u8a2d\u7f6e\u61c9\u7528\u9ed8\u8a8d\u6191\u64da\u3002  \u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [\u6e96\u5099\u5de5\u4f5c](#before-you-begin) \u3002\n [\u5728 GitHub \u4e0a\u67e5\u770b](https://github.com/GoogleCloudPlatform/java-docs-samples/blob/HEAD/iam/api-client/src/main/java/iam/snippets/CreateServiceAccountKey.java) \n```\nimport com.google.api.client.googleapis.javanet.GoogleNetHttpTransport;import com.google.api.client.json.gson.GsonFactory;import com.google.api.services.iam.v1.Iam;import com.google.api.services.iam.v1.IamScopes;import com.google.api.services.iam.v1.model.CreateServiceAccountKeyRequest;import com.google.api.services.iam.v1.model.ServiceAccountKey;import com.google.auth.http.HttpCredentialsAdapter;import com.google.auth.oauth2.GoogleCredentials;import java.io.IOException;import java.security.GeneralSecurityException;import java.util.Base64;import java.util.Collections;public class CreateServiceAccountKey {\u00a0 // Creates a key for a service account.\u00a0 public static String createKey(String projectId, String serviceAccountName) {\u00a0 \u00a0 // String projectId = \"my-project-id\";\u00a0 \u00a0 // String serviceAccountName = \"my-service-account-name\";\u00a0 \u00a0 Iam service = null;\u00a0 \u00a0 try {\u00a0 \u00a0 \u00a0 service = initService();\u00a0 \u00a0 } catch (IOException | GeneralSecurityException e) {\u00a0 \u00a0 \u00a0 System.out.println(\"Unable to initialize service: \\n\" + e);\u00a0 \u00a0 \u00a0 return null;\u00a0 \u00a0 }\u00a0 \u00a0 // Construct the service account email.\u00a0 \u00a0 // You can modify the \".iam.gserviceaccount.com\" to match the service account name in which\u00a0 \u00a0 // you want to create the key.\u00a0 \u00a0 // See, https://cloud.google.com/iam/docs/creating-managing-service-account-keys?hl=en#creating\u00a0 \u00a0 String serviceAccountEmail = serviceAccountName + \"@\" + projectId + \".iam.gserviceaccount.com\";\u00a0 \u00a0 try {\u00a0 \u00a0 \u00a0 ServiceAccountKey key =\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 service\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 .projects()\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 .serviceAccounts()\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 .keys()\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 .create(\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"projects/-/serviceAccounts/\" + serviceAccountEmail,\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 new CreateServiceAccountKeyRequest())\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 .execute();\u00a0 \u00a0 \u00a0 // The privateKeyData field contains the base64-encoded service account key\u00a0 \u00a0 \u00a0 // in JSON format.\u00a0 \u00a0 \u00a0 // TODO(Developer): Save the below key (jsonKeyFile) to a secure location.\u00a0 \u00a0 \u00a0 // \u00a0You cannot download it later.\u00a0 \u00a0 \u00a0 String jsonKeyFile = new String(Base64.getDecoder().decode(key.getPrivateKeyData()));\u00a0 \u00a0 \u00a0 System.out.println(\"Key created successfully\");\u00a0 \u00a0 \u00a0 String keyName = key.getName();\u00a0 \u00a0 \u00a0 return keyName.substring(keyName.lastIndexOf(\"/\") + 1).trim();\u00a0 \u00a0 } catch (IOException e) {\u00a0 \u00a0 \u00a0 System.out.println(\"Unable to create service account key: \\n\" + e);\u00a0 \u00a0 \u00a0 return null;\u00a0 \u00a0 }\u00a0 }\u00a0 private static Iam initService() throws GeneralSecurityException, IOException {\u00a0 \u00a0 // Use the Application Default Credentials strategy for authentication. For more info, see:\u00a0 \u00a0 // https://cloud.google.com/docs/authentication/production#finding_credentials_automatically\u00a0 \u00a0 GoogleCredentials credential =\u00a0 \u00a0 \u00a0 \u00a0 GoogleCredentials.getApplicationDefault()\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 .createScoped(Collections.singleton(IamScopes.CLOUD_PLATFORM));\u00a0 \u00a0 // Initialize the IAM service, which can be used to send requests to the IAM API.\u00a0 \u00a0 Iam service =\u00a0 \u00a0 \u00a0 \u00a0 new Iam.Builder(\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 GoogleNetHttpTransport.newTrustedTransport(),\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 GsonFactory.getDefaultInstance(),\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 new HttpCredentialsAdapter(credential))\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 .setApplicationName(\"service-account-keys\")\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 .build();\u00a0 \u00a0 return service;\u00a0 }}\n```\u5982\u9700\u77ad\u89e3\u5982\u4f55\u5b89\u88dd\u548c\u4f7f\u7528 IAM \u5ba2\u6236\u7aef\u5eab\uff0c\u8acb\u53c3\u95b1 [IAM \u5ba2\u6236\u7aef\u5eab](https://cloud.google.com/iam/docs/reference/libraries?hl=zh-cn) \u3002\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [IAM Python API \u53c3\u8003\u6587\u6a94](https://developers.google.com/api-client-library/python/apis/iam/v1?hl=zh-cn) \u3002\n\u5982\u9700\u5411 IAM \u9032\u884c\u8eab\u4efd\u9a57\u8b49\uff0c\u8acb\u8a2d\u7f6e\u61c9\u7528\u9ed8\u8a8d\u6191\u64da\u3002  \u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [\u6e96\u5099\u5de5\u4f5c](#before-you-begin) \u3002\n [\u5728 GitHub \u4e0a\u67e5\u770b](https://github.com/GoogleCloudPlatform/python-docs-samples/blob/HEAD/iam/api-client/service_account_keys.py) \n```\nimport osfrom google.oauth2 import service_accountimport googleapiclient.discovery \u00a0# type: ignoredef create_key(service_account_email: str) -> None:\u00a0 \u00a0 \"\"\"Creates a key for a service account.\"\"\"\u00a0 \u00a0 credentials = service_account.Credentials.from_service_account_file(\u00a0 \u00a0 \u00a0 \u00a0 filename=os.environ[\"GOOGLE_APPLICATION_CREDENTIALS\"],\u00a0 \u00a0 \u00a0 \u00a0 scopes=[\"https://www.googleapis.com/auth/cloud-platform\"],\u00a0 \u00a0 )\u00a0 \u00a0 service = googleapiclient.discovery.build(\"iam\", \"v1\", credentials=credentials)\u00a0 \u00a0 key = (\u00a0 \u00a0 \u00a0 \u00a0 service.projects()\u00a0 \u00a0 \u00a0 \u00a0 .serviceAccounts()\u00a0 \u00a0 \u00a0 \u00a0 .keys()\u00a0 \u00a0 \u00a0 \u00a0 .create(name=\"projects/-/serviceAccounts/\" + service_account_email, body={})\u00a0 \u00a0 \u00a0 \u00a0 .execute()\u00a0 \u00a0 )\u00a0 \u00a0 # The privateKeyData field contains the base64-encoded service account key\u00a0 \u00a0 # in JSON format.\u00a0 \u00a0 # TODO(Developer): Save the below key {json_key_file} to a secure location.\u00a0 \u00a0 # \u00a0You cannot download it again later.\u00a0 \u00a0 # import base64\u00a0 \u00a0 # json_key_file = base64.b64decode(key['privateKeyData']).decode('utf-8')\u00a0 \u00a0 if not key[\"disabled\"]:\u00a0 \u00a0 \u00a0 \u00a0 print(\"Created json key\")\n``` ` [projects.serviceAccounts.keys.create](https://cloud.google.com/iam/docs/reference/rest/v1/projects.serviceAccounts.keys/create?hl=zh-cn) ` \u65b9\u6cd5\u53ef\u7232\u670d\u52d9\u8cec\u865f\u5275\u5efa\u5bc6\u9470\u3002\n\u5728\u4f7f\u7528\u4efb\u4f55\u8acb\u6c42\u6578\u64da\u4e4b\u524d\uff0c\u8acb\u5148\u9032\u884c\u4ee5\u4e0b\u66ff\u63db\uff1a- ``\uff1a\u60a8\u7684 Google Cloud \u9805\u76ee ID\u3002\u9805\u76ee ID \u662f\u5b57\u6bcd\u6578\u5b57\u5b57\u7b26\u4e32\uff0c\u4f8b\u5982`my-project`\u3002\n- ``\uff1a\u60a8\u8981\u7232\u5176\u5275\u5efa\u5bc6\u9470\u7684\u670d\u52d9\u8cec\u865f\u7684\u540d\u7a31\u3002\n- ``\uff1a\u53ef\u9078\u3002\u7528\u65bc\u5bc6\u9470\u7684\u5bc6\u9470\u7b97\u6cd5\u3002\u9ed8\u8a8d\u503c\uff08\u96a8\u6642\u53ef\u80fd\u66f4\u6539\uff09\u7232 2048 \u4f4d RSA \u5bc6\u9470\u3002\u5982\u9700\u67e5\u770b\u6240\u6709\u53ef\u80fd\u503c\u7684\u5217\u8868\uff0c\u8acb\u53c3\u95b1 [ServiceAccountKeyAlgorithm \u53c3\u8003\u6587\u6a94](https://cloud.google.com/iam/docs/reference/rest/v1/projects.serviceAccounts.keys?hl=zh-cn#ServiceAccountKeyAlgorithm) \u3002\nHTTP \u65b9\u6cd5\u548c\u7db2\u5740\uff1a\n```\nPOST https://iam.googleapis.com/v1/projects/PROJECT_ID/serviceAccounts/SA_NAME@PROJECT_ID.iam.gserviceaccount.com/keys\n```\n\u8acb\u6c42 JSON \u6b63\u6587\uff1a\n```\n{\n \"keyAlgorithm\": \"KEY_ALGORITHM\"\n}\n```\n\u5982\u9700\u767c\u9001\u60a8\u7684\u8acb\u6c42\uff0c\u8acb\u5c55\u958b\u4ee5\u4e0b\u9078\u9805\u4e4b\u4e00\uff1a\n\u97ff\u61c9\u4e2d\u5305\u542b\u60a8\u7684\u670d\u52d9\u8cec\u865f\u7684\u5bc6\u9470\u3002\u8fd4\u56de\u7684\u5bc6\u9470\u63a1\u7528\u4ee5\u4e0b\u683c\u5f0f\uff0c\u5176\u4e2d `` \u662f\u516c\u9470/\u79c1\u9470\u5c0d\u7684\u79c1\u6709\u90e8\u5206\uff0c\u63a1\u7528 base64 \u7de8\u78bc\u3002\n```\n{\n \"name\": \"projects/PROJECT_ID/serviceAccounts/SERVICE_ACCOUNT_EMAIL/keys/KEY_ID\",\n \"privateKeyType\": \"TYPE_GOOGLE_CREDENTIALS_FILE\",\n \"privateKeyData\": \"ENCODED_PRIVATE_KEY\",\n \"validAfterTime\": \"DATE\",\n \"validBeforeTime\": \"DATE\",\n \"keyAlgorithm\": \"KEY_ALG_RSA_2048\"\n}\n```\n\u5982\u8981\u5275\u5efa\u53ef\u7528\u65bc\u4ee5\u670d\u52d9\u8cec\u865f\u8eab\u4efd\u9032\u884c\u8eab\u4efd\u9a57\u8b49\u7684\u5bc6\u9470\u6587\u4ef6\uff0c\u8acb\u89e3\u78bc\u79c1\u9470\u6578\u64da\u4e26\u5c07\u5176\u4fdd\u5b58\u5728\u6587\u4ef6\u4e2d\uff1a\n\u904b\u884c\u4ee5\u4e0b\u547d\u4ee4\uff1a\n```\necho 'ENCODED_PRIVATE_KEY' | base64 --decode > PATH\n```\n\u5c07 `` \u66ff\u63db\u7232\u60a8\u8981\u4fdd\u5b58\u5bc6\u9470\u7684\u6587\u4ef6\u7684\u8def\u5f91\u3002\u4f7f\u7528 `.json` \u6587\u4ef6\u64f4\u5c55\u540d\u3002\n\u904b\u884c\u4ee5\u4e0b\u547d\u4ee4\uff1a\n```\necho 'ENCODED_PRIVATE_KEY' | base64 --decode > PATH\n```\n\u5c07 `` \u66ff\u63db\u7232\u60a8\u8981\u4fdd\u5b58\u5bc6\u9470\u7684\u6587\u4ef6\u7684\u8def\u5f91\u3002\u4f7f\u7528 `.json` \u6587\u4ef6\u64f4\u5c55\u540d\u3002- \u5c07\u5df2\u7de8\u78bc\u7684\u79c1\u9470\u6578\u64da ( `` ) \u4fdd\u5b58\u5728\u6587\u4ef6\u4e2d\u3002\n- \u4f7f\u7528 `certutil` \u5c0d\u6587\u4ef6\u9032\u884c\u89e3\u78bc\uff1a```\ncertutil -decode ENCODED_FILE DECODED_FILE\n```\u66ff\u63db\u4ee5\u4e0b\u503c\uff1a- ``\uff1a\u5305\u542b\u5df2\u7de8\u78bc\u79c1\u9470\u6578\u64da\u7684\u6587\u4ef6\u7684\u8def\u5f91\u3002\n- ``\uff1a\u60a8\u8981\u5728\u5176\u4e2d\u4fdd\u5b58\u5bc6\u9470\u7684\u6587\u4ef6\u7684\u8def\u5f91\u3002\u4f7f\u7528`.json`\u6587\u4ef6\u64f4\u5c55\u540d\u3002\u52d9\u5fc5\u8981\u5b89\u5168\u5b58\u5132\u5bc6\u9470\u6578\u64da\uff0c\u56e0\u7232\u5b83\u80fd\u5920\u4ee5\u670d\u52d9\u8cec\u865f\u7684\u8eab\u4efd\u9032\u884c\u8eab\u4efd\u9a57\u8b49\u3002\n\u60a8\u53ef\u4ee5\u4f7f\u7528\u670d\u52d9\u8cec\u865f\u5bc6\u9470\u6587\u4ef6\u4f86 [\u5c07\u61c9\u7528\u4f5c\u7232\u670d\u52d9\u8cec\u865f\u9032\u884c\u8eab\u4efd\u9a57\u8b49](https://cloud.google.com/docs/authentication/provide-credentials-adc?hl=zh-cn#wlif-key) \u3002\n## \u522a\u9664\u670d\u52d9\u8cec\u865f\u5bc6\u9470\n\u522a\u9664\u670d\u52d9\u8cec\u865f\u5bc6\u9470\u6703\u6c38\u4e45\u963b\u6b62\u60a8\u4f7f\u7528\u8a72\u5bc6\u9470\u5411 Google API \u9032\u884c\u8eab\u4efd\u9a57\u8b49\u3002\n\u60a8\u4e0d\u80fd\u6062\u5fa9\u522a\u9664\u7684\u5bc6\u9470\u3002\u5728\u522a\u9664\u5bc6\u9470\u4e4b\u524d\uff0c\u6211\u5011\u5efa\u8b70\u60a8\u5148 [\u505c\u7528\u5bc6\u9470](https://cloud.google.com/iam/docs/keys-disable-enable?hl=zh-cn#disabling) \uff0c\u7136\u5f8c\u7b49\u5230\u60a8\u78ba\u5b9a\u4e0d\u518d\u9700\u8981\u8a72\u5bc6\u9470\u6642\uff0c\u5373\u53ef\u5c07\u5176\u522a\u9664\u3002\n\u6700\u4f73\u505a\u6cd5\u662f\u5b9a\u671f\u8f2a\u66ff\u60a8\u7684\u670d\u52d9\u8cec\u865f\u5bc6\u9470\u3002\u5982\u9700\u8a73\u7d30\u77ad\u89e3\u5982\u4f55\u8f2a\u66ff\u670d\u52d9\u8cec\u865f\u5bc6\u9470\uff0c\u8acb\u53c3\u95b1 [\u670d\u52d9\u8cec\u865f\u5bc6\u9470\u8f2a\u66ff](https://cloud.google.com/iam/docs/key-rotation?hl=zh-cn) \u3002\n**\u91cd\u8981\u63d0\u793a** \uff1a\u522a\u9664\u670d\u52d9\u8cec\u865f\u5bc6\u9470\u4e0d\u6703\u64a4\u6d88\u6839\u64da\u5bc6\u9470\u9812\u767c\u7684\u77ed\u671f\u6709\u6548\u6191\u64da\u3002\u5982\u9700\u64a4\u6d88\u5df2\u88ab\u7834\u89e3\u7684\u77ed\u671f\u6709\u6548\u6191\u64da\uff0c\u60a8\u5fc5\u9808 [\u505c\u7528\u6216\u522a\u9664\u6191\u64da\u4ee3\u8868\u7684\u670d\u52d9\u8cec\u865f](https://cloud.google.com/iam/docs/service-accounts-disable-enable?hl=zh-cn#disabling) \u3002\u5982\u679c\u60a8\u9019\u6a23\u505a\uff0c\u5247\u4f7f\u7528\u8a72\u670d\u52d9\u8cec\u865f\u7684\u4efb\u4f55\u5de5\u4f5c\u8ca0\u8f09\u90fd\u5c07\u7acb\u5373\u5931\u53bb\u60a8\u7684\u8cc7\u6e90\u7684\u8a2a\u554f\u6b0a\u9650\u3002\n- \u5728 Google Cloud \u63a7\u5236\u6aaf\u4e2d\uff0c\u8f49\u5230 **\u670d\u52d9\u8cec\u865f** \u9801\u9762\u3002 [\u8f49\u5230\u201c\u670d\u52d9\u8cec\u865f\u201d](https://console.cloud.google.com/iam-admin/serviceaccounts?walkthrough_id=iam--delete-service-account-keys&start_index=1&hl=zh-cn#step_index=1) school \u5176\u9918\u6b65\u9a5f\u5c07\u81ea\u52d5\u986f\u793a\u5728 Google Cloud \u63a7\u5236\u6aaf\u4e2d\u3002\n- \u9078\u64c7\u4e00\u500b\u9805\u76ee\u3002\n- \u5728 **\u670d\u52d9\u8cec\u865f** \u9801\u9762\u4e0a\uff0c\u9ede\u64ca\u8981\u522a\u9664\u5176\u5bc6\u9470\u7684\u670d\u52d9\u8cec\u865f\u7684\u96fb\u5b50\u90f5\u4ef6\u5730\u5740\u3002\n- \u9ede\u64ca **\u5bc6\u9470** \u6a19\u7c64\u9801\u3002\n- \u5f9e\u5bc6\u9470\u5217\u8868\u4e2d\uff0c\u91dd\u5c0d\u60a8\u60f3\u522a\u9664\u7684\u6bcf\u500b\u5bc6\u9470\u9ede\u64ca **\u522a\u9664** delete\u3002\n\u57f7\u884c [gcloud iam service-accounts keys delete](https://cloud.google.com/sdk/gcloud/reference/iam/service-accounts/keys/delete?hl=zh-cn) \u547d\u4ee4\u4f86\u522a\u9664\u670d\u52d9\u8cec\u865f\u5bc6\u9470\u3002\n\u66ff\u63db\u4ee5\u4e0b\u503c\uff1a- ``\uff1a\u8981\u522a\u9664\u7684\u5bc6\u9470\u7684 ID\u3002 \u5982\u9700\u67e5\u627e\u5bc6\u9470\u7684 ID\uff0c\u8acb [\u5217\u51fa\u670d\u52d9\u8cec\u865f\u7684\u6240\u6709\u5bc6\u9470](https://cloud.google.com/iam/docs/keys-list-get?hl=zh-cn#list-keys) \uff0c\u627e\u5230\u8981\u522a\u9664\u7684\u5bc6\u9470\uff0c\u7136\u5f8c\u8907\u88fd\u5176 ID\u3002\n- ``\uff1a\u5bc6\u9470\u6240\u5c6c\u670d\u52d9\u8cec\u865f\u7684\u540d\u7a31\u3002\n- ``\uff1a\u60a8\u7684 Google Cloud \u9805\u76ee ID\u3002\n```\ngcloud iam service-accounts keys delete KEY_ID \\\n --iam-account=SA_NAME@PROJECT_ID.iam.gserviceaccount.com\n```\n\u8f38\u51fa\u5982\u4e0b\uff1a\n```\nDeleted key [KEY_ID] for service account\n[SA_NAME@PROJECT_ID.iam.gserviceaccount.com]\n```\u5982\u9700\u77ad\u89e3\u5982\u4f55\u5b89\u88dd\u548c\u4f7f\u7528 IAM \u5ba2\u6236\u7aef\u5eab\uff0c\u8acb\u53c3\u95b1 [IAM \u5ba2\u6236\u7aef\u5eab](https://cloud.google.com/iam/docs/reference/libraries?hl=zh-cn) \u3002\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [IAM C++ API \u53c3\u8003\u6587\u6a94](https://cloud.google.com/cpp/docs/reference/iam/latest?hl=zh-cn) \u3002\n\u5982\u9700\u5411 IAM \u9032\u884c\u8eab\u4efd\u9a57\u8b49\uff0c\u8acb\u8a2d\u7f6e\u61c9\u7528\u9ed8\u8a8d\u6191\u64da\u3002  \u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [\u6e96\u5099\u5de5\u4f5c](#before-you-begin) \u3002\n [\u5728 GitHub \u4e0a\u67e5\u770b](https://github.com/googleapis/google-cloud-cpp/blob/HEAD/google/cloud/iam/samples/iam_samples.cc) \n```\nnamespace iam = ::google::cloud::iam_admin_v1;[](std::string const& name) {\u00a0 iam::IAMClient client(iam::MakeIAMConnection());\u00a0 auto response = client.DeleteServiceAccountKey(name);\u00a0 if (!response.ok()) throw std::runtime_error(response.message());\u00a0 std::cout << \"ServiceAccountKey successfully deleted.\\n\";}\n```\u5982\u9700\u77ad\u89e3\u5982\u4f55\u5b89\u88dd\u548c\u4f7f\u7528 IAM \u5ba2\u6236\u7aef\u5eab\uff0c\u8acb\u53c3\u95b1 [IAM \u5ba2\u6236\u7aef\u5eab](https://cloud.google.com/iam/docs/reference/libraries?hl=zh-cn) \u3002\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [IAM C# API \u53c3\u8003\u6587\u6a94](https://developers.google.com/api-client-library/dotnet/apis/iam/v1?hl=zh-cn) \u3002\n\u5982\u9700\u5411 IAM \u9032\u884c\u8eab\u4efd\u9a57\u8b49\uff0c\u8acb\u8a2d\u7f6e\u61c9\u7528\u9ed8\u8a8d\u6191\u64da\u3002  \u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [\u6e96\u5099\u5de5\u4f5c](#before-you-begin) \u3002\n [\u5728 GitHub \u4e0a\u67e5\u770b](https://github.com/GoogleCloudPlatform/dotnet-docs-samples/blob/HEAD/iam/api/ServiceAccountKeys/ServiceAccountKeysDelete.cs) \n```\nusing System;using Google.Apis.Auth.OAuth2;using Google.Apis.Iam.v1;using Google.Apis.Iam.v1.Data;public partial class ServiceAccountKeys{\u00a0 \u00a0 public static void DeleteKey(string fullKeyName)\u00a0 \u00a0 {\u00a0 \u00a0 \u00a0 \u00a0 var credential = GoogleCredential.GetApplicationDefault()\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 .CreateScoped(IamService.Scope.CloudPlatform);\u00a0 \u00a0 \u00a0 \u00a0 var service = new IamService(new IamService.Initializer\u00a0 \u00a0 \u00a0 \u00a0 {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 HttpClientInitializer = credential\u00a0 \u00a0 \u00a0 \u00a0 });\u00a0 \u00a0 \u00a0 \u00a0 service.Projects.ServiceAccounts.Keys.Delete(fullKeyName).Execute();\u00a0 \u00a0 \u00a0 \u00a0 Console.WriteLine(\"Deleted key: \" + fullKeyName);\u00a0 \u00a0 }}\n```\u5982\u9700\u77ad\u89e3\u5982\u4f55\u5b89\u88dd\u548c\u4f7f\u7528 IAM \u5ba2\u6236\u7aef\u5eab\uff0c\u8acb\u53c3\u95b1 [IAM \u5ba2\u6236\u7aef\u5eab](https://cloud.google.com/iam/docs/reference/libraries?hl=zh-cn) \u3002\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [IAM Go API \u53c3\u8003\u6587\u6a94](https://godoc.org/google.golang.org/genproto/googleapis/iam/admin/v1) \u3002\n\u5982\u9700\u5411 IAM \u9032\u884c\u8eab\u4efd\u9a57\u8b49\uff0c\u8acb\u8a2d\u7f6e\u61c9\u7528\u9ed8\u8a8d\u6191\u64da\u3002  \u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [\u6e96\u5099\u5de5\u4f5c](#before-you-begin) \u3002\n [\u5728 GitHub \u4e0a\u67e5\u770b](https://github.com/GoogleCloudPlatform/golang-samples/blob/HEAD/iam/snippets/service_account_keys_delete.go) \n```\nimport (\u00a0 \u00a0 \u00a0 \u00a0 \"context\"\u00a0 \u00a0 \u00a0 \u00a0 \"fmt\"\u00a0 \u00a0 \u00a0 \u00a0 \"io\"\u00a0 \u00a0 \u00a0 \u00a0 iam \"google.golang.org/api/iam/v1\")// deleteKey deletes a service account key.func deleteKey(w io.Writer, fullKeyName string) error {\u00a0 \u00a0 \u00a0 \u00a0 ctx := context.Background()\u00a0 \u00a0 \u00a0 \u00a0 service, err := iam.NewService(ctx)\u00a0 \u00a0 \u00a0 \u00a0 if err != nil {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 return fmt.Errorf(\"iam.NewService: %w\", err)\u00a0 \u00a0 \u00a0 \u00a0 }\u00a0 \u00a0 \u00a0 \u00a0 _, err = service.Projects.ServiceAccounts.Keys.Delete(fullKeyName).Do()\u00a0 \u00a0 \u00a0 \u00a0 if err != nil {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 return fmt.Errorf(\"Projects.ServiceAccounts.Keys.Delete: %w\", err)\u00a0 \u00a0 \u00a0 \u00a0 }\u00a0 \u00a0 \u00a0 \u00a0 fmt.Fprintf(w, \"Deleted key: %v\", fullKeyName)\u00a0 \u00a0 \u00a0 \u00a0 return nil}\n```\u5982\u9700\u77ad\u89e3\u5982\u4f55\u5b89\u88dd\u548c\u4f7f\u7528 IAM \u5ba2\u6236\u7aef\u5eab\uff0c\u8acb\u53c3\u95b1 [IAM \u5ba2\u6236\u7aef\u5eab](https://cloud.google.com/iam/docs/reference/libraries?hl=zh-cn) \u3002\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [IAM Java API \u53c3\u8003\u6587\u6a94](https://developers.google.com/api-client-library/java/apis/iam/v1?hl=zh-cn) \u3002\n\u5982\u9700\u5411 IAM \u9032\u884c\u8eab\u4efd\u9a57\u8b49\uff0c\u8acb\u8a2d\u7f6e\u61c9\u7528\u9ed8\u8a8d\u6191\u64da\u3002  \u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [\u6e96\u5099\u5de5\u4f5c](#before-you-begin) \u3002\n [\u5728 GitHub \u4e0a\u67e5\u770b](https://github.com/GoogleCloudPlatform/java-docs-samples/blob/HEAD/iam/api-client/src/main/java/iam/snippets/DeleteServiceAccountKey.java) \n```\nimport com.google.api.client.googleapis.javanet.GoogleNetHttpTransport;import com.google.api.client.json.gson.GsonFactory;import com.google.api.services.iam.v1.Iam;import com.google.api.services.iam.v1.IamScopes;import com.google.auth.http.HttpCredentialsAdapter;import com.google.auth.oauth2.GoogleCredentials;import java.io.IOException;import java.security.GeneralSecurityException;import java.util.Collections;public class DeleteServiceAccountKey {\u00a0 // Deletes a service account key.\u00a0 public static void deleteKey(String projectId, String serviceAccountName,\u00a0 \u00a0 \u00a0 String serviceAccountKey) {\u00a0 \u00a0 // String projectId = \"my-project-id\";\u00a0 \u00a0 // String serviceAccountName = \"my-service-account-name\";\u00a0 \u00a0 // String serviceAccountKey = \"key-name\";\u00a0 \u00a0 Iam service = null;\u00a0 \u00a0 try {\u00a0 \u00a0 \u00a0 service = initService();\u00a0 \u00a0 } catch (IOException | GeneralSecurityException e) {\u00a0 \u00a0 \u00a0 System.out.println(\"Unable to initialize service: \\n\" + e);\u00a0 \u00a0 \u00a0 return;\u00a0 \u00a0 }\u00a0 \u00a0 // Construct the service account email.\u00a0 \u00a0 // You can modify the \".iam.gserviceaccount.com\" to match the service account name in which\u00a0 \u00a0 // you want to delete the key.\u00a0 \u00a0 // See, https://cloud.google.com/iam/docs/creating-managing-service-account-keys?hl=en#deleting\u00a0 \u00a0 String serviceAccountEmail = serviceAccountName + \"@\" + projectId + \".iam.gserviceaccount.com\";\u00a0 \u00a0 try {\u00a0 \u00a0 \u00a0 String keyToDelete = String.format(\"projects/-/serviceAccounts/%s/keys/%s\",\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 serviceAccountEmail, serviceAccountKey);\u00a0 \u00a0 \u00a0 // Then you can delete the key\u00a0 \u00a0 \u00a0 service.projects().serviceAccounts().keys().delete(keyToDelete).execute();\u00a0 \u00a0 \u00a0 System.out.println(\"Deleted key: \" + keyToDelete);\u00a0 \u00a0 } catch (IOException e) {\u00a0 \u00a0 \u00a0 System.out.println(\"Unable to delete service account key: \\n\" + e);\u00a0 \u00a0 }\u00a0 }\u00a0 private static Iam initService() throws GeneralSecurityException, IOException {\u00a0 \u00a0 // Use the Application Default Credentials strategy for authentication. For more info, see:\u00a0 \u00a0 // https://cloud.google.com/docs/authentication/production#finding_credentials_automatically\u00a0 \u00a0 GoogleCredentials credential =\u00a0 \u00a0 \u00a0 \u00a0 GoogleCredentials.getApplicationDefault()\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 .createScoped(Collections.singleton(IamScopes.CLOUD_PLATFORM));\u00a0 \u00a0 // Initialize the IAM service, which can be used to send requests to the IAM API.\u00a0 \u00a0 Iam service =\u00a0 \u00a0 \u00a0 \u00a0 new Iam.Builder(\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 GoogleNetHttpTransport.newTrustedTransport(),\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 GsonFactory.getDefaultInstance(),\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 new HttpCredentialsAdapter(credential))\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 .setApplicationName(\"service-account-keys\")\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 .build();\u00a0 \u00a0 return service;\u00a0 }}\n```\u5982\u9700\u77ad\u89e3\u5982\u4f55\u5b89\u88dd\u548c\u4f7f\u7528 IAM \u5ba2\u6236\u7aef\u5eab\uff0c\u8acb\u53c3\u95b1 [IAM \u5ba2\u6236\u7aef\u5eab](https://cloud.google.com/iam/docs/reference/libraries?hl=zh-cn) \u3002\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [IAM Python API \u53c3\u8003\u6587\u6a94](https://developers.google.com/api-client-library/python/apis/iam/v1?hl=zh-cn) \u3002\n\u5982\u9700\u5411 IAM \u9032\u884c\u8eab\u4efd\u9a57\u8b49\uff0c\u8acb\u8a2d\u7f6e\u61c9\u7528\u9ed8\u8a8d\u6191\u64da\u3002  \u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [\u6e96\u5099\u5de5\u4f5c](#before-you-begin) \u3002\n [\u5728 GitHub \u4e0a\u67e5\u770b](https://github.com/GoogleCloudPlatform/python-docs-samples/blob/HEAD/iam/api-client/service_account_keys.py) \n```\nimport osfrom google.oauth2 import service_accountimport googleapiclient.discovery \u00a0# type: ignoredef delete_key(full_key_name: str) -> None:\u00a0 \u00a0 \"\"\"Deletes a service account key.\"\"\"\u00a0 \u00a0 credentials = service_account.Credentials.from_service_account_file(\u00a0 \u00a0 \u00a0 \u00a0 filename=os.environ[\"GOOGLE_APPLICATION_CREDENTIALS\"],\u00a0 \u00a0 \u00a0 \u00a0 scopes=[\"https://www.googleapis.com/auth/cloud-platform\"],\u00a0 \u00a0 )\u00a0 \u00a0 service = googleapiclient.discovery.build(\"iam\", \"v1\", credentials=credentials)\u00a0 \u00a0 service.projects().serviceAccounts().keys().delete(name=full_key_name).execute()\u00a0 \u00a0 print(\"Deleted key: \" + full_key_name)\n``` ` [projects.serviceAccounts.keys.delete](https://cloud.google.com/iam/docs/reference/rest/v1/projects.serviceAccounts.keys/delete?hl=zh-cn) ` \u65b9\u6cd5\u53ef\u522a\u9664\u670d\u52d9\u8cec\u865f\u5bc6\u9470\u3002\n\u5728\u4f7f\u7528\u4efb\u4f55\u8acb\u6c42\u6578\u64da\u4e4b\u524d\uff0c\u8acb\u5148\u9032\u884c\u4ee5\u4e0b\u66ff\u63db\uff1a- ``\uff1a\u60a8\u7684 Google Cloud \u9805\u76ee ID\u3002\u9805\u76ee ID \u662f\u5b57\u6bcd\u6578\u5b57\u5b57\u7b26\u4e32\uff0c\u4f8b\u5982`my-project`\u3002\n- ``\uff1a\u60a8\u8981\u522a\u9664\u5176\u5bc6\u9470\u7684\u670d\u52d9\u8cec\u865f\u7684\u540d\u7a31\u3002\n- ``\uff1a\u60a8\u8981\u522a\u9664\u7684\u5bc6\u9470\u7684 ID\u3002 \u5982\u9700\u67e5\u627e\u5bc6\u9470\u7684 ID\uff0c\u8acb [\u5217\u51fa\u670d\u52d9\u8cec\u865f\u7684\u6240\u6709\u5bc6\u9470](#list-keys) \uff0c\u627e\u5230\u8981\u522a\u9664\u7684\u5bc6\u9470\uff0c\u7136\u5f8c\u5f9e`name`\u5b57\u6bb5\u7684\u672b\u5c3e\u8907\u88fd\u5176 ID\u3002\u5bc6\u9470\u7684 ID \u662f`keys/`\u4e4b\u5f8c\u7684\u6240\u6709\u5167\u5bb9\u3002\nHTTP \u65b9\u6cd5\u548c\u7db2\u5740\uff1a\n```\nDELETE https://iam.googleapis.com/v1/projects/PROJECT_ID/serviceAccounts/SA_NAME@PROJECT_ID.iam.gserviceaccount.com/keys/KEY_ID\n```\n\u5982\u9700\u767c\u9001\u60a8\u7684\u8acb\u6c42\uff0c\u8acb\u5c55\u958b\u4ee5\u4e0b\u9078\u9805\u4e4b\u4e00\uff1a\n\u60a8\u61c9\u8a72\u6536\u5230\u985e\u4f3c\u4ee5\u4e0b\u5167\u5bb9\u7684 JSON \u97ff\u61c9\uff1a\n```\n{\n}\n```\n## \u5f8c\u7e8c\u6b65\u9a5f\n- \u77ad\u89e3\u5982\u4f55 [\u5217\u51fa\u548c\u7372\u53d6\u670d\u52d9\u8cec\u865f\u5bc6\u9470](https://cloud.google.com/iam/docs/keys-list-get?hl=zh-cn) \u3002\n- \u77ad\u89e3\u5982\u4f55 [\u4e0a\u50b3\u60a8\u81ea\u5df1\u7684\u516c\u5171\u670d\u52d9\u8cec\u865f\u5bc6\u9470](https://cloud.google.com/iam/docs/keys-upload?hl=zh-cn) \u3002\n- \u77ad\u89e3 [\u7ba1\u7406\u670d\u52d9\u8cec\u865f\u5bc6\u9470\u7684\u6700\u4f73\u5be6\u8e10](https://cloud.google.com/iam/docs/best-practices-for-managing-service-account-keys?hl=zh-cn) \u3002\n- \u77ad\u89e3 [\u4f7f\u7528\u670d\u52d9\u8cec\u865f\u5bc6\u9470\u9032\u884c\u8eab\u4efd\u9a57\u8b49\u7684\u66ff\u4ee3\u65b9\u6848](https://cloud.google.com/docs/authentication?hl=zh-cn#auth-decision-tree) \u3002", "guide": "IAM"}