{"title": "IAM - \u5c07\u670d\u52d9\u8cec\u865f\u95dc\u806f\u5230\u8cc7\u6e90", "url": "https://cloud.google.com/iam/docs/attach-service-accounts?hl=zh-cn", "abstract": "# IAM - \u5c07\u670d\u52d9\u8cec\u865f\u95dc\u806f\u5230\u8cc7\u6e90\n\u5c0d\u65bc\u67d0\u4e9b Google Cloud \u8cc7\u6e90\uff0c\u60a8\u53ef\u4ee5\u6307\u5b9a\u7528\u6236\u7ba1\u7406\u7684\u670d\u52d9\u8cec\u865f\uff0c\u4f9b\u8cc7\u6e90\u7528\u4f5c\u5176\u9ed8\u8a8d\u8eab\u4efd\u3002\u6b64\u904e\u7a0b\u7a31\u7232 \u201c\u5c07\u670d\u52d9\u8cec\u865f\u9644\u52a0\u5230\u8cc7\u6e90\u201d\u6216\u201c\u5c07\u670d\u52d9\u8cec\u865f\u8207\u8cc7\u6e90\u95dc\u806f\u201d \u3002\n\u7576\u8a72\u8cc7\u6e90\u9700\u8981\u8a2a\u554f\u5176\u4ed6 Google Cloud \u670d\u52d9\u548c\u8cc7\u6e90\u6642\uff0c\u5b83\u6703\u4f7f\u7528\u5176\u95dc\u806f\u7684\u670d\u52d9\u8cec\u865f\u4f5c\u7232\u5176\u8eab\u4efd\u3002\u4f8b\u5982\uff0c\u5982\u679c\u60a8 [\u5c07\u670d\u52d9\u8cec\u865f\u95dc\u806f\u5230 Compute Engine \u5be6\u4f8b](https://cloud.google.com/compute/docs/access/service-accounts?hl=zh-cn#associating_a_service_account_to_an_instance) \uff0c\u5247\u8a72\u5be6\u4f8b\u4e0a\u7684\u61c9\u7528\u4f7f\u7528 [\u5ba2\u6236\u7aef\u5eab](https://cloud.google.com/apis/docs/client-libraries-explained?hl=zh-cn) \u4f86\u8abf\u7528 Google Cloud API\uff0c\u9019\u4e9b\u61c9\u7528\u6703\u81ea\u52d5\u4ee5\u95dc\u806f\u7684\u670d\u52d9\u8cec\u865f\u8eab\u4efd\u9032\u884c\u8eab\u4efd\u9a57\u8b49\u3002\n\u672c\u9801\u9762\u4ecb\u7d39\u77ad\u5982\u4f55\u914d\u7f6e\u670d\u52d9\u8cec\u865f\uff0c\u4ee5\u4fbf\u60a8\u53ef\u4ee5\u5c07\u5176\u95dc\u806f\u5230\u8cc7\u6e90\u3002\n", "content": "## \u6e96\u5099\u5de5\u4f5c\n-   Titles in dynamic includes are not used anywhere, and we should avoid paying to translate them   \u5553\u7528 IAM and Resource Manager API\u3002 [\u5553\u7528 API](https://console.cloud.google.com/flows/enableapi?apiid=iam.googleapis.com%2Ccloudresourcemanager.googleapis.com&%3Bredirect=https%3A%2F%2Fconsole.cloud.google.com&hl=zh-cn) \n- \u78ba\u4fdd\u60a8\u77ad\u89e3 [\u670d\u52d9\u8cec\u865f\u5728 IAM \u4e2d\u7684\u5de5\u4f5c\u539f\u7406](https://cloud.google.com/iam/docs/service-accounts?hl=zh-cn) \u3002## \u5c07\u670d\u52d9\u8cec\u865f\u95dc\u806f\u5230\u8cc7\u6e90\n\u5728\u5927\u591a\u6578\u60c5\u6cc1\u4e0b\uff0c\u60a8\u5fc5\u9808\u5728\u5275\u5efa\u8cc7\u6e90\u6642\u5c07\u670d\u52d9\u8cec\u865f\u9644\u52a0\u5230\u8a72\u8cc7\u6e90\u3002\u5275\u5efa\u8cc7\u6e90\u5f8c\uff0c\u60a8\u7121\u6cd5\u66f4\u6539\u5c07\u54ea\u500b\u670d\u52d9\u8cec\u865f\u9644\u52a0\u5230\u8a72\u8cc7\u6e90\u3002Compute Engine \u5be6\u4f8b\u662f\u6b64\u898f\u5247\u7684\u4e00\u500b\u4f8b\u5916\u60c5\u6cc1\uff1b\u60a8\u53ef\u4ee5\u6839\u64da\u9700\u8981 [\u66f4\u6539\u9644\u52a0\u5230\u5be6\u4f8b\u7684\u670d\u52d9\u8cec\u865f](https://cloud.google.com/compute/docs/access/create-enable-service-accounts-for-instances?hl=zh-cn#changeserviceaccountandscopes) \u3002\n\u5728\u5c07\u670d\u52d9\u8cec\u865f\u9644\u52a0\u5230\u8cc7\u6e90\u4e4b\u524d\uff0c\u60a8\u5fc5\u9808\u5148\u914d\u7f6e\u670d\u52d9\u8cec\u865f\u3002\u6b64\u904e\u7a0b\u53d6\u6c7a\u65bc\u670d\u52d9\u8cec\u865f\u548c\u8cc7\u6e90\u662f\u4f4d\u65bc\u540c\u4e00\u9805\u76ee\u9084\u662f\u4e0d\u540c\u9805\u76ee\u4e2d\u3002\u914d\u7f6e\u670d\u52d9\u8cec\u865f\u5f8c\uff0c\u60a8\u53ef\u4ee5\u5275\u5efa\u8cc7\u6e90\u4e26\u5c07\u670d\u52d9\u8cec\u865f\u9644\u52a0\u5230\u8a72\u8cc7\u6e90\u3002\n### \u7232\u540c\u4e00\u9805\u76ee\u4e2d\u7684\u8cc7\u6e90\u9032\u884c\u914d\u7f6e\n\u5728\u5c07\u670d\u52d9\u8cec\u865f\u9644\u52a0\u5230\u540c\u4e00\u9805\u76ee\u4e2d\u7684\u5176\u4ed6\u8cc7\u6e90\u4e4b\u524d\uff0c\u8acb\u5411\u670d\u52d9\u8cec\u865f [\u6388\u4e88\u89d2\u8272](https://cloud.google.com/iam/docs/granting-changing-revoking-access?hl=zh-cn) \uff0c\u4ee5\u4fbf\u5176\u80fd\u5920\u8a2a\u554f\u76f8\u61c9\u8cc7\u6e90\uff0c\u5c31\u50cf\u60a8\u5411\u5176\u4ed6\u4efb\u4f55\u4e3b\u8cec\u865f\u6388\u4e88\u89d2\u8272\u4e00\u6a23\u3002\n### \u7232\u4e0d\u540c\u9805\u76ee\u4e2d\u7684\u8cc7\u6e90\u9032\u884c\u914d\u7f6e\n\u5728\u67d0\u4e9b\u60c5\u6cc1\u4e0b\uff0c\u60a8\u53ef\u80fd\u9700\u8981\u5c07\u670d\u52d9\u8cec\u865f\u9644\u52a0\u5230\u4f4d\u65bc\u5176\u4ed6\u9805\u76ee\u4e2d\u7684\u8cc7\u6e90\u3002\u4f8b\u5982\uff0c\u5982\u679c\u60a8 [\u5728\u55ae\u500b\u9805\u76ee\u4e2d\u5275\u5efa\u6240\u6709\u670d\u52d9\u8cec\u865f](https://cloud.google.com/iam/docs/service-account-overview?hl=zh-cn#locations) \uff0c\u5247\u53ef\u80fd\u9700\u8981\u5c07\u5176\u4e2d\u4e00\u500b\u670d\u52d9\u8cec\u865f\u9644\u52a0\u5230\u5176\u4ed6\u9805\u76ee\u4e2d\u7684\u65b0\u8cc7\u6e90\u3002\n\u5728\u5c07\u670d\u52d9\u8cec\u865f\u9023\u63a5\u5230\u5176\u4ed6\u9805\u76ee\u4e2d\u7684\u8cc7\u6e90\u4e4b\u524d\uff0c\u8acb\u5148\u57f7\u884c\u4ee5\u4e0b\u64cd\u4f5c\uff1a\n- \u5728\u670d\u52d9\u8cec\u865f\u6240\u5728\u7684\u9805\u76ee\u4e2d\uff0c\u6309\u7167\u672c\u9801\u9762\u4e2d\u7684\u6b65\u9a5f [\u5141\u8a31\u8de8\u9805\u76ee\u95dc\u806f\u670d\u52d9\u8cec\u865f](#enabling-cross-project) \u3002\n- \u78ba\u5b9a\u8981\u5728\u5176\u4e2d\u5275\u5efa\u8cc7\u6e90\u7684\u9805\u76ee\u3002\n- \u78ba\u5b9a\u60a8\u5c07\u9644\u52a0\u5230\u7684\u8cc7\u6e90\u7684\u670d\u52d9\u8cec\u865f\u985e\u578b\uff0c\u4ee5\u53ca\u8a72\u985e\u578b\u8cc7\u6e90\u7684\u670d\u52d9\u3002\u4f8b\u5982\uff0c\u5982\u679c\u60a8\u8981\u5275\u5efa Pub/Sub \u8a02\u95b1\uff0c\u5247 Pub/Sub \u662f\u64c1\u6709\u8a72\u8cc7\u6e90\u7684\u670d\u52d9\u3002\n- \u627e\u5230\u670d\u52d9\u7684\u670d\u52d9\u4ee3\u7406\u7684\u96fb\u5b50\u90f5\u4ef6\u5730\u5740\u3002\u4e0d\u540c\u7684\u670d\u52d9\u4f7f\u7528\u4e0d\u540c\u7684\u670d\u52d9\u4ee3\u7406\u3002\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [\u670d\u52d9\u4ee3\u7406](https://cloud.google.com/iam/docs/service-agents?hl=zh-cn) \u3002 **\u6ce8\u610f** \uff1a\u67d0\u4e9b\u670d\u52d9\uff08\u5305\u62ec Dataflow\u3001Dataproc \u548c Google Kubernetes Engine\uff09\u53ef\u4ee5\u5275\u5efa Compute Engine \u5be6\u4f8b\uff0c\u6216\u8005\u4ee5\u5176\u4ed6\u65b9\u5f0f\u4f9d\u8cf4\u65bc Compute Engine\u3002\u5c0d\u65bc\u9019\u4e9b\u670d\u52d9\uff0c\u60a8\u5fc5\u9808\u627e\u5230\u591a\u500b\u670d\u52d9\u4ee3\u7406\u7684\u96fb\u5b50\u90f5\u4ef6\u5730\u5740\uff1a\u4e00\u500b\u7528\u65bc Compute Engine\uff0c\u53e6\u4e00\u500b\u7528\u65bc\u90e8\u7f72\u5be6\u4f8b\u7684\u670d\u52d9\u3002\n- \u5411\u670d\u52d9\u4ee3\u7406\u6388\u4e88 Service Account Token Creator \u89d2\u8272 ( `roles/iam.serviceAccountTokenCreator` )\uff1a- \u5728 Google Cloud \u63a7\u5236\u6aaf\u4e2d\uff0c\u8f49\u5230 **\u670d\u52d9\u8cec\u865f** \u9801\u9762\u3002 [\u8f49\u5230\u201c\u670d\u52d9\u8cec\u865f\u201d](https://console.cloud.google.com/projectselector/iam-admin/serviceaccounts?hl=zh-cn) \n- \u9078\u64c7\u5c07\u60a8\u8981\u9644\u52a0\u5230\u8cc7\u6e90\u7684\u670d\u52d9\u8cec\u865f\u6240\u5c6c\u7684\u9805\u76ee\u3002\n- \u9ede\u64ca\u9644\u52a0\u5230\u8cc7\u6e90\u7684\u670d\u52d9\u8cec\u865f\u7684\u96fb\u5b50\u90f5\u4ef6\u5730\u5740\u3002\n- \u8f49\u5230 **\u6b0a\u9650** \u6a19\u7c64\u9801\uff0c\u627e\u5230 **\u6709\u6b0a\u8a2a\u554f\u6b64\u670d\u52d9\u8cec\u865f\u7684\u4e3b\u8cec\u865f** \u90e8\u5206\u3002\n- \u9ede\u64ca person_add **\u6388\u4e88\u8a2a\u554f\u6b0a\u9650** \uff0c\u7136\u5f8c\u8f38\u5165\u670d\u52d9\u4ee3\u7406\u7684\u96fb\u5b50\u90f5\u4ef6\u5730\u5740\u3002\n- \u9ede\u64ca **\u9078\u64c7\u89d2\u8272** \uff0c\u8f38\u5165 `Service Account Token Creator` \uff0c\u7136\u5f8c\u9ede\u64ca\u8a72\u89d2\u8272\u3002\n- \u9ede\u64ca **\u4fdd\u5b58** \u4ee5\u4fdd\u5b58\u66f4\u6539\u3002\n- \u53ef\u9078\uff1a\u5982\u679c\u60a8\u9700\u8981\u5411\u5176\u4ed6\u670d\u52d9\u4ee3\u7406\u6388\u4e88\u8a72\u89d2\u8272\uff0c\u8acb\u91cd\u8907\u57f7\u884c\u4e0a\u8ff0\u6b65\u9a5f\u3002\n\u4f7f\u7528 [gcloud iam service-accounts add-iam-policy-binding](https://cloud.google.com/sdk/gcloud/reference/iam/service-accounts/add-iam-policy-binding?hl=zh-cn) \u547d\u4ee4\uff1a\n```\ngcloud iam service-accounts add-iam-policy-binding \\\u00a0 \u00a0 SERVICE_ACCOUNT_NAME@PROJECT_ID.iam.gserviceaccount.com \\\u00a0 \u00a0 --member=serviceAccount:SERVICE_AGENT_EMAIL \\\u00a0 \u00a0 --role=roles/iam.serviceAccountTokenCreator\n```\n\u66ff\u63db\u4ee5\u4e0b\u503c\uff1a- ``\uff1a\u60a8\u8981\u9644\u52a0\u5230\u8cc7\u6e90\u7684\u7528\u6236\u7ba1\u7406\u670d\u52d9\u8cec\u865f\u7684\u540d\u7a31\u3002\n- ``\uff1a\u7528\u6236\u7ba1\u7406\u7684\u670d\u52d9\u8cec\u865f\u6240\u5728\u7684\u9805\u76ee ID\u3002\n- ``\uff1a\u670d\u52d9\u4ee3\u7406\u7684\u96fb\u5b50\u90f5\u4ef6\u5730\u5740\u3002\n\u8a72\u547d\u4ee4\u6703\u8f38\u51fa\u7528\u6236\u7ba1\u7406\u7684\u670d\u52d9\u8cec\u865f\u7684\u66f4\u65b0\u5f8c\u7684\u5141\u8a31\u653f\u7b56\u3002\n\u53ef\u9078\uff1a\u5982\u679c\u60a8\u9700\u8981\u5411\u5176\u4ed6\u670d\u52d9\u4ee3\u7406\u6388\u4e88\u8a72\u89d2\u8272\uff0c\u8acb\u518d\u6b21\u904b\u884c\u8a72\u547d\u4ee4\u3002\u8981\u6388\u4e88\u6b64\u89d2\u8272\uff0c\u8acb\u4f7f\u7528 read-modify-write \u6a21\u5f0f\u66f4\u65b0\u7528\u6236\u7ba1\u7406\u7684\u670d\u52d9\u8cec\u865f\u7684\u5141\u8a31\u653f\u7b56\u3002\n **\u9996\u5148\uff0c\u8b80\u53d6\u7528\u6236\u7ba1\u7406\u7684\u670d\u52d9\u8cec\u865f\u7684\u5141\u8a31\u653f\u7b56** \uff1a\n ` [projects.serviceAccounts.getIamPolicy](https://cloud.google.com/iam/docs/reference/rest/v1/projects.serviceAccounts/getIamPolicy?hl=zh-cn) ` \u65b9\u6cd5\u53ef\u8fd4\u56de\u670d\u52d9\u8cec\u865f\u7684\u5141\u8a31\u653f\u7b56\u3002\n\u5728\u4f7f\u7528\u4efb\u4f55\u8acb\u6c42\u6578\u64da\u4e4b\u524d\uff0c\u8acb\u5148\u9032\u884c\u4ee5\u4e0b\u66ff\u63db\uff1a- ``\uff1a\u60a8\u7684 Google Cloud \u9805\u76ee ID\u3002\u9805\u76ee ID \u662f\u5b57\u6bcd\u6578\u5b57\u5b57\u7b26\u4e32\uff0c\u4f8b\u5982`my-project`\u3002\n- ``\uff1a\u60a8\u7d81\u5b9a\u5230\u8cc7\u6e90\u7684\u7528\u6236\u7ba1\u7406\u670d\u52d9\u8cec\u865f\u7684\u540d\u7a31\u3002\nHTTP \u65b9\u6cd5\u548c\u7db2\u5740\uff1a\n```\nPOST https://iam.googleapis.com/v1/projects/PROJECT_ID/serviceAccounts/USER_SA_NAME@PROJECT_ID.iam.gserviceaccount.com:getIamPolicy\n```\n\u8acb\u6c42 JSON \u6b63\u6587\uff1a\n```\n{\n \"requestedPolicyVersion\": 3\n}\n```\n\u5982\u9700\u767c\u9001\u60a8\u7684\u8acb\u6c42\uff0c\u8acb\u5c55\u958b\u4ee5\u4e0b\u9078\u9805\u4e4b\u4e00\uff1a\n\u60a8\u61c9\u8a72\u6536\u5230\u985e\u4f3c\u4ee5\u4e0b\u5167\u5bb9\u7684 JSON \u97ff\u61c9\uff1a\n```\n{\n \"version\": 1,\n \"etag\": \"BwWl3KCTUMY=\",\n \"bindings\": [ {\n  \"role\": \"roles/iam.serviceAccountUser\",\n  \"members\": [  \"serviceAccount:my-service-account@my-project.iam.gserviceaccount.com\"\n  ]\n }\n ]\n}\n```\n **\u63a5\u4e0b\u4f86\uff0c\u8acb\u4fee\u6539\u5141\u8a31\u653f\u7b56\u4ee5\u5411\u670d\u52d9\u4ee3\u7406\u6388\u4e88 Service Account Token Creator \u89d2\u8272** \u3002\n```\n{\u00a0 \"version\": 1,\u00a0 \"etag\": \"BwWl3KCTUMY=\",\u00a0 \"bindings\": [\u00a0 \u00a0 {\u00a0 \u00a0 \u00a0 \"role\": \"roles/iam.serviceAccountTokenCreator\",\u00a0 \u00a0 \u00a0 \"members\": [\u00a0 \u00a0 \u00a0 \u00a0 \"serviceAccount:SERVICE_AGENT_EMAIL\"\u00a0 \u00a0 \u00a0 ]\u00a0 \u00a0 },\u00a0 \u00a0 {\u00a0 \u00a0 \u00a0 \"role\": \"roles/iam.serviceAccountUser\",\u00a0 \u00a0 \u00a0 \"members\": [\u00a0 \u00a0 \u00a0 \u00a0 \"serviceAccount:SERVICE_ACCOUNT_NAME@PROJECT_ID.iam.gserviceaccount.com\"\u00a0 \u00a0 \u00a0 ]\u00a0 \u00a0 }\u00a0 ]}\n```\n\u66ff\u63db\u4ee5\u4e0b\u5167\u5bb9\uff1a- ``\uff1a\u670d\u52d9\u4ee3\u7406\u7684\u96fb\u5b50\u90f5\u4ef6\u5730\u5740\n- ``\uff1a\u7528\u6236\u7ba1\u7406\u7684\u670d\u52d9\u8cec\u865f\u7684\u540d\u7a31\u3002\n- ``\uff1a\u7528\u6236\u7ba1\u7406\u7684\u670d\u52d9\u8cec\u865f\u6240\u5728\u7684\u9805\u76ee ID\u3002\n **\u6ce8\u610f\uff1a** \u5982\u679c\u60a8\u9700\u8981\u5411\u591a\u500b\u670d\u52d9\u4ee3\u7406\u6388\u4e88\u8a72\u89d2\u8272\uff0c\u8acb\u5c07\u6240\u6709\u670d\u52d9\u8cec\u865f\u6dfb\u52a0\u5230 `members` \u6578\u7d44\u4e2d\u3002\n **\u6700\u5f8c\uff0c\u5beb\u5165\u66f4\u65b0\u5f8c\u7684\u5141\u8a31\u653f\u7b56** \uff1a\n ` [projects.serviceAccounts.setIamPolicy](https://cloud.google.com/iam/docs/reference/rest/v1/projects.serviceAccounts/setIamPolicy?hl=zh-cn) ` \u65b9\u6cd5\u6703\u66f4\u65b0\u60a8\u7684\u670d\u52d9\u8cec\u865f\u7684\u5141\u8a31\u653f\u7b56\u3002\n\u5728\u4f7f\u7528\u4efb\u4f55\u8acb\u6c42\u6578\u64da\u4e4b\u524d\uff0c\u8acb\u5148\u9032\u884c\u4ee5\u4e0b\u66ff\u63db\uff1a- ``\uff1a\u60a8\u7684 Google Cloud \u9805\u76ee ID\u3002\u9805\u76ee ID \u662f\u5b57\u6bcd\u6578\u5b57\u5b57\u7b26\u4e32\uff0c\u4f8b\u5982`my-project`\u3002\n- ``\uff1a\u60a8\u7d81\u5b9a\u5230\u8cc7\u6e90\u7684\u7528\u6236\u7ba1\u7406\u670d\u52d9\u8cec\u865f\u7684\u540d\u7a31\u3002\n- ``\uff1a\u7232\u7528\u6236\u7ba1\u7406\u7684\u670d\u52d9\u8cec\u865f\u5275\u5efa\u8a2a\u554f\u4ee4\u724c\u7684\u670d\u52d9\u4ee3\u7406\u7684\u96fb\u5b50\u90f5\u4ef6\u5730\u5740\u3002\nHTTP \u65b9\u6cd5\u548c\u7db2\u5740\uff1a\n```\nPOST https://iam.googleapis.com/v1/projects/PROJECT_ID/serviceAccounts/SERVICE_ACCOUNT_NAME@PROJECT_ID.iam.gserviceaccount.com:setIamPolicy\n```\n\u8acb\u6c42 JSON \u6b63\u6587\uff1a\n```\n{\n \"policy\": {\n \"version\": 1,\n \"etag\": \"BwWl3KCTUMY=\",\n \"bindings\": [  {\n  \"role\": \"roles/iam.serviceAccountTokenCreator\",\n  \"members\": [   \"serviceAccount:SERVICE_AGENT_EMAIL\"\n  ]\n  },\n  {\n  \"role\": \"roles/iam.serviceAccountUser\",\n  \"members\": [   \"serviceAccount:SERVICE_ACCOUNT_NAME@PROJECT_ID.iam.gserviceaccount.com\"\n  ]\n  }\n ]\n }\n}\n```\n\u5982\u9700\u767c\u9001\u60a8\u7684\u8acb\u6c42\uff0c\u8acb\u5c55\u958b\u4ee5\u4e0b\u9078\u9805\u4e4b\u4e00\uff1a\n\u60a8\u61c9\u8a72\u6536\u5230\u985e\u4f3c\u4ee5\u4e0b\u5167\u5bb9\u7684 JSON \u97ff\u61c9\uff1a\n```\n{\n \"version\": 1,\n \"etag\": \"BwWo331TkHE=\",\n \"bindings\": [ {\n  \"role\": \"roles/iam.serviceAccountTokenCreator\",\n  \"members\": [  \"serviceAccount:SERVICE_AGENT_EMAIL\"\n  ]\n },\n {\n  \"role\": \"roles/iam.serviceAccountUser\",\n  \"members\": [  \"serviceAccount:my-service-account@my-project.iam.gserviceaccount.com\"\n  ]\n }\n ]\n}\n```\n### \u5c07\u670d\u52d9\u8cec\u865f\u95dc\u806f\u5230\u65b0\u8cc7\u6e90\n\u914d\u7f6e\u7528\u6236\u7ba1\u7406\u7684\u670d\u52d9\u8cec\u865f\u5f8c\uff0c\u60a8\u53ef\u4ee5\u5275\u5efa\u65b0\u8cc7\u6e90\u4e26\u5c07\u670d\u52d9\u8cec\u865f\u9644\u52a0\u5230\u8a72\u8cc7\u6e90\u3002\u8acb\u52d9\u5fc5\u5728\u76f8\u61c9\u7684\u9805\u76ee\u4e2d\u5275\u5efa\u65b0\u8cc7\u6e90\u3002\n\u8acb\u53c3\u95b1\u60a8\u8981\u5275\u5efa\u7684\u8cc7\u6e90\u985e\u578b\u5c0d\u61c9\u7684\u8aaa\u660e\uff1a\n| \u5275\u5efa\u8cc7\u6e90\u6642\u9644\u52a0\u670d\u52d9\u8cec\u865f | \u5275\u5efa\u8cc7\u6e90\u6642\u9644\u52a0\u670d\u52d9\u8cec\u865f.1       |\n|:--------------------------|:--------------------------------------------------|\n| AI Platform Prediction | \u6a21\u578b\u7248\u672c           |\n| AI Platform Training  | \u4f5c\u696d            |\n| App Engine \u6a19\u6e96\u74b0\u5883  | \u61c9\u7528\u7248\u672c           |\n| App Engine \u67d4\u6027\u74b0\u5883  | \u61c9\u7528\u7248\u672c           |\n| Cloud Composer   | \u74b0\u5883            |\n| Cloud Functions   | Cloud Functions \u51fd\u6578        |\n| Cloud Life Sciences  | \u6d41\u6c34\u7dda           |\n| Cloud Run     | \u670d\u52d9            |\n| Cloud Scheduler   | \u4f5c\u696d            |\n| Cloud Source Repositories | \u9805\u76ee\u914d\u7f6e \u4ee3\u78bc\u5eab\u7684 Pub/Sub \u914d\u7f6e     |\n| Compute Engine   | \u5be6\u4f8b \u5be6\u4f8b\u6a21\u677f          |\n| Dataflow     | \u4f5c\u696d            |\n| Datalab     | \u5be6\u4f8b            |\n| Dataproc     | \u96c6\u7fa3            |\n| Eventarc     | \u89f8\u767c\u5668           |\n| Google Kubernetes Engine | \u96c6\u7fa3 \u7bc0\u9ede\u6c60          |\n| \u7b46\u8a18\u672c     | \u7b46\u8a18\u672c\u5be6\u4f8b          |\n| Pub/Sub     | \u8a02\u95b1            |\n| Vertex AI     | \u81ea\u5b9a\u7fa9\u4f5c\u696d \u90e8\u7f72\u7684\u6a21\u578b\u6578 \u8d85\u53c3\u6578\u8abf\u7bc0\u4f5c\u696d \u8a13\u7df4\u6d41\u6c34\u7dda |\n| \u5de5\u4f5c\u6d41     | \u5de5\u4f5c\u6d41           |\n\u5275\u5efa\u8cc7\u6e90\u4e26\u5c07\u670d\u52d9\u8cec\u865f\u9644\u52a0\u5230\u8a72\u8cc7\u6e90\u4e4b\u5f8c\uff0c\u60a8\u53ef\u4ee5\u5411\u8a72\u670d\u52d9\u8cec\u865f\u6388\u4e88\u89d2\u8272\uff0c\u4ee5\u4fbf\u5b83\u53ef\u4ee5\u8a2a\u554f\u9069\u7576\u7684\u8cc7\u6e90\u3002\u8a72\u904e\u7a0b\u8207\u5411\u4efb\u4f55\u5176\u4ed6\u4e3b\u8cec\u865f\u6388\u4e88\u89d2\u8272\u7684\u904e\u7a0b\u76f8\u540c\u3002\n\u5982\u9700\u77ad\u89e3\u5982\u4f55\u6388\u4e88\u89d2\u8272\uff0c\u8acb\u53c3\u95b1 [\u6388\u4e88\u3001\u66f4\u6539\u548c\u64a4\u6d88\u5c0d\u8cc7\u6e90\u7684\u8a2a\u554f\u6b0a\u9650](https://cloud.google.com/iam/docs/granting-changing-revoking-access?hl=zh-cn) \u3002\n## \u5c07\u670d\u52d9\u8cec\u865f\u95dc\u806f\u5230\u5176\u4ed6\u9805\u76ee\u4e2d\u7684\u8cc7\u6e90\n\u9ed8\u8a8d\u60c5\u6cc1\u4e0b\uff0c\u60a8\u7121\u6cd5\u5c07\u5728\u4e00\u500b\u9805\u76ee\u4e2d\u5275\u5efa\u670d\u52d9\u8cec\u865f\u9644\u52a0\u5230\u5176\u4ed6\u9805\u76ee\u4e2d\u7684\u8cc7\u6e90\u4e0a\u3002\u5982\u679c\u60a8\u5e0c\u671b\u5c07\u6240\u6709\u670d\u52d9\u8cec\u865f\u4fdd\u7559\u5728\u4e00\u500b\u9805\u76ee\u4e2d\uff0c\u5247\u5fc5\u9808\u66f4\u65b0\u8a72\u9805\u76ee\u7684 [\u7d44\u7e54\u653f\u7b56](https://cloud.google.com/resource-manager/docs/organization-policy/overview?hl=zh-cn) \u3002\n**\u91cd\u8981\u63d0\u793a** \uff1a\u66f4\u65b0\u7d44\u7e54\u653f\u7b56\u5f8c\uff0c\u6211\u5011\u5f37\u70c8\u5efa\u8b70\u60a8\u4e0d\u8981\u64a4\u6d88\u66f4\u6539\uff0c\u7279\u5225\u662f\u5728\u751f\u7522\u74b0\u5883\u4e2d\u3002\u5982\u679c\u60a8\u64a4\u6d88\u66f4\u6539\uff0c\u60a8\u7684 Google Cloud \u8cc7\u6e90\u53ef\u80fd\u7121\u6cd5\u6b63\u5e38\u5de5\u4f5c\u3002\n### \u5141\u8a31\u8de8\u9805\u76ee\u95dc\u806f\u670d\u52d9\u8cec\u865f\n\u5982\u9700\u5141\u8a31\u7528\u6236\u5c07\u4e00\u500b\u9805\u76ee\u4e2d\u7684\u670d\u52d9\u8cec\u865f\u95dc\u806f\u5230\u53e6\u4e00\u500b\u9805\u76ee\u4e2d\u7684\u8cc7\u6e90\uff0c\u8acb\u5728\u670d\u52d9\u8cec\u865f\u6240\u5728\u7684\u9805\u76ee\u7684\u7d44\u7e54\u653f\u7b56\u4e2d\uff0c\u6aa2\u67e5\u4ee5\u4e0b [\u5e03\u723e\u503c\u9650\u5236\u689d\u4ef6](https://cloud.google.com/resource-manager/docs/organization-policy/understanding-constraints?hl=zh-cn#boolean_constraint) \uff1a\n- \u78ba\u4fdd \u4e0d\u6703\u7232\u9805\u76ee\u5f37\u5236\u57f7\u884c `iam.disableCrossProjectServiceAccountUsage` \u5e03\u723e\u503c\u9650\u5236\u3002\u6b64\u5e03\u723e\u503c\u9650\u5236\u689d\u4ef6\u7528\u65bc\u63a7\u5236\u662f\u5426\u53ef\u4ee5\u5c07\u670d\u52d9\u8cec\u865f\u9644\u52a0\u5230\u53e6\u4e00\u500b\u9805\u76ee\u4e2d\u7684\u8cc7\u6e90\u3002\u9ed8\u8a8d\u60c5\u6cc1\u4e0b\uff0c\u5f37\u5236\u57f7\u884c\u9650\u5236\u689d\u4ef6\u3002\u5982\u679c\u4e0d\u5f37\u5236\u57f7\u884c\u6b64\u9650\u5236\u689d\u4ef6\uff0cIAM \u6703\u6dfb\u52a0\u4e00\u500b [\u9805\u76ee\u5b89\u5168\u9396](https://cloud.google.com/resource-manager/docs/project-liens?hl=zh-cn) \uff0c\u4ee5\u9632\u6b62\u522a\u9664\u9805\u76ee\u3002\u6b64\u5b89\u5168\u9396\u7684\u4f86\u6e90\u7232 `iam.googleapis.com/cross-project-service-accounts` \u3002\u6211\u5011\u5f37\u70c8\u5efa\u8b70\u60a8\u4e0d\u8981\u522a\u9664\u6b64\u5b89\u5168\u9396\u3002\n- \u63a8\u85a6\uff1a\u78ba\u4fdd\u5c0d\u9805\u76ee\u5f37\u5236\u57f7\u884c `iam.restrictCrossProjectServiceAccountLienRemoval` \u5e03\u723e\u503c\u9650\u5236\u689d\u4ef6\u3002\u6b64\u5e03\u723e\u503c\u9650\u5236\u689d\u4ef6\u53ef\u78ba\u4fdd\u4e3b\u8cec\u865f\u53ea\u6709\u5728\u7d44\u7e54\u7d1a\u5c64\u5177\u6709 `resourcemanager.projects.updateLiens` \u6b0a\u9650\u6642\u7e94\u53ef\u4ee5\u79fb\u9664\u9805\u76ee\u5b89\u5168\u9396\u3002\u5982\u679c\u672a\u5f37\u5236\u57f7\u884c\u6b64\u9650\u5236\u689d\u4ef6\uff0c\u5247\u4e3b\u8cec\u865f\u5728\u9805\u76ee\u7d1a\u5c64\u64c1\u6709\u6b64\u6b0a\u9650\u6642\u53ef\u4ee5\u79fb\u9664\u9805\u76ee\u5b89\u5168\u9396\u3002\n\u5982\u9700\u77ad\u89e3\u5982\u4f55\u5728\u7d44\u7e54\u653f\u7b56\u4e2d\u67e5\u770b\u6216\u66f4\u6539\u5e03\u723e\u503c\u9650\u5236\u689d\u4ef6\uff0c\u8acb\u53c3\u95b1 [\u5275\u5efa\u548c\u7ba1\u7406\u7d44\u7e54\u653f\u7b56](https://cloud.google.com/resource-manager/docs/organization-policy/creating-managing-policies?hl=zh-cn) \u3002\n### \u7981\u6b62\u8de8\u9805\u76ee\u95dc\u806f\u670d\u52d9\u8cec\u865f\n\u5982\u679c\u60a8\u4e4b\u524d [\u5141\u8a31\u8de8\u9805\u76ee\u95dc\u806f\u670d\u52d9\u8cec\u865f](#attaching-different-project) \uff0c\u6211\u5011\u5f37\u70c8\u5efa\u8b70\u60a8\u4e0d\u8981\u505c\u7528\u6b64\u529f\u80fd\uff0c\u5c24\u5176\u662f\u5728\u751f\u7522\u74b0\u5883\u4e2d\u3002\n**\u6ce8\u610f** \uff1a\u5982\u679c\u60a8\u7981\u6b62\u8de8\u9805\u76ee\u95dc\u806f\u670d\u52d9\u8cec\u865f\uff0c\u5247\u60a8\u7684 Google Cloud \u8cc7\u6e90\u53ef\u80fd\u7121\u6cd5\u6b63\u5e38\u904b\u884c\u3002\n\u5177\u9ad4\u4f86\u8aaa\uff0c\u5728\u670d\u52d9\u8cec\u865f\u6240\u5728\u7684\u9805\u76ee\u4e2d\uff0c\u60a8\u4e0d\u61c9\u505a\u51fa\u4ee5\u4e0b\u4efb\u4f55\u66f4\u6539\uff1a\n- \u8acb\u52ff\u66f4\u65b0\u9805\u76ee\u7684\u7d44\u7e54\u653f\u7b56\u4ee5\u5f37\u5236\u57f7\u884c`iam.disableCrossProjectServiceAccountUsage`\u5e03\u723e\u503c\u9650\u5236\u689d\u4ef6\u3002\n- \u4e0d\u8981\u5c07\u9805\u76ee\u7684\u7d44\u7e54\u653f\u7b56\u66f4\u65b0\u7232\u4e0d\u5f37\u5236\u57f7\u884c`iam.restrictCrossProjectServiceAccountLienRemoval`\u5e03\u723e\u503c\u9650\u5236\u689d\u4ef6\u3002\n- \u8acb\u52ff\u79fb\u9664\u5e36\u6709\u6e90`iam.googleapis.com/cross-project-service-accounts`\u7684 [\u9805\u76ee\u5b89\u5168\u9396](https://cloud.google.com/resource-manager/docs/project-liens?hl=zh-cn) \uff0c\u4ee5\u9632\u522a\u9664\u9805\u76ee\u3002\n- \u8acb\u52ff\u522a\u9664\u9805\u76ee\u3002\n\u5982\u679c\u60a8\u9858\u610f\u63a5\u53d7\u505c\u7528\u6b64\u529f\u80fd\u7684\u98a8\u96aa\uff0c\u5247\u53ef\u4ee5\u901a\u904e [\u505c\u7528\u60a8\u5728\u5404\u7a2e\u9805\u76ee\u4e2d\u4f7f\u7528\u7684\u670d\u52d9\u8cec\u865f](https://cloud.google.com/iam/docs/service-accounts-disable-enable?hl=zh-cn#disabling) \u4f86\u964d\u4f4e\u98a8\u96aa\uff0c\u7136\u5f8c\u76e3\u63a7 Google Cloud \u74b0\u5883\u5f9e\u800c\u767c\u73fe\u554f\u984c\u3002 \u5982\u679c\u767c\u73fe\u4efb\u4f55\u554f\u984c\uff0c\u60a8\u53ef\u4ee5 [\u91cd\u65b0\u5553\u7528\u670d\u52d9\u8cec\u865f](https://cloud.google.com/iam/docs/service-accounts-disable-enable?hl=zh-cn#enabling) \u3002\u5982\u679c\u672a\u767c\u73fe\u4efb\u4f55\u554f\u984c\uff0c\u5247\u53ef\u80fd\u662f\u56e0\u7232\u6c92\u6709\u4efb\u4f55 Google Cloud \u8cc7\u6e90\u4f9d\u8cf4\u65bc\u5176\u4ed6\u9805\u76ee\u4e2d\u7684\u670d\u52d9\u8cec\u865f\u3002\n## \u5f8c\u7e8c\u6b65\u9a5f\n- \u77ad\u89e3\u5982\u4f55 [\u5c07\u670d\u52d9\u8cec\u865f\u95dc\u806f\u5230 Compute Engine \u5be6\u4f8b](https://cloud.google.com/compute/docs/access/service-accounts?hl=zh-cn#associating_a_service_account_to_an_instance) \u3002\n- \u67e5\u770b\u4e26\u61c9\u7528 [\u4fdd\u8b77\u670d\u52d9\u8cec\u865f\u7684\u6700\u4f73\u5be6\u8e10](https://cloud.google.com/iam/docs/best-practices-service-accounts?hl=zh-cn) \u3002\n- \u8a73\u7d30\u77ad\u89e3 [IAM \u7684\u5be9\u8988\u65e5\u8a8c\u8a18\u9304](https://cloud.google.com/iam/docs/audit-logging?hl=zh-cn) \u3002", "guide": "IAM"}