{"title": "IAM - \u4f7f\u7528\u5ba2\u6236\u7aef\u5eab\u6388\u4e88\u89d2\u8272", "url": "https://cloud.google.com/iam/docs/write-policy-client-libraries?hl=zh-cn", "abstract": "# IAM - \u4f7f\u7528\u5ba2\u6236\u7aef\u5eab\u6388\u4e88\u89d2\u8272\n# \u4f7f\u7528\u5ba2\u6236\u7aef\u5eab\u6388\u4e88\u89d2\u8272\n\u77ad\u89e3\u5982\u4f55\u4ee5\u60a8\u559c\u611b\u7684\u7de8\u7a0b\u8a9e\u8a00\u958b\u59cb\u4f7f\u7528 Resource Manager API \u4e2d\u7684 IAM \u65b9\u6cd5\u3002\u5982\u9700\u5728 Google Cloud \u63a7\u5236\u6aaf\u4e2d\u76f4\u63a5\u9075\u5faa\u6709\u95dc\u6b64\u4efb\u52d9\u7684\u5206\u6b65\u6307\u5c0e\uff0c\u8acb\u9ede\u64ca **\u64cd\u4f5c\u6f14\u793a** \uff1a\n [\u64cd\u4f5c\u6f14\u793a](https://console.cloud.google.com/?walkthrough_id=iam--api_quickstart_index&hl=zh-cn) ", "content": "## \u6e96\u5099\u5de5\u4f5c\n### \u5275\u5efa Google Cloud \u9805\u76ee\u5728\u6b64\u5feb\u901f\u5165\u9580\u4e2d\uff0c\u60a8\u9700\u8981\u4e00\u500b\u65b0\u7684 Google Cloud \u9805\u76ee\u3002\n **\u8b66\u544a** \uff1a\u5982\u679c\u60a8\u4f7f\u7528\u73fe\u6709\u9805\u76ee\uff0c\u5247\u5b8c\u6210\u6b64\u5feb\u901f\u5165\u9580\u5f8c\uff0c\u90e8\u5206\u7528\u6236\u5c07\u66ab\u6642\u80fd\u5920\u8a2a\u554f\u8a72\u9805\u76ee\u4e2d\u7684\u8cc7\u6e90\u3002\n- Titles in dynamic includes are not used anywhere, and we should avoid paying to translate them\nTitles in dynamic includes are not used anywhere, and we should avoid paying to translate them\n## \u5b89\u88dd\u5ba2\u6236\u7aef\u5eab\u5982\u9700\u8a73\u7d30\u77ad\u89e3\u5982\u4f55\u8a2d\u7f6e C# \u958b\u767c\u74b0\u5883\uff0c\u8acb\u53c3\u95b1 [C# \u958b\u767c\u74b0\u5883\u8a2d\u7f6e\u6307\u5357](https://cloud.google.com/dotnet/docs/setup?hl=zh-cn) \u3002\n```\ninstall-package Google.Apis.Iam.v1\ninstall-package Google.Apis.CloudResourceManager.v1\n``````\ngo get golang.org/x/oauth2/google\ngo get google.golang.org/api/cloudresourcemanager/v1\n```\u5982\u9700\u8a73\u7d30\u77ad\u89e3\u5982\u4f55\u8a2d\u7f6e Java \u958b\u767c\u74b0\u5883\uff0c\u8acb\u53c3\u95b1 [Java \u958b\u767c\u74b0\u5883\u8a2d\u7f6e\u6307\u5357](https://cloud.google.com/java/docs/setup?hl=zh-cn) \u3002\n\u5982\u679c\u60a8\u4f7f\u7528\u7684\u662f\n [Maven](https://maven.apache.org/) \n\uff0c\u8acb\u5c07\u5176\u6dfb\u52a0\u5230\u60a8\u7684\n`pom.xml`\n\u6587\u4ef6\u4e2d\u3002\n```\n<dependency>\u00a0 <groupId>com.google.apis</groupId>\u00a0 <artifactId>google-api-services-cloudresourcemanager</artifactId>\u00a0 <version>v3-rev20240128-2.0.0</version></dependency><dependency>\u00a0 <groupId>com.google.auth</groupId>\u00a0 <artifactId>google-auth-library-oauth2-http</artifactId></dependency><dependency>\u00a0 <groupId>com.google.http-client</groupId>\u00a0 <artifactId>google-http-client-jackson2</artifactId></dependency><dependency>\u00a0 <groupId>com.google.apis</groupId>\u00a0 <artifactId>google-api-services-iam</artifactId>\u00a0 <version>v1-rev20240118-2.0.0</version></dependency>\n```\u5982\u9700\u8a73\u7d30\u77ad\u89e3\u5982\u4f55\u8a2d\u7f6e Python \u958b\u767c\u74b0\u5883\uff0c\u8acb\u53c3\u95b1 [Python \u958b\u767c\u74b0\u5883\u8a2d\u7f6e\u6307\u5357](https://cloud.google.com/python/docs/setup?hl=zh-cn) \u3002\n```\npip install --upgrade google-api-python-client google-auth google-auth-httplib2\n```\n## \u8b80\u53d6\u3001\u4fee\u6539\u548c\u5beb\u5165\u5141\u8a31\u653f\u7b56\u672c\u5feb\u901f\u5165\u9580\u4e2d\u7684\u4ee3\u78bc\u6bb5\u6703\u57f7\u884c\u4ee5\u4e0b\u64cd\u4f5c\uff1a- \u521d\u59cb\u5316\u7528\u65bc\u7ba1\u7406 Google Cloud \u9805\u76ee\u7684 Resource Manager \u670d\u52d9\u3002\n- \u8b80\u53d6\u9805\u76ee\u7684 [\u5141\u8a31\u653f\u7b56](https://cloud.google.com/iam/docs/overview?hl=zh-cn#cloud-iam-policy) \u3002\n- \u901a\u904e\u5c07 Log Writer \u89d2\u8272 (`roles/logging.logWriter`) \u6388\u4e88\u60a8\u7684 Google \u8cec\u865f\u4f86\u4fee\u6539\u5141\u8a31\u653f\u7b56\u3002\n- \u5beb\u5165\u66f4\u65b0\u5f8c\u7684\u5141\u8a31\u653f\u7b56\u3002\n- \u8f38\u51fa\u9805\u76ee\u7d1a\u5c64\u5177\u6709 Log Writer \u89d2\u8272 (`roles/logging.logWriter`) \u7684\u6240\u6709\u4e3b\u8cec\u865f\u3002\n- \u64a4\u6d88 Log Writer \u89d2\u8272\u3002\n\u5728\u904b\u884c\u4ee3\u78bc\u6bb5\u4e4b\u524d\u66ff\u63db\u4ee5\u4e0b\u503c\uff1a- ``\uff1a\u60a8\u7684\u9805\u76ee\u7684 ID\u3002\n- ``\uff1a\u60a8\u7684 Google \u8cec\u865f\u7684\u96fb\u5b50\u90f5\u4ef6\u5730\u5740\u548c\u524d\u7db4`user:`\u7684\u7d44\u5408\u3002\u4f8b\u5982`user:tanya@example.com`\u3002\n **\u6ce8\u610f** \uff1a\u4ee5\u4e0b\u4ee3\u78bc\u6bb5\u901a\u904e\u7372\u53d6\u3001\u4fee\u6539\u548c\u8a2d\u7f6e\u9805\u76ee\u7684 **\u5141\u8a31\u653f\u7b56** \u4f86\u4fee\u6539\u8a2a\u554f\u6b0a\u9650\u3002\u5982\u9700\u8a73\u7d30\u77ad\u89e3\u5141\u8a31\u653f\u7b56\uff0c\u8acb\u53c3\u95b1 [IAM \u6982\u89bd](https://cloud.google.com/iam/docs/overview?hl=zh-cn#cloud-iam-policy) \u3002\n\u5982\u9700\u77ad\u89e3\u5982\u4f55\u5b89\u88dd\u548c\u4f7f\u7528 Resource Manager \u5ba2\u6236\u7aef\u5eab\uff0c\u8acb\u53c3\u95b1 [Resource Manager \u5ba2\u6236\u7aef\u5eab](https://cloud.google.com/iam/docs/reference/libraries?hl=zh-cn) \u3002\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [Resource Manager C# API \u53c3\u8003\u6587\u6a94](https://googleapis.dev/dotnet/Google.Apis.CloudResourceManager.v1/latest/api/Google.Apis.CloudResourceManager.v1.html) \u3002\n\u5982\u9700\u5411 Resource Manager \u9032\u884c\u8eab\u4efd\u9a57\u8b49\uff0c\u8acb\u8a2d\u7f6e\u61c9\u7528\u9ed8\u8a8d\u6191\u64da\u3002  \u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [\u7232\u672c\u5730\u958b\u767c\u74b0\u5883\u8a2d\u7f6e\u8eab\u4efd\u9a57\u8b49](https://cloud.google.com/docs/authentication/provide-credentials-adc?hl=zh-cn#local-dev) \u3002\n [\u5728 GitHub \u4e0a\u67e5\u770b](https://github.com/GoogleCloudPlatform/dotnet-docs-samples/blob/HEAD/iam/api/QuickStart/QuickStart.cs) \n```\nusing Google.Apis.Auth.OAuth2;using Google.Apis.CloudResourceManager.v1;using Google.Apis.CloudResourceManager.v1.Data;using Google.Apis.Iam.v1;using System;using System.Collections.Generic;using System.Linq;public class QuickStart{\u00a0 \u00a0 public static void Main(string[] args)\u00a0 \u00a0 {\u00a0 \u00a0 \u00a0 \u00a0 // TODO: Replace with your project ID\u00a0 \u00a0 \u00a0 \u00a0 var projectId = \"your-project\";\u00a0 \u00a0 \u00a0 \u00a0 // TODO: Replace with the ID of your member in the form \"user:member@example.com\"\u00a0 \u00a0 \u00a0 \u00a0 var member = \"your-member\";\u00a0 \u00a0 \u00a0 \u00a0 // Role to be granted\u00a0 \u00a0 \u00a0 \u00a0 var role = \"roles/logging.logWriter\";\u00a0 \u00a0 \u00a0 \u00a0 // Initialize service\u00a0 \u00a0 \u00a0 \u00a0 CloudResourceManagerService crmService = InitializeService();\u00a0 \u00a0 \u00a0 \u00a0 // Grant your member the \"Log Writer\" role for your project\u00a0 \u00a0 \u00a0 \u00a0 AddBinding(crmService, projectId, member, role);\u00a0 \u00a0 \u00a0 \u00a0 // Get the project's policy and print all members with the the \"Log Writer\" role\u00a0 \u00a0 \u00a0 \u00a0 var policy = GetPolicy(crmService, projectId);\u00a0 \u00a0 \u00a0 \u00a0 var binding = policy.Bindings.FirstOrDefault(x => x.Role == role);\u00a0 \u00a0 \u00a0 \u00a0 Console.WriteLine(\"Role: \" + binding.Role);\u00a0 \u00a0 \u00a0 \u00a0 Console.Write(\"Members: \");\u00a0 \u00a0 \u00a0 \u00a0 foreach (var m in binding.Members)\u00a0 \u00a0 \u00a0 \u00a0 {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 Console.Write(\"[\" + m + \"] \");\u00a0 \u00a0 \u00a0 \u00a0 }\u00a0 \u00a0 \u00a0 \u00a0 Console.WriteLine();\u00a0 \u00a0 \u00a0 \u00a0 // Remove member from the \"Log Writer\" role\u00a0 \u00a0 \u00a0 \u00a0 RemoveMember(crmService, projectId, member, role);\u00a0 \u00a0 }\u00a0 \u00a0 public static CloudResourceManagerService InitializeService()\u00a0 \u00a0 {\u00a0 \u00a0 \u00a0 \u00a0 // Get credentials\u00a0 \u00a0 \u00a0 \u00a0 var credential = GoogleCredential.GetApplicationDefault()\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 .CreateScoped(IamService.Scope.CloudPlatform);\u00a0 \u00a0 \u00a0 \u00a0 // Create the Cloud Resource Manager service object\u00a0 \u00a0 \u00a0 \u00a0 CloudResourceManagerService crmService = new CloudResourceManagerService(\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 new CloudResourceManagerService.Initializer\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 HttpClientInitializer = credential\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 });\u00a0 \u00a0 \u00a0 \u00a0 return crmService;\u00a0 \u00a0 }\u00a0 \u00a0 public static Policy GetPolicy(CloudResourceManagerService crmService, String projectId)\u00a0 \u00a0 {\u00a0 \u00a0 \u00a0 \u00a0 // Get the project's policy by calling the\u00a0 \u00a0 \u00a0 \u00a0 // Cloud Resource Manager Projects API\u00a0 \u00a0 \u00a0 \u00a0 var policy = crmService.Projects.GetIamPolicy(\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 new GetIamPolicyRequest(),\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 projectId).Execute();\u00a0 \u00a0 \u00a0 \u00a0 return policy;\u00a0 \u00a0 }\u00a0 \u00a0 public static void SetPolicy(CloudResourceManagerService crmService, String projectId, Policy policy)\u00a0 \u00a0 {\u00a0 \u00a0 \u00a0 \u00a0 // Set the project's policy by calling the\u00a0 \u00a0 \u00a0 \u00a0 // Cloud Resource Manager Projects API\u00a0 \u00a0 \u00a0 \u00a0 crmService.Projects.SetIamPolicy(\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0new SetIamPolicyRequest\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0{\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0Policy = policy\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0}, projectId).Execute();\u00a0 \u00a0 }\u00a0 \u00a0 public static void AddBinding(\u00a0 \u00a0 \u00a0 \u00a0 CloudResourceManagerService crmService,\u00a0 \u00a0 \u00a0 \u00a0 string projectId,\u00a0 \u00a0 \u00a0 \u00a0 string member,\u00a0 \u00a0 \u00a0 \u00a0 string role)\u00a0 \u00a0 {\u00a0 \u00a0 \u00a0 \u00a0 // Get the project's policy\u00a0 \u00a0 \u00a0 \u00a0 var policy = GetPolicy(crmService, projectId);\u00a0 \u00a0 \u00a0 \u00a0 // Find binding in policy\u00a0 \u00a0 \u00a0 \u00a0 var binding = policy.Bindings.FirstOrDefault(x => x.Role == role);\u00a0 \u00a0 \u00a0 \u00a0 // If binding already exists, add member to binding\u00a0 \u00a0 \u00a0 \u00a0 if (binding != null)\u00a0 \u00a0 \u00a0 \u00a0 {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 binding.Members.Add(member);\u00a0 \u00a0 \u00a0 \u00a0 }\u00a0 \u00a0 \u00a0 \u00a0 // If binding does not exist, add binding to policy\u00a0 \u00a0 \u00a0 \u00a0 else\u00a0 \u00a0 \u00a0 \u00a0 {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 binding = new Binding\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 Role = role,\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 Members = new List<string> { member }\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 };\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 policy.Bindings.Add(binding);\u00a0 \u00a0 \u00a0 \u00a0 }\u00a0 \u00a0 \u00a0 \u00a0 // Set the updated policy\u00a0 \u00a0 \u00a0 \u00a0 SetPolicy(crmService, projectId, policy);\u00a0 \u00a0 }\u00a0 \u00a0 public static void RemoveMember(\u00a0 \u00a0 \u00a0 \u00a0 CloudResourceManagerService crmService,\u00a0 \u00a0 \u00a0 \u00a0 string projectId,\u00a0 \u00a0 \u00a0 \u00a0 string member,\u00a0 \u00a0 \u00a0 \u00a0 string role)\u00a0 \u00a0 {\u00a0 \u00a0 \u00a0 \u00a0 // Get the project's policy\u00a0 \u00a0 \u00a0 \u00a0 var policy = GetPolicy(crmService, projectId);\u00a0 \u00a0 \u00a0 \u00a0 // Remove the member from the role\u00a0 \u00a0 \u00a0 \u00a0 var binding = policy.Bindings.FirstOrDefault(x => x.Role == role);\u00a0 \u00a0 \u00a0 \u00a0 if (binding == null)\u00a0 \u00a0 \u00a0 \u00a0 {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 Console.WriteLine(\"Role does not exist in policy.\");\u00a0 \u00a0 \u00a0 \u00a0 }\u00a0 \u00a0 \u00a0 \u00a0 else\u00a0 \u00a0 \u00a0 \u00a0 {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 if (binding.Members.Contains(member))\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 binding.Members.Remove(member);\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 }\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 else\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 Console.WriteLine(\"The member has not been granted this role.\");\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 }\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 if (binding.Members.Count == 0)\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 policy.Bindings.Remove(binding);\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 }\u00a0 \u00a0 \u00a0 \u00a0 }\u00a0 \u00a0 \u00a0 \u00a0 // Set the updated policy\u00a0 \u00a0 \u00a0 \u00a0 SetPolicy(crmService, projectId, policy);\u00a0 \u00a0 }}\n```\u5982\u9700\u77ad\u89e3\u5982\u4f55\u5b89\u88dd\u548c\u4f7f\u7528 Resource Manager \u5ba2\u6236\u7aef\u5eab\uff0c\u8acb\u53c3\u95b1 [Resource Manager \u5ba2\u6236\u7aef\u5eab](https://cloud.google.com/iam/docs/reference/libraries?hl=zh-cn) \u3002\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [Resource Manager Go API \u53c3\u8003\u6587\u6a94](https://godoc.org/google.golang.org/api/cloudresourcemanager/v1) \u3002\n\u5982\u9700\u5411 Resource Manager \u9032\u884c\u8eab\u4efd\u9a57\u8b49\uff0c\u8acb\u8a2d\u7f6e\u61c9\u7528\u9ed8\u8a8d\u6191\u64da\u3002  \u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [\u7232\u672c\u5730\u958b\u767c\u74b0\u5883\u8a2d\u7f6e\u8eab\u4efd\u9a57\u8b49](https://cloud.google.com/docs/authentication/provide-credentials-adc?hl=zh-cn#local-dev) \u3002\n [\u5728 GitHub \u4e0a\u67e5\u770b](https://github.com/GoogleCloudPlatform/golang-samples/blob/HEAD/iam/quickstart/quickstart.go) \n```\npackage mainimport (\u00a0 \u00a0 \u00a0 \u00a0 \"context\"\u00a0 \u00a0 \u00a0 \u00a0 \"flag\"\u00a0 \u00a0 \u00a0 \u00a0 \"fmt\"\u00a0 \u00a0 \u00a0 \u00a0 \"log\"\u00a0 \u00a0 \u00a0 \u00a0 \"strings\"\u00a0 \u00a0 \u00a0 \u00a0 \"time\"\u00a0 \u00a0 \u00a0 \u00a0 \"google.golang.org/api/cloudresourcemanager/v1\")func main() {\u00a0 \u00a0 \u00a0 \u00a0 // TODO: Add your project ID\u00a0 \u00a0 \u00a0 \u00a0 projectID := flag.String(\"project_id\", \"\", \"Cloud Project ID\")\u00a0 \u00a0 \u00a0 \u00a0 // TODO: Add the ID of your member in the form \"user:member@example.com\"\u00a0 \u00a0 \u00a0 \u00a0 member := flag.String(\"member_id\", \"\", \"Your member ID\")\u00a0 \u00a0 \u00a0 \u00a0 flag.Parse()\u00a0 \u00a0 \u00a0 \u00a0 // The role to be granted\u00a0 \u00a0 \u00a0 \u00a0 var role string = \"roles/logging.logWriter\"\u00a0 \u00a0 \u00a0 \u00a0 // Initializes the Cloud Resource Manager service\u00a0 \u00a0 \u00a0 \u00a0 ctx := context.Background()\u00a0 \u00a0 \u00a0 \u00a0 crmService, err := cloudresourcemanager.NewService(ctx)\u00a0 \u00a0 \u00a0 \u00a0 if err != nil {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 log.Fatalf(\"cloudresourcemanager.NewService: %v\", err)\u00a0 \u00a0 \u00a0 \u00a0 }\u00a0 \u00a0 \u00a0 \u00a0 // Grants your member the \"Log writer\" role for your project\u00a0 \u00a0 \u00a0 \u00a0 addBinding(crmService, *projectID, *member, role)\u00a0 \u00a0 \u00a0 \u00a0 // Gets the project's policy and prints all members with the \"Log Writer\" role\u00a0 \u00a0 \u00a0 \u00a0 policy := getPolicy(crmService, *projectID)\u00a0 \u00a0 \u00a0 \u00a0 // Find the policy binding for role. Only one binding can have the role.\u00a0 \u00a0 \u00a0 \u00a0 var binding *cloudresourcemanager.Binding\u00a0 \u00a0 \u00a0 \u00a0 for _, b := range policy.Bindings {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 if b.Role == role {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 binding = b\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 break\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 }\u00a0 \u00a0 \u00a0 \u00a0 }\u00a0 \u00a0 \u00a0 \u00a0 fmt.Println(\"Role: \", binding.Role)\u00a0 \u00a0 \u00a0 \u00a0 fmt.Print(\"Members: \", strings.Join(binding.Members, \", \"))\u00a0 \u00a0 \u00a0 \u00a0 // Removes member from the \"Log writer\" role\u00a0 \u00a0 \u00a0 \u00a0 removeMember(crmService, *projectID, *member, role)}// addBinding adds the member to the project's IAM policyfunc addBinding(crmService *cloudresourcemanager.Service, projectID, member, role string) {\u00a0 \u00a0 \u00a0 \u00a0 policy := getPolicy(crmService, projectID)\u00a0 \u00a0 \u00a0 \u00a0 // Find the policy binding for role. Only one binding can have the role.\u00a0 \u00a0 \u00a0 \u00a0 var binding *cloudresourcemanager.Binding\u00a0 \u00a0 \u00a0 \u00a0 for _, b := range policy.Bindings {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 if b.Role == role {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 binding = b\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 break\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 }\u00a0 \u00a0 \u00a0 \u00a0 }\u00a0 \u00a0 \u00a0 \u00a0 if binding != nil {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 // If the binding exists, adds the member to the binding\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 binding.Members = append(binding.Members, member)\u00a0 \u00a0 \u00a0 \u00a0 } else {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 // If the binding does not exist, adds a new binding to the policy\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 binding = &cloudresourcemanager.Binding{\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 Role: \u00a0 \u00a0role,\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 Members: []string{member},\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 }\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 policy.Bindings = append(policy.Bindings, binding)\u00a0 \u00a0 \u00a0 \u00a0 }\u00a0 \u00a0 \u00a0 \u00a0 setPolicy(crmService, projectID, policy)}// removeMember removes the member from the project's IAM policyfunc removeMember(crmService *cloudresourcemanager.Service, projectID, member, role string) {\u00a0 \u00a0 \u00a0 \u00a0 policy := getPolicy(crmService, projectID)\u00a0 \u00a0 \u00a0 \u00a0 // Find the policy binding for role. Only one binding can have the role.\u00a0 \u00a0 \u00a0 \u00a0 var binding *cloudresourcemanager.Binding\u00a0 \u00a0 \u00a0 \u00a0 var bindingIndex int\u00a0 \u00a0 \u00a0 \u00a0 for i, b := range policy.Bindings {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 if b.Role == role {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 binding = b\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 bindingIndex = i\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 break\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 }\u00a0 \u00a0 \u00a0 \u00a0 }\u00a0 \u00a0 \u00a0 \u00a0 // Order doesn't matter for bindings or members, so to remove, move the last item\u00a0 \u00a0 \u00a0 \u00a0 // into the removed spot and shrink the slice.\u00a0 \u00a0 \u00a0 \u00a0 if len(binding.Members) == 1 {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 // If the member is the only member in the binding, removes the binding\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 last := len(policy.Bindings) - 1\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 policy.Bindings[bindingIndex] = policy.Bindings[last]\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 policy.Bindings = policy.Bindings[:last]\u00a0 \u00a0 \u00a0 \u00a0 } else {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 // If there is more than one member in the binding, removes the member\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 var memberIndex int\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 for i, mm := range binding.Members {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 if mm == member {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 memberIndex = i\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 }\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 }\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 last := len(policy.Bindings[bindingIndex].Members) - 1\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 binding.Members[memberIndex] = binding.Members[last]\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 binding.Members = binding.Members[:last]\u00a0 \u00a0 \u00a0 \u00a0 }\u00a0 \u00a0 \u00a0 \u00a0 setPolicy(crmService, projectID, policy)}// getPolicy gets the project's IAM policyfunc getPolicy(crmService *cloudresourcemanager.Service, projectID string) *cloudresourcemanager.Policy {\u00a0 \u00a0 \u00a0 \u00a0 ctx := context.Background()\u00a0 \u00a0 \u00a0 \u00a0 ctx, cancel := context.WithTimeout(ctx, time.Second*10)\u00a0 \u00a0 \u00a0 \u00a0 defer cancel()\u00a0 \u00a0 \u00a0 \u00a0 request := new(cloudresourcemanager.GetIamPolicyRequest)\u00a0 \u00a0 \u00a0 \u00a0 policy, err := crmService.Projects.GetIamPolicy(projectID, request).Do()\u00a0 \u00a0 \u00a0 \u00a0 if err != nil {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 log.Fatalf(\"Projects.GetIamPolicy: %v\", err)\u00a0 \u00a0 \u00a0 \u00a0 }\u00a0 \u00a0 \u00a0 \u00a0 return policy}// setPolicy sets the project's IAM policyfunc setPolicy(crmService *cloudresourcemanager.Service, projectID string, policy *cloudresourcemanager.Policy) {\u00a0 \u00a0 \u00a0 \u00a0 ctx := context.Background()\u00a0 \u00a0 \u00a0 \u00a0 ctx, cancel := context.WithTimeout(ctx, time.Second*10)\u00a0 \u00a0 \u00a0 \u00a0 defer cancel()\u00a0 \u00a0 \u00a0 \u00a0 request := new(cloudresourcemanager.SetIamPolicyRequest)\u00a0 \u00a0 \u00a0 \u00a0 request.Policy = policy\u00a0 \u00a0 \u00a0 \u00a0 policy, err := crmService.Projects.SetIamPolicy(projectID, request).Do()\u00a0 \u00a0 \u00a0 \u00a0 if err != nil {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 log.Fatalf(\"Projects.SetIamPolicy: %v\", err)\u00a0 \u00a0 \u00a0 \u00a0 }}\n```\u5982\u9700\u77ad\u89e3\u5982\u4f55\u5b89\u88dd\u548c\u4f7f\u7528 Resource Manager \u5ba2\u6236\u7aef\u5eab\uff0c\u8acb\u53c3\u95b1 [Resource Manager \u5ba2\u6236\u7aef\u5eab](https://cloud.google.com/iam/docs/reference/libraries?hl=zh-cn) \u3002\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [Resource Manager Java API \u53c3\u8003\u6587\u6a94](https://cloud.google.com/java/docs/reference/google-cloud-resourcemanager/latest/overview?hl=zh-cn) \u3002\n\u5982\u9700\u5411 Resource Manager \u9032\u884c\u8eab\u4efd\u9a57\u8b49\uff0c\u8acb\u8a2d\u7f6e\u61c9\u7528\u9ed8\u8a8d\u6191\u64da\u3002  \u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [\u7232\u672c\u5730\u958b\u767c\u74b0\u5883\u8a2d\u7f6e\u8eab\u4efd\u9a57\u8b49](https://cloud.google.com/docs/authentication/provide-credentials-adc?hl=zh-cn#local-dev) \u3002\n [\u5728 GitHub \u4e0a\u67e5\u770b](https://github.com/GoogleCloudPlatform/java-docs-samples/blob/HEAD/iam/api-client/src/main/java/iam/snippets/Quickstart.java) \n```\nimport com.google.api.client.googleapis.javanet.GoogleNetHttpTransport;import com.google.api.client.json.gson.GsonFactory;import com.google.api.services.cloudresourcemanager.v3.CloudResourceManager;import com.google.api.services.cloudresourcemanager.v3.model.Binding;import com.google.api.services.cloudresourcemanager.v3.model.GetIamPolicyRequest;import com.google.api.services.cloudresourcemanager.v3.model.Policy;import com.google.api.services.cloudresourcemanager.v3.model.SetIamPolicyRequest;import com.google.api.services.iam.v1.IamScopes;import com.google.auth.http.HttpCredentialsAdapter;import com.google.auth.oauth2.GoogleCredentials;import java.io.IOException;import java.security.GeneralSecurityException;import java.util.Collections;import java.util.List;public class Quickstart {\u00a0 public static void main(String[] args) {\u00a0 \u00a0 // TODO: Replace with your project ID in the form \"projects/your-project-id\".\u00a0 \u00a0 String projectId = \"your-project\";\u00a0 \u00a0 // TODO: Replace with the ID of your member in the form \"user:member@example.com\"\u00a0 \u00a0 String member = \"your-member\";\u00a0 \u00a0 // The role to be granted.\u00a0 \u00a0 String role = \"roles/logging.logWriter\";\u00a0 \u00a0 // Initializes the Cloud Resource Manager service.\u00a0 \u00a0 CloudResourceManager crmService = null;\u00a0 \u00a0 try {\u00a0 \u00a0 \u00a0 crmService = initializeService();\u00a0 \u00a0 } catch (IOException | GeneralSecurityException e) {\u00a0 \u00a0 \u00a0 System.out.println(\"Unable to initialize service: \\n\" + e.getMessage() + e.getStackTrace());\u00a0 \u00a0 }\u00a0 \u00a0 // Grants your member the \"Log writer\" role for your project.\u00a0 \u00a0 addBinding(crmService, projectId, member, role);\u00a0 \u00a0 // Get the project's policy and print all members with the \"Log Writer\" role\u00a0 \u00a0 Policy policy = getPolicy(crmService, projectId);\u00a0 \u00a0 Binding binding = null;\u00a0 \u00a0 List<Binding> bindings = policy.getBindings();\u00a0 \u00a0 for (Binding b : bindings) {\u00a0 \u00a0 \u00a0 if (b.getRole().equals(role)) {\u00a0 \u00a0 \u00a0 \u00a0 binding = b;\u00a0 \u00a0 \u00a0 \u00a0 break;\u00a0 \u00a0 \u00a0 }\u00a0 \u00a0 }\u00a0 \u00a0 System.out.println(\"Role: \" + binding.getRole());\u00a0 \u00a0 System.out.print(\"Members: \");\u00a0 \u00a0 for (String m : binding.getMembers()) {\u00a0 \u00a0 \u00a0 System.out.print(\"[\" + m + \"] \");\u00a0 \u00a0 }\u00a0 \u00a0 System.out.println();\u00a0 \u00a0 // Removes member from the \"Log writer\" role.\u00a0 \u00a0 removeMember(crmService, projectId, member, role);\u00a0 }\u00a0 public static CloudResourceManager initializeService()\u00a0 \u00a0 \u00a0 throws IOException, GeneralSecurityException {\u00a0 \u00a0 // Use the Application Default Credentials strategy for authentication. For more info, see:\u00a0 \u00a0 // https://cloud.google.com/docs/authentication/production#finding_credentials_automatically\u00a0 \u00a0 GoogleCredentials credential =\u00a0 \u00a0 \u00a0 \u00a0 GoogleCredentials.getApplicationDefault()\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 .createScoped(Collections.singleton(IamScopes.CLOUD_PLATFORM));\u00a0 \u00a0 // Creates the Cloud Resource Manager service object.\u00a0 \u00a0 CloudResourceManager service =\u00a0 \u00a0 \u00a0 \u00a0 new CloudResourceManager.Builder(\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 GoogleNetHttpTransport.newTrustedTransport(),\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 GsonFactory.getDefaultInstance(),\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 new HttpCredentialsAdapter(credential))\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 .setApplicationName(\"iam-quickstart\")\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 .build();\u00a0 \u00a0 return service;\u00a0 }\u00a0 public static void addBinding(\u00a0 \u00a0 \u00a0 CloudResourceManager crmService, String projectId, String member, String role) {\u00a0 \u00a0 // Gets the project's policy.\u00a0 \u00a0 Policy policy = getPolicy(crmService, projectId);\u00a0 \u00a0 // If policy is not retrieved, return early.\u00a0 \u00a0 if (policy == null) {\u00a0 \u00a0 \u00a0 return;\u00a0 \u00a0 }\u00a0 \u00a0 // Finds binding in policy, if it exists.\u00a0 \u00a0 Binding binding = null;\u00a0 \u00a0 for (Binding b : policy.getBindings()) {\u00a0 \u00a0 \u00a0 if (b.getRole().equals(role)) {\u00a0 \u00a0 \u00a0 \u00a0 binding = b;\u00a0 \u00a0 \u00a0 \u00a0 break;\u00a0 \u00a0 \u00a0 }\u00a0 \u00a0 }\u00a0 \u00a0 if (binding != null) {\u00a0 \u00a0 \u00a0 // If binding already exists, adds member to binding.\u00a0 \u00a0 \u00a0 binding.getMembers().add(member);\u00a0 \u00a0 } else {\u00a0 \u00a0 \u00a0 // If binding does not exist, adds binding to policy.\u00a0 \u00a0 \u00a0 binding = new Binding();\u00a0 \u00a0 \u00a0 binding.setRole(role);\u00a0 \u00a0 \u00a0 binding.setMembers(Collections.singletonList(member));\u00a0 \u00a0 \u00a0 policy.getBindings().add(binding);\u00a0 \u00a0 }\u00a0 \u00a0 // Sets the updated policy.\u00a0 \u00a0 setPolicy(crmService, projectId, policy);\u00a0 }\u00a0 public static void removeMember(\u00a0 \u00a0 \u00a0 CloudResourceManager crmService, String projectId, String member, String role) {\u00a0 \u00a0 // Gets the project's policy.\u00a0 \u00a0 Policy policy = getPolicy(crmService, projectId);\u00a0 \u00a0 // Removes the member from the role.\u00a0 \u00a0 Binding binding = null;\u00a0 \u00a0 for (Binding b : policy.getBindings()) {\u00a0 \u00a0 \u00a0 if (b.getRole().equals(role)) {\u00a0 \u00a0 \u00a0 \u00a0 binding = b;\u00a0 \u00a0 \u00a0 \u00a0 break;\u00a0 \u00a0 \u00a0 }\u00a0 \u00a0 }\u00a0 \u00a0 if (binding != null && binding.getMembers().contains(member)) {\u00a0 \u00a0 \u00a0 binding.getMembers().remove(member);\u00a0 \u00a0 \u00a0 if (binding.getMembers().isEmpty()) {\u00a0 \u00a0 \u00a0 \u00a0 policy.getBindings().remove(binding);\u00a0 \u00a0 \u00a0 }\u00a0 \u00a0 }\u00a0 \u00a0 // Sets the updated policy.\u00a0 \u00a0 setPolicy(crmService, projectId, policy);\u00a0 }\u00a0 public static Policy getPolicy(CloudResourceManager crmService, String projectId) {\u00a0 \u00a0 // Gets the project's policy by calling the\u00a0 \u00a0 // Cloud Resource Manager Projects API.\u00a0 \u00a0 Policy policy = null;\u00a0 \u00a0 try {\u00a0 \u00a0 \u00a0 GetIamPolicyRequest request = new GetIamPolicyRequest();\u00a0 \u00a0 \u00a0 policy = crmService.projects().getIamPolicy(projectId, request).execute();\u00a0 \u00a0 } catch (IOException e) {\u00a0 \u00a0 \u00a0 System.out.println(\"Unable to get policy: \\n\" + e.getMessage() + e.getStackTrace());\u00a0 \u00a0 }\u00a0 \u00a0 return policy;\u00a0 }\u00a0 private static void setPolicy(CloudResourceManager crmService, String projectId, Policy policy) {\u00a0 \u00a0 // Sets the project's policy by calling the\u00a0 \u00a0 // Cloud Resource Manager Projects API.\u00a0 \u00a0 try {\u00a0 \u00a0 \u00a0 SetIamPolicyRequest request = new SetIamPolicyRequest();\u00a0 \u00a0 \u00a0 request.setPolicy(policy);\u00a0 \u00a0 \u00a0 crmService.projects().setIamPolicy(projectId, request).execute();\u00a0 \u00a0 } catch (IOException e) {\u00a0 \u00a0 \u00a0 System.out.println(\"Unable to set policy: \\n\" + e.getMessage() + e.getStackTrace());\u00a0 \u00a0 }\u00a0 }}\n```\u5982\u9700\u77ad\u89e3\u5982\u4f55\u5b89\u88dd\u548c\u4f7f\u7528 Resource Manager \u5ba2\u6236\u7aef\u5eab\uff0c\u8acb\u53c3\u95b1 [Resource Manager \u5ba2\u6236\u7aef\u5eab](https://cloud.google.com/iam/docs/reference/libraries?hl=zh-cn) \u3002\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [Resource Manager Python API \u53c3\u8003\u6587\u6a94](https://developers.google.com/resources/api-libraries/documentation/cloudresourcemanager/v1/python/latest/?hl=zh-cn) \u3002\n\u5982\u9700\u5411 Resource Manager \u9032\u884c\u8eab\u4efd\u9a57\u8b49\uff0c\u8acb\u8a2d\u7f6e\u61c9\u7528\u9ed8\u8a8d\u6191\u64da\u3002  \u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [\u7232\u672c\u5730\u958b\u767c\u74b0\u5883\u8a2d\u7f6e\u8eab\u4efd\u9a57\u8b49](https://cloud.google.com/docs/authentication/provide-credentials-adc?hl=zh-cn#local-dev) \u3002\n [\u5728 GitHub \u4e0a\u67e5\u770b](https://github.com/GoogleCloudPlatform/python-docs-samples/blob/HEAD/iam/api-client/quickstart.py) \n```\nimport google.authimport googleapiclient.discoverydef quickstart(project_id: str, member: str) -> None:\u00a0 \u00a0 \"\"\"Gets a policy, adds a member, prints their permissions, and removes the member.\"\"\"\u00a0 \u00a0 # Role to be granted.\u00a0 \u00a0 role = \"roles/logging.logWriter\"\u00a0 \u00a0 # Initializes service.\u00a0 \u00a0 crm_service = initialize_service()\u00a0 \u00a0 # Grants your member the 'Log Writer' role for the project.\u00a0 \u00a0 modify_policy_add_role(crm_service, project_id, role, member)\u00a0 \u00a0 # Gets the project's policy and prints all members with the 'Log Writer' role.\u00a0 \u00a0 policy = get_policy(crm_service, project_id)\u00a0 \u00a0 binding = next(b for b in policy[\"bindings\"] if b[\"role\"] == role)\u00a0 \u00a0 print(f'Role: {(binding[\"role\"])}')\u00a0 \u00a0 print(\"Members: \")\u00a0 \u00a0 for m in binding[\"members\"]:\u00a0 \u00a0 \u00a0 \u00a0 print(f\"[{m}]\")\u00a0 \u00a0 # Removes the member from the 'Log Writer' role.\u00a0 \u00a0 modify_policy_remove_member(crm_service, project_id, role, member)def initialize_service() -> dict:\u00a0 \u00a0 \"\"\"Initializes a Cloud Resource Manager service.\"\"\"\u00a0 \u00a0 credentials, _ = google.auth.default(\u00a0 \u00a0 \u00a0 \u00a0 scopes=[\"https://www.googleapis.com/auth/cloud-platform\"]\u00a0 \u00a0 )\u00a0 \u00a0 crm_service = googleapiclient.discovery.build(\u00a0 \u00a0 \u00a0 \u00a0 \"cloudresourcemanager\", \"v1\", credentials=credentials\u00a0 \u00a0 )\u00a0 \u00a0 return crm_servicedef modify_policy_add_role(\u00a0 \u00a0 crm_service: str, project_id: str, role: str, member: str) -> None:\u00a0 \u00a0 \"\"\"Adds a new role binding to a policy.\"\"\"\u00a0 \u00a0 policy = get_policy(crm_service, project_id)\u00a0 \u00a0 binding = None\u00a0 \u00a0 for b in policy[\"bindings\"]:\u00a0 \u00a0 \u00a0 \u00a0 if b[\"role\"] == role:\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 binding = b\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 break\u00a0 \u00a0 if binding is not None:\u00a0 \u00a0 \u00a0 \u00a0 binding[\"members\"].append(member)\u00a0 \u00a0 else:\u00a0 \u00a0 \u00a0 \u00a0 binding = {\"role\": role, \"members\": [member]}\u00a0 \u00a0 \u00a0 \u00a0 policy[\"bindings\"].append(binding)\u00a0 \u00a0 set_policy(crm_service, project_id, policy)def modify_policy_remove_member(\u00a0 \u00a0 crm_service: str, project_id: str, role: str, member: str) -> None:\u00a0 \u00a0 \"\"\"Removes a \u00a0member from a role binding.\"\"\"\u00a0 \u00a0 policy = get_policy(crm_service, project_id)\u00a0 \u00a0 binding = next(b for b in policy[\"bindings\"] if b[\"role\"] == role)\u00a0 \u00a0 if \"members\" in binding and member in binding[\"members\"]:\u00a0 \u00a0 \u00a0 \u00a0 binding[\"members\"].remove(member)\u00a0 \u00a0 set_policy(crm_service, project_id, policy)def get_policy(crm_service: str, project_id: str, version: int = 3) -> dict:\u00a0 \u00a0 \"\"\"Gets IAM policy for a project.\"\"\"\u00a0 \u00a0 policy = (\u00a0 \u00a0 \u00a0 \u00a0 crm_service.projects()\u00a0 \u00a0 \u00a0 \u00a0 .getIamPolicy(\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 resource=project_id,\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 body={\"options\": {\"requestedPolicyVersion\": version}},\u00a0 \u00a0 \u00a0 \u00a0 )\u00a0 \u00a0 \u00a0 \u00a0 .execute()\u00a0 \u00a0 )\u00a0 \u00a0 return policydef set_policy(crm_service: str, project_id: str, policy: str) -> dict:\u00a0 \u00a0 \"\"\"Sets IAM policy for a project.\"\"\"\u00a0 \u00a0 policy = (\u00a0 \u00a0 \u00a0 \u00a0 crm_service.projects()\u00a0 \u00a0 \u00a0 \u00a0 .setIamPolicy(resource=project_id, body={\"policy\": policy})\u00a0 \u00a0 \u00a0 \u00a0 .execute()\u00a0 \u00a0 )\u00a0 \u00a0 return policyif __name__ == \"__main__\":\u00a0 \u00a0 # TODO: replace with your project ID\u00a0 \u00a0 project_id = \"your-project-id\"\u00a0 \u00a0 # TODO: Replace with the ID of your member in the form 'user:member@example.com'.\u00a0 \u00a0 member = \"your-member\"\u00a0 \u00a0 quickstart(project_id, member)\n```\u606d\u559c\uff01\u60a8\u4f7f\u7528\u4e86 Resource Manager API \u4e2d\u7684 IAM \u65b9\u6cd5\u4f86\u4fee\u6539\u9805\u76ee\u7684\u8a2a\u554f\u6b0a\u9650\u3002## \u7d50\u679c\u600e\u9ebc\u6a23\uff1f\n## \u6e05\u7406- Titles in dynamic includes are not used anywhere, and we should avoid paying to translate them\n- \u53ef\u9078\uff1a\u64a4\u6d88\u60a8\u5275\u5efa\u7684\u8eab\u4efd\u9a57\u8b49\u6191\u64da\uff0c\u4e26\u522a\u9664\u672c\u5730\u6191\u64da\u6587\u4ef6\u3002```\ngcloud auth application-default revoke\n```\n- Titles in dynamic includes are not used anywhere, and we should avoid paying to translate them\n- \u53ef\u9078\uff1a\u5f9e gcloud CLI \u64a4\u6d88\u6191\u64da\u3002```\ngcloud auth revoke\n```\n## \u5f8c\u7e8c\u6b65\u9a5f\n- \u77ad\u89e3 [IAM \u7684\u5de5\u4f5c\u539f\u7406](https://cloud.google.com/iam/docs/concepts?hl=zh-cn) \u3002\n- \u8a73\u7d30\u77ad\u89e3\u5982\u4f55 [\u6388\u4e88\u3001\u66f4\u6539\u548c\u64a4\u6d88\u8a2a\u554f\u6b0a\u9650](https://cloud.google.com/iam/docs/granting-changing-revoking-access?hl=zh-cn) \u3002\n- \u4f7f\u7528 [\u653f\u7b56\u554f\u984c\u6392\u67e5\u5de5\u5177](https://cloud.google.com/iam/docs/troubleshooting-access?hl=zh-cn) \u6392\u67e5\u8a2a\u554f\u6b0a\u9650\u554f\u984c\u3002", "guide": "IAM"}