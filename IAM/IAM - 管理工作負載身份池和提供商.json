{"title": "IAM - \u7ba1\u7406\u5de5\u4f5c\u8ca0\u8f09\u8eab\u4efd\u6c60\u548c\u63d0\u4f9b\u5546", "url": "https://cloud.google.com/iam/docs/manage-workload-identity-pools-providers?hl=zh-cn", "abstract": "# IAM - \u7ba1\u7406\u5de5\u4f5c\u8ca0\u8f09\u8eab\u4efd\u6c60\u548c\u63d0\u4f9b\u5546\n\u672c\u9801\u9762\u4ecb\u7d39\u5982\u4f55\u7ba1\u7406\u73fe\u6709\u7684 [\u5de5\u4f5c\u8ca0\u8f09\u8eab\u4efd\u6c60](https://cloud.google.com/iam/docs/workload-identity-federation?hl=zh-cn) \u53ca\u5176\u8eab\u4efd\u63d0\u4f9b\u5546\u3002\n\u60a8\u53ef\u4ee5\u4f7f\u7528 Google Cloud Console\u3001 [Google Cloud CLI](https://cloud.google.com/sdk/gcloud?hl=zh-cn) \u6216 [REST API](https://cloud.google.com/iam/docs/reference/rest?hl=zh-cn) \u7ba1\u7406\u6c60\u548c\u63d0\u4f9b\u5546\u3002\n", "content": "## \u6e96\u5099\u5de5\u4f5c\n\u5275\u5efa\u5de5\u4f5c\u8ca0\u8f09\u8eab\u4efd\u6c60\u3002\u8acb\u53c3\u95b1\u4ee5\u4e0b\u67d0\u500b\u9801\u9762\uff0c\u77ad\u89e3\u64cd\u4f5c\u65b9\u6cd5\uff1a\n- [\u5f9e AWS \u8a2a\u554f\u8cc7\u6e90](https://cloud.google.com/iam/docs/access-resources-aws?hl=zh-cn#create) \n- [\u5f9e Microsoft Azure \u8a2a\u554f\u8cc7\u6e90](https://cloud.google.com/iam/docs/access-resources-azure?hl=zh-cn#create) \n- [\u5f9e OIDC \u8eab\u4efd\u63d0\u4f9b\u5546\u8a2a\u554f\u8cc7\u6e90](https://cloud.google.com/iam/docs/access-resources-oidc?hl=zh-cn#create) \n- [\u5f9e SAML 2.0 \u8eab\u4efd\u63d0\u4f9b\u5546\u8a2a\u554f\u8cc7\u6e90](https://cloud.google.com/iam/docs/configuring-workload-identity-federation?hl=zh-cn#saml) \n### \u6240\u9700\u7684\u89d2\u8272\n\u5982\u9700\u7372\u5f97\u7ba1\u7406\u5de5\u4f5c\u8ca0\u8f09\u8eab\u4efd\u6c60\u548c\u63d0\u4f9b\u5546\u6240\u9700\u7684\u6b0a\u9650\uff0c\u8acb\u8b93\u7ba1\u7406\u54e1\u5411\u60a8\u6388\u4e88\u9805\u76ee\u7684\u4ee5\u4e0b IAM \u89d2\u8272\uff1a\n- [IAM Workload Identity Pool Viewer](https://cloud.google.com/iam/docs/understanding-roles?hl=zh-cn#iam.workloadIdentityPoolViewer) (`roles/iam.workloadIdentityPoolViewer`)\uff08\u5982\u9700\u67e5\u770b\u6c60\u548c\u63d0\u4f9b\u65b9\uff09\n- [IAM Workload Identity Pool Admin](https://cloud.google.com/iam/docs/understanding-roles?hl=zh-cn#iam.workloadIdentityPoolAdmin) (`roles/iam.workloadIdentityPoolAdmin`)\uff08\u5982\u9700\u67e5\u770b\u3001\u5275\u5efa\u3001\u66f4\u65b0\u548c\u522a\u9664\u6c60\u548c\u63d0\u4f9b\u65b9\uff09\n\u5982\u9700\u8a73\u7d30\u77ad\u89e3\u5982\u4f55\u6388\u4e88\u89d2\u8272\uff0c\u8acb\u53c3\u95b1 [\u7ba1\u7406\u8a2a\u554f\u6b0a\u9650](https://cloud.google.com/iam/docs/granting-changing-revoking-access?hl=zh-cn) \u3002\n\u9019\u4e9b\u9810\u5b9a\u7fa9\u89d2\u8272\u5177\u6709\u7ba1\u7406\u5de5\u4f5c\u8ca0\u8f09\u8eab\u4efd\u6c60\u548c\u63d0\u4f9b\u5546\u6240\u9700\u7684\u6b0a\u9650\u3002\u5982\u9700\u67e5\u770b\u6240\u9700\u7684\u78ba\u5207\u6b0a\u9650\uff0c\u8acb\u5c55\u958b **\u6240\u9700\u6b0a\u9650** \u90e8\u5206\uff1a\n\u60a8\u4e5f\u53ef\u4ee5\u4f7f\u7528 [\u81ea\u5b9a\u7fa9\u89d2\u8272](https://cloud.google.com/iam/docs/creating-custom-roles?hl=zh-cn) \u6216\u5176\u4ed6 [\u9810\u5b9a\u7fa9\u89d2\u8272](https://cloud.google.com/iam/docs/understanding-roles?hl=zh-cn) \u4f86\u7372\u53d6\u9019\u4e9b\u6b0a\u9650\u3002\n## \u7ba1\u7406\u5de5\u4f5c\u8ca0\u8f09\u8eab\u4efd\u6c60\n\u672c\u90e8\u5206\u4ecb\u7d39\u5982\u4f55\u7ba1\u7406\u5de5\u4f5c\u8ca0\u8f09\u8eab\u4efd\u6c60\u3002\n### \u5275\u5efa\u6c60\n\u5982\u9700\u5728\u9805\u76ee\u4e2d\u5275\u5efa\u5de5\u4f5c\u8ca0\u8f09\u8eab\u4efd\u6c60\uff0c\u8acb\u57f7\u884c\u4ee5\u4e0b\u64cd\u4f5c\uff1a\n**\u6ce8\u610f** \uff1a\u524d\u7db4 `gcp-` \u5df2\u88ab\u4fdd\u7559\uff0c\u4e0d\u80fd\u5728\u6c60\u6216\u63d0\u4f9b\u65b9 ID \u4e2d\u4f7f\u7528\u3002\n\u5728 Google Cloud \u63a7\u5236\u6aaf\u4e2d\uff0c\u8f49\u5230 **Workload Identity \u6c60** \u9801\u9762\u3002\n [\u8f49\u5230\u201c\u5de5\u4f5c\u8ca0\u8f09\u8eab\u4efd\u6c60\u201d](https://console.cloud.google.com/iam-admin/workload-identity-pools?hl=zh-cn) \u57f7\u884c [gcloud iam workload-identity-pools create](https://cloud.google.com/sdk/gcloud/reference/iam/workload-identity-pools/create?hl=zh-cn) \u547d\u4ee4\u3002\u8abf\u7528 [projects.locations.workloadIdentityPools.create()](https://cloud.google.com/iam/docs/reference/rest/v1/projects.locations.workloadIdentityPools/create?hl=zh-cn) \u3002\n### \u5217\u51fa\u6c60\n\u5982\u9700\u5217\u51fa\u9805\u76ee\u4e2d\u7684\u6240\u6709\u5de5\u4f5c\u8ca0\u8f09\u8eab\u4efd\u6c60\uff0c\u8acb\u57f7\u884c\u4ee5\u4e0b\u64cd\u4f5c\uff1a\n\u5728 Google Cloud \u63a7\u5236\u6aaf\u4e2d\uff0c\u8f49\u5230 **Workload Identity \u6c60** \u9801\u9762\u3002\n [\u8f49\u5230\u201c\u5de5\u4f5c\u8ca0\u8f09\u8eab\u4efd\u6c60\u201d](https://console.cloud.google.com/iam-admin/workload-identity-pools?hl=zh-cn) \u57f7\u884c [gcloud iam workload-identity-pools list](https://cloud.google.com/sdk/gcloud/reference/iam/workload-identity-pools/list?hl=zh-cn) \u547d\u4ee4\u3002\u8abf\u7528 [projects.locations.workloadIdentityPools.list()](https://cloud.google.com/iam/docs/reference/rest/v1/projects.locations.workloadIdentityPools/list?hl=zh-cn) \u3002\n### \u7372\u53d6\u6c60\n\u5982\u9700\u7372\u53d6\u7279\u5b9a\u5de5\u4f5c\u8ca0\u8f09\u8eab\u4efd\u6c60\u7684\u8a73\u7d30\u4fe1\u606f\uff0c\u8acb\u57f7\u884c\u4ee5\u4e0b\u64cd\u4f5c\uff1a\n- \u5728 Google Cloud \u63a7\u5236\u6aaf\u4e2d\uff0c\u8f49\u5230 **Workload Identity \u6c60** \u9801\u9762\u3002 [\u8f49\u5230\u201c\u5de5\u4f5c\u8ca0\u8f09\u8eab\u4efd\u6c60\u201d](https://console.cloud.google.com/iam-admin/workload-identity-pools?hl=zh-cn) \n- \u627e\u5230\u60a8\u8981\u67e5\u770b\u7684\u5de5\u4f5c\u8ca0\u8f09\u8eab\u4efd\u6c60\uff0c\u7136\u5f8c\u9ede\u64ca\u5176 edit **\u4fee\u6539** \u5716\u6a19\u3002Google Cloud \u63a7\u5236\u6aaf\u6703\u986f\u793a\u6709\u95dc\u5de5\u4f5c\u8ca0\u8f09\u8eab\u4efd\u6c60\u7684\u8a73\u7d30\u4fe1\u606f\u3002\n\u57f7\u884c [gcloud iam workload-identity-pools describe](https://cloud.google.com/sdk/gcloud/reference/iam/workload-identity-pools/describe?hl=zh-cn) \u547d\u4ee4\u3002\u8abf\u7528 [projects.locations.workloadIdentityPools.get()](https://cloud.google.com/iam/docs/reference/rest/v1/projects.locations.workloadIdentityPools/get?hl=zh-cn) \u3002\n### \u66f4\u65b0\u6c60\n\u60a8\u53ef\u4ee5\u5553\u7528\u6216\u505c\u7528\u5de5\u4f5c\u8ca0\u8f09\u8eab\u4efd\u6c60\u3002\u60a8\u9084\u53ef\u4ee5\u66f4\u6539\u5176\u986f\u793a\u540d\u6216\u8aaa\u660e\u3002\n\u5982\u9700\u66f4\u65b0\u73fe\u6709\u5de5\u4f5c\u8ca0\u8f09\u8eab\u4efd\u6c60\uff0c\u8acb\u57f7\u884c\u4ee5\u4e0b\u64cd\u4f5c\uff1a\n- \u5728 Google Cloud \u63a7\u5236\u6aaf\u4e2d\uff0c\u8f49\u5230 **Workload Identity \u6c60** \u9801\u9762\u3002 [\u8f49\u5230\u201c\u5de5\u4f5c\u8ca0\u8f09\u8eab\u4efd\u6c60\u201d](https://console.cloud.google.com/iam-admin/workload-identity-pools?hl=zh-cn) \n- \u627e\u5230\u60a8\u8981\u4fee\u6539\u7684\u5de5\u4f5c\u8ca0\u8f09\u8eab\u4efd\u6c60\uff0c\u7136\u5f8c\u9ede\u64ca\u5176 edit **\u4fee\u6539** \u5716\u6a19\u3002\u5982\u9700\u505c\u7528\u6216\u5553\u7528\u5de5\u4f5c\u8ca0\u8f09\u8eab\u4efd\u6c60\uff0c\u8acb\u9ede\u64ca **\u72c0\u614b** \u5207\u63db\u958b\u95dc\uff0c\u7136\u5f8c\u9ede\u64ca **\u505c\u7528** \u6216 **\u5553\u7528** \u3002\u5982\u9700\u4fee\u6539\u986f\u793a\u540d\uff0c\u8acb\u9ede\u64ca\u986f\u793a\u540d\u65c1\u908a\u7684 edit **\u4fee\u6539** \u3002\u66f4\u65b0\u540d\u7a31\uff0c\u7136\u5f8c\u9ede\u64ca **\u4fdd\u5b58** \u3002\u5982\u9700\u4fee\u6539\u8aaa\u660e\uff0c\u8acb\u4f7f\u7528 gcloud CLI \u6216 REST API\u3002\n\u57f7\u884c [gcloud iam workload-identity-pools update](https://cloud.google.com/sdk/gcloud/reference/iam/workload-identity-pools/update?hl=zh-cn) \u547d\u4ee4\u3002\u8abf\u7528 [projects.locations.workloadIdentityPools.patch()](https://cloud.google.com/iam/docs/reference/rest/v1/projects.locations.workloadIdentityPools/patch?hl=zh-cn) \u3002\n### \u522a\u9664\u6c60\n\u522a\u9664\u5de5\u4f5c\u8ca0\u8f09\u8eab\u4efd\u6c60\u6642\uff0c\u5176\u5de5\u4f5c\u8ca0\u8f09\u8eab\u4efd\u6c60\u63d0\u4f9b\u5546\u4e5f\u5c07\u4e00\u540c\u522a\u9664\u3002\u56e0\u6b64\uff0c\u6c60\u4e2d\u7684\u8eab\u4efd\u5c07\u7121\u6cd5\u518d\u8a2a\u554f Google Cloud \u8cc7\u6e90\u3002\n**\u6ce8\u610f** \uff1a\u5728\u522a\u9664\u5de5\u4f5c\u8ca0\u8f09\u8eab\u4efd\u6c60\u4e4b\u524d\uff0c\u8acb\u8003\u616e [\u505c\u7528\u6c60](#update-pool) \u6216 [\u505c\u7528\u5176\u8eab\u4efd\u63d0\u4f9b\u5546](#update-provider) \u3002\u5982\u679c\u60a8\u7684\u67d0\u500b\u5de5\u4f5c\u8ca0\u8f09\u56e0\u6b64\u800c\u7121\u6cd5\u518d\u8a2a\u554f Google Cloud \u8cc7\u6e90\uff0c\u60a8\u53ef\u4ee5\u96a8\u6642\u91cd\u65b0\u5553\u7528\u8a72\u6c60\u53ca\u5176\u63d0\u4f9b\u5546\u3002\u5982\u679c\u60a8\u7684\u5de5\u4f5c\u8ca0\u8f09\u672a\u5931\u53bb\u8a2a\u554f\u6b0a\u9650\uff0c\u8acb\u653e\u5fc3\u522a\u9664\u8a72\u6c60\u3002\n\u60a8\u6700\u9577\u53ef\u4ee5\u5728\u522a\u9664\u5f8c 30 \u5929\u5167 [\u6062\u5fa9\u522a\u9664\u6c60](#undelete-pool) \u300230 \u5929\u540e\uff0c\u7cfb\u7d71\u6703\u6c38\u4e45\u522a\u9664\u63d0\u4f9b\u5546\u3002\u5728\u7cfb\u7d71\u6c38\u4e45\u522a\u9664\u67d0\u500b\u6c60\u4e4b\u524d\uff0c\u60a8\u4e0d\u80fd\u5728\u5275\u5efa\u65b0\u7684\u5de5\u4f5c\u8ca0\u8f09\u8eab\u4efd\u6c60\u6642\u91cd\u8907\u4f7f\u7528\u8a72\u6c60\u7684\u540d\u7a31\u3002\n\u5982\u9700\u522a\u9664\u5de5\u4f5c\u8ca0\u8f09\u8eab\u4efd\u6c60\u53ca\u5176\u8eab\u4efd\u63d0\u4f9b\u5546\uff0c\u8acb\u57f7\u884c\u4ee5\u4e0b\u64cd\u4f5c\uff1a\n- \u5728 Google Cloud \u63a7\u5236\u6aaf\u4e2d\uff0c\u8f49\u5230 **Workload Identity \u6c60** \u9801\u9762\u3002 [\u8f49\u5230\u201c\u5de5\u4f5c\u8ca0\u8f09\u8eab\u4efd\u6c60\u201d](https://console.cloud.google.com/iam-admin/workload-identity-pools?hl=zh-cn) \n- \u627e\u5230\u60a8\u8981\u522a\u9664\u7684\u5de5\u4f5c\u8ca0\u8f09\u8eab\u4efd\u6c60\uff0c\u7136\u5f8c\u9ede\u64ca\u5176 edit **\u4fee\u6539** \u5716\u6a19\u3002\n- \u9ede\u64ca delete **\u522a\u9664\u6c60** \uff0c\u7136\u5f8c\u9ede\u64ca **\u522a\u9664** \u3002\u5de5\u4f5c\u8ca0\u8f09\u8eab\u4efd\u6c60\u53ca\u5176\u8eab\u4efd\u63d0\u4f9b\u5546\u6703\u88ab\u522a\u9664\u3002\n\u57f7\u884c [gcloud iam workload-identity-pools delete](https://cloud.google.com/sdk/gcloud/reference/iam/workload-identity-pools/delete?hl=zh-cn) \u547d\u4ee4\u3002\u8abf\u7528 [projects.locations.workloadIdentityPools.delete()](https://cloud.google.com/iam/docs/reference/rest/v1/projects.locations.workloadIdentityPools/delete?hl=zh-cn) \u3002\n### \u6062\u5fa9\u522a\u9664\u6c60\n\u60a8\u6700\u9577\u53ef\u4ee5\u5728\u522a\u9664\u5f8c 30 \u5929\u5167\u6062\u5fa9\u5df2\u522a\u9664\u7684\u5de5\u4f5c\u8ca0\u8f09\u8eab\u4efd\u6c60\u3002\n\u5982\u9700\u6062\u5fa9\u522a\u9664\u6c60\uff0c\u8acb\u57f7\u884c\u4ee5\u4e0b\u64cd\u4f5c\uff1a\n- \u5728 Google Cloud \u63a7\u5236\u6aaf\u4e2d\uff0c\u8f49\u5230 **Workload Identity \u6c60** \u9801\u9762\u3002 [\u8f49\u5230\u201c\u5de5\u4f5c\u8ca0\u8f09\u8eab\u4efd\u6c60\u201d](https://console.cloud.google.com/iam-admin/workload-identity-pools?hl=zh-cn) \n- \u9ede\u64ca **\u986f\u793a\u5df2\u522a\u9664\u7684\u6c60\u548c\u63d0\u4f9b\u5546** \u5207\u63db\u958b\u95dc\u3002\n- \u627e\u5230\u60a8\u8981\u6062\u5fa9\u522a\u9664\u7684\u5de5\u4f5c\u8ca0\u8f09\u8eab\u4efd\u6c60\uff0c\u7136\u5f8c\u9ede\u64ca\u5176 undo **\u6062\u5fa9** \u5716\u6a19\u3002\n- \u9ede\u64ca **\u6062\u5fa9** \u3002\u7cfb\u7d71\u6703\u6062\u5fa9\u6c60\u53ca\u5176\u63d0\u4f9b\u5546\u3002\n\u57f7\u884c [gcloud iam workload-identity-pools undelete](https://cloud.google.com/sdk/gcloud/reference/iam/workload-identity-pools/undelete?hl=zh-cn) \u547d\u4ee4\u3002\u8abf\u7528 [projects.locations.workloadIdentityPools.undelete()](https://cloud.google.com/iam/docs/reference/rest/v1/projects.locations.workloadIdentityPools/undelete?hl=zh-cn) \u3002\n[](None)\n## \u7ba1\u7406\u5de5\u4f5c\u8ca0\u8f09\u8eab\u4efd\u6c60\u63d0\u4f9b\u65b9\n\u672c\u90e8\u5206\u4ecb\u7d39\u5982\u4f55\u7ba1\u7406\u5de5\u4f5c\u8ca0\u8f09\u8eab\u4efd\u6c60\u63d0\u4f9b\u65b9\u3002\n### \u5275\u5efa\u63d0\u4f9b\u5546\n\u5982\u9700\u5728\u73fe\u6709\u5de5\u4f5c\u8ca0\u8f09\u8eab\u4efd\u6c60\u4e2d\u5275\u5efa\u5de5\u4f5c\u8ca0\u8f09\u8eab\u4efd\u6c60\u63d0\u4f9b\u65b9\uff0c\u8acb\u57f7\u884c\u4ee5\u4e0b\u64cd\u4f5c\uff1a\n- \u5728 Google Cloud \u63a7\u5236\u6aaf\u4e2d\uff0c\u8f49\u5230 **Workload Identity \u6c60** \u9801\u9762\u3002 [\u8f49\u5230\u201c\u5de5\u4f5c\u8ca0\u8f09\u8eab\u4efd\u6c60\u201d](https://console.cloud.google.com/iam-admin/workload-identity-pools?hl=zh-cn) \n- \u627e\u5230\u8981\u5411\u5176\u4e2d\u6dfb\u52a0\u63d0\u4f9b\u5546\u7684\u5de5\u4f5c\u8ca0\u8f09\u8eab\u4efd\u6c60\uff0c\u7136\u5f8c\u9ede\u64ca\u5176 edit **\u4fee\u6539** \u5716\u6a19\u3002\n- \u9ede\u64ca add_box **\u6dfb\u52a0\u63d0\u4f9b\u5546** \u3002\n- \u9078\u64c7\u8981\u5275\u5efa\u7684\u63d0\u4f9b\u5546\u985e\u578b\uff1a- **AWS** \uff1aAmazon Web Services (AWS) \u8eab\u4efd\u63d0\u4f9b\u5546\u3002\n- **OpenID Connect (OIDC)** \uff1a\u8207 OIDC \u517c\u5bb9\u7684\u8eab\u4efd\u63d0\u4f9b\u5546\u3002\u9019\u5305\u62ec Microsoft Azure\u3002\n- \u8f38\u5165\u63d0\u4f9b\u5546\u7684\u540d\u7a31\u3002Google Cloud \u63a7\u5236\u6aaf\u5c07\u4f7f\u7528\u8a72\u540d\u7a31\u5275\u5efa\u63d0\u4f9b\u5546 ID\u3002\u5982\u9700\u66f4\u6539\u63d0\u4f9b\u5546 ID\uff0c\u8acb\u9ede\u64ca **\u4fee\u6539** \u3002\u63d0\u4f9b\u5546 ID \u5275\u5efa\u5f8c\u4fbf\u7121\u6cd5\u66f4\u6539\u3002\n- \u586b\u5beb\u63d0\u4f9b\u5546\u7684\u5269\u9918\u5b57\u6bb5\uff1a- **AWS** \uff1a\u8f38\u5165\u60a8\u7684 AWS \u8cec\u865f ID\u3002\n- **OIDC** \uff1a\u8f38\u5165\u9812\u767c\u8005\u7db2\u5740\u3002\u5c0d\u65bc Azure\uff0c\u9812\u767c\u8005\u7db2\u5740\u63a1\u7528`https://sts.windows.net/` ``\u683c\u5f0f\u3002\u5c0d\u65bc\u5176\u4ed6\u63d0\u4f9b\u5546\uff0c\u8acb\u53c3\u95b1\u76f8\u95dc\u63d0\u4f9b\u5546\u7684\u6587\u6a94\u3002\n\u5b8c\u6210\u64cd\u4f5c\u5f8c\uff0c\u8acb\u9ede\u64ca **\u7e7c\u7e8c** \u3002\n- \u5982\u9700\u914d\u7f6e\u7279\u6027\u6620\u5c04\uff0c\u8acb\u9ede\u64ca **\u4fee\u6539\u6620\u5c04** \u3002\u901a\u904e\u7279\u6027\u6620\u5c04\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528\u6709\u95dc\u5916\u90e8\u8eab\u4efd\u7684\u4fe1\u606f\u4f86\u6388\u4e88\u5c0d\u5176\u4e2d\u4e00\u90e8\u5206\u8eab\u4efd\u7684\u8a2a\u554f\u6b0a\u9650\u3002- **AWS** \uff1a\u9019\u662f\u53ef\u9078\u6b65\u9a5f\uff1b\u60a8\u53ef\u4ee5\u4f7f\u7528\u9ed8\u8a8d\u6620\u5c04\u3002\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [AWS \u8eab\u4efd\u63d0\u4f9b\u5546\u8a2d\u7f6e](https://cloud.google.com/iam/docs/access-resources-aws?hl=zh-cn#settings) \u3002\n- **OIDC** \uff1a\u6211\u5011\u5efa\u8b70\u60a8\u5c07 `google.subject` \u6620\u5c04\u5230 `assertion.sub` \u3002\u5176\u4ed6\u6620\u5c04\u7232\u53ef\u9078\u3002\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [Azure \u8eab\u4efd\u63d0\u4f9b\u5546\u8a2d\u7f6e](https://cloud.google.com/iam/docs/access-resources-azure?hl=zh-cn#settings) \u6216 [OIDC \u8eab\u4efd\u63d0\u4f9b\u5546\u8a2d\u7f6e](https://cloud.google.com/iam/docs/access-resources-oidc?hl=zh-cn#settings) \u3002\n- \u53ef\u9078\uff1a\u5982\u9700\u63d0\u4f9b\u7528\u65bc\u6307\u5b9a\u53ef\u9032\u884c\u8eab\u4efd\u9a57\u8b49\u7684\u8eab\u4efd\u7684\u7279\u6027\u689d\u4ef6\uff0c\u8acb\u9ede\u64ca **\u6dfb\u52a0\u689d\u4ef6** \u4e26\u8f38\u5165\u6709\u6548\u7684\u901a\u7528\u8868\u9054\u5f0f\u8a9e\u8a00 (CEL) \u8868\u9054\u5f0f\u3002\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [\u7279\u6027\u689d\u4ef6](https://cloud.google.com/iam/docs/workload-identity-federation?hl=zh-cn#conditions) \u3002\n- \u9ede\u64ca **\u4fdd\u5b58** \u3002\u5275\u5efa\u4e86\u5de5\u4f5c\u8ca0\u8f09\u8eab\u4efd\u6c60\u63d0\u4f9b\u5546\u3002\n\u57f7\u884c [gcloud iam workload-identity-pools providers create-aws](https://cloud.google.com/sdk/gcloud/reference/iam/workload-identity-pools/providers/create-aws?hl=zh-cn) \u547d\u4ee4\u4ee5\u5275\u5efa AWS \u63d0\u4f9b\u5546\u3002\n\u57f7\u884c [gcloud iam workload-identity-pools providers create-oidc](https://cloud.google.com/sdk/gcloud/reference/iam/workload-identity-pools/providers/create-oidc?hl=zh-cn) \u547d\u4ee4\u4ee5\u5275\u5efa OIDC \u63d0\u4f9b\u5546\u3002\u9019\u5305\u62ec Microsoft Azure\u3002\u8abf\u7528 [projects.locations.workloadIdentityPools.providers.create()](https://cloud.google.com/iam/docs/reference/rest/v1/projects.locations.workloadIdentityPools.providers/create?hl=zh-cn) \u3002\n### \u5217\u51fa\u63d0\u4f9b\u5546\n\u5982\u9700\u5217\u51fa\u9805\u76ee\u4e2d\u7684\u5de5\u4f5c\u8ca0\u8f09\u8eab\u4efd\u6c60\u63d0\u4f9b\u5546\uff0c\u8acb\u57f7\u884c\u4ee5\u4e0b\u64cd\u4f5c\uff1a\n- \u5728 Google Cloud \u63a7\u5236\u6aaf\u4e2d\uff0c\u8f49\u5230 **Workload Identity \u6c60** \u9801\u9762\u3002 [\u8f49\u5230\u201c\u5de5\u4f5c\u8ca0\u8f09\u8eab\u4efd\u6c60\u201d](https://console.cloud.google.com/iam-admin/workload-identity-pools?hl=zh-cn) \n- \u5982\u9700\u67e5\u770b\u5de5\u4f5c\u8ca0\u8f09\u8eab\u4efd\u6c60\u7684\u63d0\u4f9b\u5546\uff0c\u8acb\u9ede\u64ca\u8a72\u6c60\u7684 arrow_right **\u5c55\u958b\u7bc0\u9ede** \u5716\u6a19\u3002\n\u57f7\u884c [gcloud iam workload-identity-pools providers list](https://cloud.google.com/sdk/gcloud/reference/iam/workload-identity-pools/providers/list?hl=zh-cn) \u547d\u4ee4\u3002\u8abf\u7528 [projects.locations.workloadIdentityPools.providers.list()](https://cloud.google.com/iam/docs/reference/rest/v1/projects.locations.workloadIdentityPools.providers/list?hl=zh-cn) \u3002\n### \u7372\u53d6\u63d0\u4f9b\u5546\n\u5982\u9700\u7372\u53d6\u7279\u5b9a\u5de5\u4f5c\u8ca0\u8f09\u8eab\u4efd\u6c60\u63d0\u4f9b\u65b9\u7684\u8a73\u7d30\u4fe1\u606f\uff0c\u8acb\u57f7\u884c\u4ee5\u4e0b\u64cd\u4f5c\uff1a\n- \u5728 Google Cloud \u63a7\u5236\u6aaf\u4e2d\uff0c\u8f49\u5230 **Workload Identity \u6c60** \u9801\u9762\u3002 [\u8f49\u5230\u201c\u5de5\u4f5c\u8ca0\u8f09\u8eab\u4efd\u6c60\u201d](https://console.cloud.google.com/iam-admin/workload-identity-pools?hl=zh-cn) \n- \u627e\u5230\u5305\u542b\u63d0\u4f9b\u5546\u7684\u5de5\u4f5c\u8ca0\u8f09\u8eab\u4efd\u6c60\uff0c\u7136\u5f8c\u9ede\u64ca\u6c60\u7684 arrow_right **\u5c55\u958b\u7bc0\u9ede** \u5716\u6a19\u3002\n- \u627e\u5230\u8981\u67e5\u770b\u7684\u5de5\u4f5c\u8ca0\u8f09\u8eab\u4efd\u6c60\u63d0\u4f9b\u5546\uff0c\u7136\u5f8c\u9ede\u64ca\u5176 edit **\u4fee\u6539** \u5716\u6a19\u3002Google Cloud \u63a7\u5236\u6aaf\u6703\u986f\u793a\u6709\u95dc\u63d0\u4f9b\u5546\u7684\u8a73\u7d30\u4fe1\u606f\u3002\n\u57f7\u884c [gcloud iam workload-identity-pools providers describe](https://cloud.google.com/sdk/gcloud/reference/iam/workload-identity-pools/providers/describe?hl=zh-cn) \u547d\u4ee4\u3002\u8abf\u7528 [projects.locations.workloadIdentityPools.providers.get()](https://cloud.google.com/iam/docs/reference/rest/v1/projects.locations.workloadIdentityPools.providers/get?hl=zh-cn) \u3002\n### \u66f4\u65b0\u63d0\u4f9b\u5546\n\u60a8\u53ef\u4ee5\u5553\u7528\u6216\u505c\u7528\u5de5\u4f5c\u8ca0\u8f09\u8eab\u4efd\u6c60\u63d0\u4f9b\u5546\u3002\u60a8\u9084\u53ef\u4ee5\u66f4\u65b0\u5176\u8cec\u865f\u4fe1\u606f\u53ca\u5176\u7279\u6027\u6620\u5c04\uff0c\u4ee5\u53ca\u5b83\u7684\u986f\u793a\u540d\u548c\u8aaa\u660e\u3002\n\u5982\u9700\u66f4\u65b0\u73fe\u6709\u5de5\u4f5c\u8ca0\u8f09\u8eab\u4efd\u6c60\u63d0\u4f9b\u65b9\uff0c\u8acb\u57f7\u884c\u4ee5\u4e0b\u64cd\u4f5c\uff1a\n- \u5728 Google Cloud \u63a7\u5236\u6aaf\u4e2d\uff0c\u8f49\u5230 **Workload Identity \u6c60** \u9801\u9762\u3002 [\u8f49\u5230\u201c\u5de5\u4f5c\u8ca0\u8f09\u8eab\u4efd\u6c60\u201d](https://console.cloud.google.com/iam-admin/workload-identity-pools?hl=zh-cn) \n- \u627e\u5230\u5305\u542b\u63d0\u4f9b\u5546\u7684\u5de5\u4f5c\u8ca0\u8f09\u8eab\u4efd\u6c60\uff0c\u7136\u5f8c\u9ede\u64ca\u6c60\u7684 arrow_right **\u5c55\u958b\u7bc0\u9ede** \u5716\u6a19\u3002\n- \u627e\u5230\u8981\u4fee\u6539\u7684\u5de5\u4f5c\u8ca0\u8f09\u8eab\u4efd\u6c60\u63d0\u4f9b\u5546\uff0c\u7136\u5f8c\u9ede\u64ca\u5176 edit **\u4fee\u6539** \u5716\u6a19\u3002\n- \u4fee\u6539\u63d0\u4f9b\u5546\u4fe1\u606f\uff0c\u7136\u5f8c\u9ede\u64ca **\u4fdd\u5b58** \u3002\n\u57f7\u884c [gcloud iam workload-identity-pools providers update-aws](https://cloud.google.com/sdk/gcloud/reference/iam/workload-identity-pools/providers/update-aws?hl=zh-cn) \u547d\u4ee4\u4ee5\u66f4\u65b0 AWS \u63d0\u4f9b\u5546\u3002\n\u57f7\u884c [gcloud iam workload-identity-pools providers update-oidc](https://cloud.google.com/sdk/gcloud/reference/iam/workload-identity-pools/providers/update-oidc?hl=zh-cn) \u547d\u4ee4\u4ee5\u66f4\u65b0 OIDC \u63d0\u4f9b\u5546\u3002\u9019\u5305\u62ec Microsoft Azure\u3002\u8abf\u7528 [projects.locations.workloadIdentityPools.providers.patch()](https://cloud.google.com/iam/docs/reference/rest/v1/projects.locations.workloadIdentityPools.providers/patch?hl=zh-cn) \u3002\n### \u522a\u9664\u63d0\u4f9b\u5546\n\u522a\u9664\u5de5\u4f5c\u8ca0\u8f09\u8eab\u4efd\u6c60\u63d0\u4f9b\u5546\u5f8c\uff0c\u63d0\u4f9b\u5546\u7684\u8eab\u4efd\u5c07\u7121\u6cd5\u518d\u8a2a\u554f Google Cloud \u8cc7\u6e90\u3002\n**\u6ce8\u610f** \uff1a\u5728\u522a\u9664\u5de5\u4f5c\u8ca0\u8f09\u8eab\u4efd\u6c60\u63d0\u4f9b\u5546\u4e4b\u524d\uff0c\u8acb\u5148\u8003\u616e [\u505c\u7528\u63d0\u4f9b\u5546](#update-provider) \u3002\u5982\u679c\u60a8\u7684\u67d0\u500b\u5de5\u4f5c\u8ca0\u8f09\u56e0\u6b64\u800c\u7121\u6cd5\u518d\u8a2a\u554f Google Cloud \u8cc7\u6e90\uff0c\u60a8\u53ef\u4ee5\u96a8\u6642\u91cd\u65b0\u5553\u7528\u8a72\u63d0\u4f9b\u5546\u3002\u5982\u679c\u60a8\u7684\u5de5\u4f5c\u8ca0\u8f09\u672a\u5931\u53bb\u8a2a\u554f\u6b0a\u9650\uff0c\u8acb\u653e\u5fc3\u522a\u9664\u8a72\u63d0\u4f9b\u5546\u3002\n\u60a8\u6700\u9577\u53ef\u4ee5\u5728\u522a\u9664\u5f8c 30 \u5929\u5167 [\u6062\u5fa9\u522a\u9664\u63d0\u4f9b\u5546](#undelete-provider) \u300230 \u5929\u540e\uff0c\u7cfb\u7d71\u6703\u6c38\u4e45\u522a\u9664\u63d0\u4f9b\u5546\u3002\u5728\u7cfb\u7d71\u6c38\u4e45\u522a\u9664\u67d0\u500b\u63d0\u4f9b\u5546\u4e4b\u524d\uff0c\u60a8\u4e0d\u80fd\u5728\u5275\u5efa\u65b0\u7684\u63d0\u4f9b\u5546\u6642\u91cd\u8907\u4f7f\u7528\u8a72\u63d0\u4f9b\u5546\u7684\u540d\u7a31\u3002\n\u5982\u9700\u522a\u9664\u5de5\u4f5c\u8ca0\u8f09\u8eab\u4efd\u6c60\u63d0\u4f9b\u5546\uff0c\u8acb\u57f7\u884c\u4ee5\u4e0b\u64cd\u4f5c\uff1a\n- \u5728 Google Cloud \u63a7\u5236\u6aaf\u4e2d\uff0c\u8f49\u5230 **Workload Identity \u6c60** \u9801\u9762\u3002 [\u8f49\u5230\u201c\u5de5\u4f5c\u8ca0\u8f09\u8eab\u4efd\u6c60\u201d](https://console.cloud.google.com/iam-admin/workload-identity-pools?hl=zh-cn) \n- \u627e\u5230\u5305\u542b\u8a72\u63d0\u4f9b\u5546\u7684\u5de5\u4f5c\u8ca0\u8f09\u8eab\u4efd\u6c60\uff0c\u7136\u5f8c\u9ede\u64ca\u5176 edit **\u4fee\u6539** \u5716\u6a19\u3002\n- \u5728 **\u63d0\u4f9b\u5546** \u7a97\u683c\u4e2d\uff0c\u627e\u5230\u8981\u522a\u9664\u7684\u63d0\u4f9b\u5546\uff0c\u7136\u5f8c\u9ede\u64ca\u5176 delete **\u522a\u9664** \u5716\u6a19\u3002\n- \u9ede\u64ca **\u522a\u9664** \u4ee5\u522a\u9664\u8a72\u63d0\u4f9b\u5546\u3002\n\u57f7\u884c [gcloud iam workload-identity-pools providers delete](https://cloud.google.com/sdk/gcloud/reference/iam/workload-identity-pools/providers/delete?hl=zh-cn) \u547d\u4ee4\u3002\u8abf\u7528 [projects.locations.workloadIdentityPools.providers.delete()](https://cloud.google.com/iam/docs/reference/rest/v1/projects.locations.workloadIdentityPools.providers/delete?hl=zh-cn) \u3002\n### \u6062\u5fa9\u522a\u9664\u63d0\u4f9b\u5546\n\u60a8\u6700\u9577\u53ef\u4ee5\u5728\u522a\u9664\u5f8c 30 \u5929\u5167\u6062\u5fa9\u5df2\u522a\u9664\u7684\u5de5\u4f5c\u8ca0\u8f09\u8eab\u4efd\u6c60\u63d0\u4f9b\u65b9\u3002\u5982\u9700\u6062\u5fa9\u522a\u9664\u7684\u63d0\u4f9b\u5546\uff0c\u8acb\u57f7\u884c\u4ee5\u4e0b\u64cd\u4f5c\uff1a\n- \u5728 Google Cloud \u63a7\u5236\u6aaf\u4e2d\uff0c\u8f49\u5230 **Workload Identity \u6c60** \u9801\u9762\u3002 [\u8f49\u5230\u201c\u5de5\u4f5c\u8ca0\u8f09\u8eab\u4efd\u6c60\u201d](https://console.cloud.google.com/iam-admin/workload-identity-pools?hl=zh-cn) \n- \u9ede\u64ca **\u986f\u793a\u5df2\u522a\u9664\u7684\u6c60\u548c\u63d0\u4f9b\u5546** \u5207\u63db\u958b\u95dc\u3002\n- \u627e\u5230\u5305\u542b\u63d0\u4f9b\u5546\u7684\u5de5\u4f5c\u8ca0\u8f09\u8eab\u4efd\u6c60\uff0c\u7136\u5f8c\u9ede\u64ca\u6c60\u7684 arrow_right **\u5c55\u958b\u7bc0\u9ede** \u5716\u6a19\u3002\n- \u627e\u5230\u8981\u6062\u5fa9\u522a\u9664\u7684\u63d0\u4f9b\u5546\uff0c\u7136\u5f8c\u9ede\u64ca\u5176 undo **\u6062\u5fa9** \u5716\u6a19\u3002\n- \u9ede\u64ca **\u6062\u5fa9** \u3002\u8a72\u63d0\u4f9b\u5546\u5c07\u88ab\u6062\u5fa9\u3002\n\u57f7\u884c [gcloud iam workload-identity-pools providers undelete](https://cloud.google.com/sdk/gcloud/reference/iam/workload-identity-pools/providers/undelete?hl=zh-cn) \u547d\u4ee4\u3002\u8abf\u7528 [projects.locations.workloadIdentityPools.providers.undelete()](https://cloud.google.com/iam/docs/reference/rest/v1/projects.locations.workloadIdentityPools.providers/undelete?hl=zh-cn) \u3002\n## \u7ba1\u7406\u5de5\u4f5c\u8ca0\u8f09\u8eab\u4efd\u806f\u5408\u7684\u9650\u5236\u689d\u4ef6\n\u60a8\u53ef\u4ee5\u4f7f\u7528 [\u7d44\u7e54\u653f\u7b56\u9650\u5236\u689d\u4ef6](https://cloud.google.com/resource-manager/docs/organization-policy/overview?hl=zh-cn#constraints) \u4f86\u9650\u5236 Google Cloud \u7d44\u7e54\u4e2d\u8cc7\u6e90\u7684\u4f7f\u7528\u65b9\u5f0f\u3002\n\u672c\u90e8\u5206\u4ecb\u7d39\u4f7f\u7528\u5de5\u4f5c\u8ca0\u8f09\u8eab\u4efd\u806f\u5408\u6642\u63a8\u85a6\u7684\u9650\u5236\u689d\u4ef6\u3002\n### \u9650\u5236\u8eab\u4efd\u63d0\u4f9b\u5546\u914d\u7f6e\n\u4f5c\u7232\u7d44\u7e54\u7ba1\u7406\u54e1\uff0c\u60a8\u53ef\u4ee5\u6c7a\u5b9a\u5141\u8a31\u81ea\u5df1\u7684\u7d44\u7e54\u8207\u54ea\u4e9b\u8eab\u4efd\u63d0\u4f9b\u5546\u806f\u5408\u3002\n\u5982\u9700\u7ba1\u7406\u5141\u8a31\u7684\u8eab\u4efd\u63d0\u4f9b\u5546\uff0c\u8acb\u5728\u7d44\u7e54\u7684\u7d44\u7e54\u653f\u7b56\u4e2d\u5553\u7528 `constraints/iam.workloadIdentityPoolProviders` \u5217\u8868\u9650\u5236\u689d\u4ef6\u3002\u6b64\u9650\u5236\u689d\u4ef6\u6307\u5b9a\u5141\u8a31\u7684\u63d0\u4f9b\u5546\u7684\u9812\u767c\u8005 URI\u3002\u60a8\u53ef\u4ee5\u4f7f\u7528 [Google Cloud \u63a7\u5236\u6aaf](https://cloud.google.com/resource-manager/docs/organization-policy/creating-managing-policies?hl=zh-cn#list_constraints) \u6216 [Google Cloud CLI](https://cloud.google.com/resource-manager/docs/organization-policy/using-constraints?hl=zh-cn#list-constraint) \u5553\u7528\u6b64\u9650\u5236\u689d\u4ef6\u3002\n**\u6ce8\u610f** \uff1a\u6b64\u9650\u5236\u689d\u4ef6\u50c5\u9650\u5236\u5275\u5efa\u548c\u66f4\u65b0\u8eab\u4efd\u63d0\u4f9b\u5546\u3002\u5982\u679c\u5728\u5553\u7528\u8a72\u9650\u5236\u689d\u4ef6\u4e4b\u524d\u5df2\u914d\u7f6e\u67d0\u500b\u8eab\u4efd\u63d0\u4f9b\u5546\uff0c\u5247\u8a72\u63d0\u4f9b\u5546\u4ecd\u7136\u53ef\u4ee5\u4f7f\u7528\u3002\n\u5982\u9700\u53ea\u5141\u8a31\u4f86\u81ea AWS \u7684\u806f\u5408\uff0c\u8acb\u4f7f\u7528 URI `https://sts.amazonaws.com` \u5275\u5efa\u4e00\u500b\u9650\u5236\u689d\u4ef6\u3002\u4ee5\u4e0b\u793a\u4f8b\u5c55\u793a\u77ad\u5982\u4f55\u4f7f\u7528 gcloud CLI \u5275\u5efa\u6b64\u9650\u5236\u689d\u4ef6\uff1a\n```\ngcloud resource-manager org-policies allow constraints/iam.workloadIdentityPoolProviders \\\u00a0 \u00a0 \u00a0https://sts.amazonaws.com --organization=ORGANIZATION_NUMBER\n```\n\u60a8\u9084\u53ef\u4ee5\u6307\u5b9a\u54ea\u4e9b AWS \u8cec\u865f ID \u6709\u6b0a\u8a2a\u554f\u60a8\u7684 Google Cloud \u8cc7\u6e90\u3002\u5982\u8981\u6307\u5b9a\u8cec\u865f ID\uff0c\u8acb\u4f7f\u7528 `constraints/iam.workloadIdentityPoolAwsAccounts` \u5217\u8868\u9650\u5236\u689d\u4ef6\uff1a\n```\ngcloud resource-manager org-policies allow constraints/iam.workloadIdentityPoolAwsAccounts \\\u00a0 \u00a0 ACCOUNT_ID --organization=ORGANIZATION_NUMBER\n```\n\u5982\u9700\u53ea\u5141\u8a31\u4f86\u81ea\u4e00\u500b OIDC \u63d0\u4f9b\u5546\u7684\u806f\u5408\uff0c\u8acb\u4f7f\u7528\u5141\u8a31\u7684\u63d0\u4f9b\u5546\u7684 `issuer_uri` \u5275\u5efa\u4e00\u500b\u9650\u5236\u689d\u4ef6\u3002\u4f8b\u5982\uff0c\u4ee5\u4e0b\u547d\u4ee4\u53ea\u5141\u8a31\u4f86\u81ea\u7279\u5b9a Azure \u79df\u6236\u7684\u806f\u5408\uff1a\n```\ngcloud resource-manager org-policies allow constraints/iam.workloadIdentityPoolProviders \\\u00a0 \u00a0 \u00a0https://sts.windows.net/AZURE_TENANT_ID --organization=ORGANIZATION_NUMBER\n```\n\u4f86\u81ea SAML \u8eab\u4efd\u63d0\u4f9b\u5546\u7684\u806f\u5408\u662f\u4e00\u7a2e\u7279\u6b8a\u60c5\u6cc1\uff0c\u56e0\u7232\u7528\u65bc\u9a57\u8b49\u65b7\u8a00\u7684\u516c\u9470\u662f\u5728\u914d\u7f6e\u6642\u63d0\u4f9b\u7684\uff0c\u800c\u4e0d\u662f\u76f4\u63a5\u7531\u8eab\u4efd\u63d0\u4f9b\u5546\u63d0\u4f9b\u7684\u3002\u56e0\u6b64\uff0c\u60e1\u610f\u7528\u6236\u53ef\u80fd\u6703\u8a66\u5716\u4e0a\u50b3 SAML \u5143\u6578\u64da\u6587\u6a94\uff0c\u5176\u4e2d\u5305\u542b\u8cb4\u7d44\u7e54\u7684\u8eab\u4efd\u63d0\u4f9b\u5546\u7684\u5be6\u9ad4 ID\uff0c\u4f46\u8a72 ID \u662f\u4e00\u500b\u53ef\u4f9b\u60e1\u610f\u7528\u6236\u8a2a\u554f\u79c1\u9470\u7684\u516c\u9470\u3002\u5728\u6b64\u60c5\u6cc1\u4e0b\uff0c\u901a\u904e\u5be6\u9ad4 ID \u9650\u5236\u806f\u5408\u53ea\u80fd\u63d0\u4f9b\u5b89\u5168\u5047\u8c61\u3002\u56e0\u6b64\uff0c\u6211\u5011\u5f37\u70c8\u5efa\u8b70\u60a8\u50c5\u5141\u8a31\u5728\u7d44\u7e54\u96c6\u4e2d\u7ba1\u7406\u7684 Google Cloud \u9805\u76ee\u4e2d\u5275\u5efa\u5de5\u4f5c\u8ca0\u8f09\u8eab\u4efd\u6c60\uff0c\u4ee5\u5141\u8a31\u9032\u884c SAML \u806f\u5408\u3002\u7136\u5f8c\uff0c\u60a8\u53ef\u4ee5\u5411\u8a72\u5de5\u4f5c\u8ca0\u8f09\u8eab\u4efd\u6c60\u4e2d\u7684\u5916\u90e8\u8eab\u4efd\u6388\u4e88\u60a8\u7d44\u7e54\u4e2d\u5404\u9805\u8cc7\u6e90\u7684\u8a2a\u554f\u6b0a\u9650\u3002\n\u5982\u9700\u5141\u8a31\u4f86\u81ea SAML \u8eab\u4efd\u63d0\u4f9b\u5546\u7684\u806f\u5408\uff0c\u8acb\u5275\u5efa\u4e00\u500b\u5141\u8a31\u7279\u6b8a\u95dc\u9375\u5b57 `KEY_UPLOAD` \u7684\u9650\u5236\u689d\u4ef6\u3002\n```\ngcloud resource-manager org-policies allow constraints/iam.workloadIdentityPoolProviders \\\u00a0 \u00a0 \u00a0KEY_UPLOAD --organization=ORGANIZATION_NUMBER\n```\n\u60a8\u53ef\u4ee5\u91cd\u8907\u904b\u884c\u9019\u4e9b\u547d\u4ee4\uff0c\u4ee5\u5141\u8a31\u4f86\u81ea\u5176\u4ed6\u63d0\u4f9b\u5546\u7684\u806f\u5408\u3002\n\u5982\u9700\u963b\u6b62\u4f86\u81ea\u6240\u6709\u63d0\u4f9b\u5546\u7684\u806f\u5408\uff0c\u8acb\u57f7\u884c\u4ee5\u4e0b\u64cd\u4f5c\uff1a\n- \u5275\u5efa\u4e00\u500b\u5305\u542b\u4ee5\u4e0b\u5167\u5bb9\u7684 YAML \u6587\u4ef6\uff1a```\nconstraint: constraints/iam.workloadIdentityPoolProviderslistPolicy:\u00a0 allValues: DENY\n```\n- \u5c07\u6587\u4ef6\u50b3\u905e\u7d66 [gcloud resource-manager org-policies set-policy](https://cloud.google.com/sdk/gcloud/reference/resource-manager/org-policies/set-policy?hl=zh-cn) \u547d\u4ee4\uff1a```\ngcloud resource-manager org-policies set-policy FILE_NAME.yaml \\\u00a0 \u00a0 --organization=ORGANIZATION_NUMBER\n```\n### \u9650\u5236\u670d\u52d9\u8cec\u865f\u5bc6\u9470\u7684\u5275\u5efa\n\u5de5\u4f5c\u8ca0\u8f09\u8eab\u4efd\u806f\u5408\u5141\u8a31\u60a8\u5f9e Google Cloud \u5916\u90e8\u8a2a\u554f Google Cloud \u8cc7\u6e90\uff0c\u800c\u7121\u9700\u4f7f\u7528\u670d\u52d9\u8cec\u865f\u5bc6\u9470\u3002\u5982\u679c\u60a8\u5f9e\u4f86\u4e0d\u4f7f\u7528\u670d\u52d9\u8cec\u865f\u5bc6\u9470\u9032\u884c\u8eab\u4efd\u9a57\u8b49\uff0c\u5247\u53ef\u4ee5\u901a\u904e\u505c\u7528\u5bc6\u9470\u5275\u5efa\u4f86\u964d\u4f4e\u98a8\u96aa\u3002\n\u5982\u9700\u505c\u7528\u670d\u52d9\u8cec\u865f\u5bc6\u9470\u5275\u5efa\uff0c\u8acb\u5728\u7d44\u7e54\u7684\u7d44\u7e54\u653f\u7b56\u4e2d\u5f37\u5236\u57f7\u884c `iam.disableServiceAccountKeyCreation` \u5e03\u723e\u503c\u9650\u5236\u689d\u4ef6\u3002\u60a8\u4e5f\u53ef\u4ee5\u5f37\u5236\u57f7\u884c `iam.disableServiceAccountKeyUpload` \u5e03\u723e\u503c\u9650\u5236\u689d\u4ef6\uff0c\u8a72\u9650\u5236\u689d\u4ef6\u6703\u505c\u7528\u670d\u52d9\u8cec\u865f\u7684\u516c\u9470\u4e0a\u50b3\u3002\n\u60a8\u53ef\u4ee5\u4f7f\u7528 [Google Cloud \u63a7\u5236\u6aaf](https://cloud.google.com/resource-manager/docs/organization-policy/creating-managing-policies?hl=zh-cn#boolean_constraints) \u6216 [gcloud CLI](https://cloud.google.com/resource-manager/docs/organization-policy/using-constraints?hl=zh-cn#boolean-constraint) \u5553\u7528\u9019\u4e9b\u9650\u5236\u689d\u4ef6\u3002\u4f8b\u5982\uff0c\u4ee5\u4e0b gcloud CLI \u547d\u4ee4\u540c\u6642\u5553\u7528\u9019\u5169\u500b\u9650\u5236\u689d\u4ef6\uff1a\n```\ngcloud resource-manager org-policies enable-enforce \\\u00a0 \u00a0 constraints/iam.disableServiceAccountKeyCreation \\\u00a0 \u00a0 --organization=ORGANIZATION_NUMBERgcloud resource-manager org-policies enable-enforce \\\u00a0 \u00a0 constraints/iam.disableServiceAccountKeyUpload \\\u00a0 \u00a0 --organization=ORGANIZATION_NUMBER\n```\n## \u76e3\u63a7\u5de5\u4f5c\u8ca0\u8f09\u8eab\u4efd\u806f\u5408\n\u60a8\u53ef\u4ee5\u4f7f\u7528 [Cloud Monitoring](https://cloud.google.com/monitoring/docs?hl=zh-cn) \u6307\u6a19\u4f86\u76e3\u63a7\u5de5\u4f5c\u8ca0\u8f09\u8eab\u4efd\u6c60\u548c\u63d0\u4f9b\u65b9\u7684\u8eab\u4efd\u9a57\u8b49\u4e8b\u4ef6\u3002\u5982\u9700\u67e5\u770b\u53ef\u7528\u6307\u6a19\u7684\u5217\u8868\uff0c\u8acb\u53c3\u95b1 [IAM \u6307\u6a19](https://cloud.google.com/monitoring/api/metrics_gcp?hl=zh-cn#gcp-iam) \u3002\n## \u5f8c\u7e8c\u6b65\u9a5f\n[\u8a73\u7d30\u77ad\u89e3\u5de5\u4f5c\u8ca0\u8f09\u8eab\u4efd\u806f\u5408](https://cloud.google.com/iam/docs/workload-identity-federation?hl=zh-cn) \u3002", "guide": "IAM"}