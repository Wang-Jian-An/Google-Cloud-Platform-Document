{"title": "IAM - \u5275\u5efa\u548c\u7ba1\u7406\u81ea\u5b9a\u7fa9\u89d2\u8272", "url": "https://cloud.google.com/iam/docs/creating-custom-roles?hl=zh-cn", "abstract": "# IAM - \u5275\u5efa\u548c\u7ba1\u7406\u81ea\u5b9a\u7fa9\u89d2\u8272\n\u672c\u9801\u9762\u4ecb\u7d39\u5982\u4f55\u5275\u5efa\u548c\u7ba1\u7406 Identity and Access Management (IAM) \u81ea\u5b9a\u7fa9\u89d2\u8272\u3002\u7ba1\u7406\u89d2\u8272\u7684\u64cd\u4f5c\u5305\u62ec\u4fee\u6539\u3001\u505c\u7528\u3001\u5217\u51fa\u3001\u522a\u9664\u548c\u53d6\u6d88\u522a\u9664\u89d2\u8272\u3002\n", "content": "## \u6e96\u5099\u5de5\u4f5c\n-   Titles in dynamic includes are not used anywhere, and we should avoid paying to translate them   \u5553\u7528 IAM API\u3002 [\u5553\u7528 API](https://console.cloud.google.com/flows/enableapi?apiid=iam.googleapis.com&%3Bredirect=https%3A%2F%2Fconsole.cloud.google.com&hl=zh-cn) \n- \u8a2d\u7f6e\u8eab\u4efd\u9a57\u8b49\u3002  Titles in dynamic includes are not used anywhere, and we should avoid paying to translate them   \u9078\u64c7\u6a19\u7c64\u9801\u4ee5\u77ad\u89e3\u60a8\u6253\u7b97\u5982\u4f55\u4f7f\u7528\u672c\u9801\u9762\u4e0a\u7684\u793a\u4f8b\uff1a\n\u7576\u60a8\u4f7f\u7528 Google Cloud \u63a7\u5236\u6aaf\u8a2a\u554f Google Cloud \u670d\u52d9\u548c API \u6642\uff0c\u7121\u9700\u8a2d\u7f6e\u8eab\u4efd\u9a57\u8b49\u3002\u60a8\u53ef\u4ee5\u5f9e\u4ee5\u4e0b\u4efb\u4e00\u958b\u767c\u74b0\u5883\u4f7f\u7528\u672c\u9801\u9762\u4e0a\u7684 gcloud CLI \u793a\u4f8b\uff1a- **Cloud Shell** \uff1a\u5982\u9700\u4f7f\u7528\u5df2\u8a2d\u7f6e gcloud CLI \u7684\u5728\u7dda\u7d42\u7aef\uff0c\u8acb\u6fc0\u6d3b Cloud Shell\u3002Cloud Shell \u6703\u8a71\u6703\u5728\u9801\u9762\u5e95\u90e8\u5553\u52d5\uff0c\u4e26\u986f\u793a\u547d\u4ee4\u884c\u63d0\u793a\u7b26\u3002\u8a72\u6703\u8a71\u53ef\u80fd\u9700\u8981\u5e7e\u79d2\u9418\u4f86\u5b8c\u6210\u521d\u59cb\u5316\u3002\n- **\u672c\u5730 shell** \uff1a\u5982\u9700\u5728\u672c\u5730\u958b\u767c\u74b0\u5883\u4e2d\u4f7f\u7528 gcloud CLI\uff0c\u8acb [\u5b89\u88dd](https://cloud.google.com/sdk/docs/install?hl=zh-cn) \u4e26 [\u521d\u59cb\u5316](https://cloud.google.com/sdk/docs/initializing?hl=zh-cn) gcloud CLI\u3002\n\u5982\u9700\u5f9e\u672c\u5730\u958b\u767c\u74b0\u5883\u4f7f\u7528\u672c\u9801\u9762\u4e0a\u7684 C++ \u793a\u4f8b\uff0c\u8acb\u5b89\u88dd\u4e26\u521d\u59cb\u5316 gcloud CLI\uff0c\u7136\u5f8c\u4f7f\u7528\u7528\u6236\u6191\u64da\u8a2d\u7f6e\u61c9\u7528\u9ed8\u8a8d\u6191\u64da\u3002- Titles in dynamic includes are not used anywhere, and we should avoid paying to translate them\n- [\u5b89\u88dd](https://cloud.google.com/sdk/docs/install?hl=zh-cn) Google Cloud CLI\u3002\n- \u5982\u9700 [\u521d\u59cb\u5316](https://cloud.google.com/sdk/docs/initializing?hl=zh-cn) gcloud CLI\uff0c\u8acb\u904b\u884c\u4ee5\u4e0b\u547d\u4ee4\uff1a```\ngcloud init\n```\n- Titles in dynamic includes are not used anywhere, and we should avoid paying to translate them\n- \u7232\u60a8\u7684 Google \u8cec\u865f\u5275\u5efa\u672c\u5730\u8eab\u4efd\u9a57\u8b49\u6191\u64da\uff1a```\ngcloud auth application-default login\n```\n\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 Google Cloud \u8eab\u4efd\u9a57\u8b49\u6587\u6a94\u4e2d\u7684 [\u7232\u672c\u5730\u958b\u767c\u74b0\u5883\u8a2d\u7f6e\u8eab\u4efd\u9a57\u8b49](https://cloud.google.com/docs/authentication/provide-credentials-adc?hl=zh-cn#local-dev) \u3002\u5982\u9700\u5f9e\u672c\u5730\u958b\u767c\u74b0\u5883\u4f7f\u7528\u672c\u9801\u9762\u4e0a\u7684 .NET \u793a\u4f8b\uff0c\u8acb\u5b89\u88dd\u4e26\u521d\u59cb\u5316 gcloud CLI\uff0c\u7136\u5f8c\u4f7f\u7528\u7528\u6236\u6191\u64da\u8a2d\u7f6e\u61c9\u7528\u9ed8\u8a8d\u6191\u64da\u3002- Titles in dynamic includes are not used anywhere, and we should avoid paying to translate them\n- [\u5b89\u88dd](https://cloud.google.com/sdk/docs/install?hl=zh-cn) Google Cloud CLI\u3002\n- \u5982\u9700 [\u521d\u59cb\u5316](https://cloud.google.com/sdk/docs/initializing?hl=zh-cn) gcloud CLI\uff0c\u8acb\u904b\u884c\u4ee5\u4e0b\u547d\u4ee4\uff1a```\ngcloud init\n```\n- Titles in dynamic includes are not used anywhere, and we should avoid paying to translate them\n- \u7232\u60a8\u7684 Google \u8cec\u865f\u5275\u5efa\u672c\u5730\u8eab\u4efd\u9a57\u8b49\u6191\u64da\uff1a```\ngcloud auth application-default login\n```\n\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 Google Cloud \u8eab\u4efd\u9a57\u8b49\u6587\u6a94\u4e2d\u7684 [\u7232\u672c\u5730\u958b\u767c\u74b0\u5883\u8a2d\u7f6e\u8eab\u4efd\u9a57\u8b49](https://cloud.google.com/docs/authentication/provide-credentials-adc?hl=zh-cn#local-dev) \u3002\u5982\u9700\u5f9e\u672c\u5730\u958b\u767c\u74b0\u5883\u4f7f\u7528\u672c\u9801\u9762\u4e0a\u7684 Go \u793a\u4f8b\uff0c\u8acb\u5b89\u88dd\u4e26\u521d\u59cb\u5316 gcloud CLI\uff0c\u7136\u5f8c\u4f7f\u7528\u7528\u6236\u6191\u64da\u8a2d\u7f6e\u61c9\u7528\u9ed8\u8a8d\u6191\u64da\u3002- Titles in dynamic includes are not used anywhere, and we should avoid paying to translate them\n- [\u5b89\u88dd](https://cloud.google.com/sdk/docs/install?hl=zh-cn) Google Cloud CLI\u3002\n- \u5982\u9700 [\u521d\u59cb\u5316](https://cloud.google.com/sdk/docs/initializing?hl=zh-cn) gcloud CLI\uff0c\u8acb\u904b\u884c\u4ee5\u4e0b\u547d\u4ee4\uff1a```\ngcloud init\n```\n- Titles in dynamic includes are not used anywhere, and we should avoid paying to translate them\n- \u7232\u60a8\u7684 Google \u8cec\u865f\u5275\u5efa\u672c\u5730\u8eab\u4efd\u9a57\u8b49\u6191\u64da\uff1a```\ngcloud auth application-default login\n```\n\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 Google Cloud \u8eab\u4efd\u9a57\u8b49\u6587\u6a94\u4e2d\u7684 [\u7232\u672c\u5730\u958b\u767c\u74b0\u5883\u8a2d\u7f6e\u8eab\u4efd\u9a57\u8b49](https://cloud.google.com/docs/authentication/provide-credentials-adc?hl=zh-cn#local-dev) \u3002\u5982\u9700\u5f9e\u672c\u5730\u958b\u767c\u74b0\u5883\u4f7f\u7528\u672c\u9801\u9762\u4e0a\u7684 Java \u793a\u4f8b\uff0c\u8acb\u5b89\u88dd\u4e26\u521d\u59cb\u5316 gcloud CLI\uff0c\u7136\u5f8c\u4f7f\u7528\u7528\u6236\u6191\u64da\u8a2d\u7f6e\u61c9\u7528\u9ed8\u8a8d\u6191\u64da\u3002- Titles in dynamic includes are not used anywhere, and we should avoid paying to translate them\n- [\u5b89\u88dd](https://cloud.google.com/sdk/docs/install?hl=zh-cn) Google Cloud CLI\u3002\n- \u5982\u9700 [\u521d\u59cb\u5316](https://cloud.google.com/sdk/docs/initializing?hl=zh-cn) gcloud CLI\uff0c\u8acb\u904b\u884c\u4ee5\u4e0b\u547d\u4ee4\uff1a```\ngcloud init\n```\n- Titles in dynamic includes are not used anywhere, and we should avoid paying to translate them\n- \u7232\u60a8\u7684 Google \u8cec\u865f\u5275\u5efa\u672c\u5730\u8eab\u4efd\u9a57\u8b49\u6191\u64da\uff1a```\ngcloud auth application-default login\n```\n\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 Google Cloud \u8eab\u4efd\u9a57\u8b49\u6587\u6a94\u4e2d\u7684 [\u7232\u672c\u5730\u958b\u767c\u74b0\u5883\u8a2d\u7f6e\u8eab\u4efd\u9a57\u8b49](https://cloud.google.com/docs/authentication/provide-credentials-adc?hl=zh-cn#local-dev) \u3002\u5982\u9700\u5f9e\u672c\u5730\u958b\u767c\u74b0\u5883\u4f7f\u7528\u672c\u9801\u9762\u4e0a\u7684 Python \u793a\u4f8b\uff0c\u8acb\u5b89\u88dd\u4e26\u521d\u59cb\u5316 gcloud CLI\uff0c\u7136\u5f8c\u4f7f\u7528\u7528\u6236\u6191\u64da\u8a2d\u7f6e\u61c9\u7528\u9ed8\u8a8d\u6191\u64da\u3002- Titles in dynamic includes are not used anywhere, and we should avoid paying to translate them\n- [\u5b89\u88dd](https://cloud.google.com/sdk/docs/install?hl=zh-cn) Google Cloud CLI\u3002\n- \u5982\u9700 [\u521d\u59cb\u5316](https://cloud.google.com/sdk/docs/initializing?hl=zh-cn) gcloud CLI\uff0c\u8acb\u904b\u884c\u4ee5\u4e0b\u547d\u4ee4\uff1a```\ngcloud init\n```\n- Titles in dynamic includes are not used anywhere, and we should avoid paying to translate them\n- \u7232\u60a8\u7684 Google \u8cec\u865f\u5275\u5efa\u672c\u5730\u8eab\u4efd\u9a57\u8b49\u6191\u64da\uff1a```\ngcloud auth application-default login\n```\n\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 Google Cloud \u8eab\u4efd\u9a57\u8b49\u6587\u6a94\u4e2d\u7684 [\u7232\u672c\u5730\u958b\u767c\u74b0\u5883\u8a2d\u7f6e\u8eab\u4efd\u9a57\u8b49](https://cloud.google.com/docs/authentication/provide-credentials-adc?hl=zh-cn#local-dev) \u3002\u5982\u9700\u5728\u672c\u5730\u958b\u767c\u74b0\u5883\u4e2d\u4f7f\u7528\u672c\u9801\u9762\u4e0a\u7684 REST API \u793a\u4f8b\uff0c\u8acb\u4f7f\u7528\u60a8\u63d0\u4f9b\u7d66 gcloud CLI \u7684\u6191\u64da\u3002- Titles in dynamic includes are not used anywhere, and we should avoid paying to translate them\n- [\u5b89\u88dd](https://cloud.google.com/sdk/docs/install?hl=zh-cn) Google Cloud CLI\uff0c\u7136\u5f8c\u901a\u904e\u904b\u884c\u4ee5\u4e0b\u547d\u4ee4 [\u521d\u59cb\u5316](https://cloud.google.com/sdk/docs/initializing?hl=zh-cn) Google Cloud CLI\uff1a\n- ```\ngcloud init\n```\n- \u77ad\u89e3 Google Cloud [\u8cc7\u6e90\u5c64\u6b21\u7d50\u69cb](https://cloud.google.com/iam/docs/overview?hl=zh-cn#resource-hierarchy) \u3002\n- \u95b1\u8b80 [\u77ad\u89e3 IAM \u81ea\u5b9a\u7fa9\u89d2\u8272](https://cloud.google.com/iam/docs/understanding-custom-roles?hl=zh-cn) \u3002\n### \u6240\u9700\u7684\u89d2\u8272\n\u5982\u9700\u7372\u5f97\u5275\u5efa\u548c\u7ba1\u7406\u81ea\u5b9a\u7fa9\u89d2\u8272\u6240\u9700\u7684\u6b0a\u9650\uff0c\u8acb\u8b93\u7ba1\u7406\u54e1\u5411\u60a8\u6388\u4e88\u4ee5\u4e0b IAM \u89d2\u8272\uff1a\n- \u8981\u7ba1\u7406\u5176\u89d2\u8272\u7684\u9805\u76ee\u7684 [Role Administrator](https://cloud.google.com/iam/docs/understanding-roles?hl=zh-cn#iam.roleAdmin) (`roles/iam.roleAdmin`)\uff08\u5982\u9700\u7ba1\u7406\u9805\u76ee\u7684\u89d2\u8272\uff09\n- \u8981\u7ba1\u7406\u5176\u89d2\u8272\u7684\u7d44\u7e54\u7684 [Organization Role Administrator](https://cloud.google.com/iam/docs/understanding-roles?hl=zh-cn#iam.organizationRoleAdmin) (`roles/iam.organizationRoleAdmin`)\uff08\u5982\u9700\u7ba1\u7406\u7d44\u7e54\u7684\u89d2\u8272\uff09\n\u5982\u9700\u8a73\u7d30\u77ad\u89e3\u5982\u4f55\u6388\u4e88\u89d2\u8272\uff0c\u8acb\u53c3\u95b1 [\u7ba1\u7406\u8a2a\u554f\u6b0a\u9650](https://cloud.google.com/iam/docs/granting-changing-revoking-access?hl=zh-cn) \u3002\n\u60a8\u4e5f\u53ef\u4ee5\u901a\u904e [\u81ea\u5b9a\u7fa9\u89d2\u8272](https://cloud.google.com/iam/docs/creating-custom-roles?hl=zh-cn) \u6216\u5176\u4ed6 [\u9810\u5b9a\u7fa9\u89d2\u8272](https://cloud.google.com/iam/docs/understanding-roles?hl=zh-cn) \u4f86\u7372\u53d6\u6240\u9700\u7684\u6b0a\u9650\u3002\n[](None)\n## \u67e5\u770b\u9805\u76ee\u3001\u6587\u4ef6\u593e\u548c\u7d44\u7e54\u7684\u53ef\u7528\u6b0a\u9650\n\u60a8\u53ef\u4ee5\u7232\u6574\u500b\u7d44\u7e54\u6216\u8a72\u7d44\u7e54\u4e2d\u7684\u7279\u5b9a\u9805\u76ee\u5275\u5efa\u81ea\u5b9a\u7fa9\u89d2\u8272\u3002\u81ea\u5b9a\u7fa9\u89d2\u8272\u53ef\u7528\u7684\u6b0a\u9650\u53d6\u6c7a\u65bc\u60a8\u5275\u5efa\u8a72\u89d2\u8272\u7684\u4f4d\u7f6e\u3002\u4f8b\u5982\uff0c\u5982\u679c\u6709\u67d0\u9805\u6b0a\u9650\u53ea\u80fd\u5728\u7d44\u7e54\u7d1a\u5c64\u4f7f\u7528\uff0c\u90a3\u9ebc\u60a8\u4fbf\u7121\u6cd5\u5728\u9805\u76ee\u7d1a\u5c64\u81ea\u5b9a\u7fa9\u89d2\u8272\u4e2d\u6dfb\u52a0\u8a72\u6b0a\u9650\u3002\n\u5982\u9700\u6aa2\u67e5\u7d44\u7e54\u7d1a\u5c64\u548c\u9805\u76ee\u7d1a\u81ea\u5b9a\u7fa9\u89d2\u8272\u53ef\u4ee5\u4f7f\u7528\u54ea\u4e9b\u6b0a\u9650\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528 gcloud CLI \u6216 Identity and Access Management API\uff0c\u5217\u51fa\u7279\u5b9a\u7d44\u7e54\u6216\u9805\u76ee\u4e2d\u53ef\u7528\u7684\u6b0a\u9650\u3002\u4f8b\u5982\uff0c\u60a8\u53ef\u4ee5\u7372\u53d6\u53ef\u7528\u65bc\u5728\u9805\u76ee\u4e2d\u5275\u5efa\u7684\u81ea\u5b9a\u7fa9\u89d2\u8272\u7684\u6240\u6709\u6b0a\u9650\u3002\n\u67d0\u4e9b\u6b0a\u9650\u53ef\u80fd\u5c0d\u60a8\u4e0d\u53ef\u898b\u6216\u4e0d\u53ef\u7528\u65bc\u81ea\u5b9a\u7fa9\u89d2\u8272\uff0c\u5373\u4f7f\u9019\u4e9b\u6b0a\u9650\u5728\u81ea\u5b9a\u7fa9\u89d2\u8272\u4e2d\u53d7\u652f\u6301\u4e5f\u662f\u5982\u6b64\u3002\u4f8b\u5982\uff0c\u5982\u679c\u60a8\u5c1a\u672a\u7232\u670d\u52d9 [\u5553\u7528 API](https://cloud.google.com/apis/docs/getting-started?hl=zh-cn#enabling_apis) \uff0c\u5247\u53ef\u80fd\u7121\u6cd5\u5728\u81ea\u5b9a\u7fa9\u89d2\u8272\u4e2d\u4f7f\u7528\u67d0\u9805\u6b0a\u9650\u3002\n\u5982\u9700\u8a73\u7d30\u77ad\u89e3\u53ef\u4ee5\u6dfb\u52a0\u5230\u81ea\u5b9a\u7fa9\u89d2\u8272\u7684\u6b0a\u9650\uff0c\u8acb\u53c3\u95b1 [\u652f\u6301\u7684\u6b0a\u9650](https://cloud.google.com/iam/docs/roles-overview?hl=zh-cn#custom-role-supported-permissions) \u3002\n- Titles in dynamic includes are not used anywhere, and we should avoid paying to translate them\u5728 Google Cloud \u63a7\u5236\u6aaf\u4e2d\uff0c\u6fc0\u6d3b Cloud Shell\u3002 [\u6fc0\u6d3b Cloud Shell](https://console.cloud.google.com/?cloudshell=true&hl=zh-cn)  [Cloud Shell](https://cloud.google.com/shell/docs/how-cloud-shell-works?hl=zh-cn) \u6703\u8a71\u96a8\u5373\u6703\u5728 Google Cloud \u63a7\u5236\u6aaf\u7684\u5e95\u90e8\u5553\u52d5\uff0c\u4e26\u986f\u793a\u547d\u4ee4\u884c\u63d0\u793a\u7b26\u3002Cloud Shell \u662f\u4e00\u500b\u5df2\u5b89\u88dd Google Cloud CLI \u4e14\u5df2\u7232\u7576\u524d\u9805\u76ee\u8a2d\u7f6e\u503c\u7684 Shell \u74b0\u5883\u3002\u8a72\u6703\u8a71\u53ef\u80fd\u9700\u8981\u5e7e\u79d2\u9418\u6642\u9593\u4f86\u5b8c\u6210\u521d\u59cb\u5316\u3002\n- \u4f7f\u7528 ` [gcloud iam list-testable-permissions](https://cloud.google.com/sdk/gcloud/reference/iam/list-testable-permissions?hl=zh-cn) ` \u547d\u4ee4\u7372\u53d6\u7279\u5b9a\u9805\u76ee\u6216\u7d44\u7e54\u4e2d\u81ea\u5b9a\u7fa9\u89d2\u8272\u53ef\u7528\u7684\u6b0a\u9650\u5217\u8868\u3002\u97ff\u61c9\u6703\u5217\u51fa\u60a8\u53ef\u4ee5\u5728\u8a72\u9805\u76ee\u6216\u7d44\u7e54\u7684\u81ea\u5b9a\u7fa9\u89d2\u8272\u4e2d\u4f7f\u7528\u7684\u6b0a\u9650\u3002\u8981\u5217\u51fa\u9805\u76ee\u6216\u7d44\u7e54\u7684\u81ea\u5b9a\u7fa9\u89d2\u8272\u4e2d\u53ef\u7528\u7684\u6b0a\u9650\uff0c\u8acb\u904b\u884c\u6b64\u547d\u4ee4\uff1a```\ngcloud iam list-testable-permissions FULL_RESOURCE_NAME \\\n --filter=\"customRolesSupportLevel!=NOT_SUPPORTED\"\n```\u5c07 `` \u66ff\u63db\u7232\u4ee5\u4e0b\u67d0\u500b\u503c\uff1a- \u9805\u76ee\uff1a `//cloudresourcemanager.googleapis.com/projects/` `` \uff08\u4f8b\u5982 `//cloudresourcemanager.googleapis.com/projects/my-project` \uff09\n- \u7d44\u7e54\uff1a `//cloudresourcemanager.googleapis.com/organizations/` `` \uff08\u4f8b\u5982 `//cloudresourcemanager.googleapis.com/organizations/123456789012` \uff09\n\u7d50\u679c\u6703\u6307\u660e\u81ea\u5b9a\u7fa9\u89d2\u8272\u662f\u5426\u652f\u6301\u6bcf\u500b\u6b0a\u9650\u3002  \u6c92\u6709 `customRolesSupportLevel` \u5b57\u6bb5\u7684\u6b0a\u9650\u5b8c\u5168\u53d7\u652f\u6301\u3002`list-testable-permissions` \u547d\u4ee4\u53ef\u80fd\u6703\u8fd4\u56de\u6578\u767e\u500b\u7d50\u679c\u3002\u4ee5\u4e0b\u90e8\u5206\u793a\u4f8b\u986f\u793a\u4e86\u6bcf\u500b\u7d50\u679c\u7684\u683c\u5f0f\uff1a```\n--name: appengine.applications.create\nstage: GA\n--customRolesSupportLevel: TESTING\nname: appengine.applications.disable\nstage: GA\n--name: appengine.applications.get\nstage: GA\n--name: appengine.applications.update\nstage: GA\n--name: appengine.instances.delete\nstage: GA\n--name: appengine.instances.get\nstage: GA\n--\n```\n\u5982\u9700\u77ad\u89e3\u5982\u4f55\u5b89\u88dd\u548c\u4f7f\u7528 IAM \u5ba2\u6236\u7aef\u5eab\uff0c\u8acb\u53c3\u95b1 [IAM \u5ba2\u6236\u7aef\u5eab](https://cloud.google.com/iam/docs/reference/libraries?hl=zh-cn) \u3002\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [IAM C++ API \u53c3\u8003\u6587\u6a94](https://cloud.google.com/cpp/docs/reference/iam/latest?hl=zh-cn) \u3002\n\u5982\u9700\u5411 IAM \u9032\u884c\u8eab\u4efd\u9a57\u8b49\uff0c\u8acb\u8a2d\u7f6e\u61c9\u7528\u9ed8\u8a8d\u6191\u64da\u3002  \u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [\u6e96\u5099\u5de5\u4f5c](#before-you-begin) \u3002\n [\u5728 GitHub \u4e0a\u67e5\u770b](https://github.com/googleapis/google-cloud-cpp/blob/HEAD/google/cloud/iam/samples/iam_samples.cc) \n```\nnamespace iam = ::google::cloud::iam_admin_v1;[](std::string const& resource) {\u00a0 iam::IAMClient client(iam::MakeIAMConnection());\u00a0 google::iam::admin::v1::QueryTestablePermissionsRequest request;\u00a0 request.set_full_resource_name(resource);\u00a0 int count = 0;\u00a0 for (auto& permission : client.QueryTestablePermissions(request)) {\u00a0 \u00a0 if (!permission) throw std::move(permission).status();\u00a0 \u00a0 std::cout << \"Permission successfully retrieved: \" << permission->name()\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 << \"\\n\";\u00a0 \u00a0 ++count;\u00a0 }\u00a0 if (count == 0) {\u00a0 \u00a0 std::cout << \"No testable permissions found in resource: \" << resource\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 << \"\\n\";\u00a0 }}\n```\u5982\u9700\u77ad\u89e3\u5982\u4f55\u5b89\u88dd\u548c\u4f7f\u7528 IAM \u5ba2\u6236\u7aef\u5eab\uff0c\u8acb\u53c3\u95b1 [IAM \u5ba2\u6236\u7aef\u5eab](https://cloud.google.com/iam/docs/reference/libraries?hl=zh-cn) \u3002\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [IAM C# API \u53c3\u8003\u6587\u6a94](https://developers.google.com/api-client-library/dotnet/apis/iam/v1?hl=zh-cn) \u3002\n\u5982\u9700\u5411 IAM \u9032\u884c\u8eab\u4efd\u9a57\u8b49\uff0c\u8acb\u8a2d\u7f6e\u61c9\u7528\u9ed8\u8a8d\u6191\u64da\u3002  \u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [\u6e96\u5099\u5de5\u4f5c](#before-you-begin) \u3002\n [\u5728 GitHub \u4e0a\u67e5\u770b](https://github.com/GoogleCloudPlatform/dotnet-docs-samples/blob/HEAD/iam/api/CustomRoles/PermissionsQueryTestable.cs) \n```\nusing System;using System.Collections.Generic;using Google.Apis.Auth.OAuth2;using Google.Apis.Iam.v1;using Google.Apis.Iam.v1.Data;public partial class CustomRoles{\u00a0 \u00a0 public static IList<Permission> QueryTestablePermissions(\u00a0 \u00a0 \u00a0 \u00a0 string fullResourceName)\u00a0 \u00a0 {\u00a0 \u00a0 \u00a0 \u00a0 var credential = GoogleCredential.GetApplicationDefault()\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 .CreateScoped(IamService.Scope.CloudPlatform);\u00a0 \u00a0 \u00a0 \u00a0 var service = new IamService(new IamService.Initializer\u00a0 \u00a0 \u00a0 \u00a0 {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 HttpClientInitializer = credential\u00a0 \u00a0 \u00a0 \u00a0 });\u00a0 \u00a0 \u00a0 \u00a0 var request = new QueryTestablePermissionsRequest\u00a0 \u00a0 \u00a0 \u00a0 {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 FullResourceName = fullResourceName\u00a0 \u00a0 \u00a0 \u00a0 };\u00a0 \u00a0 \u00a0 \u00a0 var response = service.Permissions.QueryTestablePermissions(request)\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 .Execute();\u00a0 \u00a0 \u00a0 \u00a0 foreach (var p in response.Permissions)\u00a0 \u00a0 \u00a0 \u00a0 {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 Console.WriteLine(p.Name);\u00a0 \u00a0 \u00a0 \u00a0 }\u00a0 \u00a0 \u00a0 \u00a0 return response.Permissions;\u00a0 \u00a0 }}\n```\u5982\u9700\u77ad\u89e3\u5982\u4f55\u5b89\u88dd\u548c\u4f7f\u7528 IAM \u5ba2\u6236\u7aef\u5eab\uff0c\u8acb\u53c3\u95b1 [IAM \u5ba2\u6236\u7aef\u5eab](https://cloud.google.com/iam/docs/reference/libraries?hl=zh-cn) \u3002\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [IAM Go API \u53c3\u8003\u6587\u6a94](https://godoc.org/google.golang.org/genproto/googleapis/iam/admin/v1) \u3002\n\u5982\u9700\u5411 IAM \u9032\u884c\u8eab\u4efd\u9a57\u8b49\uff0c\u8acb\u8a2d\u7f6e\u61c9\u7528\u9ed8\u8a8d\u6191\u64da\u3002  \u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [\u6e96\u5099\u5de5\u4f5c](#before-you-begin) \u3002\n [\u5728 GitHub \u4e0a\u67e5\u770b](https://github.com/GoogleCloudPlatform/golang-samples/blob/HEAD/iam/snippets/permissions_query_testable.go) \n```\nimport (\u00a0 \u00a0 \u00a0 \u00a0 \"context\"\u00a0 \u00a0 \u00a0 \u00a0 \"fmt\"\u00a0 \u00a0 \u00a0 \u00a0 \"io\"\u00a0 \u00a0 \u00a0 \u00a0 iam \"google.golang.org/api/iam/v1\")// queryTestablePermissions lists testable permissions on a resource.func queryTestablePermissions(w io.Writer, fullResourceName string) ([]*iam.Permission, error) {\u00a0 \u00a0 \u00a0 \u00a0 ctx := context.Background()\u00a0 \u00a0 \u00a0 \u00a0 service, err := iam.NewService(ctx)\u00a0 \u00a0 \u00a0 \u00a0 if err != nil {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 return nil, fmt.Errorf(\"iam.NewService: %w\", err)\u00a0 \u00a0 \u00a0 \u00a0 }\u00a0 \u00a0 \u00a0 \u00a0 request := &iam.QueryTestablePermissionsRequest{\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 FullResourceName: fullResourceName,\u00a0 \u00a0 \u00a0 \u00a0 }\u00a0 \u00a0 \u00a0 \u00a0 response, err := service.Permissions.QueryTestablePermissions(request).Do()\u00a0 \u00a0 \u00a0 \u00a0 if err != nil {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 return nil, fmt.Errorf(\"Permissions.QueryTestablePermissions: %w\", err)\u00a0 \u00a0 \u00a0 \u00a0 }\u00a0 \u00a0 \u00a0 \u00a0 for _, p := range response.Permissions {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 fmt.Fprintf(w, \"Found permissions: %v\", p.Name)\u00a0 \u00a0 \u00a0 \u00a0 }\u00a0 \u00a0 \u00a0 \u00a0 return response.Permissions, nil}\n```\u5982\u9700\u77ad\u89e3\u5982\u4f55\u5b89\u88dd\u548c\u4f7f\u7528 IAM \u5ba2\u6236\u7aef\u5eab\uff0c\u8acb\u53c3\u95b1 [IAM \u5ba2\u6236\u7aef\u5eab](https://cloud.google.com/iam/docs/reference/libraries?hl=zh-cn) \u3002\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [IAM Java API \u53c3\u8003\u6587\u6a94](https://developers.google.com/api-client-library/java/apis/iam/v1?hl=zh-cn) \u3002\n\u5982\u9700\u5411 IAM \u9032\u884c\u8eab\u4efd\u9a57\u8b49\uff0c\u8acb\u8a2d\u7f6e\u61c9\u7528\u9ed8\u8a8d\u6191\u64da\u3002  \u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [\u6e96\u5099\u5de5\u4f5c](#before-you-begin) \u3002\n [\u5728 GitHub \u4e0a\u67e5\u770b](https://github.com/GoogleCloudPlatform/java-docs-samples/blob/HEAD/iam/snippets/src/main/java/QueryTestablePermissions.java) \n```\nimport com.google.cloud.iam.admin.v1.IAMClient;import com.google.cloud.iam.admin.v1.IAMClient.QueryTestablePermissionsPagedResponse;import com.google.iam.admin.v1.QueryTestablePermissionsRequest;import java.io.IOException;/** View available permissions in a project. */public class QueryTestablePermissions {\u00a0 public static void main(String[] args) throws IOException {\u00a0 \u00a0 // TODO(developer): Replace the variable before running the sample.\u00a0 \u00a0 // Full resource names can take one of the following forms:\u00a0 \u00a0 // cloudresourcemanager.googleapis.com/projects/PROJECT_ID\u00a0 \u00a0 // cloudresourcemanager.googleapis.com/organizations/NUMERIC_ID\u00a0 \u00a0 String fullResourceName = \"your-full-resource-name\";\u00a0 \u00a0 queryTestablePermissions(fullResourceName);\u00a0 }\u00a0 public static void queryTestablePermissions(String fullResourceName) throws IOException {\u00a0 \u00a0 QueryTestablePermissionsRequest queryTestablePermissionsRequest =\u00a0 \u00a0 \u00a0 \u00a0 QueryTestablePermissionsRequest.newBuilder().setFullResourceName(fullResourceName).build();\u00a0 \u00a0 try (IAMClient iamClient = IAMClient.create()) {\u00a0 \u00a0 \u00a0 QueryTestablePermissionsPagedResponse queryTestablePermissionsPagedResponse =\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 iamClient.queryTestablePermissions(queryTestablePermissionsRequest);\u00a0 \u00a0 \u00a0 queryTestablePermissionsPagedResponse\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 .iterateAll()\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 .forEach(permission -> System.out.println(permission.getName()));\u00a0 \u00a0 }\u00a0 }}\n```\u5982\u9700\u77ad\u89e3\u5982\u4f55\u5b89\u88dd\u548c\u4f7f\u7528 IAM \u5ba2\u6236\u7aef\u5eab\uff0c\u8acb\u53c3\u95b1 [IAM \u5ba2\u6236\u7aef\u5eab](https://cloud.google.com/iam/docs/reference/libraries?hl=zh-cn) \u3002\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [IAM Python API \u53c3\u8003\u6587\u6a94](https://developers.google.com/api-client-library/python/apis/iam/v1?hl=zh-cn) \u3002\n\u5982\u9700\u5411 IAM \u9032\u884c\u8eab\u4efd\u9a57\u8b49\uff0c\u8acb\u8a2d\u7f6e\u61c9\u7528\u9ed8\u8a8d\u6191\u64da\u3002  \u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [\u6e96\u5099\u5de5\u4f5c](#before-you-begin) \u3002\n [\u5728 GitHub \u4e0a\u67e5\u770b](https://github.com/GoogleCloudPlatform/python-docs-samples/blob/HEAD/iam/api-client/custom_roles.py) \n```\ndef query_testable_permissions(resource: str) -> None:\u00a0 \u00a0 \"\"\"Lists valid permissions for a resource.\"\"\"\u00a0 \u00a0 # pylint: disable=no-member\u00a0 \u00a0 permissions = (\u00a0 \u00a0 \u00a0 \u00a0 service.permissions()\u00a0 \u00a0 \u00a0 \u00a0 .queryTestablePermissions(body={\"fullResourceName\": resource})\u00a0 \u00a0 \u00a0 \u00a0 .execute()[\"permissions\"]\u00a0 \u00a0 )\u00a0 \u00a0 for p in permissions:\u00a0 \u00a0 \u00a0 \u00a0 print(p[\"name\"])\n``` ` [permissions.queryTestablePermissions](https://cloud.google.com/iam/docs/reference/rest/v1/permissions/queryTestablePermissions?hl=zh-cn) ` \u65b9\u6cd5\u53ef\u5217\u51fa\u7d44\u7e54\u6216\u9805\u76ee\u53ef\u7528\u7684\u6b0a\u9650\u3002\n\u5728\u4f7f\u7528\u4efb\u4f55\u8acb\u6c42\u6578\u64da\u4e4b\u524d\uff0c\u8acb\u5148\u9032\u884c\u4ee5\u4e0b\u66ff\u63db\uff1a- ``\uff1a\u7531\u670d\u52d9\u540d\u7a31\u548c\u8cc7\u6e90\u8def\u5f91\u7d44\u6210\u7684 URI\u3002\u5982\u9700\u67e5\u770b\u793a\u4f8b\uff0c\u8acb\u53c3\u95b1 [\u5b8c\u6574\u8cc7\u6e90\u540d\u7a31](https://cloud.google.com/iam/docs/full-resource-names?hl=zh-cn) \u3002\n- ``\uff1a\u53ef\u9078\u3002\u8981\u5305\u542b\u5728\u97ff\u61c9\u4e2d\u7684\u6b0a\u9650\u7684\u6578\u91cf\u3002\u9ed8\u8a8d\u503c\u7232 100\uff0c\u6700\u5927\u503c\u7232 1000\u3002\u5982\u679c\u6b0a\u9650\u6578\u5927\u65bc\u9801\u9762\u5927\u5c0f\uff0c\u5247\u97ff\u61c9\u4e2d\u6703\u5305\u542b\u5206\u9801\u4ee4\u724c\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528\u8a72\u4ee4\u724c\u6aa2\u7d22\u4e0b\u4e00\u9801\u7d50\u679c\u3002\n- ``\uff1a\u53ef\u9078\u3002\u6b64\u65b9\u6cd5\u4e4b\u524d\u7684\u97ff\u61c9\u4e2d\u8fd4\u56de\u7684\u5206\u9801\u4ee4\u724c\u3002\u5982\u679c\u5df2\u6307\u5b9a\uff0c\u5247\u53ef\u6e2c\u8a66\u6b0a\u9650\u5217\u8868\u5c07\u5f9e\u4e0a\u4e00\u500b\u97ff\u61c9\u7d50\u675f\u7684\u4f4d\u7f6e\u958b\u59cb\u3002\nHTTP \u65b9\u6cd5\u548c\u7db2\u5740\uff1a\n```\nPOST https://iam.googleapis.com/v1/permissions:queryTestablePermissions\n```\n\u8acb\u6c42 JSON \u6b63\u6587\uff1a\n```\n{\n \"fullResourceName\": \"FULL_RESOURCE_NAME\"\n \"pageSize\": PAGE_SIZE,\n \"pageToken\": \"NEXT_PAGE_TOKEN\"\n}\n```\n\u5982\u9700\u767c\u9001\u60a8\u7684\u8acb\u6c42\uff0c\u8acb\u5c55\u958b\u4ee5\u4e0b\u9078\u9805\u4e4b\u4e00\uff1a\n\u97ff\u61c9\u5305\u542b\u6b0a\u9650\u5217\u8868\u3002\n **\u6ce8\u610f** \uff1a\u6c92\u6709`customRolesSupportLevel`\u5b57\u6bb5\u7684\u6b0a\u9650\u5728\u81ea\u5b9a\u7fa9\u89d2\u8272\u4e2d\u5b8c\u5168\u53d7\u652f\u6301\u3002\n```\n{\n \"permissions\": [ {\n  \"name\": \"iam.serviceAccountKeys.create\",\n  \"stage\": \"GA\"\n },\n {\n  \"name\": \"iam.serviceAccountKeys.delete\",\n  \"stage\": \"GA\"\n },\n {\n  \"name\": \"iam.serviceAccountKeys.get\",\n  \"stage\": \"GA\"\n }\n ],\n \"nextPageToken\": \"CgoHBajEfjUDQyABEPaIv5vIiMDTVhgDIhtpYW0uc2VydmljZUFjY291bnRLZXlzLmxpc3Q\"\n}\n```\n[](None)\n## \u7372\u53d6\u89d2\u8272\u5143\u6578\u64da\n\u5728\u5275\u5efa\u81ea\u5b9a\u7fa9\u89d2\u8272\u4e4b\u524d\uff0c\u60a8\u61c9\u5148\u7372\u53d6\u9810\u5b9a\u7fa9\u89d2\u8272\u548c\u81ea\u5b9a\u7fa9\u89d2\u8272\u7684\u5143\u6578\u64da\u3002\u89d2\u8272\u5143\u6578\u64da\u5305\u62ec\u89d2\u8272 ID \u548c\u89d2\u8272\u6240\u542b\u7684\u6b0a\u9650\u3002\u60a8\u53ef\u4ee5\u4f7f\u7528 Google Cloud \u63a7\u5236\u6aaf\u6216 IAM API \u67e5\u770b\u5143\u6578\u64da\u3002\n\u8981\u67e5\u770b\u89d2\u8272\u5143\u6578\u64da\uff0c\u8acb\u4f7f\u7528\u4ee5\u4e0b\u65b9\u6cd5\u4e4b\u4e00\uff1a\n- \u5728 Google Cloud \u63a7\u5236\u6aaf\u4e2d\uff0c\u8f49\u5230 **\u89d2\u8272** \u9801\u9762\u3002 [\u8f49\u5230\u201c\u89d2\u8272\u201d\u9801\u9762](https://console.cloud.google.com/iam-admin/roles?hl=zh-cn) \n- \u5f9e\u9801\u9762\u9802\u90e8\u7684\u4e0b\u62c9\u5217\u8868\u4e2d\u9078\u64c7\u60a8\u7684\u7d44\u7e54\u6216\u9805\u76ee\u3002\n- \u9078\u4e2d\u4e00\u500b\u6216\u591a\u500b\u89d2\u8272\u5c0d\u61c9\u7684\u8907\u9078\u6846\u4ee5\u67e5\u770b\u89d2\u8272\u6b0a\u9650\u3002 \u53f3\u5074\u9762\u677f\u6703\u986f\u793a\u76f8\u61c9\u89d2\u8272\u4e2d\u6240\u542b\u7684\u6b0a\u9650\uff08\u5982\u6709\uff09\u3002\n **\u985e\u578b** \u5217\u4e2d\u7684\u5716\u6a19\u8868\u660e\u9019\u662f\u81ea\u5b9a\u7fa9\u89d2\u8272 \uff08\u201c\u5de5\u5ee0\u201d\u5716\u6a19\uff09 \u9084\u662f\u9810\u5b9a\u7fa9\u89d2\u8272 \uff08\u516d\u908a\u5f62\u5716\u6a19\uff09\u3002\u5982\u679c\u60a8\u60f3\u8981\u67e5\u627e\u5305\u542b\u7279\u5b9a\u6b0a\u9650\u7684\u6240\u6709\u89d2\u8272\uff0c\u8acb\u5728\u201c\u89d2\u8272\u201d\u5217\u8868\u9802\u90e8\u7684 **\u904e\u6ffe\u689d\u4ef6** \u6846\u4e2d\u8f38\u5165\u6b0a\u9650\u540d\u7a31\u3002- Titles in dynamic includes are not used anywhere, and we should avoid paying to translate them\u5728 Google Cloud \u63a7\u5236\u6aaf\u4e2d\uff0c\u6fc0\u6d3b Cloud Shell\u3002 [\u6fc0\u6d3b Cloud Shell](https://console.cloud.google.com/?cloudshell=true&hl=zh-cn)  [Cloud Shell](https://cloud.google.com/shell/docs/how-cloud-shell-works?hl=zh-cn) \u6703\u8a71\u96a8\u5373\u6703\u5728 Google Cloud \u63a7\u5236\u6aaf\u7684\u5e95\u90e8\u5553\u52d5\uff0c\u4e26\u986f\u793a\u547d\u4ee4\u884c\u63d0\u793a\u7b26\u3002Cloud Shell \u662f\u4e00\u500b\u5df2\u5b89\u88dd Google Cloud CLI \u4e14\u5df2\u7232\u7576\u524d\u9805\u76ee\u8a2d\u7f6e\u503c\u7684 Shell \u74b0\u5883\u3002\u8a72\u6703\u8a71\u53ef\u80fd\u9700\u8981\u5e7e\u79d2\u9418\u6642\u9593\u4f86\u5b8c\u6210\u521d\u59cb\u5316\u3002\n- \u4f7f\u7528 ` [gcloud iam roles describe](https://cloud.google.com/sdk/gcloud/reference/iam/roles/describe?hl=zh-cn) ` \u547d\u4ee4\u67e5\u770b\u9810\u5b9a\u7fa9\u89d2\u8272\u548c\u81ea\u5b9a\u7fa9\u89d2\u8272\u7684\u5143\u6578\u64da\u3002\u8981\u67e5\u770b\u9810\u5b9a\u7fa9\u89d2\u8272\u7684\u5143\u6578\u64da\uff0c\u8acb\u57f7\u884c\u4ee5\u4e0b\u547d\u4ee4\uff1a```\ngcloud iam roles describe ROLE_ID\n````` \u662f\u89d2\u8272\u7684 ID\u3002\u9810\u5b9a\u7fa9\u89d2\u8272\u7684 ID \u4e2d\u5305\u542b `role` \u524d\u7db4\uff0c\u4f8b\u5982 `roles/iam.roleViewer` \u3002\u4ee5\u4e0b\u793a\u4f8b\u6f14\u793a\u4e86\u91dd\u5c0d\u9810\u5b9a\u7fa9\u89d2\u8272 `roles/iam.roleViewer` \u57f7\u884c `describe` \u547d\u4ee4\u6642\u7684\u8f38\u51fa\u7d50\u679c\uff1a`gcloud iam roles describe roles/iam.roleViewer````\ndescription: Read access to all custom roles in the project.etag: AA==includedPermissions:- iam.roles.get- iam.roles.list- resourcemanager.projects.get- resourcemanager.projects.getIamPolicyname: roles/iam.roleViewerstage: GAtitle: Role Viewer\n```\u8981\u67e5\u770b\u81ea\u5b9a\u7fa9\u89d2\u8272\u7684\u5143\u6578\u64da\uff0c\u8acb\u57f7\u884c\u4ee5\u4e0b\u547d\u4ee4\u4e4b\u4e00\uff1a- \u8981\u67e5\u770b\u5728\u7d44\u7e54\u7d1a\u5c64\u5275\u5efa\u7684\u81ea\u5b9a\u7fa9\u89d2\u8272\u7684\u5143\u6578\u64da\uff0c\u8acb\u57f7\u884c\u4ee5\u4e0b\u547d\u4ee4\uff1a```\ngcloud iam roles describe --organization=ORGANIZATION_ID ROLE_ID\n```\n- \u8981\u67e5\u770b\u5728\u9805\u76ee\u7d1a\u5c64\u5275\u5efa\u7684\u81ea\u5b9a\u7fa9\u89d2\u8272\u7684\u5143\u6578\u64da\uff0c\u8acb\u57f7\u884c\u4ee5\u4e0b\u547d\u4ee4\uff1a```\ngcloud iam roles describe --project=PROJECT_ID ROLE_ID\n```\n\u6bcf\u500b\u4f54\u4f4d\u503c\u7684\u8aaa\u660e\u5982\u4e0b\uff1a- `` \u662f\u7d44\u7e54\u7684\u6578\u5b57 ID\uff0c\u4f8b\u5982 `123456789012` \u3002\n- `` \u662f\u9805\u76ee\u7684\u540d\u7a31\uff0c\u4f8b\u5982 `my-project` \u3002\n- `` \u662f\u89d2\u8272\u7684 ID\uff0c\u4e0d\u5305\u62ec `projects/` \u3001 `organizations/` \u6216 `roles/` \u7b49\u4efb\u4f55\u524d\u7db4\u3002\u4f8b\u5982 `myCompanyAdmin` \u3002\n\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 `` ` [gcloud iam roles describe](https://cloud.google.com/sdk/gcloud/reference/iam/roles/describe?hl=zh-cn) ` \u7684\u53c3\u8003\u6587\u6a94\u3002\n\u5982\u9700\u77ad\u89e3\u5982\u4f55\u5b89\u88dd\u548c\u4f7f\u7528 IAM \u5ba2\u6236\u7aef\u5eab\uff0c\u8acb\u53c3\u95b1 [IAM \u5ba2\u6236\u7aef\u5eab](https://cloud.google.com/iam/docs/reference/libraries?hl=zh-cn) \u3002\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [IAM C++ API \u53c3\u8003\u6587\u6a94](https://cloud.google.com/cpp/docs/reference/iam/latest?hl=zh-cn) \u3002\n\u5982\u9700\u5411 IAM \u9032\u884c\u8eab\u4efd\u9a57\u8b49\uff0c\u8acb\u8a2d\u7f6e\u61c9\u7528\u9ed8\u8a8d\u6191\u64da\u3002  \u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [\u6e96\u5099\u5de5\u4f5c](#before-you-begin) \u3002\n [\u5728 GitHub \u4e0a\u67e5\u770b](https://github.com/googleapis/google-cloud-cpp/blob/HEAD/google/cloud/iam/samples/iam_samples.cc) \n```\nnamespace iam = ::google::cloud::iam_admin_v1;[](std::string const& name) {\u00a0 iam::IAMClient client(iam::MakeIAMConnection());\u00a0 google::iam::admin::v1::GetRoleRequest request;\u00a0 request.set_name(name);\u00a0 auto response = client.GetRole(request);\u00a0 if (!response) throw std::move(response).status();\u00a0 std::cout << \"Role successfully retrieved: \" << response->DebugString()\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 << \"\\n\";}\n```\u5982\u9700\u77ad\u89e3\u5982\u4f55\u5b89\u88dd\u548c\u4f7f\u7528 IAM \u5ba2\u6236\u7aef\u5eab\uff0c\u8acb\u53c3\u95b1 [IAM \u5ba2\u6236\u7aef\u5eab](https://cloud.google.com/iam/docs/reference/libraries?hl=zh-cn) \u3002\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [IAM C# API \u53c3\u8003\u6587\u6a94](https://developers.google.com/api-client-library/dotnet/apis/iam/v1?hl=zh-cn) \u3002\n\u5982\u9700\u5411 IAM \u9032\u884c\u8eab\u4efd\u9a57\u8b49\uff0c\u8acb\u8a2d\u7f6e\u61c9\u7528\u9ed8\u8a8d\u6191\u64da\u3002  \u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [\u6e96\u5099\u5de5\u4f5c](#before-you-begin) \u3002\n [\u5728 GitHub \u4e0a\u67e5\u770b](https://github.com/GoogleCloudPlatform/dotnet-docs-samples/blob/HEAD/iam/api/CustomRoles/RolesGet.cs) \n```\nusing System;using Google.Apis.Auth.OAuth2;using Google.Apis.Iam.v1;using Google.Apis.Iam.v1.Data;public partial class CustomRoles{\u00a0 \u00a0 public static Role GetRole(string name)\u00a0 \u00a0 {\u00a0 \u00a0 \u00a0 \u00a0 var credential = GoogleCredential.GetApplicationDefault()\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 .CreateScoped(IamService.Scope.CloudPlatform);\u00a0 \u00a0 \u00a0 \u00a0 var service = new IamService(new IamService.Initializer\u00a0 \u00a0 \u00a0 \u00a0 {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 HttpClientInitializer = credential\u00a0 \u00a0 \u00a0 \u00a0 });\u00a0 \u00a0 \u00a0 \u00a0 var role = service.Roles.Get(name).Execute();\u00a0 \u00a0 \u00a0 \u00a0 Console.WriteLine(role.Name);\u00a0 \u00a0 \u00a0 \u00a0 Console.WriteLine(String.Join(\", \", role.IncludedPermissions));\u00a0 \u00a0 \u00a0 \u00a0 return role;\u00a0 \u00a0 }}\n```\u5982\u9700\u77ad\u89e3\u5982\u4f55\u5b89\u88dd\u548c\u4f7f\u7528 IAM \u5ba2\u6236\u7aef\u5eab\uff0c\u8acb\u53c3\u95b1 [IAM \u5ba2\u6236\u7aef\u5eab](https://cloud.google.com/iam/docs/reference/libraries?hl=zh-cn) \u3002\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [IAM Go API \u53c3\u8003\u6587\u6a94](https://godoc.org/google.golang.org/genproto/googleapis/iam/admin/v1) \u3002\n\u5982\u9700\u5411 IAM \u9032\u884c\u8eab\u4efd\u9a57\u8b49\uff0c\u8acb\u8a2d\u7f6e\u61c9\u7528\u9ed8\u8a8d\u6191\u64da\u3002  \u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [\u6e96\u5099\u5de5\u4f5c](#before-you-begin) \u3002\n [\u5728 GitHub \u4e0a\u67e5\u770b](https://github.com/GoogleCloudPlatform/golang-samples/blob/HEAD/iam/snippets/roles_get.go) \n```\nimport (\u00a0 \u00a0 \u00a0 \u00a0 \"context\"\u00a0 \u00a0 \u00a0 \u00a0 \"fmt\"\u00a0 \u00a0 \u00a0 \u00a0 \"io\"\u00a0 \u00a0 \u00a0 \u00a0 iam \"google.golang.org/api/iam/v1\")// getRole gets role metadata.func getRole(w io.Writer, name string) (*iam.Role, error) {\u00a0 \u00a0 \u00a0 \u00a0 ctx := context.Background()\u00a0 \u00a0 \u00a0 \u00a0 service, err := iam.NewService(ctx)\u00a0 \u00a0 \u00a0 \u00a0 if err != nil {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 return nil, fmt.Errorf(\"iam.NewService: %w\", err)\u00a0 \u00a0 \u00a0 \u00a0 }\u00a0 \u00a0 \u00a0 \u00a0 role, err := service.Roles.Get(name).Do()\u00a0 \u00a0 \u00a0 \u00a0 if err != nil {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 return nil, fmt.Errorf(\"Roles.Get: %w\", err)\u00a0 \u00a0 \u00a0 \u00a0 }\u00a0 \u00a0 \u00a0 \u00a0 fmt.Fprintf(w, \"Got role: %v\\n\", role.Name)\u00a0 \u00a0 \u00a0 \u00a0 for _, permission := range role.IncludedPermissions {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 fmt.Fprintf(w, \"Got permission: %v\\n\", permission)\u00a0 \u00a0 \u00a0 \u00a0 }\u00a0 \u00a0 \u00a0 \u00a0 return role, nil}\n```\u5982\u9700\u77ad\u89e3\u5982\u4f55\u5b89\u88dd\u548c\u4f7f\u7528 IAM \u5ba2\u6236\u7aef\u5eab\uff0c\u8acb\u53c3\u95b1 [IAM \u5ba2\u6236\u7aef\u5eab](https://cloud.google.com/iam/docs/reference/libraries?hl=zh-cn) \u3002\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [IAM Java API \u53c3\u8003\u6587\u6a94](https://developers.google.com/api-client-library/java/apis/iam/v1?hl=zh-cn) \u3002\n\u5982\u9700\u5411 IAM \u9032\u884c\u8eab\u4efd\u9a57\u8b49\uff0c\u8acb\u8a2d\u7f6e\u61c9\u7528\u9ed8\u8a8d\u6191\u64da\u3002  \u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [\u6e96\u5099\u5de5\u4f5c](#before-you-begin) \u3002\n [\u5728 GitHub \u4e0a\u67e5\u770b](https://github.com/GoogleCloudPlatform/java-docs-samples/blob/HEAD/iam/snippets/src/main/java/GetRole.java) \n```\nimport com.google.cloud.iam.admin.v1.IAMClient;import com.google.iam.admin.v1.GetRoleRequest;import com.google.iam.admin.v1.Role;import java.io.IOException;/** Get role metadata. Specifically, printing out role permissions. */public class GetRole {\u00a0 public static void main(String[] args) throws IOException {\u00a0 \u00a0 // TODO(developer): Replace the variable before running the sample.\u00a0 \u00a0 String roleId = \"a unique identifier (e.g. testViewer)\";\u00a0 \u00a0 getRole(roleId);\u00a0 }\u00a0 public static void getRole(String roleId) throws IOException {\u00a0 \u00a0 GetRoleRequest getRoleRequest = GetRoleRequest.newBuilder().setName(roleId).build();\u00a0 \u00a0 // Initialize client for sending requests. This client only needs to be created\u00a0 \u00a0 // once, and can be reused for multiple requests.\u00a0 \u00a0 try (IAMClient iamClient = IAMClient.create()) {\u00a0 \u00a0 \u00a0 Role role = iamClient.getRole(getRoleRequest);\u00a0 \u00a0 \u00a0 role.getIncludedPermissionsList().forEach(permission -> System.out.println(permission));\u00a0 \u00a0 }\u00a0 }}\n```\u5982\u9700\u77ad\u89e3\u5982\u4f55\u5b89\u88dd\u548c\u4f7f\u7528 IAM \u5ba2\u6236\u7aef\u5eab\uff0c\u8acb\u53c3\u95b1 [IAM \u5ba2\u6236\u7aef\u5eab](https://cloud.google.com/iam/docs/reference/libraries?hl=zh-cn) \u3002\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [IAM Python API \u53c3\u8003\u6587\u6a94](https://developers.google.com/api-client-library/python/apis/iam/v1?hl=zh-cn) \u3002\n\u5982\u9700\u5411 IAM \u9032\u884c\u8eab\u4efd\u9a57\u8b49\uff0c\u8acb\u8a2d\u7f6e\u61c9\u7528\u9ed8\u8a8d\u6191\u64da\u3002  \u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [\u6e96\u5099\u5de5\u4f5c](#before-you-begin) \u3002\n [\u5728 GitHub \u4e0a\u67e5\u770b](https://github.com/GoogleCloudPlatform/python-docs-samples/blob/HEAD/iam/api-client/custom_roles.py) \n```\ndef get_role(name: str) -> None:\u00a0 \u00a0 \"\"\"Gets a role.\"\"\"\u00a0 \u00a0 # pylint: disable=no-member\u00a0 \u00a0 role = service.roles().get(name=name).execute()\u00a0 \u00a0 print(role[\"name\"])\u00a0 \u00a0 for permission in role[\"includedPermissions\"]:\u00a0 \u00a0 \u00a0 \u00a0 print(permission)\n``` ` [roles.get](https://cloud.google.com/iam/docs/reference/rest/v1/projects.roles/get?hl=zh-cn) ` \u65b9\u6cd5\u53ef\u7372\u53d6\u89d2\u8272\u7684\u5b9a\u7fa9\u3002\n\u5728\u4f7f\u7528\u4efb\u4f55\u8acb\u6c42\u6578\u64da\u4e4b\u524d\uff0c\u8acb\u5148\u9032\u884c\u4ee5\u4e0b\u66ff\u63db\uff1a- ``\uff1a\u5b8c\u6574\u7684\u89d2\u8272\u540d\u7a31\uff0c\u5305\u62ec\u4efb\u4f55`organizations/`\u3001`projects/`\u6216`roles/`\u524d\u7db4\u3002\u4f8b\u5982`organizations/123456789012/roles/myCompanyAdmin`\u3002\nHTTP \u65b9\u6cd5\u548c\u7db2\u5740\uff1a\n```\nGET https://iam.googleapis.com/v1/ROLE_NAME\n```\n\u5982\u9700\u767c\u9001\u60a8\u7684\u8acb\u6c42\uff0c\u8acb\u5c55\u958b\u4ee5\u4e0b\u9078\u9805\u4e4b\u4e00\uff1a\n\u97ff\u61c9\u4e2d\u5305\u542b\u89d2\u8272\u5b9a\u7fa9\u3002\n```\n{\n \"name\": \"projects/my-project/roles/customRole\",\n \"title\": \"My Custom Role\",\n \"description\": \"My custom role description.\",\n \"includedPermissions\": [ \"storage.buckets.get\",\n \"storage.buckets.list\"\n ],\n \"etag\": \"BwWiPg2fmDE=\"\n}\n```\n## \u5275\u5efa\u81ea\u5b9a\u7fa9\u89d2\u8272\n\u60a8\u53ef\u4ee5\u5728\u9805\u76ee\u6216\u7d44\u7e54\u7d1a\u5c64\u5275\u5efa\u81ea\u5b9a\u7fa9\u89d2\u8272\u3002\n**\u6ce8\u610f** \uff1a\u60a8\u4e0d\u80fd\u5728\u6587\u4ef6\u593e\u7d1a\u5c64\u5b9a\u7fa9\u81ea\u5b9a\u7fa9\u89d2\u8272\u3002\u5982\u679c\u60a8\u9700\u8981\u5728\u6587\u4ef6\u593e\u4e2d\u4f7f\u7528\u81ea\u5b9a\u7fa9\u89d2\u8272\uff0c\u8acb\u5728\u7d44\u7e54\u7d1a\u5c64\u5b9a\u7fa9\u81ea\u5b9a\u7fa9\u89d2\u8272\u3002\n\u7d44\u7e54\u7d1a\u5c64\u81ea\u5b9a\u7fa9\u89d2\u8272\u53ef\u4ee5\u5305\u542b [\u81ea\u5b9a\u7fa9\u89d2\u8272\u652f\u6301](https://cloud.google.com/iam/docs/custom-roles-permissions-support?hl=zh-cn) \u7684\u4efb\u4f55 IAM \u6b0a\u9650\u3002\u9805\u76ee\u7d1a\u5c64\u81ea\u5b9a\u7fa9\u89d2\u8272\u53ef\u4ee5\u5305\u542b\u4efb\u4f55\u53d7\u652f\u6301\u7684\u6b0a\u9650\uff0c\u4f46 \u53ea\u80fd\u5728\u7d44\u7e54\u6216\u6587\u4ef6\u593e\u7d1a\u5c64\u4f7f\u7528\u7684\u6b0a\u9650\u9664\u5916\uff0c\u4f8b\u5982 `resourcemanager.organizations.get` \u3002\u5982\u679c\u60a8\u5617\u8a66\u5c07\u9019\u985e\u6b0a\u9650\u6dfb\u52a0\u5230\u9805\u76ee\u7d1a\u5c64\u81ea\u5b9a\u7fa9\u89d2\u8272\uff0c\u5247\u6703\u6536\u5230\u932f\u8aa4\u6d88\u606f\uff1a\n\u7cfb\u7d71\u6703\u986f\u793a\u4ee5\u4e0b\u8b66\u544a\u6d88\u606f\uff1a\u201c\u4e0d\u9069\u7528\u65bc\u9805\u76ee\u7d1a\u5c64\u81ea\u5b9a\u7fa9\u89d2\u8272\u201d\u3002\u7cfb\u7d71\u6703\u5f9e\u5df2\u5305\u542b\u6b0a\u9650\u5217\u8868\u4e2d\u81ea\u52d5\u53d6\u6d88\u9078\u64c7\u8a72\u6b0a\u9650\uff0c\u60a8\u53ef\u4ee5\u7e7c\u7e8c\u5275\u5efa\u6b64\u89d2\u8272\u3002\n\u7cfb\u7d71\u6703\u8fd4\u56de\u4ee5\u4e0b\u932f\u8aa4\u6d88\u606f\uff1a `INVALID_ARGUMENT: Permission` `` `is not valid` \u3002\u9664\u975e\u60a8\u5148\u5f9e\u89d2\u8272\u5b9a\u7fa9\u4e2d\u79fb\u9664\u8a72\u6b0a\u9650\u4e26\u91cd\u8a66\u6b64\u64cd\u4f5c\uff0c\u5426\u5247\u7cfb\u7d71\u5c07\u4e0d\u6703\u5275\u5efa\u8a72\u81ea\u5b9a\u7fa9\u89d2\u8272\u3002\n\u7cfb\u7d71\u6703\u8fd4\u56de\u4ee5\u4e0b\u932f\u8aa4\u6d88\u606f\uff1a `Permission` `` `is not valid` \uff0c\u4ee5\u53ca HTTP 400 \u932f\u8aa4\u4ee3\u78bc\u548c `INVALID_ARGUMENT` \u72c0\u614b\u3002\u9664\u975e\u60a8\u5148\u5f9e\u89d2\u8272\u5b9a\u7fa9\u4e2d\u79fb\u9664\u8a72\u6b0a\u9650\u4e26\u91cd\u8a66\u6b64\u64cd\u4f5c\uff0c\u5426\u5247\u7cfb\u7d71\u5c07\u4e0d\u6703\u5275\u5efa\u8a72\u81ea\u5b9a\u7fa9\u89d2\u8272\u3002\n\u6bcf\u500b\u81ea\u5b9a\u7fa9\u89d2\u8272\u6700\u591a\u53ef\u4ee5\u5305\u542b 3000 \u500b\u6b0a\u9650\u3002\u6b64\u5916\uff0c\u81ea\u5b9a\u7fa9\u89d2\u8272\u7684\u540d\u7a31\u3001\u63cf\u8ff0\u548c\u6b0a\u9650\u540d\u7a31\u7684\u7e3d\u5927\u5c0f\u4e0d\u5f97\u8d85\u904e 64 KB\u3002\u5982\u679c\u60a8\u9700\u8981\u5275\u5efa\u66f4\u5927\u7684\u81ea\u5b9a\u7fa9\u89d2\u8272\uff0c\u53ef\u4ee5\u5c07\u6b0a\u9650\u62c6\u5206\u7d66\u591a\u500b\u81ea\u5b9a\u7fa9\u89d2\u8272\u3002\u8acb\u9078\u64c7\u53ef\u986f\u793a\u81ea\u5b9a\u7fa9\u89d2\u8272\u4e4b\u9593\u95dc\u4fc2\u7684\u89d2\u8272\u540d\u7a31\uff0c\u4f8b\u5982 `Custom Admin (1 of 2)` \u548c `Custom Admin (2 of 2)` \u3002\n\u6bcf\u500b\u81ea\u5b9a\u7fa9\u89d2\u8272\u90fd\u53ef\u4ee5\u5177\u6709\u767c\u4f48\u968e\u6bb5\u3002\u5927\u90e8\u5206\u767c\u5e03\u968e\u6bb5\u90fd\u662f\u53c3\u8003\u4fe1\u606f\uff0c\u53ef\u5e6b\u52a9\u60a8\u8ddf\u8e64\u6bcf\u500b\u89d2\u8272\u662f\u5426\u5df2\u6e96\u5099\u597d\u6295\u5165\u5ee3\u6cdb\u4f7f\u7528\u3002\u6b64\u5916\uff0c\u60a8\u9084\u53ef\u4ee5\u85c9\u52a9 `DISABLED` \u767c\u4f48\u968e\u6bb5 [\u505c\u7528\u81ea\u5b9a\u7fa9\u89d2\u8272](#disabling-custom-role) \u3002\u5982\u9700\u8a73\u7d30\u77ad\u89e3\u767c\u4f48\u968e\u6bb5\uff0c\u8acb\u53c3\u95b1 [\u6e2c\u8a66\u548c\u90e8\u7f72](https://cloud.google.com/iam/docs/roles-overview?hl=zh-cn#custom-role-testing-deploying) \u3002\n\u4e00\u4e9b\u9810\u5b9a\u7fa9\u89d2\u8272\u5305\u542b\u5df2\u68c4\u7528\u7684\u6b0a\u9650\u6216\u4e0d\u5141\u8a31\u5728\u81ea\u5b9a\u7fa9\u89d2\u8272\u4e2d\u4f7f\u7528\u7684\u6b0a\u9650\u3002\u5982\u679c\u60a8\u5617\u8a66\u57fa\u65bc\u5176\u4e2d\u4e00\u500b\u9810\u5b9a\u7fa9\u89d2\u8272\u5275\u5efa\u81ea\u5b9a\u7fa9\u89d2\u8272\uff0c\u5247\u81ea\u5b9a\u7fa9\u89d2\u8272\u5c07\u5ffd\u7565\u5df2\u68c4\u7528\u7684\u6b0a\u9650\u548c\u53d7\u9650\u7684\u6b0a\u9650\u3002\n\u8981\u5f9e\u982d\u958b\u59cb\u5275\u5efa\u65b0\u81ea\u5b9a\u7fa9\u89d2\u8272\uff0c\u8acb\u57f7\u884c\u4ee5\u4e0b\u64cd\u4f5c\uff1a- \u5728 Google Cloud \u63a7\u5236\u6aaf\u4e2d\uff0c\u8f49\u5230 **\u89d2\u8272** \u9801\u9762\u3002 [\u8f49\u5230\u201c\u89d2\u8272\u201d\u9801\u9762](https://console.cloud.google.com/iam-admin/roles?hl=zh-cn) \n- \u5728\u9801\u9762\u9802\u90e8\u7684\u4e0b\u62c9\u5217\u8868\u4e2d\uff0c\u9078\u64c7\u8981\u5728\u54ea\u500b\u7d44\u7e54\u6216\u9805\u76ee\u4e2d\u5275\u5efa\u89d2\u8272\u3002\n- \u9ede\u64ca **\u5275\u5efa\u89d2\u8272** \u3002\n- \u8f38\u5165\u89d2\u8272\u7684 **\u540d\u7a31** \u3001 **\u6a19\u984c** \u3001 **\u8aaa\u660e** \u548c **\u89d2\u8272\u767c\u4f48\u968e\u6bb5** \u3002\u89d2\u8272\u5275\u5efa\u5f8c\uff0c\u89d2\u8272\u540d\u7a31\u4fbf\u7121\u6cd5\u66f4\u6539\u3002\n- \u9ede\u64ca **\u6dfb\u52a0\u6b0a\u9650** \u3002\n- \u9078\u64c7\u8981\u5305\u542b\u5728\u89d2\u8272\u4e2d\u7684\u6b0a\u9650\uff0c\u7136\u5f8c\u9ede\u64ca **\u6dfb\u52a0\u6b0a\u9650** \u3002\u53ef\u4f7f\u7528 **\u6240\u6709\u670d\u52d9** \u548c **\u6240\u6709\u985e\u578b** \u4e0b\u62c9\u5217\u8868\uff0c\u6309\u670d\u52d9\u548c\u985e\u578b\u904e\u6ffe\u6b0a\u9650\u4e26\u9078\u64c7\u6b0a\u9650\u3002\n\u57fa\u65bc\u73fe\u6709\u9810\u5b9a\u7fa9\u89d2\u8272\u5275\u5efa\u81ea\u5b9a\u7fa9\u89d2\u8272\uff1a- \u5728 Google Cloud \u63a7\u5236\u6aaf\u4e2d\uff0c\u8f49\u5230 **\u89d2\u8272** \u9801\u9762\u3002 [\u8f49\u5230\u201c\u89d2\u8272\u201d\u9801\u9762](https://console.cloud.google.com/iam-admin/roles?hl=zh-cn) \n- \u9078\u64c7\u8981\u5728\u54ea\u500b\u7d44\u7e54\u6216\u9805\u76ee\u4e2d\u5275\u5efa\u89d2\u8272\u3002\n- \u9078\u64c7\u5275\u5efa\u65b0\u81ea\u5b9a\u7fa9\u89d2\u8272\u6642\u8981\u4f9d\u64da\u7684\u57fa\u6e96\u89d2\u8272\u3002\n- \u9ede\u64ca **\u57fa\u65bc\u6240\u9078\u89d2\u8272\u5275\u5efa\u89d2\u8272** \u3002\n- \u8f38\u5165\u89d2\u8272\u7684 **\u540d\u7a31** \u3001 **\u6a19\u984c** \u3001 **\u8aaa\u660e** \u548c **\u89d2\u8272\u767c\u4f48\u968e\u6bb5** \u3002\u89d2\u8272\u5275\u5efa\u5f8c\uff0c\u89d2\u8272\u540d\u7a31\u4fbf\u7121\u6cd5\u66f4\u6539\u3002\n- \u53d6\u6d88\u9078\u4e2d\u8981\u5f9e\u89d2\u8272\u4e2d\u6392\u9664\u7684\u6b0a\u9650\u3002\n- \u9ede\u64ca **\u6dfb\u52a0\u6b0a\u9650** \u4ee5\u5305\u542b\u4efb\u4f55\u6b0a\u9650\u3002\n- \u9ede\u64ca **\u5275\u5efa** \u3002\n- Titles in dynamic includes are not used anywhere, and we should avoid paying to translate them\u5728 Google Cloud \u63a7\u5236\u6aaf\u4e2d\uff0c\u6fc0\u6d3b Cloud Shell\u3002 [\u6fc0\u6d3b Cloud Shell](https://console.cloud.google.com/?cloudshell=true&hl=zh-cn)  [Cloud Shell](https://cloud.google.com/shell/docs/how-cloud-shell-works?hl=zh-cn) \u6703\u8a71\u96a8\u5373\u6703\u5728 Google Cloud \u63a7\u5236\u6aaf\u7684\u5e95\u90e8\u5553\u52d5\uff0c\u4e26\u986f\u793a\u547d\u4ee4\u884c\u63d0\u793a\u7b26\u3002Cloud Shell \u662f\u4e00\u500b\u5df2\u5b89\u88dd Google Cloud CLI \u4e14\u5df2\u7232\u7576\u524d\u9805\u76ee\u8a2d\u7f6e\u503c\u7684 Shell \u74b0\u5883\u3002\u8a72\u6703\u8a71\u53ef\u80fd\u9700\u8981\u5e7e\u79d2\u9418\u6642\u9593\u4f86\u5b8c\u6210\u521d\u59cb\u5316\u3002\n- \u4f7f\u7528 ` [gcloud iam roles create](https://cloud.google.com/sdk/gcloud/reference/iam/roles/create?hl=zh-cn) ` \u547d\u4ee4\u5275\u5efa\u65b0\u7684\u81ea\u5b9a\u7fa9\u89d2\u8272\u3002\u60a8\u53ef\u4ee5\u901a\u904e\u4ee5\u4e0b\u5169\u7a2e\u65b9\u5f0f\u4f7f\u7528\u6b64\u547d\u4ee4\uff1a- \u63d0\u4f9b\u5305\u542b\u89d2\u8272\u5b9a\u7fa9\u7684 YAML \u6587\u4ef6\n- \u4f7f\u7528\u6a19\u8a8c\u6307\u5b9a\u89d2\u8272\u5b9a\u7fa9\n\u5275\u5efa\u81ea\u5b9a\u7fa9\u89d2\u8272\u6642\uff0c\u60a8\u5fc5\u9808\u4f7f\u7528 `--organization=` `` \u6216 `--project=` `` \u6a19\u8a8c\u6307\u5b9a\u8a72\u89d2\u8272\u662f\u61c9\u7528\u65bc\u7d44\u7e54\u7d1a\u5c64\u9084\u662f\u9805\u76ee\u7d1a\u5c64\u3002  \u4ee5\u4e0b\u5404\u793a\u4f8b\u90fd\u662f\u5728\u9805\u76ee\u7d1a\u5c64\u5275\u5efa\u81ea\u5b9a\u7fa9\u89d2\u8272\u3002\u81ea\u5b9a\u7fa9\u89d2\u8272\u53ea\u80fd\u5177\u6709 [\u81ea\u5b9a\u7fa9\u89d2\u8272\u652f\u6301\u7684\u6b0a\u9650](https://cloud.google.com/iam/docs/custom-roles-permissions-support?hl=zh-cn) \u3002\u5982\u679c\u81ea\u5b9a\u7fa9\u89d2\u8272\u5177\u6709\u5176\u4ed6\u6b0a\u9650\uff0c\u5247\u8a72\u547d\u4ee4\u5c07\u5931\u6557\u3002 **\u8981\u4f7f\u7528 YAML \u6587\u4ef6\u5275\u5efa\u81ea\u5b9a\u7fa9\u89d2\u8272\uff0c\u8acb\u57f7\u884c\u4ee5\u4e0b\u64cd\u4f5c\uff1a** \u5275\u5efa\u4e00\u500b\u5305\u542b\u60a8\u81ea\u5b9a\u7fa9\u89d2\u8272\u5b9a\u7fa9\u7684 YAML \u6587\u4ef6\u3002\u8a72\u6587\u4ef6\u5fc5\u9808\u63a1\u7528\u4ee5\u4e0b\u7d50\u69cb\uff1a```\ntitle: ROLE_TITLEdescription: ROLE_DESCRIPTIONstage: LAUNCH_STAGEincludedPermissions:- PERMISSION_1- PERMISSION_2\n```\u6bcf\u500b\u4f54\u4f4d\u503c\u7684\u8aaa\u660e\u5982\u4e0b\uff1a- `` \u662f\u89d2\u8272\u7684\u6613\u8a18\u6a19\u984c\uff0c\u4f8b\u5982 `\"My Company Admin\"` \u3002\n- `` \u662f\u89d2\u8272\u7684\u7c21\u77ed\u8aaa\u660e\uff0c\u4f8b\u5982 `\"My custom role description\"` \u3002\n- `` \u8868\u793a\u89d2\u8272\u5728\u767c\u4f48\u751f\u547d\u9031\u671f\u4e2d\u6240\u8655\u7684\u968e\u6bb5\uff0c\u4f8b\u5982 `ALPHA` \u3001 `BETA` \u6216 `GA` \u3002\n- `` \u548c `` \u662f\u8981\u5305\u542b\u5728\u81ea\u5b9a\u7fa9\u89d2\u8272\u4e2d\u7684\u6b0a\u9650\uff0c\u4f8b\u5982 `iam.roles.get` \u3002 \u60a8\u4e0d\u80fd\u5728\u6b0a\u9650\u540d\u7a31\u4e2d\u4f7f\u7528\u901a\u914d\u7b26 ( `*` )\u3002\n\u4fdd\u5b58 YAML \u6587\u4ef6\uff0c\u7136\u5f8c\u57f7\u884c\u4ee5\u4e0b\u547d\u4ee4\u4e4b\u4e00\uff1a- \u8981\u5728\u7d44\u7e54\u7d1a\u5c64\u5275\u5efa\u81ea\u5b9a\u7fa9\u89d2\u8272\uff0c\u8acb\u57f7\u884c\u4ee5\u4e0b\u547d\u4ee4\uff1a```\ngcloud iam roles create ROLE_ID--organization=ORGANIZATION_ID \\\n --file=YAML_FILE_PATH\n```\n- \u8981\u5728\u9805\u76ee\u7d1a\u5c64\u5275\u5efa\u81ea\u5b9a\u7fa9\u89d2\u8272\uff0c\u8acb\u57f7\u884c\u4ee5\u4e0b\u547d\u4ee4\uff1a```\ngcloud iam roles create ROLE_ID --project=PROJECT_ID \\\n --file=YAML_FILE_PATH\n```\n\u6bcf\u500b\u4f54\u4f4d\u503c\u7684\u8aaa\u660e\u5982\u4e0b\uff1a- `` \u662f\u89d2\u8272\u7684\u540d\u7a31\uff0c\u4f8b\u5982 `myCompanyAdmin` \u3002\n- `` \u662f\u7d44\u7e54\u7684\u6578\u5b57 ID\uff0c\u4f8b\u5982 `123456789012` \u3002\n- `` \u662f\u9805\u76ee\u7684\u540d\u7a31\uff0c\u4f8b\u5982 `my-project` \u3002\n- `` \u662f\u5305\u542b\u81ea\u5b9a\u7fa9\u89d2\u8272\u5b9a\u7fa9\u7684 YAML \u6587\u4ef6\u7684\u4f4d\u7f6e\u8def\u5f91\u3002\n **\u793a\u4f8b** \u4ee5\u4e0b\u793a\u4f8b YAML \u6587\u4ef6\u6f14\u793a\u77ad\u5982\u4f55\u5275\u5efa\u89d2\u8272\u5b9a\u7fa9\uff1a```\ntitle: \"My Company Admin\"description: \"My custom role description.\"stage: \"ALPHA\"includedPermissions:- iam.roles.get- iam.roles.list\n```\u4ee5\u4e0b\u793a\u4f8b\u6f14\u793a\u77ad\u5982\u4f55\u4f7f\u7528 YAML \u6587\u4ef6\u5728\u7d44\u7e54\u7d1a\u5c64\u5275\u5efa\u89d2\u8272\uff1a```\ngcloud iam roles create myCompanyAdmin --organization=123456789012 \\\n --file=my-role-definition.yaml\n```\u5982\u679c\u6210\u529f\u5275\u5efa\u4e86\u89d2\u8272\uff0c\u5247\u8a72\u547d\u4ee4\u7684\u8f38\u51fa\u985e\u4f3c\u65bc\u4ee5\u4e0b\u5167\u5bb9\uff1a```\nCreated role [myCompanyAdmin].description: My custom role description.etag: BwVkBX0sQD0=includedPermissions:- iam.roles.get- iam.roles.listname: organizations/123456789012/roles/myCompanyAdminstage: ALPHAtitle: My Company Admin\n```\u4ee5\u4e0b\u793a\u4f8b\u6f14\u793a\u77ad\u5982\u4f55\u4f7f\u7528 YAML \u6587\u4ef6\u5728\u9805\u76ee\u7d1a\u5c64\u5275\u5efa\u89d2\u8272\uff1a```\ngcloud iam roles create myCompanyAdmin --project=my-project \\\n --file=my-role-definition.yaml\n```\u5982\u679c\u6210\u529f\u5275\u5efa\u4e86\u89d2\u8272\uff0c\u5247\u8a72\u547d\u4ee4\u7684\u8f38\u51fa\u985e\u4f3c\u65bc\u4ee5\u4e0b\u5167\u5bb9\uff1a```\nCreated role [myCompanyAdmin].description: My custom role description.etag: BwVkBX0sQD0=includedPermissions:- iam.roles.get- iam.roles.listname: projects/my-project/roles/myCompanyAdminstage: ALPHAtitle: My Company Admin\n``` **\u5982\u9700\u4f7f\u7528\u6a19\u8a8c\u5275\u5efa\u81ea\u5b9a\u7fa9\u89d2\u8272\uff0c\u8acb\u57f7\u884c\u4ee5\u4e0b\u64cd\u4f5c\uff1a** \u57f7\u884c\u4ee5\u4e0b\u547d\u4ee4\u4e4b\u4e00\uff1a- \u8981\u5728\u7d44\u7e54\u7d1a\u5c64\u5275\u5efa\u81ea\u5b9a\u7fa9\u89d2\u8272\uff0c\u8acb\u57f7\u884c\u4ee5\u4e0b\u547d\u4ee4\uff1a```\ngcloud iam roles create ROLE_ID--organization=ORGANIZATION_ID \\\n --title=ROLE_TITLE --description=ROLE_DESCRIPTION \\\n --permissions=\"PERMISSIONS_LIST\" --stage=LAUNCH_STAGE\n```\n- \u8981\u5728\u9805\u76ee\u7d1a\u5c64\u5275\u5efa\u81ea\u5b9a\u7fa9\u89d2\u8272\uff0c\u8acb\u57f7\u884c\u4ee5\u4e0b\u547d\u4ee4\uff1a```\ngcloud iam roles create ROLE_ID --project=PROJECT_ID \\\n --title=ROLE_TITLE --description=ROLE_DESCRIPTION \\\n --permissions=\"PERMISSIONS_LIST\" --stage=LAUNCH_STAGE\n```\n\u6bcf\u500b\u4f54\u4f4d\u503c\u7684\u8aaa\u660e\u5982\u4e0b\uff1a- `` \u662f\u89d2\u8272\u7684\u540d\u7a31\uff0c\u4f8b\u5982 `myCompanyAdmin` \u3002\n- `` \u662f\u7d44\u7e54\u7684\u6578\u5b57 ID\uff0c\u4f8b\u5982 `123456789012` \u3002\n- `` \u662f\u9805\u76ee\u7684\u540d\u7a31\uff0c\u4f8b\u5982 `my-project` \u3002\n- `` \u662f\u89d2\u8272\u7684\u6613\u8a18\u6a19\u984c\uff0c\u4f8b\u5982 `\"My Company Admin\"` \u3002\n- `` \u662f\u89d2\u8272\u7684\u7c21\u77ed\u8aaa\u660e\uff0c\u4f8b\u5982 `\"My custom role description.\"` \u3002\n- `` \u5305\u542b\u8981\u7d0d\u5165\u81ea\u5b9a\u7fa9\u89d2\u8272\u7684\u6b0a\u9650\u7684\u82f1\u6587\u9017\u865f\u5206\u9694\u5217\u8868\u3002\u4f8b\u5982\uff1a `iam.roles.get,iam.roles.list` \u3002\u60a8\u4e0d\u80fd\u5728\u6b0a\u9650\u540d\u7a31\u4e2d\u4f7f\u7528\u901a\u914d\u7b26 ( `*` )\u3002\n- `` \u8868\u793a\u89d2\u8272\u5728\u767c\u4f48\u751f\u547d\u9031\u671f\u4e2d\u6240\u8655\u7684\u968e\u6bb5\uff0c\u4f8b\u5982 `ALPHA` \u3001 `BETA` \u6216 `GA` \u3002\n **\u793a\u4f8b** \u4ee5\u4e0b\u793a\u4f8b\u6f14\u793a\u77ad\u5982\u4f55\u4f7f\u7528\u6a19\u8a8c\u5728\u7d44\u7e54\u7d1a\u5c64\u5275\u5efa\u89d2\u8272\uff1a```\ngcloud iam roles create myCompanyAdmin --organization=123456789012 \\\n --title=\"My Company Admin\" --description=\"My custom role description.\" \\\n --permissions=\"iam.roles.get,iam.roles.list\" --stage=ALPHA\n```\u5982\u679c\u6210\u529f\u5275\u5efa\u4e86\u89d2\u8272\uff0c\u5247\u8a72\u547d\u4ee4\u7684\u8f38\u51fa\u985e\u4f3c\u65bc\u4ee5\u4e0b\u5167\u5bb9\uff1a```\nCreated role [myCompanyAdmin].description: My custom role description.etag: BwVkBX0sQD0=includedPermissions:- iam.roles.get- iam.roles.listname: organizations/123456789012/roles/myCompanyAdminstage: ALPHAtitle: My Company Admin\n```\u4ee5\u4e0b\u793a\u4f8b\u6f14\u793a\u77ad\u5982\u4f55\u4f7f\u7528\u6a19\u8a8c\u5728\u9805\u76ee\u7d1a\u5c64\u5275\u5efa\u89d2\u8272\uff1a```\ngcloud iam roles create myCompanyAdmin --project=my-project \\\n --title=\"My Company Admin\" --description=\"My custom role description.\" \\\n --permissions=\"iam.roles.get,iam.roles.list\" --stage=ALPHA\n```\u5982\u679c\u6210\u529f\u5275\u5efa\u4e86\u89d2\u8272\uff0c\u5247\u8a72\u547d\u4ee4\u7684\u8f38\u51fa\u985e\u4f3c\u65bc\u4ee5\u4e0b\u5167\u5bb9\uff1a```\nCreated role [myCompanyAdmin].description: My custom role description.etag: BwVkBX0sQD0=includedPermissions:- iam.roles.get- iam.roles.listname: projects/my-project/roles/myCompanyAdminstage: ALPHAtitle: My Company Admin\n```\n\u5982\u9700\u77ad\u89e3\u5982\u4f55\u5b89\u88dd\u548c\u4f7f\u7528 IAM \u5ba2\u6236\u7aef\u5eab\uff0c\u8acb\u53c3\u95b1 [IAM \u5ba2\u6236\u7aef\u5eab](https://cloud.google.com/iam/docs/reference/libraries?hl=zh-cn) \u3002\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [IAM C++ API \u53c3\u8003\u6587\u6a94](https://cloud.google.com/cpp/docs/reference/iam/latest?hl=zh-cn) \u3002\n\u5982\u9700\u5411 IAM \u9032\u884c\u8eab\u4efd\u9a57\u8b49\uff0c\u8acb\u8a2d\u7f6e\u61c9\u7528\u9ed8\u8a8d\u6191\u64da\u3002  \u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [\u6e96\u5099\u5de5\u4f5c](#before-you-begin) \u3002\n [\u5728 GitHub \u4e0a\u67e5\u770b](https://github.com/googleapis/google-cloud-cpp/blob/HEAD/google/cloud/iam/samples/iam_samples.cc) \n```\nnamespace iam = ::google::cloud::iam_admin_v1;[](std::string const& parent, std::string const& role_id,\u00a0 \u00a0std::vector<std::string> const& included_permissions) {\u00a0 iam::IAMClient client(iam::MakeIAMConnection());\u00a0 google::iam::admin::v1::CreateRoleRequest request;\u00a0 request.set_parent(\"projects/\" + parent);\u00a0 request.set_role_id(role_id);\u00a0 google::iam::admin::v1::Role role;\u00a0 role.set_stage(google::iam::admin::v1::Role::GA);\u00a0 for (auto const& permission : included_permissions) {\u00a0 \u00a0 *role.add_included_permissions() = permission;\u00a0 }\u00a0 *request.mutable_role() = role;\u00a0 auto response = client.CreateRole(request);\u00a0 if (!response) throw std::move(response).status();\u00a0 std::cout << \"Role successfully created: \" << response->DebugString()\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 << \"\\n\";}\n```\u5982\u9700\u77ad\u89e3\u5982\u4f55\u5b89\u88dd\u548c\u4f7f\u7528 IAM \u5ba2\u6236\u7aef\u5eab\uff0c\u8acb\u53c3\u95b1 [IAM \u5ba2\u6236\u7aef\u5eab](https://cloud.google.com/iam/docs/reference/libraries?hl=zh-cn) \u3002\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [IAM C# API \u53c3\u8003\u6587\u6a94](https://developers.google.com/api-client-library/dotnet/apis/iam/v1?hl=zh-cn) \u3002\n\u5982\u9700\u5411 IAM \u9032\u884c\u8eab\u4efd\u9a57\u8b49\uff0c\u8acb\u8a2d\u7f6e\u61c9\u7528\u9ed8\u8a8d\u6191\u64da\u3002  \u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [\u6e96\u5099\u5de5\u4f5c](#before-you-begin) \u3002\n [\u5728 GitHub \u4e0a\u67e5\u770b](https://github.com/GoogleCloudPlatform/dotnet-docs-samples/blob/HEAD/iam/api/CustomRoles/RolesCreate.cs) \n```\nusing System;using System.Collections.Generic;using Google.Apis.Auth.OAuth2;using Google.Apis.Iam.v1;using Google.Apis.Iam.v1.Data;public partial class CustomRoles{\u00a0 \u00a0 public static Role CreateRole(string name, string projectId, string title,\u00a0 \u00a0 \u00a0 \u00a0 string description, IList<string> permissions, string stage)\u00a0 \u00a0 {\u00a0 \u00a0 \u00a0 \u00a0 var credential = GoogleCredential.GetApplicationDefault()\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 .CreateScoped(IamService.Scope.CloudPlatform);\u00a0 \u00a0 \u00a0 \u00a0 var service = new IamService(new IamService.Initializer\u00a0 \u00a0 \u00a0 \u00a0 {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 HttpClientInitializer = credential\u00a0 \u00a0 \u00a0 \u00a0 });\u00a0 \u00a0 \u00a0 \u00a0 var role = new Role\u00a0 \u00a0 \u00a0 \u00a0 {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 Title = title,\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 Description = description,\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 IncludedPermissions = permissions,\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 Stage = stage\u00a0 \u00a0 \u00a0 \u00a0 };\u00a0 \u00a0 \u00a0 \u00a0 var request = new CreateRoleRequest\u00a0 \u00a0 \u00a0 \u00a0 {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 Role = role,\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 RoleId = name\u00a0 \u00a0 \u00a0 \u00a0 };\u00a0 \u00a0 \u00a0 \u00a0 role = service.Projects.Roles.Create(request,\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"projects/\" + projectId).Execute();\u00a0 \u00a0 \u00a0 \u00a0 Console.WriteLine(\"Created role: \" + role.Name);\u00a0 \u00a0 \u00a0 \u00a0 return role;\u00a0 \u00a0 }}\n```\u5982\u9700\u77ad\u89e3\u5982\u4f55\u5b89\u88dd\u548c\u4f7f\u7528 IAM \u5ba2\u6236\u7aef\u5eab\uff0c\u8acb\u53c3\u95b1 [IAM \u5ba2\u6236\u7aef\u5eab](https://cloud.google.com/iam/docs/reference/libraries?hl=zh-cn) \u3002\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [IAM Go API \u53c3\u8003\u6587\u6a94](https://godoc.org/google.golang.org/genproto/googleapis/iam/admin/v1) \u3002\n\u5982\u9700\u5411 IAM \u9032\u884c\u8eab\u4efd\u9a57\u8b49\uff0c\u8acb\u8a2d\u7f6e\u61c9\u7528\u9ed8\u8a8d\u6191\u64da\u3002  \u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [\u6e96\u5099\u5de5\u4f5c](#before-you-begin) \u3002\n [\u5728 GitHub \u4e0a\u67e5\u770b](https://github.com/GoogleCloudPlatform/golang-samples/blob/HEAD/iam/snippets/roles_create.go) \n```\nimport (\u00a0 \u00a0 \u00a0 \u00a0 \"context\"\u00a0 \u00a0 \u00a0 \u00a0 \"fmt\"\u00a0 \u00a0 \u00a0 \u00a0 \"io\"\u00a0 \u00a0 \u00a0 \u00a0 iam \"google.golang.org/api/iam/v1\")// createRole creates a custom role.func createRole(w io.Writer, projectID, name, title, description, stage string, permissions []string) (*iam.Role, error) {\u00a0 \u00a0 \u00a0 \u00a0 ctx := context.Background()\u00a0 \u00a0 \u00a0 \u00a0 service, err := iam.NewService(ctx)\u00a0 \u00a0 \u00a0 \u00a0 if err != nil {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 return nil, fmt.Errorf(\"iam.NewService: %w\", err)\u00a0 \u00a0 \u00a0 \u00a0 }\u00a0 \u00a0 \u00a0 \u00a0 request := &iam.CreateRoleRequest{\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 Role: &iam.Role{\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 Title: \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 title,\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 Description: \u00a0 \u00a0 \u00a0 \u00a0 description,\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 IncludedPermissions: permissions,\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 Stage: \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 stage,\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 },\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 RoleId: name,\u00a0 \u00a0 \u00a0 \u00a0 }\u00a0 \u00a0 \u00a0 \u00a0 role, err := service.Projects.Roles.Create(\"projects/\"+projectID, request).Do()\u00a0 \u00a0 \u00a0 \u00a0 if err != nil {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 return nil, fmt.Errorf(\"Projects.Roles.Create: %w\", err)\u00a0 \u00a0 \u00a0 \u00a0 }\u00a0 \u00a0 \u00a0 \u00a0 fmt.Fprintf(w, \"Created role: %v\", role.Name)\u00a0 \u00a0 \u00a0 \u00a0 return role, nil}\n```\u5982\u9700\u77ad\u89e3\u5982\u4f55\u5b89\u88dd\u548c\u4f7f\u7528 IAM \u5ba2\u6236\u7aef\u5eab\uff0c\u8acb\u53c3\u95b1 [IAM \u5ba2\u6236\u7aef\u5eab](https://cloud.google.com/iam/docs/reference/libraries?hl=zh-cn) \u3002\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [IAM Java API \u53c3\u8003\u6587\u6a94](https://developers.google.com/api-client-library/java/apis/iam/v1?hl=zh-cn) \u3002\n\u5982\u9700\u5411 IAM \u9032\u884c\u8eab\u4efd\u9a57\u8b49\uff0c\u8acb\u8a2d\u7f6e\u61c9\u7528\u9ed8\u8a8d\u6191\u64da\u3002  \u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [\u6e96\u5099\u5de5\u4f5c](#before-you-begin) \u3002\n [\u5728 GitHub \u4e0a\u67e5\u770b](https://github.com/GoogleCloudPlatform/java-docs-samples/blob/HEAD/iam/snippets/src/main/java/CreateRole.java) \n```\nimport com.google.cloud.iam.admin.v1.IAMClient;import com.google.iam.admin.v1.CreateRoleRequest;import com.google.iam.admin.v1.Role;import com.google.iam.admin.v1.Role.RoleLaunchStage;import java.io.IOException;import java.util.Arrays;/** Create role. */public class CreateRole {\u00a0 public static void main(String[] args) throws IOException {\u00a0 \u00a0 // TODO(developer): Replace the variables before running the sample.\u00a0 \u00a0 String projectId = \"your-project-id\";\u00a0 \u00a0 String roleId = \"a unique identifier (e.g. testViewer)\";\u00a0 \u00a0 String title = \"a title for your role (e.g. IAM Role Viewer)\";\u00a0 \u00a0 String description = \"a description of the role\";\u00a0 \u00a0 Iterable<String> includedPermissions =\u00a0 \u00a0 \u00a0 \u00a0 Arrays.asList(\"roles/iam.roleViewer\", \"roles/logging.viewer\");\u00a0 \u00a0 createRole(projectId, title, description, includedPermissions, roleId);\u00a0 }\u00a0 public static void createRole(\u00a0 \u00a0 \u00a0 String projectId,\u00a0 \u00a0 \u00a0 String title,\u00a0 \u00a0 \u00a0 String description,\u00a0 \u00a0 \u00a0 Iterable<String> includedPermissions,\u00a0 \u00a0 \u00a0 String roleId)\u00a0 \u00a0 \u00a0 throws IOException {\u00a0 \u00a0 Role.Builder roleBuilder =\u00a0 \u00a0 \u00a0 \u00a0 Role.newBuilder()\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 .setTitle(title)\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 .setDescription(description)\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 .addAllIncludedPermissions(includedPermissions)\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 // See launch stage enums at\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 // https://cloud.google.com/iam/docs/reference/rpc/google.iam.admin.v1#rolelaunchstage\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 .setStage(RoleLaunchStage.BETA);\u00a0 \u00a0 CreateRoleRequest createRoleRequest =\u00a0 \u00a0 \u00a0 \u00a0 CreateRoleRequest.newBuilder()\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 .setParent(\"projects/\" + projectId)\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 .setRoleId(roleId)\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 .setRole(roleBuilder)\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 .build();\u00a0 \u00a0 // Initialize client for sending requests. This client only needs to be created\u00a0 \u00a0 // once, and can be reused for multiple requests.\u00a0 \u00a0 try (IAMClient iamClient = IAMClient.create()) {\u00a0 \u00a0 \u00a0 Role result = iamClient.createRole(createRoleRequest);\u00a0 \u00a0 \u00a0 System.out.println(\"Created role: \" + result.getName());\u00a0 \u00a0 }\u00a0 }}\n```\u5982\u9700\u77ad\u89e3\u5982\u4f55\u5b89\u88dd\u548c\u4f7f\u7528 IAM \u5ba2\u6236\u7aef\u5eab\uff0c\u8acb\u53c3\u95b1 [IAM \u5ba2\u6236\u7aef\u5eab](https://cloud.google.com/iam/docs/reference/libraries?hl=zh-cn) \u3002\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [IAM Python API \u53c3\u8003\u6587\u6a94](https://developers.google.com/api-client-library/python/apis/iam/v1?hl=zh-cn) \u3002\n\u5982\u9700\u5411 IAM \u9032\u884c\u8eab\u4efd\u9a57\u8b49\uff0c\u8acb\u8a2d\u7f6e\u61c9\u7528\u9ed8\u8a8d\u6191\u64da\u3002  \u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [\u6e96\u5099\u5de5\u4f5c](#before-you-begin) \u3002\n [\u5728 GitHub \u4e0a\u67e5\u770b](https://github.com/GoogleCloudPlatform/python-docs-samples/blob/HEAD/iam/api-client/custom_roles.py) \n```\ndef create_role(\u00a0 \u00a0 name: str, project: str, title: str, description: str, permissions: str, stage: str) -> dict:\u00a0 \u00a0 \"\"\"Creates a role.\"\"\"\u00a0 \u00a0 # pylint: disable=no-member\u00a0 \u00a0 role = (\u00a0 \u00a0 \u00a0 \u00a0 service.projects()\u00a0 \u00a0 \u00a0 \u00a0 .roles()\u00a0 \u00a0 \u00a0 \u00a0 .create(\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 parent=\"projects/\" + project,\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 body={\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"roleId\": name,\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"role\": {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"title\": title,\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"description\": description,\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"includedPermissions\": permissions,\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"stage\": stage,\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 },\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 },\u00a0 \u00a0 \u00a0 \u00a0 )\u00a0 \u00a0 \u00a0 \u00a0 .execute()\u00a0 \u00a0 )\u00a0 \u00a0 print(\"Created role: \" + role[\"name\"])\u00a0 \u00a0 return role\n``` ` [roles.create](https://cloud.google.com/iam/docs/reference/rest/v1/projects.roles/create?hl=zh-cn) ` \u65b9\u6cd5\u53ef\u5728\u9805\u76ee\u6216\u7d44\u7e54\u4e2d\u5275\u5efa\u81ea\u5b9a\u7fa9\u89d2\u8272\u3002\n\u5728\u4f7f\u7528\u4efb\u4f55\u8acb\u6c42\u6578\u64da\u4e4b\u524d\uff0c\u8acb\u5148\u9032\u884c\u4ee5\u4e0b\u66ff\u63db\uff1a- ``\uff1a\u60a8\u8981\u7ba1\u7406\u5176\u81ea\u5b9a\u7fa9\u89d2\u8272\u7684\u8cc7\u6e90\u985e\u578b\u3002\u4f7f\u7528\u503c`projects`\u6216`organizations`\u3002\n- ``\uff1a\u60a8\u8981\u7ba1\u7406\u5176\u81ea\u5b9a\u7fa9\u89d2\u8272\u7684\u9805\u76ee ID \u6216\u7d44\u7e54 ID\u3002\u9805\u76ee ID \u662f\u5b57\u6bcd\u6578\u5b57\u5b57\u7b26\u4e32\uff0c\u4f8b\u5982`my-project`\u3002\u7d44\u7e54 ID \u662f\u6578\u5b57\uff0c\u4f8b\u5982`123456789012`\u3002\n- ``\uff1a\u89d2\u8272\u7684\u540d\u7a31\uff0c\u4f8b\u5982`myCompanyAdmin`\u3002\n- ``\uff1a\u89d2\u8272\u7684\u76f4\u89c0\u6613\u61c2\u7684\u6a19\u984c\u3002\u4f8b\u5982`My Company Admin`\u3002\n- ``\uff1a\u89d2\u8272\u7684\u8aaa\u660e\u3002\u4f8b\u5982`\"The company admin role allows company admins to access important resources\"`\u3002\n- `` \u548c `` \uff1a\u60a8\u8981\u5728\u89d2\u8272\u4e2d\u5305\u542b\u7684\u6b0a\u9650\u3002\u4f8b\u5982 `storage.objects.update` \u3002\u60a8\u4e0d\u80fd\u5728\u6b0a\u9650\u540d\u7a31\u4e2d\u4f7f\u7528\u901a\u914d\u7b26 ( `*` )\u3002\u81ea\u5b9a\u7fa9\u89d2\u8272\u53ea\u80fd\u5177\u6709 [\u81ea\u5b9a\u7fa9\u89d2\u8272\u652f\u6301\u7684\u6b0a\u9650](https://cloud.google.com/iam/docs/custom-roles-permissions-support?hl=zh-cn) \u3002\u5982\u679c\u81ea\u5b9a\u7fa9\u89d2\u8272\u5177\u6709\u5176\u4ed6\u6b0a\u9650\uff0c\u5247\u8acb\u6c42\u5c07\u5931\u6557\u3002\n- ``\uff1a\u89d2\u8272\u7684\u7576\u524d\u767c\u4f48\u968e\u6bb5\u3002\u6b64\u5b57\u6bb5\u53ef\u4ee5\u5305\u542b\u4ee5\u4e0b\u503c\u4e4b\u4e00\uff1a`EAP`\u3001`ALPHA`\u3001`BETA`\u3001`GA`\u3001`DEPRECATED`\u6216`DISABLED`\u3002\nHTTP \u65b9\u6cd5\u548c\u7db2\u5740\uff1a\n```\nPOST https://iam.googleapis.com/v1/RESOURCE_TYPE/RESOURCE_ID/roles\n```\n\u8acb\u6c42 JSON \u6b63\u6587\uff1a\n```\n{\n \"roleId\": \"ROLE_ID\",\n \"role\": {\n \"title\": \"ROLE_TITLE\",\n \"description\": \"ROLE_DESCRIPTION\",\n \"includedPermissions\": [  \"PERMISSION_1\",\n  \"PERMISSION_2\"\n ],\n \"stage\": \"LAUNCH_STAGE\"\n }\n}\n```\n\u5982\u9700\u767c\u9001\u60a8\u7684\u8acb\u6c42\uff0c\u8acb\u5c55\u958b\u4ee5\u4e0b\u9078\u9805\u4e4b\u4e00\uff1a\n\u97ff\u61c9\u4e2d\u5305\u542b\u60a8\u5275\u5efa\u7684\u89d2\u8272\u3002\n```\n{\n \"name\": \"projects/myProject/roles/myCompanyAdmin\",\n \"title\": \"My Company Admin\",\n \"description\": \"My custom role description.\",\n \"includedPermissions\": [ \"iam.roles.get\",\n \"iam.roles.list\"\n ],\n \"etag\": \"BwWox/JbaZw=\"\n}\n```\n[](None)\n## \u4fee\u6539\u73fe\u6709\u81ea\u5b9a\u7fa9\u89d2\u8272\n\u901a\u5e38\uff0c\u6211\u5011\u6309\u7167\u4ee5\u4e0b\u6a21\u5f0f\u66f4\u65b0\u8cc7\u6e90\u7684\u5143\u6578\u64da\uff08\u5982\u81ea\u5b9a\u7fa9\u89d2\u8272\uff09\uff1a \u6a21\u5f0f\u3002\u4f7f\u7528\u6b64\u6a21\u5f0f\u6642\uff0c\u60a8\u53ef\u4ee5\u8b80\u53d6\u89d2\u8272\u7684\u7576\u524d\u72c0\u614b\uff0c\u5728\u672c\u5730\u66f4\u65b0\u6578\u64da\uff0c\u7136\u5f8c\u767c\u9001\u4fee\u6539\u5f8c\u7684\u6578\u64da\u4ee5\u9032\u884c\u5beb\u5165\u3002\n\u5982\u679c\u6709\u5169\u500b\u6216\u5169\u500b\u4ee5\u4e0a\u7684\u7368\u7acb\u904e\u7a0b\u540c\u6642\u5617\u8a66\u57f7\u884c\u8a72\u5e8f\u5217\uff0c\u5247\u8b80\u53d6-\u4fee\u6539-\u5beb\u5165\u6a21\u5f0f\u53ef\u80fd\u6703\u5c0e\u81f4\u885d\u7a81\u3002\u4f8b\u5982\uff0c\u7576\u9805\u76ee\u6709\u5169\u4f4d\u6240\u6709\u8005\u540c\u6642\u5617\u8a66\u5c0d\u67d0\u4e00\u89d2\u8272\u9032\u884c\u6709\u885d\u7a81\u7684\u66f4\u6539\u6642\uff0c\u90e8\u5206\u66f4\u6539\u53ef\u80fd\u6703\u5931\u6557\u3002IAM \u53ef\u5229\u7528\u81ea\u5b9a\u7fa9\u89d2\u8272\u7684 `etag` \u5c6c\u6027\u89e3\u6c7a\u6b64\u554f\u984c\u3002\u8a72\u5c6c\u6027\u7528\u65bc\u9a57\u8b49\u81ea\u4e0a\u6b21\u8acb\u6c42\u4ee5\u4f86\u81ea\u5b9a\u7fa9\u89d2\u8272\u662f\u5426\u767c\u751f\u4e86\u66f4\u6539\u3002\u7576\u60a8\u4f7f\u7528 ETag \u503c\u5411 IAM \u767c\u51fa\u8acb\u6c42\u6642\uff0cIAM \u6703\u5c07\u8acb\u6c42\u4e2d\u7684 ETag \u503c\u8207\u81ea\u5b9a\u7fa9\u89d2\u8272\u6240\u95dc\u806f\u7684\u73fe\u6709 ETag \u503c\u9032\u884c\u6bd4\u8f03\u3002\u53ea\u6709\u5728\u5169\u500b ETag \u503c\u4e00\u81f4\u7684\u60c5\u6cc1\u4e0b\uff0c\u5b83\u7e94\u6703\u5beb\u5165\u76f8\u61c9\u66f4\u6539\u3002\n\u8981\u66f4\u65b0\u67d0\u4e00\u89d2\u8272\uff0c\u8acb\u5148\u4f7f\u7528 `roles.get()` \u7372\u53d6\u89d2\u8272\uff0c\u518d\u66f4\u65b0\u89d2\u8272\uff0c\u7136\u5f8c\u4f7f\u7528 `roles.patch()` \u5beb\u5165\u66f4\u65b0\u5f8c\u7684\u89d2\u8272\u3002\u53ea\u6709 `roles.get()` \u4e2d\u7684\u76f8\u61c9\u89d2\u8272\u5305\u542b etag \u503c\uff0c\u624d\u80fd\u5728\u8a2d\u7f6e\u89d2\u8272\u6642\u4f7f\u7528 etag \u503c\u3002\n**\u6ce8\u610f** \uff1a\u5c0d\u65bc `organizations.search` \u548c `folders.search` Cloud Resource Manager API\uff0c\u901a\u904e\u6dfb\u52a0\u6216\u79fb\u9664 `resourcemanager.organizations.get` \u3001 `resourcemanager.folders.get` \u548c `resourcemanager.projects.get` \u7576\u4e2d\u7684\u4efb\u4f55\u6b0a\u9650\u4f86\u4fee\u6539\u81ea\u5b9a\u7fa9\u89d2\u8272\uff0c\u5c0d\u81ea\u5b9a\u7fa9\u89d2\u8272\u6240\u505a\u7684\u66f4\u6539\u53ef\u80fd\u9700\u8981\u9577\u9054 24 \u5c0f\u6642\u7684\u6642\u9593\u7e94\u53ef\u751f\u6548\u3002\u6b64\u5916\uff0c\u5982\u679c API \u8abf\u7528\u672a\u63d0\u4f9b\u6307\u5b9a\u7236\u7d1a\u985e\u578b\u548c ID \u7684\u904e\u6ffe\u689d\u4ef6\uff0cAPI `projects.list` \u4e5f\u6703\u53d7\u5230\u9019\u7a2e\u5ef6\u9072\u7684\u5f71\u97ff\u3002\u767c\u751f\u9019\u7a2e\u5ef6\u9072\u7684\u539f\u56e0\u662f\uff0c\u9019\u4e9b\u6b0a\u9650\u6d89\u53ca\u641c\u7d22\u529f\u80fd\uff0c\u53ef\u80fd\u6700\u591a\u9700\u8981 24 \u500b\u5c0f\u6642\u624d\u80fd\u91cd\u5efa\u641c\u7d22\u7d22\u5f15\u3002\n- \u5728 Google Cloud \u63a7\u5236\u6aaf\u4e2d\uff0c\u8f49\u5230 **\u89d2\u8272** \u9801\u9762\u3002 [\u8f49\u5230\u201c\u89d2\u8272\u201d\u9801\u9762](https://console.cloud.google.com/iam-admin/roles?hl=zh-cn) \n- \u5728\u9801\u9762\u9802\u90e8\u7684\u4e0b\u62c9\u5217\u8868\u4e2d\uff0c\u9078\u64c7\u5305\u542b\u60a8\u8981\u4fee\u6539\u7684\u89d2\u8272\u7684\u9805\u76ee\u6216\u7d44\u7e54\u3002\n- \u9ede\u64ca\u81ea\u5b9a\u7fa9\u89d2\u8272\u3002\n- \u9ede\u64ca **\u4fee\u6539\u89d2\u8272** \u3002\n- \u5982\u9700\u66f4\u65b0\u89d2\u8272\u7684\u5143\u6578\u64da\uff0c\u8acb\u4fee\u6539\u89d2\u8272\u7684 **\u6a19\u984c** \u3001 **\u8aaa\u660e** \u6216 **\u89d2\u8272\u767c\u4f48\u968e\u6bb5** \u3002\n- \u5982\u9700\u66f4\u65b0\u89d2\u8272\u7684\u6b0a\u9650\uff0c\u8acb\u57f7\u884c\u4ee5\u4e0b\u64cd\u4f5c\uff1a- \u9ede\u64ca **\u6dfb\u52a0\u6b0a\u9650** \u4ee5\u7232\u89d2\u8272\u6dfb\u52a0\u65b0\u6b0a\u9650\u3002\n- \u53d6\u6d88\u9078\u4e2d\u6b0a\u9650\u4ee5\u5f9e\u89d2\u8272\u4e2d\u79fb\u9664\u76f8\u61c9\u6b0a\u9650\u3002\n- \u9ede\u64ca **\u66f4\u65b0** \u4ee5\u4fdd\u5b58\u4fee\u6539\u5f8c\u7684\u89d2\u8272\u3002\n- Titles in dynamic includes are not used anywhere, and we should avoid paying to translate them\u5728 Google Cloud \u63a7\u5236\u6aaf\u4e2d\uff0c\u6fc0\u6d3b Cloud Shell\u3002 [\u6fc0\u6d3b Cloud Shell](https://console.cloud.google.com/?cloudshell=true&hl=zh-cn)  [Cloud Shell](https://cloud.google.com/shell/docs/how-cloud-shell-works?hl=zh-cn) \u6703\u8a71\u96a8\u5373\u6703\u5728 Google Cloud \u63a7\u5236\u6aaf\u7684\u5e95\u90e8\u5553\u52d5\uff0c\u4e26\u986f\u793a\u547d\u4ee4\u884c\u63d0\u793a\u7b26\u3002Cloud Shell \u662f\u4e00\u500b\u5df2\u5b89\u88dd Google Cloud CLI \u4e14\u5df2\u7232\u7576\u524d\u9805\u76ee\u8a2d\u7f6e\u503c\u7684 Shell \u74b0\u5883\u3002\u8a72\u6703\u8a71\u53ef\u80fd\u9700\u8981\u5e7e\u79d2\u9418\u6642\u9593\u4f86\u5b8c\u6210\u521d\u59cb\u5316\u3002\n- \u4f7f\u7528 ` [gcloud iam roles update](https://cloud.google.com/sdk/gcloud/reference/iam/roles/update?hl=zh-cn) ` \u547d\u4ee4\u66f4\u65b0\u81ea\u5b9a\u7fa9\u89d2\u8272\u3002  \u60a8\u53ef\u4ee5\u901a\u904e\u4ee5\u4e0b\u5169\u7a2e\u65b9\u5f0f\u4f7f\u7528\u6b64\u547d\u4ee4\uff1a- \u63d0\u4f9b\u5305\u542b\u5df2\u66f4\u65b0\u89d2\u8272\u5b9a\u7fa9\u7684 YAML \u6587\u4ef6\n- \u4f7f\u7528\u6a19\u8a8c\u6307\u5b9a\u66f4\u65b0\u7684\u89d2\u8272\u5b9a\u7fa9\n\u66f4\u65b0\u81ea\u5b9a\u7fa9\u89d2\u8272\u6642\uff0c\u5fc5\u9808\u4f7f\u7528 `--organization=` `` \u6216 `--project=` `` \u6a19\u8a8c\u6307\u5b9a\u8a72\u89d2\u8272\u662f\u61c9\u7528\u65bc\u7d44\u7e54\u7d1a\u5c64\u9084\u662f\u9805\u76ee\u7d1a\u5c64\u3002\u4ee5\u4e0b\u5404\u793a\u4f8b\u90fd\u662f\u5728\u9805\u76ee\u7d1a\u5c64\u5275\u5efa\u81ea\u5b9a\u7fa9\u89d2\u8272\u3002 **\u8981\u4f7f\u7528 YAML \u6587\u4ef6\u66f4\u65b0\u81ea\u5b9a\u7fa9\u89d2\u8272\uff0c\u8acb\u57f7\u884c\u4ee5\u4e0b\u64cd\u4f5c\uff1a** \u901a\u904e\u57f7\u884c\u4ee5\u4e0b\u547d\u4ee4\u4e4b\u4e00\u7372\u53d6\u89d2\u8272\u7684\u7576\u524d\u5b9a\u7fa9\uff1a- \u8981\u7372\u53d6\u7d44\u7e54\u7d1a\u5c64\u81ea\u5b9a\u7fa9\u89d2\u8272\u7684\u5b9a\u7fa9\uff0c\u8acb\u57f7\u884c\u4ee5\u4e0b\u547d\u4ee4\uff1a```\ngcloud iam roles describe ROLE_ID --organization=ORGANIZATION_ID\n```\n- \u8981\u7372\u53d6\u9805\u76ee\u7d1a\u5c64\u81ea\u5b9a\u7fa9\u89d2\u8272\u7684\u5b9a\u7fa9\uff0c\u8acb\u57f7\u884c\u4ee5\u4e0b\u547d\u4ee4\uff1a```\ngcloud iam roles describe ROLE_ID --project=PROJECT_ID\n```\n\u6bcf\u500b\u4f54\u4f4d\u503c\u7684\u8aaa\u660e\u5982\u4e0b\uff1a- `` \u662f\u8981\u66f4\u65b0\u7684\u89d2\u8272\u7684\u540d\u7a31\uff0c\u4f8b\u5982 `myCompanyAdmin` \u3002\n- `` \u662f\u7d44\u7e54\u7684\u6578\u5b57 ID\uff0c\u4f8b\u5982 `123456789012` \u3002\n- `` \u662f\u9805\u76ee\u7684\u540d\u7a31\uff0c\u4f8b\u5982 `my-project` \u3002\n`describe` \u547d\u4ee4\u8fd4\u56de\u89d2\u8272\u7684\u5b9a\u7fa9\u5e77\u5305\u542b\u7528\u65bc\u552f\u4e00\u6a19\u8b58\u7576\u524d\u89d2\u8272\u7248\u672c\u7684 `etag` \u503c\u3002\u60a8\u61c9\u5728\u66f4\u65b0\u7684\u89d2\u8272\u5b9a\u7fa9\u4e2d\u63d0\u4f9b `etag` \u503c\uff0c\u4ee5\u78ba\u4fdd\u4efb\u4f55\u4f75\u767c\u7684\u89d2\u8272\u66f4\u6539\u90fd\u4e0d\u6703\u88ab\u8986\u84cb\u3002`describe` \u547d\u4ee4\u8fd4\u56de\u4ee5\u4e0b\u8f38\u51fa\uff1a```\ndescription: ROLE_DESCRIPTIONetag: ETAGincludedPermissions:- PERMISSION_1- PERMISSION_2name: ROLE_NAMEstage: LAUNCH_STAGEtitle: ROLE_TITLE\n```\u6bcf\u500b\u4f54\u4f4d\u503c\u7684\u8aaa\u660e\u5982\u4e0b\uff1a- `` \u662f\u89d2\u8272\u7684\u7c21\u77ed\u8aaa\u660e\uff0c\u4f8b\u5982 `\"My custom role description\"` \u3002\n- `` \u662f\u7576\u524d\u89d2\u8272\u7248\u672c\u7684\u552f\u4e00\u6a19\u8b58\u7b26\uff0c\u4f8b\u5982 `BwVkBkbfr70=` \u3002\n- `` \u548c `` \u662f\u8981\u5305\u542b\u5728\u81ea\u5b9a\u7fa9\u89d2\u8272\u4e2d\u7684\u6b0a\u9650\uff0c\u4f8b\u5982 `iam.roles.get` \u3002 \u60a8\u4e0d\u80fd\u5728\u6b0a\u9650\u540d\u7a31\u4e2d\u4f7f\u7528\u901a\u914d\u7b26 ( `*` )\u3002\n- `` \u662f\u5b8c\u6574\u7684\u89d2\u8272\u540d\u7a31\uff0c\u5305\u62ec\u4efb\u4f55 `organizations/` \u3001 `projects/` \u6216 `roles/` \u524d\u7db4\u3002\u4f8b\u5982\uff1a `organizations/123456789012/roles/myCompanyAdmin.`\n- `` \u8868\u793a\u89d2\u8272\u5728\u767c\u4f48\u751f\u547d\u9031\u671f\u4e2d\u6240\u8655\u7684\u968e\u6bb5\uff0c\u4f8b\u5982 `ALPHA` \u3001 `BETA` \u6216 `GA` \u3002\n- `` \u662f\u89d2\u8272\u7684\u6613\u8a18\u6a19\u984c\uff0c\u4f8b\u5982 `\"My Company Admin\"` \u3002\n\u8981\u66f4\u65b0\u89d2\u8272\uff0c\u8acb\u5c07\u8f38\u51fa\u7684\u89d2\u8272\u5b9a\u7fa9\u52a0\u5165 YAML \u6587\u4ef6\u4e2d\uff0c\u6216\u4f7f\u7528\u8f38\u51fa\u7684 `etag` \u503c\u66f4\u65b0\u539f\u59cb YAML \u6587\u4ef6\u3002\u8acb\u8003\u616e\u4ee5\u4e0b\u793a\u4f8b YAML \u6587\u4ef6\uff0c\u8a72\u6587\u4ef6\u5305\u542b\u91dd\u5c0d\u9805\u76ee\u7d1a\u5c64\u89d2\u8272\u904b\u884c\u7684 `describe` \u547d\u4ee4\u7684\u8f38\u51fa\u4e26\u6dfb\u52a0\u4e86\u5169\u9805 Cloud Storage \u6b0a\u9650\uff1a```\ndescription: My custom role description.etag: BwVkBkbfr70=includedPermissions:- iam.roles.get- iam.roles.list- storage.buckets.get- storage.buckets.listname: projects/my-project/roles/myCompanyAdminstage: ALPHAtitle: My Company Admin\n```\u4fdd\u5b58 YAML \u6587\u4ef6\uff0c\u7136\u5f8c\u57f7\u884c\u4ee5\u4e0b\u547d\u4ee4\u4e4b\u4e00\uff1a- \u8981\u66f4\u65b0\u7d44\u7e54\u7d1a\u5c64\u89d2\u8272\uff0c\u8acb\u57f7\u884c\u4ee5\u4e0b\u547d\u4ee4\uff1a```\ngcloud iam roles update ROLE_ID--organization=ORGANIZATION_ID \\\n --file=YAML_FILE_PATH\n```\n- \u8981\u66f4\u65b0\u9805\u76ee\u7d1a\u5c64\u89d2\u8272\uff0c\u8acb\u57f7\u884c\u4ee5\u4e0b\u547d\u4ee4\uff1a```\ngcloud iam roles update ROLE_ID --project=PROJECT_ID \\\n --file=YAML_FILE_PATH\n```\n\u6bcf\u500b\u4f54\u4f4d\u503c\u7684\u8aaa\u660e\u5982\u4e0b\uff1a- `` \u662f\u8981\u66f4\u65b0\u7684\u89d2\u8272\u7684\u540d\u7a31\uff0c\u4f8b\u5982 `myCompanyAdmin` \u3002\n- `` \u662f\u7d44\u7e54\u7684\u6578\u5b57 ID\uff0c\u4f8b\u5982 `123456789012` \u3002\n- `` \u662f\u9805\u76ee\u7684\u540d\u7a31\uff0c\u4f8b\u5982 `my-project-id` \u3002\n- `` \u662f\u5305\u542b\u5df2\u66f4\u65b0\u81ea\u5b9a\u7fa9\u89d2\u8272\u5b9a\u7fa9\u7684 YAML \u6587\u4ef6\u7684\u4f4d\u7f6e\u8def\u5f91\u3002\n **\u793a\u4f8b** \u4ee5\u4e0b\u793a\u4f8b\u6f14\u793a\u77ad\u5982\u4f55\u4f7f\u7528 YAML \u6587\u4ef6\u66f4\u65b0\u7d44\u7e54\u7d1a\u5c64\u89d2\u8272\uff1a```\ngcloud iam roles update ROLE_ID --organization=ORGANIZATION_ID \\\n --file=YAML_FILE_PATH\n```- \u8981\u66f4\u65b0\u9805\u76ee\u7d1a\u5c64\u89d2\u8272\uff0c\u8acb\u57f7\u884c\u4ee5\u4e0b\u547d\u4ee4\uff1a```\ngcloud iam roles update ROLE_ID --project=PROJECT_ID \\\n --file=YAML_FILE_PATH\n```\n\u6bcf\u500b\u4f54\u4f4d\u503c\u7684\u8aaa\u660e\u5982\u4e0b\uff1a- `` \u662f\u8981\u66f4\u65b0\u7684\u89d2\u8272\u7684\u540d\u7a31\uff0c\u4f8b\u5982 `myCompanyAdmin` \u3002\n- `` \u662f\u7d44\u7e54\u7684\u6578\u5b57 ID\uff0c\u4f8b\u5982 `123456789012` \u3002\n- `` \u662f\u9805\u76ee\u7684\u540d\u7a31\uff0c\u4f8b\u5982 `my-project` \u3002\n- `` \u662f\u5305\u542b\u5df2\u66f4\u65b0\u81ea\u5b9a\u7fa9\u89d2\u8272\u5b9a\u7fa9\u7684 YAML \u6587\u4ef6\u7684\u4f4d\u7f6e\u8def\u5f91\u3002\n **\u793a\u4f8b** \u4ee5\u4e0b\u793a\u4f8b\u6f14\u793a\u77ad\u5982\u4f55\u4f7f\u7528 YAML \u6587\u4ef6\u66f4\u65b0\u7d44\u7e54\u7d1a\u5c64\u89d2\u8272\uff1a```\ngcloud iam roles update myCompanyAdmin --organization=123456789012 \\\n --file=my-role-definition.yaml\n```\u5982\u679c\u6210\u529f\u66f4\u65b0\u4e86\u89d2\u8272\uff0c\u5247\u8a72\u547d\u4ee4\u7684\u8f38\u51fa\u985e\u4f3c\u65bc\u4ee5\u4e0b\u5167\u5bb9\uff1a```\ndescription: My custom role description.etag: BwVkBwDN0lg=includedPermissions:- iam.roles.get- iam.roles.list- storage.buckets.get- storage.buckets.listname: organizations/123456789012/roles/myCompanyAdminstage: ALPHAtitle: My Company Admin\n```\u4ee5\u4e0b\u793a\u4f8b\u6f14\u793a\u77ad\u5982\u4f55\u4f7f\u7528 YAML \u6587\u4ef6\u66f4\u65b0\u9805\u76ee\u7d1a\u5c64\u89d2\u8272\uff1a```\ngcloud iam roles update myCompanyAdmin --project=my-project \\\n --file=my-role-definition.yaml\n```\u5982\u679c\u6210\u529f\u66f4\u65b0\u4e86\u89d2\u8272\uff0c\u5247\u8a72\u547d\u4ee4\u7684\u8f38\u51fa\u985e\u4f3c\u65bc\u4ee5\u4e0b\u5167\u5bb9\uff1a```\ndescription: My custom role description.etag: BwVkBwDN0lg=includedPermissions:- iam.roles.get- iam.roles.list- storage.buckets.get- storage.buckets.listname: projects/my-project/roles/myCompanyAdminstage: ALPHAtitle: My Company Admin\n``` **\u5982\u9700\u4f7f\u7528\u6a19\u8a8c\u66f4\u65b0\u81ea\u5b9a\u7fa9\u89d2\u8272\uff0c\u8acb\u57f7\u884c\u4ee5\u4e0b\u64cd\u4f5c\uff1a** \u53ef\u4f7f\u7528\u76f8\u61c9\u6a19\u8a8c\u66f4\u65b0\u89d2\u8272\u5b9a\u7fa9\u7684\u6bcf\u500b\u90e8\u5206\u3002  \u5982\u9700\u67e5\u770b\u6240\u6709\u53ef\u7528\u6a19\u8a8c\u7684\u5217\u8868\uff0c\u8acb\u53c3\u95b1 ` [gcloud iam roles update](https://cloud.google.com/sdk/gcloud/reference/iam/roles/update?hl=zh-cn) ` \u4e3b\u984c\u3002\u60a8\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u6a19\u8a8c\u6dfb\u52a0\u6216\u79fb\u9664\u6b0a\u9650\uff1a- `--add-permissions=` `` \uff1a\u7232\u89d2\u8272\u6dfb\u52a0\u4e00\u500b\u6216\u591a\u500b\u4ee5\u82f1\u6587\u9017\u865f\u5206\u9694\u7684\u6b0a\u9650\u3002 \u60a8\u4e0d\u80fd\u5728\u6b0a\u9650\u540d\u7a31\u4e2d\u4f7f\u7528\u901a\u914d\u7b26 ( `*` )\u3002\n- `--remove-permissions=` `` \uff1a\u5f9e\u89d2\u8272\u4e2d\u79fb\u9664\u4e00\u500b\u6216\u591a\u500b\u4ee5\u82f1\u6587\u9017\u865f\u5206\u9694\u7684\u6b0a\u9650\u3002 \u60a8\u4e0d\u80fd\u5728\u6b0a\u9650\u540d\u7a31\u4e2d\u4f7f\u7528\u901a\u914d\u7b26 ( `*` )\u3002\n\u6216\u8005\uff0c\u60a8\u53ea\u9700\u4f7f\u7528 `--permissions=` `` \u6a19\u8a8c\u6307\u5b9a\u65b0\u6b0a\u9650\uff0c\u4e26\u63d0\u4f9b\u6b0a\u9650\u7684\u9017\u865f\u5206\u9694\u5217\u8868\u4ee5\u66ff\u63db\u73fe\u6709\u6b0a\u9650\u5217\u8868\u3002\u8981\u66f4\u65b0\u89d2\u8272\u5b9a\u7fa9\u7684\u5176\u4ed6\u90e8\u5206\uff0c\u8acb\u57f7\u884c\u4ee5\u4e0b\u547d\u4ee4\u4e4b\u4e00\uff1a- \u8981\u66f4\u65b0\u7d44\u7e54\u7d1a\u5c64\u89d2\u8272\uff0c\u8acb\u57f7\u884c\u4ee5\u4e0b\u547d\u4ee4\uff1a```\ngcloud iam roles update ROLE_ID--organization=ORGANIZATION_ID \\\n --title=ROLE_TITLE --description=ROLE_DESCRIPTION \\\n --stage=LAUNCH_STAGE\n```\n- \u8981\u66f4\u65b0\u9805\u76ee\u7d1a\u5c64\u89d2\u8272\uff0c\u8acb\u57f7\u884c\u4ee5\u4e0b\u547d\u4ee4\uff1a```\ngcloud iam roles update ROLE_ID --project=PROJECT_ID \\\n --title=ROLE_TITLE --description=ROLE_DESCRIPTION \\\n --stage=LAUNCH_STAGE\n```\n\u6bcf\u500b\u4f54\u4f4d\u503c\u7684\u8aaa\u660e\u5982\u4e0b\uff1a- `` \u662f\u89d2\u8272\u7684\u540d\u7a31\uff0c\u4f8b\u5982 `myCompanyAdmin` \u3002\n- `` \u662f\u7d44\u7e54\u7684\u6578\u5b57 ID\uff0c\u4f8b\u5982 `123456789012` \u3002\n- `` \u662f\u9805\u76ee\u7684\u540d\u7a31\uff0c\u4f8b\u5982 `my-project` \u3002\n- `` \u662f\u89d2\u8272\u7684\u6613\u8a18\u6a19\u984c\uff0c\u4f8b\u5982 `\"My Company Admin\"` \u3002\n- `` \u662f\u89d2\u8272\u7684\u7c21\u77ed\u8aaa\u660e\uff0c\u4f8b\u5982 `\"My custom role description.\"` \u3002\n- `` \u8868\u793a\u89d2\u8272\u5728\u767c\u4f48\u751f\u547d\u9031\u671f\u4e2d\u6240\u8655\u7684\u968e\u6bb5\uff0c\u4f8b\u5982 `ALPHA` \u3001 `BETA` \u6216 `GA` \u3002\n **\u793a\u4f8b** \u4ee5\u4e0b\u793a\u4f8b\u6f14\u793a\u77ad\u5982\u4f55\u4f7f\u7528\u6a19\u8a8c\u5411\u7d44\u7e54\u7d1a\u5c64\u89d2\u8272\u6dfb\u52a0\u6b0a\u9650\uff1a```\ngcloud iam roles update myCompanyAdmin --organization=123456789012 \\\n --add-permissions=\"storage.buckets.get,storage.buckets.list\"\n```\u5982\u679c\u6210\u529f\u66f4\u65b0\u4e86\u89d2\u8272\uff0c\u5247\u8a72\u547d\u4ee4\u7684\u8f38\u51fa\u985e\u4f3c\u65bc\u4ee5\u4e0b\u5167\u5bb9\uff1a```\ndescription: My custom role description.etag: BwVkBwDN0lg=includedPermissions:- iam.roles.get- iam.roles.list- storage.buckets.get- storage.buckets.listname: organization/123456789012/roles/myCompanyAdminstage: ALPHAtitle: My Company Admin\n```\u4ee5\u4e0b\u793a\u4f8b\u6f14\u793a\u77ad\u5982\u4f55\u4f7f\u7528\u6a19\u8a8c\u5411\u9805\u76ee\u7d1a\u5c64\u89d2\u8272\u6dfb\u52a0\u6b0a\u9650\uff1a```\ngcloud iam roles update myCompanyAdmin --project=my-project \\\n --add-permissions=\"storage.buckets.get,storage.buckets.list\"\n```\u5982\u679c\u6210\u529f\u66f4\u65b0\u4e86\u89d2\u8272\uff0c\u5247\u8a72\u547d\u4ee4\u7684\u8f38\u51fa\u985e\u4f3c\u65bc\u4ee5\u4e0b\u5167\u5bb9\uff1a```\ndescription: My custom role description.etag: BwVkBwDN0lg=includedPermissions:- iam.roles.get- iam.roles.list- storage.buckets.get- storage.buckets.listname: projects/my-project/roles/myCompanyAdminstage: ALPHAtitle: My Company Admin\n```\n\u5982\u9700\u77ad\u89e3\u5982\u4f55\u5b89\u88dd\u548c\u4f7f\u7528 IAM \u5ba2\u6236\u7aef\u5eab\uff0c\u8acb\u53c3\u95b1 [IAM \u5ba2\u6236\u7aef\u5eab](https://cloud.google.com/iam/docs/reference/libraries?hl=zh-cn) \u3002\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [IAM C++ API \u53c3\u8003\u6587\u6a94](https://cloud.google.com/cpp/docs/reference/iam/latest?hl=zh-cn) \u3002\n\u5982\u9700\u5411 IAM \u9032\u884c\u8eab\u4efd\u9a57\u8b49\uff0c\u8acb\u8a2d\u7f6e\u61c9\u7528\u9ed8\u8a8d\u6191\u64da\u3002  \u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [\u6e96\u5099\u5de5\u4f5c](#before-you-begin) \u3002\n [\u5728 GitHub \u4e0a\u67e5\u770b](https://github.com/googleapis/google-cloud-cpp/blob/HEAD/google/cloud/iam/samples/iam_samples.cc) \n```\nnamespace iam = ::google::cloud::iam_admin_v1;[](std::string const& name, std::string const& title) {\u00a0 iam::IAMClient client(iam::MakeIAMConnection());\u00a0 google::iam::admin::v1::UpdateRoleRequest request;\u00a0 request.set_name(name);\u00a0 google::iam::admin::v1::Role role;\u00a0 role.set_title(title);\u00a0 google::protobuf::FieldMask update_mask;\u00a0 *update_mask.add_paths() = \"title\";\u00a0 *request.mutable_role() = role;\u00a0 *request.mutable_update_mask() = update_mask;\u00a0 auto response = client.UpdateRole(request);\u00a0 if (!response) throw std::move(response).status();\u00a0 std::cout << \"Role successfully updated: \" << response->DebugString()\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 << \"\\n\";}\n```\u5982\u9700\u77ad\u89e3\u5982\u4f55\u5b89\u88dd\u548c\u4f7f\u7528 IAM \u5ba2\u6236\u7aef\u5eab\uff0c\u8acb\u53c3\u95b1 [IAM \u5ba2\u6236\u7aef\u5eab](https://cloud.google.com/iam/docs/reference/libraries?hl=zh-cn) \u3002\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [IAM C# API \u53c3\u8003\u6587\u6a94](https://developers.google.com/api-client-library/dotnet/apis/iam/v1?hl=zh-cn) \u3002\n\u5982\u9700\u5411 IAM \u9032\u884c\u8eab\u4efd\u9a57\u8b49\uff0c\u8acb\u8a2d\u7f6e\u61c9\u7528\u9ed8\u8a8d\u6191\u64da\u3002  \u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [\u6e96\u5099\u5de5\u4f5c](#before-you-begin) \u3002\n [\u5728 GitHub \u4e0a\u67e5\u770b](https://github.com/GoogleCloudPlatform/dotnet-docs-samples/blob/HEAD/iam/api/CustomRoles/RolesEdit.cs) \n```\nusing System;using System.Collections.Generic;using Google.Apis.Auth.OAuth2;using Google.Apis.Iam.v1;using Google.Apis.Iam.v1.Data;public partial class CustomRoles{\u00a0 \u00a0 public static Role EditRole(string name, string projectId, string newTitle,\u00a0 \u00a0 \u00a0 \u00a0 string newDescription, IList<string> newPermissions, string newStage)\u00a0 \u00a0 {\u00a0 \u00a0 \u00a0 \u00a0 var credential = GoogleCredential.GetApplicationDefault()\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 .CreateScoped(IamService.Scope.CloudPlatform);\u00a0 \u00a0 \u00a0 \u00a0 var service = new IamService(new IamService.Initializer\u00a0 \u00a0 \u00a0 \u00a0 {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 HttpClientInitializer = credential\u00a0 \u00a0 \u00a0 \u00a0 });\u00a0 \u00a0 \u00a0 \u00a0 // First, get a Role using List() or Get().\u00a0 \u00a0 \u00a0 \u00a0 string resource = $\"projects/{projectId}/roles/{name}\";\u00a0 \u00a0 \u00a0 \u00a0 var role = service.Projects.Roles.Get(resource).Execute();\u00a0 \u00a0 \u00a0 \u00a0 // Then you can update its fields.\u00a0 \u00a0 \u00a0 \u00a0 role.Title = newTitle;\u00a0 \u00a0 \u00a0 \u00a0 role.Description = newDescription;\u00a0 \u00a0 \u00a0 \u00a0 role.IncludedPermissions = newPermissions;\u00a0 \u00a0 \u00a0 \u00a0 role.Stage = newStage;\u00a0 \u00a0 \u00a0 \u00a0 role = service.Projects.Roles.Patch(role, resource).Execute();\u00a0 \u00a0 \u00a0 \u00a0 Console.WriteLine(\"Updated role: \" + role.Name);\u00a0 \u00a0 \u00a0 \u00a0 return role;\u00a0 \u00a0 }}\n```\u5982\u9700\u77ad\u89e3\u5982\u4f55\u5b89\u88dd\u548c\u4f7f\u7528 IAM \u5ba2\u6236\u7aef\u5eab\uff0c\u8acb\u53c3\u95b1 [IAM \u5ba2\u6236\u7aef\u5eab](https://cloud.google.com/iam/docs/reference/libraries?hl=zh-cn) \u3002\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [IAM Go API \u53c3\u8003\u6587\u6a94](https://godoc.org/google.golang.org/genproto/googleapis/iam/admin/v1) \u3002\n\u5982\u9700\u5411 IAM \u9032\u884c\u8eab\u4efd\u9a57\u8b49\uff0c\u8acb\u8a2d\u7f6e\u61c9\u7528\u9ed8\u8a8d\u6191\u64da\u3002  \u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [\u6e96\u5099\u5de5\u4f5c](#before-you-begin) \u3002\n [\u5728 GitHub \u4e0a\u67e5\u770b](https://github.com/GoogleCloudPlatform/golang-samples/blob/HEAD/iam/snippets/roles_edit.go) \n```\nimport (\u00a0 \u00a0 \u00a0 \u00a0 \"context\"\u00a0 \u00a0 \u00a0 \u00a0 \"fmt\"\u00a0 \u00a0 \u00a0 \u00a0 \"io\"\u00a0 \u00a0 \u00a0 \u00a0 iam \"google.golang.org/api/iam/v1\")// editRole modifies a custom role.func editRole(w io.Writer, projectID, name, newTitle, newDescription, newStage string, newPermissions []string) (*iam.Role, error) {\u00a0 \u00a0 \u00a0 \u00a0 ctx := context.Background()\u00a0 \u00a0 \u00a0 \u00a0 service, err := iam.NewService(ctx)\u00a0 \u00a0 \u00a0 \u00a0 if err != nil {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 return nil, fmt.Errorf(\"iam.NewService: %w\", err)\u00a0 \u00a0 \u00a0 \u00a0 }\u00a0 \u00a0 \u00a0 \u00a0 resource := \"projects/\" + projectID + \"/roles/\" + name\u00a0 \u00a0 \u00a0 \u00a0 role, err := service.Projects.Roles.Get(resource).Do()\u00a0 \u00a0 \u00a0 \u00a0 if err != nil {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 return nil, fmt.Errorf(\"Projects.Roles.Get: %w\", err)\u00a0 \u00a0 \u00a0 \u00a0 }\u00a0 \u00a0 \u00a0 \u00a0 role.Title = newTitle\u00a0 \u00a0 \u00a0 \u00a0 role.Description = newDescription\u00a0 \u00a0 \u00a0 \u00a0 role.IncludedPermissions = newPermissions\u00a0 \u00a0 \u00a0 \u00a0 role.Stage = newStage\u00a0 \u00a0 \u00a0 \u00a0 role, err = service.Projects.Roles.Patch(resource, role).Do()\u00a0 \u00a0 \u00a0 \u00a0 if err != nil {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 return nil, fmt.Errorf(\"Projects.Roles.Patch: %w\", err)\u00a0 \u00a0 \u00a0 \u00a0 }\u00a0 \u00a0 \u00a0 \u00a0 fmt.Fprintf(w, \"Updated role: %v\", role.Name)\u00a0 \u00a0 \u00a0 \u00a0 return role, nil}\n```\u5982\u9700\u77ad\u89e3\u5982\u4f55\u5b89\u88dd\u548c\u4f7f\u7528 IAM \u5ba2\u6236\u7aef\u5eab\uff0c\u8acb\u53c3\u95b1 [IAM \u5ba2\u6236\u7aef\u5eab](https://cloud.google.com/iam/docs/reference/libraries?hl=zh-cn) \u3002\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [IAM Java API \u53c3\u8003\u6587\u6a94](https://developers.google.com/api-client-library/java/apis/iam/v1?hl=zh-cn) \u3002\n\u5982\u9700\u5411 IAM \u9032\u884c\u8eab\u4efd\u9a57\u8b49\uff0c\u8acb\u8a2d\u7f6e\u61c9\u7528\u9ed8\u8a8d\u6191\u64da\u3002  \u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [\u6e96\u5099\u5de5\u4f5c](#before-you-begin) \u3002\n [\u5728 GitHub \u4e0a\u67e5\u770b](https://github.com/GoogleCloudPlatform/java-docs-samples/blob/HEAD/iam/snippets/src/main/java/EditRole.java) \n```\nimport com.google.cloud.iam.admin.v1.IAMClient;import com.google.iam.admin.v1.Role;import com.google.iam.admin.v1.Role.RoleLaunchStage;import com.google.iam.admin.v1.UpdateRoleRequest;import com.google.protobuf.FieldMask;import java.io.IOException;/** Edit role metadata. Specifically, update description and launch stage. */public class EditRole {\u00a0 public static void main(String[] args) throws IOException {\u00a0 \u00a0 // TODO(developer): Replace the variables before running the sample.\u00a0 \u00a0 // Role ID must point to an existing role.\u00a0 \u00a0 String projectId = \"your-project-id\";\u00a0 \u00a0 String roleId = \"a unique identifier (e.g. testViewer)\";\u00a0 \u00a0 String description = \"a new description of the role\";\u00a0 \u00a0 editRole(projectId, roleId, description);\u00a0 }\u00a0 public static void editRole(String projectId, String roleId, String description)\u00a0 \u00a0 \u00a0 throws IOException {\u00a0 \u00a0 String roleName = \"projects/\" + projectId + \"/roles/\" + roleId;\u00a0 \u00a0 Role.Builder roleBuilder =\u00a0 \u00a0 \u00a0 \u00a0 Role.newBuilder()\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 .setName(roleName)\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 .setDescription(description)\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 // See launch stage enums at\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 // https://cloud.google.com/iam/docs/reference/rpc/google.iam.admin.v1#rolelaunchstage\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 .setStage(RoleLaunchStage.GA);\u00a0 \u00a0 FieldMask fieldMask = FieldMask.newBuilder().addPaths(\"description\").addPaths(\"stage\").build();\u00a0 \u00a0 UpdateRoleRequest updateRoleRequest =\u00a0 \u00a0 \u00a0 \u00a0 UpdateRoleRequest.newBuilder()\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 .setName(roleName)\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 .setRole(roleBuilder)\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 .setUpdateMask(fieldMask)\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 .build();\u00a0 \u00a0 // Initialize client for sending requests. This client only needs to be created\u00a0 \u00a0 // once, and can be reused for multiple requests.\u00a0 \u00a0 try (IAMClient iamClient = IAMClient.create()) {\u00a0 \u00a0 \u00a0 Role result = iamClient.updateRole(updateRoleRequest);\u00a0 \u00a0 \u00a0 System.out.println(\"Edited role:\\n\" + result);\u00a0 \u00a0 }\u00a0 }}\n```\u5982\u9700\u77ad\u89e3\u5982\u4f55\u5b89\u88dd\u548c\u4f7f\u7528 IAM \u5ba2\u6236\u7aef\u5eab\uff0c\u8acb\u53c3\u95b1 [IAM \u5ba2\u6236\u7aef\u5eab](https://cloud.google.com/iam/docs/reference/libraries?hl=zh-cn) \u3002\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [IAM Python API \u53c3\u8003\u6587\u6a94](https://developers.google.com/api-client-library/python/apis/iam/v1?hl=zh-cn) \u3002\n\u5982\u9700\u5411 IAM \u9032\u884c\u8eab\u4efd\u9a57\u8b49\uff0c\u8acb\u8a2d\u7f6e\u61c9\u7528\u9ed8\u8a8d\u6191\u64da\u3002  \u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [\u6e96\u5099\u5de5\u4f5c](#before-you-begin) \u3002\n [\u5728 GitHub \u4e0a\u67e5\u770b](https://github.com/GoogleCloudPlatform/python-docs-samples/blob/HEAD/iam/api-client/custom_roles.py) \n```\ndef edit_role(\u00a0 \u00a0 name: str, project: str, title: str, description: str, permissions: str, stage: str) -> dict:\u00a0 \u00a0 \"\"\"Creates a role.\"\"\"\u00a0 \u00a0 # pylint: disable=no-member\u00a0 \u00a0 role = (\u00a0 \u00a0 \u00a0 \u00a0 service.projects()\u00a0 \u00a0 \u00a0 \u00a0 .roles()\u00a0 \u00a0 \u00a0 \u00a0 .patch(\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 name=\"projects/\" + project + \"/roles/\" + name,\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 body={\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"title\": title,\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"description\": description,\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"includedPermissions\": permissions,\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"stage\": stage,\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 },\u00a0 \u00a0 \u00a0 \u00a0 )\u00a0 \u00a0 \u00a0 \u00a0 .execute()\u00a0 \u00a0 )\u00a0 \u00a0 print(\"Updated role: \" + role[\"name\"])\u00a0 \u00a0 return role\n``` ` [roles.patch](https://cloud.google.com/iam/docs/reference/rest/v1/projects.roles/patch?hl=zh-cn) ` \u65b9\u6cd5\u53ef\u66f4\u65b0\u9805\u76ee\u6216\u7d44\u7e54\u4e2d\u7684\u81ea\u5b9a\u7fa9\u89d2\u8272\u3002\n\u5728\u4f7f\u7528\u4efb\u4f55\u8acb\u6c42\u6578\u64da\u4e4b\u524d\uff0c\u8acb\u5148\u9032\u884c\u4ee5\u4e0b\u66ff\u63db\uff1a\n **\u5fc5\u9700** \uff1a- ``\uff1a\u60a8\u8981\u7ba1\u7406\u5176\u81ea\u5b9a\u7fa9\u89d2\u8272\u7684\u8cc7\u6e90\u985e\u578b\u3002\u4f7f\u7528\u503c`projects`\u6216`organizations`\u3002\n- ``\uff1a\u60a8\u8981\u7ba1\u7406\u5176\u81ea\u5b9a\u7fa9\u89d2\u8272\u7684\u9805\u76ee ID \u6216\u7d44\u7e54 ID\u3002\u9805\u76ee ID \u662f\u5b57\u6bcd\u6578\u5b57\u5b57\u7b26\u4e32\uff0c\u4f8b\u5982`my-project`\u3002\u7d44\u7e54 ID \u662f\u6578\u5b57\uff0c\u4f8b\u5982`123456789012`\u3002\n- ``\uff1a\u5b8c\u6574\u7684\u89d2\u8272\u540d\u7a31\uff0c\u5305\u62ec\u4efb\u4f55`organizations/`\u3001`projects/`\u6216`roles/`\u524d\u7db4\u3002\u4f8b\u5982`organizations/123456789012/roles/myCompanyAdmin`\u3002\n **\u63a8\u85a6\uff1a** - ``\uff1a\u89d2\u8272\u7248\u672c\u7684\u6a19\u8b58\u7b26\u3002\u5305\u542b\u6b64\u5b57\u6bb5\u53ef\u9632\u6b62\u8986\u84cb\u5176\u4ed6\u89d2\u8272\u66f4\u6539\u3002\n **\u53ef\u9078\uff08\u5b9a\u7fa9\u4ee5\u4e0b\u4e00\u500b\u6216\u591a\u500b\u503c\uff09** - ``\uff1a\u89d2\u8272\u7684\u76f4\u89c0\u6613\u61c2\u7684\u6a19\u984c\u3002\u4f8b\u5982`My Company Admin`\u3002\n- ``\uff1a\u89d2\u8272\u7684\u8aaa\u660e\u3002\u4f8b\u5982`\"The company admin role allows company admins to access important resources\"`\u3002\n- ``\u548c``\uff1a\u60a8\u8981\u5728\u89d2\u8272\u4e2d\u5305\u542b\u7684\u6b0a\u9650\u3002\u4f8b\u5982`storage.objects.update`\u3002\u60a8\u4e0d\u80fd\u5728\u6b0a\u9650\u540d\u7a31\u4e2d\u4f7f\u7528\u901a\u914d\u7b26 (`*`)\u3002\n- ``\uff1a\u89d2\u8272\u7684\u7576\u524d\u767c\u4f48\u968e\u6bb5\u3002\u6b64\u5b57\u6bb5\u53ef\u4ee5\u5305\u542b\u4ee5\u4e0b\u503c\u4e4b\u4e00\uff1a`EAP`\u3001`ALPHA`\u3001`BETA`\u3001`GA`\u3001`DEPRECATED`\u6216`DISABLED`\u3002\nHTTP \u65b9\u6cd5\u548c\u7db2\u5740\uff1a\n```\nPATCH https://iam.googleapis.com/v1/RESOURCE_TYPE/RESOURCE_ID/roles\n```\n\u8acb\u6c42 JSON \u6b63\u6587\uff1a\n```\n{\n \"roleId\": \"ROLE_NAME\",\n \"title\": \"ROLE_TITLE\",\n \"description\": \"ROLE_DESCRIPTION\",\n \"includedPermissions\": [ \"PERMISSION_1\",\n \"PERMISSION_2\"\n ],\n \"stage\": \"LAUNCH-STAGE\",\n \"etag\": \"ETAG\"\n}\n```\n\u5982\u9700\u767c\u9001\u60a8\u7684\u8acb\u6c42\uff0c\u8acb\u5c55\u958b\u4ee5\u4e0b\u9078\u9805\u4e4b\u4e00\uff1a\n\u97ff\u61c9\u4e2d\u5305\u542b\u7c21\u5316\u7684\u89d2\u8272\u5b9a\u7fa9\uff0c\u5176\u4e2d\u5305\u62ec\u89d2\u8272\u540d\u7a31\u3001\u60a8\u66f4\u65b0\u7684\u5b57\u6bb5\u4ee5\u53ca\u6a19\u8b58\u89d2\u8272\u7576\u524d\u7248\u672c\u7684 ETag\u3002\n```\n{\n \"name\": \"projects/test-project-1000092/roles/myCompanyAdmin\",\n \"title\": \"My Updated Company Admin\",\n \"includedPermissions\": [ \"storage.buckets.get\",\n \"storage.buckets.list\"\n ],\n \"stage\": \"BETA\",\n \"etag\": \"BwWoyDpAxBc=\"\n}\n```\n[](None)\n## \u505c\u7528\u81ea\u5b9a\u7fa9\u89d2\u8272\n\u60a8\u53ef\u4ee5\u901a\u904e\u5c07\u81ea\u5b9a\u7fa9\u89d2\u8272\u7684\u767c\u4f48\u968e\u6bb5\u66f4\u6539\u7232 `DISABLED` \u4f86\u505c\u7528\u8a72\u89d2\u8272\u3002\u7576\u67d0\u500b\u89d2\u8272\u88ab\u505c\u7528\u5f8c\uff0c\u8207\u8a72\u89d2\u8272\u76f8\u95dc\u7684\u6240\u6709\u89d2\u8272\u7d81\u5b9a\u4e5f\u6703\u96a8\u4e4b\u505c\u7528\uff0c\u9019\u610f\u5473\u7740\u5411\u7528\u6236\u6388\u4e88\u8a72\u89d2\u8272\u4e0d\u6703\u7522\u751f\u4efb\u4f55\u5f71\u97ff\u3002\n- \u5728 Google Cloud \u63a7\u5236\u6aaf\u4e2d\uff0c\u8f49\u5230 **\u89d2\u8272** \u9801\u9762\u3002 [\u8f49\u5230\u201c\u89d2\u8272\u201d\u9801\u9762](https://console.cloud.google.com/iam-admin/roles?hl=zh-cn) \n- \u9ede\u64ca\u9801\u9762\u9802\u90e8\u7684\u201c\u9078\u64c7\u9805\u76ee\u201d\u4e0b\u62c9\u5217\u8868\u3002\n- \u9078\u64c7\u60a8\u7684\u7d44\u7e54\u6216\u9805\u76ee\u3002\n- \u9078\u64c7\u81ea\u5b9a\u7fa9\u89d2\u8272\u4e26\u9ede\u64ca **\u505c\u7528** \u3002\n- Titles in dynamic includes are not used anywhere, and we should avoid paying to translate them\u5728 Google Cloud \u63a7\u5236\u6aaf\u4e2d\uff0c\u6fc0\u6d3b Cloud Shell\u3002 [\u6fc0\u6d3b Cloud Shell](https://console.cloud.google.com/?cloudshell=true&hl=zh-cn)  [Cloud Shell](https://cloud.google.com/shell/docs/how-cloud-shell-works?hl=zh-cn) \u6703\u8a71\u96a8\u5373\u6703\u5728 Google Cloud \u63a7\u5236\u6aaf\u7684\u5e95\u90e8\u5553\u52d5\uff0c\u4e26\u986f\u793a\u547d\u4ee4\u884c\u63d0\u793a\u7b26\u3002Cloud Shell \u662f\u4e00\u500b\u5df2\u5b89\u88dd Google Cloud CLI \u4e14\u5df2\u7232\u7576\u524d\u9805\u76ee\u8a2d\u7f6e\u503c\u7684 Shell \u74b0\u5883\u3002\u8a72\u6703\u8a71\u53ef\u80fd\u9700\u8981\u5e7e\u79d2\u9418\u6642\u9593\u4f86\u5b8c\u6210\u521d\u59cb\u5316\u3002\n- \u4f7f\u7528 ` [gcloud iam roles update](https://cloud.google.com/sdk/gcloud/reference/iam/roles/update?hl=zh-cn) ` \u547d\u4ee4\u5c07\u8a72\u89d2\u8272\u7684\u767c\u4f48\u968e\u6bb5\u8a2d\u7f6e\u7232 `DISABLED` \uff0c\u4ee5\u505c\u7528\u81ea\u5b9a\u7fa9\u89d2\u8272\u3002\u60a8\u53ef\u4ee5\u901a\u904e\u4ee5\u4e0b\u5169\u7a2e\u65b9\u5f0f\u66f4\u65b0\u73fe\u6709\u81ea\u5b9a\u7fa9\u89d2\u8272\uff08\u8acb\u53c3\u95b1 [\u4fee\u6539\u73fe\u6709\u81ea\u5b9a\u7fa9\u89d2\u8272](#editing_an_existing_custom_role) \u90e8\u5206\u7684 **gcloud** \u6a19\u7c64\u9801\uff09\uff1a- \u63d0\u4f9b\u5305\u542b\u5df2\u66f4\u65b0\u89d2\u8272\u5b9a\u7fa9\u7684 YAML \u6587\u4ef6\n- \u4f7f\u7528\u6a19\u8a8c\u6307\u5b9a\u66f4\u65b0\u7684\u89d2\u8272\u5b9a\u7fa9\n\u505c\u7528\u73fe\u6709\u81ea\u5b9a\u7fa9\u89d2\u8272\u7684\u6700\u7c21\u55ae\u65b9\u6cd5\u662f\u4f7f\u7528 `--stage` \u6a19\u8a8c\u4e26\u5c07\u5176\u8a2d\u7f6e\u7232 `DISABLED` \u3002\u57f7\u884c\u4ee5\u4e0b\u547d\u4ee4\u4e4b\u4e00\uff1a- \u8981\u505c\u7528\u7d44\u7e54\u7d1a\u5c64\u89d2\u8272\uff0c\u8acb\u57f7\u884c\u4ee5\u4e0b\u547d\u4ee4\uff1a```\ngcloud iam roles update ROLE_ID--organization=ORGANIZATION_ID \\\n --stage=DISABLED\n```\n- \u8981\u505c\u7528\u9805\u76ee\u7d1a\u5c64\u89d2\u8272\uff0c\u8acb\u57f7\u884c\u4ee5\u4e0b\u547d\u4ee4\uff1a```\ngcloud iam roles update ROLE_ID --project=PROJECT_ID \\\n --stage=DISABLED\n```\n\u6bcf\u500b\u4f54\u4f4d\u503c\u7684\u8aaa\u660e\u5982\u4e0b\uff1a- `` \u662f\u89d2\u8272\u7684\u540d\u7a31\uff0c\u4f8b\u5982 `myCompanyAdmin` \u3002\n- `` \u662f\u7d44\u7e54\u7684\u6578\u5b57 ID\uff0c\u4f8b\u5982 `123456789012` \u3002\n- `` \u662f\u9805\u76ee\u7684\u540d\u7a31\uff0c\u4f8b\u5982 `my-project` \u3002\n **\u793a\u4f8b** \u4ee5\u4e0b\u793a\u4f8b\u6f14\u793a\u77ad\u5982\u4f55\u505c\u7528\u7d44\u7e54\u7d1a\u5c64\u89d2\u8272\uff1a```\ngcloud iam roles update myCompanyAdmin --organization=123456789012 \\\n --stage=DISABLED\n```\u5982\u679c\u6210\u529f\u66f4\u65b0\u4e86\u89d2\u8272\uff0c\u5247\u8a72\u547d\u4ee4\u7684\u8f38\u51fa\u985e\u4f3c\u65bc\u4ee5\u4e0b\u5167\u5bb9\uff1a```\ndescription: My custom role description.etag: BwVkB5NLIQw=includedPermissions:- iam.roles.get- iam.roles.listname: organization/123456789012/roles/myCompanyAdminstage: DISABLEDtitle: My Company Admin\n```\u4ee5\u4e0b\u793a\u4f8b\u6f14\u793a\u77ad\u5982\u4f55\u505c\u7528\u9805\u76ee\u7d1a\u5c64\u89d2\u8272\uff1a```\ngcloud iam roles update myCompanyAdmin --project=my-project \\\n --stage=DISABLED\n```\u5982\u679c\u6210\u529f\u66f4\u65b0\u4e86\u89d2\u8272\uff0c\u5247\u8a72\u547d\u4ee4\u7684\u8f38\u51fa\u985e\u4f3c\u65bc\u4ee5\u4e0b\u5167\u5bb9\uff1a```\ndescription: My custom role description.etag: BwVkB5NLIQw=includedPermissions:- iam.roles.get- iam.roles.listname: projects/my-project/roles/myCompanyAdminstage: DISABLEDtitle: My Company Admin\n```\n\u5c07\u8a72\u89d2\u8272\u7684 `stage` \u5b57\u6bb5 [\u66f4\u65b0](https://cloud.google.com/iam/docs/creating-custom-roles?hl=zh-cn#editing_an_existing_custom_role) \u7232 `DISABLED` \u3002\u5c07\u8a72\u89d2\u8272\u7684 `stage` \u5b57\u6bb5 [\u66f4\u65b0](https://cloud.google.com/iam/docs/creating-custom-roles?hl=zh-cn#editing_an_existing_custom_role) \u7232 `DISABLED` \u3002\u5c07\u8a72\u89d2\u8272\u7684 `stage` \u5b57\u6bb5 [\u66f4\u65b0](https://cloud.google.com/iam/docs/creating-custom-roles?hl=zh-cn#editing_an_existing_custom_role) \u7232 `DISABLED` \u3002\u5c07\u8a72\u89d2\u8272\u7684 `stage` \u5b57\u6bb5 [\u66f4\u65b0](https://cloud.google.com/iam/docs/creating-custom-roles?hl=zh-cn#editing_an_existing_custom_role) \u7232 `DISABLED` \u3002\u5c07\u8a72\u89d2\u8272\u7684 `stage` \u5b57\u6bb5 [\u66f4\u65b0](https://cloud.google.com/iam/docs/creating-custom-roles?hl=zh-cn#editing_an_existing_custom_role) \u7232 `DISABLED` \u3002 ` [roles.patch](https://cloud.google.com/iam/docs/reference/rest/v1/projects.roles/patch?hl=zh-cn) ` \u65b9\u6cd5\u53ef\u8b93\u60a8\u5c07\u81ea\u5b9a\u7fa9\u89d2\u8272\u7684\u767c\u4f48\u968e\u6bb5\u66f4\u6539\u7232 `DISABLED` \uff0c\u5f9e\u800c\u505c\u7528\u8a72\u89d2\u8272\u3002\n\u5728\u4f7f\u7528\u4efb\u4f55\u8acb\u6c42\u6578\u64da\u4e4b\u524d\uff0c\u8acb\u5148\u9032\u884c\u4ee5\u4e0b\u66ff\u63db\uff1a- ``\uff1a\u60a8\u8981\u7ba1\u7406\u5176\u81ea\u5b9a\u7fa9\u89d2\u8272\u7684\u8cc7\u6e90\u985e\u578b\u3002\u4f7f\u7528\u503c`projects`\u6216`organizations`\u3002\n- ``\uff1a\u60a8\u8981\u7ba1\u7406\u5176\u81ea\u5b9a\u7fa9\u89d2\u8272\u7684\u9805\u76ee ID \u6216\u7d44\u7e54 ID\u3002\u9805\u76ee ID \u662f\u5b57\u6bcd\u6578\u5b57\u5b57\u7b26\u4e32\uff0c\u4f8b\u5982`my-project`\u3002\u7d44\u7e54 ID \u662f\u6578\u5b57\uff0c\u4f8b\u5982`123456789012`\u3002\n- ``\uff1a\u5b8c\u6574\u7684\u89d2\u8272\u540d\u7a31\uff0c\u5305\u62ec\u4efb\u4f55`organizations/`\u3001`projects/`\u6216`roles/`\u524d\u7db4\u3002\u4f8b\u5982`organizations/123456789012/roles/myCompanyAdmin`\u3002\n- ``\uff1a\u89d2\u8272\u7248\u672c\u7684\u6a19\u8b58\u7b26\u3002\u5305\u542b\u6b64\u5b57\u6bb5\u53ef\u9632\u6b62\u8986\u84cb\u5176\u4ed6\u89d2\u8272\u66f4\u6539\u3002\nHTTP \u65b9\u6cd5\u548c\u7db2\u5740\uff1a\n```\nPATCH https://iam.googleapis.com/v1/RESOURCE_TYPE/RESOURCE_ID/roles\n```\n\u8acb\u6c42 JSON \u6b63\u6587\uff1a\n```\n{\n \"roleId\": \"ROLE_NAME\",\n \"stage\": DISABLED,\n \"etag\": \"ETAG\"\n}\n```\n\u5982\u9700\u767c\u9001\u60a8\u7684\u8acb\u6c42\uff0c\u8acb\u5c55\u958b\u4ee5\u4e0b\u9078\u9805\u4e4b\u4e00\uff1a\n\u60a8\u61c9\u8a72\u6536\u5230\u985e\u4f3c\u4ee5\u4e0b\u5167\u5bb9\u7684 JSON \u97ff\u61c9\uff1a\n```\n{\n \"name\": \"projects/test-project-1000092/roles/myCompanyAdmin\",\n \"stage\": \"DISABLED\",\n \"etag\": \"BwWoyDpAxBc=\"\n}\n```\n[](None)\n## \u5217\u51fa\u89d2\u8272\n\u60a8\u53ef\u4ee5\u5217\u51fa\u5728\u9805\u76ee\u6216\u7d44\u7e54\u4e2d\u5275\u5efa\u7684\u6240\u6709\u81ea\u5b9a\u7fa9\u89d2\u8272\u3002\n\u5728 Google Cloud \u63a7\u5236\u6aaf\u4e2d\uff0c\u8f49\u5230 **\u89d2\u8272** \u9801\u9762\u3002\n [\u8f49\u5230\u201c\u89d2\u8272\u201d\u9801\u9762](https://console.cloud.google.com/iam-admin/roles?hl=zh-cn) \n\u8a72\u9801\u9762\u4e0a\u6703\u5217\u51fa\u60a8\u9078\u64c7\u7684\u7d44\u7e54\u6216\u9805\u76ee\u7684\u6240\u6709\u81ea\u5b9a\u7fa9\u89d2\u8272\u3002- Titles in dynamic includes are not used anywhere, and we should avoid paying to translate them\u5728 Google Cloud \u63a7\u5236\u6aaf\u4e2d\uff0c\u6fc0\u6d3b Cloud Shell\u3002 [\u6fc0\u6d3b Cloud Shell](https://console.cloud.google.com/?cloudshell=true&hl=zh-cn)  [Cloud Shell](https://cloud.google.com/shell/docs/how-cloud-shell-works?hl=zh-cn) \u6703\u8a71\u96a8\u5373\u6703\u5728 Google Cloud \u63a7\u5236\u6aaf\u7684\u5e95\u90e8\u5553\u52d5\uff0c\u4e26\u986f\u793a\u547d\u4ee4\u884c\u63d0\u793a\u7b26\u3002Cloud Shell \u662f\u4e00\u500b\u5df2\u5b89\u88dd Google Cloud CLI \u4e14\u5df2\u7232\u7576\u524d\u9805\u76ee\u8a2d\u7f6e\u503c\u7684 Shell \u74b0\u5883\u3002\u8a72\u6703\u8a71\u53ef\u80fd\u9700\u8981\u5e7e\u79d2\u9418\u6642\u9593\u4f86\u5b8c\u6210\u521d\u59cb\u5316\u3002\n- \u4f7f\u7528 ` [gcloud iam roles list](https://cloud.google.com/sdk/gcloud/reference/iam/roles/list?hl=zh-cn) ` \u547d\u4ee4\u5217\u51fa\u9805\u76ee\u6216\u7d44\u7e54\u7684\u81ea\u5b9a\u7fa9\u89d2\u8272\u548c\u9810\u5b9a\u7fa9\u89d2\u8272\uff1a- \u8981\u5217\u51fa\u7d44\u7e54\u7d1a\u5c64\u81ea\u5b9a\u7fa9\u89d2\u8272\uff0c\u8acb\u57f7\u884c\u4ee5\u4e0b\u547d\u4ee4\uff1a```\ngcloud iam roles list --organization=ORGANIZATION_ID\n```\n- \u8981\u5217\u51fa\u9805\u76ee\u7d1a\u5c64\u81ea\u5b9a\u7fa9\u89d2\u8272\uff0c\u8acb\u57f7\u884c\u4ee5\u4e0b\u547d\u4ee4\uff1a```\ngcloud iam roles list --project=PROJECT_ID\n```\n\u6bcf\u500b\u4f54\u4f4d\u503c\u7684\u8aaa\u660e\u5982\u4e0b\uff1a- `` \u662f\u7d44\u7e54\u7684\u6578\u5b57 ID\uff0c\u4f8b\u5982 `123456789012` \u3002\n- `` \u662f\u9805\u76ee\u7684\u540d\u7a31\uff0c\u4f8b\u5982 `my-project` \u3002\n\u6b64\u5916\uff0c\u9084\u53ef\u4ee5\u6307\u5b9a `--show-deleted` \u6a19\u8a8c\u4ee5\u5217\u51fa\u5df2\u522a\u9664\u7684\u89d2\u8272\u3002\u57f7\u884c\u4ee5\u4e0b\u547d\u4ee4\u53ef\u5217\u51fa\u9810\u5b9a\u7fa9\u89d2\u8272\uff1a```\ngcloud iam roles list\n```\n\u5982\u9700\u77ad\u89e3\u5982\u4f55\u5b89\u88dd\u548c\u4f7f\u7528 IAM \u5ba2\u6236\u7aef\u5eab\uff0c\u8acb\u53c3\u95b1 [IAM \u5ba2\u6236\u7aef\u5eab](https://cloud.google.com/iam/docs/reference/libraries?hl=zh-cn) \u3002\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [IAM C++ API \u53c3\u8003\u6587\u6a94](https://cloud.google.com/cpp/docs/reference/iam/latest?hl=zh-cn) \u3002\n\u5982\u9700\u5411 IAM \u9032\u884c\u8eab\u4efd\u9a57\u8b49\uff0c\u8acb\u8a2d\u7f6e\u61c9\u7528\u9ed8\u8a8d\u6191\u64da\u3002  \u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [\u6e96\u5099\u5de5\u4f5c](#before-you-begin) \u3002\n [\u5728 GitHub \u4e0a\u67e5\u770b](https://github.com/googleapis/google-cloud-cpp/blob/HEAD/google/cloud/iam/samples/iam_samples.cc) \n```\nnamespace iam = ::google::cloud::iam_admin_v1;[](std::string const& project) {\u00a0 iam::IAMClient client(iam::MakeIAMConnection());\u00a0 int count = 0;\u00a0 google::iam::admin::v1::ListRolesRequest request;\u00a0 request.set_parent(project);\u00a0 for (auto& role : client.ListRoles(request)) {\u00a0 \u00a0 if (!role) throw std::move(role).status();\u00a0 \u00a0 std::cout << \"Roles successfully retrieved: \" << role->name() << \"\\n\";\u00a0 \u00a0 ++count;\u00a0 }\u00a0 if (count == 0) {\u00a0 \u00a0 std::cout << \"No roles found in project: \" << project << \"\\n\";\u00a0 }}\n```\u5982\u9700\u77ad\u89e3\u5982\u4f55\u5b89\u88dd\u548c\u4f7f\u7528 IAM \u5ba2\u6236\u7aef\u5eab\uff0c\u8acb\u53c3\u95b1 [IAM \u5ba2\u6236\u7aef\u5eab](https://cloud.google.com/iam/docs/reference/libraries?hl=zh-cn) \u3002\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [IAM C# API \u53c3\u8003\u6587\u6a94](https://developers.google.com/api-client-library/dotnet/apis/iam/v1?hl=zh-cn) \u3002\n\u5982\u9700\u5411 IAM \u9032\u884c\u8eab\u4efd\u9a57\u8b49\uff0c\u8acb\u8a2d\u7f6e\u61c9\u7528\u9ed8\u8a8d\u6191\u64da\u3002  \u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [\u6e96\u5099\u5de5\u4f5c](#before-you-begin) \u3002\n [\u5728 GitHub \u4e0a\u67e5\u770b](https://github.com/GoogleCloudPlatform/dotnet-docs-samples/blob/HEAD/iam/api/CustomRoles/RolesList.cs) \n```\nusing System;using System.Collections.Generic;using Google.Apis.Auth.OAuth2;using Google.Apis.Iam.v1;using Google.Apis.Iam.v1.Data;public partial class CustomRoles{\u00a0 \u00a0 public static IList<Role> ListRoles(string projectId)\u00a0 \u00a0 {\u00a0 \u00a0 \u00a0 \u00a0 var credential = GoogleCredential.GetApplicationDefault()\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 .CreateScoped(IamService.Scope.CloudPlatform);\u00a0 \u00a0 \u00a0 \u00a0 var service = new IamService(new IamService.Initializer\u00a0 \u00a0 \u00a0 \u00a0 {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 HttpClientInitializer = credential\u00a0 \u00a0 \u00a0 \u00a0 });\u00a0 \u00a0 \u00a0 \u00a0 var response = service.Projects.Roles.List(\"projects/\" + projectId)\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 .Execute();\u00a0 \u00a0 \u00a0 \u00a0 foreach (var role in response.Roles)\u00a0 \u00a0 \u00a0 \u00a0 {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 Console.WriteLine(role.Name);\u00a0 \u00a0 \u00a0 \u00a0 }\u00a0 \u00a0 \u00a0 \u00a0 return response.Roles;\u00a0 \u00a0 }}\n```\u5982\u9700\u77ad\u89e3\u5982\u4f55\u5b89\u88dd\u548c\u4f7f\u7528 IAM \u5ba2\u6236\u7aef\u5eab\uff0c\u8acb\u53c3\u95b1 [IAM \u5ba2\u6236\u7aef\u5eab](https://cloud.google.com/iam/docs/reference/libraries?hl=zh-cn) \u3002\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [IAM Go API \u53c3\u8003\u6587\u6a94](https://godoc.org/google.golang.org/genproto/googleapis/iam/admin/v1) \u3002\n\u5982\u9700\u5411 IAM \u9032\u884c\u8eab\u4efd\u9a57\u8b49\uff0c\u8acb\u8a2d\u7f6e\u61c9\u7528\u9ed8\u8a8d\u6191\u64da\u3002  \u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [\u6e96\u5099\u5de5\u4f5c](#before-you-begin) \u3002\n [\u5728 GitHub \u4e0a\u67e5\u770b](https://github.com/GoogleCloudPlatform/golang-samples/blob/HEAD/iam/snippets/roles_list.go) \n```\nimport (\u00a0 \u00a0 \u00a0 \u00a0 \"context\"\u00a0 \u00a0 \u00a0 \u00a0 \"fmt\"\u00a0 \u00a0 \u00a0 \u00a0 \"io\"\u00a0 \u00a0 \u00a0 \u00a0 iam \"google.golang.org/api/iam/v1\")// listRoles lists a project's roles.func listRoles(w io.Writer, projectID string) ([]*iam.Role, error) {\u00a0 \u00a0 \u00a0 \u00a0 ctx := context.Background()\u00a0 \u00a0 \u00a0 \u00a0 service, err := iam.NewService(ctx)\u00a0 \u00a0 \u00a0 \u00a0 if err != nil {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 return nil, fmt.Errorf(\"iam.NewService: %w\", err)\u00a0 \u00a0 \u00a0 \u00a0 }\u00a0 \u00a0 \u00a0 \u00a0 response, err := service.Projects.Roles.List(\"projects/\" + projectID).Do()\u00a0 \u00a0 \u00a0 \u00a0 if err != nil {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 return nil, fmt.Errorf(\"Projects.Roles.List: %w\", err)\u00a0 \u00a0 \u00a0 \u00a0 }\u00a0 \u00a0 \u00a0 \u00a0 for _, role := range response.Roles {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 fmt.Fprintf(w, \"Listing role: %v\\n\", role.Name)\u00a0 \u00a0 \u00a0 \u00a0 }\u00a0 \u00a0 \u00a0 \u00a0 return response.Roles, nil}\n```\u5982\u9700\u77ad\u89e3\u5982\u4f55\u5b89\u88dd\u548c\u4f7f\u7528 IAM \u5ba2\u6236\u7aef\u5eab\uff0c\u8acb\u53c3\u95b1 [IAM \u5ba2\u6236\u7aef\u5eab](https://cloud.google.com/iam/docs/reference/libraries?hl=zh-cn) \u3002\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [IAM Java API \u53c3\u8003\u6587\u6a94](https://developers.google.com/api-client-library/java/apis/iam/v1?hl=zh-cn) \u3002\n\u5982\u9700\u5411 IAM \u9032\u884c\u8eab\u4efd\u9a57\u8b49\uff0c\u8acb\u8a2d\u7f6e\u61c9\u7528\u9ed8\u8a8d\u6191\u64da\u3002  \u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [\u6e96\u5099\u5de5\u4f5c](#before-you-begin) \u3002\n [\u5728 GitHub \u4e0a\u67e5\u770b](https://github.com/GoogleCloudPlatform/java-docs-samples/blob/HEAD/iam/snippets/src/main/java/ListRoles.java) \n```\nimport com.google.cloud.iam.admin.v1.IAMClient;import com.google.cloud.iam.admin.v1.IAMClient.ListRolesPagedResponse;import com.google.iam.admin.v1.ListRolesRequest;import java.io.IOException;/** List roles in a project. */public class ListRoles {\u00a0 public static void main(String[] args) throws IOException {\u00a0 \u00a0 // TODO(developer): Replace the variable before running the sample.\u00a0 \u00a0 String projectId = \"your-project-id\";\u00a0 \u00a0 listRoles(projectId);\u00a0 }\u00a0 public static void listRoles(String projectId) throws IOException {\u00a0 \u00a0 ListRolesRequest listRolesRequest =\u00a0 \u00a0 \u00a0 \u00a0 ListRolesRequest.newBuilder().setParent(\"projects/\" + projectId).build();\u00a0 \u00a0 // Initialize client for sending requests. This client only needs to be created\u00a0 \u00a0 // once, and can be reused for multiple requests.\u00a0 \u00a0 try (IAMClient iamClient = IAMClient.create()) {\u00a0 \u00a0 \u00a0 ListRolesPagedResponse listRolesResponse = iamClient.listRoles(listRolesRequest);\u00a0 \u00a0 \u00a0 listRolesResponse.iterateAll().forEach(role -> System.out.println(role));\u00a0 \u00a0 }\u00a0 }}\n```\u5982\u9700\u77ad\u89e3\u5982\u4f55\u5b89\u88dd\u548c\u4f7f\u7528 IAM \u5ba2\u6236\u7aef\u5eab\uff0c\u8acb\u53c3\u95b1 [IAM \u5ba2\u6236\u7aef\u5eab](https://cloud.google.com/iam/docs/reference/libraries?hl=zh-cn) \u3002\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [IAM Python API \u53c3\u8003\u6587\u6a94](https://developers.google.com/api-client-library/python/apis/iam/v1?hl=zh-cn) \u3002\n\u5982\u9700\u5411 IAM \u9032\u884c\u8eab\u4efd\u9a57\u8b49\uff0c\u8acb\u8a2d\u7f6e\u61c9\u7528\u9ed8\u8a8d\u6191\u64da\u3002  \u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [\u6e96\u5099\u5de5\u4f5c](#before-you-begin) \u3002\n [\u5728 GitHub \u4e0a\u67e5\u770b](https://github.com/GoogleCloudPlatform/python-docs-samples/blob/HEAD/iam/api-client/custom_roles.py) \n```\ndef list_roles(project_id: str) -> None:\u00a0 \u00a0 \"\"\"Lists roles.\"\"\"\u00a0 \u00a0 # pylint: disable=no-member\u00a0 \u00a0 roles = service.roles().list(parent=\"projects/\" + project_id).execute()[\"roles\"]\u00a0 \u00a0 for role in roles:\u00a0 \u00a0 \u00a0 \u00a0 print(role[\"name\"])\n``` ` [roles.list](https://cloud.google.com/iam/docs/reference/rest/v1/projects.roles/list?hl=zh-cn) ` \u65b9\u6cd5\u53ef\u5217\u51fa\u9805\u76ee\u6216\u7d44\u7e54\u4e2d\u7684\u6240\u6709\u81ea\u5b9a\u7fa9\u89d2\u8272\u3002\n\u5728\u4f7f\u7528\u4efb\u4f55\u8acb\u6c42\u6578\u64da\u4e4b\u524d\uff0c\u8acb\u5148\u9032\u884c\u4ee5\u4e0b\u66ff\u63db\uff1a- ``\uff1a\u60a8\u8981\u7ba1\u7406\u5176\u81ea\u5b9a\u7fa9\u89d2\u8272\u7684\u8cc7\u6e90\u985e\u578b\u3002\u4f7f\u7528\u503c`projects`\u6216`organizations`\u3002\n- ``\uff1a\u60a8\u8981\u7ba1\u7406\u5176\u81ea\u5b9a\u7fa9\u89d2\u8272\u7684\u9805\u76ee ID \u6216\u7d44\u7e54 ID\u3002\u9805\u76ee ID \u662f\u5b57\u6bcd\u6578\u5b57\u5b57\u7b26\u4e32\uff0c\u4f8b\u5982`my-project`\u3002\u7d44\u7e54 ID \u662f\u6578\u5b57\uff0c\u4f8b\u5982`123456789012`\u3002\n- ``\uff1a\u53ef\u9078\u3002\u8981\u7232\u8fd4\u56de\u7684\u89d2\u8272\u5305\u542b\u7684\u4fe1\u606f\u3002\u8981\u5305\u542b\u89d2\u8272\u7684\u6b0a\u9650\uff0c\u8acb\u5c07\u6b64\u5b57\u6bb5\u8a2d\u7f6e\u7232`FULL`\u3002\u8981\u6392\u9664\u89d2\u8272\u7684\u6b0a\u9650\uff0c\u8acb\u5c07\u6b64\u5b57\u6bb5\u8a2d\u7f6e\u7232`BASIC`\u3002\u9ed8\u8a8d\u503c\u7232`BASIC`\u3002\n- ``\uff1a\u53ef\u9078\u3002\u8981\u5305\u542b\u5728\u97ff\u61c9\u4e2d\u7684\u89d2\u8272\u7684\u6578\u91cf\u3002\u9ed8\u8a8d\u503c\u7232 300\uff0c\u6700\u5927\u503c\u7232 1000\u3002\u5982\u679c\u89d2\u8272\u6578\u5927\u65bc\u9801\u9762\u5927\u5c0f\uff0c\u5247\u97ff\u61c9\u4e2d\u6703\u5305\u542b\u5206\u9801\u4ee4\u724c\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528\u8a72\u4ee4\u724c\u6aa2\u7d22\u4e0b\u4e00\u9801\u7d50\u679c\u3002\n- ``\uff1a\u53ef\u9078\u3002\u6b64\u65b9\u6cd5\u4e4b\u524d\u7684\u97ff\u61c9\u4e2d\u8fd4\u56de\u7684\u5206\u9801\u4ee4\u724c\u3002\u5982\u679c\u5df2\u6307\u5b9a\uff0c\u5247\u89d2\u8272\u5217\u8868\u5c07\u5f9e\u4e0a\u4e00\u500b\u8acb\u6c42\u7d50\u675f\u7684\u4f4d\u7f6e\u958b\u59cb\u3002\n **\u6ce8\u610f** \uff1a\u8981\u5217\u51fa\u6240\u6709\u9810\u5b9a\u7fa9\u7684 IAM \u89d2\u8272\uff0c\u8acb\u7701\u7565``\u548c``\u5b57\u6bb5\u3002\u4f8b\u5982\uff1a`GET https://iam.googleapis.com/v1/roles`\u3002\nHTTP \u65b9\u6cd5\u548c\u7db2\u5740\uff1a\n```\nGET https://iam.googleapis.com/v1/RESOURCE_TYPE/RESOURCE_ID/roles?view=ROLE_VIEW&pageSize=PAGE_SIZE&pageToken=NEXT_PAGE_TOKEN\n```\n\u5982\u9700\u767c\u9001\u60a8\u7684\u8acb\u6c42\uff0c\u8acb\u5c55\u958b\u4ee5\u4e0b\u9078\u9805\u4e4b\u4e00\uff1a\n\u60a8\u61c9\u8a72\u6536\u5230\u985e\u4f3c\u4ee5\u4e0b\u5167\u5bb9\u7684 JSON \u97ff\u61c9\uff1a\n```\n{\n \"roles\": [ {\n  \"name\": \"projects/my-project/roles/customRole1\",\n  \"title\": \"First Custom Role\",\n  \"description\": \"Created on: 2020-06-01\",\n  \"etag\": \"BwWiPg2fmDE=\"\n },\n {\n  \"name\": \"projects/my-project/roles/customRole2\",\n  \"title\": \"Second Custom Role\",\n  \"description\": \"Created on: 2020-06-07\",\n  \"etag\": \"BwWiuX53Wi0=\"\n }\n ]\n}\n```\n[](None)\n## \u522a\u9664\u81ea\u5b9a\u7fa9\u89d2\u8272\n\u60a8\u53ef\u4ee5\u522a\u9664\u9805\u76ee\u6216\u7d44\u7e54\u4e2d\u7684\u4efb\u4f55\u81ea\u5b9a\u7fa9\u89d2\u8272\u3002\n**\u91cd\u8981\u63d0\u793a** \uff1a\u5df2\u522a\u9664\u7684\u89d2\u8272\u8655\u65bc\u66ab\u505c\u72c0\u614b\uff0c\u7121\u6cd5\u7528\u65bc\u5728\u5141\u8a31\u653f\u7b56\u4e2d\u5275\u5efa\u65b0\u7684\u89d2\u8272\u7d81\u5b9a\u3002\u5305\u542b\u5df2\u522a\u9664\u89d2\u8272\u7684\u73fe\u6709\u89d2\u8272\u7d81\u5b9a\u5c07\u7121\u6548\u3002\n- \u5728 Google Cloud \u63a7\u5236\u6aaf\u4e2d\uff0c\u8f49\u5230 **\u89d2\u8272** \u9801\u9762\u3002 [\u8f49\u5230\u201c\u89d2\u8272\u201d\u9801\u9762](https://console.cloud.google.com/iam-admin/roles?hl=zh-cn) \n- \u9078\u64c7\u8981\u522a\u9664\u7684\u89d2\u8272\uff0c\u7136\u5f8c\u9ede\u64ca\u9801\u9762\u9802\u90e8\u7684 **\u522a\u9664** \u3002\n- Titles in dynamic includes are not used anywhere, and we should avoid paying to translate them\u5728 Google Cloud \u63a7\u5236\u6aaf\u4e2d\uff0c\u6fc0\u6d3b Cloud Shell\u3002 [\u6fc0\u6d3b Cloud Shell](https://console.cloud.google.com/?cloudshell=true&hl=zh-cn)  [Cloud Shell](https://cloud.google.com/shell/docs/how-cloud-shell-works?hl=zh-cn) \u6703\u8a71\u96a8\u5373\u6703\u5728 Google Cloud \u63a7\u5236\u6aaf\u7684\u5e95\u90e8\u5553\u52d5\uff0c\u4e26\u986f\u793a\u547d\u4ee4\u884c\u63d0\u793a\u7b26\u3002Cloud Shell \u662f\u4e00\u500b\u5df2\u5b89\u88dd Google Cloud CLI \u4e14\u5df2\u7232\u7576\u524d\u9805\u76ee\u8a2d\u7f6e\u503c\u7684 Shell \u74b0\u5883\u3002\u8a72\u6703\u8a71\u53ef\u80fd\u9700\u8981\u5e7e\u79d2\u9418\u6642\u9593\u4f86\u5b8c\u6210\u521d\u59cb\u5316\u3002\n- \u4f7f\u7528 ` [gcloud iam roles delete](https://cloud.google.com/sdk/gcloud/reference/iam/roles/delete?hl=zh-cn) ` \u547d\u4ee4\u522a\u9664\u81ea\u5b9a\u7fa9\u89d2\u8272\uff1a- \u8981\u522a\u9664\u7d44\u7e54\u7d1a\u5c64\u81ea\u5b9a\u7fa9\u89d2\u8272\uff0c\u8acb\u57f7\u884c\u4ee5\u4e0b\u547d\u4ee4\uff1a```\ngcloud iam roles delete ROLE_ID --organization=ORGANIZATION_ID\n```\n- \u8981\u522a\u9664\u9805\u76ee\u7d1a\u5c64\u81ea\u5b9a\u7fa9\u89d2\u8272\uff0c\u8acb\u57f7\u884c\u4ee5\u4e0b\u547d\u4ee4\uff1a```\ngcloud iam roles delete ROLE_ID --project=PROJECT_ID\n```\n\u6bcf\u500b\u4f54\u4f4d\u503c\u7684\u8aaa\u660e\u5982\u4e0b\uff1a- `` \u662f\u89d2\u8272\u7684\u540d\u7a31\uff0c\u4f8b\u5982 `myCompanyAdmin` \u3002\n- `` \u662f\u7d44\u7e54\u7684\u6578\u5b57 ID\uff0c\u4f8b\u5982 `123456789012` \u3002\n- `` \u662f\u9805\u76ee\u7684\u540d\u7a31\uff0c\u4f8b\u5982 `my-project` \u3002\n\u9664\u975e\u4f7f\u7528 `--show-deleted` \u6a19\u8a8c\uff0c\u5426\u5247\u522a\u9664\u7684\u89d2\u8272\u5c07\u4e0d\u6703\u5305\u542b\u5728 `gcloud iam roles list` \u4e2d\u3002\u5728 `list` \u97ff\u61c9\u4e2d\uff0c\u522a\u9664\u7684\u89d2\u8272\u4ee5 `deleted: true` \u584a\u8868\u793a\uff0c\u4f8b\u5982\uff1a```\n--deleted: true\ndescription: My custom role description.\netag: BwVkB5NLIQw=\nname: projects/my-project/roles/myCompanyAdmin\ntitle: My Company Admin\n--\n```\n\u5982\u9700\u77ad\u89e3\u5982\u4f55\u5b89\u88dd\u548c\u4f7f\u7528 IAM \u5ba2\u6236\u7aef\u5eab\uff0c\u8acb\u53c3\u95b1 [IAM \u5ba2\u6236\u7aef\u5eab](https://cloud.google.com/iam/docs/reference/libraries?hl=zh-cn) \u3002\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [IAM C++ API \u53c3\u8003\u6587\u6a94](https://cloud.google.com/cpp/docs/reference/iam/latest?hl=zh-cn) \u3002\n\u5982\u9700\u5411 IAM \u9032\u884c\u8eab\u4efd\u9a57\u8b49\uff0c\u8acb\u8a2d\u7f6e\u61c9\u7528\u9ed8\u8a8d\u6191\u64da\u3002  \u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [\u6e96\u5099\u5de5\u4f5c](#before-you-begin) \u3002\n [\u5728 GitHub \u4e0a\u67e5\u770b](https://github.com/googleapis/google-cloud-cpp/blob/HEAD/google/cloud/iam/samples/iam_samples.cc) \n```\nnamespace iam = ::google::cloud::iam_admin_v1;[](std::string const& name) {\u00a0 iam::IAMClient client(iam::MakeIAMConnection());\u00a0 google::iam::admin::v1::DeleteRoleRequest request;\u00a0 request.set_name(name);\u00a0 auto response = client.DeleteRole(request);\u00a0 if (!response) throw std::move(response).status();\u00a0 std::cout << \"Role successfully deleted: \" << response->DebugString()\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 << \"\\n\";}\n```\u5982\u9700\u77ad\u89e3\u5982\u4f55\u5b89\u88dd\u548c\u4f7f\u7528 IAM \u5ba2\u6236\u7aef\u5eab\uff0c\u8acb\u53c3\u95b1 [IAM \u5ba2\u6236\u7aef\u5eab](https://cloud.google.com/iam/docs/reference/libraries?hl=zh-cn) \u3002\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [IAM C# API \u53c3\u8003\u6587\u6a94](https://developers.google.com/api-client-library/dotnet/apis/iam/v1?hl=zh-cn) \u3002\n\u5982\u9700\u5411 IAM \u9032\u884c\u8eab\u4efd\u9a57\u8b49\uff0c\u8acb\u8a2d\u7f6e\u61c9\u7528\u9ed8\u8a8d\u6191\u64da\u3002  \u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [\u6e96\u5099\u5de5\u4f5c](#before-you-begin) \u3002\n [\u5728 GitHub \u4e0a\u67e5\u770b](https://github.com/GoogleCloudPlatform/dotnet-docs-samples/blob/HEAD/iam/api/CustomRoles/RolesDelete.cs) \n```\nusing System;using Google.Apis.Auth.OAuth2;using Google.Apis.Iam.v1;using Google.Apis.Iam.v1.Data;public partial class CustomRoles{\u00a0 \u00a0 public static void DeleteRole(string name, string projectId)\u00a0 \u00a0 {\u00a0 \u00a0 \u00a0 \u00a0 var credential = GoogleCredential.GetApplicationDefault()\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 .CreateScoped(IamService.Scope.CloudPlatform);\u00a0 \u00a0 \u00a0 \u00a0 var service = new IamService(new IamService.Initializer\u00a0 \u00a0 \u00a0 \u00a0 {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 HttpClientInitializer = credential\u00a0 \u00a0 \u00a0 \u00a0 });\u00a0 \u00a0 \u00a0 \u00a0 service.Projects.Roles.Delete(\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 $\"projects/{projectId}/roles/{name}\").Execute();\u00a0 \u00a0 \u00a0 \u00a0 Console.WriteLine(\"Deleted role: \" + name);\u00a0 \u00a0 }}\n```\u5982\u9700\u77ad\u89e3\u5982\u4f55\u5b89\u88dd\u548c\u4f7f\u7528 IAM \u5ba2\u6236\u7aef\u5eab\uff0c\u8acb\u53c3\u95b1 [IAM \u5ba2\u6236\u7aef\u5eab](https://cloud.google.com/iam/docs/reference/libraries?hl=zh-cn) \u3002\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [IAM Go API \u53c3\u8003\u6587\u6a94](https://godoc.org/google.golang.org/genproto/googleapis/iam/admin/v1) \u3002\n\u5982\u9700\u5411 IAM \u9032\u884c\u8eab\u4efd\u9a57\u8b49\uff0c\u8acb\u8a2d\u7f6e\u61c9\u7528\u9ed8\u8a8d\u6191\u64da\u3002  \u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [\u6e96\u5099\u5de5\u4f5c](#before-you-begin) \u3002\n [\u5728 GitHub \u4e0a\u67e5\u770b](https://github.com/GoogleCloudPlatform/golang-samples/blob/HEAD/iam/snippets/roles_delete.go) \n```\nimport (\u00a0 \u00a0 \u00a0 \u00a0 \"context\"\u00a0 \u00a0 \u00a0 \u00a0 \"fmt\"\u00a0 \u00a0 \u00a0 \u00a0 \"io\"\u00a0 \u00a0 \u00a0 \u00a0 iam \"google.golang.org/api/iam/v1\")// deleteRole deletes a custom role.func deleteRole(w io.Writer, projectID, name string) error {\u00a0 \u00a0 \u00a0 \u00a0 ctx := context.Background()\u00a0 \u00a0 \u00a0 \u00a0 service, err := iam.NewService(ctx)\u00a0 \u00a0 \u00a0 \u00a0 if err != nil {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 return fmt.Errorf(\"iam.NewService: %w\", err)\u00a0 \u00a0 \u00a0 \u00a0 }\u00a0 \u00a0 \u00a0 \u00a0 _, err = service.Projects.Roles.Delete(\"projects/\" + projectID + \"/roles/\" + name).Do()\u00a0 \u00a0 \u00a0 \u00a0 if err != nil {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 return fmt.Errorf(\"Projects.Roles.Delete: %w\", err)\u00a0 \u00a0 \u00a0 \u00a0 }\u00a0 \u00a0 \u00a0 \u00a0 fmt.Fprintf(w, \"Deleted role: %v\", name)\u00a0 \u00a0 \u00a0 \u00a0 return nil}\n```\u5982\u9700\u77ad\u89e3\u5982\u4f55\u5b89\u88dd\u548c\u4f7f\u7528 IAM \u5ba2\u6236\u7aef\u5eab\uff0c\u8acb\u53c3\u95b1 [IAM \u5ba2\u6236\u7aef\u5eab](https://cloud.google.com/iam/docs/reference/libraries?hl=zh-cn) \u3002\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [IAM Java API \u53c3\u8003\u6587\u6a94](https://developers.google.com/api-client-library/java/apis/iam/v1?hl=zh-cn) \u3002\n\u5982\u9700\u5411 IAM \u9032\u884c\u8eab\u4efd\u9a57\u8b49\uff0c\u8acb\u8a2d\u7f6e\u61c9\u7528\u9ed8\u8a8d\u6191\u64da\u3002  \u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [\u6e96\u5099\u5de5\u4f5c](#before-you-begin) \u3002\n [\u5728 GitHub \u4e0a\u67e5\u770b](https://github.com/GoogleCloudPlatform/java-docs-samples/blob/HEAD/iam/snippets/src/main/java/DeleteRole.java) \n```\nimport com.google.cloud.iam.admin.v1.IAMClient;import com.google.iam.admin.v1.DeleteRoleRequest;import java.io.IOException;/** Delete role. */public class DeleteRole {\u00a0 public static void main(String[] args) throws IOException {\u00a0 \u00a0 // TODO(developer): Replace the variables before running the sample.\u00a0 \u00a0 // Role ID must point to an existing role.\u00a0 \u00a0 String projectId = \"your-project-id\";\u00a0 \u00a0 String roleId = \"a unique identifier (e.g. testViewer)\";\u00a0 \u00a0 deleteRole(projectId, roleId);\u00a0 }\u00a0 public static void deleteRole(String projectId, String roleId) throws IOException {\u00a0 \u00a0 String roleName = \"projects/\" + projectId + \"/roles/\" + roleId;\u00a0 \u00a0 DeleteRoleRequest deleteRoleRequest = DeleteRoleRequest.newBuilder().setName(roleName).build();\u00a0 \u00a0 // Initialize client for sending requests. This client only needs to be created\u00a0 \u00a0 // once, and can be reused for multiple requests.\u00a0 \u00a0 try (IAMClient iamClient = IAMClient.create()) {\u00a0 \u00a0 \u00a0 iamClient.deleteRole(deleteRoleRequest);\u00a0 \u00a0 \u00a0 System.out.println(\"Role deleted.\");\u00a0 \u00a0 }\u00a0 }}\n```\u5982\u9700\u77ad\u89e3\u5982\u4f55\u5b89\u88dd\u548c\u4f7f\u7528 IAM \u5ba2\u6236\u7aef\u5eab\uff0c\u8acb\u53c3\u95b1 [IAM \u5ba2\u6236\u7aef\u5eab](https://cloud.google.com/iam/docs/reference/libraries?hl=zh-cn) \u3002\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [IAM Python API \u53c3\u8003\u6587\u6a94](https://developers.google.com/api-client-library/python/apis/iam/v1?hl=zh-cn) \u3002\n\u5982\u9700\u5411 IAM \u9032\u884c\u8eab\u4efd\u9a57\u8b49\uff0c\u8acb\u8a2d\u7f6e\u61c9\u7528\u9ed8\u8a8d\u6191\u64da\u3002  \u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [\u6e96\u5099\u5de5\u4f5c](#before-you-begin) \u3002\n [\u5728 GitHub \u4e0a\u67e5\u770b](https://github.com/GoogleCloudPlatform/python-docs-samples/blob/HEAD/iam/api-client/custom_roles.py) \n```\ndef delete_role(name: str, project: str) -> dict:\u00a0 \u00a0 \"\"\"Deletes a role.\"\"\"\u00a0 \u00a0 # pylint: disable=no-member\u00a0 \u00a0 role = (\u00a0 \u00a0 \u00a0 \u00a0 service.projects()\u00a0 \u00a0 \u00a0 \u00a0 .roles()\u00a0 \u00a0 \u00a0 \u00a0 .delete(name=\"projects/\" + project + \"/roles/\" + name)\u00a0 \u00a0 \u00a0 \u00a0 .execute()\u00a0 \u00a0 )\u00a0 \u00a0 print(\"Deleted role: \" + name)\u00a0 \u00a0 return role\n``` ` [roles.delete](https://cloud.google.com/iam/docs/reference/rest/v1/projects.roles/delete?hl=zh-cn) ` \u65b9\u6cd5\u53ef\u522a\u9664\u9805\u76ee\u6216\u7d44\u7e54\u4e2d\u7684\u81ea\u5b9a\u7fa9\u89d2\u8272\u3002\n\u5728\u4f7f\u7528\u4efb\u4f55\u8acb\u6c42\u6578\u64da\u4e4b\u524d\uff0c\u8acb\u5148\u9032\u884c\u4ee5\u4e0b\u66ff\u63db\uff1a- ``\uff1a\u5b8c\u6574\u7684\u89d2\u8272\u540d\u7a31\uff0c\u5305\u62ec\u4efb\u4f55`organizations/`\u3001`projects/`\u6216`roles/`\u524d\u7db4\u3002\u4f8b\u5982`organizations/123456789012/roles/myCompanyAdmin`\u3002\nHTTP \u65b9\u6cd5\u548c\u7db2\u5740\uff1a\n```\nDELETE https://iam.googleapis.com/v1/ROLE_NAME\n```\n\u5982\u9700\u767c\u9001\u60a8\u7684\u8acb\u6c42\uff0c\u8acb\u5c55\u958b\u4ee5\u4e0b\u9078\u9805\u4e4b\u4e00\uff1a\n\u97ff\u61c9\u4e2d\u5305\u542b\u5df2\u522a\u9664\u7684\u89d2\u8272\u7684\u5b9a\u7fa9\u3002\n```\n{\n \"name\": \"projects/my-project/roles/myCompanyAdmin\",\n \"title\": \"My Company Admin\",\n \"description\": \"My custom role description.\",\n \"includedPermissions\": [ \"iam.roles.get\",\n \"iam.roles.list\"\n ],\n \"etag\": \"BwWiPg2fmDE=\",\n \"deleted\": true\n}\n```\n\u89d2\u8272\u88ab\u522a\u9664\u5f8c\uff0c\u5f15\u7528\u8a72\u89d2\u8272\u7684\u4efb\u4f55\u89d2\u8272\u7d81\u5b9a\u90fd\u5c07\u4fdd\u7559\u5728\u5141\u8a31\u653f\u7b56\u4e2d\uff0c\u4f46\u8655\u65bc\u7121\u6548\u72c0\u614b\u3002\u60a8\u53ef\u4ee5\u5728 7 \u5929\u5167\u6062\u5fa9\u522a\u9664\u7684\u89d2\u8272\u3002\u5728\u9019 7 \u5929\u5167\uff0cGoogle Cloud \u63a7\u5236\u6aaf\u6703\u986f\u793a\u8a72\u89d2\u8272\u5df2\u88ab\u522a\u9664\u3002\u60a8\u4e5f\u53ef\u4ee5\u4ee5\u7de8\u7a0b\u65b9\u5f0f\u5217\u51fa\u5df2\u522a\u9664\u7684\u89d2\u8272\uff0c\u4f46\u9ed8\u8a8d\u60c5\u6cc1\u4e0b\u5b83\u5011\u6703\u88ab\u5ffd\u7565\u3002\n7 \u5230 14 \u5929\u540e\uff0c\u7cfb\u7d71\u5c07\u5b89\u6392\u6c38\u4e45\u522a\u9664\u8a72\u89d2\u8272\u3002\u6b64\u6642\uff0c\u8a72\u89d2\u8272\u4e0d\u518d\u8a08\u5165\u6bcf\u500b\u7d44\u7e54 300 \u500b\u81ea\u5b9a\u7fa9\u89d2\u8272\u6216\u6bcf\u500b\u9805\u76ee 300 \u500b\u81ea\u5b9a\u7fa9\u89d2\u8272\u7684\u9650\u984d\u3002\n**\u6ce8\u610f** \uff1a\u5728\u9805\u76ee\u4e2d\u5275\u5efa\u7684\u81ea\u5b9a\u7fa9\u89d2\u8272\u4e0d\u6703\u8a08\u5165\u60a8\u7d44\u7e54\u7684\u81ea\u5b9a\u7fa9\u89d2\u8272\u9650\u984d\u3002\n\u6c38\u4e45\u6027\u522a\u9664\u904e\u7a0b\u6703\u6301\u7e8c 30 \u5929\u3002\u5728 30 \u5929\u7684\u7a97\u53e3\u671f\u5167\uff0c\u8a72\u89d2\u8272\u548c\u8207\u4e4b\u95dc\u806f\u7684\u6240\u6709\u7d81\u5b9a\u90fd\u5c07\u88ab\u6c38\u4e45\u79fb\u9664\uff0c\u4e26\u4e14\u6b64\u671f\u9593\u60a8\u7121\u6cd5\u4f7f\u7528\u76f8\u540c\u7684\u89d2\u8272 ID \u5275\u5efa\u65b0\u89d2\u8272\u3002\n\u8a72\u89d2\u8272\u88ab\u6c38\u4e45\u522a\u9664\u4e4b\u5f8c\uff0c\u4e5f\u5c31\u662f\u81ea\u521d\u59cb\u522a\u9664\u8acb\u6c42\u8d77 44 \u5929\u540e\uff0c\u60a8\u65b9\u53ef\u4f7f\u7528\u76f8\u540c\u7684\u89d2\u8272 ID \u5275\u5efa\u65b0\u89d2\u8272\u3002\n[](None)\n## \u6062\u5fa9\u522a\u9664\u81ea\u5b9a\u7fa9\u89d2\u8272\n\u6062\u5fa9\u522a\u9664\u7684\u89d2\u8272\u53ef\u5c07\u89d2\u8272\u6062\u5fa9\u5230\u5176\u4e4b\u524d\u7684\u72c0\u614b\u3002\n\u60a8\u53ea\u80fd\u5728 7 \u5929\u5167\u6062\u5fa9\u522a\u9664\u7684\u89d2\u8272\u30027 \u5929\u540e\uff0c\u8a72\u89d2\u8272\u53ef\u4ee5\u96a8\u6642\u88ab\u6c38\u4e45\u522a\u9664\uff0c\u4e26\u4e14\u7cfb\u7d71\u6703\u79fb\u9664\u5f15\u7528\u8a72\u89d2\u8272\u7684\u6240\u6709\u89d2\u8272\u7d81\u5b9a\u3002\n- \u5728 Google Cloud \u63a7\u5236\u6aaf\u4e2d\uff0c\u8f49\u5230 **\u89d2\u8272** \u9801\u9762\u3002 [\u8f49\u5230\u201c\u89d2\u8272\u201d\u9801\u9762](https://console.cloud.google.com/iam-admin/roles?hl=zh-cn) \n- \u627e\u5230\u8981\u6062\u5fa9\u7684\u5df2\u522a\u9664\u89d2\u8272\uff0c\u9ede\u64ca\u884c\u672b\u5c3e\u7684\u66f4\u591a\u5716\u6a19\uff0c\u7136\u5f8c\u9ede\u64ca **\u6062\u5fa9\u522a\u9664** \u3002\n- Titles in dynamic includes are not used anywhere, and we should avoid paying to translate them\u5728 Google Cloud \u63a7\u5236\u6aaf\u4e2d\uff0c\u6fc0\u6d3b Cloud Shell\u3002 [\u6fc0\u6d3b Cloud Shell](https://console.cloud.google.com/?cloudshell=true&hl=zh-cn)  [Cloud Shell](https://cloud.google.com/shell/docs/how-cloud-shell-works?hl=zh-cn) \u6703\u8a71\u96a8\u5373\u6703\u5728 Google Cloud \u63a7\u5236\u6aaf\u7684\u5e95\u90e8\u5553\u52d5\uff0c\u4e26\u986f\u793a\u547d\u4ee4\u884c\u63d0\u793a\u7b26\u3002Cloud Shell \u662f\u4e00\u500b\u5df2\u5b89\u88dd Google Cloud CLI \u4e14\u5df2\u7232\u7576\u524d\u9805\u76ee\u8a2d\u7f6e\u503c\u7684 Shell \u74b0\u5883\u3002\u8a72\u6703\u8a71\u53ef\u80fd\u9700\u8981\u5e7e\u79d2\u9418\u6642\u9593\u4f86\u5b8c\u6210\u521d\u59cb\u5316\u3002\n- \u4f7f\u7528 ` [gcloud iam roles undelete](https://cloud.google.com/sdk/gcloud/reference/iam/roles/delete?hl=zh-cn) ` \u547d\u4ee4\u6062\u5fa9\u522a\u9664\u7684\u81ea\u5b9a\u7fa9\u89d2\u8272\uff1a- \u8981\u6062\u5fa9\u522a\u9664\u7684\u7d44\u7e54\u7d1a\u5c64\u81ea\u5b9a\u7fa9\u89d2\u8272\uff0c\u8acb\u57f7\u884c\u4ee5\u4e0b\u547d\u4ee4\uff1a```\ngcloud iam roles undelete ROLE_ID --organization=ORGANIZATION_ID\n```\n- \u8981\u6062\u5fa9\u522a\u9664\u7684\u9805\u76ee\u7d1a\u5c64\u81ea\u5b9a\u7fa9\u89d2\u8272\uff0c\u8acb\u57f7\u884c\u4ee5\u4e0b\u547d\u4ee4\uff1a```\ngcloud iam roles undelete ROLE_ID --project=PROJECT_ID\n```\n\u6bcf\u500b\u4f54\u4f4d\u503c\u7684\u8aaa\u660e\u5982\u4e0b\uff1a- `` \u662f\u89d2\u8272\u7684\u540d\u7a31\uff0c\u4f8b\u5982 `myCompanyAdmin` \u3002\n- `` \u662f\u7d44\u7e54\u7684\u6578\u5b57 ID\uff0c\u4f8b\u5982 `123456789012` \u3002\n- `` \u662f\u9805\u76ee\u7684\u540d\u7a31\uff0c\u4f8b\u5982 `my-project` \u3002\n **\u793a\u4f8b** \u4ee5\u4e0b\u793a\u4f8b\u6f14\u793a\u77ad\u5982\u4f55\u6062\u5fa9\u522a\u9664\u7684\u7d44\u7e54\u7d1a\u5c64\u81ea\u5b9a\u7fa9\u89d2\u8272\uff1a```\ngcloud iam roles undelete myCompanyAdmin --organization=123456789012\n```\u5982\u679c\u6210\u529f\u6062\u5fa9\u4e86\u522a\u9664\u7684\u89d2\u8272\uff0c\u5247\u8a72\u547d\u4ee4\u7684\u8f38\u51fa\u985e\u4f3c\u65bc\u4ee5\u4e0b\u5167\u5bb9\uff1a```\ndescription: My custom role description.etag: BwVkCAx9W6w=includedPermissions:- iam.roles.get- iam.roles.listname: organization/123456789012/roles/myCompanyAdminstage: ALPHAtitle: My Company Admin\n```\u4ee5\u4e0b\u793a\u4f8b\u6f14\u793a\u77ad\u5982\u4f55\u6062\u5fa9\u522a\u9664\u7684\u9805\u76ee\u7d1a\u5c64\u81ea\u5b9a\u7fa9\u89d2\u8272\uff1a```\ngcloud iam roles undelete myCompanyAdmin --project=my-project\n```\u5982\u679c\u6210\u529f\u6062\u5fa9\u4e86\u522a\u9664\u7684\u89d2\u8272\uff0c\u5247\u8a72\u547d\u4ee4\u7684\u8f38\u51fa\u985e\u4f3c\u65bc\u4ee5\u4e0b\u5167\u5bb9\uff1a```\ndescription: My custom role description.etag: BwVkCAx9W6w=includedPermissions:- iam.roles.get- iam.roles.listname: projects/my-project/roles/myCompanyAdminstage: ALPHAtitle: My Company Admin\n```\n\u5982\u9700\u77ad\u89e3\u5982\u4f55\u5b89\u88dd\u548c\u4f7f\u7528 IAM \u5ba2\u6236\u7aef\u5eab\uff0c\u8acb\u53c3\u95b1 [IAM \u5ba2\u6236\u7aef\u5eab](https://cloud.google.com/iam/docs/reference/libraries?hl=zh-cn) \u3002\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [IAM C++ API \u53c3\u8003\u6587\u6a94](https://cloud.google.com/cpp/docs/reference/iam/latest?hl=zh-cn) \u3002\n\u5982\u9700\u5411 IAM \u9032\u884c\u8eab\u4efd\u9a57\u8b49\uff0c\u8acb\u8a2d\u7f6e\u61c9\u7528\u9ed8\u8a8d\u6191\u64da\u3002  \u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [\u6e96\u5099\u5de5\u4f5c](#before-you-begin) \u3002\n [\u5728 GitHub \u4e0a\u67e5\u770b](https://github.com/googleapis/google-cloud-cpp/blob/HEAD/google/cloud/iam/samples/iam_samples.cc) \n```\nnamespace iam = ::google::cloud::iam_admin_v1;[](std::string const& name) {\u00a0 iam::IAMClient client(iam::MakeIAMConnection());\u00a0 google::iam::admin::v1::UndeleteRoleRequest request;\u00a0 request.set_name(name);\u00a0 auto response = client.UndeleteRole(request);\u00a0 if (!response) throw std::move(response).status();\u00a0 std::cout << \"Role successfully undeleted: \" << response->DebugString()\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 << \"\\n\";}\n```\u5982\u9700\u77ad\u89e3\u5982\u4f55\u5b89\u88dd\u548c\u4f7f\u7528 IAM \u5ba2\u6236\u7aef\u5eab\uff0c\u8acb\u53c3\u95b1 [IAM \u5ba2\u6236\u7aef\u5eab](https://cloud.google.com/iam/docs/reference/libraries?hl=zh-cn) \u3002\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [IAM C# API \u53c3\u8003\u6587\u6a94](https://developers.google.com/api-client-library/dotnet/apis/iam/v1?hl=zh-cn) \u3002\n\u5982\u9700\u5411 IAM \u9032\u884c\u8eab\u4efd\u9a57\u8b49\uff0c\u8acb\u8a2d\u7f6e\u61c9\u7528\u9ed8\u8a8d\u6191\u64da\u3002  \u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [\u6e96\u5099\u5de5\u4f5c](#before-you-begin) \u3002\n [\u5728 GitHub \u4e0a\u67e5\u770b](https://github.com/GoogleCloudPlatform/dotnet-docs-samples/blob/HEAD/iam/api/CustomRoles/RolesUndelete.cs) \n```\nusing System;using Google.Apis.Auth.OAuth2;using Google.Apis.Iam.v1;using Google.Apis.Iam.v1.Data;public partial class CustomRoles{\u00a0 \u00a0 public static Role UndeleteRole(string name, string projectId)\u00a0 \u00a0 {\u00a0 \u00a0 \u00a0 \u00a0 var credential = GoogleCredential.GetApplicationDefault()\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 .CreateScoped(IamService.Scope.CloudPlatform);\u00a0 \u00a0 \u00a0 \u00a0 var service = new IamService(new IamService.Initializer\u00a0 \u00a0 \u00a0 \u00a0 {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 HttpClientInitializer = credential\u00a0 \u00a0 \u00a0 \u00a0 });\u00a0 \u00a0 \u00a0 \u00a0 string resource = $\"projects/{projectId}/roles/{name}\";\u00a0 \u00a0 \u00a0 \u00a0 var role = service.Projects.Roles.Undelete(\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 new UndeleteRoleRequest(), resource).Execute();\u00a0 \u00a0 \u00a0 \u00a0 Console.WriteLine(\"Undeleted role: \" + role.Name);\u00a0 \u00a0 \u00a0 \u00a0 return role;\u00a0 \u00a0 }}\n```\u5982\u9700\u77ad\u89e3\u5982\u4f55\u5b89\u88dd\u548c\u4f7f\u7528 IAM \u5ba2\u6236\u7aef\u5eab\uff0c\u8acb\u53c3\u95b1 [IAM \u5ba2\u6236\u7aef\u5eab](https://cloud.google.com/iam/docs/reference/libraries?hl=zh-cn) \u3002\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [IAM Go API \u53c3\u8003\u6587\u6a94](https://godoc.org/google.golang.org/genproto/googleapis/iam/admin/v1) \u3002\n\u5982\u9700\u5411 IAM \u9032\u884c\u8eab\u4efd\u9a57\u8b49\uff0c\u8acb\u8a2d\u7f6e\u61c9\u7528\u9ed8\u8a8d\u6191\u64da\u3002  \u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [\u6e96\u5099\u5de5\u4f5c](#before-you-begin) \u3002\n [\u5728 GitHub \u4e0a\u67e5\u770b](https://github.com/GoogleCloudPlatform/golang-samples/blob/HEAD/iam/snippets/roles_undelete.go) \n```\nimport (\u00a0 \u00a0 \u00a0 \u00a0 \"context\"\u00a0 \u00a0 \u00a0 \u00a0 \"fmt\"\u00a0 \u00a0 \u00a0 \u00a0 \"io\"\u00a0 \u00a0 \u00a0 \u00a0 iam \"google.golang.org/api/iam/v1\")// undeleteRole restores a deleted custom role.func undeleteRole(w io.Writer, projectID, name string) (*iam.Role, error) {\u00a0 \u00a0 \u00a0 \u00a0 ctx := context.Background()\u00a0 \u00a0 \u00a0 \u00a0 service, err := iam.NewService(ctx)\u00a0 \u00a0 \u00a0 \u00a0 if err != nil {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 return nil, fmt.Errorf(\"iam.NewService: %w\", err)\u00a0 \u00a0 \u00a0 \u00a0 }\u00a0 \u00a0 \u00a0 \u00a0 resource := \"projects/\" + projectID + \"/roles/\" + name\u00a0 \u00a0 \u00a0 \u00a0 request := &iam.UndeleteRoleRequest{}\u00a0 \u00a0 \u00a0 \u00a0 role, err := service.Projects.Roles.Undelete(resource, request).Do()\u00a0 \u00a0 \u00a0 \u00a0 if err != nil {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 return nil, fmt.Errorf(\"Projects.Roles.Undelete: %w\", err)\u00a0 \u00a0 \u00a0 \u00a0 }\u00a0 \u00a0 \u00a0 \u00a0 fmt.Fprintf(w, \"Undeleted role: %v\", role.Name)\u00a0 \u00a0 \u00a0 \u00a0 return role, nil}\n```\u5982\u9700\u77ad\u89e3\u5982\u4f55\u5b89\u88dd\u548c\u4f7f\u7528 IAM \u5ba2\u6236\u7aef\u5eab\uff0c\u8acb\u53c3\u95b1 [IAM \u5ba2\u6236\u7aef\u5eab](https://cloud.google.com/iam/docs/reference/libraries?hl=zh-cn) \u3002\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [IAM Java API \u53c3\u8003\u6587\u6a94](https://developers.google.com/api-client-library/java/apis/iam/v1?hl=zh-cn) \u3002\n\u5982\u9700\u5411 IAM \u9032\u884c\u8eab\u4efd\u9a57\u8b49\uff0c\u8acb\u8a2d\u7f6e\u61c9\u7528\u9ed8\u8a8d\u6191\u64da\u3002  \u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [\u6e96\u5099\u5de5\u4f5c](#before-you-begin) \u3002\n [\u5728 GitHub \u4e0a\u67e5\u770b](https://github.com/GoogleCloudPlatform/java-docs-samples/blob/HEAD/iam/snippets/src/main/java/UndeleteRole.java) \n```\nimport com.google.cloud.iam.admin.v1.IAMClient;import com.google.iam.admin.v1.Role;import com.google.iam.admin.v1.UndeleteRoleRequest;import java.io.IOException;/**\u00a0* Undelete a role to return it to its previous state. Undeleting only works on roles that were\u00a0* deleted in the past 7 days.\u00a0*/public class UndeleteRole {\u00a0 public static void main(String[] args) throws IOException {\u00a0 \u00a0 // TODO(developer): Replace the variables before running the sample.\u00a0 \u00a0 // Role ID must point to a role that was deleted in the past 7 days.\u00a0 \u00a0 String projectId = \"your-project-id\";\u00a0 \u00a0 String roleId = \"a unique identifier (e.g. testViewer)\";\u00a0 \u00a0 undeleteRole(projectId, roleId);\u00a0 }\u00a0 public static void undeleteRole(String projectId, String roleId) throws IOException {\u00a0 \u00a0 String roleName = \"projects/\" + projectId + \"/roles/\" + roleId;\u00a0 \u00a0 UndeleteRoleRequest undeleteRoleRequest =\u00a0 \u00a0 \u00a0 \u00a0 UndeleteRoleRequest.newBuilder().setName(roleName).build();\u00a0 \u00a0 // Initialize client for sending requests. This client only needs to be created\u00a0 \u00a0 // once, and can be reused for multiple requests.\u00a0 \u00a0 try (IAMClient iamClient = IAMClient.create()) {\u00a0 \u00a0 \u00a0 Role result = iamClient.undeleteRole(undeleteRoleRequest);\u00a0 \u00a0 \u00a0 System.out.println(\"Undeleted role:\\n\" + result);\u00a0 \u00a0 }\u00a0 }}\n```\u5982\u9700\u77ad\u89e3\u5982\u4f55\u5b89\u88dd\u548c\u4f7f\u7528 IAM \u5ba2\u6236\u7aef\u5eab\uff0c\u8acb\u53c3\u95b1 [IAM \u5ba2\u6236\u7aef\u5eab](https://cloud.google.com/iam/docs/reference/libraries?hl=zh-cn) \u3002\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [IAM Python API \u53c3\u8003\u6587\u6a94](https://developers.google.com/api-client-library/python/apis/iam/v1?hl=zh-cn) \u3002\n\u5982\u9700\u5411 IAM \u9032\u884c\u8eab\u4efd\u9a57\u8b49\uff0c\u8acb\u8a2d\u7f6e\u61c9\u7528\u9ed8\u8a8d\u6191\u64da\u3002  \u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [\u6e96\u5099\u5de5\u4f5c](#before-you-begin) \u3002\n [\u5728 GitHub \u4e0a\u67e5\u770b](https://github.com/GoogleCloudPlatform/python-docs-samples/blob/HEAD/iam/api-client/custom_roles.py) \n```\ndef undelete_role(name: str, project: str) -> dict:\u00a0 \u00a0 \"\"\"Undeletes a role.\"\"\"\u00a0 \u00a0 # pylint: disable=no-member\u00a0 \u00a0 role = (\u00a0 \u00a0 \u00a0 \u00a0 service.projects()\u00a0 \u00a0 \u00a0 \u00a0 .roles()\u00a0 \u00a0 \u00a0 \u00a0 .patch(\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 name=\"projects/\" + project + \"/roles/\" + name, body={\"stage\": \"DISABLED\"}\u00a0 \u00a0 \u00a0 \u00a0 )\u00a0 \u00a0 \u00a0 \u00a0 .execute()\u00a0 \u00a0 )\u00a0 \u00a0 print(\"Disabled role: \" + role[\"name\"])\u00a0 \u00a0 return role\n``` ` [roles.undelete](https://cloud.google.com/iam/docs/reference/rest/v1/projects.roles/undelete?hl=zh-cn) ` \u65b9\u6cd5\u53ef\u6062\u5fa9\u9805\u76ee\u6216\u7d44\u7e54\u4e2d\u5df2\u522a\u9664\u7684\u81ea\u5b9a\u7fa9\u89d2\u8272\u3002\n\u5728\u4f7f\u7528\u4efb\u4f55\u8acb\u6c42\u6578\u64da\u4e4b\u524d\uff0c\u8acb\u5148\u9032\u884c\u4ee5\u4e0b\u66ff\u63db\uff1a- ``\uff1a\u5b8c\u6574\u7684\u89d2\u8272\u540d\u7a31\uff0c\u5305\u62ec\u4efb\u4f55`organizations/`\u3001`projects/`\u6216`roles/`\u524d\u7db4\u3002\u4f8b\u5982`organizations/123456789012/roles/myCompanyAdmin`\u3002\n- ``\uff1a\u89d2\u8272\u7248\u672c\u7684\u6a19\u8b58\u7b26\u3002\u5305\u542b\u6b64\u5b57\u6bb5\u53ef\u9632\u6b62\u8986\u84cb\u5176\u4ed6\u89d2\u8272\u66f4\u6539\u3002\nHTTP \u65b9\u6cd5\u548c\u7db2\u5740\uff1a\n```\nPOST https://iam.googleapis.com/v1/ROLE_NAME:undelete\n```\n\u8acb\u6c42 JSON \u6b63\u6587\uff1a\n```\n{\n \"etag\": \"ETAG\"\n}\n```\n\u5982\u9700\u767c\u9001\u60a8\u7684\u8acb\u6c42\uff0c\u8acb\u5c55\u958b\u4ee5\u4e0b\u9078\u9805\u4e4b\u4e00\uff1a\n\u97ff\u61c9\u4e2d\u5305\u542b\u6062\u5fa9\u7684\u5df2\u522a\u9664\u89d2\u8272\u7684\u5b9a\u7fa9\u3002\n```\n{\n \"name\": \"projects/my-project/roles/myCompanyAdmin\",\n \"title\": \"My Company Admin\",\n \"description\": \"My custom role description.\",\n \"includedPermissions\": [ \"iam.roles.get\",\n \"iam.roles.list\"\n ],\n \"etag\": \"BwWiPg2fmDE=\"\n}\n```\n## \u5f8c\u7e8c\u6b65\u9a5f\n- \u77ad\u89e3\u5982\u4f55 [\u5411\u4e3b\u8cec\u865f\u6388\u4e88\u89d2\u8272](https://cloud.google.com/iam/docs/granting-changing-revoking-access?hl=zh-cn) \u3002\n- \u77ad\u89e3\u5982\u4f55\u4f7f\u7528 [\u89d2\u8272\u5efa\u8b70](https://cloud.google.com/iam/docs/recommender-overview?hl=zh-cn) \u4f86\u7e2e\u5c0f\u4e3b\u8cec\u865f\u7684\u6b0a\u9650\u7bc4\u570d\u3002\n- \u77ad\u89e3 [\u689d\u4ef6\u89d2\u8272\u6388\u4e88](https://cloud.google.com/iam/docs/conditions-overview?hl=zh-cn) \uff0c\u8a72\u6a5f\u5236\u53ea\u6709\u5728\u6eff\u8db3\u7279\u5b9a\u689d\u4ef6\u7684\u60c5\u6cc1\u4e0b\u624d\u6703\u6388\u4e88\u89d2\u8272\u3002", "guide": "IAM"}