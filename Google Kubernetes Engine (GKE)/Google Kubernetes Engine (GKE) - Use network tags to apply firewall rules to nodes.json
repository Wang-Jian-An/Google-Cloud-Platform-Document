{"title": "Google Kubernetes Engine (GKE) - Use network tags to apply firewall rules to nodes", "url": "https://cloud.google.com/kubernetes-engine/docs/how-to/autopilot-network-tags", "abstract": "# Google Kubernetes Engine (GKE) - Use network tags to apply firewall rules to nodes\nThis page shows you how to dynamically apply [network tags](/vpc/docs/add-remove-network-tags) to nodes in your Google Kubernetes Engine (GKE) clusters without disrupting running workloads.\n", "content": "## About network tags\nare metadata on Compute Engine virtual machines (VMs) that allow you to make firewall rules and routes applicable to specific VM instances. In GKE, you can use network tags to make VPC firewall rules or routes applicable to the nodes in your cluster.\nYou can use the GKE API to apply and update network tags on your GKE clusters without disrupting running workloads. Network tags that you specify are also applied to any new nodes that GKE automatically provisions.\n### Use Tags instead of network tags\nNetwork tags are simple strings that aren't subject to Identity and Access Management access controls. Anyone with access to your nodes in the GKE API can add network tags to those nodes.\nIf you use GKE version 1.28 or later, we recommend that you use that have a firewall designation to enforce regional or global [network firewall policies](/firewall/docs/firewall-policies-overview) , which improve on the capabilities of VPC firewall rules.\nTags are key-value pairs that you attach to Compute Engine VMs. You can use IAM to control who can interact with specific Tags.\n- To use Tags to enforce firewall policies in GKE, see [Selectively enforce network firewall policies in GKE](/kubernetes-engine/docs/how-to/tags-firewall-policies) .\n- For more benefits of Tags, see [Comparison of Tags and network tags](/firewall/docs/tags-firewalls-overview#differences) .\n- For help with migrating your firewall rules to network firewall policies, see [Google Cloud VPC firewall rules to network firewall policies - migration guide (PDF)](https://services.google.com/fh/files/misc/vpc_firewall_rules_network_firewall_policy_migration_guide.pdf) .\n### Command-line options for applying network tags\n| Flag       | Mode of operation | Level  | Description                                                      |\n|:--------------------------------|:--------------------|:----------|:-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|\n| --autoprovisioning-network-tags | Autopilot Standard | Cluster | Applies the specified network tags to all Autopilot nodes and all auto-provisioned Standard node pools.                               |\n| --tags       | Standard   | Node pool | Manually applies network tags to specific Standard node pools. Note: If you used --autoprovisioning-network-tags to apply network tags to auto-provisioned node pools, GKE prevents you from using --tags for those node pools |\n## Limitations\nUsing `--autoprovisioning-network-tags` prevents you from using `--tags` to update the network tags for auto-provisioned Standard node pools.\nWe recommend that you use `--autoprovisioning-network-tags` for auto-provisioned node pools, and that you use `--tags` only for manually-created node pools.\n## Before you begin\nBefore you start, make sure you have performed the following tasks:\n- Enable    the Google Kubernetes Engine API.\n- [    Enable Google Kubernetes Engine API   ](https://console.cloud.google.com/flows/enableapi?apiid=container.googleapis.com) \n- If you want to use the Google Cloud CLI for this task, [install](/sdk/docs/install) and then [initialize](/sdk/docs/initializing) the  gcloud CLI. If you previously installed the gcloud CLI, get the latest  version by running`gcloud components update`. **Note:** For existing gcloud CLI  installations, make sure to set the`compute/region`and`compute/zone` [properties](/sdk/docs/properties#setting_properties) . By setting default locations,  you can avoid errors in gcloud CLI like the following:`One of [--zone, --region] must be supplied: Please specify location`.## Add network tags to new clusters\nYou can add network tags when you create a new cluster.\n### Add network tags to new Autopilot clusters\nRun the following command:\n```\ngcloud container clusters create-auto CLUSTER_NAME \\\u00a0 \u00a0 --location=LOCATION \\\u00a0 \u00a0 --autoprovisioning-network-tags=TAG1,TAG2,...\n```\nReplace the following:\n- ``: the name of your new Autopilot cluster.\n- ``: the [Compute Engine location](/compute/docs/regions-zones#available) for your new cluster.\n- ``: a comma-separated list of the network tags you want to apply.\n### Add network tags to new Standard clusters\nFor Standard, you can also specify network tags specifically for node auto-provisioning to use.\nRun the following command to create a new Standard cluster and apply network tags to the default node pool:\n```\ngcloud container clusters create CLUSTER_NAME \\\u00a0 \u00a0 --location=LOCATION \\\u00a0 \u00a0 --tags=NETWORK_TAG1,NETWORK_TAG2,...\n```\nReplace the following:\n- ``: the name of your new Standard cluster.\n- ``: the [Compute Engine location](/compute/docs/regions-zones#available) for your new cluster.\n- ``: a comma-separated list of the network tags that you want to apply.You can automatically apply network tags to all node pools that are created by node auto-provisioning.\nRun the following command:\n```\ngcloud container clusters create CLUSTER_NAME \\\u00a0 \u00a0 --location=LOCATION \\\u00a0 \u00a0 --enable-autoprovisioning \\\u00a0 \u00a0 --autoprovisioning-network-tags=TAG1,TAG2,...\n```\nReplace `` with a comma-separated list of network tags that you want applied to all autoprovisioned node pools.\n**Note:** Using `--autoprovisioning-network-tags` prevents you from later using `--tags` to manually update network tags on auto-provisioned node pools.\n## Update network tags on existing clusters\nYou can update the network tags on existing clusters.\n**Caution:** This overwrites any previously specified values for network tags.\n### Update network tags on existing Autopilot clusters\nRun the following command:\n```\ngcloud container clusters update CLUSTER_NAME \\\u00a0 \u00a0 --autoprovisioning-network-tags=TAG1,TAG2,...\n```\n### Update network tags on existing Standard clusters\nRun the following command to update the network tags on a specific Standard node pool. You **cannot** use this command to update auto-provisioned node pools if you used `--autoprovisioning-network-tags` .\n```\ngcloud container node-pools update NODE_POOL_NAME \\\u00a0 \u00a0 --cluster=CLUSTER_NAME \\\u00a0 \u00a0 --tags=NETWORK_TAG1,NETWORK_TAG2,...\n```\nIf `--autoprovisioning-network-tags` is set for the cluster, this command returns an error.\n**Note:** We recommend that you use `--autoprovisioning-network-tags` to specify network tags for auto-provisioned node pools. If you want to manually update the network tags for those node pools, you must first [remove existingauto-provisioning network tags](#remove-network-tags) .\nYou can update the network tags that node auto-provisioning applies to new and existing auto-provisioned node pools.\nRun the following command:\n```\ngcloud container clusters update CLUSTER_NAME \\\u00a0 \u00a0 --autoprovisioning-network-tags=TAG1,TAG2,...\n```\n**Note:** Using `--autoprovisioning-network-tags` prevents you from later using `--tags` to update network tags on auto-provisioned node pools.\n## Add network tags to new Standard node pools\nTo create a new node pool in a Standard clusters with specific network tags, run the following command:\n```\ngcloud container node-pools create NODE_POOL_NAME \\\u00a0 \u00a0 --cluster=CLUSTER_NAME \\\u00a0 \u00a0 --tags=NETWORK_TAG1,NETWORK_TAG2,...\n```\nReplace `` with the name of the new node pool.\n## View existing network tags\nThis section shows you how to view your existing network tags.\n### View existing network tags in Autopilot\nRun the following command:\n```\ngcloud container clusters describe CLUSTER_NAME \\\u00a0 \u00a0 --flatten=nodePoolAutoConfig.networkTags\n```\nIf the cluster has network tags, the output is similar to the following:\n```\n--tags:\n- example-tag\n```\n### View existing network tags in Standard\nYou can view network tags in auto-provisioned node pools or in node pools that you created.\nRun the following command:\n```\ngcloud container clusters describe CLUSTER_NAME \\\u00a0 \u00a0 --flatten=nodePoolAutoConfig.networkTags\n```\nIf the cluster has network tags, the output is similar to the following:\n```\n--tags:\n- example-tag\n```\nTo view the network tags for a specific Standard node pool where applied the tags using the `--tags` flag, run the following command:\n```\ngcloud container node-pools describe NODE_POOL_NAME\\\u00a0 \u00a0 --cluster=CLUSTER_NAME \\\u00a0 \u00a0 --format='value(config.tags)'\n```\nReplace `` with the name of the node pool.\nIf the node pool has tags, the output is similar to the following:\n```\nexample-tag\n```\n## Remove network tags\nYou can remove the network tags from GKE.\n### Remove network tags from Autopilot clusters\nRun the following command:\n```\ngcloud container clusters update CLUSTER_NAME \\\u00a0 \u00a0 --autoprovisioning-network-tags=\"\"\n```\n### Remove network tags from Standard clusters and node pools\nYou can remove tags from all auto-provisioned node pools or from specific node pools.\nTo remove network tags from all auto-provisioned node pools, run the following command:\n```\ngcloud container clusters update CLUSTER_NAME \\\u00a0 \u00a0 --autoprovisioning-network-tags=\"\"\n```\nThis command also restores your ability to use the `--tags` option to manually specify network tags for auto-provisioned node pools.\nTo remove network tags from specific node pools, run the following command:\n```\ngcloud container node-pools update NODE_POOL_NAME \\\u00a0 \u00a0 --cluster=CLUSTER_NAME \\\u00a0 \u00a0 --tags=\"\"\n```\n## What's next\n- [Learn more about network tags](/vpc/docs/add-remove-network-tags) .\n- [Learn how to apply cluster labels for better cluster management](/kubernetes-engine/docs/how-to/creating-managing-labels) .", "guide": "Google Kubernetes Engine (GKE)"}