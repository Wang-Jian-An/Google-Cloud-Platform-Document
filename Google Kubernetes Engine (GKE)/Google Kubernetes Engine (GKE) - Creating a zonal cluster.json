{"title": "Google Kubernetes Engine (GKE) - Creating a zonal cluster", "url": "https://cloud.google.com/kubernetes-engine/docs/how-to/creating-a-zonal-cluster", "abstract": "# Google Kubernetes Engine (GKE) - Creating a zonal cluster\nThis document shows you how to create a Standard [zonal cluster](/kubernetes-engine/docs/concepts/types-of-clusters#zonal_clusters) with the default features enabled in Google Kubernetes Engine (GKE). Zonal clusters have a single control plane in a single [zone](/compute/docs/regions-zones) . Depending on your availability requirements, you can choose to distribute your nodes for your zonal cluster in a single zone or in multiple zones.\n**Important:** Use regional clusters to run your production workloads as they offer higher availability than zonal clusters.\nTo learn about the different cluster availability types, see [About cluster configuration choices](/kubernetes-engine/docs/concepts/types-of-clusters#availability) .\n", "content": "## Single-zone versus multi-zonal\nA **single-zone** cluster has a single control plane running in one zone. This control plane manages workloads on nodes running in the same zone. If you run a workload in a single zone, this workload is unavailable in the event of a zonal outage.\nA **multi-zonal** cluster's nodes run in multiple zones, but it has only a single replica of the control plane. If you run a workload in multiple zones and there is a zonal outage, the workload is disrupted in that zone but remains available in other zones.\nIf you need higher availability for the control plane, consider creating a [regional cluster](/kubernetes-engine/docs/concepts/types-of-clusters#regional_clusters) instead. In a regional cluster, the control plane is replicated across multiple zones in a region.\n**Note:** After you create a cluster, you cannot change it from zonal to regional, or regional to zonal.\n## Before you begin\nBefore you start, make sure you have performed the following tasks:\n- Enable    the Google Kubernetes Engine API.\n- [    Enable Google Kubernetes Engine API   ](https://console.cloud.google.com/flows/enableapi?apiid=container.googleapis.com) \n- If you want to use the Google Cloud CLI for this task, [install](/sdk/docs/install) and then [initialize](/sdk/docs/initializing) the  gcloud CLI. If you previously installed the gcloud CLI, get the latest  version by running`gcloud components update`. **Note:** For existing gcloud CLI  installations, make sure to set the`compute/region`and`compute/zone` [properties](/sdk/docs/properties#setting_properties) . By setting default locations,  you can avoid errors in gcloud CLI like the following:`One of [--zone, --region] must be supplied: Please specify location`.\n- Multi-zonal clusters use more resources than single-zone clusters. If you are creating a multi-zonal cluster, ensure you have adequate [quotas](/kubernetes-engine/quotas) .\n- Ensure you have the correct permissions to create clusters. At minimum, you should be a [Kubernetes Engine Cluster Admin](/iam/docs/understanding-roles#kubernetes-engine-roles) .\n- If you want to register your new cluster to a [fleet](/anthos/fleet-management/docs) (limited access only), ensure that you have the required [APIs and permissions](/anthos/fleet-management/docs/before-you-begin) .\n**Important:** New clusters have the `cos-metrics-enabled` flag enabled by default. This setting allows kernel crash logs to be collected using dmesg. The report does not include any user logs, and does not intentionally collect any PII. It can potentially include user logs if you write logs from a privileged container and bind mount /dev/kmsg. And certain PII, for example process name, may appear in the report if kernel includes them in the error messages, such as OOM kills.\n**Caution:** If you have the organization policy constraint [constraints/compute.vmExternalIpAccess](/resource-manager/docs/organization-policy/org-policy-constraints) configured to `Deny All` or to restrict external IPs to specific VM instances at the organization, folder, or project level where you are trying to create a public GKE cluster, then your cluster creation operations will fail. See the [troubleshooting information](/kubernetes-engine/docs/troubleshooting#external-ip) for details.\n## Create a zonal cluster\nYou can create a zonal cluster by using the gcloud CLI, the Google Cloud console, or Terraform.\nIf you're developing GKE applications with Cloud Code for VS Code, try [creating clusters withCloud Code](/code/docs/vscode/create-configure-gke-cluster#create_a_cluster_and_add_it_to_your_kubeconfig) .\nTo create a zonal cluster with the gcloud CLI, use one of the following commands.\n **Note:** If you are creating a single-zone cluster, you can omit the [--node-locations](/sdk/gcloud/reference/container/clusters/create#--node-locations) flag from the command.\nReplace the following:- ``: the name of your new cluster.\n- ``: the type of [release channel](/kubernetes-engine/docs/concepts/release-channels) , which can be one of`rapid`,`regular`,`stable`, or`None`. By default, the cluster is enrolled in the`regular`release channel unless at least one of the following flags is specified:`--cluster-version`,`--release-channel`,`--no-enable-autoupgrade`, and`--no-enable-autorepair`.\n- ``: the [compute zone](/compute/docs/regions-zones#available) for the cluster control plane.\n- ``: the [version](/kubernetes-engine/versioning-and-upgrades) you wish to specify for your cluster.\n- `` `,` `` `,[...]`: the zones in which nodes are created. You can specify as many zones as needed for your cluster. All zones must be in the same region as the cluster's control plane, specified by the`--zone`flag. For zonal clusters,`--node-locations`must contain the cluster's primary zone.\nIn the following commands, you can optionally use the `--service-account=` `` `@` `` `.iam.gserviceaccount.com` flag to specify a different IAM service account that nodes in your cluster's first node pool uses instead of the Compute Engine default service account. This flag is optional, but we strongly recommend that you [create and use a minimally-privileged service account](/kubernetes-engine/docs/how-to/hardening-your-cluster#use_least_privilege_sa) so that your nodes don't have more privileges that they require.\n **Using a specific release channel:** \nTo create a new cluster using a specific release channel, run the following command:\n```\ngcloud container clusters create CLUSTER_NAME \\\n --release-channel CHANNEL \\\n --zone COMPUTE_ZONE \\\n --node-locations COMPUTE_ZONE,COMPUTE_ZONE1\n```\n **Using a specific version:** \nTo create a new cluster using a specific cluster version, run the following command:\n```\ngcloud container clusters create CLUSTER_NAME \\\n --cluster-version VERSION \\\n --zone COMPUTE_ZONE \\\n --node-locations COMPUTE_ZONE,COMPUTE_ZONE1\n```\n **Note:** If you specify a cluster version, the cluster uses that specific version and is enrolled in the most mature release channel where that version is available.\n **Using the static default version:** \nTo create a new cluster using the static default cluster version, you don't need to specify a cluster version, but you do need to set the release channel to `None` :\n```\ngcloud container clusters create CLUSTER_NAME \\\n --release-channel None \\\n --zone COMPUTE_ZONE \\\n --node-locations COMPUTE_ZONE,COMPUTE_ZONE1\n```\n **Example** \nThe following command creates a multi-zonal cluster named `example-cluster` , where the cluster control plane is located in the `us-central-a` zone, and there are three node locations. The cluster is enrolled in the `regular` release channel.\nWhen the [--num-nodes](/sdk/gcloud/reference/container/clusters/create#--num-nodes) flag is omitted, the default number of per-zone nodes created by the cluster is three. Because three zones were specified, this command creates a nine-node cluster with three nodes each in `us-central1-a` , `us-central1-b` , and `us-central1-c` .\n```\ngcloud container clusters create example-cluster \\\n --zone us-central1-a \\\n --node-locations us-central1-a,us-central1-b,us-central1-c\n```\nTo create a zonal cluster with the Google Cloud console, perform the following tasks:- Go to the **Google Kubernetes Engine** page in the Google Cloud console. [Go to Google Kubernetes Engine](https://console.cloud.google.com/kubernetes/list) \n- Click **Create** .\n- In the **Cluster basics** section, complete the following:- Enter the **Name** for your cluster.\n- For the **Location type** , select **Zonal** , and then select the desired [zone](/compute/docs/regions-zones#available) for your cluster.\n- If you are creating a multi-zonal cluster, select the **Specify default node locations** checkbox, and then choose additional zones in which you'd like the node pools to run.\n- Choose a **Control plane version** . Defaults to the recommended option of [Release channel](/kubernetes-engine/docs/concepts/release-channels) . If you must specify a static version, ensure **auto-upgrade** is enabled for your node pools.\n- Optional (available with [GKE Enterprise](/anthos/docs/concepts/gke-editions) ): If you want to register your new cluster to a [fleet](/anthos/fleet-management/docs) , go to the **Fleet registration** section, and follow the Google Cloud console instructions for [Create and register a new cluster](/anthos/fleet-management/docs/register/gke#console) to complete your cluster registration.\n- From the navigation pane, under **Node Pools** , click **default-pool** .\n- In the **Node pool details** section, complete the following:- Enter a **Name** for the default [Node pool](/kubernetes-engine/docs/concepts/node-pools) .\n- For static version nodes, choose the **Node version** .\n- Enter the **Number of nodes** to create in the cluster. You must have available [resource quota](/compute/quotas) for the nodes and their resources (such as firewall routes).\n- From the navigation pane, under **Node Pools** , click **Nodes** .\n- From the **Image type** drop-down list, select the desired [node image](/kubernetes-engine/docs/concepts/node-images) .\n- Choose the default [Machine configuration](/compute/docs/machine-types) to use for the instances. Each machine type is billed differently. The default machine type is `e2-medium` . For machine type pricing information, refer to the [machine type price sheet](/compute/pricing#standard_machine_types) .\n- From the **Boot disk type** drop-down list, select the desired [disk type](/compute/docs/disks) .\n- Enter the **Boot disk size** .\n- Optional: From the navigation pane, under **Node Pools** , click **Security** .\n- Optional: From the **Service account** drop-down list, select an Identity and Access Management (IAM) service account for your applications to use when calling Google Cloud APIs. We recommend that you [use a minimally privileged service account](/kubernetes-engine/docs/how-to/hardening-your-cluster#use_least_privilege_sa) instead of using the default service account, so that your nodes don't have more privileges that they require.\n- Click **Create** .\nTo create a zonal cluster with a single-zone node pool using Terraform, refer to the following example:\n [  gke/standard/zonal/single-zone/main.tf ](https://github.com/terraform-google-modules/terraform-docs-samples/blob/main/gke/standard/zonal/single-zone/main.tf) [View on GitHub](https://github.com/terraform-google-modules/terraform-docs-samples/blob/main/gke/standard/zonal/single-zone/main.tf) \n```\nresource \"google_container_cluster\" \"default\" {\n name    = \"gke-standard-zonal-single-zone\"\n location   = \"us-central1-a\"\n initial_node_count = 1\n # Set `deletion_protection` to `true` will ensure that one cannot\n # accidentally delete this instance by use of Terraform.\n deletion_protection = false\n}\n```\nTo create a zonal cluster with a multi-zone node pool using Terraform, refer to the following example:\n [  gke/standard/regional/multi-zone/main.tf ](https://github.com/terraform-google-modules/terraform-docs-samples/blob/main/gke/standard/regional/multi-zone/main.tf) [View on GitHub](https://github.com/terraform-google-modules/terraform-docs-samples/blob/main/gke/standard/regional/multi-zone/main.tf) \n```\nresource \"google_container_cluster\" \"default\" {\n name    = \"gke-standard-regional-multi-zone\"\n location   = \"us-central1\"\n node_locations  = [\"us-central1-b\", \"us-central1-c\"]\n initial_node_count = 2\n # Set `deletion_protection` to `true` will ensure that one cannot\n # accidentally delete this instance by use of Terraform.\n deletion_protection = false\n}\n```\nTo learn more about using Terraform, see [Terraform support for GKE](/kubernetes-engine/docs/resources/use-terraform-gke) .\n### Interact with a cluster using kubectl\nAfter you create a cluster, you need to [configure kubectl](/kubernetes-engine/docs/how-to/cluster-access-for-kubectl#generate_kubeconfig_entry) before you can interact with the cluster from the command line.\n## Cluster templates\nGKE previously supported templates for clusters. Those templates were removed from the Google Cloud console, but are still accessible from the following links:\n- [Your first cluster](https://console.cloud.google.com/kubernetes/add?template=your-first-cluster) **Note:** GKE provides a guided walkthrough for **My first cluster** .\n- [CPU intensive applications](https://console.cloud.google.com/kubernetes/add?template=high-cpu) \n- [Memory intensive applications](https://console.cloud.google.com/kubernetes/add?template=high-memory) \n- [GPU accelerated computing](https://console.cloud.google.com/kubernetes/add?template=gpu-cluster) \n- [Highly available](https://console.cloud.google.com/kubernetes/add?template=ha-cluster) ## What's next\n- Learn [about cluster configuration choices](/kubernetes-engine/docs/concepts/types-of-clusters) you can create.\n- Learn about the [GKE cluster architecture](/kubernetes-engine/docs/concepts/cluster-architecture) .\n- Learn about [managing your clusters](/kubernetes-engine/docs/how-to/managing-clusters) .\n- Learn how to [delete clusters](/kubernetes-engine/docs/how-to/deleting-a-cluster) .", "guide": "Google Kubernetes Engine (GKE)"}