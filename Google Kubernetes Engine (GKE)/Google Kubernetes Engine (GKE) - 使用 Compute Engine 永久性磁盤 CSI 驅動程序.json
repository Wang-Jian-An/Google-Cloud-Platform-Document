{"title": "Google Kubernetes Engine (GKE) - \u4f7f\u7528 Compute Engine \u6c38\u4e45\u6027\u78c1\u76e4 CSI \u9a45\u52d5\u7a0b\u5e8f", "url": "https://cloud.google.com/kubernetes-engine/docs/how-to/persistent-volumes/gce-pd-csi-driver?hl=zh-cn", "abstract": "# Google Kubernetes Engine (GKE) - \u4f7f\u7528 Compute Engine \u6c38\u4e45\u6027\u78c1\u76e4 CSI \u9a45\u52d5\u7a0b\u5e8f\nGoogle Kubernetes Engine (GKE) \u7232\u60a8\u5728\u96c6\u7fa3\u4e2d\u81ea\u52d5\u90e8\u7f72\u548c\u7ba1\u7406 [Compute Engine \u6c38\u4e45\u6027\u78c1\u76e4\u5bb9\u5668\u5b58\u5132\u63a5\u53e3 (CSI) \u9a45\u52d5\u7a0b\u5e8f](https://github.com/kubernetes-sigs/gcp-compute-persistent-disk-csi-driver) \u63d0\u4f9b\u4e86\u4e00\u7a2e\u7c21\u55ae\u7684\u65b9\u6cd5\u3002 Compute Engine \u6c38\u4e45\u6027\u78c1\u76e4 CSI \u9a45\u52d5\u7a0b\u5e8f\u5728 Autopilot \u96c6\u7fa3\u4e2d\u59cb\u7d42\u8655\u65bc\u5553\u7528\u72c0\u614b\uff0c\u7121\u6cd5\u505c\u7528\u6216\u4fee\u6539\u3002\u5728 Standard \u96c6\u7fa3\u4e2d\uff0c\u60a8\u5fc5\u9808\u5553\u7528 Compute Engine \u6c38\u4e45\u6027\u78c1\u76e4 CSI \u9a45\u52d5\u7a0b\u5e8f\u3002\nCompute Engine \u6c38\u4e45\u6027\u78c1\u76e4 CSI \u9a45\u52d5\u7a0b\u5e8f\u7248\u672c\u8207 GKE \u7248\u672c\u865f\u76f8\u95dc\u806f\u3002Compute Engine \u6c38\u4e45\u6027\u78c1\u76e4 CSI \u9a45\u52d5\u7a0b\u5e8f\u7248\u672c\u901a\u5e38\u662f\u767c\u4f48 GKE \u7248\u672c\u6642\u53ef\u7528\u7684\u6700\u65b0\u9a45\u52d5\u7a0b\u5e8f\u3002\u7576\u96c6\u7fa3\u5347\u7d1a\u5230\u6700\u65b0\u7684 GKE \u88dc\u4e01\u7a0b\u5e8f\u6642\uff0c\u9a45\u52d5\u7a0b\u5e8f\u6703\u81ea\u52d5\u66f4\u65b0\u3002\n**\u6ce8\u610f** \uff1a\u7531\u65bc Compute Engine \u6c38\u4e45\u6027\u78c1\u76e4 CSI \u9a45\u52d5\u7a0b\u5e8f\u548c\u4e00\u4e9b\u5176\u4ed6\u95dc\u806f\u7684 CSI \u7d44\u4ef6\u88ab\u90e8\u7f72\u7232\u55ae\u7368\u7684\u5bb9\u5668\uff0c\u56e0\u6b64\u6703\u4f7f\u7528 Kubernetes \u7bc0\u9ede\u4e0a\u7684\u8cc7\u6e90\uff08\u865b\u64ec\u6a5f CPU\u3001\u5167\u5b58\u548c\u5553\u52d5\u78c1\u76e4\uff09\u3002\u865b\u64ec\u6a5f CPU \u4f7f\u7528\u91cf\u901a\u5e38\u7232\u6578\u5341 millicore\uff0c\u5167\u5b58\u4f7f\u7528\u91cf\u901a\u5e38\u7232\u6578\u5341 MB\u3002\u5553\u52d5\u78c1\u76e4\u4f7f\u7528\u91cf\u4e3b\u8981\u4f86\u81ea Deployment \u4e2d\u7684 CSI \u9a45\u52d5\u7a0b\u5e8f\u548c\u5176\u4ed6\u7cfb\u7d71\u5bb9\u5668\u7684\u65e5\u8a8c\u3002\n", "content": "## \u512a\u52e2\n\u4f7f\u7528 Compute Engine \u6c38\u4e45\u6027\u78c1\u76e4 CSI \u9a45\u52d5\u7a0b\u5e8f\u5177\u6709\u4ee5\u4e0b\u512a\u52e2\uff1a\n- \u5b83\u53ef\u4ee5\u81ea\u52d5\u90e8\u7f72\u548c\u7ba1\u7406\u6c38\u4e45\u6027\u78c1\u76e4\u9a45\u52d5\u7a0b\u5e8f\uff0c\u800c\u4e0d\u5fc5\u624b\u52d5\u9032\u884c\u8a2d\u7f6e\u3002\n- \u60a8\u53ef\u4ee5\u4f7f\u7528\u5ba2\u6236\u7ba1\u7406\u7684\u52a0\u5bc6\u5bc6\u9470 (CMEK)\u3002\u9019\u4e9b\u5bc6\u9470\u7528\u65bc\u5c0d\u52a0\u5bc6\u60a8\u7684\u6578\u64da\u7684\u6578\u64da\u52a0\u5bc6\u5bc6\u9470\u9032\u884c\u52a0\u5bc6\u3002\u5982\u9700\u8a73\u7d30\u77ad\u89e3 GKE \u4e0a\u7684 CMEK\uff0c\u8acb\u53c3\u95b1 [\u4f7f\u7528 CMEK](https://cloud.google.com/kubernetes-engine/docs/how-to/using-cmek?hl=zh-cn) \u3002\n- \u60a8\u53ef\u4ee5\u5c07 [\u5377\u5feb\u7167](https://cloud.google.com/kubernetes-engine/docs/how-to/persistent-volumes/volume-snapshots?hl=zh-cn) \u8207 Compute Engine \u6c38\u4e45\u6027\u78c1\u76e4 CSI \u9a45\u52d5\u7a0b\u5e8f\u7d50\u5408\u4f7f\u7528\u3002\u901a\u904e\u5377\u5feb\u7167\uff0c\u60a8\u53ef\u4ee5\u5728\u7279\u5b9a\u6642\u9593\u9ede\u5275\u5efa\u5377\u7684\u526f\u672c\u3002\u60a8\u53ef\u4ee5\u4f7f\u7528\u6b64\u526f\u672c\u5c07\u5377\u6062\u5fa9\u5230\u4e4b\u524d\u7684\u72c0\u614b\u6216\u9810\u914d\u65b0\u5377\u3002\n- \u60a8\u53ef\u4ee5\u5c07 [\u5377\u514b\u9686](https://cloud.google.com/kubernetes-engine/docs/how-to/persistent-volumes/volume-cloning?hl=zh-cn) \u8207\u904b\u884c GKE 1.22 \u53ca\u66f4\u9ad8\u7248\u672c\u7684\u96c6\u7fa3\u4e2d\u7684 Compute Engine \u6c38\u4e45\u6027\u78c1\u76e4 CSI \u9a45\u52d5\u7a0b\u5e8f\u7d50\u5408\u4f7f\u7528\u3002\u901a\u904e\u5377\u514b\u9686\uff0c\u60a8\u53ef\u4ee5\u5728\u7279\u5b9a\u6642\u9593\u9ede\u5275\u5efa\u5377\u7684\u526f\u672c\uff0c\u4e26\u9810\u914d\u4f86\u6e90\u5377\u7684\u6240\u6709\u6578\u64da\u3002\n- Bug \u4fee\u5fa9\u548c\u529f\u80fd\u66f4\u65b0\u7368\u7acb\u65bc\u6b21\u8981\u7684 Kubernetes \u7248\u672c\u800c\u767c\u4f48\u3002\u6b64\u767c\u4f48\u6642\u9593\u8868\u901a\u5e38\u6703\u52a0\u5feb\u767c\u4f48\u7bc0\u594f\u3002## \u9808\u77e5\u4e8b\u9805\n\u5728\u958b\u59cb\u4e4b\u524d\uff0c\u8acb\u78ba\u4fdd\u60a8\u5df2\u57f7\u884c\u4ee5\u4e0b\u4efb\u52d9\uff1a\n- \u5553\u7528 Google Kubernetes Engine API\u3002\n- [  \u5553\u7528 Google Kubernetes Engine API ](https://console.cloud.google.com/flows/enableapi?apiid=container.googleapis.com&hl=zh-cn) \n- \u5982\u679c\u60a8\u8981\u4f7f\u7528 Google Cloud CLI \u57f7\u884c\u6b64\u4efb\u52d9\uff0c\u8acb [\u5b89\u88dd](https://cloud.google.com/sdk/docs/install?hl=zh-cn) \u4e26 [\u521d\u59cb\u5316](https://cloud.google.com/sdk/docs/initializing?hl=zh-cn) gcloud CLI\u3002 \u5982\u679c\u60a8\u4e4b\u524d\u5b89\u88dd\u4e86 gcloud CLI\uff0c\u8acb\u904b\u884c`gcloud components update`\u4ee5\u7372\u53d6\u6700\u65b0\u7248\u672c\u3002 **\u6ce8\u610f** \uff1a\u5c0d\u65bc\u73fe\u6709 gcloud CLI \u5b89\u88dd\uff0c\u8acb\u52d9\u5fc5\u8a2d\u7f6e`compute/region`\u548c`compute/zone` [\u5c6c\u6027](https://cloud.google.com/sdk/docs/properties?hl=zh-cn#setting_properties) \u3002\u901a\u904e\u8a2d\u7f6e\u9ed8\u8a8d\u4f4d\u7f6e\uff0c\u60a8\u53ef\u4ee5\u907f\u514d gcloud CLI \u4e2d\u51fa\u73fe\u4ee5\u4e0b\u932f\u8aa4\uff1a`One of [--zone, --region] must be supplied: Please specify location`\u3002\n### \u4f7f\u7528\u8981\u6c42\n\u5982\u9700\u4f7f\u7528 Compute Engine \u6c38\u4e45\u6027\u78c1\u76e4 CSI \u9a45\u52d5\u7a0b\u5e8f\uff0c\u60a8\u7684\u96c6\u7fa3\u5fc5\u9808\u4f7f\u7528\u4ee5\u4e0b\u7248\u672c\uff1a\n- Linux \u96c6\u7fa3\uff1aGKE 1.14 \u6216\u66f4\u9ad8\u7248\u672c\u3002\n- Windows \u96c6\u7fa3\uff1aGKE 1.18 \u6216\u66f4\u9ad8\u7248\u672c\u3002\n\u5728 1.22 \u53ca\u66f4\u9ad8\u7248\u672c\u4e2d\uff0c [\u5df2\u5553\u7528 CSI \u9077\u79fb](https://kubernetes.io/blog/2019/12/09/kubernetes-1-17-feature-csi-migration-beta/) \u3002\u4f7f\u7528 `gce-pd` \u63d0\u4f9b\u5546\u7684\u73fe\u6709\u5377\u5c07\u9032\u884c\u9077\u79fb\uff0c\u4ee5\u6539\u7232\u901a\u904e CSI \u9a45\u52d5\u7a0b\u5e8f\u9032\u884c\u901a\u4fe1\u3002\u7121\u9700\u5c0d\u4efb\u4f55 StorageClass \u9032\u884c\u66f4\u6539\u3002 `gce-pd` \u63d0\u4f9b\u5546\u4f9d\u7136\u4e0d\u652f\u6301 CMEK \u6216\u5377\u5feb\u7167\u7b49\u529f\u80fd\u3002\u5fc5\u9808\u4f7f\u7528 StorageClass \u4e2d\u7684 `pd.csi.storage.gke.io` \u63d0\u4f9b\u5546\u4f86\u5553\u7528\u9019\u4e9b\u529f\u80fd\u3002\n\u5982\u9700\u5c07 Compute Engine \u6c38\u4e45\u6027\u78c1\u76e4 CSI \u9a45\u52d5\u7a0b\u5e8f\u8207 [GKE \u7684\u5de5\u4f5c\u8ca0\u8f09\u8eab\u4efd\u806f\u5408](https://cloud.google.com/kubernetes-engine/docs/how-to/workload-identity?hl=zh-cn) \u642d\u914d\u4f7f\u7528\uff0c\u60a8\u7684 Standard \u96c6\u7fa3\u5fc5\u9808\u4f7f\u7528\u4ee5\u4e0b\u7248\u672c\uff1a\n- Linux \u96c6\u7fa3\uff1aGKE 1.16 \u6216\u66f4\u9ad8\u7248\u672c\u3002\n- Windows \u96c6\u7fa3\uff1aGKE 1.20.8-gke.900 \u6216\u66f4\u9ad8\u7248\u672c\u3002\n**\u6ce8\u610f** \uff1a\u5c0d\u65bc [Autopilot](https://cloud.google.com/kubernetes-engine/docs/concepts/autopilot-overview?hl=zh-cn) \uff0cCompute Engine \u6c38\u4e45\u6027\u78c1\u76e4 CSI \u9a45\u52d5\u7a0b\u5e8f\u9ed8\u8a8d\u8655\u65bc\u5553\u7528\u72c0\u614b\uff0c\u7121\u6cd5\u505c\u7528\u6216\u4fee\u6539\u3002\u5982\u9700\u4f7f\u7528\u6b64\u9a45\u52d5\u7a0b\u5e8f\uff0c\u8acb\u8df3\u81f3 [\u4f7f\u7528\u9069\u7528\u65bc Linux \u96c6\u7fa3\u7684 Compute Engine \u6c38\u4e45\u6027\u78c1\u76e4 CSI \u9a45\u52d5\u7a0b\u5e8f](#using_the_for_linux_clusters) \u3002\n## \u5728\u65b0\u96c6\u7fa3\u4e0a\u5553\u7528 Compute Engine \u6c38\u4e45\u6027\u78c1\u76e4 CSI \u9a45\u52d5\u7a0b\u5e8f\n**\u6ce8\u610f** \uff1a\u9ed8\u8a8d\u60c5\u6cc1\u4e0b\uff0c\u5728\u4ee5\u4e0b\u7248\u672c\u7684\u65b0\u5275\u5efa\u7684\u7fa3\u96c6\u4e0a\u5553\u7528 Compute Engine \u6c38\u4e45\u6027\u78c1\u76e4 CSI \u9a45\u52d5\u7a0b\u5e8f\uff1a **Linux \u96c6\u7fa3** \uff1aGKE 1.18.10-gke.2100 \u6216\u66f4\u9ad8\u7248\u672c\uff0c\u6216\u8005 1.19.3-gke.2100 \u6216\u66f4\u9ad8\u7248\u672c\u3002 **Windows \u96c6\u7fa3** \uff1aGKE 1.22.6-gke.300 \u6216\u66f4\u9ad8\u7248\u672c\uff0c\u6216\u8005 1.23.2-gke.300 \u6216\u66f4\u9ad8\u7248\u672c\u3002\u5c0d\u65bc Autopilot \u96c6\u7fa3\uff0cCompute Engine \u6c38\u4e45\u6027\u78c1\u76e4 CSI \u9a45\u52d5\u7a0b\u5e8f\u9ed8\u8a8d\u8655\u65bc\u5553\u7528\u72c0\u614b\uff0c\u4e14\u7121\u6cd5\u505c\u7528\u6216\u4fee\u6539\u3002\n\u5982\u9700\u4f7f\u7528\u672a\u81ea\u52d5\u5553\u7528 Compute Engine \u6c38\u4e45\u6027\u78c1\u76e4 CSI \u9a45\u52d5\u7a0b\u5e8f\u7684\u7248\u672c\u5275\u5efa\u96c6\u7fa3\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528 Google Cloud CLI \u6216 Google Cloud Console\u3002\n\u5982\u9700\u5728\u5275\u5efa\u96c6\u7fa3\u6642\u5553\u7528\u8a72\u9a45\u52d5\u7a0b\u5e8f\uff0c\u8acb\u5b8c\u6210\u4ee5\u4e0b\u6b65\u9a5f\uff1a\n```\ngcloud container clusters create CLUSTER-NAME \\\u00a0 \u00a0 --addons=GcePersistentDiskCsiDriver \\\u00a0 \u00a0 --cluster-version=VERSION\n```\n\u66ff\u63db\u4ee5\u4e0b\u5167\u5bb9\uff1a- ``\uff1a\u60a8\u7684\u96c6\u7fa3\u7684\u540d\u7a31\u3002\n- ``\uff1aGKE \u7248\u672c\u865f\u3002 **\u60a8\u5fc5\u9808\u9078\u64c7 1.14 \u6216\u66f4\u9ad8\u7248\u672c\u624d\u80fd\u4f7f\u7528\u6b64\u529f\u80fd\u3002** \n\u5982\u9700\u67e5\u770b\u5b8c\u6574\u7684\u6a19\u8a8c\u5217\u8868\uff0c\u8acb\u53c3\u95b1 [gcloud container clusters create](https://cloud.google.com/sdk/gcloud/reference/container/clusters/create?hl=zh-cn) \u6587\u6a94\u3002- \u8f49\u5230 Google Cloud \u63a7\u5236\u6aaf\u4e2d\u7684 **Google Kubernetes Engine** \u9801\u9762\u3002 [\u8f49\u5230 Google Kubernetes Engine](https://console.cloud.google.com/kubernetes/list?hl=zh-cn) \n- \u9ede\u64ca **\u5275\u5efa** \u3002\n- \u5728 **\u6a19\u6e96** \u90e8\u5206\u4e2d\uff0c\u9ede\u64ca **\u914d\u7f6e** \u3002\n- \u6839\u64da\u9700\u8981\u914d\u7f6e\u96c6\u7fa3\u3002\n- \u5728\u5c0e\u822a\u7a97\u683c\u7684 **\u96c6\u7fa3** \u4e0b\uff0c\u9ede\u64ca **\u529f\u80fd** \u3002\n- \u9078\u4e2d **\u5553\u7528 Compute Engine \u6c38\u4e45\u6027\u78c1\u76e4 CSI \u9a45\u52d5\u7a0b\u5e8f** \u8907\u9078\u6846\u3002\n- \u9ede\u64ca **\u5275\u5efa** \u3002\n\u5553\u7528 Compute Engine \u6c38\u4e45\u6027\u78c1\u76e4 CSI \u9a45\u52d5\u7a0b\u5e8f\u5f8c\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528\u9a45\u52d5\u7a0b\u5e8f\u548c\u9810\u914d\u5de5\u5177\u540d\u7a31 `pd.csi.storage.gke.io` \u5728 Kubernetes \u5377\u4e2d\u4f7f\u7528\u8a72\u9a45\u52d5\u7a0b\u5e8f\u3002\n## \u5728\u73fe\u6709\u96c6\u7fa3\u4e0a\u5553\u7528 Compute Engine \u6c38\u4e45\u6027\u78c1\u76e4 CSI \u9a45\u52d5\u7a0b\u5e8f\n\u5982\u9700\u5728\u73fe\u6709\u6a19\u6e96\u96c6\u7fa3\u4e2d\u5553\u7528 Compute Engine \u6c38\u4e45\u6027\u78c1\u76e4 CSI \u9a45\u52d5\u7a0b\u5e8f\uff0c\u8acb\u4f7f\u7528 Google Cloud CLI \u6216 Google Cloud Console\u3002\n\u5982\u9700\u5728\u73fe\u6709\u96c6\u7fa3\u4e0a\u5553\u7528\u8a72\u9a45\u52d5\u7a0b\u5e8f\uff0c\u8acb\u5b8c\u6210\u4ee5\u4e0b\u6b65\u9a5f\uff1a\n```\ngcloud container clusters update CLUSTER-NAME \\\u00a0 \u00a0--update-addons=GcePersistentDiskCsiDriver=ENABLED\n```\n\u5c07 `` \u66ff\u63db\u7232\u73fe\u6709\u96c6\u7fa3\u7684\u540d\u7a31\u3002- \u8f49\u5230 Google Cloud \u63a7\u5236\u6aaf\u4e2d\u7684 **Google Kubernetes Engine** \u9801\u9762\u3002 [\u524d\u5f80 Google Kubernetes Engine](https://console.cloud.google.com/kubernetes/list?hl=zh-cn) \n- \u5728\u96c6\u7fa3\u5217\u8868\u4e2d\uff0c\u9ede\u64ca\u60a8\u8981\u4fee\u6539\u7684\u96c6\u7fa3\u7684\u540d\u7a31\u3002\n- \u5728 **\u529f\u80fd** \u4e0b\uff0c\u9ede\u64ca **Compute Engine \u6c38\u4e45\u6027\u78c1\u76e4 CSI \u9a45\u52d5\u7a0b\u5e8f** \u5b57\u6bb5\u65c1\u908a\u7684 **\u4fee\u6539 Compute Engine CSI \u9a45\u52d5\u7a0b\u5e8f** \u3002\n- \u9078\u4e2d **\u5553\u7528 Compute Engine \u6c38\u4e45\u6027\u78c1\u76e4 CSI \u9a45\u52d5\u7a0b\u5e8f** \u8907\u9078\u6846\u3002\n- \u9ede\u64ca **\u4fdd\u5b58\u66f4\u6539** \u3002## \u505c\u7528 Compute Engine \u6c38\u4e45\u6027\u78c1\u76e4 CSI \u9a45\u52d5\u7a0b\u5e8f\n\u60a8\u53ef\u4ee5\u4f7f\u7528 Google Cloud CLI \u6216 Google Cloud \u63a7\u5236\u6aaf\u505c\u7528\u9069\u7528\u65bc\u6a19\u6e96\u96c6\u7fa3\u7684 Compute Engine \u6c38\u4e45\u6027\u78c1\u76e4 CSI \u9a45\u52d5\u7a0b\u5e8f\u3002\n\u5982\u679c\u60a8\u505c\u7528\u8a72\u9a45\u52d5\u7a0b\u5e8f\uff0c\u5247\u7576\u524d\u4f7f\u7528\u8a72\u9a45\u52d5\u7a0b\u5e8f\u6240\u64c1\u6709\u7684 PersistentVolume \u7684\u4efb\u4f55 Pod \u90fd\u5c07\u7121\u6cd5\u7d42\u6b62\u3002\u5617\u8a66\u4f7f\u7528\u9019\u4e9b PersistentVolume \u7684\u6240\u6709\u65b0 Pod \u4e5f\u5c07\u7121\u6cd5\u5553\u52d5\u3002\n**\u6ce8\u610f** \uff1a\u5728 1.22 \u7248\u53ca\u66f4\u9ad8\u7248\u672c\u4e2d\uff0c\u7531\u65bc `gcePersistentDisk` \u5377\u985e\u578b\u5df2\u9077\u79fb\u5230\u7684 Compute Engine \u6c38\u4e45\u6027\u78c1\u76e4 CSI \u9a45\u52d5\u7a0b\u5e8f\uff0c\u5982\u679c\u60a8\u505c\u7528\u6c38\u4e45\u6027\u78c1\u76e4 CSI \u9a45\u52d5\u7a0b\u5e8f\uff0c `gcePersistentDisk` \u5377\u985e\u578b\u4e5f\u6703\u505c\u6b62\u904b\u884c\u3002\n**\u8b66\u544a** \uff1a\u5982\u679c\u60a8\u4f7f\u7528\u6a39\u5167\u6c38\u4e45\u6027\u78c1\u76e4\u9a45\u52d5\u7a0b\u5e8f\uff0c\u4e26\u4e14\u60f3\u8981\u522a\u9664\u5340\u57df\u78c1\u76e4\uff0c\u5247 GKE 1.21 \u53ca\u8f03\u4f4e\u7248\u672c\u4e2d\u5b58\u5728\u4e00\u500b\u5df2\u77e5\u554f\u984c\u3002\u7576 Compute Engine \u5340\u57df\u78c1\u76e4\u7684\u76f8\u95dc `PersistentVolume` \u8cc7\u6e90\u88ab\u522a\u9664\u6642\uff0c\u8a72\u78c1\u76e4\u53ef\u80fd\u6703\u6cc4\u9732\u3002\u5982\u679c\u522a\u9664\u5340\u57df\u78c1\u76e4\u7684 API \u8abf\u7528\u5931\u6557\u4e26\u8fd4\u56de `NotFound` \u4ee5\u5916\u7684\u932f\u8aa4\u4ee3\u78bc\uff0c\u5247\u53ef\u4ee5\u6aa2\u6e2c\u5230\u6b64\u554f\u984c\u3002 [\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1\u6b64 ](https://github.com/kubernetes/kubernetes/issues/109328) GitHub \u554f\u984c\u3002\n\u5982\u9700\u5728\u73fe\u6709\u6a19\u6e96\u96c6\u7fa3\u4e0a\u505c\u7528\u8a72\u9a45\u52d5\u7a0b\u5e8f\uff0c\u8acb\u5b8c\u6210\u4ee5\u4e0b\u6b65\u9a5f\uff1a\n```\ngcloud container clusters update CLUSTER-NAME \\\u00a0 \u00a0 --update-addons=GcePersistentDiskCsiDriver=DISABLED\n```\n\u5c07 `` \u66ff\u63db\u7232\u73fe\u6709\u96c6\u7fa3\u7684\u540d\u7a31\u3002- \u8f49\u5230 Google Cloud \u63a7\u5236\u6aaf\u4e2d\u7684 **Google Kubernetes Engine** \u9801\u9762\u3002 [\u524d\u5f80 Google Kubernetes Engine](https://console.cloud.google.com/kubernetes/list?hl=zh-cn) \n- \u5728\u96c6\u7fa3\u5217\u8868\u4e2d\uff0c\u9ede\u64ca\u60a8\u8981\u4fee\u6539\u7684\u96c6\u7fa3\u7684\u540d\u7a31\u3002\n- \u5728 **\u529f\u80fd** \u4e0b\uff0c\u9ede\u64ca **Compute Engine \u6c38\u4e45\u6027\u78c1\u76e4 CSI \u9a45\u52d5\u7a0b\u5e8f** \u5b57\u6bb5\u65c1\u908a\u7684 **\u4fee\u6539 Compute Engine CSI \u9a45\u52d5\u7a0b\u5e8f** \u3002\n- \u53d6\u6d88\u9078\u4e2d **\u5553\u7528 Compute Engine Persistent Disk CSI \u9a45\u52d5\u7a0b\u5e8f** \u8907\u9078\u6846\u3002\n- \u9ede\u64ca **\u4fdd\u5b58\u66f4\u6539** \u3002## \u4f7f\u7528\u9069\u7528\u65bc Linux \u96c6\u7fa3\u7684 Compute Engine \u6c38\u4e45\u6027\u78c1\u76e4 CSI \u9a45\u52d5\u7a0b\u5e8f\n\u4ee5\u4e0b\u5e7e\u500b\u90e8\u5206\u4ecb\u7d39\u4e86\u5728 GKE \u4e2d\u4f7f\u7528 CSI \u9a45\u52d5\u7a0b\u5e8f\u652f\u6301\u7684 Kubernetes \u5377\u7684\u5178\u578b\u904e\u7a0b\u3002 \u9019\u4e9b\u90e8\u5206\u91dd\u5c0d\u4f7f\u7528 Linux \u7684\u96c6\u7fa3\u3002\n### \u5275\u5efa\u4e00\u500b StorageClass\n\u5553\u7528 Compute Engine \u6c38\u4e45\u6027\u78c1\u76e4 CSI \u9a45\u52d5\u7a0b\u5e8f\u5f8c\uff0cGKE \u6703\u81ea\u52d5\u5b89\u88dd\u4ee5\u4e0b [StorageClass](https://cloud.google.com/kubernetes-engine/docs/concepts/persistent-volumes?hl=zh-cn#storageclasses) \uff1a\n- `standard-rwo`\uff08\u4f7f\u7528\u5e73\u8861\u6c38\u4e45\u6027\u78c1\u76e4\uff09\n- `premium-rwo`\uff08\u4f7f\u7528 SSD \u6c38\u4e45\u6027\u78c1\u76e4\uff09\n\u5c0d\u65bc Autopilot \u96c6\u7fa3\uff0c\u9ed8\u8a8d StorageClass \u662f `standard-rwo` \uff0c\u5b83\u4f7f\u7528 Compute Engine \u6c38\u4e45\u6027\u78c1\u76e4 CSI \u9a45\u52d5\u7a0b\u5e8f\u3002\u5c0d\u65bc\u6a19\u6e96\u96c6\u7fa3\uff0c\u9ed8\u8a8d StorageClass \u4f7f\u7528 Kubernetes \u6a39\u5167 `gcePersistentDisk` \u5377\u63d2\u4ef6\u3002\n\u60a8\u53ef\u4ee5\u901a\u904e\u904b\u884c\u4ee5\u4e0b\u547d\u4ee4\u627e\u5230\u5df2\u5b89\u88dd\u7684 StorageClass \u7684\u540d\u7a31\uff1a\n```\nkubectl get sc\n```\n\u60a8\u9084\u53ef\u4ee5\u901a\u904e\u5728\u9810\u914d\u5de5\u5177\u5b57\u6bb5\u4e2d\u6dfb\u52a0 `pd.csi.storage.gke.io` \u4f86\u5b89\u88dd\u5176\u4ed6\u4f7f\u7528 Compute Engine \u6c38\u4e45\u6027\u78c1\u76e4 CSI \u9a45\u52d5\u7a0b\u5e8f\u7684 StorageClass\u3002\n\u4f8b\u5982\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u540d\u7232 `pd-example-class.yaml` \u7684\u6587\u4ef6\u5275\u5efa\u4e00\u500b StorageClass\uff1a\n```\napiVersion: storage.k8s.io/v1kind: StorageClassmetadata:\u00a0 name: pd-exampleprovisioner: pd.csi.storage.gke.iovolumeBindingMode: WaitForFirstConsumerallowVolumeExpansion: trueparameters:\u00a0 type: pd-balanced\n```\n\u60a8\u53ef\u4ee5\u5728 `type` \u53c3\u6578\u4e2d\u6307\u5b9a\u4ee5\u4e0b [\u6c38\u4e45\u6027\u78c1\u76e4\u985e\u578b](https://cloud.google.com/compute/docs/disks?hl=zh-cn#disk-types) \uff1a\n- `pd-balanced`\n- `pd-ssd`\n- `pd-standard`\n- `pd-extreme`\uff08\u5728 GKE 1.26 \u7248\u53ca\u66f4\u9ad8\u7248\u672c\u4e2d\u53d7\u652f\u6301\uff09\n\u5982\u679c\u4f7f\u7528 `pd-standard` \u6216 `pd-extreme` \uff0c\u8acb\u53c3\u95b1 [\u4e0d\u652f\u6301\u7684\u6a5f\u5668\u985e\u578b](#unsupported_machine_types) \uff0c\u77ad\u89e3\u5176\u4ed6\u4f7f\u7528\u9650\u5236\u3002\n\u4f7f\u7528 `pd-extreme` \u9078\u9805\u6642\uff0c\u60a8\u9084\u5fc5\u9808\u5c07 `provisioned-iops-on-create` \u5b57\u6bb5\u6dfb\u52a0\u5230\u6e05\u55ae\u4e2d\u3002\u6b64\u5b57\u6bb5\u5fc5\u9808\u8a2d\u7f6e\u7232\u60a8\u5728\u5275\u5efa\u6c38\u4e45\u6027\u78c1\u76e4\u6642\u6307\u5b9a\u7684 [\u9810\u914d IOPS \u503c](https://cloud.google.com/compute/docs/disks/extreme-persistent-disk?hl=zh-cn#provisioning_iops) \u3002\n```\napiVersion: storage.k8s.io/v1kind: StorageClassmetadata:\u00a0 name: pd-extreme-exampleprovisioner: pd.csi.storage.gke.iovolumeBindingMode: WaitForFirstConsumerallowVolumeExpansion: trueparameters:\u00a0 type: pd-extreme\u00a0 provisioned-iops-on-create: '10000'\n```\n\u5275\u5efa `pd-example-class.yaml` \u6587\u4ef6\u5f8c\uff0c\u8acb\u904b\u884c\u4ee5\u4e0b\u547d\u4ee4\uff1a\n```\nkubectl create -f pd-example-class.yaml\n```\n### \u5275\u5efa\u4e00\u500b PersistentVolumeClaim\n\u60a8\u53ef\u4ee5\u5275\u5efa\u4e00\u500b\u5f15\u7528 Compute Engine \u6c38\u4e45\u6027\u78c1\u76e4 CSI \u9a45\u52d5\u7a0b\u5e8f\u7684 StorageClass \u7684 PersistentVolumeClaim\u3002\n\u4ee5\u4e0b\u540d\u7232 `pvc-example.yaml` \u7684\u6587\u4ef6\u4f7f\u7528\u9810\u5b89\u88dd\u7684\u5b58\u5132\u985e\u5225 `standard-rwo` \uff1a\n```\nkind: PersistentVolumeClaimapiVersion: v1metadata:\u00a0 name: podpvcspec:\u00a0 accessModes:\u00a0 - ReadWriteOnce\u00a0 storageClassName: standard-rwo\u00a0 resources:\u00a0 \u00a0 requests:\u00a0 \u00a0 \u00a0 storage: 6Gi\n```\n\u5275\u5efa PersistentVolumeClaim \u6e05\u55ae\u5f8c\uff0c\u8acb\u904b\u884c\u4ee5\u4e0b\u547d\u4ee4\uff1a\n```\nkubectl create -f pvc-example.yaml\n```\n\u5728\u9810\u5b89\u88dd\u7684 StorageClass ( `standard-rwo` ) \u4e2d\uff0c\u5c07 `volumeBindingMode` \u8a2d\u7f6e\u7232 `WaitForFirstConsumer` \u3002\u5982\u679c\u5c07 `volumeBindingMode` \u8a2d\u7f6e\u7232 `WaitForFirstConsumer` \uff0c\u5247\u5728\u8abf\u5ea6\u5f15\u7528 PersistentVolumeClaim \u7684 Pod \u4e4b\u524d\uff0c\u7cfb\u7d71\u4e0d\u6703\u9810\u914d PersistentVolume\u3002\u5982\u679c\u5c07 StorageClass \u4e2d\u7684 `volumeBindingMode` \u8a2d\u7f6e\u7232 `Immediate` \uff08\u6216\u8005\u5c07\u5176\u7701\u7565\uff09\uff0c\u5247\u5728\u5275\u5efa PersistentVolumeClaim \u5f8c\uff0c\u7cfb\u7d71\u6703\u9810\u914d\u57fa\u65bc\u6c38\u4e45\u6027\u78c1\u76e4\u7684 PersistentVolume\u3002\n### \u5275\u5efa\u4f7f\u7528\u8a72\u5377\u7684 Pod\n\u5c07 Pod \u8207 PersistentVolume \u642d\u914d\u4f7f\u7528\u6642\uff0c\u6211\u5011\u5efa\u8b70\u60a8\u4f7f\u7528\u5de5\u4f5c\u8ca0\u8f09\u63a7\u5236\u5668\uff08\u4f8b\u5982 Deployment \u6216 StatefulSet\uff09\u3002\u96d6\u7136\u60a8\u901a\u5e38\u4e0d\u6703\u4f7f\u7528\u4e00\u500b\u7368\u7acb\u7684 Pod\uff0c\u4f46\u4ee5\u4e0b\u793a\u4f8b\u7232\u7c21\u55ae\u8d77\u898b\u4f7f\u7528\u4e86\u4e00\u500b Pod\u3002\n\u4ee5\u4e0b\u793a\u4f8b\u5c07\u4f7f\u7528\u60a8\u5728\u4e0a\u4e00\u90e8\u5206\u4e2d\u5275\u5efa\u7684\u5377\uff1a\n```\napiVersion: v1kind: Podmetadata:\u00a0 name: web-serverspec:\u00a0 containers:\u00a0 \u00a0- name: web-server\u00a0 \u00a0 \u00a0image: nginx\u00a0 \u00a0 \u00a0volumeMounts:\u00a0 \u00a0 \u00a0 \u00a0- mountPath: /var/lib/www/html\u00a0 \u00a0 \u00a0 \u00a0 \u00a0name: mypvc\u00a0 volumes:\u00a0 \u00a0- name: mypvc\u00a0 \u00a0 \u00a0persistentVolumeClaim:\u00a0 \u00a0 \u00a0 \u00a0claimName: podpvc\u00a0 \u00a0 \u00a0 \u00a0readOnly: false\n```\n## \u4f7f\u7528\u9069\u7528\u65bc Windows \u96c6\u7fa3\u7684 Compute Engine \u6c38\u4e45\u6027\u78c1\u76e4 CSI \u9a45\u52d5\u7a0b\u5e8f\n\u4ee5\u4e0b\u5e7e\u500b\u90e8\u5206\u4ecb\u7d39\u4e86\u5728 GKE \u4e2d\u4f7f\u7528 CSI \u9a45\u52d5\u7a0b\u5e8f\u652f\u6301\u7684 Kubernetes \u5377\u7684\u5178\u578b\u904e\u7a0b\u3002 \u9019\u4e9b\u90e8\u5206\u91dd\u5c0d\u4f7f\u7528 Windows \u7684\u96c6\u7fa3\u3002\n\u78ba\u4fdd\uff1a\n- \u96c6\u7fa3\u7248\u672c\u7232 1.19.7-gke.2000\u30011.20.2-gke.2000 \u6216\u66f4\u9ad8\u7248\u672c\u3002\n- \u7bc0\u9ede\u7248\u672c\u7232 1.18.12-gke.1203\u30011.19.6-gke.800 \u6216\u66f4\u9ad8\u7248\u672c\u3002\n### \u5275\u5efa\u4e00\u500b StorageClass\n\u5275\u5efa\u9069\u7528\u65bc Windows \u7684 StorageClass \u7684\u904e\u7a0b\u8207 Linux \u975e\u5e38\u76f8\u4f3c\u3002\u8acb\u6ce8\u610f\uff0c\u9ed8\u8a8d\u5b89\u88dd\u7684 StorageClass \u4e26\u4e0d\u9069\u7528\u65bc Windows\uff0c\u56e0\u7232\u6587\u4ef6\u7cfb\u7d71\u985e\u578b\u4e0d\u540c\u3002\u9069\u7528\u65bc Windows \u7684 Compute Engine \u6c38\u4e45\u6027\u78c1\u76e4 CSI \u9a45\u52d5\u7a0b\u5e8f\u9700\u8981\u4ee5 `NTFS` \u4f5c\u7232\u6587\u4ef6\u7cfb\u7d71\u985e\u578b\u3002\n\u4f8b\u5982\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u540d\u7232 `pd- windows-class.yaml` \u7684\u6587\u4ef6\u5275\u5efa\u4e00\u500b StorageClass\u3002\u8acb\u52d9\u5fc5\u5c07 `csi.storage.k8s.io/fstype: NTFS` \u6dfb\u52a0\u5230\u53c3\u6578\u5217\u8868\u4e2d\uff1a\n```\napiVersion: storage.k8s.io/v1kind: StorageClassmetadata:\u00a0 name: pd-sc-windowsprovisioner: pd.csi.storage.gke.iovolumeBindingMode: WaitForFirstConsumerallowVolumeExpansion: trueparameters:\u00a0 type: pd-balanced\u00a0 csi.storage.k8s.io/fstype: NTFS\n```\n### \u5275\u5efa\u4e00\u500b PersistentVolumeClaim\n\u5275\u5efa\u9069\u7528\u65bc Windows \u7684 StorageClass \u5f8c\uff0c\u60a8\u4fbf\u53ef\u4ee5\u5275\u5efa\u5f15\u7528\u8a72 StorageClass \u7684 PersistentVolumeClaim\uff1a\n```\nkind: PersistentVolumeClaimapiVersion: v1metadata:\u00a0 name: podpvc-windowsspec:\u00a0 accessModes:\u00a0 - ReadWriteOnce\u00a0 storageClassName: pd-sc-windows\u00a0 resources:\u00a0 \u00a0 requests:\u00a0 \u00a0 \u00a0 storage: 6Gi\n```\n### \u5275\u5efa\u4f7f\u7528\u8a72\u5377\u7684 Pod\n\u4ee5\u4e0b\u793a\u4f8b\u5c07\u4f7f\u7528\u60a8\u5728\u4e0a\u4e00\u4efb\u52d9\u4e2d\u5275\u5efa\u7684\u5377\uff1a\n```\napiVersion: v1kind: Podmetadata:\u00a0 name: web-serverspec:\u00a0 nodeSelector:\u00a0 \u00a0 kubernetes.io/os: windows\u00a0 containers:\u00a0 \u00a0 - name: iis-server\u00a0 \u00a0 \u00a0 image: mcr.microsoft.com/windows/servercore/iis\u00a0 \u00a0 \u00a0 ports:\u00a0 \u00a0 \u00a0 - containerPort: 80\u00a0 \u00a0 \u00a0 volumeMounts:\u00a0 \u00a0 \u00a0 - mountPath: /var/lib/www/html\u00a0 \u00a0 \u00a0 \u00a0 name: mypvc\u00a0 volumes:\u00a0 \u00a0 - name: mypvc\u00a0 \u00a0 \u00a0 persistentVolumeClaim:\u00a0 \u00a0 \u00a0 \u00a0 claimName: podpvc-windows\u00a0 \u00a0 \u00a0 \u00a0 readOnly: false\n```\n## \u4f7f\u7528\u5177\u6709\u975e\u9ed8\u8a8d\u6587\u4ef6\u7cfb\u7d71\u985e\u578b\u7684 Compute Engine \u6c38\u4e45\u6027\u78c1\u76e4 CSI \u9a45\u52d5\u7a0b\u5e8f\nGKE \u4e2d Compute Engine \u6c38\u4e45\u6027\u78c1\u76e4\u7684\u9ed8\u8a8d\u6587\u4ef6\u7cfb\u7d71\u985e\u578b\u7232 `ext4` \u3002\u53ea\u8981\u7bc0\u9ede\u6620\u50cf\u652f\u6301\u8a72\u985e\u578b\uff0c\u60a8\u4e5f\u53ef\u4ee5\u4f7f\u7528 `xfs` \u5b58\u5132\u985e\u578b\u3002\u5982\u9700\u67e5\u770b\u7bc0\u9ede\u6620\u50cf\u652f\u6301\u7684\u9a45\u52d5\u7a0b\u5e8f\u5217\u8868\uff0c\u8acb\u53c3\u95b1 [\u5b58\u5132\u9a45\u52d5\u7a0b\u5e8f\u652f\u6301](https://cloud.google.com/kubernetes-engine/docs/concepts/node-images?hl=zh-cn#storage_driver_support) \u3002\n\u4ee5\u4e0b\u793a\u4f8b\u5c55\u793a\u77ad\u5982\u4f55\u5c07 `xfs` \uff08\u800c\u975e `ext4` \uff09\u7528\u4f5c Compute Engine \u6c38\u4e45\u6027\u78c1\u76e4 CSI \u9a45\u52d5\u7a0b\u5e8f\u7684\u9ed8\u8a8d\u6587\u4ef6\u7cfb\u7d71\u985e\u578b\u3002\n### \u5275\u5efa\u4e00\u500b StorageClass\n- \u5c07\u4ee5\u4e0b\u6e05\u55ae\u4fdd\u5b58\u7232\u540d\u7232 `pd-xfs-class.yaml` \u7684 YAML \u6587\u4ef6\uff1a```\napiVersion: storage.k8s.io/v1kind: StorageClassmetadata:\u00a0 name: xfs-classprovisioner: pd.csi.storage.gke.ioparameters:\u00a0 type: pd-balanced\u00a0 csi.storage.k8s.io/fstype: xfsvolumeBindingMode: WaitForFirstConsumer\n```\n- \u61c9\u7528\u6e05\u55ae\uff1a```\nkubectl apply -f pd-xfs-class.yaml\n```\n### \u5275\u5efa\u4e00\u500b PersistentVolumeClaim\n- \u5c07\u4ee5\u4e0b\u6e05\u55ae\u4fdd\u5b58\u7232 `pd-xfs-pvc.yaml` \uff1a```\napiVersion: v1kind: PersistentVolumeClaimmetadata:\u00a0 name: xfs-pvcspec:\u00a0 storageClassName: xfs-class\u00a0 accessModes:\u00a0 \u00a0 - ReadWriteOnce\u00a0 resources:\u00a0 \u00a0 requests:\u00a0 \u00a0 \u00a0 storage: 10Gi\n```\n- \u61c9\u7528\u6e05\u55ae\uff1a```\nkubectl apply -f pd-xfs-pvc.yaml\n```\n### \u5275\u5efa\u4f7f\u7528\u8a72\u5377\u7684 Pod\n- \u5c07\u4ee5\u4e0b\u6e05\u55ae\u4fdd\u5b58\u7232 `pd-xfs-pod.yaml` \uff1a```\napiVersion: v1kind: Podmetadata:\u00a0 name: pd-xfs-podspec:\u00a0 containers:\u00a0 - name: cloud-sdk\u00a0 \u00a0 image: google/cloud-sdk:slim\u00a0 \u00a0 args: [\"sleep\",\"3600\"]\u00a0 \u00a0 volumeMounts:\u00a0 \u00a0 - mountPath: /xfs\u00a0 \u00a0 \u00a0 name: xfs-volume\u00a0 volumes:\u00a0 - name: xfs-volume\u00a0 \u00a0 persistentVolumeClaim:\u00a0 \u00a0 \u00a0 claimName: xfs-pvc\n```\n- \u61c9\u7528\u6e05\u55ae\uff1a```\nkubectl apply -f pd-xfs-pod.yaml\n```\n### \u9a57\u8b49\u5377\u662f\u5426\u5df2\u6b63\u78ba\u88dd\u8f09\n- \u5728 Pod \u4e2d\u6253\u958b shell \u6703\u8a71\uff1a```\nkubectl exec -it pd-xfs-pod -- /bin/bash\n```\n- \u67e5\u627e `xfs` \u5206\u5340\uff1a```\ndf -aTh --type=xfs\n```\u8f38\u51fa\u61c9\u985e\u4f3c\u5982\u4e0b\u6240\u793a\uff1a```\nFilesystem  Type Size Used Avail Use% Mounted on\n/dev/sdb  xfs 30G 63M 30G 1% /xfs\n```## \u67e5\u770b Compute Engine \u6c38\u4e45\u6027\u78c1\u76e4 CSI \u9a45\u52d5\u7a0b\u5e8f\u7684\u65e5\u8a8c\n\u60a8\u53ef\u4ee5\u4f7f\u7528 Cloud Logging \u67e5\u770b\u8207 Compute Engine \u6c38\u4e45\u6027\u78c1\u76e4 CSI \u9a45\u52d5\u7a0b\u5e8f\u76f8\u95dc\u7684\u4e8b\u4ef6\u3002\u65e5\u8a8c\u53ef\u5e6b\u52a9\u60a8\u6392\u67e5\u554f\u984c\u3002\n\u5982\u9700\u8a73\u7d30\u77ad\u89e3 Cloud Logging\uff0c\u8acb\u53c3\u95b1 [\u67e5\u770b GKE \u65e5\u8a8c](https://cloud.google.com/stackdriver/docs/solutions/gke/using-logs?hl=zh-cn) \u3002\n\u5982\u9700\u67e5\u770b Compute Engine \u6c38\u4e45\u6027\u78c1\u76e4 CSI \u9a45\u52d5\u7a0b\u5e8f\u7684\u65e5\u8a8c\uff0c\u8acb\u5b8c\u6210\u4ee5\u4e0b\u6b65\u9a5f\uff1a\n- \u8f49\u5230 Google Cloud \u63a7\u5236\u6aaf\u4e2d\u7684 **Cloud Logging** \u9801\u9762\u3002 [\u8f49\u5230 Cloud Logging](https://console.cloud.google.com/logs?hl=zh-cn) \n- \u8acb\u904b\u884c\u4ee5\u4e0b\u67e5\u8a62\uff1a```\n\u00a0resource.type=\"k8s_container\"\u00a0resource.labels.project_id=\"PROJECT_ID\"\u00a0resource.labels.location=\"LOCATION\"\u00a0resource.labels.cluster_name=\"CLUSTER_NAME\"\u00a0resource.labels.namespace_name=\"kube-system\"\u00a0resource.labels.container_name=\"gce-pd-driver\"\n```\u66ff\u63db\u4ee5\u4e0b\u5167\u5bb9\uff1a- ``\uff1a\u60a8\u7684\u9805\u76ee\u7684\u540d\u7a31\u3002\n- ``\uff1a\u96c6\u7fa3\u7684 Compute Engine \u5340\u57df\u6216\u53ef\u7528\u5340\u3002\n- ``\uff1a\u60a8\u7684\u96c6\u7fa3\u7684\u540d\u7a31\u3002\n## \u5df2\u77e5\u554f\u984c\n### \u4e0d\u652f\u6301\u7684\u6a5f\u5668\u985e\u578b\n\u5982\u679c\u60a8\u4f7f\u7528\u7684\u662f C3 \u7cfb\u5217\u6a5f\u5668\u7cfb\u5217\uff0c\u5247 `pd-standard` \u6c38\u4e45\u6027\u78c1\u76e4\u985e\u578b\u4e0d\u53d7\u652f\u6301\u3002\n\u5982\u679c\u60a8\u5617\u8a66\u5728\u6a5f\u5668\u4e0a\u904b\u884c Pod\uff0c\u4e26\u4e14\u8a72 Pod \u4f7f\u7528\u4e0d\u53d7\u652f\u6301\u7684\u6c38\u4e45\u6027\u78c1\u76e4\u985e\u578b\uff0c\u60a8\u5c07\u770b\u5230 Pod \u4e0a\u767c\u51fa\u7684\u5982\u4e0b\u8b66\u544a\u6d88\u606f\uff1a\n```\nAttachVolume.Attach failed for volume \"pvc-d7397693-5097-4a70-9df0-b10204611053\" : rpc error: code = Internal desc = unknown Attach error: failed when waiting for zonal op: operation operation-1681408439910-5f93b68c8803d-6606e4ed-b96be2e7 failed (UNSUPPORTED_OPERATION): [pd-standard] features are not compatible for creating instance.\n```\n\u5982\u679c\u60a8\u7684\u96c6\u7fa3\u5305\u542b\u591a\u500b\u5177\u6709\u4e0d\u540c\u6a5f\u5668\u7cfb\u5217\u7684\u7bc0\u9ede\u6c60\uff0c\u5247\u60a8\u53ef\u4ee5\u4f7f\u7528 [\u7bc0\u9ede\u6c61\u9ede](https://cloud.google.com/kubernetes-engine/docs/how-to/node-taints?hl=zh-cn#create_a_cluster_with_node_taints) \u548c [\u7bc0\u9ede\u89aa\u548c\u6027](https://cloud.google.com/kubernetes-engine/docs/how-to/node-taints?hl=zh-cn#configure_pods_to_tolerate_a_taint) \u4f86\u9650\u5236\u53ef\u4ee5\u8abf\u5ea6\u5de5\u4f5c\u8ca0\u8f09\u7684\u4f4d\u7f6e\u3002\u4f8b\u5982\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528\u6b64\u65b9\u6cd5\u4f86\u9650\u5236\u4f7f\u7528 `pd-standard` \u7684\u5de5\u4f5c\u8ca0\u8f09\u5728\u4e0d\u53d7\u652f\u6301\u7684\u6a5f\u5668\u7cfb\u5217\u4e0a\u904b\u884c\u3002\n\u5982\u679c\u60a8\u4f7f\u7528\u7684\u662f `pd-extreme` \u6c38\u4e45\u6027\u78c1\u76e4\u985e\u578b\uff0c\u5247\u9700\u8981\u78ba\u4fdd\u5c07\u78c1\u76e4\u639b\u63a5\u5230\u5177\u6709\u9069\u7576\u6a5f\u5668\u914d\u7f6e\u7684\u865b\u64ec\u6a5f\u5be6\u4f8b\u3002\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [\u6a5f\u5668\u914d\u7f6e\u652f\u6301](https://cloud.google.com/compute/docs/disks/extreme-persistent-disk?hl=zh-cn#machine_shape_support) \u3002\n## \u5f8c\u7e8c\u6b65\u9a5f\n- [\u77ad\u89e3\u5982\u4f55\u4f7f\u7528\u5377\u64f4\u5c55\u529f\u80fd](https://cloud.google.com/kubernetes-engine/docs/how-to/persistent-volumes/volume-expansion?hl=zh-cn) \u3002\n- [\u77ad\u89e3\u5982\u4f55\u4f7f\u7528\u5377\u5feb\u7167](https://cloud.google.com/kubernetes-engine/docs/how-to/persistent-volumes/volume-snapshots?hl=zh-cn) \u3002\n- [\u77ad\u89e3\u5982\u4f55\u4f7f\u7528\u5377\u514b\u9686](https://cloud.google.com/kubernetes-engine/docs/how-to/persistent-volumes/volume-cloning?hl=zh-cn) \u3002\n- [\u5728 GitHub \u4e0a\u8a73\u7d30\u77ad\u89e3\u8a72\u9a45\u52d5\u7a0b\u5e8f](https://github.com/kubernetes-sigs/gcp-compute-persistent-disk-csi-driver) \u3002", "guide": "Google Kubernetes Engine (GKE)"}