{"title": "Google Kubernetes Engine (GKE) - \u5c07 Kubernetes Beta \u7248 API \u8207 GKE \u96c6\u7fa3\u642d\u914d\u4f7f\u7528", "url": "https://cloud.google.com/kubernetes-engine/docs/how-to/use-beta-apis?hl=zh-cn", "abstract": "# Google Kubernetes Engine (GKE) - \u5c07 Kubernetes Beta \u7248 API \u8207 GKE \u96c6\u7fa3\u642d\u914d\u4f7f\u7528\n[\u914d\u7f6e Beta \u7248 API](#configure-beta-apis)\n", "content": "## Kubernetes API \u5982\u4f55\u5f15\u5165\u65b0\u529f\u80fd\nGKE \u96c6\u7fa3\u7531\u63a7\u5236\u5e73\u9762\u548c\u5de5\u4f5c\u5668\u7bc0\u9ede [\u7d44\u6210](https://cloud.google.com/kubernetes-engine/docs/concepts/cluster-architecture?hl=zh-cn) \u3002\u63a7\u5236\u5e73\u9762\u516c\u958b API \u670d\u52d9\u5668\uff0c\u8a72\u670d\u52d9\u5668\u516c\u958b [Kubernetes API](https://kubernetes.io/docs/concepts/overview/kubernetes-api/) \uff0c\u4ee5\u4fbf\u6700\u7d42\u7528\u6236\u4ee5\u53ca\u5167\u90e8\u7d44\u4ef6\u548c\u5916\u90e8\u7d44\u4ef6\u53ef\u4ee5\u901a\u4fe1\u3002\u6b64 API \u6703\u96a8\u7740\u6642\u9593\u7684\u63a8\u79fb\u800c\u4e0d\u65b7\u767c\u5c55\uff0c\u65b0\u529f\u80fd [\u5728 Alpha \u7248\u6216 Beta \u7248\u968e\u6bb5\u4e2d\u5f15\u5165](https://kubernetes.io/docs/reference/using-api/#api-versioning) \uff0c\u7136\u5f8c\u6700\u7d42\u5347\u7d1a\u5230\u6b63\u5f0f\u7248 (GA) \u6216\u5728\u8f03\u65b0\u7684\u6b21\u8981\u7248\u672c\u4e2d\u68c4\u7528\u4e26\u79fb\u9664\u3002\n\u60a8\u53ea\u80fd\u5c07 Alpha \u7248 API \u8207 [Alpha \u7248\u96c6\u7fa3](https://cloud.google.com/kubernetes-engine/docs/concepts/alpha-clusters?hl=zh-cn) \u642d\u914d\u4f7f\u7528\uff0c\u4f46\u53ef\u4ee5\u5c07 Beta \u7248 API \u8207\u6240\u6709\u985e\u578b\u7684 GKE \u96c6\u7fa3\u642d\u914d\u4f7f\u7528\u3002\u5f9e Kubernetes 1.24 \u7248\u958b\u59cb\uff0c\u65b0 Beta \u7248 API \u9ed8\u8a8d\u5728\u65b0\u96c6\u7fa3\u4e2d\u505c\u7528\u3002\u904b\u884c 1.24 \u4e4b\u524d\u7248\u672c\u5275\u5efa\u7684\u73fe\u6709\u96c6\u7fa3\u5c07\u8b93\u73fe\u6709 Beta \u7248 API \u4fdd\u6301\u5553\u7528\u72c0\u614b\uff0c\u56e0\u7232\u7121\u6cd5\u5728\u73fe\u6709\u96c6\u7fa3\u4e0a\u7981\u7528\u81ea\u52d5\u5553\u7528\uff081.24 \u4e4b\u524d\u5f15\u5165\uff09\u6216\u624b\u52d5\u5553\u7528\u7684 [Beta \u7248 API](#configure-beta-apis) \uff081.24 \u6216\u66f4\u9ad8\u7248\u672c\u5f15\u5165\uff09\u3002\u5c0d\u65bc\u6240\u6709\u96c6\u7fa3\uff0c\u7248\u672c 1.24 \u4e4b\u524d\u5f15\u5165\u7684\u73fe\u6709 Beta \u7248 API \u9ed8\u8a8d\u4fdd\u6301\u5553\u7528\u72c0\u614b\uff0c\u73fe\u6709 Beta \u7248 API \u7684\u65b0\u7248\u672c\u4e5f\u6703\u9ed8\u8a8d\u4fdd\u6301\u5553\u7528\u72c0\u614b\u3002\n\u4f8b\u5982\uff0c\u5982\u679c\u5728 Kubernetes API 1.22 \u7248\u4e2d\u5f15\u5165\u4e86 `v1beta1` API\uff0c\u7136\u5f8c\u5728 Kubernetes Beta 1.25 \u7248\u4e2d\u5f15\u5165\u4e86\u6b64 Beta \u7248 API \u7684\u65b0\u7248\u672c\uff08\u4f8b\u5982 `v1beta3` \uff09\uff0c\u5247\u8a72 API \u6703\u81ea\u52d5\u5553\u7528\u3002\u9019\u662f\u56e0\u7232\u5b83\u662f\u73fe\u6709 Beta \u7248 API \u7684\u65b0\u7248\u672c\uff0c\u800c\u4e0d\u662f\u5168\u65b0\u7684 Beta \u7248 API\u3002\u4f46\u662f\uff0c\u5728 Kubernetes 1.24 \u7248\u6216\u66f4\u9ad8\u7248\u672c\u4e2d\u5f15\u5165\u7684 `v1beta1` \u7248\u672c\u7684\u65b0 Beta \u7248 API \u9ed8\u8a8d\u8655\u65bc\u505c\u7528\u72c0\u614b\u3002\n\u5982\u9700\u4f7f\u7528\u5728 1.24 \u7248\u53ca\u66f4\u9ad8\u7248\u672c\u4e2d\u5f15\u5165\u7684 Beta \u7248 API\uff0c\u60a8\u5fc5\u9808\u7232\u6bcf\u500b\u96c6\u7fa3\u7684\u6bcf\u500b\u8cc7\u6e90 [\u914d\u7f6e Beta \u7248 API](#configure-beta-apis) \u3002\u60a8\u53ef\u4ee5 [\u5728\u5275\u5efa\u96c6\u7fa3\u6642](#create-cluster-beta-apis) \u6216 [\u7232\u73fe\u6709\u96c6\u7fa3](#update-existing-cluster-beta-apis) \u5553\u7528 API\u3002\u5982\u9700\u67e5\u770b\u96c6\u7fa3\u7684\u6b21\u8981\u7248\u672c\u53ef\u7528\u7684 Beta \u7248 API\uff0c\u8acb\u53c3\u95b1 [\u53ef\u7528\u7684 Beta \u7248 API](#available-beta-apis) \u3002\n\u5553\u7528 Beta \u7248 API \u5f8c\uff0c\u5b83\u5c07\u4fdd\u6301\u5553\u7528\u72c0\u614b\uff0c\u76f4\u5230 Beta \u7248 API \u88ab\u68c4\u7528\u4e26\u4e14\u96c6\u7fa3\u5347\u7d1a\u5230 API \u88ab\u79fb\u9664\u7684\u6b21\u8981\u7248\u672c\u3002 \u5982\u9700\u67e5\u770b\u60a8\u7684\u96c6\u7fa3\u5df2\u5553\u7528\u54ea\u4e9b Beta \u7248 API\uff0c\u8acb\u53c3\u95b1 [\u6aa2\u67e5\u5df2\u5553\u7528\u54ea\u4e9b Beta \u7248 API](#check-beta-apis-enabled) \u3002\n### \u53ef\u7528\u7684 Beta \u7248 API\n\u60a8\u53ef\u4ee5\u7232 GKE \u96c6\u7fa3\u5553\u7528\u4e00\u90e8\u5206 Kubernetes Beta \u7248 API\u3002\u5176\u4ed6 Beta \u7248 API \u4e0d\u53ef\u7528\u7684\u539f\u56e0\u5305\u62ec\uff1a\n- Beta \u7248 API \u4f9d\u8cf4\u65bc\u975e\u6b63\u5f0f\u7248 Kubernetes \u529f\u80fd\u3002\n- Beta \u7248 API \u4e0d\u5b89\u5168\u3002\n- Beta \u7248 API \u8207 Autopilot \u4e0d\u517c\u5bb9\u3002\n\u4e0b\u8868\u4e2d\u5217\u51fa\u4e86 Beta \u7248 API \u4ee5\u53ca\u5f15\u5165\u9019\u4e9b API \u7684\u76f8\u61c9\u6b21\u8981\u7248\u672c\uff1a\n| Kubernetes \u7248\u672c | \u96a8\u6b64 Kubernetes \u6b21\u8981\u7248\u672c\u6dfb\u52a0\u7684 Beta \u7248 API                        | GKE \u53ef\u7528                                | Notes              |\n|------------------:|:----------------------------------------------------------------------------------------------------------------------------------------|:----------------------------------------------------------------------------------------------------------------------------------------|:-------------------------------------------------------------|\n|    1.29 | \u7121                                  | admissionregistration.k8s.io/v1beta1/validatingadmissionpolicies admissionregistration.k8s.io/v1beta1/validatingadmissionpolicybindings | \u60a8\u5fc5\u9808\u540c\u6642\u5553\u7528\u9019\u5169\u500b API\u3002\u9019\u6703\u5553\u7528\u9a57\u8b49\u51c6\u8a31\u653f\u7b56 Beta \u7248\u529f\u80fd\u3002 |\n|    1.28 | admissionregistration.k8s.io/v1beta1/validatingadmissionpolicies admissionregistration.k8s.io/v1beta1/validatingadmissionpolicybindings | \u7121                                  | nan               |\n|    1.27 | authentication.k8s.io/v1beta1/selfsubjectreviews                      | authentication.k8s.io/v1beta1/selfsubjectreviews                      | nan               |\n## \u4f7f\u7528 Beta \u7248 API \u4e4b\u524d\u7684\u6ce8\u610f\u4e8b\u9805\nKubernetes Beta \u7248 API \u53d7 [Kubernetes \u68c4\u7528\u653f\u7b56](https://kubernetes.io/docs/reference/using-api/deprecation-policy/) \u7684\u7d04\u675f\u3002\u6e2c\u8a66\u7248 API \u88ab\u68c4\u7528\u5f8c\uff0c\u60a8\u5fc5\u9808\u505c\u6b62\u4f7f\u7528\u8a72 API\u3002\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [Beta \u7248 API \u68c4\u7528](#beta-api-deprecations) \u3002\n## \u6e96\u5099\u5de5\u4f5c\n\u5728\u958b\u59cb\u4e4b\u524d\uff0c\u8acb\u78ba\u4fdd\u60a8\u5df2\u57f7\u884c\u4ee5\u4e0b\u4efb\u52d9\uff1a\n- \u5553\u7528 Google Kubernetes Engine API\u3002\n- [  \u5553\u7528 Google Kubernetes Engine API ](https://console.cloud.google.com/flows/enableapi?apiid=container.googleapis.com&hl=zh-cn) \n- \u5982\u679c\u60a8\u8981\u4f7f\u7528 Google Cloud CLI \u57f7\u884c\u6b64\u4efb\u52d9\uff0c\u8acb [\u5b89\u88dd](https://cloud.google.com/sdk/docs/install?hl=zh-cn) \u4e26 [\u521d\u59cb\u5316](https://cloud.google.com/sdk/docs/initializing?hl=zh-cn) gcloud CLI\u3002 \u5982\u679c\u60a8\u4e4b\u524d\u5b89\u88dd\u4e86 gcloud CLI\uff0c\u8acb\u904b\u884c`gcloud components update`\u4ee5\u7372\u53d6\u6700\u65b0\u7248\u672c\u3002 **\u6ce8\u610f** \uff1a\u5c0d\u65bc\u73fe\u6709 gcloud CLI \u5b89\u88dd\uff0c\u8acb\u52d9\u5fc5\u8a2d\u7f6e`compute/region`\u548c`compute/zone` [\u5c6c\u6027](https://cloud.google.com/sdk/docs/properties?hl=zh-cn#setting_properties) \u3002\u901a\u904e\u8a2d\u7f6e\u9ed8\u8a8d\u4f4d\u7f6e\uff0c\u60a8\u53ef\u4ee5\u907f\u514d gcloud CLI \u4e2d\u51fa\u73fe\u4ee5\u4e0b\u932f\u8aa4\uff1a`One of [--zone, --region] must be supplied: Please specify location`\u3002## \u914d\u7f6e Beta \u7248 API\nBeta \u7248 API \u6703\u7232\u6bcf\u500b\u96c6\u7fa3\u7684\u6bcf\u500b\u8cc7\u6e90\u5553\u7528\u3002\u60a8\u53ef\u4ee5\u5728\u5275\u5efa\u96c6\u7fa3\u6642\u6216\u7232\u73fe\u6709\u96c6\u7fa3\u5553\u7528 API\u3002\n\u5982\u9700\u5217\u51fa\u9019\u4e9b\u547d\u4ee4\u7684 Beta \u7248 API \u8cc7\u6e90\uff0c\u8acb\u4f7f\u7528\u8868\u793a\u6cd5 `{group}/{version}/{resource}` \u3002\u7248\u672c\u5fc5\u9808\u662f Beta \u7248\u3002\u6b64\u6709\u6548\u8868\u793a\u6cd5\u7684\u4e00\u500b\u793a\u4f8b\u7232 `authentication.k8s.io/v1beta1/selfsubjectreviews` \u3002\n\u5c0d\u65bc\u4e0b\u4e00\u90e8\u5206\u4e2d\u7684\u547d\u4ee4\uff0c\u8acb\u66ff\u63db\u4ee5\u4e0b\u8b8a\u91cf\uff1a\n- ``\uff1a\u60a8\u8981\u66f4\u65b0\u7684\u96c6\u7fa3\u7684\u540d\u7a31\u3002\n- ``\uff1a\u60a8\u8981\u5553\u7528\u7684 Beta \u7248 API \u7684\u5217\u8868\uff0c\u4ee5\u82f1\u6587\u9017\u865f\u5206\u9694\u3002\n- ``\uff1a\u65b0\u96c6\u7fa3\u7684 [Compute Engine \u5730\u5340](https://cloud.google.com/compute/docs/regions-zones?hl=zh-cn#available) \u3002\u5c0d\u65bc\u53ef\u7528\u5340\u7d1a\u96c6\u7fa3\uff0c\u8acb\u4f7f\u7528`--zone=` ``\u3002\n### \u5275\u5efa\u5553\u7528\u4e86 Beta \u7248 API \u7684\u65b0\u96c6\u7fa3\n\u5275\u5efa\u5553\u7528\u4e86 Beta \u7248 API \u5217\u8868\u7684\u65b0\u96c6\u7fa3\uff1a\n```\ngcloud container clusters create-auto CLUSTER_NAME \u00a0\\\u00a0 \u00a0 --enable-kubernetes-unstable-apis=LIST_OF_APIS \\\u00a0 \u00a0 --region=COMPUTE_REGION\n```\n### \u5728\u73fe\u6709\u96c6\u7fa3\u4e0a\u5553\u7528 Beta \u7248 API\n\u5728\u73fe\u6709\u96c6\u7fa3\u4e0a\u5553\u7528 Beta \u7248 API \u5217\u8868\uff1a\n```\ngcloud container clusters update CLUSTER_NAME \u00a0\\\u00a0 \u00a0 --enable-kubernetes-unstable-apis=LIST_OF_APIS \\\u00a0 \u00a0 --region=COMPUTE_REGION\n```\n### \u5728\u73fe\u6709\u96c6\u7fa3\u4e0a\u505c\u7528 Beta \u7248 API\n\u60a8\u7121\u6cd5\u505c\u7528\u96c6\u7fa3\u4e0a\u5df2\u5553\u7528\u7684 Beta \u7248 API\u3002Beta \u7248 API \u5728 API \u88ab\u68c4\u7528\u4ee5\u53ca\u96c6\u7fa3\u5347\u7d1a\u5230 API \u88ab\u79fb\u9664\u7684\u6b21\u8981\u7248\u672c\u4e4b\u524d\u4ecd\u7136\u53ef\u7528\u3002\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [Beta \u7248 API \u68c4\u7528](https://cloud.google.com/kubernetes-engine/docs/how-to/beta-api-deprecations?hl=zh-cn) \u3002\n## \u6aa2\u67e5\u5df2\u5553\u7528\u54ea\u4e9b Beta \u7248 API\n\u6aa2\u67e5\u60a8\u7684 GKE \u96c6\u7fa3\u5df2\u5553\u7528\u54ea\u4e9b Beta \u7248 API\uff1a\n```\ngcloud container clusters describe CLUSTER_NAME \\\u00a0 \u00a0 --region=COMPUTE_REGION \\\u00a0 \u00a0 --format=\"value(enableK8sBetaApis.enabledApis)\"\n```\n## Beta \u7248 API \u68c4\u7528\nBeta \u7248 API \u5553\u7528\u5f8c\u6703\u4fdd\u6301\u5553\u7528\u72c0\u614b\uff0c\u76f4\u5230 Beta \u7248 API \u88ab\u68c4\u7528\u4e26\u4e14\u96c6\u7fa3\u5347\u7d1a\u5230 API \u88ab\u79fb\u9664\u7684\u6b21\u8981\u7248\u672c\u7232\u6b62\u3002\nBeta \u7248 API \u7684\u53ef\u7528\u6642\u9593\u901a\u5e38\u7232\u4e09\u500b\u6b21\u8981\u7248\u672c\uff0c\u7136\u5f8c\u6703\u88ab\u68c4\u7528\uff0c\u53d6\u800c\u4ee3\u4e4b\u7684\u662f\u65b0\u7684 Beta \u7248\u3001\u7a69\u5b9a\u7248\u6216\u6c92\u6709\u66ff\u63db\u7248\u672c\u3002Beta \u7248 API \u7248\u672c\u6703\u5728\u68c4\u7528\u5f8c\u88ab\u79fb\u9664\u3002\u5982\u679c\u60a8\u4f7f\u7528\u7684\u662f\u5df2\u68c4\u7528\u4e26\u4e14\u5c07\u5728\u5373\u5c07\u767c\u4f48\u7684 Kubernetes \u6b21\u8981\u7248\u672c\u4e2d\u79fb\u9664\u7684 Beta \u7248 API\uff0c\u5247\u9700\u8981\u9077\u79fb\u5230\u53d7\u652f\u6301\u7684 API\uff0c\u4ee5\u4fbf\u60a8\u7684\u96c6\u7fa3\u53ef\u4ee5\u5347\u7d1a\u5230 Beta \u7248 API \u5c07\u88ab\u79fb\u9664\u7684\u6b21\u8981\u7248\u672c\u3002\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [Kubernetes \u68c4\u7528\u529f\u80fd\u5982\u4f55\u8207 GKE \u642d\u914d\u4f7f\u7528](https://cloud.google.com/kubernetes-engine/docs/deprecations?hl=zh-cn#how_kubernetes_deprecations_work_with) \u3002\nGKE \u6703\u5617\u8a66\u6aa2\u6e2c\u662f\u5426\u4f7f\u7528\u4e86\u5df2\u68c4\u7528\u7684 Kubernetes API\uff0c\u5f9e\u800c\u7c21\u5316\u6b64\u904e\u7a0b\u3002\u5982\u679c GKE \u6aa2\u6e2c\u5230\u4f7f\u7528\u4e86\u5df2\u68c4\u7528\u7684 API\uff0c\u5247\u6703 [\u66ab\u505c\u81ea\u52d5\u5347\u7d1a](https://cloud.google.com/kubernetes-engine/docs/deprecations?hl=zh-cn#auto-upgrade-pause) \u5230\u8a72 API \u88ab\u79fb\u9664\u7684\u6b21\u8981\u7248\u672c\u3002GKE \u9084\u6703\u5206\u4eab [\u68c4\u7528\u63d0\u793a\u548c\u5efa\u8b70](https://cloud.google.com/kubernetes-engine/docs/deprecations?hl=zh-cn#what-deprecation-insights-recs) \uff0c\u901a\u77e5\u60a8\u96c6\u7fa3\u4f7f\u7528\u4e86\u5df2\u68c4\u7528\u7684 API\uff0c\u4ee5\u4fbf\u60a8\u53ef\u4ee5\u63a1\u53d6\u63aa\u65bd\u4f86\u7e7c\u7e8c\u5347\u7d1a\u3002\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [\u8a55\u4f30\u548c\u7de9\u89e3\u5373\u5c07\u767c\u751f\u7684 Kubernetes \u68c4\u7528\u7684\u98a8\u96aa](https://cloud.google.com/kubernetes-engine/docs/deprecations?hl=zh-cn#assess_and_mitigate_exposure_to_upcoming_kubernetes_deprecations) \u3002\n\u5982\u9700\u67e5\u770b\u5df2\u68c4\u7528 API \u7684\u5b8c\u6574\u5217\u8868\u4ee5\u53ca GKE \u662f\u5426\u6aa2\u6e2c\u4f7f\u7528\u60c5\u6cc1\uff0c\u8acb\u53c3\u95b1 [Kubernetes API \u68c4\u7528\u8868](https://cloud.google.com/kubernetes-engine/docs/deprecations?hl=zh-cn#kubernetes_api_deprecations) \u3002\n## \u5f8c\u7e8c\u6b65\u9a5f\n- [GKE \u68c4\u7528](https://cloud.google.com/kubernetes-engine/docs/deprecations?hl=zh-cn)", "guide": "Google Kubernetes Engine (GKE)"}