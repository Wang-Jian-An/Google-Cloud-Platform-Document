{"title": "Google Kubernetes Engine (GKE) - \u591a\u96c6\u7fa3 Ingress \u7684\u554f\u984c\u6392\u67e5\u548c\u64cd\u4f5c", "url": "https://cloud.google.com/kubernetes-engine/docs/how-to/troubleshooting-and-ops?hl=zh-cn", "abstract": "# Google Kubernetes Engine (GKE) - \u591a\u96c6\u7fa3 Ingress \u7684\u554f\u984c\u6392\u67e5\u548c\u64cd\u4f5c\nGKE Enterprise Ingress \u63a7\u5236\u5668\u7528\u65bc\u7ba1\u7406 Compute Engine \u8cc7\u6e90\u3002 `MultiClusterIngress` \u548c `MultiClusterService` \u8cc7\u6e90\u6703\u6620\u5c04\u5230\u4e0d\u540c\u7684 Compute Engine \u8cc7\u6e90\uff0c\u56e0\u6b64\u77ad\u89e3\u9019\u4e9b\u8cc7\u6e90\u4e4b\u9593\u7684\u95dc\u4fc2\u6709\u52a9\u65bc\u60a8\u6392\u67e5\u554f\u984c\u3002\u4f8b\u5982\uff0c\u60a8\u53ef\u4ee5\u6aa2\u67e5\u4ee5\u4e0b `MultiClusterIngress` \u8cc7\u6e90\uff1a\n```\napiVersion: extensions/v1beta1kind: MultiClusterIngressmetadata:\u00a0 name: foo-ingressspec:\u00a0 rules:\u00a0 - host: store.foo.com\u00a0 \u00a0 http:\u00a0 \u00a0 \u00a0 paths:\u00a0 \u00a0 \u00a0 - backend:\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 serviceName: store-foo\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 servicePort: 80\u00a0 - host: search.foo.com\u00a0 \u00a0 http:\u00a0 \u00a0 \u00a0 paths:\u00a0 \u00a0 \u00a0 - backend:\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 serviceName: search-foo\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 servicePort: 80\n```\n#", "content": "## Compute Engine \u5230\u591a\u96c6\u7fa3 Ingress \u8cc7\u6e90\u7684\u6620\u5c04\n\u4e0b\u8868\u986f\u793a\u4e86\u968a\u5217\u8cc7\u6e90\u8207 Kubernetes \u96c6\u7fa3\u548c Google Cloud \u4e2d\u5275\u5efa\u7684\u8cc7\u6e90\u4e4b\u9593\u7684\u6620\u5c04\uff1a\n| Kubernetes \u8cc7\u6e90  | Google Cloud \u8cc7\u6e90 | \u8aaa\u660e            |\n|:--------------------|:--------------------|:---------------------------------------------------|\n| MultiClusterIngress | \u8f49\u767c\u898f\u5247   | HTTP(S) \u8ca0\u8f09\u5e73\u8861\u5668 VIP\u3002       |\n| MultiClusterIngress | \u76ee\u6a19\u4ee3\u7406   | \u5f9e\u8a3b\u91cb\u548c TLS \u584a\u7372\u53d6\u7684 HTTP/S \u7d42\u6b62\u8a2d\u7f6e\u3002   |\n| MultiClusterIngress | \u7db2\u5740\u6620\u5c04   | \u898f\u5247\u90e8\u5206\u4e2d\u7684\u865b\u64ec\u4e3b\u6a5f\u8def\u5f91\u6620\u5c04\u3002      |\n| MultiClusterService | Kubernetes Service | \u5f9e\u6a21\u677f\u6d3e\u751f\u7684\u8cc7\u6e90\u3002         |\n| MultiClusterService | \u5f8c\u7aef\u670d\u52d9   | \u7232\u6bcf\u500b (Service, ServicePort) \u5c0d\u5275\u5efa\u4e00\u500b\u5f8c\u7aef\u670d\u52d9\u3002 |\n| MultiClusterService | \u7db2\u7d61\u7aef\u9ede\u7d44   | \u53c3\u8207 Service \u7684\u4e00\u7d44\u5f8c\u7aef Pod\u3002      |\n## \u6aa2\u67e5 Compute Engine \u8ca0\u8f09\u5747\u8861\u5668\u8cc7\u6e90\n\u5275\u5efa\u8ca0\u8f09\u5747\u8861\u5668\u5f8c\uff0c\u591a\u96c6\u7fa3 Ingress \u72c0\u614b\u5c07\u5305\u542b\u7232\u69cb\u5efa\u8a72\u8ca0\u8f09\u5747\u8861\u5668\u800c\u5275\u5efa\u7684\u6bcf\u500b Compute Engine \u8cc7\u6e90\u7684\u540d\u7a31\u3002\u4f8b\u5982\uff1a\n```\nName: \u00a0 \u00a0 \u00a0 \u00a0 shopping-serviceNamespace: \u00a0 \u00a0prodLabels: \u00a0 \u00a0 \u00a0 <none>Annotations: \u00a0<none>API Version: \u00a0networking.gke.io/v1beta1Kind: \u00a0 \u00a0 \u00a0 \u00a0 MultiClusterIngressMetadata:\u00a0 Creation Timestamp: \u00a02019-07-16T17:23:14Z\u00a0 Finalizers:\u00a0 \u00a0 mci.finalizer.networking.gke.ioSpec:\u00a0 Template:\u00a0 \u00a0 Spec:\u00a0 \u00a0 \u00a0 Backend:\u00a0 \u00a0 \u00a0 \u00a0 Service Name: \u00a0shopping-service\u00a0 \u00a0 \u00a0 \u00a0 Service Port: \u00a080Status:\u00a0 VIP: \u00a034.102.212.68\u00a0 CloudResources:\u00a0 \u00a0 Firewalls: \"mci-l7\"\u00a0 \u00a0 ForwardingRules: \"mci-abcdef-myforwardingrule\"\u00a0 \u00a0 TargetProxies: \"mci-abcdef-mytargetproxy\"\u00a0 \u00a0 UrlMap: \"mci-abcdef-myurlmap\"\u00a0 \u00a0 HealthChecks: \"mci-abcdef-80-myhealthcheck\"\u00a0 \u00a0 BackendServices: \"mci-abcdef-80-mybackendservice\"\u00a0 \u00a0 NetworkEndpointGroups: \"k8s1-neg1\", \"k8s1-neg2\", \"k8s1-neg3\"\n```\n## \u672a\u5275\u5efa VIP\n\u5982\u679c\u672a\u770b\u5230 VIP \u5730\u5740\uff0c\u5247 VIP \u5730\u5740\u5275\u5efa\u904e\u7a0b\u53ef\u80fd\u51fa\u932f\u4e86\u3002\u5982\u9700\u67e5\u770b\u662f\u5426\u767c\u751f\u4e86\u932f\u8aa4\uff0c\u8acb\u904b\u884c\u4ee5\u4e0b\u547d\u4ee4\uff1a\n```\nkubectl describe mci shopping-service\n```\n\u8f38\u51fa\u53ef\u80fd\u985e\u4f3c\u65bc\u4ee5\u4e0b\u5167\u5bb9\uff1a\n```\nName:   shopping-service\nNamespace: prod\nLabels:  <none>\nAnnotations: <none>\nAPI Version: networking.gke.io/v1beta1\nKind:   MultiClusterIngress\nMetadata:\n Creation Timestamp: 2019-07-16T17:23:14Z\n Finalizers:\n mci.finalizer.networking.gke.io\nSpec:\n Template:\n Spec:\n  Backend:\n  Service Name: shopping-service\n  Service Port: 80\nStatus:\n VIP: 34.102.212.68\nEvents:\n Type  Reason Age From        Message\n ----  ------ ---- ----        ------ Warning SYNC 29s multi-cluster-ingress-controller error translating MCI prod/shopping-service: exceeded 4 retries with final error: error translating MCI prod/shopping-service: multiclusterservice prod/shopping-service does not exist\n```\n\u6b64\u793a\u4f8b\u4e4b\u6240\u4ee5\u51fa\u73fe\u932f\u8aa4\uff0c\u662f\u56e0\u7232\u7528\u6236\u6c92\u6709\u5275\u5efa\u7531 `MultiClusterIngress` \u5f15\u7528\u7684 `MultiClusterService` \u8cc7\u6e90\u3002\n## 502 \u97ff\u61c9\n\u5982\u679c\u60a8\u7684\u8ca0\u8f09\u5747\u8861\u5668\u7372\u5f97\u4e86 VIP \u5730\u5740\uff0c\u4f46\u4e00\u76f4\u63d0\u4f9b 502 \u97ff\u61c9\uff0c\u5247\u8868\u793a\u8ca0\u8f09\u5747\u8861\u5668\u5065\u5eb7\u6aa2\u67e5\u53ef\u80fd\u5931\u6557\u4e86\u3002\u5065\u5eb7\u6aa2\u67e5\u53ef\u80fd\u6703\u56e0\u5169\u500b\u539f\u56e0\u800c\u5931\u6557\uff1a\n- \u61c9\u7528 Pod \u904b\u884c\u72c0\u6cc1\u4e0d\u4f73\uff08\u4f8b\u5982\uff0c\u8acb\u53c3\u95b1 [Cloud \u63a7\u5236\u6aaf](#console-debugging) \u8abf\u8a66\uff09\u3002\n- \u9632\u706b\u7246\u914d\u7f6e\u6709\u8aa4\uff0c\u5c0e\u81f4 Google \u5065\u5eb7\u6aa2\u67e5\u5668\u7121\u6cd5\u57f7\u884c\u5065\u5eb7\u6aa2\u67e5\u3002\n\u5c0d\u65bc\u7b2c\u4e00\u7a2e\u539f\u56e0\uff0c\u8acb\u78ba\u4fdd\u60a8\u7684\u61c9\u7528\u78ba\u5be6\u5728\u201c/\u201d\u8def\u5f91\u4e0a\u63d0\u4f9b\u4e86 200 \u97ff\u61c9\u3002\n\u5c0d\u65bc\u7b2c\u4e8c\u7a2e\u539f\u56e0\uff0c\u8acb\u78ba\u4fdd\u60a8\u7684 VPC \u4e2d\u5b58\u5728\u540d\u7232\u201cmci-default-l7\u201d\u7684\u9632\u706b\u7246\u3002Ingress \u63a7\u5236\u5668\u6703\u5728\u60a8\u7684 VPC \u4e2d\u5275\u5efa\u9632\u706b\u7246\uff0c\u4ee5\u78ba\u4fdd Google \u5065\u5eb7\u6aa2\u67e5\u5668\u53ef\u4ee5\u8a2a\u554f\u60a8\u7684\u5f8c\u7aef\u3002\u5982\u679c\u9632\u706b\u7246\u4e0d\u5b58\u5728\uff0c\u8acb\u78ba\u4fdd\u6c92\u6709\u4efb\u4f55\u5916\u90e8\u81ea\u52d5\u5316\u6a5f\u5236\u6703\u5728\u9632\u706b\u7246\u5275\u5efa\u6642\u5c07\u5176\u522a\u9664\u3002\n## \u6d41\u91cf\u672a\u6dfb\u52a0\u5230\u96c6\u7fa3\u6216\u672a\u5f9e\u96c6\u7fa3\u79fb\u9664\n\u6dfb\u52a0\u65b0\u7684\u6210\u54e1\u8cc7\u683c\u6642\uff0c\u6d41\u91cf\u61c9\u5728\u9069\u7528\u6642\u5230\u9054\u5e95\u5c64\u96c6\u7fa3\u4e2d\u7684\u5f8c\u7aef\u3002\u540c\u6a23\uff0c\u5982\u679c\u79fb\u9664\u4e86\u6210\u54e1\u8cc7\u683c\uff0c\u5247\u4efb\u4f55\u6d41\u91cf\u90fd\u4e0d\u61c9\u5230\u9054\u5e95\u5c64\u96c6\u7fa3\u4e2d\u7684\u5f8c\u7aef\u3002\u5982\u679c\u60a8\u672a\u89c0\u5bdf\u5230\u6b64\u884c\u7232\uff0c\u8acb\u6aa2\u67e5 `MultiClusterIngress` \u548c `MultiClusterService` \u8cc7\u6e90\u662f\u5426\u5b58\u5728\u932f\u8aa4\u3002\n\u767c\u751f\u6b64\u932f\u8aa4\u7684\u5e38\u898b\u60c5\u6cc1\u5305\u62ec\uff1a\u5728\u672a\u8655\u65bc VPC \u539f\u751f\u6a21\u5f0f\u7684 GKE \u96c6\u7fa3\u4e0a\u6dfb\u52a0\u65b0\u7684\u6210\u54e1\u8cc7\u683c\uff1b\u6216\u8005\u6dfb\u52a0\u4e86\u65b0\u7684\u6210\u54e1\u8cc7\u683c\uff0c\u4f46\u672a\u5728 GKE \u96c6\u7fa3\u4e2d\u90e8\u7f72\u61c9\u7528\u3002\n- \u63cf\u8ff0 `MultiClusterService` \uff1a```\nkubectl describe mcs zone-svc\n```\n- \u63cf\u8ff0 `MultiClusterIngress` \uff1a```\nkubectl describe mci zone-mci\n```## \u914d\u7f6e\u96c6\u7fa3\u9077\u79fb\n\u5982\u9700\u8a73\u7d30\u77ad\u89e3\u9077\u79fb\u7684\u4f7f\u7528\u5834\u666f\uff0c\u8acb\u53c3\u95b1 [\u914d\u7f6e\u96c6\u7fa3\u8a2d\u8a08\u6982\u5ff5](https://cloud.google.com/kubernetes-engine/docs/concepts/multi-cluster-ingress?hl=zh-cn#config_cluster_design) \u3002\n\u5982\u679c\u8655\u7406\u4e0d\u7576\uff0c\u5247\u914d\u7f6e\u96c6\u7fa3\u9077\u79fb\u53ef\u80fd\u6703\u6210\u7232\u4e00\u9805\u7834\u58de\u6027\u64cd\u4f5c\u3002\u57f7\u884c\u914d\u7f6e\u96c6\u7fa3\u9077\u79fb\u6642\uff0c\u8acb\u9075\u5faa\u4ee5\u4e0b\u6e96\u5247\uff1a\n- \u52d9\u5fc5\u5728\u60a8\u7684`MultiClusterIngress`\u8cc7\u6e90\u4e0a\u4f7f\u7528 [static-ip \u8a3b\u89e3](https://cloud.google.com/kubernetes-engine/docs/how-to/ingress-for-anthos?hl=zh-cn#static) \u3002\u5426\u5247\uff0c\u5728\u9077\u79fb\u6642\uff0c\u6d41\u91cf\u6703\u4e2d\u65b7\u3002\u5728\u9077\u79fb\u914d\u7f6e\u96c6\u7fa3\u6642\uff0c\u7cfb\u7d71\u6703\u91cd\u65b0\u5275\u5efa\u81e8\u6642 IP \u5730\u5740\u3002\n- `MultiClusterIngress`\u548c`MultiClusterService`\u8cc7\u6e90\u5fc5\u9808\u4ee5\u76f8\u540c\u7684\u65b9\u5f0f\u90e8\u7f72\u5230\u73fe\u6709\u914d\u7f6e\u96c6\u7fa3\u548c\u65b0\u7684\u914d\u7f6e\u96c6\u7fa3\u3002\u5b83\u5011\u4e4b\u9593\u7684\u5dee\u7570\u5c07\u5c0e\u81f4\u7cfb\u7d71\u5c0d\u65b0\u914d\u7f6e\u96c6\u7fa3\u4e2d\u7684\u4e0d\u540c`MultiClusterService`\u548c`MultiClusterIngress`\u8cc7\u6e90\u9032\u884c\u5354\u8abf\u3002\n- \u5728\u4efb\u4f55\u6642\u5019\uff0c\u53ea\u6709\u4e00\u500b\u914d\u7f6e\u96c6\u7fa3\u8655\u65bc\u6d3b\u8e8d\u72c0\u614b\u3002\u5728\u66f4\u6539\u914d\u7f6e\u96c6\u7fa3\u4e4b\u524d\uff0c\u65b0\u914d\u7f6e\u96c6\u7fa3\u4e2d\u7684`MultiClusterIngress`\u548c`MultiClusterService`\u8cc7\u6e90\u5c07\u4e0d\u6703\u5f71\u97ff\u8ca0\u8f09\u5747\u8861\u5668\u8cc7\u6e90\u3002\n\u5982\u9700\u9077\u79fb\u914d\u7f6e\u96c6\u7fa3\uff0c\u8acb\u904b\u884c\u4ee5\u4e0b\u547d\u4ee4\uff1a\n```\n\u00a0 gcloud container fleet ingress update \\\u00a0 \u00a0 --config-membership=projects/project_id/locations/global/memberships/new_config_cluster\n```\n\u901a\u904e\u78ba\u4fdd\u529f\u80fd\u72c0\u614b\u4e2d\u6c92\u6709\u660e\u986f\u7684\u932f\u8aa4\u4f86\u9a57\u8b49\u547d\u4ee4\u662f\u5426\u6b63\u5e38\u904b\u884c\uff1a\n```\n\u00a0 gcloud container fleet ingress describe\n```\n## \u63a7\u5236\u6aaf\u8abf\u8a66\n\u5728\u5927\u591a\u6578\u60c5\u6cc1\u4e0b\uff0c\u6aa2\u67e5\u8ca0\u8f09\u5e73\u8861\u5668\u7684\u78ba\u5207\u72c0\u614b\u5c0d\u65bc\u554f\u984c\u8abf\u8a66\u5f88\u6709\u5e6b\u52a9\u3002\u60a8\u53ef\u4ee5\u8f49\u5230 Google Cloud \u63a7\u5236\u6aaf\u4e2d\u7684 [\u8ca0\u8f09\u5747\u8861](https://console.cloud.google.com/net-services/loadbalancing/?hl=zh-cn) \uff0c\u627e\u5230\u8ca0\u8f09\u5747\u8861\u5668\u3002\n## \u932f\u8aa4/\u8b66\u544a\u4ee3\u78bc\n\u5c0d\u65bc\u5df2\u77e5\u554f\u984c\uff0c\u591a\u96c6\u7fa3 Ingress \u6703\u5728 `MultiClusterIngress` \u548c `MultiClusterService` \u8cc7\u6e90\u4ee5\u53ca gcloud `multiclusteringress` \u63cf\u8ff0\u5b57\u6bb5\u4e2d\u767c\u51fa\u932f\u8aa4\u548c\u8b66\u544a\u4ee3\u78bc\u3002\u4ee5\u4e0b\u6d88\u606f\u8a18\u9304\u4e86\u932f\u8aa4\u548c\u8b66\u544a\u4ee3\u78bc\uff0c\u4ee5\u4fbf\u60a8\u5728\u67d0\u500b\u8cc7\u6e90\u672a\u6309\u9810\u671f\u904b\u884c\u6642\u53ef\u4ee5\u66f4\u8f15\u9b06\u5730\u77ad\u89e3\u932f\u8aa4\u548c\u8b66\u544a\u4ee3\u78bc\u7684\u542b\u7fa9\u3002\u6bcf\u500b\u4ee3\u78bc\u90fd\u5305\u542b\u4e00\u500b\u932f\u8aa4 ID\uff08\u683c\u5f0f\u7232 `AVMBR123` \uff0c\u5176\u4e2d `123` \u662f\u8207\u932f\u8aa4\u6216\u8b66\u544a\u5c0d\u61c9\u7684\u552f\u4e00\u7de8\u865f\uff09\uff0c\u4ee5\u53ca\u6709\u95dc\u5982\u4f55\u89e3\u6c7a\u8a72\u932f\u8aa4\u7684\u5efa\u8b70\u3002\n### AVMBR101\uff1aAnnotation [NAME] not recognized\n\u5982\u679c `MultiClusterIngress` \u6216 `MultiClusterService` \u6e05\u55ae\u4e2d\u6307\u5b9a\u4e86\u8a3b\u89e3\uff0c\u4f46\u8a72\u8a3b\u89e3\u7121\u6cd5\u8b58\u5225\uff0c\u5247\u7cfb\u7d71\u6703\u986f\u793a\u6b64\u932f\u8aa4\u3002\u5c0e\u81f4\u8a3b\u89e3\u7121\u6cd5\u8b58\u5225\u7684\u539f\u56e0\u6709\u4ee5\u4e0b\u5e7e\u7a2e\uff1a\n- \u591a\u96c6\u7fa3 Ingress \u4e0d\u652f\u6301\u8a72\u8a3b\u89e3\u3002\u5982\u679c\u7232 GKE Enterprise Ingress \u63a7\u5236\u5668\u9810\u8a08\u4e0d\u6703\u4f7f\u7528\u7684\u8cc7\u6e90\u6dfb\u52a0\u8a3b\u91cb\uff0c\u5247\u53ef\u80fd\u6703\u51fa\u73fe\u9019\u7a2e\u60c5\u6cc1\u3002\n- \u8a3b\u91cb\u53d7\u652f\u6301\uff0c\u4f46\u62fc\u5beb\u932f\u8aa4\uff0c\u56e0\u6b64\u7121\u6cd5\u8b58\u5225\u3002\n\u5728\u9019\u5169\u7a2e\u60c5\u6cc1\u4e0b\uff0c\u8acb\u53c3\u95b1\u6587\u6a94\u4ee5\u77ad\u89e3 [\u652f\u6301\u7684\u8a3b\u91cb](https://cloud.google.com/kubernetes-engine/docs/how-to/multi-cluster-ingress?hl=zh-cn#annotations) \u53ca\u5176\u6307\u5b9a\u65b9\u5f0f\u3002\n### AVMBR102\uff1a[RESOURCE_NAME] not found\n\u7576\u5728 `MultiClusterIngress` \u4e2d\u6307\u5b9a\u88dc\u5145\u8cc7\u6e90\u4f46\u5728\u914d\u7f6e\u6210\u54e1\u4e2d\u627e\u4e0d\u5230\u88dc\u5145\u8cc7\u6e90\u6642\uff0c\u6703\u986f\u793a\u6b64\u932f\u8aa4\u3002\u4f8b\u5982\uff0c\u5982\u679c `MultiClusterIngress` \u5f15\u7528\u4e86\u4e00\u500b\u7121\u6cd5\u627e\u5230\u7684 `MultiClusterService` \u6216\u8005 `MultiClusterService` \u5f15\u7528\u4e86\u4e00\u500b\u7121\u6cd5\u627e\u5230\u7684 BackendConfig\uff0c\u5247\u7cfb\u7d71\u6703\u62cb\u51fa\u6b64\u932f\u8aa4\u3002\u5c0e\u81f4\u8cc7\u6e90\u7121\u6cd5\u627e\u5230\u7684\u539f\u56e0\u6709\u4ee5\u4e0b\u5e7e\u7a2e\uff1a\n- \u8cc7\u6e90\u4e0d\u5728\u6b63\u78ba\u7684\u547d\u540d\u7a7a\u9593\u4e2d\u3002\u8acb\u78ba\u4fdd\u76f8\u4e92\u5f15\u7528\u7684\u8cc7\u6e90\u90fd\u5728\u540c\u4e00\u547d\u540d\u7a7a\u9593\u4e2d\u3002\n- \u8cc7\u6e90\u540d\u7a31\u62fc\u5beb\u932f\u8aa4\u3002\n- \u96d6\u7136\u547d\u540d\u7a7a\u9593\u548c\u540d\u7a31\u90fd\u6b63\u78ba\uff0c\u4f46\u8cc7\u6e90\u78ba\u5be6\u4e0d\u5b58\u5728\u3002\u5728\u9019\u7a2e\u60c5\u6cc1\u4e0b\uff0c\u8acb\u5275\u5efa\u8a72\u8cc7\u6e90\u3002\n### AVMBR103\uff1a[CLUSTER_SELECTOR] is invalid\n\u5982\u679c\u5728 `MultiClusterService` \u4e0a\u6307\u5b9a\u7684\u96c6\u7fa3\u9078\u64c7\u5668\u7121\u6548\uff0c\u5247\u7cfb\u7d71\u6703\u986f\u793a\u6b64\u932f\u8aa4\u3002\u5c0e\u81f4\u6b64\u9078\u64c7\u5668\u53ef\u80fd\u7121\u6548\u7684\u539f\u56e0\u6709\u4ee5\u4e0b\u5e7e\u7a2e\uff1a\n- \u63d0\u4f9b\u7684\u5b57\u7b26\u4e32\u5305\u542b\u62fc\u5beb\u932f\u8aa4\u3002\n- \u63d0\u4f9b\u7684\u5b57\u7b26\u4e32\u5f15\u7528\u4e86\u8266\u968a\u4e2d\u4e0d\u518d\u5b58\u5728\u7684\u96c6\u7fa3\u6210\u54e1\u8cc7\u683c\u3002\n### AVMBR104\uff1aCannot find NEGs for Service Port [SERVICE_PORT]\n\u5982\u679c\u627e\u4e0d\u5230\u7d66\u5b9a `MultiClusterService` \u548c\u670d\u52d9\u7aef\u53e3\u5c0d\u7684 NetworkEndpointGroup (NEG)\uff0c\u5247\u6703\u62cb\u51fa\u6b64\u932f\u8aa4\u3002NEG \u662f\u5305\u542b\u6bcf\u500b\u5f8c\u7aef\u96c6\u7fa3\u4e2d\u7684 Pod \u7aef\u9ede\u7684\u8cc7\u6e90\u3002NEG \u53ef\u80fd\u4e0d\u5b58\u5728\u7684\u4e3b\u8981\u539f\u56e0\u662f\u5728\u5f8c\u7aef\u96c6\u7fa3\u4e2d\u5275\u5efa\u6216\u66f4\u65b0\u6d3e\u751f\u670d\u52d9\u6642\u51fa\u73fe\u932f\u8aa4\u3002\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 `MultiClusterService` \u8cc7\u6e90\u4e0a\u7684\u4e8b\u4ef6\u3002\n### AVMBR105\uff1aMissing GKE Enterprise license.\n\u6b64\u932f\u8aa4\u986f\u793a\u5728\u529f\u80fd\u72c0\u614b\u4e0b\uff0c\u8868\u793a GKE Enterprise API (anthos.googleapis.com) \u672a\u5553\u7528\u3002\n### AVMBR106\uff1aDerived service is invalid: [REASON].\n\u6b64\u932f\u8aa4\u986f\u793a\u5728 `MultiClusterService` \u8cc7\u6e90\u7684\u4e8b\u4ef6\u4e0b\u3002\u5c0e\u81f4\u6b64\u932f\u8aa4\u7684\u4e00\u500b\u5e38\u898b\u539f\u56e0\u662f\u6d3e\u751f\u81ea `MultiClusterService` \u7684 Service \u8cc7\u6e90\u5305\u542b\u7121\u6548\u7684\u898f\u7bc4\u3002\n\u4f8b\u5982\uff0c\u6b64 `MultiClusterService` \u7684\u898f\u7bc4\u4e2d\u672a\u5b9a\u7fa9\u4efb\u4f55 `ServicePort` \u3002\n```\napiVersion: networking.gke.io/v1kind: MultiClusterServicemetadata:\u00a0 name: zone-mcs\u00a0 namespace: whereamispec:\u00a0 clusters:\u00a0 - link: \"us-central1-a/gke-us\"\u00a0 - link: \"europe-west1-c/gke-eu\"\n```\n### AVMBR107\uff1aMissing GKE cluster resource link in Membership.\n\u6b64\u932f\u8aa4\u986f\u793a\u5728\u529f\u80fd\u72c0\u614b\u4e0b\uff0c\u56e0\u7232\u6210\u54e1\u8cc7\u683c\u8cc7\u6e90\u4e0b\u6c92\u6709 GKE \u96c6\u7fa3\u3002\u60a8\u53ef\u4ee5\u901a\u904e\u904b\u884c\u4ee5\u4e0b\u6307\u4ee4\u4f86\u9a57\u8b49\u9019\u4e00\u9ede\uff1a\n```\ngcloud container fleet memberships describe membership-name\n```\n\u4e26\u78ba\u4fdd\u7aef\u9ede\u5b57\u6bb5\u4e0b\u6c92\u6709 GKE \u96c6\u7fa3\u8cc7\u6e90\u93c8\u63a5\u3002\n### AVMBR108\uff1aGKE cluster [NAME] not found.\n\u6b64\u932f\u8aa4\u986f\u793a\u5728\u529f\u80fd\u72c0\u614b\u4e0b\uff0c\u5982\u679c\u6210\u54e1\u7684\u5e95\u5c64 GKE \u96c6\u7fa3\u4e0d\u5b58\u5728\uff0c\u5247\u6703\u62cb\u51fa\u6b64\u932f\u8aa4\u3002\n### AVMBR109\uff1a[NAME] is not a VPC-native GKE cluster.\n\u6b64\u932f\u8aa4\u986f\u793a\u5728\u529f\u80fd\u72c0\u614b\u4e0b\u3002\u5982\u679c\u6307\u5b9a\u7684 GKE \u96c6\u7fa3\u662f\u57fa\u65bc\u8def\u7531\u7684\u96c6\u7fa3\uff0c\u5247\u6703\u62cb\u51fa\u6b64\u932f\u8aa4\u3002\u591a\u96c6\u7fa3 Ingress \u63a7\u5236\u5668\u4f7f\u7528 NEG \u5275\u5efa\u5bb9\u5668\u539f\u751f\u8ca0\u8f09\u5747\u8861\u5668\u3002\u96c6\u7fa3\u5fc5\u9808\u662f VPC \u539f\u751f\u96c6\u7fa3\u624d\u80fd\u4f7f\u7528\u5bb9\u5668\u539f\u751f\u8ca0\u8f09\u5747\u8861\u5668\u3002\n\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [\u5275\u5efa VPC \u539f\u751f\u96c6\u7fa3](https://cloud.google.com/kubernetes-engine/docs/how-to/alias-ips?hl=zh-cn) \u3002\n### AVMBR110\uff1a[IAM_PERMISSION] permission missing for GKE cluster [NAME].\n\u6b64\u932f\u8aa4\u986f\u793a\u5728\u529f\u80fd\u72c0\u614b\u4e0b\u3002\u5c0e\u81f4\u6b64\u932f\u8aa4\u7684\u539f\u56e0\u6709\u5f88\u591a\uff0c\u5982\u4e0b\u6240\u793a\uff1a\n- \u6210\u54e1\u8cc7\u683c\u7684\u5e95\u5c64 GKE \u96c6\u7fa3\u8207\u6210\u54e1\u8cc7\u683c\u672c\u8eab\u4f4d\u65bc\u4e0d\u540c\u7684\u9805\u76ee\u4e2d\u3002\n- \u5f9e`MultiClusterIngress`\u670d\u52d9\u4ee3\u7406\u4e2d\u79fb\u9664\u4e86\u6307\u5b9a\u7684 IAM \u6b0a\u9650\u3002\n### AVMBR111\uff1aFailed to get Config Membership: [REASON].\n\u6b64\u932f\u8aa4\u986f\u793a\u5728\u529f\u80fd\u72c0\u614b\u4e0b\u3002\u5c0e\u81f4\u6b64\u932f\u8aa4\u7684\u4e3b\u8981\u539f\u56e0\u662f\u5553\u7528\u8a72\u529f\u80fd\u6642\u522a\u9664\u4e86\u914d\u7f6e\u6210\u54e1\u8cc7\u683c\u3002\n\u4efb\u4f55\u6642\u5019\u90fd\u4e0d\u8981\u522a\u9664\u914d\u7f6e\u6210\u54e1\u8cc7\u683c\u3002\u5982\u679c\u60a8\u8981\u66f4\u6539\u6b64\u8a2d\u7f6e\uff0c\u8acb\u6309\u7167 [\u914d\u7f6e\u96c6\u7fa3\u9077\u79fb\u6b65\u9a5f](#config_cluster_migration) \u9032\u884c\u64cd\u4f5c\u3002\n### AVMBR112\uff1aHTTPLoadBalancing Addon is disabled in GKE Cluster [NAME].\n\u6b64\u932f\u8aa4\u986f\u793a\u5728\u529f\u80fd\u72c0\u614b\u4e0b\uff0c\u4e26\u4e14\u5728 GKE \u96c6\u7fa3\u4e2d\u505c\u7528 `HTTPLoadBalancing` \u63d2\u4ef6\u6642\u6703\u767c\u751f\u6b64\u932f\u8aa4\u3002\u60a8\u53ef\u4ee5\u66f4\u65b0 GKE \u96c6\u7fa3\u4ee5\u5553\u7528 `HTTPLoadBalancing` \u63d2\u4ef6\u3002\n```\ngcloud container clusters update name --update-addons=HttpLoadBalancing=ENABLED\n```\n### AVMBR113\uff1aThis resource is orphaned.\n\u5728\u67d0\u4e9b\u60c5\u6cc1\u4e0b\uff0c\u8cc7\u6e90\u7684\u5be6\u7528\u6027\u53d6\u6c7a\u65bc\u5176\u4ed6\u8cc7\u6e90\u5c0d\u8a72\u8cc7\u6e90\u7684\u5f15\u7528\u60c5\u6cc1\u3002\u7576\u5275\u5efa Kubernetes \u8cc7\u6e90\u4f46\u8a72\u8cc7\u6e90\u4e26\u672a\u88ab\u5176\u4ed6\u8cc7\u6e90\u5f15\u7528\u6642\uff0c\u6703\u62cb\u51fa\u6b64\u932f\u8aa4\u3002\u4f8b\u5982\uff0c\u5982\u679c\u60a8\u5275\u5efa\u7684 `BackendConfig` \u8cc7\u6e90\u672a\u88ab `MultiClusterService` \u5f15\u7528\uff0c\u5c31\u6703\u770b\u5230\u6b64\u932f\u8aa4\u3002", "guide": "Google Kubernetes Engine (GKE)"}