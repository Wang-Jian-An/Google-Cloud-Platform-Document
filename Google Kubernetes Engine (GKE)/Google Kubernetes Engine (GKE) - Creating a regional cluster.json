{"title": "Google Kubernetes Engine (GKE) - Creating a regional cluster", "url": "https://cloud.google.com/kubernetes-engine/docs/how-to/creating-a-regional-cluster", "abstract": "# Google Kubernetes Engine (GKE) - Creating a regional cluster\nThis document shows how to create a Standard [regionalcluster](/kubernetes-engine/docs/concepts/regional-clusters) to increase availability of the cluster's control plane and workloads during cluster upgrades, automated maintenance, or a zonal disruption.\nGKE [Autopilot](/kubernetes-engine/docs/how-to/creating-an-autopilot-cluster) clusters are always regional.\n", "content": "## Overview\nWhen you create a regional cluster instead of a [zonal cluster](/kubernetes-engine/docs/concepts/types-of-clusters#zonal_clusters) , the cluster's control plane is replicated across multiple zones in a given region. For node pools in a regional cluster, you can manually specify the zone(s) in which to run the node pools or you can use the default configuration, which replicates each node pool across three zones of the control plane's region. All zones must be within the same region as the cluster's control plane.\nRegional clusters replicate resources across multiple zones and consume additional [quotas](/kubernetes-engine/quotas) .\nTo learn about the different cluster availability types, see [About cluster configuration choices](/kubernetes-engine/docs/concepts/types-of-clusters#availability) .\nThe instructions in the following sections show you how to:\n- [Create a regional cluster with a single-zone node pool.](#create-regional-single-zone-nodepool) \n- [Create a regional cluster with a multi-zone node pool.](#create-regional-multi-zone-nodepool) \n**Note:** Once you create a regional cluster, you cannot convert it to a zonal cluster.\n## Before you begin\nBefore you start, make sure you have performed the following tasks:\n- Enable    the Google Kubernetes Engine API.\n- [    Enable Google Kubernetes Engine API   ](https://console.cloud.google.com/flows/enableapi?apiid=container.googleapis.com) \n- If you want to use the Google Cloud CLI for this task, [install](/sdk/docs/install) and then [initialize](/sdk/docs/initializing) the  gcloud CLI. If you previously installed the gcloud CLI, get the latest  version by running`gcloud components update`. **Note:** For existing gcloud CLI  installations, make sure to set the`compute/region`and`compute/zone` [properties](/sdk/docs/properties#setting_properties) . By setting default locations,  you can avoid errors in gcloud CLI like the following:`One of [--zone, --region] must be supplied: Please specify location`.\n- Ensure you have the correct permissions to create clusters. At minimum, you should be a [Kubernetes Engine Cluster Admin](/iam/docs/understanding-roles#kubernetes-engine-roles) .\n- If you want to register your new cluster to a [fleet](/anthos/fleet-management/docs) , ensure that you have the required [APIs and permissions](/anthos/fleet-management/docs/before-you-begin) .\n**Caution:** If you have the organization policy constraint [constraints/compute.vmExternalIpAccess](/resource-manager/docs/organization-policy/org-policy-constraints) configured to `Deny All` or to restrict external IPs to specific VM instances at the organization, folder, or project level where you are trying to create a public GKE cluster, then your cluster creation operations will fail. See the [troubleshooting information](/kubernetes-engine/docs/troubleshooting#external-ip) for details.\n## Create a regional cluster with a single-zone node pool\nThe following instructions show you how to create a regional cluster with a node pool operating in a single zone within the region. The cluster's control plane is replicated across multiple zones in the specified region, but the nodes are located in the single zone, and are not replicated to other zones.\nYou can use the gcloud CLI, the Google Cloud console, or Terraform to create the cluster.\nIf you're developing GKE applications with Cloud Code for VS Code, try [creating clusters withCloud Code](/code/docs/vscode/create-configure-gke-cluster#create_a_cluster_and_add_it_to_your_kubeconfig) .\nTo create a regional cluster with the gcloud CLI, use one of the following commands and replace the following variables:- ``: the name of your new regional cluster.\n- ``: the desired [region](/compute/docs/regions-zones#available) for your cluster, such as`us-central1`.\n- ``: the desired [zone](/compute/docs/regions-zones#available) for your node pool, such as`us-central1-a`. The zone must be in the same region as the cluster control plane.\n- ``: the type of [release channel](/kubernetes-engine/docs/concepts/release-channels) , which can be one of`rapid`,`regular`,`stable`, or`None`. By default, the cluster is enrolled in the`regular`release channel unless at least one of the following flags is specified:`--cluster-version`,`--release-channel`,`--no-enable-autoupgrade`, and`--no-enable-autorepair`.\n- ``: the [version](/kubernetes-engine/versioning-and-upgrades) you want to specify for your cluster.\nIn the following commands, you can optionally use the `--service-account=` `` `@` `` `.iam.gserviceaccount.com` flag to specify a different IAM service account that nodes in your cluster's first node pool uses instead of the Compute Engine default service account. This flag is optional, but we strongly recommend that you [create a minimally-privileged service account](/kubernetes-engine/docs/how-to/hardening-your-cluster#use_least_privilege_sa) so that your nodes don't have more privileges that they require.\n **Using a specific release channel:** \nTo create a new cluster using a specific release channel, run the following command:\n```\ngcloud container clusters create CLUSTER_NAME \\\u00a0 \u00a0 --region COMPUTE_REGION \\\u00a0 \u00a0 --node-locations COMPUTE_ZONE \\\u00a0 \u00a0 --release-channel CHANNEL\n```\n **Using a specific version:** \nTo create a new cluster using a specific cluster version, run the following command:\n```\ngcloud container clusters create CLUSTER_NAME \\\u00a0 \u00a0 --region COMPUTE_REGION \\\u00a0 \u00a0 --node-locations COMPUTE_ZONE \\\u00a0 \u00a0 --cluster-version VERSION\n```\n **Note:** If you specify a cluster version, the cluster uses that specific version and is enrolled in the most mature release channel where that version is available.\n **Using the static default version:** \nTo create a new cluster using the static default cluster version, you don't need to specify a cluster version, but you do need to set the release channel to `None` :\n```\ngcloud container clusters create CLUSTER_NAME \\\u00a0 \u00a0 --region COMPUTE_REGION \\\u00a0 \u00a0 --node-locations COMPUTE_ZONE \\\u00a0 \u00a0 --release-channel None\n```\n **Example** \nThe following command creates a regional cluster enrolled in the `regular` release channel (default), with three nodes (default) in the `us-west1-c` zone:\n```\ngcloud container clusters create my-regional-cluster \\\n --region us-west1 \\\n --node-locations us-west1-c\n```\n **Example** \nThe following command creates a regional cluster enrolled in the `regular` release channel (default), with two nodes located in the `us-west1-c` zone:\n```\ngcloud container clusters create my-regional-cluster \\\n --region us-west1 \\\n --node-locations us-west1-c \\\n --num-nodes 2\n```- Go to the **Google Kubernetes Engine** page in the Google Cloud console. [Go to Google Kubernetes Engine](https://console.cloud.google.com/kubernetes/list) \n- Click **Create** .\n- In the **Cluster basics** section, complete the following:- Enter the **Name** for your cluster.\n- For the **Location type** , select **Regional** , and then select the desired [region](/compute/docs/regions-zones#available) for your cluster.\n- If you want to override the default node locations (for example, to run in a single zone), select the **Specify default node locations** checkbox, and then choose the zone(s) in which you want the node pools to run.\n- Choose a **Control plane version** . Defaults to the recommended option of [Release channel](/kubernetes-engine/docs/concepts/release-channels) . If you must specify a static version, ensure **auto-upgrade** is enabled for your node pools.\n- Optional (available with [GKE Enterprise](/anthos/docs/concepts/gke-editions) ): If you want to register your new cluster to a [fleet](/anthos/fleet-management/docs) , go to the **Fleet registration** section, and follow the Google Cloud console instructions for [Create and register a new cluster](/anthos/fleet-management/docs/register/gke#console) to complete your cluster registration.\n- From the navigation pane, under **Node Pools** , click **default-pool** .\n- In the **Node pool details** section, complete the following:- Enter a **Name** for the default [Node pool](/kubernetes-engine/docs/concepts/node-pools) .\n- For static version nodes, choose the **Node version** .\n- Enter the **Number of nodes** to create in the cluster. You must have available [resource quota](/compute/quotas) for the nodes and their resources (such as firewall routes).\n- From the navigation pane, under **Node Pools** , click **Nodes** .\n- From the **Image type** drop-down list, select the desired [node image](/kubernetes-engine/docs/concepts/node-images) .\n- Choose the default [Machine configuration](/compute/docs/machine-types) to use for the instances. Each machine type is billed differently. The default machine type is `e2-medium` . For machine type pricing information, refer to the [machine type price sheet](/compute/pricing#standard_machine_types) .\n- From the **Boot disk type** drop-down list, select the desired [disk type](/compute/docs/disks) .\n- Enter the **Boot disk size** .\n- Optional: From the navigation pane, under **Node Pools** , click **Security** .\n- Optional: From the **Service account** drop-down list, select an Identity and Access Management (IAM) service account for your applications to use when calling Google Cloud APIs. We recommend that you [use a minimally privileged service account](/kubernetes-engine/docs/how-to/hardening-your-cluster#use_least_privilege_sa) instead of using the default service account, so that your nodes don't have more privileges that they require.\n- Click **Create** .\nTo create a regional cluster with a single-zone node pool using Terraform, refer to the following example:\n [  gke/standard/regional/single-zone/main.tf ](https://github.com/terraform-google-modules/terraform-docs-samples/blob/main/gke/standard/regional/single-zone/main.tf) [View on GitHub](https://github.com/terraform-google-modules/terraform-docs-samples/blob/main/gke/standard/regional/single-zone/main.tf) \n```\nresource \"google_container_cluster\" \"default\" {\n name    = \"gke-standard-regional-single-zone\"\n location   = \"us-west1\"\n node_locations  = [\"us-west1-c\"]\n initial_node_count = 2\n # Set `deletion_protection` to `true` will ensure that one cannot\n # accidentally delete this instance by use of Terraform.\n deletion_protection = false\n}\n```\nTo learn more about using Terraform, see [Terraform support for GKE](/kubernetes-engine/docs/resources/use-terraform-gke) .\n### Interact with a cluster using kubectl\nAfter you create a cluster, you need to [configure kubectl](/kubernetes-engine/docs/how-to/cluster-access-for-kubectl#generate_kubeconfig_entry) before you can interact with the cluster from the command line.\n## Create a regional cluster with a multi-zone node pool\nThe following instructions show you how to create a regional cluster with a multi-zone node pool, which is the default set up. The cluster's control plane and nodes are replicated across multiple zones in the specified region.\nYou can use the gcloud CLI, Google Cloud console, or Terraform to create the cluster.\nIf you're developing GKE applications with Visual Studio Code, try [creating clusters with Cloud Code](/code/docs/vscode/adding-a-cluster#creating_a_kubernetes_cluster_with_gke) .\nTo create a regional cluster with the gcloud CLI, use one of the following commands and replace the following variables:- ``: the name of your new regional cluster.\n- ``: the desired [region](/compute/docs/regions-zones#available) for your cluster, such as`us-central1`.\n- ``: the type of [release channel](/kubernetes-engine/docs/concepts/release-channels) , which can be one of`rapid`,`regular`,`stable`, or`None`. By default, the cluster is enrolled in the`regular`release channel if the following flags aren't specified:`--cluster-version`,`--release-channel`,`--no-enable-autoupgrade`, and`--no-enable-autorepair`.\n- ``: the [version](/kubernetes-engine/versioning-and-upgrades) you want to specify for your cluster.\n- For regions with more than three [zones](/compute/docs/regions-zones#available) or in cases where fewer zones is preferred, you can use the optional [--node-locations](/sdk/gcloud/reference/container/clusters/create#--node-locations) flag to override the default zones in which the nodes are replicated.\nIn the following commands, you can optionally use the `--service-account=` `` `@` `` `.iam.gserviceaccount.com` flag to specify a different IAM service account that nodes in your cluster's first node pool uses instead of the Compute Engine default service account. This flag is optional, but we strongly recommend that you [create and use a minimally-privileged service account](/kubernetes-engine/docs/how-to/hardening-your-cluster#use_least_privilege_sa) so that your nodes don't have more privileges that they require.\n **Using a specific release channel:** \nTo create a new cluster using a specific release channel, run the following command:\n```\ngcloud container clusters create CLUSTER_NAME \\\u00a0 \u00a0 --region COMPUTE_REGION \\\u00a0 \u00a0 --release-channel CHANNEL\n```\n **Using a specific version:** \nTo create a new cluster using a specific cluster version, run the following command:\n```\ngcloud container clusters create CLUSTER_NAME \\\u00a0 \u00a0 --region COMPUTE_REGION \\\u00a0 \u00a0 --cluster-version VERSION\n```\n **Note:** If you specify a cluster version, the cluster uses that specific version and is enrolled in a release channel.\n **Using the static default version:** \nTo create a new cluster using the static default cluster version, you don't need to specify a cluster version, but you do need to set the release channel to `None` :\n```\ngcloud container clusters create CLUSTER_NAME \\\u00a0 \u00a0 --region COMPUTE_REGION \\\u00a0 \u00a0 --release-channel None\n```\n **Example** \nThe following command creates a regional cluster enrolled in the `regular` release channel, with nine nodes in `us-west1` (three zones with three nodes each, which is default):\n```\ngcloud container clusters create my-regional-cluster --region us-west1\n```\n **Example** \nThe following command creates a regional cluster enrolled in the `regular` release channel, with six nodes (three zones with two nodes each, specified by `--num-nodes` ):\n```\ngcloud container clusters create my-regional-cluster \\\n --region us-west1 \\\n --num-nodes 2\n```\n **Example** \nThe following command creates a regional cluster enrolled in the `regular` release channel, with six nodes in two zones (two zones, specified by `--node-locations` , with three nodes each):\n```\ngcloud container clusters create my-regional-cluster \\\n --region us-central1 \\\n --node-locations us-central1-b,us-central1-c\n```- Go to the **Google Kubernetes Engine** page in the Google Cloud console. [Go to Google Kubernetes Engine](https://console.cloud.google.com/kubernetes/list) \n- Click **Create** .\n- In the **Cluster basics** section, complete the following:- Enter the **Name** for your cluster.\n- For the **Location type** , select **Regional** , and then select the desired [region](/compute/docs/regions-zones#available) for your cluster.\n- If you want to override the default node locations (for example, to run in a single zone), select the **Specify default node locations** checkbox, and then choose the zone(s) in which you want the node pools to run.\n- Choose a **Control plane version** . Defaults to the recommended option of [Release channel](/kubernetes-engine/docs/concepts/release-channels) . If you must specify a static version, ensure **auto-upgrade** is enabled for your node pools.\n- Optional (available with [GKE Enterprise](/anthos/docs/concepts/gke-editions) ): If you want to register your new cluster to a [fleet](/anthos/fleet-management/docs) , go to the **Fleet registration** section, and follow the Google Cloud console instructions for [Create and register a new cluster](/anthos/fleet-management/docs/register/gke#console) to complete your cluster registration.\n- From the navigation pane, under **Node Pools** , click **default-pool** .\n- In the **Node pool details** section, complete the following:- Enter a **Name** for the default [Node pool](/kubernetes-engine/docs/concepts/node-pools) .\n- For static version nodes, choose the **Node version** .\n- Enter the **Number of nodes** to create in the cluster. You must have available [resource quota](/compute/quotas) for the nodes and their resources (such as firewall routes).\n- From the navigation pane, under **Node Pools** , click **Nodes** .\n- From the **Image type** drop-down list, select the desired [node image](/kubernetes-engine/docs/concepts/node-images) .\n- Choose the default [Machine configuration](/compute/docs/machine-types) to use for the instances. Each machine type is billed differently. The default machine type is `e2-medium` . For machine type pricing information, refer to the [machine type price sheet](/compute/pricing#standard_machine_types) .\n- From the **Boot disk type** drop-down list, select the desired [disk type](/compute/docs/disks) .\n- Enter the **Boot disk size** .\n- Optional: From the navigation pane, under **Node Pools** , click **Security** .\n- Optional: From the **Service account** drop-down list, select an Identity and Access Management (IAM) service account for your applications to use when calling Google Cloud APIs. We recommend that you [use a minimally privileged service account](/kubernetes-engine/docs/how-to/hardening-your-cluster#use_least_privilege_sa) instead of using the default service account, so that your nodes don't have more privileges that they require.\n- Click **Create** .\nTo create a regional cluster with a multi-zone node pool using Terraform, refer to the following example:\n [  gke/standard/regional/multi-zone/main.tf ](https://github.com/terraform-google-modules/terraform-docs-samples/blob/main/gke/standard/regional/multi-zone/main.tf) [View on GitHub](https://github.com/terraform-google-modules/terraform-docs-samples/blob/main/gke/standard/regional/multi-zone/main.tf) \n```\nresource \"google_container_cluster\" \"default\" {\n name    = \"gke-standard-regional-multi-zone\"\n location   = \"us-central1\"\n node_locations  = [\"us-central1-b\", \"us-central1-c\"]\n initial_node_count = 2\n # Set `deletion_protection` to `true` will ensure that one cannot\n # accidentally delete this instance by use of Terraform.\n deletion_protection = false\n}\n```\nTo learn more about using Terraform, see [Terraform support for GKE](/kubernetes-engine/docs/resources/use-terraform-gke) .\n### Interact with a cluster using kubectl\nAfter you create a cluster, you need to [configure kubectl](/kubernetes-engine/docs/how-to/cluster-access-for-kubectl#generate_kubeconfig_entry) before you can interact with the cluster from the command line.\n## What's next\n- Learn more about the [types of clusters](/kubernetes-engine/docs/concepts/types-of-clusters) you can create.\n- [Create a zonal cluster](/kubernetes-engine/docs/how-to/creating-a-zonal-cluster) .", "guide": "Google Kubernetes Engine (GKE)"}