{"title": "Google Kubernetes Engine (GKE) - \u5275\u5efa\u5377", "url": "https://cloud.google.com/kubernetes-engine/docs/how-to/volumes?hl=zh-cn", "abstract": "# Google Kubernetes Engine (GKE) - \u5275\u5efa\u5377\n\u672c\u9801\u9762\u4ecb\u7d39\u5982\u4f55\u5728\u96c6\u7fa3\u4e2d\u5275\u5efa\u5377\u8cc7\u6e90\u3002\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [\u6709\u95dc\u5377\u7684 Kubernetes \u6587\u6a94](https://kubernetes.io/docs/concepts/storage/volumes/) \u3002\n", "content": "## \u5c07\u5377\u8207 Deployment \u914d\u5408\u4f7f\u7528\n\u60a8\u53ef\u4ee5\u7232 Pod [\u5275\u5efa Deployment](https://kubernetes.io/docs/concepts/workloads/controllers/deployment/) \uff0c\u5176\u4e2d\u6bcf\u500b Pod \u5305\u542b\u4e00\u500b\u6216\u591a\u500b\u5377\u3002\u4ee5\u4e0b Deployment \u6e05\u55ae\u4ecb\u7d39\u4e86\u4e09\u500b Pod \u7684 Deployment\uff0c\u6bcf\u500b Pod \u90fd\u5177\u6709 [emptyDir \u5377](https://kubernetes.io/docs/concepts/storage/volumes/#emptydir) \u3002\n\u5728\u6b64\u793a\u4f8b\u4e2d\uff1a\n- `metadata: name`\u5b57\u6bb5\u6307\u5b9a\u540d\u7232`volumes-example-deployment`\u7684 Deployment\u3002\n- [Pod \u6a21\u677f](https://kubernetes.io/docs/concepts/workloads/pods/pod-overview/#pod-templates) \u898f\u7bc4\u5305\u62ec\u4e00\u500b`volumes`\u5b57\u6bb5\uff0c\u7528\u65bc\u63cf\u8ff0\u540d\u7232`cache-volume`\u7684 emptyDir \u5377\u3002\n- \u5bb9\u5668\u898f\u7bc4\u5305\u62ec\u4e00\u500b`volumeMounts:`\u5b57\u6bb5\uff0c\u7528\u65bc\u6307\u5b9a\u5728\u6587\u4ef6\u8def\u5f91`/cache`\u4e2d\u88dd\u8f09\u540d\u7232`cache-volume`\u7684\u5377\u3002\n- \u6e05\u55ae\u6587\u4ef6\u540d\u7232`volumes-demo.yaml`\u3002\n```\napiVersion: apps/v1kind: Deploymentmetadata:\u00a0 name: volumes-example-deploymentspec:\u00a0 replicas: 3\u00a0 selector:\u00a0 \u00a0 matchLabels:\u00a0 \u00a0 \u00a0 app: demo\u00a0 template:\u00a0 \u00a0 metadata:\u00a0 \u00a0 \u00a0 labels:\u00a0 \u00a0 \u00a0 \u00a0 app: demo\u00a0 \u00a0 spec:\u00a0 \u00a0 \u00a0 containers:\u00a0 \u00a0 \u00a0 - name: test-container\u00a0 \u00a0 \u00a0 \u00a0 image: us-docker.pkg.dev/google-samples/containers/gke/hello-app:1.0\u00a0 \u00a0 \u00a0 \u00a0 volumeMounts:\u00a0 \u00a0 \u00a0 \u00a0 - mountPath: /cache\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 name: cache-volume\u00a0 \u00a0 \u00a0 volumes:\u00a0 \u00a0 \u00a0 \u00a0 - name: cache-volume\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 emptyDir: {}\n```\n\u5982\u9700\u6839\u64da\u6b64\u6e05\u55ae\u6587\u4ef6\u5275\u5efa Deployment\uff0c\u8acb\u904b\u884c\u4ee5\u4e0b\u547d\u4ee4\uff1a\n```\nkubectl apply -f volumes-demo.yaml\n```\n\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u9a57\u8b49 Deployment \u662f\u5426\u6b63\u78ba\u904b\u884c\u4e26\u5177\u6709\u9810\u671f\u7684\u5377\uff1a\n```\nkubectl describe pods volumes-example-deployment\n```\n\u9019\u5c07\u5206\u5225\u8f38\u51fa Deployment \u4e2d\u4e09\u500b Pod \u7684\u76f8\u95dc\u4fe1\u606f\u3002\u8f38\u51fa\u7d50\u679c\u6703\u986f\u793a\u6bcf\u500b Pod \u90fd\u6709\u4e00\u500b\u5bb9\u5668\u3001\u6e2c\u8a66\u5bb9\u5668\u4ee5\u53ca `/cache` \u88dd\u8f09\uff1a\n```\nMounts:\n /cache from cache-volume (rw)\n```\n\u8f38\u51fa\u7d50\u679c\u9084\u6703\u986f\u793a\u6bcf\u500b Pod \u90fd\u5305\u542b\u4e00\u500b\u540d\u7232 `cache-volume` \u7684\u5377\uff1a\n```\nVolumes:\n cache-volume:\n Type: EmptyDir (a temporary directory that shares a pod's lifetime)\n```\n\u8981\u8a73\u7d30\u77ad\u89e3\u5982\u4f55\u5275\u5efa Deployment\uff0c\u8acb\u53c3\u95b1 [\u5275\u5efa Deployment](https://cloud.google.com/kubernetes-engine/docs/how-to/stateless-apps?hl=zh-cn#create) \u3002\n## \u5f8c\u7e8c\u6b65\u9a5f\n- [\u77ad\u89e3 PersistentVolume\u3001PersistentVolumeClaim \u548c\u52d5\u614b\u5b58\u5132\u7a7a\u9593\u9810\u914d](https://cloud.google.com/kubernetes-engine/docs/concepts/persistent-volumes?hl=zh-cn) \u3002\n- [\u77ad\u89e3\u5982\u4f55\u4f7f\u7528 Compute Engine \u6c38\u4e45\u6027\u78c1\u76e4 CSI \u9a45\u52d5\u7a0b\u5e8f](https://cloud.google.com/kubernetes-engine/docs/how-to/gce-pd-csi-driver?hl=zh-cn) \u3002", "guide": "Google Kubernetes Engine (GKE)"}