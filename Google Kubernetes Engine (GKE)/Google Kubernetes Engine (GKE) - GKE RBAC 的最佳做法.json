{"title": "Google Kubernetes Engine (GKE) - GKE RBAC \u7684\u6700\u4f73\u505a\u6cd5", "url": "https://cloud.google.com/kubernetes-engine/docs/best-practices/rbac?hl=zh-cn", "abstract": "# Google Kubernetes Engine (GKE) - GKE RBAC \u7684\u6700\u4f73\u505a\u6cd5\n\u672c\u9801\u9762\u4ecb\u7d39\u4e86\u898f\u5283\u57fa\u65bc\u89d2\u8272\u7684\u8a2a\u554f\u6b0a\u9650\u63a7\u5236 (RBAC) \u653f\u7b56\u7684\u6700\u4f73\u505a\u6cd5\u3002\u5982\u9700\u77ad\u89e3\u5982\u4f55\u5728 Google Kubernetes Engine (GKE) \u4e2d\u5be6\u73fe RBAC\uff0c\u8acb\u53c3\u95b1 [\u914d\u7f6e\u57fa\u65bc\u89d2\u8272\u7684\u8a2a\u554f\u6b0a\u9650\u63a7\u5236](https://cloud.google.com/kubernetes-engine/docs/how-to/role-based-access-control?hl=zh-cn) \u3002\nRBAC \u662f Kubernetes \u4e2d\u7684\u4e00\u500b\u6838\u5fc3\u5b89\u5168\u529f\u80fd\uff0c\u53ef\u8b93\u60a8\u5275\u5efa\u7cbe\u7d30\u7684\u6b0a\u9650\uff0c\u4ee5\u7ba1\u7406\u7528\u6236\u548c\u5de5\u4f5c\u8ca0\u8f09\u53ef\u4ee5\u5c0d\u96c6\u7fa3\u4e2d\u7684\u8cc7\u6e90\u57f7\u884c\u7684\u64cd\u4f5c\u3002\u4f5c\u7232\u5e73\u81fa\u7ba1\u7406\u54e1\uff0c\u60a8\u53ef\u4ee5\u5275\u5efa RBAC \u89d2\u8272 \u4e26\u5c07\u9019\u4e9b\u89d2\u8272\u7d81\u5b9a \u5230\u4e3b\u9ad4 \uff0c\u9019\u4e9b\u4e3b\u9ad4\u662f\u7d93\u904e\u8eab\u4efd\u9a57\u8b49\u7684\u7528\u6236\uff0c\u4f8b\u5982\u670d\u52d9\u8cec\u865f\u6216 Google \u7fa3\u7d44\u3002\n", "content": "## \u6e96\u5099\u5de5\u4f5c\n\u78ba\u4fdd\u719f\u6089\u4ee5\u4e0b\u6982\u5ff5\uff1a\n- [RBAC](https://kubernetes.io/docs/reference/access-authn-authz/rbac/) \n- [Kubernetes API \u7d44](https://kubernetes.io/docs/reference/generated/kubernetes-api/v1.25/#-strong-api-groups-strong-) \n- [Kubernetes API \u8cc7\u6e90](https://kubernetes.io/docs/reference/kubernetes-api/) \n- [Kubernetes API \u52d5\u8a5e](https://kubernetes.io/docs/reference/using-api/api-concepts/#api-verbs) \n\u5982\u9700\u67e5\u770b\u672c\u6307\u5357\u7684\u6838\u5c0d\u6e05\u55ae\uff0c\u8acb\u53c3\u95b1 [\u8988\u5c0d\u6e05\u55ae\u6458\u8981](#checklist-summary) \u3002\n## RBAC \u7684\u5de5\u4f5c\u539f\u7406\nRBAC \u652f\u6301\u4ee5\u4e0b\u985e\u578b\u7684\u89d2\u8272\u548c\u7d81\u5b9a\uff1a\n- **ClusterRole** \uff1a\u4e00\u7d44\u53ef\u4ee5\u61c9\u7528\u65bc\u4efb\u4f55\u547d\u540d\u7a7a\u9593\u6216\u6574\u500b\u96c6\u7fa3\u7684\u6b0a\u9650\u3002\n- **\u89d2\u8272** \uff1a\u4e00\u7d44\u50c5\u9650\u65bc\u55ae\u500b\u547d\u540d\u7a7a\u9593\u7684\u6b0a\u9650\u3002\n- **ClusterRoleBinding** \uff1a\u5c07`ClusterRole`\u7d81\u5b9a\u5230\u96c6\u7fa3\u4e2d\u6240\u6709\u547d\u540d\u7a7a\u9593\u7684\u7528\u6236\u6216\u7fa3\u7d44\u3002\n- **RoleBinding** \uff1a\u5c07`Role`\u6216`ClusterRole`\u7d81\u5b9a\u5230\u7279\u5b9a\u547d\u540d\u7a7a\u9593\u4e2d\u7684\u7528\u6236\u6216\u7fa3\u7d44\u3002\n\u60a8\u53ef\u4ee5\u5728 `Role` \u6216 `ClusterRole` \u4e2d\u5c07\u6b0a\u9650\u5b9a\u7fa9\u7232 `rules` \u3002\u89d2\u8272\u4e2d\u7684\u6bcf\u500b `rules` \u5b57\u6bb5\u90fd\u5305\u542b API \u7d44\u3001\u8a72 API \u7d44\u4e2d\u7684 API \u8cc7\u6e90\u4ee5\u53ca\u5141\u8a31\u5c0d\u9019\u4e9b\u8cc7\u6e90\u4f7f\u7528\u7684\u52d5\u8a5e\uff08\u64cd\u4f5c\uff09\u3002\uff08\u53ef\u9078\uff09\u60a8\u53ef\u4ee5\u4f7f\u7528 `resourceNames` \u5b57\u6bb5\u5c07\u52d5\u8a5e\u7684\u7bc4\u570d\u9650\u5b9a\u7232\u5df2\u547d\u540d\u7684 API \u8cc7\u6e90\u5be6\u4f8b\u3002\u5982\u9700\u67e5\u770b\u793a\u4f8b\uff0c\u8acb\u53c3\u95b1 [\u50c5\u9650\u8a2a\u554f\u7279\u5b9a\u8cc7\u6e90\u5be6\u4f8b](#named-resources) \u3002\n\u5b9a\u7fa9\u89d2\u8272\u5f8c\uff0c\u4f7f\u7528 `RoleBinding` \u6216 `ClusterRoleBinding` \u5c07\u8a72\u89d2\u8272\u7d81\u5b9a\u5230\u4e3b\u9ad4\u3002\u6839\u64da\u60a8\u8981\u5728\u55ae\u500b\u547d\u540d\u7a7a\u9593\u4e2d\u9084\u662f\u5728\u591a\u500b\u547d\u540d\u7a7a\u9593\u4e2d\u6388\u4e88\u6b0a\u9650\uff0c\u9078\u64c7\u7d81\u5b9a\u985e\u578b\u3002\n## RBAC \u89d2\u8272\u8a2d\u8a08\n### \u9075\u5faa\u6700\u5c0f\u6b0a\u9650\u539f\u5247\n\u5728 RBAC \u89d2\u8272\u4e2d\u5206\u914d\u6b0a\u9650\u6642\uff0c\u8acb\u9075\u5faa\u6700\u5c0f\u6b0a\u9650\u539f\u5247\u4e26\u6388\u4e88\u57f7\u884c\u4efb\u52d9\u6240\u9700\u7684\u6700\u4f4e\u6b0a\u9650\u3002\u4f7f\u7528\u6700\u5c0f\u6b0a\u9650\u539f\u5247\u53ef\u4ee5\u964d\u4f4e\u96c6\u7fa3\u88ab\u76dc\u7528\u6642\u63d0\u5347\u6b0a\u9650\u7684\u53ef\u80fd\u6027\uff0c\u4e26\u964d\u4f4e\u904e\u5ea6\u8a2a\u554f\u5c0e\u81f4\u5b89\u5168\u4e8b\u4ef6\u7684\u53ef\u80fd\u6027\u3002\n\u8a2d\u8a08\u89d2\u8272\u6642\uff0c\u8acb\u4ed4\u7d30\u8003\u616e\u5e38\u898b\u7684\u63d0\u5347\u6b0a\u9650\u98a8\u96aa\uff0c\u4f8b\u5982 `escalate` \u6216 `bind` \u52d5\u8a5e\u3001PersistentVolume \u7684 `create` \u8a2a\u554f\u6b0a\u9650\u6216\u8b49\u66f8\u7c64\u540d\u8acb\u6c42\u7684 `create` \u8a2a\u554f\u6b0a\u9650\u3002\u5982\u9700\u67e5\u770b\u98a8\u96aa\u5217\u8868\uff0c\u8acb\u53c3\u95b1 [Kubernetes RBAC - \u63d0\u5347\u6b0a\u9650\u98a8\u96aa](https://kubernetes.io/docs/concepts/security/rbac-good-practices/#privilege-escalation-risks) \u3002\n### \u907f\u514d\u4f7f\u7528\u9ed8\u8a8d\u89d2\u8272\u548c\u7fa3\u7d44\nKubernetes \u6703\u5275\u5efa\u4e00\u7d44\u9ed8\u8a8d ClusterRole \u548c ClusterRoleBinding\uff0c\u4f9b\u60a8\u7528\u65bc API \u767c\u73fe\u548c\u5553\u7528\u4ee3\u7ba1\u5f0f\u7d44\u4ef6\u529f\u80fd\u3002\u9019\u4e9b\u9ed8\u8a8d\u89d2\u8272\u6388\u4e88\u7684\u6b0a\u9650\u53ef\u80fd\u6bd4\u8f03\u5ee3\u6cdb\uff0c\u5177\u9ad4\u53d6\u6c7a\u65bc\u89d2\u8272\u3002Kubernetes \u9084\u6709\u4e00\u7d44\u9ed8\u8a8d\u7528\u6236\u548c\u7528\u6236\u7d44\uff0c\u7531 `system:` \u524d\u7db4\u6a19\u8b58\u3002\u9ed8\u8a8d\u60c5\u6cc1\u4e0b\uff0cKubernetes \u548c GKE \u6703\u81ea\u52d5\u5c07\u9019\u4e9b\u89d2\u8272\u7d81\u5b9a\u5230\u9ed8\u8a8d\u7fa3\u7d44\u548c\u5404\u7a2e\u4e3b\u9ad4\u3002\u5982\u9700\u67e5\u770b Kubernetes \u5275\u5efa\u7684\u9ed8\u8a8d\u89d2\u8272\u548c\u7d81\u5b9a\u7684\u5b8c\u6574\u5217\u8868\uff0c\u8acb\u53c3\u95b1 [\u9ed8\u8a8d\u89d2\u8272\u548c\u89d2\u8272\u7d81\u5b9a](https://kubernetes.io/docs/reference/access-authn-authz/rbac/#default-roles-and-role-bindings) \u3002\n\u4e0b\u8868\u4ecb\u7d39\u4e86\u4e00\u4e9b\u9ed8\u8a8d\u89d2\u8272\u3001\u7528\u6236\u548c\u7fa3\u7d44\u3002\u9664\u975e\u60a8\u4ed4\u7d30\u8a55\u4f30\u9019\u4e9b\u89d2\u8272\u3001\u7528\u6236\u548c\u7fa3\u7d44\uff0c\u5426\u5247\u6211\u5011\u5efa\u8b70\u60a8\u4e0d\u8981\u8207\u9019\u4e9b\u89d2\u8272\u3001\u7528\u6236\u548c\u7fa3\u7d44\u9032\u884c\u4e92\u52d5\uff0c\u56e0\u7232\u8207\u9019\u4e9b\u8cc7\u6e90\u4e92\u52d5\u53ef\u80fd\u6703\u7522\u751f\u610f\u5916\u7684\u5b89\u5168\u72c0\u6cc1\u3002\n| \u540d\u7a31     | \u985e\u578b  | \u8aaa\u660e                                                                     |\n|:-----------------------|:------------|:---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|\n| cluster-admin   | ClusterRole | \u6388\u4e88\u4e3b\u9ad4\u5c0d\u96c6\u7fa3\u4e2d\u7684\u4efb\u4f55\u8cc7\u6e90\u57f7\u884c\u4efb\u4f55\u64cd\u4f5c\u7684\u6b0a\u9650\u3002                                                           |\n| system:anonymous  | \u7528\u6236  | Kubernetes \u6703\u5c07\u6b64\u7528\u6236\u5206\u914d\u7d66\u672a\u63d0\u4f9b\u8eab\u4efd\u9a57\u8b49\u4fe1\u606f\u7684 API \u670d\u52d9\u5668\u8acb\u6c42\u3002 \u5c07\u89d2\u8272\u7d81\u5b9a\u5230\u6b64\u7528\u6236\u5f8c\uff0c\u6240\u6709\u672a\u7d93\u8eab\u4efd\u9a57\u8b49\u7684\u7528\u6236\u90fd\u6703\u7372\u5f97\u8a72\u89d2\u8272\u6388\u4e88\u7684\u6b0a\u9650\u3002                                    |\n| system:unauthenticated | \u7fa3\u7d44  | Kubernetes \u5c07\u6b64\u7fa3\u7d44\u5206\u914d\u7d66\u672a\u63d0\u4f9b\u8eab\u4efd\u9a57\u8b49\u4fe1\u606f\u7684 API \u670d\u52d9\u5668\u8acb\u6c42\u3002 \u5c07\u89d2\u8272\u7d81\u5b9a\u5230\u8a72\u7fa3\u7d44\u5f8c\uff0c\u6240\u6709\u672a\u7d93\u8eab\u4efd\u9a57\u8b49\u7684\u7528\u6236\u90fd\u6703\u7372\u5f97\u8a72\u89d2\u8272\u6388\u4e88\u7684\u6b0a\u9650\u3002                                     |\n| system:authenticated | \u7d44   | GKE \u6703\u5c07\u6b64\u7fa3\u7d44\u5206\u914d\u7d66\u4efb\u4f55\u4f7f\u7528 Google \u8cec\u865f\uff08\u5305\u62ec\u6240\u6709 Gmail \u8cec\u865f\uff09\u767b\u9304\u7684\u7528\u6236\u767c\u51fa\u7684 API \u670d\u52d9\u5668\u8acb\u6c42\u3002\u5be6\u969b\u4e0a\uff0c\u9019\u8207 system:unauthenticated \u6c92\u6709\u4ec0\u9ebc\u5340\u5225\uff0c\u56e0\u7232\u4efb\u4f55\u4eba\u90fd\u53ef\u4ee5\u5275\u5efa Google \u8cec\u865f\u3002 \u5c07\u89d2\u8272\u7d81\u5b9a\u5230\u8a72\u7fa3\u7d44\u5f8c\uff0c\u4efb\u4f55\u64c1\u6709 Google \u8cec\u865f\uff08\u5305\u62ec\u6240\u6709 Gmail \u8cec\u865f\uff09\u7684\u7528\u6236\u90fd\u6703\u7372\u5f97\u8a72\u89d2\u8272\u6388\u4e88\u7684\u6b0a\u9650\u3002 |\n| system:masters   | \u7d44   | \u9ed8\u8a8d\u60c5\u6cc1\u4e0b\uff0cKubernetes \u6703\u5c07 cluster-admin ClusterRole \u5206\u914d\u7d66\u8a72\u7fa3\u7d44\uff0c\u4ee5\u5553\u7528\u7cfb\u7d71\u529f\u80fd\u3002 \u5411\u8a72\u7fa3\u7d44\u6dfb\u52a0\u60a8\u81ea\u5df1\u7684\u4e3b\u9ad4\u5f8c\uff0c\u9019\u4e9b\u4e3b\u9ad4\u5c07\u80fd\u5920\u5c0d\u96c6\u7fa3\u4e2d\u7684\u4efb\u4f55\u8cc7\u6e90\u57f7\u884c\u4efb\u4f55\u64cd\u4f5c\u3002                              |\n**\u5982\u679c\u53ef\u80fd\uff0c\u8acb\u907f\u514d\u5275\u5efa\u6d89\u53ca\u9ed8\u8a8d\u7528\u6236\u3001\u89d2\u8272\u548c\u7fa3\u7d44\u7684\u7d81\u5b9a\u3002** \u9019\u53ef\u80fd\u6703\u5c0e\u81f4\u96c6\u7fa3\u7684\u5b89\u5168\u72c0\u6cc1\u51fa\u73fe\u610f\u5916\u5f8c\u679c\u3002\u4f8b\u5982\uff1a\n- \u5c07\u9ed8\u8a8d\u7684`cluster-admin`ClusterRole \u7d81\u5b9a\u5230`system:unauthenticated`\u7fa3\u7d44\u53ef\u8b93\u4efb\u4f55\u672a\u7d93\u8eab\u4efd\u9a57\u8b49\u7684\u7528\u6236\u8a2a\u554f\u96c6\u7fa3\u4e2d\u7684\u6240\u6709\u8cc7\u6e90\uff08\u5305\u62ec Secret\uff09\u3002\u9019\u4e9b\u7279\u6b0a\u9ad8\u7684\u7d81\u5b9a\u7531\u5927\u898f\u6a21\u60e1\u610f\u8edf\u4ef6\u6d3b\u52d5\u7b49\u653b\u64ca\u4e3b\u52d5\u4f5c\u7232\u76ee\u6a19\u3002\n- \u5c07\u81ea\u5b9a\u7fa9\u89d2\u8272\u7d81\u5b9a\u5230`system:unauthenticated`\u7fa3\u7d44\u6703\u4f7f\u672a\u7d93\u8eab\u4efd\u9a57\u8b49\u7684\u7528\u6236\u7372\u5f97\u8a72\u89d2\u8272\u6388\u4e88\u7684\u6b0a\u9650\u3002\n\u5982\u679c\u53ef\u80fd\uff0c\u8acb\u4f7f\u7528\u4ee5\u4e0b\u6e96\u5247\uff1a\n- \u8acb\u52ff\u5c07\u60a8\u81ea\u5df1\u7684\u4e3b\u9ad4\u6dfb\u52a0\u5230`system:masters`\u7d44\u3002\n- \u8acb\u52ff\u5c07`system:unauthenticated`\u7fa3\u7d44\u7d81\u5b9a\u5230\u4efb\u4f55 RBAC \u89d2\u8272\u3002\n- \u8acb\u52ff\u5c07`system:authenticated`\u7fa3\u7d44\u7d81\u5b9a\u5230\u4efb\u4f55 RBAC \u89d2\u8272\u3002\n- \u8acb\u52ff\u5c07`system:anonymous`\u7528\u6236\u7d81\u5b9a\u5230\u4efb\u4f55 RBAC \u89d2\u8272\u3002\n- \u8acb\u52ff\u5c07`cluster-admin`ClusterRole \u7d81\u5b9a\u5230\u60a8\u81ea\u5df1\u7684\u4e3b\u9ad4\u6216\u4efb\u4f55\u9ed8\u8a8d\u7528\u6236\u548c\u7fa3\u7d44\u3002\u5982\u679c\u60a8\u7684\u61c9\u7528\u9700\u8981\u8a31\u591a\u6b0a\u9650\uff0c\u8acb\u78ba\u5b9a\u6240\u9700\u7684\u78ba\u5207\u6b0a\u9650\uff0c\u7136\u5f8c\u7232\u6b64\u5275\u5efa\u4e00\u500b\u7279\u5b9a\u89d2\u8272\u3002\n- \u5728\u7d81\u5b9a\u4e3b\u9ad4\u4e4b\u524d\u8a55\u4f30\u5176\u4ed6\u9ed8\u8a8d\u89d2\u8272\u6388\u4e88\u7684\u6b0a\u9650\u3002\n- \u5728\u4fee\u6539\u9019\u4e9b\u7fa3\u7d44\u7684\u6210\u54e1\u4e4b\u524d\uff0c\u8acb\u8a55\u4f30\u7d81\u5b9a\u5230\u9ed8\u8a8d\u7fa3\u7d44\u7684\u89d2\u8272\u3002**\u6ce8\u610f\uff1a** \u7232\u4e86\u5e6b\u52a9\u60a8\u7684\u96c6\u7fa3\u514d\u53d7\u5229\u7528 `cluster-admin` \u8a2a\u554f\u914d\u7f6e\u932f\u8aa4\u7684\u5927\u578b\u60e1\u610f\u8edf\u4ef6\u653b\u64ca\uff0c\u904b\u884c 1.28 \u53ca\u66f4\u9ad8\u7248\u672c\u7684 GKE \u96c6\u7fa3\u4e0d\u5141\u8a31\u5c07 `cluster-admin` ClusterRole \u7d81\u5b9a\u5230 `system:anonymous` \u7528\u6236\uff0c\u4e5f\u4e0d\u5141\u8a31\u7d81\u5b9a\u5230 `system:unauthenticated` \u6216 `system:authenticated` \u7d44\u3002\n\u60a8\u61c9\u8a55\u4f30\u96c6\u7fa3\uff0c\u4ee5\u78ba\u5b9a\u662f\u5426\u5df2\u4f7f\u7528 ClusterRoleBinding \u548c RoleBinding \u7d81\u5b9a `system:anonymous` \u7528\u6236\u6216\u8005\u7d81\u5b9a `system:unauthenticated` \u6216 `system:authenticated` \u7fa3\u7d44\u3002- \u5217\u51fa\u4e3b\u9ad4\u7232 `system:anonymous` \u3001 `system:unauthenticated` \u6216 `system:authenticated` \u7684\u4efb\u4f55 ClusterRoleBinding \u7684\u540d\u7a31\uff1a```\nkubectl get clusterrolebindings -o json \\\u00a0 | jq -r '[\"Name\"], [\"-----\"], (.items[] | select((.subjects | length) > 0) | select(any(.subjects[]; .name == \"system:anonymous\" or .name == \"system:unauthenticated\" or .name == \"system:authenticated\")) | [.metadata.namespace, .metadata.name]) | @tsv'\n```\u8f38\u51fa\u61c9\u50c5\u5217\u51fa\u4ee5\u4e0b ClusterRoleBinding\uff1a```\nName\n---\"system:basic-user\"\n\"system:discovery\"\n\"system:public-info-viewer\"\n```\u5982\u679c\u8f38\u51fa\u5305\u542b\u5176\u4ed6\u975e\u9ed8\u8a8d\u7d81\u5b9a\uff0c\u8acb\u5c0d\u6bcf\u500b\u9644\u52a0\u7d81\u5b9a\u57f7\u884c\u4ee5\u4e0b\u64cd\u4f5c \u3002\u5982\u679c\u8f38\u51fa\u4e0d\u5305\u542b\u975e\u9ed8\u8a8d\u7d81\u5b9a\uff0c\u8acb\u8df3\u904e\u4ee5\u4e0b\u6b65\u9a5f\u3002\n- \u5217\u51fa\u8207\u7d81\u5b9a\u95dc\u806f\u7684\u89d2\u8272\u7684\u6b0a\u9650\uff1a```\nkubectl get clusterrolebinding CLUSTER_ROLE_BINDING_NAME -o json \\\u00a0 \u00a0 | jq ' .roleRef.name +\" \" + .roleRef.kind' \\\u00a0 \u00a0 | sed -e 's/\"//g' \\\u00a0 \u00a0 | xargs -l bash -c 'kubectl get $1 $0 -o yaml'\n```\u5c07 `` \u66ff\u63db\u7232\u975e\u9ed8\u8a8d ClusterRoleBinding \u7684\u540d\u7a31\u3002\u8f38\u51fa\u985e\u4f3c\u65bc\u4ee5\u4e0b\u5167\u5bb9\uff1a```\napiVersion: rbac.authorization.k8s.io/v1\nkind: ClusterRole\nmetadata:\n...\nrules:\n- apiGroups:\n - \"\"\n resources:\n - secrets\n verbs:\n - get\n - watch\n - list\n```\u5982\u679c\u60a8\u78ba\u5b9a\u8f38\u51fa\u4e2d\u7684\u6b0a\u9650\u53ef\u5b89\u5168\u6388\u4e88\u7d66\u9ed8\u8a8d\u7528\u6236\u6216\u7fa3\u7d44\uff0c\u5247\u7121\u9700\u57f7\u884c\u9032\u4e00\u6b65\u64cd\u4f5c\u3002\u5982\u679c\u60a8\u78ba\u5b9a\u7d81\u5b9a\u6388\u4e88\u7684\u6b0a\u9650\u4e0d\u5b89\u5168\uff0c\u8acb\u7e7c\u7e8c\u57f7\u884c\u4e0b\u4e00\u6b65\u3002\n- \u5f9e\u96c6\u7fa3\u4e2d\u522a\u9664\u4e0d\u5b89\u5168\u7684\u7d81\u5b9a\uff1a```\nkubectl delete clusterrolebinding CLUSTER_ROLE_BINDING_NAME\n```\u5c07 `` \u66ff\u63db\u7232\u8981\u522a\u9664\u7684 ClusterRoleBinding \u7684\u540d\u7a31\u3002- \u5217\u51fa\u4e3b\u9ad4\u7232 `system:anonymous` \u3001 `system:unauthenticated` \u6216 `system:authenticated` \u7684\u4efb\u4f55 RoleBinding \u7684\u547d\u540d\u7a7a\u9593\u548c\u540d\u7a31\uff1a```\nkubectl get rolebindings -A -o json \\\u00a0 | jq -r '[\"Namespace\", \"Name\"], [\"---------\", \"-----\"], (.items[] | select((.subjects | length) > 0) | select(any(.subjects[]; .name == \"system:anonymous\" or .name == \"system:unauthenticated\" or .name == \"system:authenticated\")) | [.metadata.namespace, .metadata.name]) | @tsv'\n```\u5982\u679c\u60a8\u7684\u96c6\u7fa3\u914d\u7f6e\u6b63\u78ba\uff0c\u5247\u8f38\u51fa\u61c9\u986f\u793a\u7232 **\u7a7a\u767d** \u3002 \u5982\u679c\u8f38\u51fa\u5305\u542b\u4efb\u4f55\u975e\u9ed8\u8a8d\u7d81\u5b9a\uff0c\u8acb\u5c0d\u6bcf\u500b\u9644\u52a0\u7d81\u5b9a\u57f7\u884c\u4ee5\u4e0b\u6b65\u9a5f \u3002\u5982\u679c\u8f38\u51fa\u7232\u7a7a\uff0c\u8acb\u8df3\u904e\u4ee5\u4e0b\u6b65\u9a5f\u3002\u5982\u679c\u60a8\u53ea\u77e5\u9053 RoleBinding \u7684\u540d\u7a31\uff0c\u5247\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u547d\u4ee4\u5728\u6240\u6709\u547d\u540d\u7a7a\u9593\u4e2d\u67e5\u627e\u5339\u914d\u7684\u89d2\u8272\u7d81\u5b9a\uff1a```\nkubectl get rolebindings -A -o json \\\u00a0 | jq -r '[\"Namespace\", \"Name\"], [\"---------\", \"-----\"], (.items[] | select((.subjects | length) > 0) | select(.metadata.name == \"ROLE_BINDING_NAME\") | [.metadata.namespace, .metadata.name]) | @tsv'\n```\u5c07 `` \u66ff\u63db\u7232\u975e\u9ed8\u8a8d RoleBinding \u7684\u540d\u7a31\u3002\n- \u5217\u51fa\u8207\u7d81\u5b9a\u95dc\u806f\u7684\u89d2\u8272\u7684\u6b0a\u9650\uff1a```\nkubectl get rolebinding ROLE_BINDING_NAME --namespace ROLE_BINDING_NAMESPACE -o json \\\u00a0 \u00a0 | jq ' .roleRef.name +\" \" + .roleRef.kind' \\\u00a0 \u00a0 | sed -e 's/\"//g' \\\u00a0 \u00a0 | xargs -l bash -c 'kubectl get $1 $0 -o yaml --namespace ROLE_BINDING_NAMESPACE'\n```\u66ff\u63db\u4ee5\u4e0b\u5167\u5bb9\uff1a- ``\uff1a\u975e\u9ed8\u8a8d RoleBinding \u7684\u540d\u7a31\u3002\n- ``\uff1a\u975e\u9ed8\u8a8d RoleBinding \u7684\u547d\u540d\u7a7a\u9593\u3002\n\u8f38\u51fa\u985e\u4f3c\u65bc\u4ee5\u4e0b\u5167\u5bb9\uff1a```\napiVersion: rbac.authorization.k8s.io/v1\nkind: Role\nmetadata:\n...\nrules:\n- apiGroups:\n - \"\"\n resources:\n - secrets\n verbs:\n - get\n - watch\n - list\n```\u5982\u679c\u60a8\u78ba\u5b9a\u8f38\u51fa\u4e2d\u7684\u6b0a\u9650\u53ef\u5b89\u5168\u6388\u4e88\u7d66\u9ed8\u8a8d\u7528\u6236\u6216\u7fa3\u7d44\uff0c\u5247\u7121\u9700\u57f7\u884c\u9032\u4e00\u6b65\u64cd\u4f5c\u3002\u5982\u679c\u60a8\u78ba\u5b9a\u7d81\u5b9a\u6388\u4e88\u7684\u6b0a\u9650\u4e0d\u5b89\u5168\uff0c\u8acb\u7e7c\u7e8c\u57f7\u884c\u4e0b\u4e00\u6b65\u3002\n- \u5f9e\u96c6\u7fa3\u4e2d\u522a\u9664\u4e0d\u5b89\u5168\u7684\u7d81\u5b9a\uff1a```\nkubectl delete rolebinding ROLE_BINDING_NAME --namespace ROLE_BINDING_NAMESPACE\n```\u66ff\u63db\u4ee5\u4e0b\u5167\u5bb9\uff1a- ``\uff1a\u8981\u522a\u9664\u7684 RoleBinding \u7684\u540d\u7a31\u3002\n- ``\uff1a\u8981\u522a\u9664\u7684 RoleBinding \u7684\u547d\u540d\u7a7a\u9593\u3002\n### \u5c07\u6b0a\u9650\u9650\u5236\u5230\u547d\u540d\u7a7a\u9593\u7d1a\u5225\n\u6839\u64da\u5de5\u4f5c\u8ca0\u8f09\u6216\u7528\u6236\u7684\u9700\u6c42\uff0c\u4f7f\u7528\u5982\u4e0b\u7d81\u5b9a\u548c\u89d2\u8272\uff1a\n- \u8981\u6388\u4e88\u5c0d **\u4e00\u500b** \u547d\u540d\u7a7a\u9593\u4e2d\u7684\u8cc7\u6e90\u7684\u8a2a\u554f\u6b0a\u9650\uff0c\u8acb\u4f7f\u7528`Role`\u548c`RoleBinding`\u3002\n- \u8981\u6388\u4e88\u5c0d **\u591a\u500b** \u547d\u540d\u7a7a\u9593\u4e2d\u8cc7\u6e90\u7684\u8a2a\u554f\u6b0a\u9650\uff0c\u8acb\u5728\u6bcf\u500b\u547d\u540d\u7a7a\u9593\u4e2d\u4f7f\u7528`ClusterRole`\u548c`RoleBinding`\u3002\n- \u8981\u6388\u4e88\u5c0d **\u6bcf\u500b** \u547d\u540d\u7a7a\u9593\u4e2d\u8cc7\u6e90\u7684\u8a2a\u554f\u6b0a\u9650\uff0c\u8acb\u4f7f\u7528`ClusterRole`\u548c`ClusterRoleBinding`\u3002\n\u5728\u5118\u53ef\u80fd\u5c11\u7684\u547d\u540d\u7a7a\u9593\u4e2d\u6388\u4e88\u6b0a\u9650\u3002\n### \u8acb\u52ff\u4f7f\u7528\u901a\u914d\u7b26\n`*` \u5b57\u7b26\u662f\u4e00\u500b\u9069\u7528\u65bc\u6240\u6709\u5167\u5bb9\u7684\u901a\u914d\u7b26 \u3002\u907f\u514d\u5728\u898f\u5247\u4e2d\u4f7f\u7528\u901a\u914d\u7b26\u3002\u5728 RBAC \u898f\u5247\u4e2d\u660e\u78ba\u6307\u5b9a API \u7d44\u3001\u8cc7\u6e90\u548c\u52d5\u8a5e\u3002\u4f8b\u5982\uff0c\u5728 `verbs` \u5b57\u6bb5\u4e2d\u6307\u5b9a `*` \u5c07\u6388\u4e88 `get` \u3001 `list` \u3001 `watch` \u3001 `patch` \u3001 `update` \u3001 `deletecollection` \u548c `delete` \u6b0a\u9650\u3002\u4e0b\u8868\u8209\u4f8b\u8aaa\u660e\u4e86\u5982\u4f55\u907f\u514d\u5728\u898f\u5247\u4e2d\u4f7f\u7528\u901a\u914d\u7b26\uff1a\n| \u63a8\u85a6                                           | \u4e0d\u63a8\u85a6                              |\n|:------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:------------------------------------------------------------------------------------------------------------------------------|\n| - rules: apiGroups: [\"apps\",\"extensions\"] resources: [\"deployments\"] verbs: [\"get\",\"list\",\"watch\"] \u5c08\u9580\u5411 apps \u548c extensions API \u7d44\u6388\u4e88 get\u3001list \u548c watch \u52d5\u8a5e\u3002   | - rules: apiGroups: [\"*\"] resources: [\"deployments\"] verbs: [\"get\",\"list\",\"watch\"] \u5c07\u52d5\u8a5e\u6388\u4e88\u4efb\u4f55 API \u7d44\u4e2d\u7684 deployments\u3002 |\n| - rules: apiGroups: [\"apps\", \"extensions\"] resources: [\"deployments\"] verbs: [\"get\", \"list\", \"watch\"] \u50c5\u5c07 get\u3001list \u548c watch \u52d5\u8a5e\u6388\u4e88 apps \u548c extensions API \u7d44\u4e2d\u7684\u90e8\u7f72\u3002 | - rules: apiGroups: [\"apps\", \"extensions\"] resources: [\"deployments\"] verbs: [\"*\"] \u6388\u4e88\u6240\u6709\u52d5\u8a5e\uff0c\u5305\u62ec patch \u6216 delete\u3002 |\n### \u4f7f\u7528\u55ae\u7368\u898f\u5247\u5c0d\u7279\u5b9a\u8cc7\u6e90\u6388\u4e88\u6700\u5c0f\u8a2a\u554f\u6b0a\u9650\n\u898f\u5283\u898f\u5247\u6642\uff0c\u8acb\u5617\u8a66\u4ee5\u4e0b\u7c21\u8981\u6b65\u9a5f\uff0c\u5728\u6bcf\u500b\u89d2\u8272\u4e2d\u63a1\u7528\u66f4\u9ad8\u6548\u7684\u6700\u5c0f\u6b0a\u9650\u898f\u5247\u8a2d\u8a08\uff1a\n- \u7232\u4e3b\u9ad4\u9700\u8981\u8a2a\u554f\u7684\u6bcf\u9805\u8cc7\u6e90\u4e0a\u7684\u52d5\u8a5e\u8349\u64ec\u55ae\u7368\u7684 RBAC \u898f\u5247\u3002\n- \u8349\u64ec\u898f\u5247\u5f8c\uff0c\u5206\u6790\u898f\u5247\uff0c\u4ee5\u6aa2\u67e5\u591a\u689d\u898f\u5247\u662f\u5426\u5177\u6709\u76f8\u540c\u7684`verbs`\u5217\u8868\u3002\u5c07\u9019\u4e9b\u898f\u5247\u5408\u4f75\u7232\u4e00\u689d\u898f\u5247\u3002\n- \u8acb\u5c07\u5176\u9918\u7684\u6240\u6709\u898f\u5247\u5f7c\u6b64\u5206\u6563\u3002\n\u9019\u7a2e\u65b9\u6cd5\u53ef\u5be6\u73fe\u66f4\u6709\u689d\u7406\u7684\u898f\u5247\u8a2d\u8a08\uff0c\u5c07\u5c0d\u591a\u500b\u8cc7\u6e90\u6388\u4e88\u76f8\u540c\u52d5\u8a5e\u7684\u898f\u5247\u7d44\u5408\u8d77\u4f86\uff0c\u5c07\u7232\u8cc7\u6e90\u6388\u4e88\u4e0d\u540c\u52d5\u8a5e\u7684\u898f\u5247\u5f7c\u6b64\u5206\u6563\u3002\n\u4f8b\u5982\uff0c\u5982\u679c\u60a8\u7684\u5de5\u4f5c\u8ca0\u8f09\u9700\u8981\u7372\u53d6 `deployments` \u8cc7\u6e90\u7684\u6b0a\u9650\uff0c\u4f46\u9700\u8981 `daemonsets` \u8cc7\u6e90\u7684 `list` \u548c `watch` \u6b0a\u9650\uff0c\u5247\u60a8\u61c9\u8a72\u5728\u5275\u5efa\u89d2\u8272\u662f\u4f7f\u7528\u55ae\u7368\u898f\u5247\u3002\u7576\u60a8\u5c07 RBAC \u89d2\u8272\u7d81\u5b9a\u5230\u5de5\u4f5c\u8ca0\u8f09\u6642\uff0c\u8a72\u89d2\u8272\u5c07\u7121\u6cd5\u5c0d `deployments` \u4f7f\u7528 `watch` \u3002\n\u518d\u8209\u4e00\u4f8b\uff0c\u5982\u679c\u60a8\u7684\u5de5\u4f5c\u8ca0\u8f09\u9700\u8981 `pods` \u8cc7\u6e90\u548c `daemonsets` \u8cc7\u6e90\u7684 `get` \u548c `watch` \u6b0a\u9650\uff0c\u60a8\u53ef\u4ee5\u5c07\u5b83\u5011\u7d44\u5408\u6210\u4e00\u689d\u898f\u5247\uff0c\u56e0\u7232\u5de5\u4f5c\u8ca0\u8f09\u9700\u8981\u5728\u9019\u5169\u500b\u8cc7\u6e90\u4e0a\u4f7f\u7528\u76f8\u540c\u7684\u52d5\u8a5e\u3002\n\u5728\u4e0b\u8868\u4e2d\uff0c\u9019\u5169\u7a2e\u898f\u5247\u8a2d\u8a08\u5747\u6709\u6548\uff0c\u4f46\u62c6\u5206\u898f\u5247\u6703\u6839\u64da\u9700\u8981\u66f4\u7cbe\u7d30\u5730\u9650\u5236\u8cc7\u6e90\u8a2a\u554f\u6b0a\u9650\uff1a\n| \u63a8\u85a6                                                                | \u4e0d\u63a8\u85a6                                                          |\n|:--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|\n| - rules: apiGroups: [\"apps\"] resources: [\"deployments\"] verbs: [\"get\"] - rules: apiGroups: [\"apps\"] resources: [\"daemonsets\"] verbs: [\"list\", \"watch\"] \u7232 Deployment \u6388\u4e88 get \u8a2a\u554f\u6b0a\u9650\uff0c\u7232 DaemonSet \u6388\u4e88 watch \u548c list \u8a2a\u554f\u6b0a\u9650\u3002 \u4e3b\u9ad4\u7121\u6cd5\u5217\u51fa Deployment\u3002 | - rules: apiGroups: [\"apps\"] resources: [\"deployments\", \"daemonsets\"] verbs: [\"get\",\"list\",\"watch\"] \u5c07\u52d5\u8a5e\u540c\u6642\u6388\u4e88 Deployment \u548c DaemonSet\u3002\u53ef\u80fd\u5c0d deployments \u5c0d\u8c61\u4e0d\u9700\u8981 list \u8a2a\u554f\u6b0a\u9650\u7684\u4e3b\u9ad4\u4ecd\u6703\u7372\u5f97\u8a72\u8a2a\u554f\u6b0a\u9650\u3002      |\n| - rules: apiGroups: [\"apps\"] resources: [\"daemonsets\", \"deployments\"] verbs: [\"list\", \"watch\"] \u7d44\u5408\u5169\u689d\u898f\u5247\uff0c\u56e0\u7232\u4e3b\u9ad4\u9700\u8981\u5c0d daemonsets \u548c deployments \u8cc7\u6e90\u4f7f\u7528\u76f8\u540c\u7684\u52d5\u8a5e\u3002                      | - rules: apiGroups: [\"apps\"] resources: [\"daemonsets\"] verbs: [\"list\", \"watch\"] - rules: apiGroups: [\"apps\"] resources: [\"deployments\"] verbs: [\"list\", \"watch\"] \u9019\u4e9b\u62c6\u5206\u898f\u5247\u7684\u7d50\u679c\u5c07\u8207\u7d44\u5408\u898f\u5247\u76f8\u540c\uff0c\u4f46\u6703\u5c0e\u81f4\u89d2\u8272\u6e05\u55ae\u7522\u751f\u4e0d\u5fc5\u8981\u7684\u96dc\u4e82 |\n### \u50c5\u9650\u8a2a\u554f\u7279\u5b9a\u8cc7\u6e90\u5be6\u4f8b\n\u901a\u904e RBAC\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528\u898f\u5247\u4e2d\u7684 `resourceNames` \u5b57\u6bb5\u50c5\u9650\u8a2a\u554f\u8cc7\u6e90\u7684\u7279\u5b9a\u547d\u540d\u5be6\u4f8b\u3002\u4f8b\u5982\uff0c\u5982\u679c\u60a8\u6b63\u5728\u7de8\u5beb\u50c5\u9700\u8981 `update` `seccomp-high` ConfigMap \u7684 RBAC \u89d2\u8272\uff0c\u5247\u53ef\u4ee5\u4f7f\u7528 `resourceNames` \u50c5\u6307\u5b9a\u8a72 ConfigMap\u3002\u5118\u53ef\u80fd\u4f7f\u7528 `resourceNames` \u3002\n**\u6ce8\u610f** \uff1a\u60a8\u4e0d\u80fd\u5c07 `resourceNames` \u7528\u65bc `list` \u548c `create` \u52d5\u8a5e\u3002\u4f8b\u5982\uff0c\u5982\u679c\u60a8\u7de8\u5beb\u7684\u89d2\u8272\u9700\u8981 `list` \u6240\u6709 ConfigMap\uff0c\u90a3\u9ebc\u9664\u4e86\u66f4\u65b0 `seccomp-high` ConfigMap \u4e4b\u5916\uff0c\u60a8\u9084\u9700\u8981\u62c6\u5206\u898f\u5247\u3002\n| \u63a8\u85a6                                                                                    | \u4e0d\u63a8\u85a6                                   |\n|:----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:-------------------------------------------------------------------------------------------------------------------------------------------------|\n| - rules: apiGroups: [\"\"] resources: [\"configmaps\"] resourceNames: [\"seccomp-high\"] verbs: [\"update\"] \u50c5\u9650\u4e3b\u9ad4\u66f4\u65b0 seccomp-high ConfigMap\u3002\u4e3b\u9ad4\u7121\u6cd5\u66f4\u65b0\u547d\u540d\u7a7a\u9593\u4e2d\u7684\u4efb\u4f55\u5176\u4ed6 ConfigMap\u3002                                       | - rules: apiGroups: [\"\"] resources: [\"configmaps\"] verbs: [\"update\"] \u4e3b\u9ad4\u53ef\u4ee5\u66f4\u65b0\u547d\u540d\u7a7a\u9593\u4e2d\u7684 seccomp-high ConfigMap \u4ee5\u53ca\u4efb\u4f55\u5176\u4ed6 ConfigMap\u3002 |\n| - rules: apiGroups: [\"\"] resources: [\"configmaps\"] verbs: [\"list\"] - rules: apiGroups: [\"\"] resources: [\"configmaps\"] resourceNames: [\"seccomp-high\"] verbs: [\"update\"] \u5411\u547d\u540d\u7a7a\u9593\u4e2d\u6240\u6709 ConfigMap \u6388\u4e88 list \u8a2a\u554f\u6b0a\u9650\uff0c\u5305\u62ec seccomp-high\u3002\u5c07 update \u8a2a\u554f\u6b0a\u9650\u50c5\u9650\u65bc seccomp-high ConfigMap\u3002\u9019\u4e9b\u898f\u5247\u662f\u62c6\u5206\u7684\uff0c\u56e0\u7232\u60a8\u7121\u6cd5\u7232\u547d\u540d\u8cc7\u6e90\u6388\u4e88 list\u3002 | - rules: apiGroups: [\"\"] resources: [\"configmaps\"] verbs: [\"update\", \"list\"] \u7232\u6240\u6709 ConfigMap \u6388\u4e88 update \u8a2a\u554f\u6b0a\u9650\u4ee5\u53ca list \u8a2a\u554f\u6b0a\u9650\u3002  |\n### \u4e0d\u5141\u8a31\u670d\u52d9\u8cec\u865f\u4fee\u6539 RBAC \u8cc7\u6e90\n\u8acb\u52ff\u5c07\u5c0d `rbac.authorization.k8s.io` API \u7d44\u5177\u6709 `bind` \u3001 `escalate` \u3001 `create` \u3001 `update` \u6216 `patch` \u6b0a\u9650\u7684 `Role` \u6216 `ClusterRole` \u8cc7\u6e90\u7d81\u5b9a\u5230\u4efb\u4f55\u547d\u540d\u7a7a\u9593\u4e2d\u7684\u670d\u52d9\u8cec\u865f\u3002\u7279\u5225\u662f `escalate` \u548c `bind` \u53ef\u8b93\u653b\u64ca\u8005\u7e5e\u904e [RBAC \u4e2d\u5167\u7f6e\u7684\u5347\u7d1a\u9810\u9632\u6a5f\u5236](https://kubernetes.io/docs/reference/access-authn-authz/rbac/#privilege-escalation-prevention-and-bootstrapping) \u3002\n## Kubernetes \u670d\u52d9\u8cec\u865f\n### \u7232\u6bcf\u500b\u5de5\u4f5c\u8ca0\u8f09\u5275\u5efa Kubernetes \u670d\u52d9\u8cec\u865f\n\u7232\u6bcf\u500b\u5de5\u4f5c\u8ca0\u8f09\u5275\u5efa\u55ae\u7368\u7684 Kubernetes \u670d\u52d9\u8cec\u865f\u3002\u5c07\u6700\u5c0f\u6b0a\u9650 `Role` \u6216 `ClusterRole` \u7d81\u5b9a\u5230\u8a72\u670d\u52d9\u8cec\u865f\u3002\n### \u8acb\u52ff\u4f7f\u7528\u9ed8\u8a8d\u670d\u52d9\u8cec\u865f\nKubernetes \u6703\u5728\u6bcf\u500b\u547d\u540d\u7a7a\u9593\u4e2d\u5275\u5efa\u4e00\u500b\u540d\u7232 `default` \u7684\u670d\u52d9\u8cec\u865f\u3002 `default` \u670d\u52d9\u8cec\u865f\u6703\u81ea\u52d5\u5206\u914d\u7d66\u672a\u5728\u6e05\u55ae\u4e2d\u660e\u78ba\u6307\u5b9a\u670d\u52d9\u8cec\u865f\u7684 Pod\u3002\u907f\u514d\u5c07 `Role` \u6216 `ClusterRole` \u7d81\u5b9a\u5230 `default` \u670d\u52d9\u8cec\u865f\u3002Kubernetes \u53ef\u80fd\u6703\u5c07 `default` \u670d\u52d9\u8cec\u865f\u5206\u914d\u7d66\u4e0d\u9700\u8981\u5728\u9019\u4e9b\u89d2\u8272\u4e2d\u6388\u4e88\u7684\u8a2a\u554f\u6b0a\u9650\u7684 Pod\u3002\n### \u8acb\u52ff\u81ea\u52d5\u88dd\u8f09\u670d\u52d9\u8cec\u865f\u4ee4\u724c\nPod \u898f\u7bc4\u4e2d\u7684 `automountServiceAccountToken` \u5b57\u6bb5\u6307\u793a Kubernetes \u5c07 Kubernetes \u670d\u52d9\u8cec\u865f\u7684\u6191\u64da\u6ce8\u5165 Pod\u3002Pod \u53ef\u4ee5\u4f7f\u7528\u6b64\u4ee4\u724c\u5411 Kubernetes API \u670d\u52d9\u5668\u767c\u51fa\u7d93\u904e\u8eab\u4efd\u9a57\u8b49\u7684\u8acb\u6c42\u3002\u6b64\u5b57\u6bb5\u7684\u9ed8\u8a8d\u503c\u7232 `true` \u3002\n\u5728\u6240\u6709 GKE \u7248\u672c\u4e2d\uff0c\u5982\u679c\u60a8\u7684 Pod \u4e0d\u9700\u8981\u8207 API \u670d\u52d9\u5668\u901a\u4fe1\uff0c\u8acb\u5728 Pod \u898f\u7bc4\u4e2d\u8a2d\u7f6e `automountServiceAccountToken=false` \u3002\n### \u9996\u9078\u81e8\u6642\u4ee4\u724c\u800c\u4e0d\u662f\u57fa\u65bc Secret \u7684\u4ee4\u724c\n\u5275\u5efa\u548c\u4f7f\u7528\u670d\u52d9\u8cec\u865f\u4ee4\u724c\u6642\uff0c\u8acb\u907f\u514d\u4f7f\u7528 Kubernetes Secret \u5b58\u5132\u4ee4\u724c\u3002\u57fa\u65bc Secret \u7684\u670d\u52d9\u8cec\u865f\u4ee4\u724c\u662f\u4e0d\u6703\u904e\u671f\u4e14\u4e0d\u6703\u81ea\u52d5\u8f2a\u66ff\u7684\u820a\u7248\u6191\u64da\u3002\u5982\u679c\u60a8\u9700\u8981\u670d\u52d9\u8cec\u865f\u7684\u6191\u64da\uff0c\u8acb\u4f7f\u7528 [TokenRequest API](https://kubernetes.io/docs/reference/kubernetes-api/authentication-resources/token-request-v1/) \u7372\u53d6\u53ef\u81ea\u52d5\u8f2a\u66ff\u7684\u77ed\u671f\u4ee4\u724c\u3002\n## \u6301\u7e8c\u5be9\u8988 RBAC \u6b0a\u9650\n\u5b9a\u671f\u5be9\u8988 RBAC \u89d2\u8272\u548c\u8a2a\u554f\u6b0a\u9650\uff0c\u4ee5\u78ba\u5b9a\u6f5b\u5728\u7684\u4e0a\u5831\u8def\u5f91\u548c\u5197\u9918\u898f\u5247\u3002\u4f8b\u5982\uff0c\u5047\u8a2d\u60a8\u6c92\u6709\u522a\u9664\u5c07\u5177\u6709\u7279\u6b8a\u6b0a\u9650\u7684 `Role` \u7d81\u5b9a\u5230\u5df2\u522a\u9664\u7528\u6236\u7684 `RoleBinding` \u3002\u5982\u679c\u653b\u64ca\u8005\u5728\u8a72\u547d\u540d\u7a7a\u9593\u4e2d\u5275\u5efa\u4e00\u500b\u8207\u5df2\u522a\u9664\u7528\u6236\u540c\u540d\u7684\u7528\u6236\u8cec\u865f\uff0c\u5247\u4ed6\u5011\u5c07\u7d81\u5b9a\u5230\u8a72 `Role` \u4e26\u7e7c\u627f\u76f8\u540c\u7684\u8a2a\u554f\u6b0a\u9650\u3002\u5b9a\u671f\u5be9\u8988\u53ef\u5c07\u6b64\u98a8\u96aa\u964d\u81f3\u6700\u4f4e\u3002\n## \u8988\u5c0d\u6e05\u55ae\u6458\u8981\n## \u5f8c\u7e8c\u6b65\u9a5f\n- [\u95b1\u8b80 GKE \u5b89\u5168\u5f37\u5316\u5efa\u8b70](https://cloud.google.com/kubernetes-engine/docs/how-to/hardening-your-cluster?hl=zh-cn) \u3002\n- [\u95b1\u8b80 Kubernetes RBAC \u6700\u4f73\u505a\u6cd5](https://kubernetes.io/docs/concepts/security/rbac-good-practices/) \u3002\n- [\u63a2\u7d22\u6211\u5011\u7684\u5176\u4ed6\u6700\u4f73\u505a\u6cd5](https://cloud.google.com/kubernetes-engine/docs/best-practices?hl=zh-cn) \u3002\n- [\u67e5\u770b\u5e38\u898b\u96c6\u7fa3\u89d2\u8272\u7684\u793a\u4f8b\u6e05\u55ae](https://github.com/GoogleCloudPlatform/gke-rbac-best-practices)", "guide": "Google Kubernetes Engine (GKE)"}