{"title": "Google Kubernetes Engine (GKE) - \u63a7\u5236\u5c64\u9762\u5b89\u5168", "url": "https://cloud.google.com/kubernetes-engine/docs/concepts/control-plane-security?hl=zh-cn", "abstract": "# Google Kubernetes Engine (GKE) - \u63a7\u5236\u5c64\u9762\u5b89\u5168\n\u672c\u6587\u6a94\u4ecb\u7d39 Google Kubernetes Engine (GKE) \u5982\u4f55\u4fdd\u8b77\u96c6\u7fa3\u63a7\u5236\u5c64\u9762\u7d44\u4ef6\u3002\n\u5728 [\u5171\u540c\u8cac\u4efb\u6a21\u5f0f](https://cloud.google.com/kubernetes-engine/docs/concepts/shared-responsibility?hl=zh-cn#googles_responsibilities) \u4e0b\uff0cGoogle \u6703\u7232\u60a8\u7ba1\u7406 GKE \u63a7\u5236\u5e73\u9762\u7d44\u4ef6\u3002\u63a7\u5236\u5e73\u9762\u5305\u62ec Kubernetes API \u670d\u52d9\u5668\u3001etcd \u5b58\u5132\u548c\u5176\u4ed6\u63a7\u5236\u5668\u3002\u60a8\u53ef\u80fd\u80fd\u5920\u6839\u64da\u81ea\u5df1\u7684\u8981\u6c42\u914d\u7f6e\u67d0\u4e9b\u9078\u9805\uff0c\u4f46\u63a7\u5236\u5e73\u9762\u7684\u5b89\u5168\u7531 Google \u8ca0\u8cac\u3002\u60a8\u8ca0\u8cac\u7bc0\u9ede\u3001\u5bb9\u5668\u548c Pod \u7684\u5b89\u5168\u3002\n", "content": "## \u5b89\u5168\u5f37\u5316\u578b\u64cd\u4f5c\u7cfb\u7d71\nGKE \u63a7\u5236\u5e73\u9762\u7d44\u4ef6\u5728 [Container-Optimized OS](https://cloud.google.com/container-optimized-os/docs/concepts/features-and-benefits?hl=zh-cn) \u4e2d\u904b\u884c\uff0c\u8a72\u64cd\u4f5c\u7cfb\u7d71\u662f\u7531 Google \u8a2d\u8a08\u7684\u5b89\u5168\u5f37\u5316\u578b\u64cd\u4f5c\u7cfb\u7d71\u3002\u5982\u9700\u8a73\u7d30\u77ad\u89e3 Container-Optimized OS \u7684\u5167\u7f6e\u5b89\u5168\u529f\u80fd\uff0c\u8acb\u53c3\u95b1 [Container-Optimized OS \u5b89\u5168\u6982\u89bd](https://cloud.google.com/container-optimized-os/docs/concepts/security?hl=zh-cn) \u3002\n## \u67b6\u69cb\u548c\u9694\u96e2\n\u5728 GKE \u96c6\u7fa3\u4e2d\uff0c\u63a7\u5236\u5c64\u9762\u7d44\u4ef6\u5728 Google \u7ba1\u7406\u7684\u9805\u76ee\u4e2d\u7684\u7531 Google \u64c1\u6709\u7684 Compute Engine \u5be6\u4f8b\u4e0a\u904b\u884c\u3002\u6bcf\u500b\u5be6\u4f8b\u50c5\u7232\u4e00\u500b\u96c6\u7fa3\u904b\u884c\u9019\u4e9b\u7d44\u4ef6\u3002\n\u5982\u9700\u8a73\u7d30\u77ad\u89e3\u96c6\u7fa3\u7d44\u4ef6\u5982\u4f55\u5c0d\u5f7c\u6b64\u9032\u884c\u8eab\u4efd\u9a57\u8b49\uff0c\u8acb\u53c3\u95b1 [\u96c6\u7fa3\u4fe1\u4efb](https://cloud.google.com/kubernetes-engine/docs/concepts/cluster-trust?hl=zh-cn) \u3002\n## \u63a7\u5236\u5c0d\u9805\u76ee\u7684\u5c64\u9762\u8a2a\u554f\u6b0a\u9650\nGKE \u4f7f\u7528\u540d\u7232 Kubernetes Engine Service Agent \u7684 [Google \u7ba1\u7406\u7684\u670d\u52d9\u8cec\u865f](https://cloud.google.com/iam/docs/service-account-types?hl=zh-cn#google-managed) \uff0c\u4ee3\u8868\u60a8\u57f7\u884c\u64cd\u4f5c\uff08\u4f8b\u5982\u7bc0\u9ede\u3001\u78c1\u76e4\u548c\u8ca0\u8f09\u5747\u8861\u5668\uff09\u3002\u670d\u52d9\u8cec\u865f\u6703\u81ea\u52d5\u7372\u5f97\u9805\u76ee\u7684 [Kubernetes Engine Service Agent \u89d2\u8272](https://cloud.google.com/iam/docs/understanding-roles?hl=zh-cn#service-agents-roles) ( `roles/container.serviceAgent` )\u3002\nKubernetes Engine Service Agent \u5177\u6709\u4ee5\u4e0b\u96fb\u5b50\u90f5\u4ef6\u5730\u5740\uff1a\n```\nservice-PROJECT_NUMBER@container-engine-robot.iam.gserviceaccount.com\n```\n\u5728\u6b64\u96fb\u5b50\u90f5\u4ef6\u5730\u5740\u4e2d\uff0c `` \u662f\u60a8\u7684 [\u9805\u76ee\u7de8\u865f](https://cloud.google.com/resource-manager/docs/creating-managing-projects?hl=zh-cn#identifying_projects) \u3002\n## \u96c6\u7fa3\u7684\u7ba1\u7406\u54e1\u6b0a\u9650\nGoogle \u7ad9\u9ede\u53ef\u9760\u6027\u5de5\u7a0b\u5e2b\u7684 SSH \u6703\u8a71\u901a\u904e Google \u7684\u5167\u90e8\u5be9\u8a08\u57fa\u790e\u8a2d\u65bd\u5be9\u8a08\u8a18\u9304\uff0c\u53ef\u7528\u65bc\u53d6\u8b49\u548c\u5b89\u5168\u97ff\u61c9\u3002\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 Google \u5b89\u5168\u6027\u767d\u76ae\u66f8\u4e2d\u7684 [\u7ba1\u7406\u54e1\u6b0a\u9650](https://cloud.google.com/security/overview/whitepaper?hl=zh-cn#administrative_access) \u3002\n## etcd \u5b89\u5168\u6027\n\u5728 Google Cloud \u4e2d\uff0c\u9ed8\u8a8d\u60c5\u6cc1\u4e0b\uff0c\u5ba2\u6236\u5167\u5bb9\u5728\u6587\u4ef6\u7cfb\u7d71\u5c64\u52a0\u5bc6\u3002\u56e0\u6b64\uff0c\u8a17\u7ba1 GKE \u96c6\u7fa3\u7684 etcd \u5b58\u5132\u7684\u78c1\u76e4\u5728\u6587\u4ef6\u7cfb\u7d71\u5c64\u52a0\u5bc6\u3002\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [\u975c\u614b\u52a0\u5bc6](https://cloud.google.com/security/encryption/default-encryption?hl=zh-cn) \u3002\netcd \u76e3\u807d\u5169\u500b TCP \u7aef\u53e3\u3002\u7aef\u53e3 2379 \u7528\u65bc etcd \u5ba2\u6236\u7aef\uff0c\u5982 Kubernetes API \u670d\u52d9\u5668\u3002\u7aef\u53e3 2379 \u7d81\u5b9a\u5230\u672c\u5730\u74b0\u56de\u7db2\u7d61\u63a5\u53e3\uff0c\u56e0\u6b64\u53ea\u80fd\u5f9e\u904b\u884c Kubernetes API \u670d\u52d9\u5668\u7684\u865b\u64ec\u6a5f\u8a2a\u554f\u3002\u7aef\u53e3 2380 \u7528\u65bc\u670d\u52d9\u5668\u5230\u670d\u52d9\u5668\u7684\u901a\u4fe1\u3002\u7aef\u53e3 2380 \u4e0a\u7684\u6d41\u91cf\u901a\u904e\u96d9\u5411 TLS \u52a0\u5bc6\uff0c\u4e5f\u5c31\u662f\u8aaa\uff0c\u5169\u7aef\u7684\u670d\u52d9\u5668\u5fc5\u9808\u5411\u5f7c\u6b64\u8b49\u660e\u8eab\u4efd\u3002\u5728\u5340\u57df\u6027\u96c6\u7fa3\u4e2d\uff0c\u7528\u65bc\u5efa\u7acb\u4ef2\u88c1\u7684 etcd \u670d\u52d9\u5668\u4e4b\u9593\u7684\u901a\u4fe1\u901a\u904e [\u96d9\u5411 TLS](https://www.wikipedia.org/wiki/Mutual_authentication) \u52a0\u5bc6\u3002\n## \u8b49\u66f8\u6388\u6b0a\u6a5f\u69cb\u548c\u96c6\u7fa3\u4fe1\u4efb\n\u6bcf\u500b\u96c6\u7fa3\u90fd\u6709\u81ea\u5df1\u7684 [\u6839\u8b49\u66f8\u6388\u6b0a\u6a5f\u69cb (CA)](https://kubernetes.io/docs/tasks/tls/managing-tls-in-a-cluster) \u3002Google \u5167\u90e8\u670d\u52d9\u7ba1\u7406\u6b64\u985e\u6839\u8b49\u66f8\u9812\u767c\u6a5f\u69cb\u7684\u6839\u5bc6\u9470\u3002\u6bcf\u500b\u96c6\u7fa3\u9084\u6709\u81ea\u5df1\u7684 etcd \u6839\u8b49\u66f8\u9812\u767c\u6a5f\u69cb\u3002etcd \u6839\u8b49\u66f8\u9812\u767c\u7d50\u69cb\u7684\u6839\u5bc6\u9470\u6703\u5206\u767c\u7d66\u904b\u884c Kubernetes API \u670d\u52d9\u5668\u7684\u865b\u64ec\u6a5f\u7684\u5143\u6578\u64da\u3002 \u7bc0\u9ede\u8207 Kubernetes API \u670d\u52d9\u5668\u4e4b\u9593\u7684\u901a\u4fe1\u53d7 TLS \u4fdd\u8b77\u3002\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [\u96c6\u7fa3\u4fe1\u4efb](https://cloud.google.com/kubernetes-engine/docs/concepts/cluster-trust?hl=zh-cn) \u3002\n## \u6f0f\u6d1e\u548c\u88dc\u4e01\u7a0b\u5e8f\u7ba1\u7406\nGKE \u9075\u5faa Google \u6a19\u6e96\u4f86\u6e2c\u8a66\u3001\u9451\u5b9a\u548c\u9010\u6b65\u63a8\u51fa\u5c0d\u63a7\u5236\u5e73\u9762\u7684\u66f4\u6539\u3002\u9019\u6a23\u53ef\u4ee5\u6700\u5927\u9650\u5ea6\u5730\u964d\u4f4e\u63a7\u5236\u5e73\u9762\u7d44\u4ef6\u4e0d\u53ef\u7528\u7684\u98a8\u96aa\u3002GKE \u9075\u5faa [\u670d\u52d9\u7b49\u7d1a\u5354\u8b70](https://cloud.google.com/kubernetes-engine/sla?hl=zh-cn) \uff0c\u8a72\u5354\u8b70\u5b9a\u7fa9\u4e86\u53ef\u7528\u6027\u7684\u8af8\u591a\u65b9\u9762\u3002\nGKE \u63a7\u5236\u5e73\u9762\u7d44\u4ef6\u7531 Google \u7ad9\u9ede\u53ef\u9760\u6027\u5de5\u7a0b\u5e2b\u5718\u968a\u7ba1\u7406\uff0c\u4e26\u4fdd\u6301\u7528\u6700\u65b0\u7684\u5b89\u5168\u88dc\u4e01\u5be6\u6642\u66f4\u65b0\u3002\u9019\u5305\u62ec\u4e3b\u6a5f\u64cd\u4f5c\u7cfb\u7d71\u3001Kubernetes \u7d44\u4ef6\u4ee5\u53ca\u5728\u63a7\u5236\u5e73\u9762\u865b\u64ec\u6a5f\u4e0a\u904b\u884c\u7684\u5bb9\u5668\u7684\u88dc\u4e01\u3002\nGKE \u6703\u53ca\u6642\u61c9\u7528\u65b0\u7684\u5167\u6838\u3001\u64cd\u4f5c\u7cfb\u7d71\u548c Kubernetes \u7d1a\u5225\u7684\u4fee\u5fa9\u4f86\u63a7\u5236\u5e73\u9762\u865b\u64ec\u6a5f\uff0c\u5728\u5176\u4e2d\u5305\u542b\u5c0d\u5df2\u77e5\u6f0f\u6d1e\u7684\u4fee\u5fa9\u6642\uff0c\u60a8\u53ef\u4ee5\u5728 GKE [\u5b89\u5168\u516c\u544a](https://cloud.google.com/kubernetes-engine/docs/security-bulletins?hl=zh-cn) \u4e2d\u627e\u5230\u66f4\u591a\u4fe1\u606f\u3002GKE \u4f7f\u7528 [Artifact Analysis](https://cloud.google.com/container-analysis/docs/get-image-vulnerabilities?hl=zh-cn) \u6383\u63cf\u6240\u6709 Kubernetes \u7cfb\u7d71\u548c GKE \u7279\u5b9a\u5bb9\u5668\u7684\u6f0f\u6d1e\uff0c\u4e26\u5be6\u6642\u4fee\u88dc\u5bb9\u5668\uff0c\u5f9e\u800c\u4f7f\u6574\u500b Kubernetes \u751f\u614b\u7cfb\u7d71\u53d7\u76ca\u3002\nGoogle \u5de5\u7a0b\u5e2b\u53c3\u8207\u67e5\u627e\u3001\u4fee\u5fa9\u548c\u62ab\u9732 Kubernetes \u5b89\u5168\u932f\u8aa4\u3002Google \u9084\u901a\u904e [Google \u6f0f\u6d1e\u734e\u52f5\u8a08\u5283](https://bughunters.google.com/about/rules/6625378258649088?hl=zh-cn) \u5411\u5916\u90e8\u5b89\u5168\u7814\u7a76\u4eba\u54e1\u652f\u4ed8\u5831\u916c\uff0c\u4ee5\u5c0b\u627e\u5b89\u5168\u6f0f\u6d1e\u3002\u5728\u67d0\u4e9b\u60c5\u6cc1\u4e0b\uff0c\u4f8b\u5982 2017 \u5e74 10 \u6708\u7684 [dnsmasq \u6f0f\u6d1e](https://security.googleblog.com/2017/10/behind-masq-yet-more-dns-and-dhcp.html) \uff0cGKE \u6210\u529f\u5728\u6f0f\u6d1e\u516c\u958b\u4e4b\u524d\u4fee\u88dc\u4e86\u6240\u6709\u6b63\u5728\u904b\u884c\u7684\u96c6\u7fa3\u3002\n## \u5f8c\u7e8c\u5167\u5bb9\n\u672c\u4e3b\u984c\u524d\u9762\u8a0e\u8ad6\u7684\u5b89\u5168\u529f\u80fd\u7531 Google \u7ba1\u7406\u3002 \u672c\u7bc0\u548c\u4e0b\u4e00\u7bc0\u8a0e\u8ad6\u60a8\u53ef\u4ee5\u76e3\u63a7\u548c\u914d\u7f6e\u7684\u5b89\u5168\u529f\u80fd\u3002\n\u81ea GKE 1.8.3 \u7248\u8d77\u5275\u5efa\u7684\u96c6\u7fa3\u9ed8\u8a8d\u5553\u7528 [\u5be9\u8988\u65e5\u8a8c\u8a18\u9304](https://cloud.google.com/kubernetes-engine/docs/how-to/audit-logging?hl=zh-cn) \u3002\u9019\u63d0\u4f9b\u4e86\u5c0d Kubernetes API \u670d\u52d9\u5668\u9032\u884c\u8abf\u7528\u7684\u8a73\u7d30\u8a18\u9304\uff08\u53ef\u5728 Google Cloud Observability \u4e2d\u7372\u53d6\uff09\u3002\u60a8\u53ef\u4ee5\u5728 Google Cloud \u63a7\u5236\u6aaf\u7684 [Logs Explorer](https://console.cloud.google.com/logs/query?hl=zh-cn) \u4e2d\u67e5\u770b\u65e5\u8a8c\u689d\u76ee\u3002\u60a8\u9084\u53ef\u4ee5\u4f7f\u7528 BigQuery \u67e5\u770b\u548c\u5206\u6790\u9019\u4e9b\u65e5\u8a8c\u3002\n## \u60a8\u53ef\u4ee5\u914d\u7f6e\u7684\u5167\u5bb9\n\u9ed8\u8a8d\u60c5\u6cc1\u4e0b\uff0cKubernetes API \u670d\u52d9\u5668\u4f7f\u7528\u516c\u5171 IP \u5730\u5740\u3002\u8981\u4fdd\u8b77 Kubernetes API \u670d\u52d9\u5668\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528 [\u6388\u6b0a\u7db2\u7d61](https://cloud.google.com/kubernetes-engine/docs/how-to/authorized-networks?hl=zh-cn) \u548c [\u5c08\u7528\u96c6\u7fa3](https://cloud.google.com/kubernetes-engine/docs/how-to/private-clusters?hl=zh-cn) \uff0c\u4ee5\u5141\u8a31\u60a8\u5c07\u5c08\u7528 IP \u5730\u5740\u5206\u914d\u7d66 Kubernetes API \u670d\u52d9\u5668\u4e26\u505c\u7528\u5c0d\u516c\u5171 IP \u5730\u5740\u7684\u8a2a\u554f\u6b0a\u9650\u3002\n\u60a8\u53ef\u4ee5\u901a\u904e\u5c07 IAM \u7528\u4f5c\u8eab\u4efd\u63d0\u4f9b\u65b9\u5728 GKE \u4e2d\u8655\u7406\u96c6\u7fa3\u8eab\u4efd\u9a57\u8b49\u3002\u7232\u4e86\u589e\u5f37\u8eab\u4efd\u9a57\u8b49\u7684\u5b89\u5168\u6027\uff0c\u5c0d\u65bc\u4f7f\u7528 GKE 1.12 \u53ca\u66f4\u9ad8\u7248\u672c\u5275\u5efa\u7684\u96c6\u7fa3\uff0c\u9ed8\u8a8d\u60c5\u6cc1\u4e0b\u7cfb\u7d71\u6703\u505c\u7528\u57fa\u672c\u8eab\u4efd\u9a57\u8b49\u548c\u5ba2\u6236\u7aef\u8b49\u66f8\u9812\u767c\u3002\n\u60a8\u53ef\u4ee5\u901a\u904e\u5b9a\u671f\u57f7\u884c [\u6191\u64da\u8f2a\u66ff](https://cloud.google.com/kubernetes-engine/docs/how-to/credential-rotation?hl=zh-cn) \u4f86\u589e\u5f37\u63a7\u5236\u5c64\u9762\u7684\u5b89\u5168\u3002\u5553\u52d5\u6191\u64da\u8f2a\u66ff\u5f8c\uff0cTLS \u8b49\u66f8\u548c\u96c6\u7fa3\u8b49\u66f8\u9812\u767c\u6a5f\u69cb\u5c07\u81ea\u52d5\u8f2a\u66ff\u3002 GKE \u9084\u6703\u8f2a\u66ff Kubernetes API \u670d\u52d9\u5668\u7684 IP \u5730\u5740\u3002\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [\u57fa\u65bc\u89d2\u8272\u7684\u8a2a\u554f\u63a7\u5236 (RBAC)](https://cloud.google.com/kubernetes-engine/docs/how-to/role-based-access-control?hl=zh-cn) \u548c [\u6191\u64da\u8f2a\u66ff](https://cloud.google.com/kubernetes-engine/docs/how-to/credential-rotation?hl=zh-cn) \u3002\n## \u5f8c\u7e8c\u6b65\u9a5f\n- [\u5b89\u5168\u6982\u89bd](https://cloud.google.com/kubernetes-engine/docs/concepts/security-overview?hl=zh-cn) \n- [Container-Optimized OS \u5b89\u5168\u6982\u89bd](https://cloud.google.com/container-optimized-os/docs/concepts/security?hl=zh-cn) \n- [\u5f37\u5316\u96c6\u7fa3\u7684\u5b89\u5168\u6027](https://cloud.google.com/kubernetes-engine/docs/how-to/hardening-your-cluster?hl=zh-cn)", "guide": "Google Kubernetes Engine (GKE)"}