{"title": "Google Kubernetes Engine (GKE) - \u5f9e Docker \u9077\u79fb\u5230 containerd \u7bc0\u9ede\u6620\u50cf", "url": "https://cloud.google.com/kubernetes-engine/docs/how-to/migrate-containerd?hl=zh-cn", "abstract": "# Google Kubernetes Engine (GKE) - \u5f9e Docker \u9077\u79fb\u5230 containerd \u7bc0\u9ede\u6620\u50cf\n\u672c\u9801\u9762\u4ecb\u7d39\u5982\u4f55\u5c07 Google Kubernetes Engine (GKE) Standard \u96c6\u7fa3\u548c\u7bc0\u9ede\u6c60\u9077\u79fb\u5230\u4f7f\u7528 containerd \u5bb9\u5668\u904b\u884c\u6642\u7684\u7bc0\u9ede\u6620\u50cf\u3002\n**\u91cd\u8981\u63d0\u793a\uff1a** \u5728 1.23 \u7248 [\u65bc 2023 \u5e74 7 \u6708 31 \u65e5\u9054\u5230\u670d\u52d9\u7d42\u6b62\u671f\u9650](https://cloud.google.com/kubernetes-engine/docs/release-schedule?hl=zh-cn#schedule-for-release-channels) \u5f8c\uff0cGKE \u6703\u958b\u59cb\u81ea\u52d5\u5c07\u96c6\u7fa3\u9077\u79fb\u5230 GKE 1.24 \u7248\u3002\u5982\u9700\u8a73\u7d30\u77ad\u89e3\u9077\u79fb\u904e\u7a0b\u7684\u5de5\u4f5c\u539f\u7406\uff0c\u4ee5\u53ca\u5728 1.23 \u7248\u9054\u5230\u670d\u52d9\u7d42\u6b62\u671f\u9650\u5f8c\u5982\u4f55\u4f7f\u7528\u7dad\u8b77\u6392\u9664\u9805\u4f86\u66ab\u6642\u963b\u6b62\u7bc0\u9ede\u9077\u79fb\u5230 containerd \u7bc0\u9ede\u6620\u50cf\uff0c\u8acb\u53c3\u95b1 [\u66ab\u6642\u5ef6\u9072\u81ea\u52d5\u9077\u79fb\u5230 containerd \u7bc0\u9ede\u6620\u50cf](https://cloud.google.com/kubernetes-engine/docs/deprecations/docker-containerd?hl=zh-cn#temporarily-delay) \u3002\n", "content": "## \u6982\u89bd\nKubernetes \u7bc0\u9ede\u4f7f\u7528\u5bb9\u5668\u904b\u884c\u6642 \u5553\u52d5\u3001\u7ba1\u7406\u548c\u505c\u6b62 Pod \u4e2d\u904b\u884c\u7684\u5bb9\u5668\u3002 [containerd \u904b\u884c\u6642](https://containerd.io/) \u662f GKE \u652f\u6301\u7684\u884c\u696d\u6a19\u6e96\u5bb9\u5668\u904b\u884c\u6642\u3002\ncontainerd \u904b\u884c\u6642\u63d0\u4f9b\u4e86\u5206\u5c64\u62bd\u8c61\uff0c\u53ef\u5be6\u73fe [gVisor](https://gvisor.dev/) \u548c [\u6620\u50cf\u6d41\u5f0f\u50b3\u8f38](https://cloud.google.com/kubernetes-engine/docs/how-to/image-streaming?hl=zh-cn) \u7b49\u4e00\u7d44\u8c50\u5bcc\u7684\u7279\u5fb5\u4f86\u64f4\u5c55 GKE \u529f\u80fd\u3002\u8207 Docker \u904b\u884c\u6642\u76f8\u6bd4\uff0ccontainerd \u904b\u884c\u6642\u88ab\u8a8d\u7232\u66f4\u7701\u8cc7\u6e90\u4e14\u66f4\u5b89\u5168\u3002\n**\u6ce8\u610f** \uff1aGKE 1.24 \u53ca\u66f4\u9ad8\u7248\u672c\u50c5\u652f\u6301\u4f7f\u7528 containerd \u904b\u884c\u6642\u7684\u7bc0\u9ede\u6620\u50cf\u3002\u5c0d\u65bc\u4f7f\u7528 Docker \u7bc0\u9ede\u6620\u50cf\u7684\u96c6\u7fa3\uff0c\u5728 1.23 \u7248\u9054\u5230\u670d\u52d9\u7d42\u6b62\u671f\u9650\u4e4b\u524d\uff0c\u7cfb\u7d71\u6703\u66ab\u505c\u81ea\u52d5\u5347\u7d1a\u5230 1.24 \u4e26\u963b\u6b62\u624b\u52d5\u5347\u7d1a\uff0c\u76f4\u5230\u6240\u6709\u7bc0\u9ede\u90fd\u9077\u79fb\u5230 containerd \u7bc0\u9ede\u6620\u50cf\u3002\u5982\u9700\u8a73\u7d30\u77ad\u89e3\u5c0d Docker \u652f\u6301\u7684\u79fb\u9664\u4ee5\u53ca\u9077\u79fb\u7684\u6f5b\u5728\u5f71\u97ff\uff0c\u8acb\u53c3\u95b1 [\u95dc\u65bc Docker \u7bc0\u9ede\u6620\u50cf\u68c4\u7528](https://cloud.google.com/kubernetes-engine/docs/deprecations/docker-containerd?hl=zh-cn) \u3002\n\u5982\u9700\u9077\u79fb\u5bb9\u5668\u904b\u884c\u6642\uff0c\u8acb\u57f7\u884c\u4ee5\u4e0b\u64cd\u4f5c\uff1a\n- \u8b58\u5225\u4f7f\u7528 Docker \u904b\u884c\u6642\u7684\u7bc0\u9ede\n- \u9a57\u8b49\u9077\u79fb\u7684\u5f71\u97ff\n- \u66f4\u6539\u7bc0\u9ede\u6620\u50cf## \u6e96\u5099\u5de5\u4f5c\n\u5728\u958b\u59cb\u4e4b\u524d\uff0c\u8acb\u78ba\u4fdd\u60a8\u5df2\u57f7\u884c\u4ee5\u4e0b\u4efb\u52d9\uff1a\n- \u5553\u7528 Google Kubernetes Engine API\u3002\n- [  \u5553\u7528 Google Kubernetes Engine API ](https://console.cloud.google.com/flows/enableapi?apiid=container.googleapis.com&hl=zh-cn) \n- \u5982\u679c\u60a8\u8981\u4f7f\u7528 Google Cloud CLI \u57f7\u884c\u6b64\u4efb\u52d9\uff0c\u8acb [\u5b89\u88dd](https://cloud.google.com/sdk/docs/install?hl=zh-cn) \u4e26 [\u521d\u59cb\u5316](https://cloud.google.com/sdk/docs/initializing?hl=zh-cn) gcloud CLI\u3002 \u5982\u679c\u60a8\u4e4b\u524d\u5b89\u88dd\u4e86 gcloud CLI\uff0c\u8acb\u904b\u884c`gcloud components update`\u4ee5\u7372\u53d6\u6700\u65b0\u7248\u672c\u3002 **\u6ce8\u610f** \uff1a\u5c0d\u65bc\u73fe\u6709 gcloud CLI \u5b89\u88dd\uff0c\u8acb\u52d9\u5fc5\u8a2d\u7f6e`compute/region`\u548c`compute/zone` [\u5c6c\u6027](https://cloud.google.com/sdk/docs/properties?hl=zh-cn#setting_properties) \u3002\u901a\u904e\u8a2d\u7f6e\u9ed8\u8a8d\u4f4d\u7f6e\uff0c\u60a8\u53ef\u4ee5\u907f\u514d gcloud CLI \u4e2d\u51fa\u73fe\u4ee5\u4e0b\u932f\u8aa4\uff1a`One of [--zone, --region] must be supplied: Please specify location`\u3002## \u8b58\u5225\u4f7f\u7528 Docker \u904b\u884c\u6642\u7684\u7bc0\u9ede\n\u60a8\u53ef\u4ee5\u63a1\u7528\u4ee5\u4e0b\u65b9\u6cd5\u6aa2\u67e5\u54ea\u4e9b\u7bc0\u9ede\u4f7f\u7528\u57fa\u65bc Docker \u7684\u7bc0\u9ede\u6620\u50cf\uff1a\n- \u4f7f\u7528\u8173\u672c\u904d\u6b77 Google Cloud \u9805\u76ee\u5167\u6240\u6709 GKE \u96c6\u7fa3\u4e2d\u7684\u6240\u6709\u7bc0\u9ede\u3002\n- \u4f7f\u7528 Google Cloud CLI\u3001`kubectl`\u6216 Google Cloud \u63a7\u5236\u6aaf\u4f86\u8b58\u5225\u7bc0\u9ede\u6620\u50cf\u3002\n- \u4f7f\u7528 [\u68c4\u7528\u63d0\u793a\u548c\u5efa\u8b70](https://cloud.google.com/kubernetes-engine/docs/deprecations/viewing-deprecation-insights-and-recommendations?hl=zh-cn) \u4f86\u8b58\u5225 Google Cloud \u9805\u76ee\u4e2d\u7279\u5b9a\u53ef\u7528\u5340\u6216\u5340\u57df\u7684\u96c6\u7fa3\u548c\u7bc0\u9ede\u3002\n\u6211\u5011\u5efa\u8b70\u60a8\u4f7f\u7528\u8173\u672c\u4f86\u5feb\u901f\u8b58\u5225\u9700\u8981\u9077\u79fb\u7684\u6240\u6709\u7bc0\u9ede\u3002\n### \u4f7f\u7528\u8173\u672c\u8b58\u5225 Docker \u7bc0\u9ede\n\u4ee5\u4e0b\u8173\u672c\u53ef\u4ee5\u904d\u6b77\u53ef\u7528\u9805\u76ee\u5167\u6bcf\u500b\u96c6\u7fa3\u4e2d\u7684\u6bcf\u500b\u7bc0\u9ede\uff0c\u4f75\u7232\u60a8\u63d0\u4f9b\u5207\u5be6\u53ef\u884c\u7684\u5efa\u8b70\uff0c\u4f8b\u5982\uff1a\n- \u662f\u5426\u7232 Docker \u6620\u50cf\u914d\u7f6e [\u7bc0\u9ede\u81ea\u52d5\u9810\u914d](https://cloud.google.com/kubernetes-engine/docs/how-to/node-auto-provisioning?hl=zh-cn) \u529f\u80fd\n- \u5efa\u8b70\u9077\u79fb\u7684 [containerd \u7bc0\u9ede\u6620\u50cf](https://cloud.google.com/kubernetes-engine/docs/concepts/node-images?hl=zh-cn) \u7b49\u6548\u9805\n- \u5efa\u8b70\u9077\u79fb\u7684\u7bc0\u9ede\u6620\u50cf\u7248\u672c\n- \u5efa\u8b70\u904b\u884c\u4ee5\u9077\u79fb\u5df2\u8b58\u5225\u7684\u7bc0\u9ede\u548c\u8a2d\u7f6e\u7684\u547d\u4ee4\n\u8a72\u8173\u672c\u6703\u5ffd\u7565 GKE Autopilot \u96c6\u7fa3\uff0c\u9019\u4e9b\u96c6\u7fa3\u9ed8\u8a8d\u4f7f\u7528\u5177\u6709 containerd \u7bc0\u9ede\u6620\u50cf\u7684 Container-Optimized OS\u3002\n\u904b\u884c\u4ee5\u4e0b\u8173\u672c\uff1a\n[  migrating-to-containerd/find-nodepools-to-migrate.sh ](https://github.com/GoogleCloudPlatform/k8s-node-tools/blob/HEAD/migrating-to-containerd/find-nodepools-to-migrate.sh) [\u5728 GitHub \u4e0a\u67e5\u770b](https://github.com/GoogleCloudPlatform/k8s-node-tools/blob/HEAD/migrating-to-containerd/find-nodepools-to-migrate.sh)\n```\nfor project in $(gcloud projects list --format=\"value(projectId)\")do\u00a0 echo \"ProjectId: $project\"\u00a0 for clusters in $( \\\u00a0 \u00a0 gcloud container clusters list \\\u00a0 \u00a0 \u00a0 --project $project \\\u00a0 \u00a0 \u00a0 --format=\"csv[no-heading](name,location,autopilot.enabled,currentMasterVersion,autoscaling.enableNodeAutoprovisioning,autoscaling.autoprovisioningNodePoolDefaults.imageType)\")\u00a0 do\u00a0 \u00a0 IFS=',' read -r -a clustersArray <<< \"$clusters\"\u00a0 \u00a0 cluster_name=\"${clustersArray[0]}\"\u00a0 \u00a0 cluster_zone=\"${clustersArray[1]}\"\u00a0 \u00a0 cluster_isAutopilot=\"${clustersArray[2]}\"\u00a0 \u00a0 cluster_version=\"${clustersArray[3]}\"\u00a0 \u00a0 cluster_minorVersion=${cluster_version:0:4}\u00a0 \u00a0 cluster_autoprovisioning=\"${clustersArray[4]}\"\u00a0 \u00a0 cluster_autoprovisioningImageType=\"${clustersArray[5]}\"\u00a0 \u00a0 if [ \"$cluster_isAutopilot\" = \"True\" ]; then\u00a0 \u00a0 \u00a0 echo \" \u00a0Cluster: $cluster_name (autopilot) (zone: $cluster_zone)\"\u00a0 \u00a0 \u00a0 echo \" \u00a0 \u00a0Autopilot clusters are running Containerd.\"\u00a0 \u00a0 else\u00a0 \u00a0 \u00a0 echo \" \u00a0Cluster: $cluster_name (zone: $cluster_zone)\"\u00a0 \u00a0 \u00a0 if [ \"$cluster_autoprovisioning\" = \"True\" ]; then\u00a0 \u00a0 \u00a0 \u00a0 if [ \"$cluster_minorVersion\" \u00a0\\< \"1.20\" ]; then\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 echo \" \u00a0 \u00a0Node autoprovisioning is enabled, and new node pools will have image type 'COS'.\"\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 echo \" \u00a0 \u00a0This settings is not configurable on the current version of a cluster.\"\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 echo \" \u00a0 \u00a0Please upgrade you cluster and configure the default node autoprovisioning image type.\"\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 echo \" \u00a0 \u00a0\"\u00a0 \u00a0 \u00a0 \u00a0 else\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 if [ \"$cluster_autoprovisioningImageType\" = \"COS\" ]; then\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 echo \" \u00a0 \u00a0Node autoprovisioning is configured to create new node pools of type 'COS'.\"\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 echo \" \u00a0 \u00a0Run the following command to update:\"\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 echo \" \u00a0 \u00a0gcloud container clusters update '$cluster_name' --project '$project' --zone '$cluster_zone' --enable-autoprovisioning --autoprovisioning-image-type='COS_CONTAINERD'\"\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 echo \" \u00a0 \u00a0\"\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 fi\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 if [ \"$cluster_autoprovisioningImageType\" = \"UBUNTU\" ]; then\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 echo \" \u00a0 \u00a0Node autoprovisioning is configured to create new node pools of type 'UBUNTU'.\"\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 echo \" \u00a0 \u00a0Run the following command to update:\"\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 echo \" \u00a0 \u00a0gcloud container clusters update '$cluster_name' --project '$project' --zone '$cluster_zone' --enable-autoprovisioning --autoprovisioning-image-type='UBUNTU_CONTAINERD'\"\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 echo \" \u00a0 \u00a0\"\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 fi\u00a0 \u00a0 \u00a0 \u00a0 fi\u00a0 \u00a0 \u00a0 fi\u00a0 \u00a0 \u00a0 for nodepools in $( \\\u00a0 \u00a0 \u00a0 \u00a0 gcloud container node-pools list \\\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 --project $project \\\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 --cluster $cluster_name \\\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 --zone $cluster_zone \\\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 --format=\"csv[no-heading](name,version,config.imageType)\")\u00a0 \u00a0 \u00a0 do\u00a0 \u00a0 \u00a0 \u00a0 IFS=',' read -r -a nodepoolsArray <<< \"$nodepools\"\u00a0 \u00a0 \u00a0 \u00a0 nodepool_name=\"${nodepoolsArray[0]}\"\u00a0 \u00a0 \u00a0 \u00a0 nodepool_version=\"${nodepoolsArray[1]}\"\u00a0 \u00a0 \u00a0 \u00a0 nodepool_imageType=\"${nodepoolsArray[2]}\"\u00a0 \u00a0 \u00a0 \u00a0 nodepool_minorVersion=${nodepool_version:0:4}\u00a0 \u00a0 \u00a0 \u00a0 echo \" \u00a0 \u00a0Nodepool: $nodepool_name, version: $nodepool_version ($nodepool_minorVersion), image: $nodepool_imageType\"\u00a0 \u00a0 \u00a0 \u00a0 minorVersionWithRev=\"${nodepool_version/-gke./.}\"\u00a0 \u00a0 \u00a0 \u00a0 linuxGkeMinVersion=\"1.14\"\u00a0 \u00a0 \u00a0 \u00a0 windowsGkeMinVersion=\"1.21.1.2200\"\u00a0 \u00a0 \u00a0 \u00a0 suggestedImageType=\"COS_CONTAINERD\"\u00a0 \u00a0 \u00a0 \u00a0 if [ \"$nodepool_imageType\" = \"UBUNTU\" ]; then\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 suggestedImageType=\"UBUNTU_CONTAINERD\"\u00a0 \u00a0 \u00a0 \u00a0 elif [ \"$nodepool_imageType\" = \"WINDOWS_LTSC\" ]; then\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 suggestedImageType=\"WINDOWS_LTSC_CONTAINERD\"\u00a0 \u00a0 \u00a0 \u00a0 elif [ \"$nodepool_imageType\" = \"WINDOWS_SAC\" ]; then\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 suggestedImageType=\"WINDOWS_SAC_CONTAINERD\"\u00a0 \u00a0 \u00a0 \u00a0 fi\u00a0 \u00a0 \u00a0 \u00a0 tab=$'\\n \u00a0 \u00a0 \u00a0';\u00a0 \u00a0 \u00a0 \u00a0 nodepool_message=\"$tab Please update the nodepool to use Containerd.\"\u00a0 \u00a0 \u00a0 \u00a0 nodepool_message+=\"$tab Make sure to consult with the list of known issues https://cloud.google.com/kubernetes-engine/docs/concepts/using-containerd#known_issues.\"\u00a0 \u00a0 \u00a0 \u00a0 nodepool_message+=\"$tab Run the following command to upgrade:\"\u00a0 \u00a0 \u00a0 \u00a0 nodepool_message+=\"$tab \"\u00a0 \u00a0 \u00a0 \u00a0 nodepool_message+=\"$tab gcloud container clusters upgrade '$cluster_name' --project '$project' --zone '$cluster_zone' --image-type '$suggestedImageType' --node-pool '$nodepool_name'\"\u00a0 \u00a0 \u00a0 \u00a0 nodepool_message+=\"$tab \"\u00a0 \u00a0 \u00a0 \u00a0 # see https://cloud.google.com/kubernetes-engine/docs/concepts/node-images\u00a0 \u00a0 \u00a0 \u00a0 if [ \"$nodepool_imageType\" = \"COS_CONTAINERD\" ] || [ \"$nodepool_imageType\" = \"UBUNTU_CONTAINERD\" ] ||\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0[ \"$nodepool_imageType\" = \"WINDOWS_LTSC_CONTAINERD\" ] || [ \"$nodepool_imageType\" = \"WINDOWS_SAC_CONTAINERD\" ]; then\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 nodepool_message=\"$tab Nodepool is using Containerd already\"\u00a0 \u00a0 \u00a0 \u00a0 elif ( [ \"$nodepool_imageType\" = \"WINDOWS_LTSC\" ] || [ \"$nodepool_imageType\" = \"WINDOWS_SAC\" ] ) &&\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0[ \"$(printf '%s\\n' \"$windowsGkeMinVersion\" \"$minorVersionWithRev\" | sort -V | head -n1)\" != \"$windowsGkeMinVersion\" ]; then\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 nodepool_message=\"$tab Upgrade nodepool to the version that supports Containerd for Windows\"\u00a0 \u00a0 \u00a0 \u00a0 elif [ \"$(printf '%s\\n' \"$linuxGkeMinVersion\" \"$minorVersionWithRev\" | sort -V | head -n1)\" != \"$linuxGkeMinVersion\" ]; then\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 nodepool_message=\"$tab Upgrade nodepool to the version that supports Containerd\"\u00a0 \u00a0 \u00a0 \u00a0 fi\u00a0 \u00a0 \u00a0 \u00a0 echo \"$nodepool_message\"\u00a0 \u00a0 \u00a0 done\u00a0 \u00a0 fi # not autopilot\u00a0 donedone# Sample output:\n## ProjectId: \u00a0my-project-id# \u00a0Cluster: autopilot-cluster-1 (autopilot) (zone: us-central1)# \u00a0 \u00a0Autopilot clusters are running Containerd.# \u00a0Cluster: cluster-1 (zone: us-central1-c)# \u00a0 \u00a0Nodepool: default-pool, version: 1.18.12-gke.1210 (1.18), image: COS\n## \u00a0 \u00a0 \u00a0 Please update the nodepool to use Containerd.# \u00a0 \u00a0 \u00a0 Make sure to consult with the list of known issues https://cloud.google.com/kubernetes-engine/docs/concepts/using-containerd#known_issues.# \u00a0 \u00a0 \u00a0 Run the following command to upgrade:\n## \u00a0 \u00a0 \u00a0 gcloud container clusters upgrade 'cluster-1' --project 'my-project-id' --zone 'us-central1-c' --image-type 'COS_CONTAINERD' --node-pool 'default-pool'\n## \u00a0 \u00a0Nodepool: pool-1, version: 1.18.12-gke.1210 (1.18), image: COS\n## \u00a0 \u00a0 \u00a0 Please update the nodepool to use Containerd.# \u00a0 \u00a0 \u00a0 Make sure to consult with the list of known issues https://cloud.google.com/kubernetes-engine/docs/concepts/using-containerd#known_issues.# \u00a0 \u00a0 \u00a0 Run the following command to upgrade:\n## \u00a0 \u00a0 \u00a0 gcloud container clusters upgrade 'cluster-1' --project 'my-project-id' --zone 'us-central1-c' --image-type 'COS_CONTAINERD' --node-pool 'pool-1'\n## \u00a0 \u00a0Nodepool: winpool, version: 1.18.12-gke.1210 (1.18), image: WINDOWS_SAC\n## \u00a0 \u00a0 \u00a0 Upgrade nodepool to the version that supports Containerd for Windows\n## \u00a0Cluster: another-test-cluster (zone: us-central1-c)# \u00a0 \u00a0Nodepool: default-pool, version: 1.20.4-gke.400 (1.20), image: COS_CONTAINERD\n## \u00a0 \u00a0 \u00a0Nodepool is using Containerd already#\n```\n### \u4f7f\u7528 Google Cloud \u8b58\u5225\u7bc0\u9ede\u6620\u50cf\n\u53ef\u4ee5\u4f7f\u7528 Google Cloud CLI\u3001 `kubectl` \u6216 Google Cloud Console \u6aa2\u67e5\u73fe\u6709\u7bc0\u9ede\u7684\u7bc0\u9ede\u6620\u50cf\u3002\n\u904b\u884c\u4ee5\u4e0b\u547d\u4ee4\uff1a\n```\ngcloud container node-pools list \\\u00a0 \u00a0 --cluster=CLUSTER_NAME \\\u00a0 \u00a0 --format=\"table(name,version,config.imageType)\"\n```\n\u5c07 `` \u66ff\u63db\u7232\u60a8\u7684\u96c6\u7fa3\u540d\u7a31\u3002\n\u8f38\u51fa\u5167\u5bb9\u985e\u4f3c\u5982\u4e0b\uff1a\n```\nNAME   NODE_VERSION IMAGE_TYPE\ndefault-pool 1.19.6-gke.600 UBUNTU\n```- \u8f49\u5230 Google Cloud \u63a7\u5236\u6aaf\u4e2d\u7684 **Google Kubernetes Engine** \u9801\u9762\u3002 [\u8f49\u5230 Google Kubernetes Engine](https://console.cloud.google.com/kubernetes/list?hl=zh-cn) \n- \u5728\u96c6\u7fa3\u5217\u8868\u4e2d\uff0c\u9ede\u64ca\u60a8\u8981\u9a57\u8b49\u7684\u96c6\u7fa3\u7684\u540d\u7a31\u3002\n- \u9078\u64c7 **\u7bc0\u9ede** \u6a19\u7c64\u9801\u3002\n- \u5728 **\u7bc0\u9ede\u6c60** \u90e8\u5206\u4e2d\uff0c\u6aa2\u67e5 **\u6620\u50cf\u985e\u578b** \u5217\u4e2d\u7684\u503c\u3002\n\u904b\u884c\u4ee5\u4e0b\u547d\u4ee4\uff1a\n```\nkubectl get nodes -o wide\n```\n\u8f38\u51fa\u5167\u5bb9\u985e\u4f3c\u5982\u4e0b\uff1a\n```\n# For Docker runtime\nNAME   STATUS VERSION    OS-IMAGE        CONTAINER-RUNTIME\ngke-node-1 Ready v1.16.15-gke.6000 Container-Optimized OS from Google docker://19.3.1\ngke-node-2 Ready v1.16.15-gke.6000 Container-Optimized OS from Google docker://19.3.1\ngke-node-3 Ready v1.16.15-gke.6000 Container-Optimized OS from Google docker://19.3.1\n```\n`CONTAINER-RUNTIME` \u5217\u4e2d\u7684\u503c\u6703\u986f\u793a\u904b\u884c\u6642\u548c\u7248\u672c\u3002\n### \u4f7f\u7528\u68c4\u7528\u63d0\u793a\u548c\u5efa\u8b70\u78ba\u5b9a\u96c6\u7fa3\nGKE \u6703\u6aa2\u6e2c\u4e00\u4e9b\u5df2\u68c4\u7528\u7684\u529f\u80fd\u548c API\uff08\u5305\u62ec\u57fa\u65bc Docker \u7684\u7bc0\u9ede\u6620\u50cf\uff09\u7684\u4f7f\u7528\u60c5\u6cc1\u3002\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [GKE \u68c4\u7528](https://cloud.google.com/kubernetes-engine/docs/deprecations?hl=zh-cn) \u3002\n\u5728\u6aa2\u6e2c\u68c4\u7528\u4f7f\u7528\u60c5\u6cc1\u6642\uff0cGKE \u6703 [\u751f\u6210\u63d0\u793a\u548c\u5efa\u8b70](https://cloud.google.com/kubernetes-engine/docs/deprecations/viewing-deprecation-insights-and-recommendations?hl=zh-cn) \uff0c\u5b83\u5011\u6703\u4f7f\u7528\u63d0\u793a\u5b50\u985e\u578b `DEPRECATION_K8S_1_24_DOCKERSHIM` \u6a19\u8b58\u4f7f\u7528\u4e86\u57fa\u65bc Docker \u7684\u7bc0\u9ede\u6620\u50cf\u3002\n\u4e00\u500b\u63d0\u793a\u548c\u5efa\u8b70\u914d\u5c0d\u6a19\u8b58\u4e00\u500b\u5177\u6709\u4f7f\u7528\u57fa\u65bc Docker \u7684\u7bc0\u9ede\u6620\u50cf\u7684\u7bc0\u9ede\u7684\u96c6\u7fa3\u3002\u6bcf\u500b\u63d0\u793a\u548c\u5efa\u8b70\u90fd\u63d0\u4f9b\u4e86\u96c6\u7fa3\u4e2d\u4f7f\u7528\u57fa\u65bc Docker \u7684\u7bc0\u9ede\u6620\u50cf\u7684\u7279\u5b9a\u7bc0\u9ede\u6c60\u7684\u5217\u8868\uff0c\u4e26\u4e14\u9019\u4e9b\u7bc0\u9ede\u6c60\u5fc5\u9808\u9077\u79fb\u5230 containerd \u7bc0\u9ede\u6620\u50cf\u3002\n\u8981\u958b\u59cb\u4f7f\u7528\uff0c\u8acb\u6309\u7167\u76f8\u95dc\u8aaa\u660e [\u67e5\u770b\u68c4\u7528\u63d0\u793a\u548c\u5efa\u8b70](https://cloud.google.com/kubernetes-engine/docs/deprecations/viewing-deprecation-insights-and-recommendations?hl=zh-cn#view-deprecation-insights-recs) \u3002\u5c0d\u65bc gcloud CLI \u547d\u4ee4\uff0c\u8acb\u4f7f\u7528\u4ee5\u4e0b\u6a19\u8a8c\u4ee5\u50c5\u67e5\u770b\u6b64\u68c4\u7528\u7684\u63d0\u793a\uff1a\n```\n--filter=\"insightSubtype:DEPRECATION_K8S_1_24_DOCKERSHIM\"\n```\n\u78ba\u5b9a\u54ea\u500b\u96c6\u7fa3\u7684\u7bc0\u9ede\u6c60\u6b63\u5728\u4f7f\u7528\u57fa\u65bc Docker \u7684\u7bc0\u9ede\u6620\u50cf\u5f8c\uff0c\u8acb\u6309\u7167\u76f8\u95dc\u8aaa\u660e [\u5c07\u7bc0\u9ede\u6620\u50cf\u66f4\u6539\u7232 containerd \u7bc0\u9ede\u6620\u50cf](#change-image) \u3002\n## \u9a57\u8b49\u9077\u79fb\u7684\u5f71\u97ff\n\u5728\u5c07\u751f\u7522\u96c6\u7fa3\u548c\u7bc0\u9ede\u6c60\u9077\u79fb\u5230\u4f7f\u7528 containerd \u7684\u7bc0\u9ede\u6620\u50cf\u4e4b\u524d\uff0c\u6211\u5011\u5f37\u70c8\u5efa\u8b70\u60a8\u5728\u9810\u6f14\u74b0\u5883\u4e2d\u6e2c\u8a66\u9077\u79fb\u7684\u5f71\u97ff\uff0c\u4ee5\u6700\u5927\u9650\u5ea6\u5730\u964d\u4f4e\u554f\u984c\u6240\u5e36\u4f86\u7684\u98a8\u96aa\u3002\n\u6211\u5011\u5efa\u8b70\u60a8\u5728\u9077\u79fb\u7bc0\u9ede\u6642\u7368\u7acb\u5347\u7d1a\u7bc0\u9ede\uff0c\u4ee5\u4fbf\u5728\u4f7f\u7528\u65b0\u914d\u7f6e\u9a57\u8b49\u5de5\u4f5c\u8ca0\u8f09\u529f\u80fd\u6642\u53ef\u4ee5\u9694\u96e2\u8b8a\u91cf\u3002\u6b64\u5916\uff0c\u5982\u679c\u540c\u6642\u5c07\u7bc0\u9ede\u6c60\u5347\u7d1a\u5230 1.24 \u7248\uff0c\u5247\u7121\u6cd5\u56de\u6efe\u66f4\u6539\uff0c\u56e0\u7232 1.24 \u4e0d\u652f\u6301 Docker \u7bc0\u9ede\uff0c\u4e26\u4e14\u60a8\u4e5f\u7121\u6cd5\u964d\u7d1a\u6b21\u8981\u7248\u672c\u3002\n## \u5c07\u7bc0\u9ede\u6620\u50cf\u66f4\u6539\u7232 containerd \u6620\u50cf\n\u5982\u679c\u60a8\u4f7f\u7528 [\u8173\u672c](#identify-script) \u8b58\u5225 Docker \u7bc0\u9ede\uff0c\u5247\u53ef\u4ee5\u4f7f\u7528\u8a72\u8173\u672c\u8fd4\u56de\u7684\u5efa\u8b70\u904b\u884c\u7684\u547d\u4ee4\u5c07\u7bc0\u9ede\u81ea\u52d5\u9810\u914d\u8a2d\u7f6e\u548c\u7bc0\u9ede\u6620\u50cf\u66f4\u6539\u7232 containerd \u7b49\u6548\u9805\u3002\n\u60a8\u9084\u53ef\u4ee5\u901a\u904e\u4f7f\u7528 gcloud CLI \u6216 Google Cloud \u63a7\u5236\u6aaf\u66f4\u65b0\u7bc0\u9ede\u6c60\u4e26\u8a2d\u7f6e\u5176\u4ed6\u6620\u50cf\uff0c\u5c07\u7bc0\u9ede\u5f9e Docker \u6620\u50cf\u985e\u578b\u9077\u79fb\u5230 containerd \u6620\u50cf\u985e\u578b\u3002\nGKE \u4f7f\u7528 [\u9078\u5b9a\u7684\u7bc0\u9ede\u6c60\u5347\u7d1a\u7b56\u7565](https://cloud.google.com/kubernetes-engine/docs/concepts/node-pool-upgrade-strategies?hl=zh-cn) \u548c\u914d\u7f6e\u4f86\u9077\u79fb\u7bc0\u9ede\u7684\u6620\u50cf\u3002\u5c0d\u65bc\u6b64\u9077\u79fb\uff0c\u6211\u5011\u5efa\u8b70\u60a8\u4f7f\u7528 [\u85cd\u7da0\u5347\u7d1a\u7b56\u7565](https://cloud.google.com/kubernetes-engine/docs/concepts/node-pool-upgrade-strategies?hl=zh-cn#blue-green-upgrade-strategy) \uff0c\u56e0\u7232\u5982\u679c\u60a8\u7684\u5de5\u4f5c\u8ca0\u8f09\u5728\u5347\u7d1a\u671f\u9593\u9047\u5230\u65b0\u7bc0\u9ede\u6620\u50cf\u7684\u554f\u984c\uff0c\u60a8\u53ef\u4ee5 [\u56de\u6efe](https://cloud.google.com/kubernetes-engine/docs/concepts/node-pool-upgrade-strategies?hl=zh-cn#rollback-a-blue-green-upgrade) \u5230\u5177\u6709\u539f\u59cb\u7bc0\u9ede\u6620\u50cf\u914d\u7f6e\u7684\u5148\u524d\u74b0\u5883\u3002\n\u904b\u884c\u4ee5\u4e0b\u547d\u4ee4\uff1a\n```\ngcloud container clusters upgrade CLUSTER_NAME \\\u00a0 \u00a0 --image-type=NODE_IMAGE \\\u00a0 \u00a0 --node-pool=POOL_NAME \\\u00a0 \u00a0 --cluster-version=NODE_VERSION\n```\n\u66ff\u63db\u4ee5\u4e0b\u5167\u5bb9\uff1a- ``\uff1a\u60a8\u60f3\u8981\u7bc0\u9ede\u4f7f\u7528\u7684\u7bc0\u9ede\u6620\u50cf\u3002\n- ``\uff1a\u8981\u9077\u79fb\u7684\u7bc0\u9ede\u6c60\u7684\u540d\u7a31\u3002\n- ``\uff1a\u7bc0\u9ede\u6c60\u7684\u73fe\u6709\u7248\u672c\u3002\u6211\u5011\u5efa\u8b70\u8a2d\u7f6e\u6b64\u6a19\u8a8c\uff0c\u56e0\u7232\u4e0d\u8a2d\u7f6e\u6b64\u6a19\u8a8c\u6642 GKE \u6703\u5617\u8a66\u5c07\u7bc0\u9ede\u6c60\u7684\u7248\u672c\u5347\u7d1a\u5230\u63a7\u5236\u5e73\u9762\u7248\u672c\uff0c\u4e26\u5728\u540c\u4e00\u64cd\u4f5c\u4e2d\u66f4\u65b0\u7bc0\u9ede\u6620\u50cf\u3002\u5982\u679c\u63a7\u5236\u5e73\u9762\u904b\u884c 1.24\uff0c\u5247\u8a72\u547d\u4ee4\u6703\u5931\u6557\u3002\u5982\u679c\u63a7\u5236\u5e73\u9762\u6b63\u5728\u904b\u884c 1.23\uff0c\u5247\u8a72\u547d\u4ee4\u6703\u6210\u529f\uff0c\u9019\u6a23\u6703\u963b\u6b62\u60a8\u55ae\u7368\u6e2c\u8a66\u9019\u5169\u7a2e\u66f4\u6539\uff08\u7248\u672c\u5347\u7d1a\u548c\u6620\u50cf\u66f4\u65b0\uff09\u3002\n\u8f38\u51fa\u985e\u4f3c\u65bc\u4ee5\u4e0b\u5167\u5bb9\uff1a\n```\nNAME   NODE_VERSION IMAGE_TYPE\ndefault-pool 1.23.6-gke.600 UBUNTU_CONTAINERD\n```\n **\u6ce8\u610f** \uff1a\u66f4\u65b0\u7bc0\u9ede\u6620\u50cf\u5f8c\uff0c\u5982\u679c\u60a8\u767c\u73fe\u554f\u984c\u4e26\u9700\u8981\u9084\u539f\u5230 Docker \u6620\u50cf\uff0c\u8acb\u904b\u884c\u76f8\u540c\u7684\u547d\u4ee4\u4e26\u5c07 `` \u66ff\u63db\u7232\u4e4b\u524d\u7684 Docker \u6620\u50cf\u3002- \u8f49\u5230 Google Cloud \u63a7\u5236\u6aaf\u4e2d\u7684 **Google Kubernetes Engine** \u9801\u9762\u3002 [\u8f49\u5230 Google Kubernetes Engine](https://console.cloud.google.com/kubernetes/list?hl=zh-cn) \n- \u5728\u96c6\u7fa3\u5217\u8868\u4e2d\uff0c\u9ede\u64ca\u60a8\u8981\u9a57\u8b49\u7684\u96c6\u7fa3\u7684\u540d\u7a31\u3002\n- \u9ede\u64ca **\u7bc0\u9ede** \u6a19\u7c64\u9801\u3002\n- \u5728 **\u7bc0\u9ede\u6c60** \u90e8\u5206\u4e2d\uff0c\u9ede\u64ca\u8981\u4fee\u6539\u7684\u7bc0\u9ede\u6c60\u7684\u540d\u7a31\u3002\n- \u5728 **\u7bc0\u9ede\u6c60\u8a73\u60c5** \u9801\u9762\u4e2d\uff0c\u9ede\u64ca edit **\u4fee\u6539** \u3002\n- \u5728 **\u7bc0\u9ede** \u90e8\u5206\u4e2d\u7684 **\u6620\u50cf\u985e\u578b** \u4e0b\uff0c\u9ede\u64ca **\u66f4\u6539** \u3002\n- \u9078\u64c7\u5176\u4e2d\u4e00\u7a2e containerd \u6620\u50cf\u985e\u578b\u3002\n- \u9ede\u64ca **\u66f4\u6539** \u3002\n **\u6ce8\u610f** \uff1a\u66f4\u65b0\u7bc0\u9ede\u6620\u50cf\u5f8c\uff0c\u5982\u679c\u60a8\u767c\u73fe\u554f\u984c\u4e26\u9700\u8981\u9084\u539f\u5230 Docker \u6620\u50cf\uff0c\u8acb\u57f7\u884c\u4e0a\u8ff0\u6b65\u9a5f\u4e26\u9078\u64c7\u4e4b\u524d\u7684 Docker \u6620\u50cf\u3002\n### \u56de\u6efe\u5230 Docker \u7bc0\u9ede\u6620\u50cf\n\u5982\u679c\u60a8\u7684\u7bc0\u9ede\u5df2\u81ea\u52d5\u6216\u624b\u52d5\u9077\u79fb\u5230 containerd \u7bc0\u9ede\uff0c\u4e26\u4e14\u60a8\u767c\u73fe\u5de5\u4f5c\u8ca0\u8f09\u5b58\u5728\u554f\u984c\uff0c\u8acb\u57f7\u884c\u4ee5\u4e0b\u6b65\u9a5f\u4ee5\u9084\u539f\u5230 Docker \u7bc0\u9ede\u6620\u50cf\uff1a\n- \u6839\u64da\u64cd\u4f5c\u7684\u72c0\u614b\u9078\u64c7\u4ee5\u4e0b\u6b65\u9a5f\uff1a- \u5982\u679c\u64cd\u4f5c\u4ecd\u5728\u9032\u884c\u4e2d\uff0c\u60a8\u53ef\u4ee5 [\u53d6\u6d88](https://cloud.google.com/kubernetes-engine/docs/how-to/upgrading-a-cluster?hl=zh-cn#cancel) \u548c [\u56de\u6efe](https://cloud.google.com/kubernetes-engine/docs/how-to/upgrading-a-cluster?hl=zh-cn#rollback) \u3002\n- \u5982\u679c\u64cd\u4f5c\u5df2\u5b8c\u6210\uff0c\u8acb\u53c3\u95b1 [\u4e0a\u4e00\u90e8\u5206](#change-image) \u7684\u6b65\u9a5f\uff0c\u4e26\u9078\u64c7 [\u7b49\u6548\u7684 Docker \u6620\u50cf](https://cloud.google.com/kubernetes-engine/docs/deprecations/docker-containerd?hl=zh-cn#docker_and_containerd_node_images) \u3002\n- [\u914d\u7f6e\u7dad\u8b77\u6392\u9664\u9805](https://cloud.google.com/kubernetes-engine/docs/how-to/maintenance-windows-and-exclusions?hl=zh-cn#configuring_a_maintenance_exclusion) \u4ee5\u66ab\u6642\u963b\u6b62 GKE \u91cd\u8a66\u9077\u79fb\u3002\n- \u8abf\u67e5\u554f\u984c\u7684\u6839\u672c\u539f\u56e0\uff0c\u4ee5\u4fbf\u53ef\u4ee5\u5f9e Docker \u9032\u884c\u9077\u79fb\uff0c\u4e26\u78ba\u4fdd\u60a8\u7684\u96c6\u7fa3\u904b\u884c\u7684\u662f\u53d7\u652f\u6301\u7684 GKE \u7248\u672c\u3002\n- \u518d\u6b21\u5617\u8a66 [\u5c07\u7bc0\u9ede\u6620\u50cf\u66f4\u6539\u7232 containerd \u6620\u50cf](#change-image) \u3002\u5982\u679c\u60a8 [\u79fb\u9664\u7dad\u8b77\u6392\u9664\u9805](https://cloud.google.com/kubernetes-engine/docs/how-to/maintenance-windows-and-exclusions?hl=zh-cn#remove-exclusions) \uff0cGKE \u5c07\u518d\u6b21\u89f8\u767c\u64cd\u4f5c\u3002\n### \u66f4\u65b0\u57fa\u790e\u67b6\u69cb\u5373\u4ee3\u78bc (IaC) \u5de5\u5177\u914d\u7f6e\n\u5982\u679c\u60a8\u4f7f\u7528 Terraform\u3001Ansible \u6216 Pulumi \u7b49 IaC \u5de5\u5177\u4f86\u7ba1\u7406 GKE \u96c6\u7fa3\uff0c\u8acb\u52d9\u5fc5\u66f4\u65b0\u914d\u7f6e\u4f86\u4f7f\u7528 containerd \u7bc0\u9ede\u6620\u50cf\uff0c\u4ee5\u9632\u6b62\u9019\u4e9b\u5de5\u5177\u5c07\u65b0\u7684\u5be6\u969b\u72c0\u614b\u6062\u5fa9\u5230\u4e4b\u524d\u9700\u8981\u7684\u72c0\u614b\u3002\u4f8b\u5982\uff0cGKE Terraform \u63d0\u4f9b\u7a0b\u5e8f\u652f\u6301 [\u53ef\u914d\u7f6e\u7684\u6620\u50cf\u985e\u578b](https://registry.terraform.io/providers/hashicorp/google/latest/docs/resources/container_cluster#image_type) \u3002\n\u66f4\u65b0\u6240\u6709\u914d\u7f6e\uff0c\u4ee5\u907f\u514d\u9077\u79fb\u5230 containerd \u7bc0\u9ede\u6620\u50cf\u5f8c\u5de5\u5177\u5c07\u7bc0\u9ede\u6620\u50cf\u66f4\u65b0\u56de\u57fa\u65bc Docker \u7684\u7bc0\u9ede\u6620\u50cf\u3002\n## \u66f4\u6539\u7bc0\u9ede\u81ea\u52d5\u9810\u914d\u7684\u9ed8\u8a8d\u7bc0\u9ede\u6620\u50cf\n\u5982\u679c\u5728\u96c6\u7fa3\u4e2d\u4f7f\u7528 [\u7bc0\u9ede\u81ea\u52d5\u9810\u914d](https://cloud.google.com/kubernetes-engine/docs/how-to/node-auto-provisioning?hl=zh-cn) \u529f\u80fd\uff0c\u8acb\u5c07\u9ed8\u8a8d\u6620\u50cf\u985e\u578b\u66f4\u6539\u7232 containerd \u7bc0\u9ede\u6620\u50cf\u3002\u66f4\u6539\u9ed8\u8a8d\u6620\u50cf\u985e\u578b\u50c5\u9069\u7528\u65bc\u65b0\u7684\u81ea\u52d5\u9810\u914d\u7bc0\u9ede\u6c60\u3002\u5fc5\u9808\u624b\u52d5\u66f4\u6539\u73fe\u6709\u81ea\u52d5\u9810\u914d\u7bc0\u9ede\u6c60\u7684\u7bc0\u9ede\u6620\u50cf\u3002\n\u53ef\u4ee5\u4f7f\u7528 gcloud CLI \u6216\u914d\u7f6e\u6587\u4ef6\u66f4\u6539\u9ed8\u8a8d\u7bc0\u9ede\u81ea\u52d5\u9810\u914d\u6620\u50cf\u985e\u578b\u3002\n\u904b\u884c\u4ee5\u4e0b\u547d\u4ee4\uff1a\n```\ngcloud container clusters update CLUSTER_NAME \\\u00a0 \u00a0 --enable-autoprovisioning \\\u00a0 \u00a0 --autoprovisioning-image-type=IMAGE_TYPE\n```\n\u66ff\u63db\u4ee5\u4e0b\u5167\u5bb9\uff1a- ``\uff1a\u8981\u66f4\u65b0\u7684\u96c6\u7fa3\u7684\u540d\u7a31\u3002\n- `` \uff1a\u7bc0\u9ede\u6620\u50cf\u985e\u578b\uff0c\u53ef\u4ee5\u662f\u4ee5\u4e0b\u503c\u4e4b\u4e00\uff1a- `cos_containerd`\n- `ubuntu_containerd` **\u6ce8\u610f** \uff1a\u5c0d\u65bc `ubuntu_containerd` \uff0c\u8acb\u5728\u8a72\u547d\u4ee4\u4e2d\u6307\u5b9a `--autoprovisioning-scopes=https://www.googleapis.com/auth/devstorage.read_only` \u3002\n\u53ef\u4ee5\u4f7f\u7528 YAML \u914d\u7f6e\u6587\u4ef6\u4f86\u66f4\u6539\u7bc0\u9ede\u81ea\u52d5\u9810\u914d\u6240\u7528\u7684\u9ed8\u8a8d\u7bc0\u9ede\u6620\u50cf\u985e\u578b\u3002\u4f7f\u7528\u6587\u4ef6\u6642\uff0c\u60a8\u9084\u5fc5\u9808\u6307\u5b9a CPU \u548c\u5167\u5b58\u8cc7\u6e90\u7684\u6700\u5927\u503c\u3002- \u4fdd\u5b58\u4ee5\u4e0b YAML \u6587\u4ef6\uff1a```\nresourceLimits:\u00a0 - resourceType: 'cpu'\u00a0 \u00a0 \u00a0 minimum: 4\u00a0 \u00a0 \u00a0 maximum: 10\u00a0 - resourceType: 'memory'\u00a0 \u00a0 \u00a0 maximum: 64autoprovisioningNodePoolDefaults:\u00a0 imageType: 'IMAGE_TYPE'\n```\u5c07 `` \u66ff\u63db\u7232 containerd \u6620\u50cf\u985e\u578b\u3002 **\u6ce8\u610f** \uff1a\u5c0d\u65bc `ubuntu_containerd` \uff0c\u8acb\u5c07 `scopes: https://www.googleapis.com/auth/devstorage.read_only` \u6dfb\u52a0\u5230\u914d\u7f6e\u6587\u4ef6\u4e2d\u3002\n- \u61c9\u7528\u914d\u7f6e\uff1a```\ngcloud container clusters update CLUSTER_NAME \\\u00a0 \u00a0 --enable-autoprovisioning \\\u00a0 \u00a0 --autoprovisioning-config-file=FILE_NAME\n```\u5c07 `` \u66ff\u63db\u7232\u914d\u7f6e\u6587\u4ef6\u7684\u8def\u5f91\u3002## \u554f\u984c\u6392\u67e5\n\u5982\u9700\u9032\u884c\u554f\u984c\u6392\u67e5\u4e26\u67e5\u770b\u5b58\u5728\u89e3\u6c7a\u65b9\u6cd5\u7684\u5df2\u77e5\u554f\u984c\uff0c\u8acb\u53c3\u95b1 [\u6392\u67e5\u5bb9\u5668\u904b\u884c\u6642\u7684\u554f\u984c](https://cloud.google.com/kubernetes-engine/docs/troubleshooting/container-runtime?hl=zh-cn) \u3002\n## \u5f8c\u7e8c\u6b65\u9a5f\n- [\u8a73\u7d30\u77ad\u89e3\u7bc0\u9ede\u81ea\u52d5\u9810\u914d](https://cloud.google.com/kubernetes-engine/docs/how-to/node-auto-provisioning?hl=zh-cn) \u3002\n- [\u8a73\u7d30\u77ad\u89e3 containerd \u7bc0\u9ede\u6620\u50cf](https://cloud.google.com/kubernetes-engine/docs/concepts/using-containerd?hl=zh-cn) \u3002", "guide": "Google Kubernetes Engine (GKE)"}