{"title": "Google Kubernetes Engine (GKE) - \u5229\u7528 Hyperdisk \u64f4\u7e2e\u5b58\u5132\u6027\u80fd", "url": "https://cloud.google.com/kubernetes-engine/docs/how-to/persistent-volumes/hyperdisk?hl=zh-cn", "abstract": "# Google Kubernetes Engine (GKE) - \u5229\u7528 Hyperdisk \u64f4\u7e2e\u5b58\u5132\u6027\u80fd\nCompute Engine Persistent Disk CSI \u9a45\u52d5\u7a0b\u5e8f\u662f\u60a8\u8a2a\u554f [\u4f7f\u7528 GKE \u96c6\u7fa3\u7684 Hyperdisk \u5b58\u5132](https://cloud.google.com/kubernetes-engine/docs/concepts/hyperdisk?hl=zh-cn) \u7684\u4e3b\u8981\u65b9\u5f0f\u3002\n**\u6ce8\u610f** \uff1aHyperdisk \u652f\u6301\u53d6\u6c7a\u65bc\u7bc0\u9ede\u7684\u6a5f\u5668\u985e\u578b\u3002\u5982\u9700\u77ad\u89e3\u6700\u65b0\u4fe1\u606f\uff0c\u8acb\u53c3\u95b1 Compute Engine \u6587\u6a94\u4e2d\u7684 [\u6a5f\u5668\u985e\u578b\u652f\u6301](https://cloud.google.com/compute/docs/disks/hyperdisks?hl=zh-cn#machine-type-support) \u3002\n", "content": "## \u6e96\u5099\u5de5\u4f5c\n\u5728\u958b\u59cb\u4e4b\u524d\uff0c\u8acb\u78ba\u4fdd\u60a8\u5df2\u57f7\u884c\u4ee5\u4e0b\u4efb\u52d9\uff1a\n- \u5553\u7528 Google Kubernetes Engine API\u3002\n- [  \u5553\u7528 Google Kubernetes Engine API ](https://console.cloud.google.com/flows/enableapi?apiid=container.googleapis.com&hl=zh-cn) \n- \u5982\u679c\u60a8\u8981\u4f7f\u7528 Google Cloud CLI \u57f7\u884c\u6b64\u4efb\u52d9\uff0c\u8acb [\u5b89\u88dd](https://cloud.google.com/sdk/docs/install?hl=zh-cn) \u4e26 [\u521d\u59cb\u5316](https://cloud.google.com/sdk/docs/initializing?hl=zh-cn) gcloud CLI\u3002 \u5982\u679c\u60a8\u4e4b\u524d\u5b89\u88dd\u4e86 gcloud CLI\uff0c\u8acb\u904b\u884c`gcloud components update`\u4ee5\u7372\u53d6\u6700\u65b0\u7248\u672c\u3002 **\u6ce8\u610f** \uff1a\u5c0d\u65bc\u73fe\u6709 gcloud CLI \u5b89\u88dd\uff0c\u8acb\u52d9\u5fc5\u8a2d\u7f6e`compute/region`\u548c`compute/zone` [\u5c6c\u6027](https://cloud.google.com/sdk/docs/properties?hl=zh-cn#setting_properties) \u3002\u901a\u904e\u8a2d\u7f6e\u9ed8\u8a8d\u4f4d\u7f6e\uff0c\u60a8\u53ef\u4ee5\u907f\u514d gcloud CLI \u4e2d\u51fa\u73fe\u4ee5\u4e0b\u932f\u8aa4\uff1a`One of [--zone, --region] must be supplied: Please specify location`\u3002\n- \u5c07\u60a8\u7684\u9ed8\u8a8d\u5340\u57df\u548c\u53ef\u7528\u5340\u8a2d\u7f6e\u7232\u67d0\u500b [\u652f\u6301\u7684\u503c](https://cloud.google.com/compute/docs/disks/hyperdisks?hl=zh-cn#hyperdisk_regions) \u3002\n### \u4f7f\u7528\u8981\u6c42\n\u5982\u9700\u5728 GKE \u4e2d\u4f7f\u7528 Hyperdisk \u5377\uff0c\u60a8\u7684\u96c6\u7fa3\u5fc5\u9808\u6eff\u8db3\u4ee5\u4e0b\u8981\u6c42\uff1a\n- \u4f7f\u7528\u904b\u884c GKE 1.26 \u7248\u6216\u66f4\u9ad8\u7248\u672c\u7684 Linux \u96c6\u7fa3\u3002\u5982\u679c\u60a8\u4f7f\u7528 [\u767c\u4f48\u6e20\u9053](https://cloud.google.com/kubernetes-engine/docs/concepts/release-channels?hl=zh-cn) \uff0c\u8acb\u78ba\u4fdd\u8a72\u6e20\u9053\u5177\u6709\u6b64\u9a45\u52d5\u7a0b\u5e8f\u6240\u9700\u7684\u6700\u4f4e GKE \u7248\u672c\u6216\u66f4\u9ad8\u7248\u672c\n- \u78ba\u4fdd\u5df2\u5553\u7528 [Compute Engine Persistent Disk CSI \u9a45\u52d5\u7a0b\u5e8f](https://cloud.google.com/kubernetes-engine/docs/how-to/persistent-volumes/gce-pd-csi-driver?hl=zh-cn) \u3002\u9ed8\u8a8d\u60c5\u6cc1\u4e0b\uff0c\u65b0\u7684 Autopilot \u548c Standard \u96c6\u7fa3\u6703\u5553\u7528 Compute Engine Persistent Disk \u9a45\u52d5\u7a0b\u5e8f\uff0c\u4e26\u4e14\u5728\u4f7f\u7528 Autopilot \u6642\u7121\u6cd5\u505c\u7528\u6216\u4fee\u6539\u3002\u5982\u679c\u60a8\u9700\u8981\u5728\u96c6\u7fa3\u4e2d\u624b\u52d5\u6dfb\u52a0\u6216\u79fb\u9664 Compute Engine Persistent Disk CSI \u9a45\u52d5\u7a0b\u5e8f\uff0c\u8acb\u53c3\u95b1 [\u5728\u73fe\u6709\u96c6\u7fa3\u4e0a\u5553\u7528 Compute Engine Persistent Disk CSI \u9a45\u52d5\u7a0b\u5e8f](https://cloud.google.com/kubernetes-engine/docs/how-to/persistent-volumes/gce-pd-csi-driver?hl=zh-cn#enabling_the_on_an_existing_cluster) \u3002## \u7232 GKE \u5275\u5efa Hyperdisk \u5377\n\u672c\u90e8\u5206\u4ecb\u7d39\u5982\u4f55\u5728 GKE \u4e2d\u5275\u5efa\u7531 Compute Engine CSI \u9a45\u52d5\u7a0b\u5e8f\u652f\u6301\u7684 Hyperdisk \u5377\u3002\n**\u6ce8\u610f\uff1a** \u7576\u60a8\u5275\u5efa\u8207 StorageClass \u95dc\u806f\u7684 PersistentVolumeClaim \u6642\uff0cGKE \u6703\u81ea\u52d5\u5275\u5efa\u5e95\u5c64 Google Cloud Hyperdisk \u5f8c\u5099\u5b58\u5132\u4e26\u5c07\u5b58\u5132\u639b\u63a5\u5230\u7bc0\u9ede\u3002\u60a8\u7121\u9700\u55ae\u7368\u5275\u5efa Google Cloud Hyperdisk \u5b58\u5132\u4e26\u5c07\u5176\u639b\u63a5\u5230\u7bc0\u9ede\u3002\n### \u5275\u5efa\u4e00\u500b StorageClass\nCompute Engine Persistent Disk CSI \u9a45\u52d5\u7a0b\u5e8f\u63d0\u4f9b\u4e86\u4ee5\u4e0b [Persistent Disk \u5b58\u5132 Type \u5b57\u6bb5](https://cloud.google.com/compute/docs/disks?hl=zh-cn#disk-types) \uff0c\u7528\u65bc\u652f\u6301 Hyperdisk\uff1a\n- `hyperdisk-balanced`\n- `hyperdisk-throughput`\n- `hyperdisk-extreme`\n\u5982\u9700\u5275\u5efa\u5177\u6709\u6240\u9700\u7684\u541e\u5410\u91cf\u6216 IOPS \u7d1a\u5225\u7684\u65b0 StorageClass\uff0c\u8acb\u5728\u9810\u914d\u5de5\u5177\u5b57\u6bb5\u4e2d\u4f7f\u7528 `pd.csi.storage.gke.io` \uff0c\u4e26\u6307\u5b9a\u5176\u4e2d\u4e00\u7a2e Hyperdisk \u5b58\u5132\u985e\u578b\u3002\n\u5275\u5efa StorageClass \u6642\uff0c\u8acb\u4f7f\u7528 `provisioned-throughput-on-create` \u53c3\u6578\u914d\u7f6e\u541e\u5410\u91cf\uff0c\u4e26\u4f7f\u7528\u5b9a\u7fa9 StorageClass \u7684 `provisioned-iops-on-create` \u914d\u7f6e IOPS\u3002\u5982\u9700\u7372\u5f97\u5141\u8a31\u7684\u541e\u5410\u91cf\u503c\u6307\u5357\uff0c\u8acb\u53c3\u95b1 [\u898f\u5283 Hyperdisk \u5377\u7684\u6027\u80fd\u7d1a\u5225](https://cloud.google.com/kubernetes-engine/docs/concepts/hyperdisk?hl=zh-cn#plan) \u3002\n\u4f7f\u7528\u201cMi\u201d\u9650\u5b9a\u7b26\u8868\u793a\u541e\u5410\u91cf\u503c\uff08\u4ee5 MiBps \u7232\u55ae\u4f4d\uff09\uff1b\u4f8b\u5982\uff0c\u5982\u679c\u60a8\u9700\u8981\u7684\u541e\u5410\u91cf\u7232 50 MiBps\uff0c\u8acb\u5728\u5275\u5efa StorageClass \u6642\u6307\u5b9a `\"50Mi\"` \u3002\nIOPS \u503c\u61c9\u4e0d\u5e36\u4efb\u4f55\u9650\u5b9a\u7b26\u8868\u793a\uff1b\u4f8b\u5982\uff0c\u5982\u679c\u60a8\u9700\u8981 7,000 IOPS\uff0c\u8acb\u5728\u5275\u5efa StorageClass \u6642\u6307\u5b9a `\"7000\"` \u3002- \u5c07\u4ee5\u4e0b\u6e05\u55ae\u4fdd\u5b58\u5728\u540d\u7232 `hdb-example-class.yaml` \u7684\u6587\u4ef6\u4e2d\uff1a```\napiVersion: storage.k8s.io/v1kind: StorageClass\u00a0 metadata:name: balanced-storageprovisioner: pd.csi.storage.gke.iovolumeBindingMode: WaitForFirstConsumerallowVolumeExpansion: trueparameters:\u00a0 type: hyperdisk-balanced\u00a0 provisioned-throughput-on-create: \"50Mi\"\u00a0 provisioned-iops-on-create: \"7000\"\n```\n- \u5275\u5efa StorageClass\uff1a```\nkubectl create -f hdb-example-class.yaml\n```\n\u5b9a\u7fa9 StorageClass \u6642\uff0c\u8acb\u4f7f\u7528 `provisioned-throughput-on-create` \u53c3\u6578\u9810\u914d\u541e\u5410\u91cf\u3002\u5982\u9700\u7372\u5f97\u5141\u8a31\u7684\u541e\u5410\u91cf\u503c\u6307\u5357\uff0c\u8acb\u53c3\u95b1 [\u898f\u5283 Hyperdisk \u5377\u7684\u6027\u80fd\u7d1a\u5225](https://cloud.google.com/kubernetes-engine/docs/concepts/hyperdisk?hl=zh-cn#plan) \u3002\u9019\u4e9b\u503c\u61c9\u4f7f\u7528\u201cMi\u201d\u9650\u5b9a\u7b26\u4ee5 MiBps \u7232\u55ae\u4f4d\u8868\u793a\uff1b\u4f8b\u5982\uff0c\u5982\u679c\u60a8\u9700\u8981\u7684\u541e\u5410\u91cf\u7232 50 MiBps\uff0c\u8acb\u5728\u5275\u5efa StorageClass \u6642\u6307\u5b9a `\"50Mi\"` \u3002- \u5c07\u4ee5\u4e0b\u6e05\u55ae\u4fdd\u5b58\u5728\u540d\u7232 `hdt-example-class.yaml` \u7684\u6587\u4ef6\u4e2d\uff1a```\napiVersion: storage.k8s.io/v1kind: StorageClassmetadata:\u00a0 name: throughput-storageprovisioner: pd.csi.storage.gke.iovolumeBindingMode: WaitForFirstConsumerallowVolumeExpansion: trueparameters:\u00a0 type: hyperdisk-throughput\u00a0 provisioned-throughput-on-create: \"50Mi\"\n```\n- \u5275\u5efa StorageClass\uff1a```\nkubectl create -f hdt-example-class.yaml\n```\n\u5b9a\u7fa9 StorageClass \u6642\uff0c\u8acb\u4f7f\u7528 `provisioned-iops-on-create` \u53c3\u6578\u9810\u914d IOPS\u3002\u6709\u95dc IOPS \u7684\u53ef\u5141\u8a31\u503c\u7684\u6307\u5357\uff0c\u8acb\u53c3\u95b1 [\u898f\u5283 Hyperdisk \u5377\u7684\u6027\u80fd\u7d1a\u5225](https://cloud.google.com/kubernetes-engine/docs/concepts/hyperdisk?hl=zh-cn#plan) \u3002\u8a72\u503c\u61c9\u4e0d\u5e36\u4efb\u4f55\u9650\u5b9a\u7b26\u8868\u793a\uff1b\u4f8b\u5982\uff0c\u5982\u679c\u60a8\u9700\u8981\u7684 IOPS \u7232 1,000 IOPS\uff0c\u8acb\u5728\u5275\u5efa StorageClass \u6642\u6307\u5b9a `\"1000\"` \u3002- \u5c07\u4ee5\u4e0b\u6e05\u55ae\u4fdd\u5b58\u5728\u540d\u7232 `hdx-example-class.yaml` \u7684\u6587\u4ef6\u4e2d\uff1a```\napiVersion: storage.k8s.io/v1kind: StorageClassmetadata:\u00a0 name: extreme-storageprovisioner: pd.csi.storage.gke.iovolumeBindingMode: WaitForFirstConsumerallowVolumeExpansion: trueparameters:\u00a0 type: hyperdisk-extreme\u00a0 provisioned-iops-on-create: \"1000\"\n```\n- \u5275\u5efa StorageClass\uff1a```\nkubectl create -f hdx-example-class.yaml\n```\n\u5982\u9700\u67e5\u627e\u96c6\u7fa3\u4e2d\u53ef\u7528\u7684 StorageClass \u7684\u540d\u7a31\uff0c\u8acb\u904b\u884c\u4ee5\u4e0b\u547d\u4ee4\uff1a\n```\nkubectl get sc\n```\n### \u5275\u5efa\u4e00\u500b PersistentVolumeClaim\n\u60a8\u53ef\u4ee5\u5275\u5efa\u4e00\u500b\u5f15\u7528 Compute Engine Persistent Disk CSI \u9a45\u52d5\u7a0b\u5e8f\u7684 StorageClass \u7684 PersistentVolumeClaim\u3002\n\u5728\u6b64\u793a\u4f8b\u4e2d\uff0c\u60a8\u5c07 Hyperdisk Balanced \u5377\u7684\u76ee\u6a19\u5b58\u5132\u5bb9\u91cf\u6307\u5b9a\u7232 10 GiB\u3002- \u5c07\u4ee5\u4e0b PersistentVolumeClaim \u6e05\u55ae\u4fdd\u5b58\u5230\u540d\u7232 `pvc-example.yaml` \u7684\u6587\u4ef6\u4e2d\uff1a```\nkind: PersistentVolumeClaimapiVersion: v1metadata:\u00a0 name: ubuntupvcspec:\u00a0 accessModes:\u00a0 - ReadWriteOnce\u00a0 storageClassName: balanced-storage\u00a0 resources:\u00a0 \u00a0 requests:\u00a0 \u00a0 \u00a0 storage: 10Gi\n```\n- \u61c9\u7528\u5f15\u7528\u60a8\u5728\u524d\u9762\u793a\u4f8b\u4e2d\u5275\u5efa\u7684 StorageClass \u7684 PersistentVolumeClaim\uff1a```\nkubectl apply -f pvc-example.yaml\n```\n\u5728\u6b64\u793a\u4f8b\u4e2d\uff0c\u60a8\u9700\u8981\u5c07 Hyperdisk Throughput \u5377\u7684\u76ee\u6a19\u5b58\u5132\u5bb9\u91cf\u6307\u5b9a\u7232 2\u00a0TiB\u3002- \u5c07\u4ee5\u4e0b PersistentVolumeClaim \u6e05\u55ae\u4fdd\u5b58\u5728\u540d\u7232 `pvc-example.yaml` \u7684\u6587\u4ef6\u4e2d\uff1a```\nkind: PersistentVolumeClaimapiVersion: v1metadata:\u00a0 name: ubuntupvcspec:\u00a0 accessModes:\u00a0 - ReadWriteOnce\u00a0 storageClassName: throughput-storage\u00a0 resources:\u00a0 \u00a0 requests:\u00a0 \u00a0 \u00a0 storage: 2Ti\n```\n- \u61c9\u7528\u5f15\u7528\u60a8\u5728\u524d\u9762\u793a\u4f8b\u4e2d\u5275\u5efa\u7684 StorageClass \u7684 PersistentVolumeClaim\uff1a```\nkubectl apply -f pvc-example.yaml\n```\n\u5728\u6b64\u793a\u4f8b\u4e2d\uff0c\u60a8\u5c07 Hyperdisk Extreme \u5377\u7684\u6700\u5c0f\u5b58\u5132\u5bb9\u91cf\u6307\u5b9a\u7232 64\u00a0GiB\u3002- \u5c07\u4ee5\u4e0b PersistentVolumeClaim \u6e05\u55ae\u4fdd\u5b58\u5728\u540d\u7232 `pvc-example.yaml` \u7684\u6587\u4ef6\u4e2d\uff1a```\nkind: PersistentVolumeClaimapiVersion: v1metadata:\u00a0 name: ubuntupvcspec:\u00a0 accessModes:\u00a0 - ReadWriteOnce\u00a0 storageClassName: extreme-storage\u00a0 resources:\u00a0 \u00a0 requests:\u00a0 \u00a0 \u00a0 storage: 64Gi\n```\n- \u61c9\u7528\u5f15\u7528\u60a8\u5728\u524d\u9762\u793a\u4f8b\u4e2d\u5275\u5efa\u7684 StorageClass \u7684 PersistentVolumeClaim\uff1a```\nkubectl apply -f pvc-example.yaml\n```\n### \u5275\u5efa Deployment \u4ee5\u4f7f\u7528 Hyperdisk \u5377\n\u5c07 Pod \u8207 PersistentVolume \u642d\u914d\u4f7f\u7528\u6642\uff0c\u6211\u5011\u5efa\u8b70\u60a8\u4f7f\u7528\u5de5\u4f5c\u8ca0\u8f09\u63a7\u5236\u5668\uff08\u4f8b\u5982 [Deployment](https://kubernetes.io/docs/concepts/workloads/controllers/deployment/) \u6216 [StatefulSet](https://kubernetes.io/docs/concepts/workloads/controllers/statefulset/) \uff09\u3002\n- \u4ee5\u4e0b\u793a\u4f8b\u5c07\u5275\u5efa\u4e00\u500b\u6e05\u55ae\uff0c\u8a72\u6e05\u55ae\u5c07\u914d\u7f6e Pod \u4ee5\u4f7f\u7528\u4e0a\u4e00\u90e8\u5206\u4e2d\u5275\u5efa\u7684 PersistentVolumeClaim \u90e8\u7f72 Nginx Web \u670d\u52d9\u5668\u3002\u5c07\u4ee5\u4e0b\u793a\u4f8b\u6e05\u55ae\u4fdd\u5b58\u7232 `hyperdisk-example-deployment.yaml` \uff1a```\napiVersion: apps/v1kind: Deploymentmetadata:\u00a0 name: web-server-deployment\u00a0 labels:\u00a0 \u00a0 app: nginxspec:\u00a0 replicas: 1\u00a0 selector:\u00a0 \u00a0 matchLabels:\u00a0 \u00a0 \u00a0 app: nginx\u00a0 template:\u00a0 \u00a0 metadata:\u00a0 \u00a0 \u00a0 labels:\u00a0 \u00a0 \u00a0 \u00a0 app: nginx\u00a0 \u00a0 spec:\u00a0 \u00a0 \u00a0 containers:\u00a0 \u00a0 \u00a0 - name: nginx\u00a0 \u00a0 \u00a0 \u00a0 image: nginx\u00a0 \u00a0 \u00a0 \u00a0 volumeMounts:\u00a0 \u00a0 \u00a0 \u00a0 - mountPath: /var/lib/www/html\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 name: mypvc\u00a0 \u00a0 \u00a0 volumes:\u00a0 \u00a0 \u00a0 - name: mypvc\u00a0 \u00a0 \u00a0 \u00a0 persistentVolumeClaim:\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 claimName: podpvc\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 readOnly: false\n```\n- \u5982\u9700\u6839\u64da `hyperdisk-example-deployment.yaml` \u6e05\u55ae\u6587\u4ef6\u5275\u5efa Deployment\uff0c\u8acb\u904b\u884c\u4ee5\u4e0b\u547d\u4ee4\uff1a```\nkubectl apply -f hyperdisk-example-deployment.yaml\n```\n- \u78ba\u8a8d\u5df2\u6210\u529f\u5275\u5efa Deployment\uff1a```\nkubectl get deployment\n```Hyperdisk \u5be6\u4f8b\u53ef\u80fd\u9700\u8981\u5e7e\u5206\u9418\u624d\u80fd\u5b8c\u6210\u9810\u914d\u3002 \u90e8\u7f72\u5b8c\u6210\u9810\u914d\u5f8c\uff0c\u6703\u5831\u544a `READY` \u72c0\u614b\u3002\n- \u60a8\u53ef\u4ee5\u904b\u884c\u4ee5\u4e0b\u547d\u4ee4\u4f86\u76e3\u63a7 PersistentVolumeClaim \u72c0\u614b\uff0c\u4ee5\u67e5\u770b\u9032\u5ea6\uff1a```\nkubectl get pvc\n```## \u901a\u904e\u5feb\u7167\u9810\u914d Hyperdisk \u5377\n\u5982\u9700\u901a\u904e\u73fe\u6709 Persistent Disk \u5feb\u7167\u5275\u5efa\u65b0\u7684 Hyperdisk \u5377\uff0c\u8acb\u4f7f\u7528 Google Cloud \u63a7\u5236\u6aaf\u3001Google Cloud CLI \u6216 [Compute Engine API](https://cloud.google.com/compute/docs/reference/rest/v1/disks?hl=zh-cn) \u3002\u5982\u9700\u77ad\u89e3\u5982\u4f55\u5275\u5efa Persistent Disk \u5feb\u7167\uff0c\u8acb\u53c3\u95b1 [\u5275\u5efa\u548c\u4f7f\u7528\u5377\u5feb\u7167](https://cloud.google.com/kubernetes-engine/docs/how-to/persistent-volumes/volume-snapshots?hl=zh-cn#creating_and_using_a_volume_snapshot) \u3002\n- \u8f49\u5230 Google Cloud \u63a7\u5236\u6aaf\u4e2d\u7684 **\u78c1\u76e4** \u9801\u9762\u3002 [\u6253\u958b\u201c\u78c1\u76e4\u201d](https://console.cloud.google.com/compute/disks?hl=zh-cn) \n- \u9ede\u64ca **\u5275\u5efa\u78c1\u76e4** \u3002\n- \u5728 **\u78c1\u76e4\u985e\u578b** \u4e0b\uff0c\u9078\u64c7\u4ee5\u4e0b\u78c1\u76e4\u985e\u578b\u4e4b\u4e00\uff1a- **\u5e73\u8861 Hyperdisk** \n- **Hyperdisk Extreme** \n- **Hyperdisk Throughput** \n- \u5728 **\u78c1\u76e4\u4f86\u6e90\u985e\u578b** \u4e0b\uff0c\u9ede\u64ca **\u5feb\u7167** \u3002\n- \u9078\u64c7\u8981\u6062\u5fa9\u7684\u5feb\u7167\u7684\u540d\u7a31\u3002\n- \u9078\u64c7\u65b0\u78c1\u76e4\u7684\u5927\u5c0f\uff08\u4ee5 GiB \u7232\u55ae\u4f4d\uff09\u3002\u6b64\u6578\u5b57\u5fc5\u9808\u7b49\u65bc\u6216\u5927\u65bc\u5feb\u7167\u6700\u521d\u7684\u4f86\u6e90\u78c1\u76e4\u5927\u5c0f\u3002\n- \u7232\u78c1\u76e4\u8a2d\u7f6e **\u9810\u914d\u541e\u5410\u91cf** \u6216 **\u9810\u914d IOPS** \uff08\u5982\u679c\u8207\u9ed8\u8a8d\u503c\u4e0d\u540c\uff09\u3002\n- \u9ede\u64ca **\u5275\u5efa** \u4ee5\u5275\u5efa Hyperdisk \u5377\u3002\n\u904b\u884c [gcloud compute disks create \u547d\u4ee4](https://cloud.google.com/sdk/gcloud/reference/compute/disks/create?hl=zh-cn) \u4ee5\u901a\u904e\u5feb\u7167\u5275\u5efa Hyperdisk \u5377\u3002\n```\ngcloud compute disks create DISK_NAME \\\u00a0 \u00a0 --size=SIZE \\\u00a0 \u00a0 --source-snapshot=SNAPSHOT_NAME \\\u00a0 \u00a0 --provisioned-throughput=TRHROUGHPUT_LIMIT \\\u00a0 \u00a0 --provisioned-iops=IOPS_LIMIT \\\u00a0 \u00a0 --type=hyperdisk-balanced\n```\n\u66ff\u63db\u4ee5\u4e0b\u5167\u5bb9\uff1a- ``\uff1a\u65b0\u78c1\u76e4\u7684\u540d\u7a31\u3002\n- ``\uff1a\u65b0\u78c1\u76e4\u7684\u5927\u5c0f\uff0c\u4ee5\u5409\u6bd4\u5b57\u7bc0 (GiB) \u6216\u592a\u6bd4\u5b57\u7bc0 (TiB) \u7232\u55ae\u4f4d\u3002\u5982\u9700\u77ad\u89e3\u6700\u65b0\u7684\u5bb9\u91cf\u9650\u5236\uff0c\u8acb\u53c3\u95b1 [Compute Engine \u6587\u6a94](https://cloud.google.com/compute/docs/disks/hyperdisks?hl=zh-cn) \u3002\n- ``\uff1a\u8981\u6062\u5fa9\u7684\u5feb\u7167\u7684\u540d\u7a31\u3002\n- ``\uff1a\u53ef\u9078\u3002\u5c0d\u65bc Hyperdisk Balanced \u78c1\u76e4\uff0c\u9019\u662f\u4e00\u500b\u6574\u6578\uff0c\u8868\u793a\u78c1\u76e4\u53ef\u4ee5\u8655\u7406\u7684\u541e\u5410\u91cf\uff08\u4ee5 MiBps \u7232\u55ae\u4f4d\uff09\u3002\u5982\u9700\u77ad\u89e3\u6700\u65b0\u7684\u9650\u5236\uff0c\u8acb\u53c3\u95b1 [Compute Engine \u6587\u6a94](https://cloud.google.com/compute/docs/disks/hyperdisks?hl=zh-cn) \u3002\n- ``\uff1a\u53ef\u9078\u3002\u5c0d\u65bc Hyperdisk Balanced \u78c1\u76e4\uff0c\u9019\u662f\u78c1\u76e4\u53ef\u4ee5\u8655\u7406\u7684 IOPS \u6578\u3002\u5982\u9700\u77ad\u89e3\u6700\u65b0\u7684\u6027\u80fd\u9650\u5236\uff0c\u8acb\u53c3\u95b1 [Compute Engine \u6587\u6a94](https://cloud.google.com/compute/docs/disks/hyperdisks?hl=zh-cn) \u3002\n```\ngcloud compute disks create DISK_NAME \\\u00a0 \u00a0 --size=SIZE \\\u00a0 \u00a0 --source-snapshot=SNAPSHOT_NAME \\\u00a0 \u00a0 --provisioned-throughput=TRHROUGHPUT_LIMIT \\\u00a0 \u00a0 --type=hyperdisk-throughput\n```\n\u8acb\u66ff\u63db\u4ee5\u4e0b\u5167\u5bb9\uff1a- ``\uff1a\u65b0\u78c1\u76e4\u7684\u540d\u7a31\u3002\n- ``\uff1a\u65b0\u78c1\u76e4\u7684\u5927\u5c0f\uff0c\u4ee5\u5409\u6bd4\u5b57\u7bc0 (GiB \u6216 GB) \u6216\u592a\u6bd4\u5b57\u7bc0 (TiB \u6216 TB) \u7232\u55ae\u4f4d\u3002\u5982\u9700\u77ad\u89e3\u6700\u65b0\u7684\u5bb9\u91cf\u9650\u5236\uff0c\u8acb\u53c3\u95b1 [Compute Engine \u6587\u6a94](https://cloud.google.com/compute/docs/disks/hyperdisks?hl=zh-cn) \u3002\n- ``\uff1a\u8981\u6062\u5fa9\u7684\u5feb\u7167\u7684\u540d\u7a31\u3002\n- ``\uff1a\u53ef\u9078\uff1a\u5c0d\u65bc Hyperdisk Throughput \u78c1\u76e4\uff0c\u9019\u662f\u4e00\u500b\u6574\u6578\uff0c\u8868\u793a\u78c1\u76e4\u53ef\u4ee5\u8655\u7406\u7684\u541e\u5410\u91cf\uff08\u4ee5 MiBps \u7232\u55ae\u4f4d\uff09\u3002\u5982\u9700\u77ad\u89e3\u6700\u65b0\u7684\u6027\u80fd\u9650\u5236\uff0c\u8acb\u53c3\u95b1 [Compute Engine \u6587\u6a94](https://cloud.google.com/compute/docs/disks/hyperdisks?hl=zh-cn) \u3002\n```\ngcloud compute disks create DISK_NAME \\\u00a0 \u00a0 --size=SIZE \\\u00a0 \u00a0 --source-snapshot=SNAPSHOT_NAME \\\u00a0 \u00a0 --provisioned-iops=IOPS_LIMIT \\\u00a0 \u00a0 --type=hyperdisk-iops\n```\n\u8acb\u66ff\u63db\u4ee5\u4e0b\u5167\u5bb9\uff1a- ``\uff1a\u65b0\u78c1\u76e4\u7684\u540d\u7a31\u3002\n- ``\uff1a\u65b0\u78c1\u76e4\u7684\u5927\u5c0f\uff0c\u4ee5\u5409\u6bd4\u5b57\u7bc0 (GiB \u6216 GB) \u6216\u592a\u6bd4\u5b57\u7bc0 (TiB \u6216 TB) \u7232\u55ae\u4f4d\u3002\u5982\u9700\u77ad\u89e3\u6700\u65b0\u7684\u5bb9\u91cf\u9650\u5236\uff0c\u8acb\u53c3\u95b1 [Compute Engine \u6587\u6a94](https://cloud.google.com/compute/docs/disks/hyperdisks?hl=zh-cn) \u3002\n- ``\uff1a\u8981\u6062\u5fa9\u7684\u5feb\u7167\u7684\u540d\u7a31\u3002\n- ``\uff08\u53ef\u9078\uff09\uff1a\u5c0d\u65bc Hyperdisk Extreme \u78c1\u76e4\uff0c\u9019\u662f\u78c1\u76e4\u6bcf\u79d2\u53ef\u8655\u7406\u7684 I/O \u64cd\u4f5c\u6578\u3002\u5982\u9700\u77ad\u89e3\u6700\u65b0\u7684\u6027\u80fd\u9650\u5236\uff0c\u8acb\u53c3\u95b1 [Compute Engine \u6587\u6a94](https://cloud.google.com/compute/docs/disks/hyperdisks?hl=zh-cn) \u3002## \u7232 Hyperdisk \u5377\u5275\u5efa\u5feb\u7167\n\u5982\u9700\u901a\u904e Hyperdisk \u5377\u5275\u5efa\u5feb\u7167\uff0c\u8acb\u6309\u7167\u8207\u7232 Persistent Disk \u5377\u5275\u5efa\u5feb\u7167\u76f8\u540c\u7684\u6b65\u9a5f\u64cd\u4f5c\uff1a\n- [\u5728 Google Cloud \u63a7\u5236\u6aaf\u4e2d\u5275\u5efa\u5feb\u7167](https://cloud.google.com/compute/docs/disks/create-snapshots?hl=zh-cn#console) \n- [\u4f7f\u7528 gcloud CLI \u5275\u5efa\u5feb\u7167](https://cloud.google.com/compute/docs/disks/create-snapshots?hl=zh-cn#gcloud) ## \u66f4\u65b0\u73fe\u6709 Hyperdisk \u5377\u7684\u9810\u914d\u541e\u5410\u91cf\u6216 IOPS\n\u672c\u90e8\u5206\u4ecb\u7d39\u5982\u4f55\u4fee\u6539 Hyperdisk \u5377\u7684\u9810\u914d\u6027\u80fd\u3002\n\u53ea\u6709 Hyperdisk Balanced \u548c Hyperdisk Throughput \u5377\u624d\u652f\u6301\u66f4\u65b0\u9810\u914d\u541e\u5410\u91cf\u3002\n\u5982\u9700\u66f4\u65b0 Hyperdisk \u5377\u7684\u9810\u914d\u541e\u5410\u91cf\u7d1a\u5225\uff0c\u8acb\u6309\u7167 [\u66f4\u6539 Hyperdisk \u5377\u7684\u9810\u914d\u6027\u80fd](https://cloud.google.com/compute/docs/disks/modify-hyperdisks?hl=zh-cn#changing_the_provisioned_performance_for_a_volume) \u4e2d\u7684 Google Cloud \u63a7\u5236\u6aaf\u3001gcloud CLI \u6216 Compute Engine API \u8aaa\u660e\u9032\u884c\u64cd\u4f5c\u3002\n\u60a8\u53ef\u4ee5\u5728\u5275\u5efa\u5377\u5f8c\u66f4\u6539 Hyperdisk \u5377\u7684\u9810\u914d\u541e\u5410\u91cf\u7d1a\u5225\uff08\u6700\u591a\u6bcf 4 \u5c0f\u6642\u4e00\u6b21\uff09\u3002\u65b0\u7684\u541e\u5410\u91cf\u7d1a\u5225\u6700\u591a\u53ef\u80fd\u9700\u8981 15 \u5206\u9418\u624d\u80fd\u751f\u6548\u3002\u5728\u6027\u80fd\u66f4\u6539\u671f\u9593\uff0c\u4efb\u4f55\u6027\u80fd SLA \u548c SLO \u90fd\u4e0d\u6703\u751f\u6548\u3002 \u7121\u8ad6\u78c1\u76e4\u662f\u5426\u639b\u63a5\u5230\u6b63\u5728\u904b\u884c\u7684\u5be6\u4f8b\uff0c\u60a8\u90fd\u53ef\u4ee5\u96a8\u6642\u66f4\u6539\u73fe\u6709\u5377\u7684\u541e\u5410\u91cf\u7d1a\u5225\u3002\n\u60a8\u6307\u5b9a\u7684\u65b0\u541e\u5410\u91cf\u7d1a\u5225\u5fc5\u9808\u9075\u5faa [Hyperdisk \u5377\u652f\u6301\u7684\u503c](https://cloud.google.com/compute/docs/disks/modify-hyperdisks?hl=zh-cn#limits) \u3002\n\u53ea\u6709 Hyperdisk Balanced \u548c Hyperdisk Extreme \u5377\u624d\u652f\u6301\u66f4\u65b0\u9810\u914d IOPS\u3002\n\u5982\u9700\u66f4\u65b0 Hyperdisk \u5377\u7684\u9810\u914d IOPS \u7d1a\u5225\uff0c\u8acb\u6309\u7167 [\u66f4\u6539 Hyperdisk \u5377\u7684\u9810\u914d\u6027\u80fd](https://cloud.google.com/compute/docs/disks/modify-hyperdisks?hl=zh-cn#changing_the_provisioned_performance_for_a_volume) \u4e2d\u7684 Google Cloud \u63a7\u5236\u6aaf\u3001gcloud CLI \u6216 Compute Engine API \u8aaa\u660e\u9032\u884c\u64cd\u4f5c\u3002\n\u60a8\u53ef\u4ee5\u5728\u5275\u5efa\u5377\u5f8c\u66f4\u6539 Hyperdisk IOPS \u5377\u7684\u9810\u914d IOPS \u7d1a\u5225\uff08\u6700\u591a\u6bcf 4 \u5c0f\u6642\u4e00\u6b21\uff09\u3002\u65b0\u7684 IOPS \u7d1a\u5225\u6700\u591a\u53ef\u80fd\u9700\u8981 15 \u5206\u9418\u624d\u80fd\u751f\u6548\u3002\u5728\u6027\u80fd\u66f4\u6539\u671f\u9593\uff0c\u4efb\u4f55\u6027\u80fd SLA \u548c SLO \u90fd\u4e0d\u6703\u751f\u6548\u3002 \u7121\u8ad6\u78c1\u76e4\u662f\u5426\u639b\u63a5\u5230\u6b63\u5728\u904b\u884c\u7684\u5be6\u4f8b\uff0c\u60a8\u90fd\u53ef\u4ee5\u96a8\u6642\u66f4\u6539\u73fe\u6709\u5377\u7684 IOPS \u7d1a\u5225\u3002\n\u60a8\u6307\u5b9a\u7684\u65b0 IOPS \u7d1a\u5225\u5fc5\u9808\u9075\u5faa [Hyperdisk \u5377\u652f\u6301\u7684\u503c](https://cloud.google.com/compute/docs/disks/modify-hyperdisks?hl=zh-cn#supported_values_for_volumes) \u3002\n\u5982\u9700\u66f4\u65b0 Hyperdisk \u5377\u7684\u9810\u914d IOPS \u7d1a\u5225\uff0c\u60a8\u5fc5\u9808\u78ba\u5b9a\u652f\u6301 PersistentVolumeClaim \u548c PersistentVolume \u8cc7\u6e90\u7684 Persistent Disk \u7684\u540d\u7a31\uff1a- \u5728 Google Cloud \u63a7\u5236\u6aaf\u4e2d\uff0c\u8f49\u5230 **\u5c0d\u8c61\u700f\u89bd\u5668** \u3002 [\u8f49\u5230\u5c0d\u8c61\u700f\u89bd\u5668](https://console.cloud.google.com/kubernetes/object/browser?hl=zh-cn) \n- \u67e5\u627e PersistentVolumeClaim \u5c0d\u8c61\u7684\u689d\u76ee\u3002\n- \u9ede\u64ca **\u5377** \u93c8\u63a5\u3002\n- \u6253\u958b\u95dc\u806f PersistentVolume \u7684 YAML \u6a19\u7c64\u9801\u3002\u5411\u4e0b\u6efe\u52d5\u627e\u5230 CSI `volumeHandle` \u503c\u3002\n- \u8acb\u6ce8\u610f\u6b64\u53e5\u67c4\u7684\u6700\u5f8c\u4e00\u500b\u5143\u7d20\uff08\u5176\u503c\u61c9\u985e\u4f3c\u65bc\u201c `pvc-XXXXX` \u201d\uff09\u3002\u9019\u662f PersistentVolumeClaim \u7684\u540d\u7a31\u3002\u60a8\u9084\u61c9\u8a72\u8a18\u4e0b\u9805\u76ee\u548c\u53ef\u7528\u5340\u3002## \u76e3\u63a7 Hyperdisk \u6372\u4e0a\u7684\u541e\u5410\u91cf\u6216 IOPS\n\u5982\u9700\u76e3\u63a7 Hyperdisk \u5377\u7684\u9810\u914d\u6027\u80fd\uff0c\u8acb\u53c3\u95b1 Compute Engine \u6587\u6a94\u4e2d\u7684 [\u5206\u6790\u9810\u914d\u7684 IOPS \u548c\u541e\u5410\u91cf](https://cloud.google.com/compute/docs/disks/analyze-iops-hyperdisk?hl=zh-cn) \u3002\n## \u554f\u984c\u6392\u67e5\n\u672c\u90e8\u5206\u63d0\u4f9b\u77ad\u89e3\u6c7a GKE \u4e0a\u7684 Hyperdisk \u5377\u554f\u984c\u7684\u554f\u984c\u6392\u67e5\u6307\u5357\u3002\n### \u7121\u6cd5\u66f4\u6539\u6027\u80fd\u6216\u5bb9\u91cf\uff1a\u6bd4\u7387\u8d85\u51fa\u7bc4\u570d\n\u5982\u679c\u60a8\u5617\u8a66\u66f4\u6539\u9810\u914d\u7684\u6027\u80fd\u7d1a\u5225\u6216\u5bb9\u91cf\uff0c\u4f46\u60a8\u9078\u64c7\u7684\u6027\u80fd\u7d1a\u5225\u6216\u5bb9\u91cf\u8d85\u51fa\u5377\u7684\u53ef\u63a5\u53d7\u7bc4\u570d\uff0c\u5247\u6703\u767c\u751f\u4ee5\u4e0b\u932f\u8aa4\uff1a\n- `Requested provisioned throughput cannot be higher than <value>.`\n- `Requested provisioned throughput cannot be lower than <value>.`\n- `Requested provisioned throughput is too high for the requested disk size.`\n- `Requested provisioned throughput is too low for the requested disk size.`\n- `Requested disk size is too high for current provisioned throughput.`\n\u7232 Hyperdisk Throughput \u5377\u9810\u914d\u7684\u541e\u5410\u91cf\u5fc5\u9808\u6eff\u8db3\u4ee5\u4e0b\u8981\u6c42\uff1a\n- \u6bcf TiB \u5bb9\u91cf\u81f3\u5c11\u7232 10 MiBps\uff0c\u6bcf TiB \u5bb9\u91cf\u4e0d\u8d85\u904e 90 MiBps\u3002\n- \u6bcf\u500b\u5377\u6700\u591a 600 MiBps\u3002\n\u8981\u89e3\u6c7a\u6b64\u554f\u984c\uff0c\u8acb\u5c07\u8acb\u6c42\u7684\u541e\u5410\u91cf\u6216\u5bb9\u91cf\u66f4\u6b63\u5728\u5141\u8a31\u7684\u7bc4\u570d\u5167\uff0c\u7136\u5f8c\u91cd\u65b0\u767c\u51fa\u547d\u4ee4\u3002\n### \u7121\u6cd5\u66f4\u6539\u6027\u80fd\uff1a\u901f\u7387\u53d7\u9650\n\u5982\u679c\u60a8\u5617\u8a66\u66f4\u6539\u9810\u914d\u7684\u6027\u80fd\u7d1a\u5225\uff0c\u4f46\u6027\u80fd\u7d1a\u5225\u5728\u904e\u53bb 4 \u5c0f\u6642\u5167\u5df2\u66f4\u6539\uff0c\u5247\u6703\u767c\u751f\u4ee5\u4e0b\u932f\u8aa4\uff1a\n```\nCannot update provisioned throughput due to being rate limited.\nCannot update provisioned iops due to being rate limited.\n```\nHyperdisk Throughput \u5377\u548c IOPS \u5377\u53ef\u4ee5\u6bcf 4 \u5c0f\u6642\u66f4\u65b0\u4e00\u6b21\u9810\u914d\u7684\u6027\u80fd\u3002\u5982\u9700\u89e3\u6c7a\u6b64\u554f\u984c\uff0c\u8acb\u7b49\u5f85\u51b7\u537b\u671f\u8b93\u6372\u5230\u671f\uff0c\u7136\u5f8c\u91cd\u65b0\u767c\u51fa\u547d\u4ee4\u3002\n## \u5f8c\u7e8c\u6b65\u9a5f\n- [\u77ad\u89e3\u5982\u4f55\u5c07 Persistent Disk \u5377\u9077\u79fb\u5230 Hyperdisk](https://cloud.google.com/compute/docs/disks/migrate-to-hyperdisk?hl=zh-cn#gcloud) \u3002\n- [\u77ad\u89e3\u5982\u4f55\u4f7f\u7528\u5377\u64f4\u5c55\u529f\u80fd](https://cloud.google.com/kubernetes-engine/docs/how-to/persistent-volumes/volume-expansion?hl=zh-cn) \u3002\n- [\u77ad\u89e3\u5982\u4f55\u4f7f\u7528\u5377\u5feb\u7167](https://cloud.google.com/kubernetes-engine/docs/how-to/persistent-volumes/volume-snapshots?hl=zh-cn) \u3002\n- [\u5728 GitHub \u4e0a\u8a73\u7d30\u77ad\u89e3\u8a72\u9a45\u52d5\u7a0b\u5e8f](https://github.com/kubernetes-sigs/gcp-compute-persistent-disk-csi-driver) \u3002", "guide": "Google Kubernetes Engine (GKE)"}