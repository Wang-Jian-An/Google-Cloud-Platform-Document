{"title": "Compute Engine - Troubleshooting Google Virtual NIC", "url": "https://cloud.google.com/compute/docs/instances", "abstract": "# Compute Engine - Troubleshooting Google Virtual NIC\n[Google Virtual NIC (gVNIC)](/compute/docs/networking/using-gvnic)\n", "content": "## Common errors\nThe following issue occurs when the image used to create the VM is not tagged to use gVNIC.\n```\nERROR: (gcloud.compute.instances.create) Could not fetch resource:\n - Invalid value for field 'resource.networkInterfaces[0].nicType': 'GVNIC'. NetworkInterface NicType can only be set to GVNIC on instances with GVNIC GuestOsFeature.\n```\nTo resolve this issue, ensure that you are using an image that is tagged to use gVNIC. For more information, see [Create a custom image](/compute/docs/networking/using-gvnic#create-custom-image) .\n## Other issues\n### VM instance didn't boot\n- **Cause:** gVNIC is not enabled on the image.\n- **Diagnosis:** Check that the image has `gVNIC` enabled. To verify, run the following command:```\ngcloud compute images describe IMAGE_NAME\n```Replace `` with the name of your image.The output of the command should show `GVNIC` under `guestOsFeatures` .You can also check if the VM was created with the `nic-type` set to `gVNIC` . To do this run the following command:```\ngcloud compute instances describe VM_NAME\n```Replace `` with the name of your VM.\n- **Resolution:** Ensure that you are using a [supported image](/compute/docs/networking/using-gvnic#os-support) or that you have properly [set up the gVNIC driver](/compute/docs/networking/using-gvnic#manual-gvnic-setup) on your custom image.\n### VM instance booted but is not reachable over the network\n- **Cause:** gVNIC was not successfully installed and loaded.\n- **Diagnosis:** To check if the driver was installed and loaded, complete the following steps:\n- Check that the driver is installed.```\nmodinfo gve\n```The output should resemble the following:```\nfilename:  /lib/modules/4.15.0-1036-gcp/updates/dkms/gve.ko\nversion:  1.1.0\nlicense:  Dual MIT/GPL\ndescription: gVNIC Driver\nauthor:   Google, XXX.\nsrcversion:  5FEFB9DD945EB2DEC94EE09\nalias:   pci:v00001AE0d00000042sv*sd*bc*sc*i*\ndepends:\nretpoline:  Y\nname:   gve\nvermagic:  4.15.0-1036-gcp SMP mod_unload\n```\n- Check that the driver is loaded.```\nlsmod | grep gve\n```The output should resemble the following:```\ngve     49152 0\n```\n- Connect to instance through [SAC](/compute/docs/instances/connecting-to-windows#windows_cli) .\n- Login with your username and password.\n- From the command prompt, run the following command:```\ndism /online /get-drivers | findstr gvnic\n```\n- Review the result.- If the driver is installed, you should see the text`Original File Name : gvnic.inf`in the output.\n- If the driver is not installed, no message is returned.\n **Note:** You can also review the [interactive serial console](/compute/docs/instances/interacting-with-serial-console) when debugging issues with your connection.\n- **Resolution:** If gVNIC is not available, ensure that you are using a [supported image](/compute/docs/networking/using-gvnic#os-support) or that you have properly [set up gVNIC](/compute/docs/networking/using-gvnic#manual-gvnic-setup) on your custom image.\n### Poor networking throughput for Windows Server 2022 and Windows 11 VMs\nYou might experience poor networking throughput when using [Google Virtual NIC (gVNIC)](/compute/docs/networking/using-gvnic) with Windows Server 2022 and Windows 11 VMs that use gVNIC driver GooGet package version `1.0.0@44` or earlier.\nTo resolve this issue, update the gVNIC driver GooGet package to version `1.0.0@45` or later by doing the following:\n- Check which driver version is installed on your VM by running the following command from an administrator Command Prompt or Powershell session:```\ngooget installed\n```The output looks similar to the following:```\nInstalled packages:\n ...\n google-compute-engine-driver-gvnic.x86_64 VERSION_NUMBER\n ...\n```\n- If the `google-compute-engine-driver-gvnic.x86_64` driver version is `1.0.0@44` or earlier, update the update the [GooGet package repository](https://github.com/google/googet) by running the following command from an administrator Command Prompt or Powershell session:```\ngoogle-compute-engine-driver-gvnic.x86_64\n```", "guide": "Compute Engine"}