{"title": "Apigee - Synchronizer logs", "url": "https://cloud.google.com/apigee/docs/api-platform/get-started/what-apigee", "abstract": "# Apigee - Synchronizer logs\nYou are currently viewing version 1.1 of the Apigee hybrid documentation. **This version is end of life.** You should upgrade to a newer version. For more information, see [Supported versions](/apigee/docs/hybrid/supported-platforms#supported-versions) .\nLogs are a good way to troubleshoot problems with your Apigee hybrid installation. See [Logging](/apigee/docs/hybrid/v1.1/logging) for details.\n", "content": "## Synchronizer log entries\nThe following table describes the fields that you will see in Synchronizer log files.\n| Field  | Indicates                |\n|:------------|:----------------------------------------------------------------------|\n| org:  | Organization name              |\n| env:  | Environment name              |\n| target:  | Path of entity to which the log entry represents      |\n| action:  | Action SYNC=Upstream sync action REPLICATE=Replicate/download action |\n| context-id: | The contract version wherever applicable        |\nFor example:\n```\n2019-02-05 00:00:59,098 org:hybrid env:test target: action:SYNC context-id: mode: Apigee-Timer-5 INFO \u00a0CONFIG-CHANGE - SyncContext.syncUpStream() : Upstream sync started with https://api.enterprise.apigee.net\n```\n## Understanding Synchronizer logs\nIf you need to troubleshoot a problem with the Synchronizer, look at the log files. The following table may help you troubleshoot errors may see in the Synchronizer logs. See also [Logging](/apigee/docs/hybrid/v1.1/logging) .\n| Log entry                                                                  | What does it mean                    |\n|:------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:-----------------------------------------------------------------------------------------------|\n| org:test env:dev target: action:SYNC context-id: mode: Apigee-Timer-0 INFO CONFIG-CHANGE - SyncContext.syncUpStream() : Upstream sync started with http://localhost:8080                          | Upstream poll was started for the org and environment and given management plane URL   |\n| 2019-01-21 16:58:02,275 org:test env:qa target: action:SYNC context-id: mode: Apigee-Timer-1 INFO CONFIG-CHANGE - ManagementServerBasedReplicationContext.getContract() : Upstream contract poll returned 200                 | Contract was received successfully                |\n| 2019-01-21 16:58:02,536 org:test env:dev target: action:SYNC context-id: mode: Apigee-Timer-0 INFO CONFIG-CHANGE - ManagementServerBasedReplicationContext.getContract() : Received a new contract version 20190121.090851.339            | A contract version was received                |\n| 2019-01-21 17:58:56,530 org:test env:qa target:/organizations/test/environments/qa action:REPLICATE context-id:20190121.090859.699 mode: Apigee-Timer-1 INFO CONFIG-CHANGE - ConfigReplicator.startReplication() : Replication started          | Indicates Replication start. MDC fields indicate the details about what is being replicated |\n| 2019-01-21 17:58:56,654 org:test env:qa target:/organizations/test/environments/qa/resourcefiles/js/JavaScriptCallout.js action:REPLICATE context-id:20190121.090859.699 mode: Apigee-Timer-1 INFO CONFIG-CHANGE - ConfigReplicator.startReplication() : Replication complete | Indicates Replication finished. MDC fields indicate the details about what is being replicated |\n| 2019-01-21 17:58:56,654 org:test env:qa target:/organizations/test/environments/qa action:REPLICATE context-id:20190121.090859.699 mode: Apigee-Timer-1 ERROR CONFIG-CHANGE - ConfigReplicator.startReplication() : Replication failed          | Indicates a replication error                 |\n| 2019-01-21 17:59:00,246 org:test env:qa target: action:SYNC context-id: mode: Apigee-Timer-1 INFO CONFIG-CHANGE - SyncContext.syncUpStream() : Upstream sync finished in 4 seconds                       | Indicates end of a sync cycle and also provides time taken to sync        |\n| 2019-01-21 18:00:00,249 org:test env:dev target: action:SYNC context-id: mode: Apigee-Timer-1 INFO CONFIG-CHANGE - ManagementServerBasedReplicationContext.getContract() : Upstream contract poll returned 304                | Indicates that a newer contract was not available            |\n| 2019-01-21 18:21:39,128 org:test env:qa target: action:SYNC context-id: mode: Apigee-Timer-1 ERROR CONFIG-CHANGE - ManagementServerBasedReplicationContext.getContract() : Upstream contract poll returned error 0               | Indicates that the management plane was not reachable           |\n| 2019-01-21 18:21:39,128 org:test env:qa target: action:SYNC context-id: mode: Apigee-Timer-1 ERROR CONFIG-CHANGE - ManagementServerBasedReplicationContext.getContract() : Upstream contract poll returned error 404               | Indicates that the management plane returned a 404 response for the contract     |\n| 2019-01-21 18:22:39,217 org:test1 env:dev target: action:SYNC context-id: mode: Apigee-Timer-2 ERROR CONFIG-CHANGE - ManagementServerBasedReplicationContext.getContract() : Upstream contract poll returned error 403              | Indicates that environment being polled for is not hybrid-enabled        |\n| 2019-01-21 18:22:39,217 org:test1 env:dev target: action:SYNC context-id: mode: Apigee-Timer-2 ERROR CONFIG-CHANGE - ManagementServerBasedReplicationContext.getContract() : Upstream contract poll returned error 401              | Supplied credentials has some issues               |\n## Error troubleshooting\nLogs are a good way to troubleshoot problems with your installation. See [Logging](/apigee/docs/hybrid/v1.1/logging) for details.\n### Synchronizer fails to start\nBelow are a few errors and their remediation explained. Each of these errors message start with an ErrorCode of type sync.xxxxx. Below are possible error codes\n**sync.NullOrEmptyConfig**\n**Message:** Null or empty config supplied via com.apigee.sync.config\n**Reason:** You will see this error message when the Synchronizer's configuration properties were not supplied properly.\n**Remedy:** Make sure all configuration properties are populated with appropriate values.\n**sync.ConfigFileNotFound**\n**Reason:** The Synchronizer was set to read its configuration properties from a file but the file could not be loaded\n**Remedy:** make sure the file is available and accessible during Synchronizer bootup\n**sync.IncorrectSettings**\n**Reason:** One or more required configuration properties are missing from the Synchronizer configuration or they values that are outside the expected range. The error should have more details about the exact property that is causing the problem. These errors are in-built into the parser to make sure that and setting errors are caught even before the service starts.\nThe following table lists some possible IncorrectSettings errors:\n| Error                                             | What's wrong                   |\n|:--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|:----------------------------------------------------------------------------------------|\n| configuration.json.IncorrectSettings: [com.apigee.sync.config.json] Error:/controlPlane/retries numeric instance is greater than the required maximum (maximum: 3, found: 20)   | Value supplied to retries field in controlPlane section has exceeded the allowed  |\n| configuration.json.IncorrectSettings: [com.apigee.sync.config.json] Error:/controlPlane/connectionTimeout numeric instance is lower than the required minimum (minimum: 10, found: 1) | Value supplied to connectionTimeout field in controlPlane section is lower than allowed |\n| configuration.json.IncorrectSettings: [com.apigee.sync.config.json] Error:/controlPlane object has missing required properties ([\\\"contractProvider\\\"])        | controlPlane section is missing the mandatory field contractProvider     |\n| configuration.json.IncorrectSettings: [com.apigee.sync.config.json] Error:/controlPlane/contractProvider string \\\"http://\\\\uapi.apigee.com\\\" is not a valid URI      | Contract provider URI is not a valid URI            |\n| configuration.json.IncorrectSettings: [com.apigee.sync.config.json] Error:/environments array is too short: must have at least 1 elements but instance has 0 elements     | The environments array must have at least one environment        |\n| configuration.json.IncorrectSettings: [com.apigee.sync.config.json] Error:/environments/0 object has missing required properties ([\\\"environmentName\\\"])        | Environment at index 0 is missing the mandatory field environmentName     |\n| configuration.json.IncorrectSettings: [com.apigee.sync.config.json] Error:/environments/0 object has missing required properties ([\\\"organizationName\\\"])        | Environment at index 0 is missing the mandatory field organizationName     |\n| configuration.json.IncorrectSettings: [com.apigee.sync.config.json] Error:/environments/0/pollInterval numeric instance is lower than the required minimum (minimum: 60, found: 6) | Environment at index 0 has a poll interval which is under the allowed limit of 60  |\n**Remedy:** Fix the setting to include the required block\n**sync.ReplicationRootDoesNotExist**\n**Reason:** The Synchronizer was supplied with a replication root which does not exist\n**Remedy:** make sure the supplied root folder exists and is writeable\n**sync.ReadOnlyReplicationRoot**\n**Reason:** The Synchronizer was supplied with a replication root which do not have write permissions\n**Remedy:** make sure the supplied root folder exists and is writeable\n**sync.ReplicationRootNotADir**\n**Reason:** The Synchronizer was supplied with a replication root which is possibly a file\n**Remedy:** make sure the supplied root folder exists and is writeable\n**sync.InvalidControlPlaneURL**\n**Reason:** The Synchronizer was supplied with a config URL which is empty\n**Remedy:** Make sure the supplied root folder exists and is writeable\n**sync.InvalidControlPlaneSubscriptionURL**\n**Reason:** The Synchronizer was supplied with an incorrect, incomplete, or empty config URL for subscription creation.\n**Remedy:** Correct the URL to a valid config URL for pub/sub subscription creation to handle signals from control plane.\n**sync.InvalidControlPlaneUnsubscriptionURL**\n**Reason:** The Synchronizer was supplied with an incorrect, incomplete, or empty config URL for subscription deletion.\n**Remedy:** Correct the URL to a valid config URL for pub/sub subscription deletion to handle signals from control plane.\n**sync.CannotCreateEnvironmentFolder**\n**Reason:** The Synchronizer tried to create a folder for replicating environment qa but could not create the required folder\n**Remedy:** make sure the replication root does not have a conflicting path with the same name which is either read-only of a file\n**sync.DuplicateEnvironmentEntries**\n**Reason:** The same environment was added multiple times in the configuration.\n**Remedy:** Every environment can be specified only once.\n**sync.DiskExceedsAllowedCapacity**\n**Reason:** The supplied storage disk is already at threshold capacity supplied via the configuration properties.\n**Remedy:** Make sure there is enough disk space or check if the storage settings can be tweaked to allow more disk space.\n**sync.OwnershipClaimFailed**\n**Reason:** Synchronizer tried to claim ownership on the environment folder but failed\n**Remedy:** every Synchronizer will first try to make sure it is a sole writer to the file system. The error indicates the path and the reason for the failure. Address the root cause\n## Synchronizer errors during runtime\nThe following Synchronizer errors can occur during runtime.\n**sync.replicators.PollReturnedError**\nAssociated message will include the upstream status. Below are the error statuses\n**status 0**\n**Reason:** Indicates a connectivity issue. The management plane was not reachable\n**Remedy:** Make sure the management plane details are correct and the [contracts API](#diagnosing-contract-download-failures) is reachable\n**status 404**\n**Reason:** Most likely the org/env name is not found on the server\n**Remedy:** Make sure the management plane details are correct and the [contracts API](#diagnosing-contract-download-failures) is reachable\n**status 401**\n**Reason:** Most likely credentials supplied do not have the org admin privileges.\n**Remedy:** Make sure the management plane credentials are correct and the [contracts API](#diagnosing-contract-download-failures) is reachable\n**status 403**\n**Reason:** Indicates the environment being polled for is not set up as hybrid environment\n**Remedy:** Make sure the org has the required flag **\"features.hybrid.enabled=true\"**\n**sync.OwnershipClaimedByOther**\n**Reason:** During the operation Synchronizer found that the file root is being accessed by another instance of Synchronizer. (This can happen when a file system is shared among Synchronizers.)\n**Remedy:** Address the root problem to make sure no two Synchronizer instances share the same file system. The Synchronizer would have marked itself down and would be in an unrecoverable position here. It would also make sure the other Synchronizer which is accessing the same file root gets notified about it via their ownership files\n**sync.DiskExceedsAllowedCapacity**\n**Reason:** During the operation Synchronizer realized that the disk occupancy has exceeded the allowed limit.\n**Remedy:** At this point Synchronizer would abort any downloads and try a stale file cleanup operation. However this may become a recurring condition and the only way to recover completely is to make sure the Synchronizer has enough disk memory to operate.\n### Diagnose contract download failures\nIf you see \"upstream contract poll\" in an error message, try calling the contract API and check the details, where username is your Apigee username (your email address). The contract represents the entire collection of data that the Synchronizer downloads from the management plane.\n```\ncurl https://api.enterprise.apigee.net/v1/organizations/org/environments/env/contracts/1.0 -u username\n```", "guide": "Apigee"}