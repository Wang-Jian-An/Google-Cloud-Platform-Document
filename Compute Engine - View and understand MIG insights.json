{"title": "Compute Engine - View and understand MIG insights", "url": "https://cloud.google.com/compute/docs/instances", "abstract": "# Compute Engine - View and understand MIG insights\nManaged instance group (MIG) insights help you understand the CPU and memory usage of the virtual machine (VM) instances that are part of your MIG. These insights are generated automatically based on system metrics or metrics gathered by the Cloud Monitoring service. You can use these insights to support decisions about resizing your MIG's machine type to more efficiently use VM resources.\nFor more information about insights, see [Insights](/recommender/docs/insights/using-insights) .\n", "content": "## Before you begin\n- If you haven't already, set up authentication. [Authentication](/compute/docs/authentication) is the process by which your identity is verified for access to Google Cloud services and APIs. To run code or samples from a local development environment, you can authenticate to Compute Engine as follows.Select the tab for how you plan to use the samples on this page:\nWhen you use the Google Cloud console to access Google Cloud services and   APIs, you don't need to set up authentication.- [Install](/sdk/docs/install) the Google Cloud CLI, then [initialize](/sdk/docs/initializing) it by running the following command:```\ngcloud init\n``` **Note:** If you installed the gcloud CLI  previously, make sure you have the latest version by running`gcloud components  update`.\n- [ Set a default region and zone](/compute/docs/gcloud-compute#set_default_zone_and_region_in_your_local_client) .\nTo use the REST API samples on this page in a local development environment, you use the credentials you provide to the gcloud CLI.- [Install](/sdk/docs/install) the Google Cloud CLI, then [initialize](/sdk/docs/initializing) it by running the following command:\n- ```\ngcloud init\n```## View insights for MIG recommendations\nCompute Engine generates [machine type recommendations](/compute/docs/instance-groups/apply-machine-type-recommendations-managed-instance-groups) based on resource [insights](/recommender/docs/insights/using-insights) . By viewing insights associated with a specific MIG, you can learn more about the CPU and memory usage for your MIG.\nTo view the insights that generated a specific recommendation, use the gcloud CLI or REST.\nTo view all the available insights in detail for a specific zone, use the [insights list command](/sdk/gcloud/reference/recommender/insights/list) .\n```\ngcloud recommender insights list --project=PROJECT_ID \\\n --location=LOCATION \\\n --insight-type=INSIGHT_TYPE_ID \\\n --format=FORMAT\n```\nReplace the following:- ``: the ID of your project.\n- ``: the zone that contains the resources for which you want to view insights.\n- ``: the id of the [insight type](/recommender/docs/insights/insight-types) . For a list of the VM insights available, see [Types of MIG insights](#types_of_mig_insights) .\n- ``: your preferred output [format](/sdk/gcloud/reference/topic/formats) \u2013for example,`json`.\nA typical output of the `insights list` command using the `json` output format might look like the following.\n```\n[ {\n \"name\": \"projects/PROJECT_ID/locations/us-central1-a/insightTypes/google.compute.instanceGroupManager.CpuUsagePredictionInsight/insights/0ec21a13-bb04-3121-7321-dc43a11cc3e3\",\n \"description\": \"Predicted CPU usage is 1.5 vCPUs.\",\n \"targetResources\": [  \"//compute.googleapis.com/projects/PROJECT_ID/zones/us-central1-a/instanceGroupManagers/test-instance\"\n ],\n \"insightSubtype\": \"CPU_USAGE_PREDICTION\",\n \"lastRefreshTime\": \"2021-09-15T06:50:45Z\",\n \"observationPeriod\": \"14 days\",\n \"stateInfo\": {\n  \"state\": \"ACTIVE\"\n },\n \"content\": {\n  \"predictedCpuCores\": 1.5\n },\n \"category\": \"PERFORMANCE\",\n \"etag\": \"fds421j2340\",\n \"associatedRecommendations\": [  {\n   \"recommendation\": \"projects/PROJECT_ID/locations/us-central1-a/recommenders/google.compute.instanceGroupManager.MachineTypeRecommender/recommendations/0fd31b24-cc05-4132-8431-ed54a22dd4f1\"\n  }\n ]\n }\n]\n```\nTo view all the available insights in detail for a specific zone, use the [insights.list method](/recommender/docs/reference/rest/v1/projects.locations.insightTypes.insights/list) .\n```\nGET https://recommender.googleapis.com/v1/projects/PROJECT_ID/locations/LOCATION/insightTypes/INSIGHT_TYPE_ID/insights\n```\nReplace the following:- ``: the ID of your project.\n- ``: the zone that contains the resources for which you want to view insights.\n- ``: the id of the [insight type](/recommender/docs/insights/insight-types) . For a list of the VM insights available, see [Types of MIG insights](#types_of_mig_insights) .\nA typical output of the `insights.list` method might look like the following.\n```\n[ {\n \"name\": \"projects/PROJECT_ID/locations/us-central1-a/insightTypes/google.compute.instanceGroupManager.CpuUsagePredictionInsight/insights/0ec21a13-bb04-3121-7321-dc43a11cc3e3\",\n \"description\": \"Predicted CPU usage is 1.5 vCPUs.\",\n \"targetResources\": [  \"//compute.googleapis.com/projects/PROJECT_ID/zones/us-central1-a/instanceGroupManagers/test-instance\"\n ],\n \"insightSubtype\": \"CPU_USAGE_PREDICTION\",\n \"lastRefreshTime\": \"2021-09-15T06:50:45Z\",\n \"observationPeriod\": \"14 days\",\n \"stateInfo\": {\n  \"state\": \"ACTIVE\"\n },\n \"content\": {\n  \"predictedCpuCores\": 1.5\n },\n \"category\": \"PERFORMANCE\",\n \"etag\": \"fds421j2340\",\n \"associatedRecommendations\": [  {\n   \"recommendation\": \"projects/PROJECT_ID/locations/us-central1-a/recommenders/google.compute.instanceGroupManager.MachineTypeRecommender/recommendations/0fd31b24-cc05-4132-8431-ed54a22dd4f1\"\n  }\n ]\n }\n]\n```\nFor more information about insights, see the [reference docs](/recommender/docs/reference/rest/v1/projects.locations.insightTypes.insights) .\n## Types of MIG insights\nYou can use different insights to retrieve information about the performance of your MIGs. Each insight type has specific content attributes.\nThe following sections provide a reference for the MIG insights available.\n### CPU usage insight\nCompute Engine creates CPU usage insights when the CPU usage of your MIGs has been higher or lower than usual for the last observation period.\nThe insight type ID is `google.compute.instanceGroupManager.CpuUsageInsight` .\nThe available subtypes are:\n- `HIGH_CPU_USAGE`\n- `LOW_CPU_USAGE`\nThese are associated with insight descriptions such as the following:\n- `In the last 7 days for 80% of the time, CPU usage was greater than or equal to 83% for the least utilized VM instance. In the last 7 days for 80% of the time, CPU usage was greater than or equal to 93% for the most utilized VM instance.`\n- `In the last 7 days for 80% of the time, CPU usage was lower than or equal to 10% for the most utilized VM instance. In the last 7 days for 80% of the time, CPU usage was lower than or equal to 3% for the least utilized VM instance.`\nThe following table provides some details about the content associated with CPU usage insights.\n| 0      | 1  | 2                                                                                              |\n|:-------------------------|:------|:-----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|\n| Attribute    | Type | Description                                                                                            |\n| pointsForLeastUtilizedVm | ARRAY | Array of objects. Each object contains the following properties: sampleProbability: (DOUBLE) Relative amount of CPU usage samples below the quantile function value. quantileFunctionValue: (DOUBLE) Upper bound for CPU usage which holds at least part (sample probability) of samples. The value represents the ratio of the total amount of vCPUs, and is in the range [0, 1]. |\n| pointsForMostUtilizedVm | ARRAY | Array of objects. Each object contains the following properties: sampleProbability: (DOUBLE) Relative amount of CPU usage samples below quantile function value. quantileFunctionValue: (DOUBLE) Upper bound for CPU usage which holds at least part (sample probability) of samples. The value represents the ratio of the total amount of vCPUs, and is in the range [0, 1].  |### CPU usage prediction insight\nCompute Engine creates CPU usage prediction insights to indicate the predicted CPU usage for the following day.\nThe insight type ID is `google.compute.instanceGroupManager.CpuUsagePredictionInsight` .\nA typical description you can find in this insight is similar to the following:\n- `Predicted CPU usage of a single instance is 1.5 vCPUs.`\nThe following table provides some details about the content associated with CPU usage prediction insights.\n| 0     | 1  | 2        |\n|:--------------------|:-------|:-------------------------------|\n| Attribute   | Type | Description     |\n| predicted_cpu_cores | DOUBLE | Predicted amount of CPU cores. |\n### CPU usage trend insight\nCompute Engine creates CPU usage trend insights when CPU usage shows an increasing or decreasing trend in the last observation period.\nThe insight type ID is `google.compute.instanceGroupManager.CpuUsageTrendInsight` .\nThe available subtypes are:\n- `CPU_USAGE_INCREASE`\n- `CPU_USAGE_DECREASE`\nThese are generally associated with insight descriptions such as the following:\n- `In the last 7 days, average daily CPU usage has increased by 8% from 65% to 73%.`\n- `In the last 7 days, average daily CPU usage has decreased by 10% from 55% to 45%.`\nThe following table provides some details about the content associated with CPU usage trend insights.\n| 0        | 1  | 2                                                              |\n|:------------------------------|:-------|:---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|\n| Attribute      | Type | Description                                                            |\n| cpu_usage_percentage_at_start | DOUBLE | Measured daily mean of CPU usage at the start of the observation period. The value represents the percentage of the total number of vCPUs, and is in the range [0, 100].                    |\n| cpu_usage_percentage_at_end | DOUBLE | Measured daily mean of CPU usage at the end of the observation period. The value represents the percentage of the total number of vCPUs, and is in the range [0, 100].                    |\n| cpu_usage_percentage_change | DOUBLE | Predicted change of daily mean of CPU usage during the observation period. Prediction uses linear regression to model the change of daily CPU usage. The value represents the percentage of the total number of vCPUs, and is in the range [0, 100]. |\n### Memory usage insight\nCompute Engine creates memory usage insights if the memory usage is exceptionally high or low during the observation period.\nThe insight type ID is `google.compute.instanceGroupManager.MemoryUsageInsight` .\n**Note:** You can receive memory usage insights only if you install Cloud Monitoring in your VMs. For more information, see [Installing Cloud Monitoring](/monitoring/agent/monitoring/installation) .\nThe available subtypes are:\n- `HIGH_MEMORY_USAGE`\n- `LOW_MEMORY_USAGE`\nThese are generally associated with insight descriptions such as the following:\n- `In the last 12 days for 80% of the time, memory usage was greater than or equal to 64%.`\n- `In the last 7 days for 50% of the time, memory usage was lower than or equal to 10%.`\nThe following table provides some details about the content associated with memory usage insights.\n| 0        | 1  | 2                                                    |\n|:--------------------------------|:-------|:---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|\n| Attribute      | Type | Description                                                 |\n| sample_probability    | DOUBLE | Relative amount of memory usage samples below quantile function value. The value is in the range [0, 1].                          |\n| quantile_function_lowest_value | DOUBLE | Upper bound for memory usage which holds at least part (sample probability) of samples for the least utilized VM. The value represents the ratio of the total amount of memory, and is in the range [0, 1]. |\n| quantile_function_highest_value | DOUBLE | Upper bound for memory usage which holds at least part (sample probability) of samples for the most utilized VM. The value represents the ratio of the total amount of memory, and is in the range [0, 1]. |\n### Memory usage prediction insight\nCompute Engine creates memory usage prediction insights to indicate the memory usage predicted for the following day.\n**Note:** You can receive memory usage insights only if you install Cloud Monitoring in your VMs.\nThe insight type ID is `google.compute.instanceGroupManager.MemoryUsagePredictionInsight` .\nA typical insight description is the following:\n- `Predicted memory usage is 1536 MB.`\nThe following table provides some details about the content associated with memory usage prediction insights.\n| 0     | 1  | 2           |\n|:--------------------|:-------|:--------------------------------------------|\n| Attribute   | Type | Description         |\n| predicted_memory_mb | DOUBLE | Predicted amount of memory expressed in MB. |\n## What's next\n- Learn more about [machine type recommendations](/compute/docs/instance-groups/apply-machine-type-recommendations-managed-instance-groups) that Compute Engine creates based on insights.", "guide": "Compute Engine"}