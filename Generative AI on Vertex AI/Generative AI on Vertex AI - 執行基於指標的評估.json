{"title": "Generative AI on Vertex AI - \u57f7\u884c\u57fa\u65bc\u6307\u6a19\u7684\u8a55\u4f30", "url": "https://cloud.google.com/vertex-ai/generative-ai/docs/models/evaluate-models?hl=zh-cn", "abstract": "# Generative AI on Vertex AI - \u57f7\u884c\u57fa\u65bc\u6307\u6a19\u7684\u8a55\u4f30\n**\u9810\u89bd** \u6b64\u529f\u80fd\u7232\u9810\u89bd\u7248\uff0c\u53d7 [GCP \u670d\u52d9\u5c08\u7528\u689d\u6b3e](https://cloud.google.com/terms/service-terms?hl=zh-cn) \u7684\u6b63\u5f0f\u767c\u4f48\u524d\u7522\u54c1\u689d\u6b3e\u7d04\u675f\u3002\u6211\u5011\u5c0d\u6b63\u5f0f\u767c\u4f48\u524d\u7522\u54c1\u548c\u529f\u80fd\u7684\u652f\u6301\u53ef\u80fd\u6bd4\u8f03\u6709\u9650\uff0c\u4e26\u4e14\u5c0d\u6b63\u5f0f\u767c\u4f48\u524d\u7522\u54c1\u548c\u529f\u80fd\u7684\u66f4\u6539\u53ef\u80fd\u8207\u5176\u4ed6\u6b63\u5f0f\u767c\u4f48\u524d\u7248\u672c\u4e0d\u517c\u5bb9\u3002\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [\u767c\u4f48\u968e\u6bb5\u8aaa\u660e](https://cloud.google.com/products?hl=zh-cn#product-launch-stages) \u3002  \u6b64\u5916\uff0c\u4f7f\u7528 PaLM API on Vertex AI \u5373\u8868\u793a\u60a8\u540c\u610f\u751f\u6210\u5f0f AI \u9810\u89bd\u7248 [\u689d\u6b3e\u53ca\u689d\u4ef6](https://cloud.google.com/trustedtester/aitos?hl=zh-CN) \uff08\u201c\u9810\u89bd\u7248\u689d\u6b3e\u201d\uff09\u3002\u5c0d\u65bc\u975e\u6b63\u5f0f\u7248 PaLM API on Vertex AI\uff0c\u60a8\u53ef\u4ee5\u6309\u7167\u300a\u96f2\u7aef\u6578\u64da\u8655\u7406\u9644\u9304\u300b\u4e2d\u7684\u8aaa\u660e\u8655\u7406\u500b\u4eba\u6578\u64da\uff0c\u4f46\u53d7\u5230\u5354\u8b70\u4e2d\u7684\u9069\u7528\u9650\u5236\u548c\u7fa9\u52d9\uff08\u5982\u201c\u9810\u89bd\u7248\u689d\u6b3e\u201d\u4e2d\u6240\u5b9a\u7fa9\uff09\u7684\u7d04\u675f\u3002\n\u60a8\u53ef\u4ee5\u5728 Vertex AI \u4e0a\u7684\u751f\u6210\u5f0f AI \u4e2d\u8a55\u4f30\u57fa\u790e\u6a21\u578b\u548c\u7d93\u904e\u8abf\u512a\u7684\u751f\u6210\u5f0f AI \u6a21\u578b\u7684\u6027\u80fd\u3002\u7cfb\u7d71\u6703\u91dd\u5c0d\u60a8\u63d0\u4f9b\u7684\u8a55\u4f30\u6578\u64da\u96c6\uff0c\u4f7f\u7528\u4e00\u7d44\u6307\u6a19\u4f86\u8a55\u4f30\u6a21\u578b\u3002\u672c\u9801\u9762\u4ecb\u7d39\u4e86\u6a21\u578b\u8a55\u4f30\u7684\u5de5\u4f5c\u539f\u7406\u3001\u5982\u4f55\u5275\u5efa\u8a55\u4f30\u6578\u64da\u96c6\u4e26\u8a2d\u7f6e\u683c\u5f0f\uff0c\u4ee5\u53ca\u5982\u4f55\u4f7f\u7528 Google Cloud \u63a7\u5236\u6aaf\u3001Vertex AI API \u6216 Python \u7248 Vertex AI SDK \u57f7\u884c\u8a55\u4f30\u3002\n", "content": "## \u6a21\u578b\u8a55\u4f30\u7684\u5de5\u4f5c\u539f\u7406\n\u5982\u9700\u8a55\u4f30\u6a21\u578b\u7684\u6027\u80fd\uff0c\u8acb\u5148\u5275\u5efa\u5305\u542b\u63d0\u793a\u548c\u6a19\u6e96\u7b54\u6848\u5c0d\u7684\u8a55\u4f30\u6578\u64da\u96c6\u3002\u5c0d\u65bc\u6bcf\u500b\u5c0d\uff0c\u63d0\u793a\u662f\u8981\u8a55\u4f30\u7684\u8f38\u5165\uff0c\u6a19\u6e96\u7b54\u6848\u662f\u8a72\u63d0\u793a\u7684\u7406\u60f3\u56de\u7b54\u3002\u5728\u8a55\u4f30\u904e\u7a0b\u4e2d\uff0c\u8a55\u4f30\u6578\u64da\u96c6\u7684\u6bcf\u500b\u5c0d\u4e2d\u7684\u63d0\u793a\u6703\u50b3\u905e\u7d66\u6a21\u578b\u4ee5\u751f\u6210\u8f38\u51fa\u3002\u6a21\u578b\u751f\u6210\u7684\u8f38\u51fa\u548c\u4f86\u81ea\u8a55\u4f30\u6578\u64da\u96c6\u7684\u6a19\u6e96\u7b54\u6848\u7528\u65bc\u8a08\u7b97\u8a55\u4f30\u6307\u6a19\u3002\n\u7528\u65bc\u8a55\u4f30\u7684\u6307\u6a19\u985e\u578b\u53d6\u6c7a\u65bc\u60a8\u6240\u8a55\u4f30\u7684\u4efb\u52d9\u3002\u4e0b\u8868\u986f\u793a\u4e86\u652f\u6301\u7684\u4efb\u52d9\u4ee5\u53ca\u7528\u65bc\u8a55\u4f30\u6bcf\u7a2e\u4efb\u52d9\u7684\u6307\u6a19\uff1a\n| \u4efb\u52d9  | \u6307\u6a19        |\n|:---------|:---------------------------------|\n| \u5206\u985e  | Micro-F1\u3001Macro-F1\u3001Per class F1 |\n| \u6458\u8981  | ROUGE-L       |\n| \u554f\u984c\u56de\u7b54 | \u5b8c\u5168\u5339\u914d       |\n| \u6587\u672c\u751f\u6210 | BLEU\u3001ROUGE-L     |\n## \u652f\u6301\u7684\u6a21\u578b\n`text-bison` \u7684\u57fa\u672c\u7248\u672c\u548c\u8abf\u512a\u5f8c\u7248\u672c\u652f\u6301\u6a21\u578b\u8a55\u4f30\u3002\n## \u6e96\u5099\u8a55\u4f30\u6578\u64da\u96c6\n\u7528\u65bc\u6a21\u578b\u8a55\u4f30\u7684\u8a55\u4f30\u6578\u64da\u96c6\u5305\u542b\u8207\u60a8\u8981\u8a55\u4f30\u7684\u4efb\u52d9\u76f8\u914d\u7684\u63d0\u793a\u548c\u6a19\u6e96\u7b54\u6848\u5c0d\u3002\u6578\u64da\u96c6\u5fc5\u9808\u81f3\u5c11\u5305\u542b\u4e00\u500b\u63d0\u793a\u548c\u6a19\u6e96\u7b54\u6848\u5c0d\uff1b\u7232\u7372\u5f97\u6709\u610f\u7fa9\u7684\u6307\u6a19\uff0c\u81f3\u5c11\u5305\u542b 10 \u500b\u5c0d\u3002\u60a8\u63d0\u4f9b\u7684\u6a23\u672c\u8d8a\u591a\uff0c\u7d50\u679c\u5c31\u8d8a\u6709\u610f\u7fa9\u3002\n### \u6578\u64da\u96c6\u683c\u5f0f\n\u60a8\u7684\u8a55\u4f30\u6578\u64da\u96c6\u5fc5\u9808\u63a1\u7528 [JSON \u884c](https://jsonlines.org/) (JSONL) \u683c\u5f0f\uff0c\u5176\u4e2d\u6bcf\u884c\u5305\u542b\u5206\u5225\u5728 `input_text` \u548c `output_text` \u5b57\u6bb5\u4e2d\u6307\u5b9a\u7684\u55ae\u500b\u63d0\u793a\u548c\u6a19\u6e96\u7b54\u6848\u5c0d\u3002 `input_text` \u5b57\u6bb5\u5305\u542b\u60a8\u8981\u8a55\u4f30\u7684\u63d0\u793a\uff0c `output_text` \u5b57\u6bb5\u5305\u542b\u8a72\u63d0\u793a\u7684\u7406\u60f3\u56de\u7b54\u3002\n`input_text` \u7684\u8a5e\u5143\u9577\u5ea6\u4e0a\u9650\u7232 8,192\uff0c `output_text` \u7684\u8a5e\u5143\u9577\u5ea6\u4e0a\u9650\u7232 1,024\u3002\n```\n{\"input_text\": \"Multi-choice problem: What is the topic of this text? OPTIONS: -nature - news - politics - sports - health - startups TEXT: #DYK In 2015, theworld produced 322M tonnes of plastic. That equals 900 Empire State Buildings!Act:\\u2026 https://t.co/qGrpumIN20\", \"output_text\": \"nature\"}{\"input_text\": \"Multi-choice problem: What is the topic of this text? OPTIONS: -nature - news - politics - sports - health - startups TEXT: Do you agree withChris Pratt? https://t.co/1q43CvIWAY https://t.co/zcKnTa9hKS\", \"output_text\":\"news\"}{\"input_text\": \"Multi-choice problem: What is the topic of this text? OPTIONS: -nature - news - politics - sports - health - startups TEXT: Cahill and DiegoCosta aren't far away from getting their head on Hazard's corner. Meanwhile,Ibe has replaced Pugh for Bournemouth. #BOUCHE\", \"output_text\": \"sports\"}{\"input_text\": \"Multi-choice problem: What is the topic of this text? OPTIONS: -nature - news - politics - sports - health - startups TEXT: Protecting ouroceans is integral to protecting the global environment #EarthDayhttps://t.co/CN5NHKFbsB\", \"output_text\": \"nature\"}{\"input_text\": \"Multi-choice problem: What is the topic of this text? OPTIONS: -nature - news - politics - sports - health - startups TEXT: Scientists havefound that water is gushing across Antarctica \\u2014 more than they everrealized:\\u2026 https://t.co/ttBGA15w5G\", \"output_text\": \"news\"}\n```\n```\n{\"input_text\": \"What is the capital of Australia?\", \"output_text\": \"Canberra\"}{\"input_text\": \"Who is the author of The Great Gatsby?\", \"output_text\": \"F. ScottFitzgerald\"}{\"input_text\": \"What is the highest mountain in the world?\", \"output_text\":\"Mount Everest\"}{\"input_text\": \"What is the largest country in South America?\", \"output_text\":\"Brazil\"}{\"input_text\": \"Who directed The Godfather?\", \"output_text\": \"Francis FordCoppola\"}\n```\n```\n{\"input_text\":\"Basketball teams in the Midwest.\", \"output_text\":\"There areseveral basketball teams located in the Midwest region of the United States.Here are some of them:\"}{\"input_text\":\"How to bake gluten-free bread?\", \"output_text\":\"Baking gluten-freebread can be a bit challenging because gluten is the protein that gives breadits structure and elasticity.\"}{\"input_text\":\"Want to buy a new phone.\", \"output_text\":\"Great! There are manyfactors to consider when buying a new phone, including your budget, preferredoperating system, desired features, and more. Here are some general steps tofollow to help you make an informed decision:\"}{\"input_text\":\"I told them \\\"see you tomorrow\\\"\", \"output_text\":\"If you toldsomeone \\\"see you tomorrow,\\\" you most likely meant that you will see them thefollowing day. This is a common phrase used when saying goodbye to someonewith the intention of seeing them again soon. If you are unable to meet withthem as planned, it is always polite to let them know as soon as possible sothat they are not left waiting or wondering.\"}{\"input_text\":\"Apples are red\\nOranges are orange\", \"output_text\":\"Yes, applesare often red, although there are other varieties of apples that can be green,yellow, or a combination of these colors. Oranges are typically orange, butthey can also be green or even slightly red depending on their variety andripeness. Colors are an important characteristic of fruits, as they can be anindication of ripeness and nutritional value.\"}\n```\n```\n{\"input_text\": \"Summarize this: The coronavirus pandemic has resulted in a globalhealth crisis, with millions of people infected and hundreds of thousands ofdeaths. Governments and healthcare organizations around the world are workingto contain the spread of the virus and develop effective treatments andvaccines. In addition to the health impacts, the pandemic has also had majoreconomic and social consequences, with many businesses forced to shut down andpeople facing unemployment and financial hardship.\", \"output_text\": \"Thecoronavirus pandemic has caused a global health crisis, with governments andhealthcare organizations working to contain the virus and develop treatmentsand vaccines. The pandemic has also had major economic and socialconsequences, with businesses shutting down and people facing financialhardship.\"}{\"input_text\": \"Summarize this: The United States has a long and complicatedhistory of race relations, with racism and discrimination affecting manyaspects of society. In recent years, there have been numerous protests andmovements calling for racial justice and equality. These efforts have broughtrenewed attention to issues such as police brutality, mass incarceration, andsystemic inequality.\", \"output_text\": \"The United States has a history ofracism and discrimination, with recent protests calling for racial justice andequality. Issues such as police brutality, mass incarceration, and systemicinequality have been brought to the forefront.\"}{\"input_text\": \"Summarize this: Climate change is a pressing global issue, withrising temperatures and sea levels posing significant threats to ecosystemsand human societies. Many governments and organizations are taking steps toreduce greenhouse gas emissions and transition to cleaner sources of energy.However, there is still much work to be done to address the root causes ofclimate change and mitigate its impacts.\", \"output_text\": \"Climate change isa global issue, with rising temperatures and sea levels posing significantthreats. Many governments and organizations are taking steps to reducegreenhouse gas emissions, but more work needs to be done to address the rootcauses and mitigate the impacts.\"}{\"input_text\": \"Summarize this: Artificial intelligence and machine learning arerapidly advancing fields with many potential applications in industry,healthcare, and other sectors. However, there are also concerns about theethical implications of AI and the potential for these technologies toexacerbate existing inequalities. As AI continues to evolve, it will beimportant to ensure that its development and use are guided by principles offairness and accountability.\", \"output_text\": \"Artificial intelligence andmachine learning have many potential applications, but there are also concernsabout the ethical implications and potential for exacerbating existinginequalities. It will be important to ensure that AI development and use areguided by principles of fairness and accountability.\"}\n```\n## \u5c07\u8a55\u4f30\u6578\u64da\u96c6\u4e0a\u50b3\u5230 Cloud Storage\n\u60a8\u53ef\u4ee5 [\u5275\u5efa\u65b0\u7684 Cloud Storage \u5b58\u5132\u6876](https://cloud.google.com/storage/docs/creating-buckets?hl=zh-cn#create_a_new_bucket) \uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528\u73fe\u6709\u5b58\u5132\u6876\u4f86\u5b58\u5132\u6578\u64da\u96c6\u6587\u4ef6\u3002\u5b58\u5132\u6876\u5fc5\u9808\u8207\u6a21\u578b\u4f4d\u65bc\u540c\u4e00\u5340\u57df\u3002\n\u5b58\u5132\u6876\u6e96\u5099\u5c31\u7dd2\u5f8c\uff0c\u5c07\u6578\u64da\u96c6\u6587\u4ef6 [\u4e0a\u50b3](https://cloud.google.com/storage/docs/creating-buckets?hl=zh-cn#create_a_new_bucket) \u5230\u5b58\u5132\u6876\u3002\n## \u57f7\u884c\u6a21\u578b\u8a55\u4f30\n\u60a8\u53ef\u4ee5\u4f7f\u7528 REST API \u6216 Google Cloud \u63a7\u5236\u6aaf\u8a55\u4f30\u6a21\u578b\u3002\n\u5982\u9700\u5275\u5efa\u6a21\u578b\u8a55\u4f30\u4f5c\u696d\uff0c\u8acb\u4f7f\u7528 [pipelineJobs](https://cloud.google.com/vertex-ai/docs/reference/rest/v1/projects.locations.pipelineJobs/create?hl=zh-cn) \u65b9\u6cd5\u767c\u9001 `POST` \u8acb\u6c42\u3002\n\u5728\u4f7f\u7528\u4efb\u4f55\u8acb\u6c42\u6578\u64da\u4e4b\u524d\uff0c\u8acb\u5148\u9032\u884c\u4ee5\u4e0b\u66ff\u63db\uff1a- \uff1a\u904b\u884c\u6d41\u6c34\u7dda\u7d44\u4ef6\u7684 Google Cloud \u9805\u76ee\u3002\n- \uff1apipelineJob \u7684\u986f\u793a\u540d\u7a31\u3002\n- \uff1a\u9700\u8981\u5728\u5176\u4e2d\u904b\u884c\u6d41\u6c34\u7dda\u7d44\u4ef6\u7684\u5340\u57df\u3002\u76ee\u524d\u53ea\u652f\u6301`us-central1`\u3002\n- \uff1a\u53c3\u8003\u6578\u64da\u96c6\u7684 Cloud Storage URI\u3002\u60a8\u53ef\u4ee5\u6307\u5b9a\u4e00\u500b\u6216\u591a\u500b URI\u3002\u6b64\u53c3\u6578\u652f\u6301 [\u901a\u914d\u7b26](https://cloud.google.com/storage/docs/gsutil/addlhelp/WildcardNames?hl=zh-cn) \u3002\u5982\u9700\u8a73\u7d30\u77ad\u89e3\u6b64\u53c3\u6578\uff0c\u8acb\u53c3\u95b1 [InputConfig](https://cloud.google.com/vertex-ai/docs/reference/rest/v1/projects.locations.batchPredictionJobs?hl=zh-cn#InputConfig) \u3002\n- \uff1a\u7528\u65bc\u5b58\u5132\u8a55\u4f30\u8f38\u51fa\u7684 Cloud Storage URI\u3002\n- \uff1a\u6307\u5b9a\u767c\u4f48\u65b9\u6a21\u578b\u6216\u7d93\u904e\u8abf\u6574\u7684\u6a21\u578b\u8cc7\u6e90\uff0c\u5982\u4e0b\u6240\u793a\uff1a- **\u767c\u4f48\u65b9\u6a21\u578b** \uff1a`publishers/google/models/` `` `@` ``\u793a\u4f8b\uff1a `publishers/google/models/text-bison@001`\n- **\u7d93\u8abf\u6574\u7684\u6a21\u578b** \uff1a`projects/` `` `/locations/` `` `/models/` ``\u793a\u4f8b\uff1a `projects/123456789012/locations/us-central1/models/1234567890123456789`\n\u8a55\u4f30\u4f5c\u696d\u4e0d\u6703\u5f71\u97ff\u6a21\u578b\u6216\u5176\u8cc7\u6e90\u7684\u4efb\u4f55\u73fe\u6709\u90e8\u7f72\u3002\n- \uff1a\u8981\u8a55\u4f30\u6a21\u578b\u7684\u4efb\u52d9\u3002\u8a55\u4f30\u4f5c\u696d\u6703\u8a08\u7b97\u4e00\u7d44\u8207\u8a72\u7279\u5b9a\u4efb\u52d9\u76f8\u95dc\u7684\u6307\u6a19\u3002\u53ef\u63a5\u53d7\u7684\u503c\u5305\u62ec\uff1a- `summarization`\n- `question-answering`\n- `text-generation`\n- `classification`\n- \uff1a\u6578\u64da\u96c6\u7684\u683c\u5f0f\u3002\u76ee\u524d\u53ea\u652f\u6301`jsonl`\u3002\u5982\u9700\u8a73\u7d30\u77ad\u89e3\u6b64\u53c3\u6578\uff0c\u8acb\u53c3\u95b1 [InputConfig](https://cloud.google.com/vertex-ai/docs/reference/rest/v1/projects.locations.batchPredictionJobs?hl=zh-cn#InputConfig) \u3002\n- \uff1a\u8a55\u4f30\u8f38\u51fa\u7684\u683c\u5f0f\u3002\u76ee\u524d\u53ea\u652f\u6301`jsonl`\u3002\u5982\u9700\u8a73\u7d30\u77ad\u89e3\u6b64\u53c3\u6578\uff0c\u8acb\u53c3\u95b1 [InputConfig](https://cloud.google.com/vertex-ai/docs/reference/rest/v1/projects.locations.batchPredictionJobs?hl=zh-cn#InputConfig) \u3002\n- \uff1a\uff08\u53ef\u9078\uff09\u7528\u65bc\u904b\u884c\u8a55\u4f30\u4f5c\u696d\u7684\u6a5f\u5668\u985e\u578b\u3002\u9ed8\u8a8d\u503c\u7232`e2-highmem-16`\u3002\u5982\u9700\u67e5\u770b\u652f\u6301\u7684\u6a5f\u5668\u985e\u578b\u7684\u5217\u8868\uff0c\u8acb\u53c3\u95b1 [\u6a5f\u5668\u985e\u578b](https://cloud.google.com/vertex-ai/docs/training/configure-compute?hl=zh-cn#machine-types) \u3002\n- \uff1a\uff08\u53ef\u9078\uff09\u7528\u65bc\u904b\u884c\u8a55\u4f30\u4f5c\u696d\u7684\u670d\u52d9\u8cec\u865f\u3002\u5982\u9700\u77ad\u89e3\u5982\u4f55\u5275\u5efa\u81ea\u5b9a\u7fa9\u670d\u52d9\u8cec\u865f\uff0c\u8acb\u53c3\u95b1 [\u914d\u7f6e\u5177\u6709\u7cbe\u7d30\u6b0a\u9650\u7684\u670d\u52d9\u8cec\u865f](https://cloud.google.com/vertex-ai/docs/pipelines/configure-project?hl=zh-cn#service-account) \u3002\u5982\u679c\u672a\u6307\u5b9a\uff0c\u7cfb\u7d71\u6703\u4f7f\u7528 [Vertex AI Custom Code Service Agent](https://cloud.google.com/vertex-ai/docs/general/access-control?hl=zh-cn#service-agents) \u3002\n- \uff1a\uff08\u53ef\u9078\uff09\u8981\u8207\u8a55\u4f30\u4f5c\u696d\u5c0d\u7b49\u4e92\u9023\u7684 Compute Engine \u7db2\u7d61\u7684\u5b8c\u5168\u9650\u5b9a\u540d\u7a31\u3002\u7db2\u7d61\u540d\u7a31\u7684\u683c\u5f0f\u7232`projects/` `` `/global/networks/` ``\u3002\u5982\u679c\u60a8\u6307\u5b9a\u6b64\u5b57\u6bb5\uff0c\u5247\u9700\u8981\u64c1\u6709 [\u9069\u7528\u65bc Vertex AI \u4e0a\u7684\u751f\u6210\u5f0f AI \u7684 VPC \u7db2\u7d61\u5c0d\u7b49\u4e92\u9023](https://cloud.google.com/vertex-ai/docs/general/vpc-peering?hl=zh-cn) \u3002\u5982\u679c\u672a\u6307\u5b9a\uff0c\u5247\u8a55\u4f30\u4f5c\u696d\u4e0d\u8207\u4efb\u4f55\u7db2\u7d61\u5c0d\u7b49\u4e92\u9023\u3002\n- \uff1a\uff08\u53ef\u9078\uff09\u5ba2\u6236\u7ba1\u7406\u7684\u52a0\u5bc6\u5bc6\u9470 (CMEK) \u7684\u540d\u7a31\u3002\u5982\u679c\u5df2\u914d\u7f6e\uff0c\u5247\u4f7f\u7528\u63d0\u4f9b\u7684\u52a0\u5bc6\u5bc6\u9470\u5c0d\u8a55\u4f30\u4f5c\u696d\u5275\u5efa\u7684\u8cc7\u6e90\u9032\u884c\u52a0\u5bc6\u3002\u5bc6\u9470\u540d\u7a31\u7684\u683c\u5f0f\u7232`projects/` `` `/locations/` `` `/keyRings/` `` `/cryptoKeys/` ``\u3002\u5bc6\u9470\u9700\u8981\u8207\u8a55\u4f30\u4f5c\u696d\u8655\u65bc\u540c\u4e00\u5340\u57df\u3002\nHTTP \u65b9\u6cd5\u548c\u7db2\u5740\uff1a\n```\nPOST https://LOCATION-aiplatform.googleapis.com/v1/projects/PROJECT_ID/locations/LOCATION/pipelineJobs\n```\n\u8acb\u6c42 JSON \u6b63\u6587\uff1a\n```\n{\n \"displayName\": \"PIPELINEJOB_DISPLAYNAME\",\n \"runtimeConfig\": {\n \"gcsOutputDirectory\": \"gs://OUTPUT_DIR\",\n \"parameterValues\": {\n  \"project\": \"PROJECT_ID\",\n  \"location\": \"LOCATION\",\n  \"batch_predict_gcs_source_uris\": [\"gs://DATASET_URI\"],\n  \"batch_predict_gcs_destination_output_uri\": \"gs://OUTPUT_DIR\",\n  \"model_name\": \"MODEL_NAME\",\n  \"evaluation_task\": \"EVALUATION_TASK\",\n  \"batch_predict_instances_format\": \"INSTANCES_FORMAT\",\n  \"batch_predict_predictions_format: \"PREDICTIONS_FORMAT\",\n  \"machine_type\": \"MACHINE_TYPE\",\n  \"service_account\": \"SERVICE_ACCOUNT\",\n  \"network\": \"NETWORK\",\n  \"encryption_spec_key_name\": \"KEY_NAME\"\n }\n },\n \"templateUri\": \"https://us-kfp.pkg.dev/vertex-evaluation/pipeline-templates/evaluation-llm-text-generation-pipeline/1.0.1\"\n}\n```\n\u5982\u9700\u767c\u9001\u8acb\u6c42\uff0c\u8acb\u9078\u64c7\u4ee5\u4e0b\u65b9\u5f0f\u4e4b\u4e00\uff1a\n **\u6ce8\u610f** \uff1a\u4ee5\u4e0b\u547d\u4ee4\u5047\u5b9a\u60a8\u5df2\u4f7f\u7528\u60a8\u7684\u7528\u6236\u8cec\u865f\u901a\u904e\u904b\u884c [gcloud init](https://cloud.google.com/sdk/gcloud/reference/init?hl=zh-cn) \u6216 [gcloud auth login](https://cloud.google.com/sdk/gcloud/reference/auth/login?hl=zh-cn) \u767b\u9304`gcloud`CLI\uff0c\u6216\u8005\u4f7f\u7528\u4e86 [Cloud Shell](https://cloud.google.com/shell/docs?hl=zh-cn) \uff0c\u9019\u6703\u4f7f\u60a8\u81ea\u52d5\u767b\u9304`gcloud`CLI\u3002\u60a8\u53ef\u4ee5\u904b\u884c [gcloud auth list](https://cloud.google.com/sdk/gcloud/reference/auth/list?hl=zh-cn) \u4f86\u6aa2\u67e5\u7576\u524d\u6d3b\u8e8d\u7684\u8cec\u865f\u3002\n\u5c07\u8acb\u6c42\u6b63\u6587\u4fdd\u5b58\u5728\u540d\u7232 `request.json` \u7684\u6587\u4ef6\u4e2d\uff0c\u7136\u5f8c\u57f7\u884c\u4ee5\u4e0b\u547d\u4ee4\uff1a\n```\ncurl -X POST \\ -H \"Authorization: Bearer $(gcloud auth print-access-token)\" \\ -H \"Content-Type: application/json; charset=utf-8\" \\ -d @request.json \\ \"https://LOCATION-aiplatform.googleapis.com/v1/projects/PROJECT_ID/locations/LOCATION/pipelineJobs\"\n``` **\u6ce8\u610f** \uff1a\u4ee5\u4e0b\u547d\u4ee4\u5047\u5b9a\u60a8\u5df2\u4f7f\u7528\u60a8\u7684\u7528\u6236\u8cec\u865f\u901a\u904e\u904b\u884c [gcloud init](https://cloud.google.com/sdk/gcloud/reference/init?hl=zh-cn) \u6216 [gcloud auth login](https://cloud.google.com/sdk/gcloud/reference/auth/login?hl=zh-cn) \u767b\u9304`gcloud`CLI\uff0c\u6216\u8005\u4f7f\u7528\u4e86 [Cloud Shell](https://cloud.google.com/shell/docs?hl=zh-cn) \uff0c\u9019\u6703\u4f7f\u60a8\u81ea\u52d5\u767b\u9304`gcloud`CLI\u3002\u60a8\u53ef\u4ee5\u904b\u884c [gcloud auth list](https://cloud.google.com/sdk/gcloud/reference/auth/list?hl=zh-cn) \u4f86\u6aa2\u67e5\u7576\u524d\u6d3b\u8e8d\u7684\u8cec\u865f\u3002\n\u5c07\u8acb\u6c42\u6b63\u6587\u4fdd\u5b58\u5728\u540d\u7232 `request.json` \u7684\u6587\u4ef6\u4e2d\uff0c\u7136\u5f8c\u57f7\u884c\u4ee5\u4e0b\u547d\u4ee4\uff1a\n```\n$cred = gcloud auth print-access-token$headers = @{ \"Authorization\" = \"Bearer $cred\" }Invoke-WebRequest ` -Method POST ` -Headers $headers ` -ContentType: \"application/json; charset=utf-8\" ` -InFile request.json ` -Uri \"https://LOCATION-aiplatform.googleapis.com/v1/projects/PROJECT_ID/locations/LOCATION/pipelineJobs\" | Select-Object -Expand Content\n```\n\u60a8\u61c9\u8a72\u6536\u5230\u985e\u4f3c\u4ee5\u4e0b\u5167\u5bb9\u7684 JSON \u97ff\u61c9\u3002\u8acb\u6ce8\u610f\uff0c\u7232\u7bc0\u7701\u7a7a\u9593\uff0c\u7cfb\u7d71\u622a\u65b7\u4e86 `pipelineSpec` \u3002```\nPROJECT_ID=myprojectREGION=us-central1MODEL_NAME=publishers/google/models/text-bison@001TEST_DATASET_URI=gs://my-gcs-bucket-uri/dataset.jsonlOUTPUT_DIR=gs://my-gcs-bucket-uri/outputcurl \\-X POST \\-H \"Authorization: Bearer $(gcloud auth print-access-token)\" \\-H \"Content-Type: application/json; charset=utf-8\" \\\"https://${REGION}-aiplatform.googleapis.com/v1/projects/${PROJECT_ID}/locations/${REGION}/pipelineJobs\" -d \\$'{\u00a0 \"displayName\": \"evaluation-llm-text-generation-pipeline\",\u00a0 \"runtimeConfig\": {\u00a0 \u00a0 \"gcsOutputDirectory\": \"'${OUTPUT_DIR}'\",\u00a0 \u00a0 \"parameterValues\": {\u00a0 \u00a0 \u00a0 \"project\": \"'${PROJECT_ID}'\",\u00a0 \u00a0 \u00a0 \"location\": \"'${REGION}'\",\u00a0 \u00a0 \u00a0 \"batch_predict_gcs_source_uris\": [\"'${TEST_DATASET_URI}'\"],\u00a0 \u00a0 \u00a0 \"batch_predict_gcs_destination_output_uri\": \"'${OUTPUT_DIR}'\",\u00a0 \u00a0 \u00a0 \"model_name\": \"'${MODEL_NAME}'\",\u00a0 \u00a0 }\u00a0 },\u00a0 \"templateUri\": \"https://us-kfp.pkg.dev/vertex-evaluation/pipeline-templates/evaluation-llm-text-generation-pipeline/1.0.1\"}'\n```\u5982\u9700\u77ad\u89e3\u5982\u4f55\u5b89\u88dd\u6216\u66f4\u65b0 Python\uff0c\u8acb\u53c3\u95b1 [\u5b89\u88dd Python \u7248 Vertex AI SDK](https://cloud.google.com/vertex-ai/docs/start/use-vertex-ai-python-sdk?hl=zh-cn) \u3002  \u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [   Python API \u53c3\u8003\u6587\u6a94](https://cloud.google.com/python/docs/reference/aiplatform/latest?hl=zh-cn) \u3002\n [\u5728 GitHub \u4e0a\u67e5\u770b](https://github.com/GoogleCloudPlatform/python-docs-samples/blob/HEAD/generative_ai/evaluate_model.py) \n```\nfrom google.auth import defaultimport vertexaifrom vertexai.preview.language_models import (\u00a0 \u00a0 EvaluationTextClassificationSpec,\u00a0 \u00a0 TextGenerationModel,)# Set credentials for the pipeline components used in the evaluation taskcredentials, _ = default(scopes=[\"https://www.googleapis.com/auth/cloud-platform\"])def evaluate_model(\u00a0 \u00a0 project_id: str,\u00a0 \u00a0 location: str,) -> object:\u00a0 \u00a0 \"\"\"Evaluate the performance of a generative AI model.\"\"\"\u00a0 \u00a0 vertexai.init(project=project_id, location=location, credentials=credentials)\u00a0 \u00a0 # Create a reference to a generative AI model\u00a0 \u00a0 model = TextGenerationModel.from_pretrained(\"text-bison@002\")\u00a0 \u00a0 # Define the evaluation specification for a text classification task\u00a0 \u00a0 task_spec = EvaluationTextClassificationSpec(\u00a0 \u00a0 \u00a0 \u00a0 ground_truth_data=[\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"gs://cloud-samples-data/ai-platform/generative_ai/llm_classification_bp_input_prompts_with_ground_truth.jsonl\"\u00a0 \u00a0 \u00a0 \u00a0 ],\u00a0 \u00a0 \u00a0 \u00a0 class_names=[\"nature\", \"news\", \"sports\", \"health\", \"startups\"],\u00a0 \u00a0 \u00a0 \u00a0 target_column_name=\"ground_truth\",\u00a0 \u00a0 )\u00a0 \u00a0 # Evaluate the model\u00a0 \u00a0 eval_metrics = model.evaluate(task_spec=task_spec)\u00a0 \u00a0 print(eval_metrics)\u00a0 \u00a0 return eval_metrics\n```\u5982\u9700\u4f7f\u7528 Google Cloud \u63a7\u5236\u6aaf\u5275\u5efa\u6a21\u578b\u8a55\u4f30\u4f5c\u696d\uff0c\u8acb\u57f7\u884c\u4ee5\u4e0b\u6b65\u9a5f\uff1a- \u5728 Google Cloud \u63a7\u5236\u6aaf\u7684\u201c\u751f\u6210\u5f0f AI\u201d\u90e8\u5206\uff0c\u8f49\u5230 **Vertex AI Model Registry** \u9801\u9762\u3002 [\u8f49\u5230 Vertex AI Model Registry](https://console.cloud.google.com/vertex-ai/models?hl=zh-cn) \n- \u9ede\u64ca\u8981\u8a55\u4f30\u7684\u6a21\u578b\u7684\u540d\u7a31\u3002\n- \u5728 **\u8a55\u4f30** \u6a19\u7c64\u9801\u4e2d\uff0c\u9ede\u64ca **\u5275\u5efa\u8a55\u4f30** \uff0c\u7136\u5f8c\u6309\u5982\u4e0b\u65b9\u5f0f\u9032\u884c\u914d\u7f6e\uff1a\n- **\u76ee\u6a19** \uff1a\u9078\u64c7\u8981\u8a55\u4f30\u7684\u4efb\u52d9\u3002\n- **\u76ee\u6a19\u5217\u6216\u5b57\u6bb5** \uff1a\uff08\u50c5\u9650\u5206\u985e\uff09\u8f38\u5165\u9032\u884c\u9810\u6e2c\u7684\u76ee\u6a19\u5217\u3002\u793a\u4f8b\uff1a`ground_truth`\u3002\n- **\u4f86\u6e90\u8def\u5f91** \uff1a\u8f38\u5165\u6216\u9078\u64c7\u8a55\u4f30\u6578\u64da\u96c6\u7684 URI\u3002\n- **\u8f38\u51fa\u683c\u5f0f** \uff1a\u8f38\u5165\u8a55\u4f30\u8f38\u51fa\u7684\u683c\u5f0f\u3002\u76ee\u524d\u53ea\u652f\u6301`jsonl`\u3002\n- **Cloud Storage \u8def\u5f91** \uff1a\u8f38\u5165\u6216\u9078\u64c7\u7528\u65bc\u5b58\u5132\u8a55\u4f30\u8f38\u51fa\u7684 URI\u3002\n- **\u985e\u5225\u540d\u7a31** \uff1a\uff08\u50c5\u9650\u5206\u985e\uff09\u8f38\u5165\u53ef\u80fd\u7684\u985e\u5225\u540d\u7a31\u7684\u5217\u8868\u3002\n- **\u8a08\u7b97\u7bc0\u9ede\u6578** \uff1a\u8f38\u5165\u8981\u7528\u65bc\u904b\u884c\u8a55\u4f30\u4f5c\u696d\u7684\u8a08\u7b97\u7bc0\u9ede\u6578\u3002\n- **\u6a5f\u5668\u985e\u578b** \uff1a\u9078\u64c7\u8981\u7528\u65bc\u904b\u884c\u8a55\u4f30\u4f5c\u696d\u7684\u6a5f\u5668\u985e\u578b\u3002\n- \u9ede\u64ca **\u958b\u59cb\u8a55\u4f30** \n## \u67e5\u770b\u8a55\u4f30\u7d50\u679c\n\u60a8\u53ef\u4ee5\u5728\u5275\u5efa\u8a55\u4f30\u4f5c\u696d\u6642\u6307\u5b9a\u7684 Cloud Storage \u8f38\u51fa\u76ee\u9304\u4e2d\u627e\u5230\u8a55\u4f30\u7d50\u679c\u3002\u8a72\u6587\u4ef6\u7684\u540d\u7a31\u7232 `evaluation_metrics.json` \u3002\n\u5c0d\u65bc\u7d93\u904e\u8abf\u512a\u7684\u6a21\u578b\uff0c\u60a8\u9084\u53ef\u4ee5\u5728 Google Cloud \u63a7\u5236\u6aaf\u4e2d\u67e5\u770b\u8a55\u4f30\u7d50\u679c\uff1a\n- \u5728 Google Cloud \u63a7\u5236\u6aaf\u7684\u201c\u751f\u6210\u5f0f AI\u201d\u90e8\u5206\uff0c\u8f49\u5230 **Vertex AI Model Registry** \u9801\u9762\u3002 [\u8f49\u5230 Vertex AI Model Registry](https://console.cloud.google.com/vertex-ai/models?hl=zh-cn) \n- \u9ede\u64ca\u8981\u67e5\u770b\u5176\u8a55\u4f30\u6307\u6a19\u7684\u6a21\u578b\u7684\u540d\u7a31\u3002\n- \u5728 **\u8a55\u4f30** \u6a19\u7c64\u9801\u4e2d\uff0c\u9ede\u64ca\u8981\u67e5\u770b\u7684\u8a55\u4f30\u904b\u884c\u7684\u540d\u7a31\u3002## \u5f8c\u7e8c\u6b65\u9a5f\n- \u77ad\u89e3 [\u81ea\u52d5\u4e26\u6392\u8a55\u4f30](https://cloud.google.com/vertex-ai/generative-ai/docs/models/side-by-side-eval?hl=zh-cn) \u3002\n- \u77ad\u89e3\u5982\u4f55 [\u8abf\u6574\u57fa\u790e\u6a21\u578b](https://cloud.google.com/vertex-ai/generative-ai/docs/models/tune-models?hl=zh-cn) \u3002", "guide": "Generative AI on Vertex AI"}