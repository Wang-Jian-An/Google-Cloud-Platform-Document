{"title": "Generative AI on Vertex AI - Use Visual Question Answering (VQA) to get image information", "url": "https://cloud.google.com/vertex-ai/generative-ai/docs/image/visual-question-answering", "abstract": "# Generative AI on Vertex AI - Use Visual Question Answering (VQA) to get image information\nTo see an example of Visual Question Answering (VQA) using Imagen,  run the \"Visual Question Answering (VQA) with Imagen on Vertex AI\" Jupyter notebook in one of the following  environments: [Openin Colab](https://colab.research.google.com/github/GoogleCloudPlatform/generative-ai/blob/main/vision/getting-started/visual_question_answering.ipynb) | [Openin Vertex AI Workbench user-managed notebooks](https://console.cloud.google.com/vertex-ai/workbench/deploy-notebook?download_url=https%3A%2F%2Fraw.githubusercontent.com%2FGoogleCloudPlatform%2Fgenerative-ai%2Fmain%2Fvision%2Fgetting-started%2Fvisual_question_answering.ipynb) | [View on GitHub](https://github.com/GoogleCloudPlatform/generative-ai/blob/main/vision/getting-started/visual_question_answering.ipynb)\nVisual Question Answering (VQA) lets you provide an image to the model and ask a question about the image's contents. In response to your question you get one or more natural language answers.\n", "content": "## Languages supported\nVQA is available in the following languages:\n- English (en)## Performance and limitations\nThe following limits apply when you use this model:\n| Limits                | Value  |\n|:-------------------------------------------------------------------|:----------|\n| Maximum number of API requests (short-form) per minute per project | 500  |\n| Maximum number of tokens returned in response (short-form)   | 64 tokens |\n| Maximum number of tokens accepted in request (VQA short-form only) | 80 tokens |\nThe following service latency estimates apply when you use this model. These values are meant to be illustrative and are not a promise of service:\n| Latency     | Value  |\n|:--------------------------|:------------|\n| API requests (short-form) | 1.5 seconds |\n## Locations\nA location is a [region](/about/locations) you can specify in a request to control where data is stored at rest. For a list of available regions, see [Generative AI on Vertex AI locations](/vertex-ai/generative-ai/docs/learn/locations-genai) .\n## Use VQA on an image (short-form responses)\nUse the following samples to ask a question and get an answer about an image.\n- In the Google Cloud console, open the **Vertex AI Studio > Vision** tab in the Vertex AI dashboard. [Go to the Vertex AI Studio tab](https://console.cloud.google.com/vertex-ai/generative/vision) \n- In the lower menu, click **Visual Q & A** .\n- Click **Upload image** to select your local image to caption.\n- In the **Parameters** panel, choose your **Number of captions** and **Language** .\n- In the prompt field, enter a question about your uploaded image.\n- Click play_arrow **Submit** .\nFor more information about `imagetext` model requests, see the [imagetext model API reference](/vertex-ai/generative-ai/docs/model-reference/visual-question-answering) .\nBefore using any of the request data, make the following replacements:- : Your Google Cloud [project ID](/resource-manager/docs/creating-managing-projects#identifiers) .\n- : Your project's region. For example,`us-central1`,`europe-west2`, or`asia-northeast3`. For a list of available regions, see [Generative AI on Vertex AI locations](/vertex-ai/generative-ai/docs/learn/locations-genai) .\n- : The question you want to get answered about your image.\n- : The image to get captions for. The image must be  specified as a [base64-encoded](/vertex-ai/generative-ai/docs/image/base64-encode) byte string. Size  limit: 10 MB.\n- : The number of answers you want to generate. Accepted integer values: 1-3.\nHTTP method and URL:\n```\nPOST https://LOCATION-aiplatform.googleapis.com/v1/projects/PROJECT_ID/locations/LOCATION/publishers/google/models/imagetext:predict\n```\nRequest JSON body:\n```\n{\n \"instances\": [ {\n  \"prompt\": \"VQA_PROMPT\",\n  \"image\": {\n   \"bytesBase64Encoded\": \"B64_IMAGE\"\n  }\n }\n ],\n \"parameters\": {\n \"sampleCount\": RESPONSE_COUNT\n }\n}\n```\nTo send your request, choose one of these options:\n **Note:** The following command assumes that you have logged in to  the`gcloud`CLI with your user account by running [gcloud init](/sdk/gcloud/reference/init) or [gcloud auth login](/sdk/gcloud/reference/auth/login) ,  or by using [Cloud Shell](/shell/docs) ,  which automatically logs you into the`gcloud`CLI.  You can check the currently active account by running [gcloud auth list](/sdk/gcloud/reference/auth/list) .\nSave the request body in a file named `request.json` ,  and execute the following command:\n```\ncurl -X POST \\ -H \"Authorization: Bearer $(gcloud auth print-access-token)\" \\ -H \"Content-Type: application/json; charset=utf-8\" \\ -d @request.json \\ \"https://LOCATION-aiplatform.googleapis.com/v1/projects/PROJECT_ID/locations/LOCATION/publishers/google/models/imagetext:predict\"\n``` **Note:** The following command assumes that you have logged in to  the`gcloud`CLI with your user account by running [gcloud init](/sdk/gcloud/reference/init) or [gcloud auth login](/sdk/gcloud/reference/auth/login) ,  or by using [Cloud Shell](/shell/docs) ,  which automatically logs you into the`gcloud`CLI.  You can check the currently active account by running [gcloud auth list](/sdk/gcloud/reference/auth/list) .\nSave the request body in a file named `request.json` ,  and execute the following command:\n```\n$cred = gcloud auth print-access-token$headers = @{ \"Authorization\" = \"Bearer $cred\" }Invoke-WebRequest ` -Method POST ` -Headers $headers ` -ContentType: \"application/json; charset=utf-8\" ` -InFile request.json ` -Uri \"https://LOCATION-aiplatform.googleapis.com/v1/projects/PROJECT_ID/locations/LOCATION/publishers/google/models/imagetext:predict\" | Select-Object -Expand Content\n```The following sample responses are for a request with\n`\"sampleCount\": 2`\nand\n`\"prompt\": \"What is this?\"`\n. The response returns two prediction string answers.\n```\n{\n \"predictions\": [ \"cappuccino\",\n \"coffee\"\n ],\n \"deployedModelId\": \"DEPLOYED_MODEL_ID\",\n \"model\": \"projects/PROJECT_ID/locations/LOCATION/models/MODEL_ID\",\n \"modelDisplayName\": \"MODEL_DISPLAYNAME\",\n \"modelVersionId\": \"1\"\n}\n```\nBefore trying this sample, follow the Python setup instructions in the [Vertex AI quickstart using   client libraries](/vertex-ai/docs/start/client-libraries) .       For more information, see the [Vertex AI Python API reference documentation](/python/docs/reference/aiplatform/latest) .\nTo authenticate to Vertex AI, set up Application Default Credentials.  For more information, see [Set up authentication for a local development environment](/docs/authentication/provide-credentials-adc#local-dev) .\nIn this sample you use the `load_from_file` method to reference a local file as the base [Image](/python/docs/reference/aiplatform/latest/vertexai.vision_models.Image) to get information about. After you specify the base image, you use the [ask_question](/python/docs/reference/aiplatform/latest/vertexai.vision_models.ImageTextModel#vertexai_vision_models_ImageTextModel_ask_question) method on the [ImageTextModel](/python/docs/reference/aiplatform/latest/vertexai.vision_models.ImageTextModel) and print the answers.\n [  generative_ai/imagen/get_short_form_image_responses.py ](https://github.com/GoogleCloudPlatform/python-docs-samples/blob/HEAD/generative_ai/imagen/get_short_form_image_responses.py) [View on GitHub](https://github.com/GoogleCloudPlatform/python-docs-samples/blob/HEAD/generative_ai/imagen/get_short_form_image_responses.py) \n```\nimport argparseimport vertexaifrom vertexai.preview.vision_models import Image, ImageTextModeldef get_short_form_image_responses(\u00a0 \u00a0 project_id: str, location: str, input_file: str, question: str) -> list:\u00a0 \u00a0 \"\"\"Get short-form responses to a question about a local image.\u00a0 \u00a0 Args:\u00a0 \u00a0 \u00a0 project_id: Google Cloud project ID, used to initialize Vertex AI.\u00a0 \u00a0 \u00a0 location: Google Cloud region, used to initialize Vertex AI.\u00a0 \u00a0 \u00a0 input_file: Local path to the input image file.\u00a0 \u00a0 \u00a0 question: The question about the contents of the image.\"\"\"\u00a0 \u00a0 vertexai.init(project=project_id, location=location)\u00a0 \u00a0 model = ImageTextModel.from_pretrained(\"imagetext@001\")\u00a0 \u00a0 source_img = Image.load_from_file(location=input_file)\u00a0 \u00a0 answers = model.ask_question(\u00a0 \u00a0 \u00a0 \u00a0 image=source_img,\u00a0 \u00a0 \u00a0 \u00a0 question=question,\u00a0 \u00a0 \u00a0 \u00a0 # Optional parameters\u00a0 \u00a0 \u00a0 \u00a0 number_of_results=1,\u00a0 \u00a0 )\u00a0 \u00a0 print(answers)\u00a0 \u00a0 return answers\n```\n## Use parameters for VQA\nWhen you get VQA responses there are several parameters you can set depending on your use case.\n### Number of results\nUse the number of results parameter to limit the amount of responses returned for each request you send. For more information, see the [imagetext (VQA)model API reference](/vertex-ai/generative-ai/docs/model-reference/image-captioning#request_body) .\n### Seed number\nA number you add to a request to make generated responses deterministic. Adding a seed number with your request is a way to assure you get the same prediction (responses) each time. However, the answers aren't necessarily returned in the same order. For more information, see the [imagetext (VQA) model API reference](/vertex-ai/generative-ai/docs/model-reference/image-captioning#request_body) .\n## What's next\n- View videos describing Vertex AI foundation models including Imagen, the text-to-image foundation model that lets you generate and edit images:- [Introduction to foundation models on Google Cloud](https://youtu.be/YCZ6nwGnL4o) \n- [Imagen on Vertex AI: Create and edit images from text](https://youtu.be/pN-RTBq6i3I) \n- Read blog posts describing Imagen on Vertex AI and Generative AI on Vertex AI:- [Imagen\u00a02 on Vertex AI is now generally available](/blog/products/ai-machine-learning/imagen-2-on-vertex-ai-is-now-generally-available) \n- [Gemini, Google's most capable model, is now available on Vertex AI](/blog/products/ai-machine-learning/gemini-support-on-vertex-ai) \n- [Announcing General Availability of Duet AI for Developers and Duet AI in Security Operations](https://cloud.google.com/blog/products/ai-machine-learning/duet-ai-for-developers-and-in-security-operations-now-ga)", "guide": "Generative AI on Vertex AI"}