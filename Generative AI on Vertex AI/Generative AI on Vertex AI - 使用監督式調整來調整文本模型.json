{"title": "Generative AI on Vertex AI - \u4f7f\u7528\u76e3\u7763\u5f0f\u8abf\u6574\u4f86\u8abf\u6574\u6587\u672c\u6a21\u578b", "url": "https://cloud.google.com/vertex-ai/generative-ai/docs/models/tune-text-models-supervised?hl=zh-cn", "abstract": "# Generative AI on Vertex AI - \u4f7f\u7528\u76e3\u7763\u5f0f\u8abf\u6574\u4f86\u8abf\u6574\u6587\u672c\u6a21\u578b\n\u76e3\u7763\u5f0f\u8abf\u6574\u4f7f\u7528\u6709\u6a19\u7c64\u6a23\u672c\u4f86\u8a13\u7df4\u6a21\u578b\u3002\u6bcf\u500b\u6a23\u672c\u90fd\u6f14\u793a\u4e86\u60a8\u5e0c\u671b\u6587\u672c\u6a21\u578b\u5728\u63a8\u7406\u671f\u9593\u63d0\u4f9b\u7684\u8f38\u51fa\u3002\u5982\u679c\u6a21\u578b\u7684\u8f38\u51fa\u4e26\u975e\u7279\u5225\u8907\u96dc\u4e14\u6613\u65bc\u5b9a\u7fa9\uff0c\u5247\u76e3\u7763\u5f0f\u8abf\u6574\u662f\u500b\u4e0d\u932f\u7684\u9078\u64c7\u3002\u5982\u679c\u6a21\u578b\u7684\u8f38\u51fa\u96e3\u4ee5\u5b9a\u7fa9\uff0c\u8acb\u8003\u616e\u4f7f\u7528 [\u57fa\u65bc\u4eba\u985e\u53cd\u994b\u7684\u5f37\u5316\u5b78\u7fd2 (RLHF) \u8abf\u6574](https://cloud.google.com/vertex-ai/generative-ai/docs/models/tune-text-models-rlhf?hl=zh-cn) \u4f86\u8abf\u6574\u6587\u672c\u6a21\u578b\u3002\n\u5982\u9700\u67e5\u770b\u4f7f\u7528 Python \u7248 Vertex AI SDK \u8abf\u6574\u6587\u672c\u751f\u6210\u57fa\u790e\u6a21\u578b\u7684\u793a\u4f8b\uff0c\u8acb\u5728\u4ee5\u4e0b\u4efb\u4e00\u74b0\u5883\u4e2d\u904b\u884c\u201cVertex AI \u8abf\u6574 PEFT \u6a21\u578b\u201dJupyter \u7b46\u8a18\u672c\uff1a [\u5728 Colab \u4e2d\u6253\u958b](https://colab.research.google.com/github/GoogleCloudPlatform/vertex-ai-samples/blob/main/notebooks/official/generative_ai/tune_peft.ipynb?hl=zh-cn) | [\u5728 Vertex AI Workbench \u7528\u6236\u7ba1\u7406\u7684\u7b46\u8a18\u672c\u4e2d\u6253\u958b](https://console.cloud.google.com/vertex-ai/workbench/deploy-notebook?download_url=https%3A%2F%2Fraw.githubusercontent.com%2FGoogleCloudPlatform%2Fvertex-ai-samples%2Fmain%2Fnotebooks%2Fofficial%2Fgenerative_ai%2Ftune_peft.ipynb&hl=zh-cn) | [\u5728 GitHub \u4e0a\u67e5\u770b](https://github.com/GoogleCloudPlatform/vertex-ai-samples/blob/main/notebooks/official/generative_ai/tune_peft.ipynb)\n", "content": "## \u6587\u672c\u6a21\u578b\u76e3\u7763\u5f0f\u8abf\u6574\u5206\u6b65\u6307\u5357\n\u4ee5\u4e0b\u5f15\u5c0e\u5f0f\u6559\u7a0b\u53ef\u5e6b\u52a9\u60a8\u77ad\u89e3\u5982\u4f55\u4f7f\u7528\u76e3\u7763\u5f0f\u8abf\u6574\u5728 Google Cloud \u63a7\u5236\u6aaf\u4e2d\u8abf\u6574\u6587\u672c\u57fa\u790e\u6a21\u578b\u3002\n\u5982\u9700\u5728 Google Cloud \u63a7\u5236\u6aaf\u4e2d\u76f4\u63a5\u9075\u5faa\u6709\u95dc\u6b64\u4efb\u52d9\u7684\u5206\u6b65\u6307\u5c0e\uff0c\u8acb\u9ede\u64ca **\u64cd\u4f5c\u6f14\u793a** \uff1a\n[\u64cd\u4f5c\u6f14\u793a](https://console.cloud.google.com/?walkthrough_id=prompt_tuning&hl=zh-cn)\n## \u652f\u6301\u7684\u6a21\u578b\n\u4ee5\u4e0b\u6587\u672c\u6a21\u578b\u652f\u6301\u76e3\u7763\u5f0f\u8abf\u6574\uff1a\n- `text-bison@002`\n- `chat-bison@002`\n- `text-bison-32k`\n- `chat-bison-32k`## \u5c0d\u6587\u672c\u6a21\u578b\u4f7f\u7528\u76e3\u7763\u5f0f\u8abf\u6574\u7684\u7528\u4f8b\n\u5982\u679c\u9810\u671f\u8f38\u51fa\u6216\u4efb\u52d9\u53ef\u4ee5\u5728\u63d0\u793a\u4e2d\u6e05\u6670\u4e14\u7c21\u660e\u5730\u5b9a\u7fa9\uff0c\u4e26\u4e14\u63d0\u793a\u59cb\u7d42\u5982\u4e00\u5730\u751f\u6210\u9810\u671f\u8f38\u51fa\uff0c\u5247\u57fa\u790e\u6587\u672c\u6a21\u578b\u6548\u679c\u826f\u597d\u3002\u5982\u679c\u60a8\u5e0c\u671b\u6a21\u578b\u5b78\u7fd2\u504f\u96e2\u5e38\u898f\u8a9e\u8a00\u6a21\u5f0f\u7684\u7279\u5b9a\u9818\u57df\u6216\u7279\u5b9a\u5167\u5bb9\uff0c\u5247\u4e0d\u59a8\u8003\u616e\u8abf\u6574\u8a72\u6a21\u578b\u3002\u4f8b\u5982\uff0c\u60a8\u53ef\u4ee5\u4f7f\u7528\u6a21\u578b\u8abf\u6574\u4f86\u8a13\u7df4\u6a21\u578b\u5b78\u7fd2\u4ee5\u4e0b\u5167\u5bb9\uff1a\n- \u7528\u65bc\u751f\u6210\u8f38\u51fa\u7684\u7279\u5b9a\u7d50\u69cb\u6216\u683c\u5f0f\u3002\n- \u7279\u5b9a\u884c\u7232\uff0c\u4f8b\u5982\u4f55\u6642\u63d0\u4f9b\u7c21\u6f54\u6216\u8a73\u7d30\u8f38\u51fa\u3002\n- \u91dd\u5c0d\u7279\u5b9a\u8f38\u5165\u985e\u578b\u7684\u7279\u5b9a\u81ea\u5b9a\u7fa9\u8f38\u51fa\u3002\n\u4ee5\u4e0b\u793a\u4f8b\u662f\u96e3\u4ee5\u50c5\u6839\u64da\u63d0\u793a\u8aaa\u660e\u6355\u7372\u7684\u4f7f\u7528\u5834\u666f\uff1a\n- **\u5206\u985e** \uff1a\u9810\u671f\u97ff\u61c9\u662f\u7279\u5b9a\u7684\u5b57\u8a5e\u6216\u77ed\u8a9e\u3002| 0                       |\n|:-------------------------------------------------------------------------------------------|\n| \u63d0\u793a\uff1a \u5c07\u4ee5\u4e0b\u6587\u672c\u5206\u985e\u7232\u4ee5\u4e0b\u985e\u5225\u4e4b\u4e00\uff1a[\u5546\u696d\u3001\u5a1b\u6a02]\u3002 \u6587\u672c\uff1a\u591a\u5143\u5316\u60a8\u7684\u6295\u8cc7\u7d44\u5408 \u97ff\u61c9\uff1a \u696d\u52d9 |\u8abf\u6574\u6a21\u578b\u6709\u52a9\u65bc\u9632\u6b62\u6a21\u578b\u751f\u6210\u8a73\u7d30\u7684\u97ff\u61c9\u3002\n- **\u6458\u8981** \uff1a\u6458\u8981\u9075\u5faa\u7279\u5b9a\u683c\u5f0f\u3002 \u4f8b\u5982\uff0c\u60a8\u53ef\u80fd\u9700\u8981\u79fb\u9664\u804a\u5929\u6458\u8981\u4e2d\u7684\u500b\u4eba\u8eab\u4efd\u4fe1\u606f (PII)\u3002| 0                                 |\n|:-----------------------------------------------------------------------------------------------------------------------------------|\n| \u63d0\u793a\uff1a \u7e3d\u7d50\uff1a Jessica\uff1a\u807d\u8d77\u4f86\u5f88\u68d2\uff01\u6642\u4ee3\u5ee3\u5834\u898b\uff01 Alexander\uff1a10 \u9ede\u898b\uff01 \u56de\u7b54\uff1a #Person1 \u548c #Person2 \u7d04\u5b9a\u4e0a\u5348 10:00 \u5728\u6642\u4ee3\u5ee3\u5834\u6703\u5408\u3002 |\u9019\u7a2e\u5c07\u8b1b\u8a71\u4eba\u59d3\u540d\u66ff\u63db\u7232 `#Person1` \u548c `#Person2` \u7684\u683c\u5f0f\u5f88\u96e3\u63cf\u8ff0\uff0c\u57fa\u790e\u6a21\u578b\u53ef\u80fd\u7121\u6cd5\u81ea\u7136\u5730\u7522\u751f\u6b64\u985e\u97ff\u61c9\u3002\n- **\u63d0\u53d6\u5f0f\u554f\u7b54** \uff1a\u554f\u984c\u8207\u4e0a\u4e0b\u6587\u6709\u95dc\uff0c\u56de\u7b54\u662f\u4e0a\u4e0b\u6587\u7684\u5b50\u5b57\u7b26\u4e32\u3002| 0                                      |\n|:------------------------------------------------------------------------------------------------------------------------------------------------------|\n| \u63d0\u793a\uff1a \u8a9e\u5883\uff1a\u6709\u8b49\u64da\u8868\u660e\uff0c\u5728\u904e\u53bb 21,000 \u5e74\u88cf\uff0c\u901a\u904e\u672b\u6b21\u76db\u51b0\u671f (LGM) \u548c\u96a8\u5f8c\u7684\u51b0\u6d88\u671f\uff0c\u4e9e\u99ac\u905c\u96e8\u6797\u690d\u88ab\u9aee\u751f\u4e86\u91cd\u5927\u8b8a\u5316\u3002\u554f\u984c\uff1aLGM \u6307\u4ec0\u9ebc\uff1f \u97ff\u61c9\uff1a \u672b\u6b21\u76db\u51b0\u671f |\u97ff\u61c9\u201cLast Glacial Maximum\u201d\u662f\u4e0a\u4e0b\u6587\u4e2d\u7684\u7279\u5b9a\u8a5e\u7d44\u3002\n- **\u804a\u5929** \uff1a\u60a8\u9700\u8981\u81ea\u5b9a\u7fa9\u6a21\u578b\u97ff\u61c9\u4ee5\u9075\u5faa\u4eba\u8a2d\u3001\u89d2\u8272\u6216\u4eba\u7269\u3002| 0                          |\n|:--------------------------------------------------------------------------------------------------------|\n| \u63d0\u793a\uff1a \u7528\u6236\uff1a\u4eca\u5929\u5929\u6c23\u600e\u9ebc\u6a23\uff1f \u97ff\u61c9\uff1a \u667a\u80fd\u52a9\u7406\uff1a\u4f5c\u7232 Lola Lollipops, \u7684\u865b\u64ec\u638c\u6ac3\uff0c\u6211\u53ea\u80fd\u5e6b\u60a8\u4ee3\u8cfc\u548c\u767c\u8ca8\u3002 |\n\u60a8\u9084\u53ef\u4ee5\u5728\u4ee5\u4e0b\u60c5\u6cc1\u4e0b\u8abf\u6574\u6a21\u578b\uff1a\n- \u63d0\u793a\u7121\u6cd5\u7522\u751f\u4e00\u81f4\u6027\u8db3\u5920\u597d\u7684\u9810\u671f\u7d50\u679c\u3002\n- \u4efb\u52d9\u904e\u65bc\u8907\u96dc\uff0c\u7121\u6cd5\u5728\u63d0\u793a\u4e2d\u5b9a\u7fa9\u3002\u4f8b\u5982\uff0c\u60a8\u5e0c\u671b\u6a21\u578b\u91dd\u5c0d\u96e3\u4ee5\u5728\u63d0\u793a\u4e2d\u6e05\u6670\u8868\u9054\u7684\u884c\u7232\u9032\u884c\u884c\u7232\u514b\u9686\u3002\n- \u60a8\u5c0d\u4efb\u52d9\u6709\u96e3\u4ee5\u8868\u8ff0\u7684\u7406\u89e3\uff0c\u53ef\u4ee5\u62bd\u7d72\u525d\u7e6d\u5c64\u5c64\u5f15\u51fa\uff0c\u4f46\u5f88\u96e3\u5728\u63d0\u793a\u4e2d\u898f\u7bc4\u8868\u9054\u3002\n- \u60a8\u5e0c\u671b\u901a\u904e\u79fb\u9664\u5c11\u91cf\u6a23\u672c\u793a\u4f8b\u4f86\u7e2e\u77ed\u8a9e\u5883\u9577\u5ea6\u3002## \u6e96\u5099\u76e3\u7763\u5f0f\u8abf\u6574\u6578\u64da\u96c6\n\u7528\u65bc\u8abf\u6574\u57fa\u790e\u6a21\u578b\u7684\u6578\u64da\u96c6\u9700\u8981\u5305\u542b\u8207\u60a8\u5e0c\u671b\u6a21\u578b\u57f7\u884c\u7684\u4efb\u52d9\u76f8\u914d\u7684\u6a23\u672c\u3002\u4ee5\u6587\u672c\u5230\u6587\u672c\u683c\u5f0f\u69cb\u5efa\u8a13\u7df4\u6578\u64da\u96c6\u3002\u6578\u64da\u96c6\u4e2d\u7684\u6bcf\u689d\u8a18\u9304\u6216\u8005\u8aaa\u6bcf\u4e00\u884c\u90fd\u5305\u542b\u8207\u6a21\u578b\u7684\u9810\u671f\u8f38\u51fa\u914d\u5c0d\u7684\u8f38\u5165\u6587\u672c\uff08\u4e5f\u7a31\u7232\u63d0\u793a\uff09\u3002\u76e3\u7763\u5f0f\u8abf\u512a\u4f7f\u7528\u6578\u64da\u96c6\u4f86\u8a13\u7df4\u6a21\u578b\uff0c\u4ee5\u6a21\u64ec\u6240\u9700\u7684\u884c\u7232\u6216\u4efb\u52d9\uff0c\u65b9\u6cd5\u662f\u5411\u6578\u64da\u96c6\u63d0\u4f9b\u6578\u767e\u500b\u6a23\u672c\u4f86\u8aaa\u660e\u8a72\u884c\u7232\u3002\n\u60a8\u7684\u6578\u64da\u96c6\u5fc5\u9808\u81f3\u5c11\u5305\u542b 10 \u500b\u6a23\u672c\uff0c\u4f46\u7232\u4e86\u7372\u5f97\u826f\u597d\u7684\u7d50\u679c\uff0c\u6211\u5011\u5efa\u8b70\u81f3\u5c11\u4f7f\u7528 100 \u5230 500 \u500b\u6a23\u672c\u3002\u60a8\u5728\u6578\u64da\u96c6\u4e2d\u63d0\u4f9b\u7684\u6a23\u672c\u8d8a\u591a\uff0c\u7d50\u679c\u5c31\u8d8a\u597d\u3002\n\u5982\u9700\u67e5\u770b\u793a\u4f8b\u6578\u64da\u96c6\uff0c\u8acb\u53c3\u95b1\u672c\u9801\u9762\u4e0a\u7684 [\u793a\u4f8b\u6578\u64da\u96c6](#sample-datasets) \u3002\n### \u6578\u64da\u96c6\u683c\u5f0f\n\u6a21\u578b\u8abf\u6574\u6578\u64da\u96c6\u5fc5\u9808\u63a1\u7528 [JSON \u884c](https://jsonlines.org/) (JSONL) \u683c\u5f0f\uff0c\u5176\u4e2d\u6bcf\u884c\u5305\u542b\u4e00\u500b\u8abf\u6574\u6a23\u672c\u3002\u7528\u65bc\u8abf\u6574\u6587\u672c\u751f\u6210\u6a21\u578b\u7684\u6578\u64da\u96c6\u683c\u5f0f\u8207\u7528\u65bc\u8abf\u6574\u6587\u672c\u804a\u5929\u6a21\u578b\u7684\u6578\u64da\u96c6\u683c\u5f0f\u4e0d\u540c\u3002\u5728\u8abf\u6574\u6a21\u578b\u4e4b\u524d\uff0c\u60a8\u5fc5\u9808\u5148 [\u5c07\u6578\u64da\u96c6\u4e0a\u50b3\u5230 Cloud Storage \u5b58\u5132\u6876](#upload-datasets) \u3002\n\u6bcf\u500b\u793a\u4f8b\u90fd\u5305\u542b\u4e00\u500b `input_text` \u5b57\u6bb5\uff08\u5305\u542b\u6a21\u578b\u63d0\u793a\uff09\u548c\u4e00\u500b `output_text` \u5b57\u6bb5\uff08\u5305\u542b\u7d93\u904e\u8abf\u6574\u7684\u6a21\u578b\u9810\u671f\u751f\u6210\u7684\u793a\u4f8b\u97ff\u61c9\uff09\u3002 \u7d50\u69cb\u5316\u63d0\u793a\u4e2d\u7684\u5176\u4ed6\u5b57\u6bb5\uff08\u4f8b\u5982 `context` \uff09\u6703\u88ab\u5ffd\u7565\u3002\n`input_text` \u7684\u8a5e\u5143\u9577\u5ea6\u4e0a\u9650\u7232 8192\uff0c `output_text` \u7684\u8a5e\u5143\u9577\u5ea6\u4e0a\u9650\u7232 1024\u3002\u5982\u679c\u4efb\u4e00\u5b57\u6bb5\u8d85\u904e\u8a5e\u5143\u9577\u5ea6\u4e0a\u9650\uff0c\u5247\u591a\u9918\u7684\u8a5e\u5143\u5c07\u88ab\u622a\u65b7\u3002\n\u6587\u672c\u751f\u6210\u6a21\u578b\u7684\u6578\u64da\u96c6\u6700\u591a\u53ef\u5305\u542b\u7684\u6a23\u672c\u6578\u91cf\u7232 10,000\u3002\n### \u6578\u64da\u96c6\u6a23\u672c```\n{\"input_text\": \"question: How many people live in Beijing? context:\nWith over 21 million residents, Beijing is the world's most populous national\ncapital city and is China's second largest city after Shanghai. It is\nlocated in Northern China, and is governed as a municipality under the direct\nadministration of the State Council with 16 urban, suburban, and rural\ndistricts.[14] Beijing is mostly surrounded by Hebei Province with the exception\nof neighboring Tianjin to the southeast; together, the three divisions form the\nJingjinji megalopolis and the national capital region of China.\",\n\"output_text\": \"over 21 million people\"}\n{\"input_text\": \"question: How many parishes are there in Louisiana? context:\nThe U.S. state of Louisiana is divided into 64 parishes (French: paroisses) in\nthe same manner that 48 other states of the United States are divided into\ncounties, and Alaska is divided into boroughs.\", \"output_text\": \"64\"}\n```\n### \u5728\u6a23\u672c\u4e2d\u6dfb\u52a0\u8aaa\u660e\u5c0d\u65bc\u5206\u985e\u7b49\u4efb\u52d9\uff0c\u53ef\u4ee5\u5275\u5efa\u4e0d\u5305\u542b\u8aaa\u660e\u7684\u6a23\u672c\u6578\u64da\u96c6\u3002\u4f46\u662f\uff0c\u5982\u679c\u5f9e\u6578\u64da\u96c6\u4e2d\u7684\u793a\u4f8b\u4e2d\u6392\u9664\u8aaa\u660e\uff0c\u5247\u8207\u5305\u542b\u8aaa\u660e\u76f8\u6bd4\uff0c\u5728\u8abf\u6574\u5f8c\u6027\u80fd\u6703\u4e0b\u964d\uff0c\u5c0d\u65bc\u8f03\u5c0f\u7684\u6578\u64da\u96c6\u5c24\u751a\u3002\n **\u6392\u9664\u8aaa\u660e** \uff1a\n```\n{\"input_text\": \"5 stocks to buy now\",\"output_text\": \"business\"}\n```\n **\u5305\u542b\u8aaa\u660e** \uff1a\n```\n{\"input_text\": \"Classify the following text into one of the following classes:[business, entertainment] Text: 5 stocks to buy now\",\"output_text\": \"business\"}\n```\n\u804a\u5929\u8abf\u6574\u6578\u64da\u96c6\u4e2d\u7684\u6bcf\u500b\u5c0d\u8a71\u793a\u4f8b\u7531\u4e00\u500b `messages` \u5b57\u6bb5\uff08\u5fc5\u9700\uff09\u548c\u4e00\u500b `context` \u5b57\u6bb5\uff08\u53ef\u9078\uff09\u7d44\u6210\u3002\n`messages` \u5b57\u6bb5\u5305\u542b\u4e00\u7d44\u4f5c\u8005-\u5167\u5bb9\u5c0d\u3002 `author` \u5b57\u6bb5\u6307\u6d88\u606f\u7684\u4f5c\u8005\uff0c\u4e26\u4ea4\u66ff\u8a2d\u7f6e\u7232 `user` \u6216 `assistant` \u3002 `content` \u5b57\u6bb5\u662f\u6d88\u606f\u7684\u5167\u5bb9\u3002\u6bcf\u500b\u5c0d\u8a71\u793a\u4f8b\u90fd\u61c9\u8a72\u6709\u5169\u5230\u4e09\u500b\u7528\u6236-\u667a\u80fd\u52a9\u7406\u6d88\u606f\u5c0d\uff0c\u4ee3\u8868\u4f86\u81ea\u7528\u6236\u7684\u6d88\u606f\u548c\u4f86\u81ea\u6a21\u578b\u7684\u97ff\u61c9\u3002\n\u901a\u904e [context](https://cloud.google.com/vertex-ai/generative-ai/docs/chat/chat-prompts?hl=zh-cn#context) \u5b57\u6bb5\uff0c\u60a8\u53ef\u4ee5\u6307\u5b9a\u804a\u5929\u7684\u4e0a\u4e0b\u6587\u3002\u5982\u679c\u60a8\u6307\u5b9a\u793a\u4f8b\u7684\u4e0a\u4e0b\u6587\uff0c\u5247\u8a72\u4e0a\u4e0b\u6587\u5c07\u8986\u84cb\u5728 `default_context` \u4e2d\u63d0\u4f9b\u7684\u503c\u3002\n\u5c0d\u65bc\u6bcf\u500b\u5c0d\u8a71\u793a\u4f8b\uff0c `context` \u548c `messages` \u7684\u7e3d\u8a5e\u5143\u9577\u5ea6\u4e0a\u9650\u7232 8192 \u500b\u8a5e\u5143\u3002\u6b64\u5916\uff0c `assistant` \u7684\u6bcf\u500b `content` \u5b57\u6bb5\u4e0d\u61c9\u8d85\u904e 1,024 \u500b\u8a5e\u5143\u3002\n\u5728\u6587\u672c\u804a\u5929\u6a21\u578b\u7684\u6578\u64da\u96c6\u4e2d\uff0c\u6a23\u672c\u6700\u591a\u53ef\u4ee5\u5305\u542b 10,000 \u500b `author` \u5b57\u6bb5\u3002\u6b64\u4e0a\u9650\u662f\u6240\u6709\u6a23\u672c\u7684\u6240\u6709 `messages` \u4e2d\u6240\u6709 `author` \u5b57\u6bb5\u7684\u7e3d\u548c\u3002```\n{\u00a0 \"context\": \"You are a pirate dog named Captain Barktholomew.\",\u00a0 \"messages\": [\u00a0 \u00a0 {\u00a0 \u00a0 \u00a0 \"author\": \"user\",\u00a0 \u00a0 \u00a0 \"content\": \"Hi\"\u00a0 \u00a0 },\u00a0 \u00a0 {\u00a0 \u00a0 \u00a0 \"author\": \"assistant\",\u00a0 \u00a0 \u00a0 \"content\": \"Argh! What brings ye to my ship?\"\u00a0 \u00a0 },\u00a0 \u00a0 {\u00a0 \u00a0 \u00a0 \"author\": \"user\",\u00a0 \u00a0 \u00a0 \"content\": \"What's your name?\"\u00a0 \u00a0 },\u00a0 \u00a0 {\u00a0 \u00a0 \u00a0 \"author\": \"assistant\",\u00a0 \u00a0 \u00a0 \"content\": \"I be Captain Barktholomew, the most feared pirate dog of the seven seas.\"\u00a0 \u00a0 }\u00a0 ]}\n```\n### \u793a\u4f8b\u6578\u64da\u96c6\n\u60a8\u53ef\u4ee5\u4f7f\u7528\u793a\u4f8b\u6578\u64da\u96c6\u4f86\u958b\u59cb\u8abf\u6574 `text-bison@002` \u6a21\u578b\u3002\u4e0b\u9762\u662f\u4e00\u500b\u5206\u985e\u4efb\u52d9\u6578\u64da\u96c6\uff0c\u5176\u4e2d\u5305\u542b\u5404\u7a2e\u91ab\u5b78\u5c08\u696d\u9818\u57df\u7684\u793a\u4f8b\u91ab\u7642\u8f49\u5beb\u8a18\u9304\u3002\u6578\u64da\u4f86\u81ea [mtsamples.com](https://mtsamples.com) \uff0c [Kaggle](https://www.kaggle.com/datasets/tboyle10/medicaltranscriptions) \u4e0a\u63d0\u4f9b\u4e86\u8a72\u6578\u64da\u96c6\u3002\n- \u8abf\u512a\u6578\u64da\u96c6\u793a\u4f8b URI\uff1a`gs://cloud-samples-data/vertex-ai/model-evaluation/peft_train_sample.jsonl`\n- \u8a55\u4f30\u6578\u64da\u96c6\u793a\u4f8b URI\uff1a`gs://cloud-samples-data/vertex-ai/model-evaluation/peft_eval_sample.jsonl`\n\u5982\u9700\u4f7f\u7528\u9019\u4e9b\u6578\u64da\u96c6\uff0c\u8acb\u5728 [\u5275\u5efa\u6587\u672c\u6a21\u578b\u76e3\u7ba1\u5f0f\u8abf\u512a\u4f5c\u696d](#create_a_text_model_supervised_tuning_job) \u6642\u6307\u5b9a\u9069\u7528\u53c3\u6578\u4e2d\u7684 URI\u3002\n\u4f8b\u5982\uff1a\n```\n...\"dataset_uri\": \"gs://cloud-samples-data/vertex-ai/model-evaluation/peft_train_sample.jsonl\",...\"evaluation_data_uri\": \"gs://cloud-samples-data/vertex-ai/model-evaluation/peft_eval_sample.jsonl\",...\n```\n### \u8207\u751f\u7522\u6578\u64da\u4fdd\u6301\u4e00\u81f4\n\u6578\u64da\u96c6\u4e2d\u7684\u6a23\u672c\u61c9\u8207\u60a8\u7684\u9810\u671f\u751f\u7522\u6d41\u91cf\u76f8\u5339\u914d\u3002\u5982\u679c\u60a8\u7684\u6578\u64da\u96c6\u5305\u542b\u7279\u5b9a\u7684\u683c\u5f0f\u3001\u95dc\u9375\u5b57\u3001\u8aaa\u660e\u6216\u4fe1\u606f\uff0c\u5247\u751f\u7522\u6578\u64da\u61c9\u4ee5\u76f8\u540c\u65b9\u5f0f\u8a2d\u7f6e\u683c\u5f0f\u5e77\u5305\u542b\u76f8\u540c\u7684\u8aaa\u660e\u3002\n\u4f8b\u5982\uff0c\u5982\u679c\u6578\u64da\u96c6\u4e2d\u7684\u6a23\u672c\u5305\u542b `\"question:\"` \u548c `\"context:\"` \uff0c\u5247\u751f\u7522\u6d41\u91cf\u7684\u683c\u5f0f\u4e5f\u61c9\u8a2d\u7f6e\u7232\u5305\u542b `\"question:\"` \u548c `\"context:\"` \uff0c\u5176\u9806\u5e8f\u8207\u5728\u6578\u64da\u96c6\u6a23\u672c\u4e2d\u7684\u986f\u793a\u9806\u5e8f\u76f8\u540c\u3002\u5982\u679c\u6392\u9664\u4e86\u8a9e\u5883\uff0c\u5247\u6a21\u578b\u5c07\u7121\u6cd5\u8b58\u5225\u8a72\u6a21\u5f0f\uff0c\u5373\u4f7f\u78ba\u5207\u7684\u554f\u984c\u5305\u542b\u5728\u6578\u64da\u96c6\u5167\u7684\u6a23\u672c\u4e2d\u4e5f\u662f\u5982\u6b64\u3002\n### \u5c07\u8abf\u6574\u6578\u64da\u96c6\u4e0a\u50b3\u5230 Cloud Storage\n\u82e5\u8981\u904b\u884c\u8abf\u512a\u4f5c\u696d\uff0c\u60a8\u9700\u8981\u5c07\u4e00\u500b\u6216\u591a\u500b\u6578\u64da\u96c6\u4e0a\u50b3\u5230 Cloud Storage \u5b58\u5132\u6876\u3002\u60a8\u53ef\u4ee5 [\u5275\u5efa\u65b0\u7684 Cloud Storage \u5b58\u5132\u6876](https://cloud.google.com/storage/docs/creating-buckets?hl=zh-cn#create_a_new_bucket) \uff0c\u4e5f\u53ef\u4ee5\u4f7f\u7528\u73fe\u6709\u7684\u5b58\u5132\u6876\u4f86\u5b58\u5132\u6578\u64da\u96c6\u6587\u4ef6\u3002\u5b58\u5132\u6876\u7684\u5340\u57df\u7121\u95dc\u7dca\u8981\uff0c\u4f46\u6211\u5011\u5efa\u8b70\u60a8\u4f7f\u7528\u60a8\u8a08\u5283\u7528\u65bc\u5c0d\u6a21\u578b\u8abf\u512a\u7684\u540c\u4e00 Google Cloud \u9805\u76ee\u4e2d\u7684\u5b58\u5132\u6876\u3002\n\u5b58\u5132\u6876\u6e96\u5099\u5c31\u7dd2\u5f8c\uff0c\u5c07\u6578\u64da\u96c6\u6587\u4ef6 [\u4e0a\u50b3](https://cloud.google.com/storage/docs/creating-buckets?hl=zh-cn#create_a_new_bucket) \u5230\u5b58\u5132\u6876\u3002\n## \u76e3\u7763\u5f0f\u8abf\u512a\u5340\u57df\u8a2d\u7f6e\n\u914d\u7f6e\u76e3\u7763\u5f0f\u8abf\u512a\u4f5c\u696d\u6642\uff0c\u60a8\u53ef\u4ee5\u6307\u5b9a\u4e09\u500b Google Cloud \u5340\u57df\u8a2d\u7f6e\u3002\u4e00\u500b\u5340\u57df\u662f\u904b\u884c\u6a21\u578b\u8abf\u512a\u6d41\u6c34\u7dda\u7684\u4f4d\u7f6e\u3002\u53e6\u4e00\u500b\u5340\u57df\u662f\u904b\u884c\u6a21\u578b\u8abf\u512a\u4f5c\u696d\u548c\u4e0a\u50b3\u8abf\u512a\u5f8c\u6a21\u578b\u7684\u4f4d\u7f6e\u3002\n### \u6d41\u6c34\u7dda\u4f5c\u696d\u5340\u57df\n\u6d41\u6c34\u7dda\u4f5c\u696d\u5340\u57df\u662f\u904b\u884c\u6d41\u6c34\u7dda\u4f5c\u696d\u7684\u5340\u57df\u3002\u5982\u679c\u672a\u6307\u5b9a\u53ef\u9078\u7684 [\u6a21\u578b\u4e0a\u50b3\u5340\u57df](#upload-region) \uff0c\u5247\u6a21\u578b\u5c07\u4e0a\u50b3\u4e26\u90e8\u7f72\u5230\u6d41\u6c34\u7dda\u4f5c\u696d\u5340\u57df\u3002\u4e2d\u9593\u6578\u64da\uff08\u4f8b\u5982\u8f49\u63db\u5f8c\u7684\u6578\u64da\u96c6\uff09\u5b58\u5132\u5728\u6d41\u6c34\u7dda\u4f5c\u696d\u5340\u57df\u4e2d\u3002\u5982\u9700\u77ad\u89e3\u53ef\u7528\u65bc\u6d41\u6c34\u7dda\u4f5c\u696d\u5340\u57df\u7684\u5340\u57df\uff0c\u8acb\u53c3\u95b1 [\u652f\u6301\u7684\u6d41\u6c34\u7dda\u4f5c\u696d\u548c\u6a21\u578b\u4e0a\u50b3\u5340\u57df](#supported-supervised-tuning-regions) \u3002\u60a8\u5fc5\u9808\u4f7f\u7528\u4ee5\u4e0b\u65b9\u6cd5\u4e4b\u4e00\u6307\u5b9a\u6d41\u6c34\u7dda\u4f5c\u696d\u5340\u57df\uff1a\n- \u5982\u679c\u60a8\u4f7f\u7528 Vertex AI SDK\uff0c\u5247\u53ef\u4ee5\u4f7f\u7528\u8868\u793a\u60a8\u6b63\u5728\u8abf\u512a\u7684\u6a21\u578b\u7684\u5c0d\u8c61\u7684 `tune_model` \u65b9\u6cd5\uff08\u4f8b\u5982\uff0c [TextGenerationModel.tune_model](https://cloud.google.com/python/docs/reference/aiplatform/latest/vertexai.language_models.TextGenerationModel?hl=zh-cn#vertexai_language_models_TextGenerationModel_tune_model) \u65b9\u6cd5\uff09\u4e0a\u7684 `tuning_job_location` \u53c3\u6578\u4f86\u6307\u5b9a\u6d41\u6c34\u7dda\u4f5c\u696d\u904b\u884c\u7684\u5340\u57df\u3002\n- \u5982\u679c\u60a8\u901a\u904e\u4f7f\u7528 [pipelineJobs.create](https://cloud.google.com/vertex-ai/docs/reference/rest/v1/projects.locations.pipelineJobs/create?hl=zh-cn) \u65b9\u6cd5\u767c\u9001 POST \u8acb\u6c42\u4f86\u5275\u5efa\u76e3\u7763\u5f0f\u8abf\u512a\u4f5c\u696d\uff0c\u5247\u53ef\u4ee5\u4f7f\u7528\u7db2\u5740\u4f86\u6307\u5b9a\u6d41\u6c34\u7dda\u4f5c\u696d\u904b\u884c\u7684\u5340\u57df\u3002\u5728\u4ee5\u4e0b\u7db2\u5740\u4e2d\uff0c\u5c07\u51fa\u73fe\u7684\u5169\u500b \u66ff\u63db\u7232\u6d41\u6c34\u7dda\u904b\u884c\u7684\u5340\u57df\uff1a```\n\u00a0https://PIPELINE_JOB_REGION-aiplatform.googleapis.com/v1/projects/PROJECT_ID/locations/PIPELINE_JOB_REGION/pipelineJobs\n```\n- \u5982\u679c\u60a8\u4f7f\u7528 Google Cloud \u63a7\u5236\u6aaf\u5275\u5efa\u76e3\u7763\u5f0f\u6a21\u578b\u8abf\u512a\u4f5c\u696d\uff0c\u5247\u53ef\u4ee5\u5728\u5275\u5efa\u8abf\u512a\u4f5c\u696d\u6642\u5728 **\u5340\u57df** \u63a7\u4ef6\u4e2d\u6307\u5b9a\u6d41\u6c34\u7dda\u4f5c\u696d\u5340\u57df\u3002\u5728 Google Cloud \u63a7\u5236\u6aaf\u4e2d\uff0c **\u5340\u57df** \u63a7\u4ef6\u540c\u6642\u6307\u5b9a\u6d41\u6c34\u7dda\u4f5c\u696d\u5340\u57df\u548c\u6a21\u578b\u4e0a\u50b3\u5340\u57df\u3002\u7576\u60a8\u4f7f\u7528 Google Cloud \u63a7\u5236\u6aaf\u5275\u5efa\u76e3\u7763\u5f0f\u6a21\u578b\u8abf\u512a\u4f5c\u696d\u6642\uff0c\u9019\u5169\u500b\u5340\u57df\u59cb\u7d42\u76f8\u540c\u3002\n### \u6a21\u578b\u4e0a\u50b3\u5340\u57df\n\u60a8\u53ef\u4ee5\u4f7f\u7528\u53ef\u9078\u7684 `tuned_model_location` \u53c3\u6578\u6307\u5b9a\u8abf\u512a\u5f8c\u6a21\u578b\u4e0a\u50b3\u5230\u7684\u4f4d\u7f6e\u3002\u5982\u679c\u672a\u6307\u5b9a\u6a21\u578b\u4e0a\u50b3\u5340\u57df\uff0c\u7cfb\u7d71\u6703\u5c07\u8abf\u512a\u5f8c\u7684\u6a21\u578b\u4e0a\u50b3\u5230 [\u6d41\u6c34\u7dda\u4f5c\u696d\u5340\u57df](#pipeline-region) \u3002\u60a8\u53ef\u4ee5\u4f7f\u7528 [\u652f\u6301\u7684\u6d41\u6c34\u7dda\u4f5c\u696d\u548c\u6a21\u578b\u4e0a\u50b3\u5340\u57df](#supported-supervised-tuning-regions) \u4e2d\u7684\u5340\u57df\u3002\u60a8\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u67d0\u7a2e\u65b9\u6cd5\u6307\u5b9a\u6a21\u578b\u4e0a\u50b3\u5340\u57df\uff1a\n- \u5982\u679c\u60a8\u4f7f\u7528 Vertex AI SDK\uff0c\u5247\u5728\u4ee3\u8868\u60a8\u6b63\u5728\u8abf\u512a\u7684\u6a21\u578b\u7684\u5c0d\u8c61\u7684 `tune_model` \u65b9\u6cd5\uff08\u4f8b\u5982\uff0c [TextGenerationModel.tune_model](https://cloud.google.com/python/docs/reference/aiplatform/latest/vertexai.language_models.TextGenerationModel?hl=zh-cn#vertexai_language_models_TextGenerationModel_tune_model) \u65b9\u6cd5\uff09\u4e0a\u6307\u5b9a `tuned_model_location` \u53c3\u6578\u3002\n- \u5982\u679c\u60a8\u901a\u904e\u4f7f\u7528 [pipelineJobs](https://cloud.google.com/vertex-ai/docs/reference/rest/v1/projects.locations.pipelineJobs/create?hl=zh-cn) \u65b9\u6cd5\u767c\u9001 POST \u8acb\u6c42\u4f86\u5275\u5efa\u76e3\u7763\u5f0f\u6a21\u578b\u8abf\u512a\u4f5c\u696d\uff0c\u5247\u53ef\u4ee5\u4f7f\u7528 `location` \u53c3\u6578\u6307\u5b9a\u6a21\u578b\u4e0a\u50b3\u5340\u57df\u3002\n- \u5982\u679c\u60a8\u4f7f\u7528 Google Cloud \u63a7\u5236\u6aaf\u5275\u5efa\u76e3\u7763\u5f0f\u6a21\u5f0f\u8abf\u512a\u4f5c\u696d\uff0c\u5247\u5728\u5275\u5efa\u8abf\u512a\u4f5c\u696d\u6642\u5728 **\u5340\u57df** \u63a7\u4ef6\u4e2d\u6307\u5b9a\u6a21\u578b\u4e0a\u50b3\u5340\u57df\u3002\u5728 Google Cloud \u63a7\u5236\u6aaf\u4e2d\uff0c **\u5340\u57df** \u63a7\u4ef6\u540c\u6642\u6307\u5b9a\u6a21\u578b\u4e0a\u50b3\u5340\u57df\u548c\u6d41\u6c34\u7dda\u4f5c\u696d\u5340\u57df\u3002\u7576\u60a8\u4f7f\u7528 Google Cloud \u63a7\u5236\u6aaf\u5275\u5efa\u76e3\u7763\u5f0f\u6a21\u578b\u8abf\u512a\u4f5c\u696d\u6642\uff0c\u9019\u5169\u500b\u5340\u57df\u59cb\u7d42\u76f8\u540c\u3002\n### \u6a21\u578b\u8abf\u512a\u5340\u57df\n\u6a21\u578b\u8abf\u512a\u5340\u57df\u662f\u9032\u884c\u6a21\u578b\u8abf\u512a\u8a08\u7b97\u7684\u4f4d\u7f6e\u3002\u6b64\u5340\u57df\u7531\u60a8\u9078\u64c7\u7684\u52a0\u901f\u5668\u985e\u578b\u6c7a\u5b9a\u3002\u5982\u679c\u60a8\u5c07\u52a0\u901f\u5668\u985e\u578b\u6307\u5b9a\u7232 `TPU` \uff0c\u5247\u6a21\u578b\u8abf\u512a\u8a08\u7b97\u6703\u5728 `europe-west4` \u4e2d\u9032\u884c\u3002\u5982\u679c\u60a8\u5c07\u52a0\u901f\u5668\u985e\u578b\u6307\u5b9a\u7232 `GPU` \uff0c\u5247\u6a21\u578b\u8abf\u512a\u5728 `us-central1` \u4e2d\u9032\u884c\u3002\n### \u652f\u6301\u7684\u6d41\u6c34\u7dda\u4f5c\u696d\u548c\u6a21\u578b\u4e0a\u50b3\u5340\u57df\n\u60a8\u53ef\u4ee5\u4f7f\u7528\u4ee5\u4e0b\u5340\u57df\u4e4b\u4e00\u4f86\u6307\u5b9a\u6a21\u578b\u4e0a\u50b3\u5340\u57df\u4e26\u6307\u5b9a\u6d41\u6c34\u7dda\u4f5c\u696d\u5340\u57df\uff1a\n- `us-central1`\n- `europe-west4`\n- `asia-southeast1`\n- `us-west1`\n- `europe-west3`\n- `europe-west2`\n- `asia-northeast1`\n- `us-east4`\n- `us-west4`\n- `northamerica-northeast1`\n- `europe-west9`\n- `europe-west1`\n- `asia-northeast3`## \u5275\u5efa\u6587\u672c\u6a21\u578b\u76e3\u7763\u5f0f\u8abf\u6574\u4f5c\u696d\n\u60a8\u53ef\u4ee5\u4f7f\u7528 Google Cloud \u63a7\u5236\u6aaf\u6216 Python \u7248 Vertex AI SDK \u5275\u5efa\u76e3\u7763\u5f0f\u6587\u672c\u6a21\u578b\u8abf\u6574\u4f5c\u696d\u3002\u5982\u9700\u67e5\u770b\u6a21\u578b\u8abf\u6574\u914d\u7f6e\u7684\u6307\u5c0e\u4fe1\u606f\uff0c\u8acb\u53c3\u95b1 [\u63a8\u85a6\u914d\u7f6e](#recommended_configurations) \u3002\n\u5982\u9700\u67e5\u770b\u4f7f\u7528 Python \u7248 Vertex AI SDK \u8abf\u6574\u6587\u672c\u751f\u6210\u57fa\u790e\u6a21\u578b\u7684\u793a\u4f8b\uff0c\u8acb\u5728\u4ee5\u4e0b\u4efb\u4e00\u74b0\u5883\u4e2d\u904b\u884c\u201cVertex AI \u8abf\u6574 PEFT \u6a21\u578b\u201dJupyter \u7b46\u8a18\u672c\uff1a [\u5728 Colab \u4e2d\u6253\u958b](https://colab.research.google.com/github/GoogleCloudPlatform/vertex-ai-samples/blob/main/notebooks/official/generative_ai/tune_peft.ipynb?hl=zh-cn) | [\u5728 Vertex AI Workbench \u7528\u6236\u7ba1\u7406\u7684\u7b46\u8a18\u672c\u4e2d\u6253\u958b](https://console.cloud.google.com/vertex-ai/workbench/deploy-notebook?download_url=https%3A%2F%2Fraw.githubusercontent.com%2FGoogleCloudPlatform%2Fvertex-ai-samples%2Fmain%2Fnotebooks%2Fofficial%2Fgenerative_ai%2Ftune_peft.ipynb&hl=zh-cn) | [\u5728 GitHub \u4e0a\u67e5\u770b](https://github.com/GoogleCloudPlatform/vertex-ai-samples/blob/main/notebooks/official/generative_ai/tune_peft.ipynb)\n\u5982\u9700\u5275\u5efa\u6a21\u578b\u8abf\u6574\u4f5c\u696d\uff0c\u8acb\u4f7f\u7528 [pipelineJobs](https://cloud.google.com/vertex-ai/docs/reference/rest/v1/projects.locations.pipelineJobs/create?hl=zh-cn) \u65b9\u6cd5\u767c\u9001 POST \u8acb\u6c42\u3002\u8acb\u6ce8\u610f\uff0c\u67d0\u4e9b\u53c3\u6578\u53ea\u53d7\u90e8\u5206\u6a21\u578b\u652f\u6301\u3002\u78ba\u4fdd\u50c5\u5305\u542b\u60a8\u8981\u8abf\u512a\u7684\u6a21\u578b\u7684\u9069\u7528\u53c3\u6578\u3002\n\u5728\u4f7f\u7528\u4efb\u4f55\u8acb\u6c42\u6578\u64da\u4e4b\u524d\uff0c\u8acb\u5148\u9032\u884c\u4ee5\u4e0b\u66ff\u63db\uff1a- \uff1apipelineJob \u7684\u986f\u793a\u540d\u7a31\u3002\n- \uff1a\u8981\u5c07\u6d41\u6c34\u7dda\u5de5\u4ef6\u8f38\u51fa\u5230\u7684\u5b58\u5132\u6876\u7684 URI\u3002\n- \uff1a\u60a8\u7684 [\u9805\u76ee ID](https://cloud.google.com/resource-manager/docs/creating-managing-projects?hl=zh-cn#identifiers) \u3002\n- \uff1apipelineJob \u4e0a\u50b3\uff08\u5275\u5efa\uff09\u7684\u6a21\u578b\u7684\u986f\u793a\u540d\u7a31\u3002\n- \uff1a\u6578\u64da\u96c6\u6587\u4ef6\u7684 URI\u3002\n- \uff1a\u904b\u884c\u6d41\u6c34\u7dda\u8abf\u6574\u4f5c\u696d\u7684\u5340\u57df\u3002\u9019\u4e5f\u662f\u4e0a\u50b3\u8abf\u512a\u5f8c\u6a21\u578b\u7684\u9ed8\u8a8d\u5340\u57df\u3002\u5982\u679c\u8981\u5c07\u6a21\u578b\u4e0a\u50b3\u5230\u5176\u4ed6\u5340\u57df\uff0c\u8acb\u4f7f\u7528`location`\u53c3\u6578\u6307\u5b9a\u8abf\u6574\u5f8c\u6a21\u578b\u4e0a\u50b3\u5340\u57df\u3002\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [\u6a21\u578b\u4e0a\u50b3\u5340\u57df](https://cloud.google.com/vertex-ai/generative-ai/docs/models/tune-text-models-supervised?hl=zh-cn#pipeline-region) \u3002\n- \uff1a\uff08\u53ef\u9078\uff09\u4e0a\u50b3\u8abf\u6574\u5f8c\u6a21\u578b\u7684\u5340\u57df\u3002\u5982\u679c\u672a\u6307\u5b9a\u6a21\u578b\u4e0a\u50b3\u5340\u57df\uff0c\u5247\u8abf\u512a\u5f8c\u7684\u6a21\u578b\u6703\u4e0a\u50b3\u5230\u904b\u884c\u6d41\u6c34\u7dda\u4f5c\u696d\u7684\u540c\u4e00\u5340\u57df\u3002\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [\u6a21\u578b\u4e0a\u50b3\u5340\u57df](https://cloud.google.com/vertex-ai/generative-ai/docs/models/tune-text-models-supervised?hl=zh-cn#upload-region) \u3002\n- \uff1a\uff08\u53ef\u9078\uff0c\u9ed8\u8a8d\u7232`GPU`\uff09\u7528\u65bc\u6a21\u578b\u8abf\u512a\u7684\u52a0\u901f\u5668\u985e\u578b\u3002\u6709\u6548\u9078\u9805\u5305\u62ec\uff1a- `GPU`\uff1a\u4f7f\u7528 8 \u500b A100 80 GB GPU \u9032\u884c\u8abf\u512a\u3002\u8acb\u78ba\u4fdd\u60a8\u6709\u8db3\u5920\u7684 [\u914d\u984d](https://cloud.google.com/vertex-ai/generative-ai/docs/models/tune-models?hl=zh-cn#quota) \u3002\u5982\u679c\u60a8\u9078\u64c7`GPU`\uff0c\u5247\u652f\u6301 [VPC-SC](https://cloud.google.com/vertex-ai/docs/general/vpc-service-controls?hl=zh-cn) \u3002\u5982\u679c\u8abf\u512a\u4f4d\u7f6e\u548c\u6a21\u578b\u4e0a\u50b3\u4f4d\u7f6e\u7232`us-centra1`\uff0c\u5247\u652f\u6301 [CMEK](https://cloud.google.com/vertex-ai/docs/general/cmek?hl=zh-cn) \u3002\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [\u76e3\u7763\u5f0f\u8abf\u512a\u5340\u57df\u8a2d\u7f6e](https://cloud.google.com/vertex-ai/generative-ai/docs/models/tune-text-models-supervised?hl=zh-cn#supervised-tuning-regions) \u3002\u5982\u679c\u60a8\u9078\u64c7`GPU`\uff0c\u5247\u6a21\u578b\u8abf\u512a\u8a08\u7b97\u6703\u5728`us-central1`\u5340\u57df\u9032\u884c\u3002\n- `TPU`\uff1a\u4f7f\u7528 64 \u500b TPU v3 Pod \u6838\u5fc3\u9032\u884c\u8abf\u512a\u3002\u8acb\u78ba\u4fdd\u60a8\u6709\u8db3\u5920\u7684 [\u914d\u984d](https://cloud.google.com/vertex-ai/generative-ai/docs/models/tune-models?hl=zh-cn#quota) \u3002\u4e0d\u652f\u6301 [CMEK](https://cloud.google.com/vertex-ai/docs/general/cmek?hl=zh-cn) \uff0c\u4f46\u652f\u6301 [VPC-SC](https://cloud.google.com/vertex-ai/docs/general/vpc-service-controls?hl=zh-cn) \u3002\u5982\u679c\u60a8\u9078\u64c7`TPU`\uff0c\u5247\u6a21\u578b\u8abf\u6574\u8a08\u7b97\u6703\u5728`europe-west4`\u5340\u57df\u9032\u884c\u3002\n- \uff1a\u8981\u8abf\u6574\u7684\u57fa\u790e\u6a21\u578b\u7684\u540d\u7a31\u3002\u9078\u9805\u5305\u62ec\uff1a- `text-bison@002`\n- `chat-bison@002`\n- \uff1a\u9069\u7528\u65bc\u8abf\u6574\u6578\u64da\u96c6\u4e2d\u6240\u6709\u8abf\u6574\u6a23\u672c\u7684\u8a9e\u5883\u3002\u5728\u6a23\u672c\u4e2d\u8a2d\u7f6e`context`\u5b57\u6bb5\u6703\u66ff\u63db\u9ed8\u8a8d\u4e0a\u4e0b\u6587\u3002\n- \uff1a\u6a21\u578b\u8abf\u6574\u6240\u8981\u904b\u884c\u7684\u6b65\u6578\u3002\u9ed8\u8a8d\u503c\u7232 300\u3002\u6279\u6b21\u5927\u5c0f\u56e0\u8abf\u512a\u4f4d\u7f6e\u548c\u6a21\u578b\u5927\u5c0f\u800c\u7570\u3002\u5c0d\u65bc 8k \u6a21\u578b\uff0c\u4f8b\u5982`text-bison@002`\u3001`chat-bison@002`\u3001`code-bison@002`\u548c`codechat-bison@002`\uff1a- `us-central1`\u7684\u6279\u6b21\u5927\u5c0f\u7232 8\u3002\n- `europe-west4`\u7684\u6279\u6b21\u5927\u5c0f\u7232 24\u3002\n\u5c0d\u65bc 32k \u6a21\u578b\uff0c\u4f8b\u5982`text-bison-32k`\u3001`chat-bison-32k`\u3001`code-bison-32k`\u548c`codechat-bison-32k`\uff1a- `us-central1`\u7684\u6279\u6b21\u5927\u5c0f\u7232 8\u3002\n- `europe-west4`\u7684\u6279\u6b21\u5927\u5c0f\u7232 8\u3002\n\u4f8b\u5982\uff0c\u5982\u679c\u60a8\u5728 `europe-west4` \u4e2d\u8a13\u7df4 `text-bison@002` \uff0c\u8a13\u7df4\u6578\u64da\u96c6\u4e2d\u6709 240 \u500b\u6a23\u672c\uff0c\u4e26\u4e14\u5c07 `steps` \u8a2d\u7f6e\u7232 20\uff0c\u5247\u8a13\u7df4\u6a23\u672c\u6578\u7232 20 \u6b65\u8207\u6279\u6b21\u5927\u5c0f 24 \u7684\u4e58\u7a4d\uff0c\u5373\u8a13\u7df4\u6b65\u6578\u7232 480\u3002\u5728\u9019\u7a2e\u60c5\u6cc1\u4e0b\uff0c\u8a13\u7df4\u904e\u7a0b\u6709\u5169\u500b\u9031\u671f\uff0c\u56e0\u7232\u5b83\u904d\u6b77\u6a23\u672c\u5169\u6b21\u3002\u5728 `us-central1` \u4e2d\uff0c\u5982\u679c\u8a13\u7df4\u6578\u64da\u96c6\u4e2d\u6709 240 \u500b\u6a23\u672c\uff0c\u4e26\u4e14\u60a8\u5c07 `steps` \u8a2d\u7f6e\u7232 15\uff0c\u5247\u8a13\u7df4\u6a23\u672c\u6578\u7232 15 \u6b65\u8207\u6279\u6b21\u5927\u5c0f 8 \u7684\u4e58\u7a4d\uff0c\u5373\u8a13\u7df4\u6b65\u6578\u7232 120\u3002\u5728\u9019\u7a2e\u60c5\u6cc1\u4e0b\u6709 0.5 \u500b\u9031\u671f\uff0c\u56e0\u7232\u8a13\u7df4\u6b65\u6578\u662f\u6a23\u672c\u6578\u7684\u4e00\u534a\u3002\n- \uff1a\u8981\u61c9\u7528\u65bc\u5efa\u8b70\u7684\u5b78\u7fd2\u901f\u7387\u7684\u8abf\u7bc0\u4fc2\u6578\u3002\u5982\u9700\u4f7f\u7528\u5efa\u8b70\u7684\u5b78\u7fd2\u901f\u7387\uff0c\u8acb\u4f7f\u7528`1.0`\u3002\n- \uff1a\uff08\u53ef\u9078\uff09\u5305\u542b\u8a55\u4f30\u6578\u64da\u96c6\uff08\u7528\u65bc\u6279\u91cf\u9810\u6e2c\u548c\u8a55\u4f30\uff09\u7684 JSONL \u6587\u4ef6\u7684 URI\u3002`chat-bison`\u4e0d\u652f\u6301\u8a55\u4f30\u3002\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [\u7528\u65bc\u8abf\u512a\u4ee3\u78bc\u6a21\u578b\u7684\u6578\u64da\u96c6\u683c\u5f0f](https://cloud.google.com/vertex-ai/generative-ai/docs/models/tune-text-models?hl=zh-cn#dataset-format) \u3002\u8a55\u4f30\u6578\u64da\u96c6\u9700\u8981 10 \u5230 250 \u500b\u6a23\u672c\u3002\n- \uff1a\uff08\u53ef\u9078\uff0c\u9ed8\u8a8d\u503c\u7232`20`\uff09\u6bcf\u6b21\u8a55\u4f30\u4e4b\u9593\u7684\u8abf\u512a\u6b65\u6578\u3002\u804a\u5929\u6a21\u578b\u4e0d\u652f\u6301\u8a55\u4f30\u9593\u9694\u3002\u7531\u65bc\u8a55\u4f30\u662f\u91dd\u5c0d\u6574\u500b\u8a55\u4f30\u6578\u64da\u96c6\u904b\u884c\uff0c\u56e0\u6b64\u8a55\u4f30\u9593\u9694\u8d8a\u5c0f\uff0c\u8abf\u512a\u6642\u9593\u5c31\u8d8a\u9577\u3002\u4f8b\u5982\uff0c\u5982\u679c`steps`\u7232 200 \u4e14`EVAL_INTERVAL`\u7232 100\uff0c\u5247\u60a8\u5c07\u50c5\u7372\u5f97\u8a55\u4f30\u6307\u6a19\u7684\u5169\u500b\u6578\u64da\u9ede\u3002\u6b64\u53c3\u6578\u8981\u6c42\u8a2d\u7f6e`evalutation_data_uri`\u3002\n- \uff1a\uff08\u53ef\u9078\uff0c\u9ed8\u8a8d\u503c\u7232`true`\uff09\u4e00\u500b`boolean`\uff0c\u5982\u679c\u8a2d\u7f6e\u7232`true`\uff0c\u4e14\u6a21\u578b\u6027\u80fd\u5728\u5169\u6b21\u8a55\u4f30\u904b\u884c\u4e2d\u6c92\u6709\u5f97\u5230\u8db3\u5920\u7684\u6539\u9032\uff08\u901a\u904e\u9810\u6e2c\u8a5e\u5143\u7684\u6e96\u78ba\u7387\u4f86\u8861\u91cf\uff09\uff0c\u5247\u5728\u5b8c\u6210\u6240\u6709\u8abf\u6574\u6b65\u9a5f\u4e4b\u524d\u505c\u6b62\u8abf\u6574\u3002\u5982\u679c\u7232`false`\uff0c\u5247\u7e7c\u7e8c\u8abf\u6574\uff0c\u76f4\u5230\u6240\u6709\u8abf\u6574\u6b65\u9a5f\u5b8c\u6210\u3002\u6b64\u53c3\u6578\u8981\u6c42\u8a2d\u7f6e`evaluation_data_uri`\u3002 \u804a\u5929\u6a21\u578b\u4e0d\u652f\u6301\u5553\u7528\u65e9\u505c\u6cd5\u3002\n- \uff1a\uff08\u53ef\u9078\uff09 [Vertex AI TensorBoard \u5be6\u4f8b](https://cloud.google.com/vertex-ai/docs/experiments/tensorboard-setup?hl=zh-cn#tensorboard_id) \u7684 ID\u3002Vertex AI TensorBoard \u5be6\u4f8b\u7528\u65bc\u5728\u8abf\u512a\u4f5c\u696d\u5b8c\u6210\u5f8c\u5275\u5efa [\u5be6\u9a57](https://cloud.google.com/vertex-ai/docs/experiments/create-experiment?hl=zh-cn) \u3002Vertex AI TensorBoard \u5be6\u4f8b\u9700\u8981\u8207\u8abf\u512a\u6d41\u6c34\u7dda\u4f4d\u65bc\u540c\u4e00\u5340\u57df\u3002\n- \uff1a\uff08\u53ef\u9078\uff09\u8981\u7528\u65bc\u6578\u64da\u52a0\u5bc6\u7684\u5ba2\u6236\u7ba1\u7406\u7684\u52a0\u5bc6\u5bc6\u9470 (CMEK) \u7684\u5b8c\u5168\u9650\u5b9a\u540d\u7a31\u3002CMEK \u50c5\u5728`us-central1`\u4e2d\u53ef\u7528\u3002\u5982\u679c\u60a8\u4f7f\u7528`us-central1`\u4e26\u4e14\u672a\u6307\u5b9a CMEK\uff0c\u5247\u7cfb\u7d71\u6703\u4f7f\u7528 Google \u7ba1\u7406\u7684\u52a0\u5bc6\u5bc6\u9470\u3002\u5728\u6240\u6709\u5176\u4ed6 [\u53ef\u7528\u5340\u57df](https://cloud.google.com/vertex-ai/generative-ai/docs/models/tune-text-models-supervised?hl=zh-cn#supported-supervised-tuning-regions) \u4e2d\uff0c\u7cfb\u7d71\u9ed8\u8a8d\u4f7f\u7528 Google \u7ba1\u7406\u7684\u52a0\u5bc6\u5bc6\u9470\u3002\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [CMEK \u6982\u89bd](https://cloud.google.com/kms/docs/cmek?hl=zh-cn) \u3002\n- \uff1a\u8981\u4f7f\u7528\u7684\u8abf\u6574\u6a21\u677f\u53d6\u6c7a\u65bc\u60a8\u8981\u8abf\u6574\u7684\u6a21\u578b\uff1a- \u6587\u672c\u6a21\u578b\uff1a`https://us-kfp.pkg.dev/ml-pipeline/large-language-model-pipelines/tune-large-model/v2.0.0`\n- \u804a\u5929\u6a21\u578b\uff1a`https://us-kfp.pkg.dev/ml-pipeline/large-language-model-pipelines/tune-large-chat-model/v3.0.0`\n- \uff1a\uff08\u53ef\u9078\uff09\u751f\u6210\u5f0f AI \u7528\u65bc\u904b\u884c\u6d41\u6c34\u7dda\u4f5c\u696d\u7684\u670d\u52d9\u8cec\u865f\u3002\u9ed8\u8a8d\u60c5\u6cc1\u4e0b\uff0c\u7cfb\u7d71\u6703\u4f7f\u7528\u9805\u76ee\u7684 Compute Engine \u9ed8\u8a8d\u670d\u52d9\u8cec\u865f (`PROJECT_NUMBER\u2011compute@developer.gserviceaccount.com`)\u3002\u8a73\u7d30\u77ad\u89e3\u5982\u4f55 [\u95dc\u806f\u81ea\u5b9a\u7fa9\u670d\u52d9\u8cec\u865f](https://cloud.google.com/vertex-ai/docs/general/custom-service-account?hl=zh-cn) \u3002\nHTTP \u65b9\u6cd5\u548c\u7db2\u5740\uff1a\n```\nPOST https://PIPELINE_JOB_REGION-aiplatform.googleapis.com/v1/projects/PROJECT_ID/locations/PIPELINE_JOB_REGION/pipelineJobs\n```\n\u8acb\u6c42 JSON \u6b63\u6587\uff1a\n```\n{\n \"displayName\": \"PIPELINEJOB_DISPLAYNAME\",\n \"runtimeConfig\": {\n \"gcsOutputDirectory\": \"gs://OUTPUT_DIR\",\n \"parameterValues\": {\n  \"project\": \"PROJECT_ID\",\n  \"model_display_name\": \"MODEL_DISPLAYNAME\",\n  \"dataset_uri\": \"gs://DATASET_URI\",\n  \"location\": \"MODEL_UPLOAD_REGION\",\n  \"accelerator_type\": \"ACCELERATOR_TYPE\",\n  \"large_model_reference\": \"LARGE_MODEL_REFERENCE\",\n  \"default_context\": \"DEFAULT_CONTEXT (chat only)\",\n  \"train_steps\": STEPS,\n  \"learning_rate_multiplier\": LEARNING_RATE_MULTIPLIER,\n  \"evaluation_data_uri\": \"gs://EVAL_DATASET_URI (text only)\",\n  \"evaluation_interval\": EVAL_INTERVAL (text only),\n  \"enable_early_stopping\": ENABLE_EARLY_STOPPING (text only),\n  \"enable_checkpoint_selection\": \"ENABLE_CHECKPOINT_SELECTION (text only)\",\n  \"tensorboard_resource_id\": \"TENSORBOARD_ID\",\n  \"encryption_spec_key_name\": \"ENCRYPTION_KEY_NAME\"\n }\n },\n \"encryptionSpec\": {\n \"kmsKeyName\": \"ENCRYPTION_KEY_NAME\"\n },\n \"serviceAccount\": \"SERVICE_ACCOUNT\",\n \"templateUri\": \"TEMPLATE_URI\"\n}\n```\n\u5982\u9700\u767c\u9001\u8acb\u6c42\uff0c\u8acb\u9078\u64c7\u4ee5\u4e0b\u65b9\u5f0f\u4e4b\u4e00\uff1a\n **\u6ce8\u610f** \uff1a\u4ee5\u4e0b\u547d\u4ee4\u5047\u5b9a\u60a8\u5df2\u4f7f\u7528\u60a8\u7684\u7528\u6236\u8cec\u865f\u901a\u904e\u904b\u884c [gcloud init](https://cloud.google.com/sdk/gcloud/reference/init?hl=zh-cn) \u6216 [gcloud auth login](https://cloud.google.com/sdk/gcloud/reference/auth/login?hl=zh-cn) \u767b\u9304`gcloud`CLI\uff0c\u6216\u8005\u4f7f\u7528\u4e86 [Cloud Shell](https://cloud.google.com/shell/docs?hl=zh-cn) \uff0c\u9019\u6703\u4f7f\u60a8\u81ea\u52d5\u767b\u9304`gcloud`CLI\u3002\u60a8\u53ef\u4ee5\u904b\u884c [gcloud auth list](https://cloud.google.com/sdk/gcloud/reference/auth/list?hl=zh-cn) \u4f86\u6aa2\u67e5\u7576\u524d\u6d3b\u8e8d\u7684\u8cec\u865f\u3002\n\u5c07\u8acb\u6c42\u6b63\u6587\u4fdd\u5b58\u5728\u540d\u7232 `request.json` \u7684\u6587\u4ef6\u4e2d\uff0c\u7136\u5f8c\u57f7\u884c\u4ee5\u4e0b\u547d\u4ee4\uff1a\n```\ncurl -X POST \\ -H \"Authorization: Bearer $(gcloud auth print-access-token)\" \\ -H \"Content-Type: application/json; charset=utf-8\" \\ -d @request.json \\ \"https://PIPELINE_JOB_REGION-aiplatform.googleapis.com/v1/projects/PROJECT_ID/locations/PIPELINE_JOB_REGION/pipelineJobs\"\n``` **\u6ce8\u610f** \uff1a\u4ee5\u4e0b\u547d\u4ee4\u5047\u5b9a\u60a8\u5df2\u4f7f\u7528\u60a8\u7684\u7528\u6236\u8cec\u865f\u901a\u904e\u904b\u884c [gcloud init](https://cloud.google.com/sdk/gcloud/reference/init?hl=zh-cn) \u6216 [gcloud auth login](https://cloud.google.com/sdk/gcloud/reference/auth/login?hl=zh-cn) \u767b\u9304`gcloud`CLI\uff0c\u6216\u8005\u4f7f\u7528\u4e86 [Cloud Shell](https://cloud.google.com/shell/docs?hl=zh-cn) \uff0c\u9019\u6703\u4f7f\u60a8\u81ea\u52d5\u767b\u9304`gcloud`CLI\u3002\u60a8\u53ef\u4ee5\u904b\u884c [gcloud auth list](https://cloud.google.com/sdk/gcloud/reference/auth/list?hl=zh-cn) \u4f86\u6aa2\u67e5\u7576\u524d\u6d3b\u8e8d\u7684\u8cec\u865f\u3002\n\u5c07\u8acb\u6c42\u6b63\u6587\u4fdd\u5b58\u5728\u540d\u7232 `request.json` \u7684\u6587\u4ef6\u4e2d\uff0c\u7136\u5f8c\u57f7\u884c\u4ee5\u4e0b\u547d\u4ee4\uff1a\n```\n$cred = gcloud auth print-access-token$headers = @{ \"Authorization\" = \"Bearer $cred\" }Invoke-WebRequest ` -Method POST ` -Headers $headers ` -ContentType: \"application/json; charset=utf-8\" ` -InFile request.json ` -Uri \"https://PIPELINE_JOB_REGION-aiplatform.googleapis.com/v1/projects/PROJECT_ID/locations/PIPELINE_JOB_REGION/pipelineJobs\" | Select-Object -Expand Content\n```\n\u60a8\u61c9\u8a72\u6536\u5230\u985e\u4f3c\u4ee5\u4e0b\u5167\u5bb9\u7684 JSON \u97ff\u61c9\u3002\u8acb\u6ce8\u610f\uff0c\u7232\u7bc0\u7701\u7a7a\u9593\uff0c\u7cfb\u7d71\u622a\u65b7\u4e86 `pipelineSpec` \u3002\u5982\u9700\u77ad\u89e3\u5982\u4f55\u5b89\u88dd\u6216\u66f4\u65b0 Python\uff0c\u8acb\u53c3\u95b1 [\u5b89\u88dd Python \u7248 Vertex AI SDK](https://cloud.google.com/vertex-ai/docs/start/use-vertex-ai-python-sdk?hl=zh-cn) \u3002   \u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [   Python API \u53c3\u8003\u6587\u6a94](https://cloud.google.com/python/docs/reference/aiplatform/latest?hl=zh-cn) \u3002\n [\u5728 GitHub \u4e0a\u67e5\u770b](https://github.com/GoogleCloudPlatform/python-docs-samples/blob/HEAD/generative_ai/tuning.py) \n```\nfrom __future__ import annotationsfrom typing import Optionalfrom google.auth import defaultfrom google.cloud import aiplatformimport pandas as pdimport vertexaifrom vertexai.language_models import TextGenerationModelfrom vertexai.preview.language_models import TuningEvaluationSpeccredentials, _ = default(scopes=[\"https://www.googleapis.com/auth/cloud-platform\"])def tuning(\u00a0 \u00a0 project_id: str,\u00a0 \u00a0 location: str,\u00a0 \u00a0 model_display_name: str,\u00a0 \u00a0 training_data: pd.DataFrame | str,\u00a0 \u00a0 train_steps: int = 10,\u00a0 \u00a0 evaluation_dataset: Optional[str] = None,\u00a0 \u00a0 tensorboard_instance_name: Optional[str] = None,) -> TextGenerationModel:\u00a0 \u00a0 \"\"\"Tune a new model, based on a prompt-response data.\u00a0 \u00a0 \"training_data\" can be either the GCS URI of a file formatted in JSONL format\u00a0 \u00a0 (for example: training_data=f'gs://{bucket}/{filename}.jsonl'), or a pandas\u00a0 \u00a0 DataFrame. Each training example should be JSONL record with two keys, for\u00a0 \u00a0 example:\u00a0 \u00a0 \u00a0 {\u00a0 \u00a0 \u00a0 \u00a0 \"input_text\": <input prompt>,\u00a0 \u00a0 \u00a0 \u00a0 \"output_text\": <associated output>\u00a0 \u00a0 \u00a0 },\u00a0 \u00a0 or the pandas DataFame should contain two columns:\u00a0 \u00a0 \u00a0 ['input_text', 'output_text']\u00a0 \u00a0 with rows for each training example.\u00a0 \u00a0 Args:\u00a0 \u00a0 \u00a0 project_id: GCP Project ID, used to initialize vertexai\u00a0 \u00a0 \u00a0 location: GCP Region, used to initialize vertexai\u00a0 \u00a0 \u00a0 model_display_name: Customized Tuned LLM model name.\u00a0 \u00a0 \u00a0 training_data: GCS URI of jsonl file or pandas dataframe of training data.\u00a0 \u00a0 \u00a0 train_steps: Number of training steps to use when tuning the model.\u00a0 \u00a0 \u00a0 evaluation_dataset: GCS URI of jsonl file of evaluation data.\u00a0 \u00a0 \u00a0 tensorboard_instance_name: The full name of the existing Vertex AI TensorBoard instance:\u00a0 \u00a0 \u00a0 \u00a0 projects/PROJECT_ID/locations/LOCATION_ID/tensorboards/TENSORBOARD_INSTANCE_ID\u00a0 \u00a0 \u00a0 \u00a0 Note that this instance must be in the same region as your tuning job.\u00a0 \u00a0 \"\"\"\u00a0 \u00a0 vertexai.init(project=project_id, location=location, credentials=credentials)\u00a0 \u00a0 eval_spec = TuningEvaluationSpec(evaluation_data=evaluation_dataset)\u00a0 \u00a0 eval_spec.tensorboard = aiplatform.Tensorboard(\u00a0 \u00a0 \u00a0 \u00a0 tensorboard_name=tensorboard_instance_name\u00a0 \u00a0 )\u00a0 \u00a0 model = TextGenerationModel.from_pretrained(\"text-bison@002\")\u00a0 \u00a0 model.tune_model(\u00a0 \u00a0 \u00a0 \u00a0 training_data=training_data,\u00a0 \u00a0 \u00a0 \u00a0 # Optional:\u00a0 \u00a0 \u00a0 \u00a0 model_display_name=model_display_name,\u00a0 \u00a0 \u00a0 \u00a0 train_steps=train_steps,\u00a0 \u00a0 \u00a0 \u00a0 tuning_job_location=\"europe-west4\",\u00a0 \u00a0 \u00a0 \u00a0 tuned_model_location=location,\u00a0 \u00a0 \u00a0 \u00a0 tuning_evaluation_spec=eval_spec,\u00a0 \u00a0 )\u00a0 \u00a0 print(model._job.status)\u00a0 \u00a0 return model\n```\u5728\u5617\u8a66\u6b64\u793a\u4f8b\u4e4b\u524d\uff0c\u8acb\u6309\u7167 [\u300a\u751f\u6210\u5f0f AI \u5feb\u901f\u5165\u9580\uff1a\u4f7f\u7528\u5ba2\u6236\u7aef\u5eab\u300b](https://cloud.google.com/vertex-ai/docs/start/client-libraries?hl=zh-cn) \u4e2d\u7684 Node.js \u8a2d\u7f6e\u8aaa\u660e\u57f7\u884c\u64cd\u4f5c\u3002\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [\u751f\u6210\u5f0f AI Node.js API \u53c3\u8003\u6587\u6a94](https://cloud.google.com/nodejs/docs/reference/aiplatform/latest?hl=zh-cn) \u3002\n\u5982\u9700\u5411\u751f\u6210\u5f0f AI \u9032\u884c\u8eab\u4efd\u9a57\u8b49\uff0c\u8acb\u8a2d\u7f6e\u61c9\u7528\u9ed8\u8a8d\u6191\u64da\u3002\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [\u7232\u672c\u5730\u958b\u767c\u74b0\u5883\u8a2d\u7f6e\u8eab\u4efd\u9a57\u8b49](https://cloud.google.com/docs/authentication/provide-credentials-adc?hl=zh-cn#local-dev) \u3002\n [\u5728 GitHub \u4e0a\u67e5\u770b](https://github.com/GoogleCloudPlatform/nodejs-docs-samples/blob/HEAD/ai-platform/snippets/tuning.js) \n```\n/**\u00a0* TODO(developer): Uncomment these variables before running the sample.\\\u00a0* (Not necessary if passing values as arguments)\u00a0*/// const project = 'YOUR_PROJECT_ID';// const location = 'YOUR_PROJECT_LOCATION';const aiplatform = require('@google-cloud/aiplatform');const {PipelineServiceClient} = aiplatform.v1;// Import the helper module for converting arbitrary protobuf.Value objects.const {helpers} = aiplatform;// Specifies the location of the api endpointconst clientOptions = {\u00a0 apiEndpoint: 'europe-west4-aiplatform.googleapis.com',};const model = 'text-bison@001';const pipelineClient = new PipelineServiceClient(clientOptions);async function tuneLLM() {\u00a0 // Configure the parent resource\u00a0 const parent = `projects/${project}/locations/${location}`;\u00a0 const parameters = {\u00a0 \u00a0 train_steps: helpers.toValue(trainSteps),\u00a0 \u00a0 project: helpers.toValue(project),\u00a0 \u00a0 location: helpers.toValue('us-central1'),\u00a0 \u00a0 dataset_uri: helpers.toValue(datasetUri),\u00a0 \u00a0 large_model_reference: helpers.toValue(model),\u00a0 \u00a0 model_display_name: helpers.toValue(modelDisplayName),\u00a0 \u00a0 accelerator_type: helpers.toValue('GPU'), // Optional: GPU or TPU\u00a0 };\u00a0 const runtimeConfig = {\u00a0 \u00a0 gcsOutputDirectory,\u00a0 \u00a0 parameterValues: parameters,\u00a0 };\u00a0 const pipelineJob = {\u00a0 \u00a0 templateUri:\u00a0 \u00a0 \u00a0 'https://us-kfp.pkg.dev/ml-pipeline/large-language-model-pipelines/tune-large-model/v2.0.0',\u00a0 \u00a0 displayName: 'my-tuning-job',\u00a0 \u00a0 runtimeConfig,\u00a0 };\u00a0 const createPipelineRequest = {\u00a0 \u00a0 parent,\u00a0 \u00a0 pipelineJob,\u00a0 \u00a0 pipelineJobId,\u00a0 };\u00a0 await new Promise((resolve, reject) => {\u00a0 \u00a0 pipelineClient.createPipelineJob(createPipelineRequest).then(\u00a0 \u00a0 \u00a0 response => resolve(response),\u00a0 \u00a0 \u00a0 e => reject(e)\u00a0 \u00a0 );\u00a0 }).then(response => {\u00a0 \u00a0 const [result] = response;\u00a0 \u00a0 console.log('Tuning pipeline job:');\u00a0 \u00a0 console.log(`\\tName: ${result.name}`);\u00a0 \u00a0 console.log(\u00a0 \u00a0 \u00a0 `\\tCreate time: ${new Date(1970, 0, 1)\u00a0 \u00a0 \u00a0 \u00a0 .setSeconds(result.createTime.seconds)\u00a0 \u00a0 \u00a0 \u00a0 .toLocaleString()}`\u00a0 \u00a0 );\u00a0 \u00a0 console.log(`\\tStatus: ${result.status}`);\u00a0 });}await tuneLLM();\n```\u5728\u5617\u8a66\u6b64\u793a\u4f8b\u4e4b\u524d\uff0c\u8acb\u6309\u7167 [\u300a\u751f\u6210\u5f0f AI \u5feb\u901f\u5165\u9580\uff1a\u4f7f\u7528\u5ba2\u6236\u7aef\u5eab\u300b](https://cloud.google.com/vertex-ai/docs/start/client-libraries?hl=zh-cn) \u4e2d\u7684 Java \u8a2d\u7f6e\u8aaa\u660e\u57f7\u884c\u64cd\u4f5c\u3002\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [\u751f\u6210\u5f0f AI Java API \u53c3\u8003\u6587\u6a94](https://cloud.google.com/java/docs/reference/google-cloud-aiplatform/latest/com.google.cloud.aiplatform.v1?hl=zh-cn) \u3002\n\u5982\u9700\u5411\u751f\u6210\u5f0f AI \u9032\u884c\u8eab\u4efd\u9a57\u8b49\uff0c\u8acb\u8a2d\u7f6e\u61c9\u7528\u9ed8\u8a8d\u6191\u64da\u3002\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [\u7232\u672c\u5730\u958b\u767c\u74b0\u5883\u8a2d\u7f6e\u8eab\u4efd\u9a57\u8b49](https://cloud.google.com/docs/authentication/provide-credentials-adc?hl=zh-cn#local-dev) \u3002\n [\u5728 GitHub \u4e0a\u67e5\u770b](https://github.com/GoogleCloudPlatform/java-docs-samples/blob/HEAD/aiplatform/src/main/java/aiplatform/CreatePipelineJobModelTuningSample.java) \n```\nimport com.google.cloud.aiplatform.v1beta1.CreatePipelineJobRequest;import com.google.cloud.aiplatform.v1beta1.LocationName;import com.google.cloud.aiplatform.v1beta1.PipelineJob;import com.google.cloud.aiplatform.v1beta1.PipelineJob.RuntimeConfig;import com.google.cloud.aiplatform.v1beta1.PipelineServiceClient;import com.google.cloud.aiplatform.v1beta1.PipelineServiceSettings;import com.google.protobuf.Value;import java.io.IOException;import java.util.HashMap;import java.util.Map;public class CreatePipelineJobModelTuningSample {\u00a0 public static void main(String[] args) throws IOException {\u00a0 \u00a0 // TODO(developer): Replace these variables before running the sample.\u00a0 \u00a0 String project = \"PROJECT\";\u00a0 \u00a0 String location = \"europe-west4\"; // europe-west4 and us-central1 are the supported regions\u00a0 \u00a0 String pipelineJobDisplayName = \"PIPELINE_JOB_DISPLAY_NAME\";\u00a0 \u00a0 String modelDisplayName = \"MODEL_DISPLAY_NAME\";\u00a0 \u00a0 String outputDir = \"OUTPUT_DIR\";\u00a0 \u00a0 String datasetUri = \"DATASET_URI\";\u00a0 \u00a0 int trainingSteps = 300;\u00a0 \u00a0 createPipelineJobModelTuningSample(\u00a0 \u00a0 \u00a0 \u00a0 project,\u00a0 \u00a0 \u00a0 \u00a0 location,\u00a0 \u00a0 \u00a0 \u00a0 pipelineJobDisplayName,\u00a0 \u00a0 \u00a0 \u00a0 modelDisplayName,\u00a0 \u00a0 \u00a0 \u00a0 outputDir,\u00a0 \u00a0 \u00a0 \u00a0 datasetUri,\u00a0 \u00a0 \u00a0 \u00a0 trainingSteps);\u00a0 }\u00a0 // Create a model tuning job\u00a0 public static void createPipelineJobModelTuningSample(\u00a0 \u00a0 \u00a0 String project,\u00a0 \u00a0 \u00a0 String location,\u00a0 \u00a0 \u00a0 String pipelineJobDisplayName,\u00a0 \u00a0 \u00a0 String modelDisplayName,\u00a0 \u00a0 \u00a0 String outputDir,\u00a0 \u00a0 \u00a0 String datasetUri,\u00a0 \u00a0 \u00a0 int trainingSteps)\u00a0 \u00a0 \u00a0 throws IOException {\u00a0 \u00a0 final String endpoint = String.format(\"%s-aiplatform.googleapis.com:443\", location);\u00a0 \u00a0 PipelineServiceSettings pipelineServiceSettings =\u00a0 \u00a0 \u00a0 \u00a0 PipelineServiceSettings.newBuilder().setEndpoint(endpoint).build();\u00a0 \u00a0 // Initialize client that will be used to send requests. This client only needs to be created\u00a0 \u00a0 // once, and can be reused for multiple requests.\u00a0 \u00a0 try (PipelineServiceClient client = PipelineServiceClient.create(pipelineServiceSettings)) {\u00a0 \u00a0 \u00a0 Map<String, Value> parameterValues = new HashMap<>();\u00a0 \u00a0 \u00a0 parameterValues.put(\"project\", stringToValue(project));\u00a0 \u00a0 \u00a0 parameterValues.put(\"model_display_name\", stringToValue(modelDisplayName));\u00a0 \u00a0 \u00a0 parameterValues.put(\"dataset_uri\", stringToValue(datasetUri));\u00a0 \u00a0 \u00a0 parameterValues.put(\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"location\",\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 stringToValue(\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"us-central1\")); // Deployment is only supported in us-central1 for Public Preview\u00a0 \u00a0 \u00a0 parameterValues.put(\"large_model_reference\", stringToValue(\"text-bison@001\"));\u00a0 \u00a0 \u00a0 parameterValues.put(\"train_steps\", numberToValue(trainingSteps));\u00a0 \u00a0 \u00a0 parameterValues.put(\"accelerator_type\", stringToValue(\"GPU\")); // Optional: GPU or TPU\u00a0 \u00a0 \u00a0 RuntimeConfig runtimeConfig =\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 RuntimeConfig.newBuilder()\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 .setGcsOutputDirectory(outputDir)\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 .putAllParameterValues(parameterValues)\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 .build();\u00a0 \u00a0 \u00a0 PipelineJob pipelineJob =\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 PipelineJob.newBuilder()\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 .setTemplateUri(\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"https://us-kfp.pkg.dev/ml-pipeline/large-language-model-pipelines/tune-large-model/v2.0.0\")\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 .setDisplayName(pipelineJobDisplayName)\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 .setRuntimeConfig(runtimeConfig)\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 .build();\u00a0 \u00a0 \u00a0 LocationName parent = LocationName.of(project, location);\u00a0 \u00a0 \u00a0 CreatePipelineJobRequest request =\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 CreatePipelineJobRequest.newBuilder()\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 .setParent(parent.toString())\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 .setPipelineJob(pipelineJob)\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 .build();\u00a0 \u00a0 \u00a0 PipelineJob response = client.createPipelineJob(request);\u00a0 \u00a0 \u00a0 System.out.format(\"response: %s\\n\", response);\u00a0 \u00a0 \u00a0 System.out.format(\"Name: %s\\n\", response.getName());\u00a0 \u00a0 }\u00a0 }\u00a0 static Value stringToValue(String str) {\u00a0 \u00a0 return Value.newBuilder().setStringValue(str).build();\u00a0 }\u00a0 static Value numberToValue(int n) {\u00a0 \u00a0 return Value.newBuilder().setNumberValue(n).build();\u00a0 }}\n```\u5982\u9700\u4f7f\u7528 Google Cloud \u63a7\u5236\u6aaf\u901a\u904e\u76e3\u7763\u5f0f\u8abf\u6574\u529f\u80fd\u4f86\u8abf\u6574\u6587\u672c\u6a21\u578b\uff0c\u8acb\u57f7\u884c\u4ee5\u4e0b\u6b65\u9a5f\uff1a- \u5728 Google Cloud \u63a7\u5236\u6aaf\u7684\u201c\u751f\u6210\u5f0f AI\u201d\u90e8\u5206\uff0c\u9032\u5165 **Vertex AI Studio** \u9801\u9762\u3002 [\u9032\u5165 Vertex AI Studio](https://console.cloud.google.com/vertex-ai/generative/language?hl=zh-cn) \n- \u9ede\u64ca **Tune and distill** \uff08\u8abf\u53c3\u548c\u84b8\u993e\uff09\u6a19\u7c64\u9801\u3002\n- \u9ede\u64caadd **\u5275\u5efa\u7d93\u8abf\u512a\u7684\u6a21\u578b** \u3002\n- \u9ede\u64ca **\u76e3\u7763\u5f0f\u8abf\u512a** \u3002\n- \u914d\u7f6e\u6a21\u578b\u8a73\u60c5\uff1a- **\u5df2\u8abf\u53c3\u6a21\u578b\u7684\u540d\u7a31** \uff1a\u8f38\u5165\u8abf\u512a\u5f8c\u6a21\u578b\u7684\u540d\u7a31\u3002\n- **\u57fa\u672c\u6a21\u578b** \uff1a\u9078\u64c7\u8981\u8abf\u512a\u7684\u6a21\u578b\u3002\n- **\u5340\u57df** \uff1a\u9078\u64c7\u904b\u884c\u6d41\u6c34\u7dda\u8abf\u512a\u4f5c\u696d\u4ee5\u53ca\u90e8\u7f72\u8abf\u512a\u5f8c\u6a21\u578b\u7684\u5340\u57df\u3002\n- **\u8f38\u51fa\u76ee\u9304** \uff1a\u8f38\u5165\u5c0d\u6a21\u578b\u8abf\u512a\u6642\u7528\u65bc\u5b58\u5132\u5de5\u4ef6\u7684 Cloud Storage \u4f4d\u7f6e\u3002\n- \u5c55\u958b **\u9ad8\u7d1a\u9078\u9805** \u4ee5\u914d\u7f6e\u9ad8\u7d1a\u8a2d\u7f6e\u3002- **\u8a13\u7df4\u6b65\u6578** \uff1a\u8f38\u5165\u8981\u7232\u6a21\u578b\u8abf\u512a\u904b\u884c\u7684\u6b65\u6578\u3002\u9ed8\u8a8d\u503c\u7232 300\u3002\u6279\u6b21\u5927\u5c0f\u56e0\u8abf\u512a\u4f4d\u7f6e\u548c\u6a21\u578b\u5927\u5c0f\u800c\u7570\u3002\u5c0d\u65bc 8k \u6a21\u578b\uff0c\u4f8b\u5982`text-bison@002`\u3001`chat-bison@002`\u3001`code-bison@002`\u548c`codechat-bison@002`\uff1a- `us-central1`\u7684\u6279\u6b21\u5927\u5c0f\u7232 8\u3002\n- `europe-west4`\u7684\u6279\u6b21\u5927\u5c0f\u7232 24\u3002\n\u5c0d\u65bc 32k \u6a21\u578b\uff0c\u4f8b\u5982`text-bison-32k`\u3001`chat-bison-32k`\u3001`code-bison-32k`\u548c`codechat-bison-32k`\uff1a- `us-central1`\u7684\u6279\u6b21\u5927\u5c0f\u7232 8\u3002\n- `europe-west4`\u7684\u6279\u6b21\u5927\u5c0f\u7232 8\u3002\n\u4f8b\u5982\uff0c\u5982\u679c\u60a8\u5728 `europe-west4` \u4e2d\u8a13\u7df4 `text-bison@002` \uff0c\u8a13\u7df4\u6578\u64da\u96c6\u4e2d\u6709 240 \u500b\u6a23\u672c\uff0c\u4e26\u4e14\u5c07 `steps` \u8a2d\u7f6e\u7232 20\uff0c\u5247\u8a13\u7df4\u6a23\u672c\u6578\u7232 20 \u6b65\u8207\u6279\u6b21\u5927\u5c0f 24 \u7684\u4e58\u7a4d\uff0c\u5373\u8a13\u7df4\u6b65\u6578\u7232 480\u3002\u5728\u9019\u7a2e\u60c5\u6cc1\u4e0b\uff0c\u8a13\u7df4\u904e\u7a0b\u6709\u5169\u500b\u9031\u671f\uff0c\u56e0\u7232\u5b83\u904d\u6b77\u6a23\u672c\u5169\u6b21\u3002\u5728 `us-central1` \u4e2d\uff0c\u5982\u679c\u8a13\u7df4\u6578\u64da\u96c6\u4e2d\u6709 240 \u500b\u6a23\u672c\uff0c\u4e26\u4e14\u60a8\u5c07 `steps` \u8a2d\u7f6e\u7232 15\uff0c\u5247\u8a13\u7df4\u6a23\u672c\u6578\u7232 15 \u6b65\u8207\u6279\u6b21\u5927\u5c0f 8 \u7684\u4e58\u7a4d\uff0c\u5373\u8a13\u7df4\u6b65\u6578\u7232 120\u3002\u5728\u9019\u7a2e\u60c5\u6cc1\u4e0b\u6709 0.5 \u500b\u9031\u671f\uff0c\u56e0\u7232\u8a13\u7df4\u6b65\u6578\u662f\u6a23\u672c\u6578\u7684\u4e00\u534a\u3002\n- **\u5b78\u7fd2\u901f\u7387\u8abf\u7bc0\u4fc2\u6578** \uff1a\u8f38\u5165\u6bcf\u6b21\u8fed\u4ee3\u6642\u7684\u6b65\u9577\u3002\u9ed8\u8a8d\u503c\u7232 1\u3002\n- **\u52a0\u901f\u5668\u985e\u578b** \uff1a\uff08\u53ef\u9078\uff09\u8f38\u5165\u7528\u65bc\u6a21\u578b\u8abf\u512a\u7684\u52a0\u901f\u5668\u985e\u578b\u3002\u6709\u6548\u9078\u9805\u5305\u62ec\uff1a- `GPU`\uff1a\u4f7f\u7528 8 \u500b A100 80 GB GPU \u9032\u884c\u8abf\u512a\u3002\u8acb\u78ba\u4fdd\u60a8\u6709\u8db3\u5920\u7684 [\u914d\u984d](https://cloud.google.com/vertex-ai/generative-ai/docs/models/tune-models?hl=zh-cn#quota) \u3002\u5982\u679c\u60a8\u9078\u64c7`GPU`\uff0c\u5247\u652f\u6301 [VPC-SC](https://cloud.google.com/vertex-ai/docs/general/vpc-service-controls?hl=zh-cn) \u3002\u5982\u679c\u8abf\u512a\u4f4d\u7f6e\u548c\u6a21\u578b\u4e0a\u50b3\u4f4d\u7f6e\u7232`us-centra1`\uff0c\u5247\u652f\u6301 [CMEK](https://cloud.google.com/vertex-ai/docs/general/cmek?hl=zh-cn) \u3002\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [\u76e3\u7763\u5f0f\u8abf\u512a\u5340\u57df\u8a2d\u7f6e](https://cloud.google.com/vertex-ai/generative-ai/docs/models/tune-text-models-supervised?hl=zh-cn#supervised-tuning-regions) \u3002\u5982\u679c\u60a8\u9078\u64c7`GPU`\uff0c\u5247\u6a21\u578b\u8abf\u512a\u8a08\u7b97\u6703\u5728`us-central1`\u5340\u57df\u9032\u884c\u3002\n- `TPU`\uff1a\u4f7f\u7528 64 \u500b TPU v3 Pod \u6838\u5fc3\u9032\u884c\u8abf\u512a\u3002\u8acb\u78ba\u4fdd\u60a8\u6709\u8db3\u5920\u7684 [\u914d\u984d](https://cloud.google.com/vertex-ai/generative-ai/docs/models/tune-models?hl=zh-cn#quota) \u3002\u4e0d\u652f\u6301 [CMEK](https://cloud.google.com/vertex-ai/docs/general/cmek?hl=zh-cn) \uff0c\u4f46\u652f\u6301 [VPC-SC](https://cloud.google.com/vertex-ai/docs/general/vpc-service-controls?hl=zh-cn) \u3002\u5982\u679c\u60a8\u9078\u64c7`TPU`\uff0c\u5247\u6a21\u578b\u8abf\u512a\u8a08\u7b97\u6703\u5728`europe-west4`\u5340\u57df\u9032\u884c\u3002\n- **\u6dfb\u52a0 TensorBoard \u5be6\u4f8b** \uff1a\uff08\u53ef\u9078\uff09 [Vertex AI TensorBoard \u5be6\u4f8b](https://cloud.google.com/vertex-ai/docs/experiments/tensorboard-setup?hl=zh-cn#tensorboard_id) \u7684 ID\u3002Vertex AI TensorBoard \u5be6\u4f8b\u7528\u65bc\u5728\u8abf\u512a\u4f5c\u696d\u5b8c\u6210\u5f8c\u5275\u5efa [\u5be6\u9a57](https://cloud.google.com/vertex-ai/docs/experiments/create-experiment?hl=zh-cn) \u3002Vertex AI TensorBoard \u5be6\u4f8b\u9700\u8981\u8207\u8abf\u512a\u6d41\u6c34\u7dda\u4f4d\u65bc\u540c\u4e00\u5340\u57df\u3002\n- **\u52a0\u5bc6** \uff08\u53ef\u9078\uff09\u9078\u64c7\u4f7f\u7528 Google \u7ba1\u7406\u7684\u52a0\u5bc6\u5bc6\u9470\u6216\u5ba2\u6236\u7ba1\u7406\u7684\u52a0\u5bc6\u5bc6\u9470 (CMEK)\u3002CMEK \u53ea\u80fd\u5728`us-central1`\u5340\u57df\u7528\u65bc\u52a0\u5bc6\u3002\u5728\u6240\u6709\u5176\u4ed6 [\u53ef\u7528\u5340\u57df](https://cloud.google.com/vertex-ai/generative-ai/docs/models/tune-text-models-supervised?hl=zh-cn#supported-supervised-tuning-regions) \u4e2d\uff0c\u7cfb\u7d71\u6703\u4f7f\u7528 Google \u7ba1\u7406\u7684\u52a0\u5bc6\u5bc6\u9470\u3002\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [CMEK \u6982\u89bd](https://cloud.google.com/kms/docs/cmek?hl=zh-cn) \u3002\n- **\u670d\u52d9\u8cec\u865f** \uff08\u53ef\u9078\uff09\u9078\u64c7\u7528\u6236\u7ba1\u7406\u7684\u670d\u52d9\u8cec\u865f\u3002\u670d\u52d9\u8cec\u865f\u6c7a\u5b9a\u4e86\u60a8\u7684\u670d\u52d9\u4ee3\u78bc\u53ef\u4ee5\u8a2a\u554f\u54ea\u4e9b Google Cloud \u8cc7\u6e90\u3002\u5982\u679c\u60a8\u672a\u9078\u64c7\u670d\u52d9\u8cec\u865f\uff0c\u5247\u7cfb\u7d71\u6703\u4f7f\u7528\u7531 Google \u7ba1\u7406\u7684\u670d\u52d9\u8cec\u865f\uff0c\u5176\u4e2d\u5305\u542b\u9069\u5408\u5927\u591a\u6578\u6a21\u578b\u7684\u6b0a\u9650\u3002\n- \u9ede\u64ca **\u7e7c\u7e8c** \n- \u5982\u679c\u8981\u4e0a\u50b3\u6578\u64da\u96c6\u6587\u4ef6\uff0c\u8acb\u9078\u64c7radio_button_checked **\u5c07 JSONL \u6587\u4ef6\u4e0a\u50b3\u5230 Cloud Storage** \u3002\u5982\u679c\u60a8\u7684\u6578\u64da\u96c6\u6587\u4ef6\u5df2\u5728 Cloud Storage \u5b58\u5132\u6876\u4e2d\uff0c\u8acb\u9078\u64c7radio_button_checked **Cloud Storage \u4e0a\u7684\u73fe\u6709 JSONL \u6587\u4ef6** \u3002- \u5728 **\u9078\u64c7 JSONL \u6587\u4ef6** \u4e2d\uff0c\u9ede\u64ca **\u700f\u89bd** \u4e26\u9078\u64c7\u6578\u64da\u96c6\u6587\u4ef6\u3002\n- \u5728 **\u6578\u64da\u96c6\u4f4d\u7f6e** \u4e2d\uff0c\u9ede\u64ca **\u700f\u89bd** \u4e26\u9078\u64c7\u8981\u5b58\u5132\u6578\u64da\u96c6\u6587\u4ef6\u7684 Cloud Storage \u5b58\u5132\u6876\u3002\n\u5728 **Cloud Storage \u6587\u4ef6\u8def\u5f91** \u4e2d\uff0c\u9ede\u64ca **\u700f\u89bd** \uff0c\u7136\u5f8c\u9078\u64c7\u6578\u64da\u96c6\u6587\u4ef6\u6240\u5728\u7684 Cloud Storage \u5b58\u5132\u6876\u3002\n- \uff08\u53ef\u9078\uff09\u5982\u9700\u8a55\u4f30\u8abf\u512a\u5f8c\u7684\u6a21\u578b\uff0c\u8acb\u9078\u64c7 **\u5553\u7528\u6a21\u578b\u8a55\u4f30** \u4e26\u914d\u7f6e\u6a21\u578b\u8a55\u4f30\uff1a- **\u8a55\u4f30\u6578\u64da\u96c6** \uff1a\uff08\u53ef\u9078\uff09\u5305\u542b\u8a55\u4f30\u6578\u64da\u96c6\uff08\u7528\u65bc\u6279\u91cf\u9810\u6e2c\u548c\u8a55\u4f30\uff09\u7684 JSONL \u6587\u4ef6\u7684 URI\u3002`chat-bison`\u4e0d\u652f\u6301\u8a55\u4f30\u3002\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [\u7528\u65bc\u8abf\u512a\u4ee3\u78bc\u6a21\u578b\u7684\u6578\u64da\u96c6\u683c\u5f0f](https://cloud.google.com/vertex-ai/generative-ai/docs/models/tune-text-models?hl=zh-cn#dataset-format) \u3002\u8a55\u4f30\u6578\u64da\u96c6\u9700\u8981 10 \u5230 250 \u500b\u6a23\u672c\u3002\n- **\u8a55\u4f30\u9593\u9694** \uff08\u53ef\u9078\uff0c\u9ed8\u8a8d\u503c\u7232`20`\uff09\u6bcf\u6b21\u8a55\u4f30\u4e4b\u9593\u7684\u8abf\u512a\u6b65\u6578\u3002\u804a\u5929\u6a21\u578b\u4e0d\u652f\u6301\u8a55\u4f30\u9593\u9694\u3002\u7531\u65bc\u8a55\u4f30\u662f\u91dd\u5c0d\u6574\u500b\u8a55\u4f30\u6578\u64da\u96c6\u904b\u884c\uff0c\u56e0\u6b64\u8a55\u4f30\u9593\u9694\u8d8a\u5c0f\uff0c\u8abf\u512a\u6642\u9593\u5c31\u8d8a\u9577\u3002\u4f8b\u5982\uff0c\u5982\u679c`steps`\u7232 200 \u4e14`EVAL_INTERVAL`\u7232 100\uff0c\u5247\u60a8\u5c07\u50c5\u7372\u5f97\u8a55\u4f30\u6307\u6a19\u7684\u5169\u500b\u6578\u64da\u9ede\u3002\u6b64\u53c3\u6578\u8981\u6c42\u8a2d\u7f6e`evalutation_data_uri`\u3002\n- **\u5553\u7528\u65e9\u505c\u6cd5** \uff1a\uff08\u53ef\u9078\uff0c\u9ed8\u8a8d\u503c\u7232`true`\uff09`boolean`\uff0c\u5982\u679c\u8a2d\u7f6e\u7232`true`\uff0c\u4e14\u6a21\u578b\u6027\u80fd\u5728\u5169\u6b21\u8a55\u4f30\u904b\u884c\u4e2d\u6c92\u6709\u5f97\u5230\u8db3\u5920\u7684\u6539\u9032\uff08\u901a\u904e\u9810\u6e2c\u8a5e\u5143\u7684\u6e96\u78ba\u7387\u4f86\u8861\u91cf\uff09\uff0c\u5247\u5728\u5b8c\u6210\u6240\u6709\u8abf\u512a\u6b65\u9a5f\u4e4b\u524d\u505c\u6b62\u8abf\u512a\u3002\u5982\u679c\u7232`false`\uff0c\u5247\u7e7c\u7e8c\u8abf\u512a\uff0c\u76f4\u5230\u6240\u6709\u8abf\u512a\u6b65\u9a5f\u5b8c\u6210\u3002\u6b64\u53c3\u6578\u8981\u6c42\u8a2d\u7f6e`evaluation_data_uri`\u3002 \u804a\u5929\u6a21\u578b\u4e0d\u652f\u6301\u5553\u7528\u65e9\u505c\u6cd5\u3002\n- **\u5553\u7528\u6aa2\u67e5\u9ede\u9078\u64c7** \uff1a\u5553\u7528\u5f8c\uff0c\u751f\u6210\u5f0f AI \u6703\u5f9e\u8abf\u512a\u4f5c\u696d\u671f\u9593\u5275\u5efa\u7684\u6240\u6709\u6aa2\u67e5\u9ede\u4e2d\u9078\u64c7\u4e26\u8fd4\u56de\u5177\u6709\u6700\u4f73\u6a21\u578b\u8a55\u4f30\u6027\u80fd\u7684\u6aa2\u67e5\u9ede\u3002\u505c\u7528\u5f8c\uff0c\u7cfb\u7d71\u5c07\u8fd4\u56de\u5728\u8abf\u7bc0\u4f5c\u696d\u671f\u9593\u5275\u5efa\u7684\u6700\u7d42\u6aa2\u67e5\u9ede\u3002\u6bcf\u500b\u6aa2\u67e5\u9ede\u662f\u6307\u6a21\u578b\u5728\u8abf\u7bc0\u4f5c\u696d\u671f\u9593\u7684\u5feb\u7167\u3002\n- **TensorBoard \u5be6\u4f8b** \uff1a \uff08\u53ef\u9078\uff09 [Vertex AI TensorBoard \u5be6\u4f8b](https://cloud.google.com/vertex-ai/docs/experiments/tensorboard-setup?hl=zh-cn#tensorboard_id) \u7684 ID\u3002Vertex AI TensorBoard \u5be6\u4f8b\u7528\u65bc\u5728\u8abf\u512a\u4f5c\u696d\u5b8c\u6210\u5f8c\u5275\u5efa [\u5be6\u9a57](https://cloud.google.com/vertex-ai/docs/experiments/create-experiment?hl=zh-cn) \u3002Vertex AI TensorBoard \u5be6\u4f8b\u9700\u8981\u8207\u8abf\u512a\u6d41\u6c34\u7dda\u4f4d\u65bc\u540c\u4e00\u5340\u57df\u3002\n- \u9ede\u64ca **\u958b\u59cb\u8abf\u512a** \u3002**\u6ce8\u610f** \uff1a\u6240\u6709\u4e2d\u9593\u6d41\u6c34\u7dda\u6578\u64da\uff08\u4f8b\u5982\u5df2\u8655\u7406\u7684\u6578\u64da\u96c6\uff09\u90fd\u5b58\u5132\u5728 [\u6d41\u6c34\u7dda\u4f5c\u696d\u5340\u57df](#pipeline-region) \u4e2d\u3002\u6a21\u578b\u8abf\u512a\u8a08\u7b97\u5728 [\u6a21\u578b\u8abf\u512a\u5340\u57df](#tuning-region) \u4e2d\u9032\u884c\u3002\u6a21\u578b\u6703\u90e8\u7f72\u5230 [\u6a21\u578b\u4e0a\u50b3\u5340\u57df](#upload-region) \u3002\n```\nPROJECT_ID=myprojectDATASET_URI=gs://my-gcs-bucket-uri/datasetOUTPUT_DIR=gs://my-gcs-bucket-uri/outputACCELERATOR_TYPE=GPULOCATION=us-central1curl \\-X POST \\-H \"Authorization: Bearer $(gcloud auth print-access-token)\" \\-H \"Content-Type: application/json; charset=utf-8\" \\\"https://europe-west4-aiplatform.googleapis.com/v1/projects/${PROJECT_ID}/locations/europe-west4/pipelineJobs?pipelineJobId=tune-large-model-$(date +%Y%m%d%H%M%S)\" -d \\$'{\u00a0 \"displayName\": \"tune-llm\",\u00a0 \"runtimeConfig\": {\u00a0 \u00a0 \"gcsOutputDirectory\": \"'${OUTPUT_DIR}'\",\u00a0 \u00a0 \"parameterValues\": {\u00a0 \u00a0 \u00a0 \"project\": \"'${PROJECT_ID}'\",\u00a0 \u00a0 \u00a0 \"model_display_name\": \"The display name for your model in the UI\",\u00a0 \u00a0 \u00a0 \"dataset_uri\": \"'${DATASET_URI}'\",\u00a0 \u00a0 \u00a0 \"location\": \"'${LOCATION}'\",\u00a0 \u00a0 \u00a0 \"accelerator_type:\": \"'${ACCELERATOR_TYPE}'\",\u00a0 \u00a0 \u00a0 \"large_model_reference\": \"text-bison@002\",\u00a0 \u00a0 \u00a0 \"train_steps\": 300,\u00a0 \u00a0 \u00a0 \"learning_rate_multiplier\": 1,\u00a0 \u00a0 \u00a0 \"encryption_spec_key_name\": \"projects/myproject/locations/us-central1/keyRings/sample-key/cryptoKeys/sample-key\"\u00a0 \u00a0 }\u00a0 },\u00a0 \"encryptionSpec\": {\u00a0 \u00a0 \"kmsKeyName\": \"projects/myproject/locations/us-central1/keyRings/sample-key/cryptoKeys/sample-key\"\u00a0 },\u00a0 \"templateUri\": \"https://us-kfp.pkg.dev/ml-pipeline/large-language-model-pipelines/tune-large-model/v2.0.0\"}'\n```\n### \u5efa\u8b70\u7684\u914d\u7f6e\n\u4e0b\u8868\u986f\u793a\u4e86\u8abf\u6574\u57fa\u790e\u6a21\u578b\u7684\u5efa\u8b70\u914d\u7f6e\uff0c\u6309\u4efb\u52d9\u5217\u51fa\uff1a\n| \u4efb\u52d9   | \u6578\u64da\u96c6\u4e2d\u7684\u793a\u4f8b\u6578 | \u8a13\u7df4\u6b65\u6578 |\n|:-------------|:-------------------|:-----------|\n| \u5206\u985e   | \u8d85\u904e 100 \u500b  | 100-500 |\n| \u6458\u8981   | 100-500+   | 200-1000 |\n| \u62bd\u6a23\u8cea\u91cf\u6aa2\u67e5 | \u8d85\u904e 100 \u500b  | 100-500 |\n| \u804a\u5929   | 200 \u591a\u500b   | 1000  |\n\u5c0d\u65bc\u8a13\u7df4\u6b65\u9a5f\uff0c\u60a8\u53ef\u4ee5\u91dd\u5c0d\u7279\u5b9a\u6578\u64da\u96c6\u5617\u8a66\u4f7f\u7528\u591a\u500b\u503c\u4f86\u7372\u5f97\u6700\u4f73\u6027\u80fd\uff0c\u4f8b\u5982 100\u3001200\u3001500\u3002\n## \u67e5\u770b\u7d93\u904e\u8abf\u6574\u7684\u6a21\u578b\u5217\u8868\n\u60a8\u53ef\u4ee5\u4f7f\u7528 Google Cloud \u63a7\u5236\u6aaf\u6216 Python \u7248 Vertex AI SDK \u67e5\u770b\u7576\u524d\u9805\u76ee\u4e2d\u7684\u6a21\u578b\u5217\u8868\uff0c\u5305\u62ec\u7d93\u904e\u8abf\u6574\u7684\u6a21\u578b\u3002\n\u5728\u5617\u8a66\u6b64\u793a\u4f8b\u4e4b\u524d\uff0c\u8acb\u6309\u7167 [\u300a\u751f\u6210\u5f0f AI \u5feb\u901f\u5165\u9580\uff1a\u4f7f\u7528\u5ba2\u6236\u7aef\u5eab\u300b](https://cloud.google.com/vertex-ai/docs/start/client-libraries?hl=zh-cn) \u4e2d\u7684 Python \u8a2d\u7f6e\u8aaa\u660e\u57f7\u884c\u64cd\u4f5c\u3002\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [\u751f\u6210\u5f0f AI Python API \u53c3\u8003\u6587\u6a94](https://cloud.google.com/python/docs/reference/aiplatform/latest?hl=zh-cn) \u3002\n\u5982\u9700\u5411\u751f\u6210\u5f0f AI \u9032\u884c\u8eab\u4efd\u9a57\u8b49\uff0c\u8acb\u8a2d\u7f6e\u61c9\u7528\u9ed8\u8a8d\u6191\u64da\u3002\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [\u7232\u672c\u5730\u958b\u767c\u74b0\u5883\u8a2d\u7f6e\u8eab\u4efd\u9a57\u8b49](https://cloud.google.com/docs/authentication/provide-credentials-adc?hl=zh-cn#local-dev) \u3002\n [\u5728 GitHub \u4e0a\u67e5\u770b](https://github.com/GoogleCloudPlatform/python-docs-samples/blob/HEAD/generative_ai/list_tuned_models.py) \n```\nimport vertexaifrom vertexai.language_models import TextGenerationModeldef list_tuned_models(\u00a0 \u00a0 project_id: str,\u00a0 \u00a0 location: str,) -> None:\u00a0 \u00a0 \"\"\"List tuned models.\"\"\"\u00a0 \u00a0 vertexai.init(project=project_id, location=location)\u00a0 \u00a0 model = TextGenerationModel.from_pretrained(\"text-bison@002\")\u00a0 \u00a0 tuned_model_names = model.list_tuned_model_names()\u00a0 \u00a0 print(tuned_model_names)\u00a0 \u00a0 return tuned_model_names\n```\u5982\u9700\u5728 Google Cloud \u63a7\u5236\u6aaf\u4e2d\u67e5\u770b\u8abf\u6574\u5f8c\u6a21\u578b\uff0c\u8acb\u9032\u5165 **Vertex AI Model Registry** \u9801\u9762\u3002\n [\u9032\u5165 Vertex AI Model Registry](https://console.cloud.google.com/vertex-ai/models?hl=zh-cn)\n## \u52a0\u8f09\u8abf\u6574\u5f8c\u7684\u6587\u672c\u6a21\u578b\n\u4ee5\u4e0b\u793a\u4f8b\u4ee3\u78bc\u4f7f\u7528 Python \u7248 Vertex AI SDK \u52a0\u8f09\u4f7f\u7528\u76e3\u7763\u5f0f\u8abf\u6574\u65b9\u6cd5\u8abf\u6574\u7684\u6587\u672c\u751f\u6210\u6a21\u578b\uff1a\n```\nimport vertexaifrom vertexai.preview.language_models import TextGenerationModelmodel = TextGenerationModel.get_tuned_model(TUNED_MODEL_NAME)\n```\n\u5c07 `` \u66ff\u63db\u7232\u7d93\u904e\u8abf\u6574\u7684\u6a21\u578b\u7684\u9650\u5b9a\u8cc7\u6e90\u540d\u7a31\u3002\u6b64\u540d\u7a31\u7684\u683c\u5f0f\u7232 `projects/` `` `/locations/` `` `/models/` `` \u3002\u60a8\u53ef\u4ee5\u5728 [Vertex AI Model Registry](https://console.cloud.google.com/vertex-ai/models?hl=zh-cn) \u4e2d\u627e\u5230\u7d93\u904e\u8abf\u6574\u7684\u6a21\u578b\u7684\u6a21\u578b ID\u3002\n## \u8abf\u6574\u548c\u8a55\u4f30\u6307\u6a19\n\u60a8\u53ef\u4ee5\u914d\u7f6e\u6a21\u578b\u8abf\u512a\u4f5c\u696d\u4f86\u6536\u96c6\u548c\u5831\u544a\u6a21\u578b\u8abf\u512a\u548c\u6a21\u578b\u8a55\u4f30\u6307\u6a19\uff0c\u7136\u5f8c\u53ef\u4ee5\u4f7f\u7528 [Vertex AI TensorBoard](https://cloud.google.com/vertex-ai/docs/experiments/tensorboard-introduction?hl=zh-cn) \u76f4\u89c0\u5448\u73fe\u9019\u4e9b\u6307\u6a19\u3002\u5982\u9700\u5c07\u8abf\u512a\u4f5c\u696d\u9023\u63a5\u5230 Vertex AI TensorBoard\uff0c\u8acb\u6307\u5b9a [Vertex AI TensorBoard \u5be6\u4f8b ID](https://cloud.google.com/vertex-ai/docs/experiments/tensorboard-setup?hl=zh-cn#tensorboard_id) \u548c\u8a55\u4f30\u6578\u64da\u96c6\u3002\n### \u6a21\u578b\u8abf\u512a\u6307\u6a19\n\u60a8\u53ef\u4ee5\u914d\u7f6e\u6a21\u578b\u8abf\u512a\u4f5c\u696d\u4f86\u6536\u96c6 `chat-bison` \u3001 `code-bison` \u3001 `codechat-bison` \u548c `text-bison` \u7684\u4ee5\u4e0b\u8abf\u512a\u6307\u6a19\uff1a\n- `/train_total_loss`\uff1a\u4e00\u500b\u8a13\u7df4\u6b65\u9577\u4e2d\u8abf\u512a\u6578\u64da\u96c6\u7684\u640d\u5931\u3002\n- `/train_fraction_of_correct_next_step_preds`\uff1a\u4e00\u500b\u8a13\u7df4\u6b65\u9577\u4e2d\u7684\u8a5e\u5143\u6e96\u78ba\u7387\u3002\u55ae\u500b\u9810\u6e2c\u7531\u4e00\u7cfb\u5217\u8a5e\u5143\u7d44\u6210\u3002\u8a72\u6307\u6a19\u8861\u91cf\u9810\u6e2c\u8a5e\u5143\u7684\u6e96\u78ba\u7387\uff08\u8207\u8abf\u512a\u6578\u64da\u96c6\u4e2d\u7684\u6a19\u6e96\u7b54\u6848\u76f8\u6bd4\uff09\u3002\n- `/train_num_predictions:`\uff1a\u4e00\u500b\u8a13\u7df4\u6b65\u9577\u4e2d\u7684\u9810\u6e2c\u8a5e\u5143\u6578\u3002\n### \u6a21\u578b\u8a55\u4f30\u6307\u6a19\uff1a\n\u60a8\u53ef\u4ee5\u914d\u7f6e\u6a21\u578b\u8abf\u512a\u4f5c\u696d\u4f86\u6536\u96c6 `code-bison` \u548c `text-bison` \u7684\u4ee5\u4e0b\u8a55\u4f30\u6307\u6a19\uff1a\n- `/eval_total_loss`\uff1a\u4e00\u500b\u8a55\u4f30\u6b65\u9577\u4e2d\u8a55\u4f30\u6578\u64da\u96c6\u7684\u640d\u5931\u3002\n- `/eval_fraction_of_correct_next_step_preds`\uff1a\u4e00\u500b\u8a55\u4f30\u6b65\u9577\u4e2d\u7684\u8a5e\u5143\u6e96\u78ba\u7387\u3002\u55ae\u500b\u9810\u6e2c\u7531\u4e00\u7cfb\u5217\u8a5e\u5143\u7d44\u6210\u3002\u8a72\u6307\u6a19\u8861\u91cf\u8a55\u4f30\u8a5e\u5143\u7684\u6e96\u78ba\u7387\uff08\u8207\u8a55\u4f30\u6578\u64da\u96c6\u4e2d\u7684\u6a19\u6e96\u7b54\u6848\u76f8\u6bd4\uff09\u3002\n- `/eval_num_predictions`\uff1a\u4e00\u500b\u8a55\u4f30\u6b65\u9577\u4e2d\u7684\u9810\u6e2c\u8a5e\u5143\u6578\u3002\n\u6a21\u578b\u8abf\u512a\u4f5c\u696d\u5b8c\u6210\u5f8c\u5c07\u63d0\u4f9b\u6307\u6a19\u7684\u53ef\u8996\u5316\u5167\u5bb9\u3002 \u5982\u679c\u60a8\u5728\u5275\u5efa\u8abf\u512a\u4f5c\u696d\u6642\u50c5\u6307\u5b9a Vertex AI TensorBoard \u5be6\u4f8b ID \u800c\u4e0d\u6307\u5b9a\u8a55\u4f30\u6578\u64da\u96c6\uff0c\u5247\u53ea\u63d0\u4f9b\u8abf\u512a\u6307\u6a19\u7684\u53ef\u8996\u5316\u5167\u5bb9\u3002\n## \u554f\u984c\u6392\u67e5\n\u4ee5\u4e0b\u4e3b\u984c\u53ef\u5e6b\u52a9\u60a8\u89e3\u6c7a\u4f7f\u7528\u76e3\u7763\u5f0f\u8abf\u6574\u65b9\u6cd5\u4f86\u8abf\u6574\u57fa\u790e\u6587\u672c\u6a21\u578b\u6642\u9047\u5230\u7684\u554f\u984c\u3002\n\u5982\u679c\u60a8\u5728\u5617\u8a66\u8abf\u6574\u6a21\u578b\u6642\u9047\u5230 500 \u932f\u8aa4\uff0c\u8acb\u5617\u8a66\u6b64\u89e3\u6c7a\u65b9\u6cd5\uff1a\n\u904b\u884c\u4ee5\u4e0b cURL \u547d\u4ee4\uff0c\u5275\u5efa\u4e00\u500b\u7a7a\u7684 Vertex AI \u4e0a\u7684\u751f\u6210\u5f0f AI \u6578\u64da\u96c6\u3002\u8acb\u78ba\u4fdd\u5728\u547d\u4ee4\u4e2d\u914d\u7f6e\u60a8\u7684\u9805\u76ee ID\u3002\n```\ncurl \\-X POST \\-H \"Authorization: Bearer $(gcloud auth print-access-token)\" \\-H \"Content-Type: application/json\" \\https://europe-west4-aiplatform.googleapis.com/ui/projects/$PROJECT_ID/locations/europe-west4/datasets \\-d '{\u00a0 \u00a0 \"display_name\": \"test-name1\",\u00a0 \u00a0 \"metadata_schema_uri\": \"gs://google-cloud-aiplatform/schema/dataset/metadata/image_1.0.0.yaml\",\u00a0 \u00a0 \"saved_queries\": [{\"display_name\": \"saved_query_name\", \"problem_type\": \"IMAGE_CLASSIFICATION_MULTI_LABEL\"}]}'\n```\n\u547d\u4ee4\u5b8c\u6210\u5f8c\uff0c\u7b49\u5f85\u4e94\u5206\u9418\uff0c\u7136\u5f8c\u518d\u6b21\u5617\u8a66\u8abf\u6574\u6a21\u578b\u3002\n\u78ba\u4fdd\u5df2\u5553\u7528 Compute Engine API\uff0c\u4e26\u4e14\u9ed8\u8a8d Compute Engine \u670d\u52d9\u8cec\u865f ( `` `\u2011compute@developer.gserviceaccount.com` ) \u5df2\u88ab\u6388\u4e88 [aiplatform.admin](https://cloud.google.com/vertex-ai/docs/general/access-control?hl=zh-cn#aiplatform.admin) \u548c [storage.objectAdmin](https://cloud.google.com/storage/docs/access-control/iam-roles?hl=zh-cn#standard-roles) \u89d2\u8272\u3002\n\u5982\u9700\u5411 Compute Engine \u670d\u52d9\u8cec\u865f\u6388\u4e88 [aiplatform.admin](https://cloud.google.com/vertex-ai/docs/general/access-control?hl=zh-cn#aiplatform.admin) \u548c [storage.objectAdmin](https://cloud.google.com/storage/docs/access-control/iam-roles?hl=zh-cn#standard-roles) \u89d2\u8272\uff0c\u8acb\u57f7\u884c\u4ee5\u4e0b\u64cd\u4f5c\uff1a- Titles in dynamic includes are not used anywhere, and we should avoid paying to translate them\u5728 Google Cloud \u63a7\u5236\u6aaf\u4e2d\uff0c\u6fc0\u6d3b Cloud Shell\u3002 [\u6fc0\u6d3b Cloud Shell](https://console.cloud.google.com/?cloudshell=true&hl=zh-cn)  [Cloud Shell](https://cloud.google.com/shell/docs/how-cloud-shell-works?hl=zh-cn) \u6703\u8a71\u96a8\u5373\u6703\u5728 Google Cloud \u63a7\u5236\u6aaf\u7684\u5e95\u90e8\u5553\u52d5\uff0c\u4e26\u986f\u793a\u547d\u4ee4\u884c\u63d0\u793a\u7b26\u3002Cloud Shell \u662f\u4e00\u500b\u5df2\u5b89\u88dd Google Cloud CLI \u4e14\u5df2\u7232\u7576\u524d\u9805\u76ee\u8a2d\u7f6e\u503c\u7684 Shell \u74b0\u5883\u3002\u8a72\u6703\u8a71\u53ef\u80fd\u9700\u8981\u5e7e\u79d2\u9418\u6642\u9593\u4f86\u5b8c\u6210\u521d\u59cb\u5316\u3002\u5982\u679c\u60a8\u5e0c\u671b\u5728\u6a5f\u5668\u4e0a\u4f7f\u7528\u7d42\u7aef\uff0c\u8acb [\u5b89\u88dd\u548c\u914d\u7f6e Google Cloud CLI](https://cloud.google.com/sdk/docs/install-sdk?hl=zh-cn) \u3002\n- \u4f7f\u7528 [gcloud projects add-iam-policy-binding \u547d\u4ee4](https://cloud.google.com/sdk/gcloud/reference/projects/add-iam-policy-binding?hl=zh-cn) \u5c07 [aiplatform.admin](https://cloud.google.com/vertex-ai/docs/general/access-control?hl=zh-cn#aiplatform.admin) \u89d2\u8272\u95dc\u806f\u5230 Compute Engine \u670d\u52d9\u8cec\u865f\uff1a\u66ff\u63db\u4ee5\u4e0b\u5167\u5bb9\uff1a- \u5c07``\u66ff\u63db\u7232 Google Cloud \u9805\u76ee ID\u3002\n- \u5c07``\u66ff\u63db\u7232\u60a8\u7684 Google Cloud \u9805\u76ee\u7de8\u865f\u3002\n```\ngcloud projects add-iam-policy-binding PROJECT_ID --member serviceAccount:PROJECT_NUM-compute@developer.gserviceaccount.com --role roles/aiplatform.admin\n```\n- \u4f7f\u7528 [gcloud projects add-iam-policy-binding \u547d\u4ee4](https://cloud.google.com/sdk/gcloud/reference/projects/add-iam-policy-binding?hl=zh-cn) \u5c07 [storage.objectAdmin](https://cloud.google.com/storage/docs/access-control/iam-roles?hl=zh-cn#standard-roles) \u89d2\u8272\u95dc\u806f\u5230 Compute Engine \u670d\u52d9\u8cec\u865f\uff1a- \u5c07``\u66ff\u63db\u7232 Google Cloud \u9805\u76ee ID\u3002\n- \u5c07``\u66ff\u63db\u7232\u60a8\u7684 Google Cloud \u9805\u76ee\u7de8\u865f\u3002\n```\ngcloud projects add-iam-policy-binding PROJECT_ID --member serviceAccount:PROJECT_NUM-compute@developer.gserviceaccount.com \u00a0--role roles/storage.objectAdmin\n```\u6b64\u6b0a\u9650\u932f\u8aa4\u662f\u50b3\u64ad\u5ef6\u9072\u5f15\u8d77\u7684\u3002\u5f8c\u7e8c\u91cd\u8a66\u61c9\u53ef\u89e3\u6c7a\u6b64\u932f\u8aa4\u3002\n## \u5f8c\u7e8c\u6b65\u9a5f\n- \u77ad\u89e3\u5982\u4f55 [\u8a55\u4f30\u8abf\u6574\u5f8c\u7684\u6a21\u578b](https://cloud.google.com/vertex-ai/generative-ai/docs/models/evaluate-models?hl=zh-cn) \u3002\n- \u77ad\u89e3\u5982\u4f55 [\u4f7f\u7528 RLHF \u8abf\u6574\u4f86\u8abf\u6574\u57fa\u790e\u6a21\u578b](https://cloud.google.com/vertex-ai/generative-ai/docs/models/tune-text-models-rlhf?hl=zh-cn) \u3002\n- \u77ad\u89e3\u5982\u4f55 [\u8abf\u6574\u4ee3\u78bc\u6a21\u578b](https://cloud.google.com/vertex-ai/generative-ai/docs/models/tune-code-models?hl=zh-cn) \u3002", "guide": "Generative AI on Vertex AI"}