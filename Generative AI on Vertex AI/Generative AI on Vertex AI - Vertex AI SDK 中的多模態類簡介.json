{"title": "Generative AI on Vertex AI - Vertex AI SDK \u4e2d\u7684\u591a\u6a21\u614b\u985e\u7c21\u4ecb", "url": "https://cloud.google.com/vertex-ai/generative-ai/docs/multimodal/sdk-for-gemini/gemini-sdk-overview-reference?hl=zh-cn", "abstract": "# Generative AI on Vertex AI - Vertex AI SDK \u4e2d\u7684\u591a\u6a21\u614b\u985e\u7c21\u4ecb\n\u60a8\u53ef\u4ee5\u4f7f\u7528 [Python \u7248 Vertex AI SDK](https://cloud.google.com/vertex-ai/docs/python-sdk/use-vertex-ai-python-sdk?hl=zh-cn) \u901a\u904e [Gemini \u6a21\u578b](https://cloud.google.com/vertex-ai/generative-ai/docs/multimodal/overview?hl=zh-cn) \u985e\u4ee5\u7de8\u7a0b\u65b9\u5f0f\u5275\u5efa\u89e3\u6c7a\u65b9\u6848\u3002\u60a8\u53ef\u4ee5\u4f7f\u7528 Vertex AI SDK \u52a0\u8f09\u5176\u4e2d\u4e00\u500b\u591a\u6a21\u614b\uff1aGemini Pro \u548c Gemini Pro Vision \u3002\u52a0\u8f09\u6a21\u578b\u5f8c\uff0c\u53ef\u4ee5\u4f7f\u7528\u5b83\u5f9e\u6587\u672c\u63d0\u793a\u3001\u5716\u7247\u6216\u6587\u672c\u63d0\u793a\u548c\u5716\u7247\u751f\u6210\u6587\u672c\u3002\u5982\u9700\u8a73\u7d30\u77ad\u89e3 Gemini \u6a21\u578b\uff0c\u8acb\u53c3\u95b1 [Gemini API \u6a21\u578b](https://cloud.google.com/vertex-ai/generative-ai/docs/learn/models?hl=zh-cn) \u3002\nVertex AI SDK \u4e2d\u8868\u793a\u7684 Gemini \u6a21\u578b\u985e\u662f\u5c0d\u5275\u5efa\u8207\u751f\u6210\u5f0f AI \u548c\u8a9e\u8a00\u6a21\u578b\u7121\u95dc\u7684\u751f\u6210\u5f0f AI \u89e3\u6c7a\u65b9\u6848\u7684\u88dc\u5145\u3002\u5982\u9700\u77ad\u89e3\u5982\u4f55\u4f7f\u7528 Vertex AI SDK \u81ea\u52d5\u57f7\u884c\u6578\u64da\u6ce8\u5165\u3001\u8a13\u7df4\u6a21\u578b\u4e26\u5728\u751f\u6210\u5f0f AI \u4e0a\u7372\u53d6\u9810\u6e2c\u7d50\u679c\uff0c\u8acb\u53c3\u95b1 [Python \u7248 Vertex AI SDK \u7c21\u4ecb](https://cloud.google.com/vertex-ai/docs/python-sdk/use-vertex-ai-python-sdk?hl=zh-cn) \u3002\n", "content": "## \u5b89\u88dd Vertex AI SDK\n\u5982\u9700\u5b89\u88dd Python \u7248 Vertex AI SDK\uff0c\u8acb\u904b\u884c\u4ee5\u4e0b\u547d\u4ee4\uff1a\n```\npip install --upgrade google-cloud-aiplatform\n```\n\u5982\u9700\u77ad\u89e3\u8a73\u60c5\uff0c\u8acb\u53c3\u95b1 [\u5b89\u88dd Python \u7248 Vertex AI SDK](https://cloud.google.com/vertex-ai/docs/start/install-sdk?hl=zh-cn) \u3002 \u5982\u9700\u67e5\u770b [Vertex AI SDK \u53c3\u8003\u6307\u5357](https://cloud.google.com/python/docs/reference/aiplatform/latest/google.cloud.aiplatform?hl=zh-cn) \u4e2d\u7684\u8a9e\u8a00\u6a21\u578b\u90e8\u5206\uff0c\u8acb\u53c3\u95b1 [\u8edf\u4ef6\u5305\u8a9e\u8a00\u6a21\u578b](https://cloud.google.com/python/docs/reference/aiplatform/latest/vertexai.language_models?hl=zh-cn) \u3002\n## \u5c0d Vertex AI SDK \u9032\u884c\u8eab\u4efd\u9a57\u8b49\n\u5b89\u88dd Python \u7248 Vertex AI SDK \u5f8c\uff0c\u60a8\u9700\u8981\u9032\u884c\u8eab\u4efd\u9a57\u8b49\u3002\u4ee5\u4e0b\u4e3b\u984c\u4ecb\u7d39\u4e86\u5728\u672c\u5730\u5de5\u4f5c\u4ee5\u53ca\u4f7f\u7528 Colaboratory \u6642\u5982\u4f55\u5411 Vertex AI SDK \u9032\u884c\u8eab\u4efd\u9a57\u8b49\uff1a\n- \u5982\u679c\u60a8\u662f\u5728\u672c\u5730\u958b\u767c\uff0c\u8acb\u57f7\u884c\u4ee5\u4e0b\u64cd\u4f5c\uff0c\u4ee5\u5728\u672c\u5730\u74b0\u5883\u4e2d\u8a2d\u7f6e [\u61c9\u7528\u9ed8\u8a8d\u6191\u64da (ADC)](https://cloud.google.com/docs/authentication/application-default-credentials?hl=zh-cn) \uff1a- [\u5b89\u88dd](https://cloud.google.com/sdk/docs/install?hl=zh-cn) Google Cloud CLI\uff0c\u7136\u5f8c\u901a\u904e\u904b\u884c\u4ee5\u4e0b\u547d\u4ee4\u5c0d\u5176\u9032\u884c [initialize](https://cloud.google.com/sdk/docs/initializing?hl=zh-cn) \uff1a```\ngcloud init\n```\n- \u7232\u60a8\u7684 Google \u8cec\u865f\u5275\u5efa\u672c\u5730\u8eab\u4efd\u9a57\u8b49\u6191\u64da\uff1a```\ngcloud auth application-default login\n```\u7cfb\u7d71\u6703\u986f\u793a\u767b\u9304\u5c4f\u5e55\u3002\u5728\u60a8\u767b\u9304\u5f8c\uff0c\u60a8\u7684\u6191\u64da\u6703\u5b58\u5132\u5728 ADC \u4f7f\u7528\u7684\u672c\u5730\u6191\u64da\u6587\u4ef6\u4e2d\u3002\u5982\u9700\u8a73\u7d30\u77ad\u89e3\u5982\u4f55\u5728\u672c\u5730\u74b0\u5883\u4e2d\u4f7f\u7528 ADC\uff0c\u8acb\u53c3\u95b1 [\u672c\u5730\u958b\u767c\u74b0\u5883](https://cloud.google.com/docs/authentication/provide-credentials-adc?hl=zh-cn#local-dev) \u3002\n- \u5728 Colaboratory \u4e2d\uff0c\u5728 Colab \u55ae\u5143\u4e2d\u904b\u884c\u4ee5\u4e0b\u547d\u4ee4\u4ee5\u9032\u884c\u8eab\u4efd\u9a57\u8b49\uff1a```\nfrom google.colab import authauth.authenticate_user()\n```\u6b64\u547d\u4ee4\u5c07\u6253\u958b\u4e00\u500b\u7a97\u53e3\uff0c\u60a8\u53ef\u5728\u5176\u4e2d\u5b8c\u6210\u8eab\u4efd\u9a57\u8b49\u3002## \u52a0\u8f09 Gemini \u6a21\u578b\n\u5982\u9700\u4f7f\u7528 Vertex AI SDK \u5f15\u7528\u591a\u6a21\u614b\u6a21\u578b\uff0c\u8acb\u5f9e `vertexai.preview.generative_models` \u5c0e\u5165 `GenerativeModel` \uff0c\u7136\u5f8c\u4f7f\u7528 `GenerativeModel` \u52a0\u8f09\u8a72\u6a21\u578b\u3002\u4ee5\u4e0b\u793a\u4f8b\u4ee3\u78bc\u5c55\u793a\u77ad\u5982\u4f55\u52a0\u8f09 Gemini Pro \u548c Gemini Pro Vision \u6a21\u578b\uff1a\n```\nfrom vertexai.preview.generative_models import GenerativeModel# Load Gemini Progemini_pro_model = GenerativeModel(\"gemini-1.0-pro\")# Load Gemini Pro Visiongemini_pro_vision_model = GenerativeModel(\"gemini-1.0-pro-vision\")\n```\n## GenerativeModel \u985e\u4ee3\u78bc\u793a\u4f8b\n`GenerativeModel` \u985e\u8868\u793a Gemini \u6a21\u578b\u3002\u60a8\u53ef\u4ee5\u4f7f\u7528\u5b83\u52a0\u8f09 Gemini Pro \u6216 Gemini Pro Vision \u6a21\u578b\u3002 `GenerativeModel` \u985e\u5305\u542b\u591a\u7a2e\u65b9\u6cd5\uff0c\u53ef\u5e6b\u52a9\u60a8\u901a\u904e\u6587\u672c\u3001\u5716\u7247\u548c\u8996\u983b\u5167\u5bb9\u751f\u6210\u5167\u5bb9\u3002\u4ee5\u4e0b\u4ee3\u78bc\u793a\u4f8b\u6f14\u793a\u77ad\u5982\u4f55\u4f7f\u7528 `GenerativeModel` \u985e\u3002\n- [\u4f7f\u7528\u6587\u672c\u63d0\u793a\u751f\u6210\u5167\u5bb9](#generate-content-from-text) \n- [\u4f7f\u7528\u591a\u500b\u6587\u672c\u63d0\u793a\u751f\u6210\u5167\u5bb9](#generate-content-from-multiple-text-prompts) \n- [\u751f\u6210\u5716\u7247\u7684\u8aaa\u660e](#generate-content-from-image) \n- [\u5f9e\u6587\u672c\u548c\u5716\u7247\u751f\u6210\u5167\u5bb9](#generate-content-from-text-and-image) \n- [\u5f9e\u8996\u983b\u751f\u6210\u5167\u5bb9](#generate-content-from-video) \n### \u4f7f\u7528\u6587\u672c\u63d0\u793a\u751f\u6210\u5167\u5bb9\n\u4ee5\u4e0b\u4ee3\u78bc\u793a\u4f8b\u4f7f\u7528 Gemini Pro \u591a\u6a21\u614b\u751f\u6210\u95dc\u65bc\u73ab\u7470\u7684\u6587\u672c\uff1a\n```\nfrom vertexai.preview.generative_models import GenerativeModelgemini_pro_model = GenerativeModel(\"gemini-1.0-pro\")model_response = gemini_pro_model.generate_content(\"Why do cars have four wheels?\")print(\"model_response\\n\",model_response)\n```\n\u6b64\u793a\u4f8b\u4ee3\u78bc\u7684\u97ff\u61c9\u53ef\u80fd\u8207\u4ee5\u4e0b\u5167\u5bb9\u985e\u4f3c\u3002\u7232\u7c21\u6f54\u8d77\u898b\uff0c\u8fd4\u56de\u7684\u6587\u672c\u5df2\u622a\u65b7\u3002\n```\ncandidates {\u00a0 content {\u00a0 \u00a0 parts {\u00a0 \u00a0 \u00a0 text: \"1. **Stability:** Four wheels provide a wider base of support,\u00a0 \u00a0 \u00a0 \u00a0 which increases the vehicle\\'s stability. This is especially important\u00a0 \u00a0 \u00a0 \u00a0 when cornering or driving on uneven surfaces.\\n\\n2....\"\u00a0 \u00a0 }\u00a0 }}usage_metadata {\u00a0 prompt_token_count: 7\u00a0 candidates_token_count: 323\u00a0 total_token_count: 330}\n```\n### \u4f7f\u7528\u591a\u500b\u6587\u672c\u63d0\u793a\u751f\u6210\u5167\u5bb9\n\u4ee5\u4e0b\u4ee3\u78bc\u793a\u4f8b\u4f7f\u7528 Gemini Pro \u591a\u6a21\u614b\uff0c\u901a\u904e\u591a\u500b\u6587\u672c\u63d0\u793a\u751f\u6210\u6587\u672c\uff1a\n```\nfrom vertexai.preview.generative_models import GenerativeModelgemini_pro_model = GenerativeModel(\"gemini-1.0-pro\")model_response = gemini_pro_model.generate_content([\"What is x multiplied by 2?\", \"x = 42\"])print(\"model_response\\n\",model_response)\n```\n\u6b64\u793a\u4f8b\u4ee3\u78bc\u7684\u97ff\u61c9\u53ef\u80fd\u8207\u4ee5\u4e0b\u5167\u5bb9\u985e\u4f3c\uff1a\n```\ncandidates {\u00a0 content {\u00a0 \u00a0 parts {\u00a0 \u00a0 \u00a0 text: \"84\"\u00a0 \u00a0 }\u00a0 }}usage_metadata {\u00a0 prompt_token_count: 13\u00a0 candidates_token_count: 2\u00a0 total_token_count: 15}\n```\n### \u751f\u6210\u5716\u7247\u7684\u8aaa\u660e\n\u4ee5\u4e0b\u4ee3\u78bc\u793a\u4f8b\u4f7f\u7528 Gemini Pro Vision \u591a\u6a21\u614b\u6a21\u578b\u751f\u6210\u63cf\u8ff0\u82b1\u5349\u7684\u6587\u672c\uff1a\n```\nfrom vertexai.preview.generative_models import GenerativeModelfrom vertexai.preview.generative_models import Partgemini_pro_vision_model = GenerativeModel(\"gemini-1.0-pro-vision\")image = Part.from_uri(\"gs://cloud-samples-data/ai-platform/flowers/daisy/10559679065_50d2b16f6d.jpg\", mime_type=\"image/jpeg\")model_response = gemini_pro_vision_model.generate_content([\"what is this image?\", image])print(\"model_response\\n\",model_response)\n```\n\u6b64\u793a\u4f8b\u4ee3\u78bc\u7684\u97ff\u61c9\u53ef\u80fd\u8207\u4ee5\u4e0b\u5167\u5bb9\u985e\u4f3c\uff1a\n```\ncandidates {\u00a0 content {\u00a0 \u00a0 role: \"model\"\u00a0 \u00a0 parts {\u00a0 \u00a0 \u00a0 text: \" The image is a photograph of a daisy flower in a field of fallen leaves.\"\u00a0 \u00a0 }\u00a0 }\u00a0 finish_reason: STOP\u00a0 safety_ratings {\u00a0 \u00a0 category: HARM_CATEGORY_HARASSMENT\u00a0 \u00a0 probability: NEGLIGIBLE\u00a0 }\u00a0 safety_ratings {\u00a0 \u00a0 category: HARM_CATEGORY_HATE_SPEECH\u00a0 \u00a0 probability: NEGLIGIBLE\u00a0 }\u00a0 safety_ratings {\u00a0 \u00a0 category: HARM_CATEGORY_SEXUALLY_EXPLICIT\u00a0 \u00a0 probability: NEGLIGIBLE\u00a0 }\u00a0 safety_ratings {\u00a0 \u00a0 category: HARM_CATEGORY_DANGEROUS_CONTENT\u00a0 \u00a0 probability: NEGLIGIBLE\u00a0 }}usage_metadata {\u00a0 prompt_token_count: 263\u00a0 candidates_token_count: 16\u00a0 total_token_count: 279}\n```\n### \u5f9e\u6587\u672c\u548c\u5716\u7247\u751f\u6210\u5167\u5bb9\n\u4ee5\u4e0b\u4ee3\u78bc\u793a\u4f8b\u4f7f\u7528 Gemini Pro Vision \u591a\u6a21\u614b\u6a21\u578b\uff0c\u901a\u904e\u6587\u672c\u63d0\u793a\u548c\u82b1\u5349\u5716\u7247\u751f\u6210\u5167\u5bb9\uff1a\n```\nfrom vertexai import generative_modelsfrom vertexai.generative_models import GenerativeModelimage = generative_models.Part.from_uri(\"gs://cloud-samples-data/ai-platform/flowers/daisy/10559679065_50d2b16f6d.jpg\", mime_type=\"image/jpeg\")gemini_pro_vision_model = GenerativeModel(\"gemini-1.0-pro-vision\")model_response = gemini_pro_vision_model.generate_content([\"What is shown in this image?\", image])print(\"model_response\\n\",model_response)\n```\n\u6b64\u793a\u4f8b\u4ee3\u78bc\u7684\u97ff\u61c9\u53ef\u80fd\u8207\u4ee5\u4e0b\u5167\u5bb9\u985e\u4f3c\uff1a\n```\ncandidates {\u00a0 content {\u00a0 \u00a0 role: \"model\"\u00a0 \u00a0 parts {\u00a0 \u00a0 \u00a0 text: \" This is an image of a white daisy growing in a pile of brown, dead leaves.\"\u00a0 \u00a0 }\u00a0 }\u00a0 finish_reason: STOP\u00a0 safety_ratings {\u00a0 \u00a0 category: HARM_CATEGORY_HARASSMENT\u00a0 \u00a0 probability: NEGLIGIBLE\u00a0 }\u00a0 safety_ratings {\u00a0 \u00a0 category: HARM_CATEGORY_HATE_SPEECH\u00a0 \u00a0 probability: NEGLIGIBLE\u00a0 }\u00a0 safety_ratings {\u00a0 \u00a0 category: HARM_CATEGORY_SEXUALLY_EXPLICIT\u00a0 \u00a0 probability: NEGLIGIBLE\u00a0 }\u00a0 safety_ratings {\u00a0 \u00a0 category: HARM_CATEGORY_DANGEROUS_CONTENT\u00a0 \u00a0 probability: NEGLIGIBLE\u00a0 }}usage_metadata {\u00a0 prompt_token_count: 265\u00a0 candidates_token_count: 18\u00a0 total_token_count: 283}\n```\n### \u5f9e\u8996\u983b\u751f\u6210\u5167\u5bb9\n\u60a8\u53ef\u4ee5\u4f7f\u7528\u6d41\u5f0f\u50b3\u8f38\u4f86\u901a\u904e\u8996\u983b\u751f\u6210\u5167\u5bb9\u3002Gemini \u6a21\u578b\u50c5\u652f\u6301\u6d41\u5f0f\u50b3\u8f38\u8996\u983b\u5167\u5bb9\u3002\u4ee5\u4e0b\u4ee3\u78bc\u793a\u4f8b\u4f7f\u7528 Gemini Pro Vision \u591a\u6a21\u614b\u6a21\u578b\uff0c\u901a\u904e\u6587\u672c\u63d0\u793a\u548c\u96fb\u5f71\u5ee3\u544a\u8996\u983b\u751f\u6210\u5167\u5bb9\u3002\n```\nfrom vertexai import generative_modelsfrom vertexai.generative_models import GenerativeModelgemini_pro_vision_model = GenerativeModel(\"gemini-1.0-pro-vision\")response = gemini_pro_vision_model.generate_content([\u00a0 \"What is in the video? \",\u00a0 generative_models.Part.from_uri(\"gs://cloud-samples-data/video/animals.mp4\", mime_type=\"video/mp4\"),], stream=True)for chunk in response :\u00a0 print(chunk.text)\n```\n\u6b64\u793a\u4f8b\u4ee3\u78bc\u7684\u97ff\u61c9\u53ef\u80fd\u8207\u4ee5\u4e0b\u5167\u5bb9\u985e\u4f3c\uff1a\n```\nThe video is an advertisement for the movie Zootopia. It features a tiger, an\notter, and a sloth. The tiger is shown looking at the camera , while the otter\nand the sloth are shown swimming in a pool. The video is set to the song \"Try\nEverything\" by Shakira.\"\n```\n## \u5f8c\u7e8c\u6b65\u9a5f\n- \u77ad\u89e3 [\u57fa\u790e\u6a21\u578b\u985e\u548c Vertex AI SDK](https://cloud.google.com/vertex-ai/generative-ai/docs/sdk-for-llm/llm-sdk-overview?hl=zh-cn) \u3002\n- \u77ad\u89e3\u5982\u4f55 [\u4f7f\u7528\u6587\u672c\u6a21\u578b\u985e\u548c Vertex AI SDK](https://cloud.google.com/vertex-ai/generative-ai/docs/sdk-for-llm/sdk-use-text-models?hl=zh-cn) \u3002\n- \u77ad\u89e3\u5982\u4f55 [\u4f7f\u7528\u4ee3\u78bc\u6a21\u578b\u985e\u548c Vertex AI SDK](https://cloud.google.com/vertex-ai/generative-ai/docs/sdk-for-llm/sdk-use-code-models?hl=zh-cn) \u3002", "guide": "Generative AI on Vertex AI"}