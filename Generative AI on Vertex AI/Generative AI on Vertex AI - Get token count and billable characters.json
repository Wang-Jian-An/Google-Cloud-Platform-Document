{"title": "Generative AI on Vertex AI - Get token count and billable characters", "url": "https://cloud.google.com/vertex-ai/generative-ai/docs/get-token-count", "abstract": "# Generative AI on Vertex AI - Get token count and billable characters\nGenerative AI models break down text data into units called for processing. The way text data is converted into tokens depends on the tokenizer used. A token can be characters, words, or phrases. Each model has a maximum number of tokens that it can handle in a prompt and response. This page shows you how to get the token count and the number of billable characters for a prompt.\n", "content": "## Supported models\nThe following foundation models support getting prompt token counts:\n- `text-bison`\n- `chat-bison`\n- `code-bison`\n- `codechat-bison`\n- `code-gecko`\n- `textembedding-gecko`\nTo learn how to get the prompt token count for Gemini models, see the [get token count instructions for the Vertex AI Gemini API](/vertex-ai/generative-ai/docs/multimodal/get-token-count) .\n## Get the token count for a prompt\nYou can get the token count and the number of billable characters for a prompt by using the `countTokens` API. The input format for `countTokens` depends on the model you use. Each input format is the same as the `predict` input format.\nTo get the token count and the number of billable characters for a prompt by using the Vertex AI API, send a POST request to the publisher model endpoint.\nBefore using any of the request data, make the following replacements:- : Enter a supported region. For a list of supported regions, see [Available locations](/vertex-ai/generative-ai/docs/learn/locations-genai#available-regions) .\n- : Your [project ID](/resource-manager/docs/creating-managing-projects#identifiers) .\n- : The prompt to get the token count and billable  characters for. (Don't add quotes around the prompt here.)\nHTTP method and URL:\n```\nPOST https://LOCATION-aiplatform.googleapis.com/v1/projects/PROJECT_ID/locations/LOCATION/publishers/google/models/text-bison:countTokens\n```\nRequest JSON body:\n```\n{\n \"instances\": [ { \"prompt\": \"PROMPT\" }\n ]\n}\n```\nTo send your request, choose one of these options:\n **Note:** The following command assumes that you have logged in to  the`gcloud`CLI with your user account by running [gcloud init](/sdk/gcloud/reference/init) or [gcloud auth login](/sdk/gcloud/reference/auth/login) ,  or by using [Cloud Shell](/shell/docs) ,  which automatically logs you into the`gcloud`CLI.  You can check the currently active account by running [gcloud auth list](/sdk/gcloud/reference/auth/list) .\nSave the request body in a file named `request.json` .  Run the following command in the terminal to create or overwrite  this file in the current directory:\n```\ncat > request.json << 'EOF'\n{\n \"instances\": [ { \"prompt\": \"PROMPT\" }\n ]\n}\nEOF\n```\nThen execute the following command to send your REST request:\n```\ncurl -X POST \\ -H \"Authorization: Bearer $(gcloud auth print-access-token)\" \\ -H \"Content-Type: application/json; charset=utf-8\" \\ -d @request.json \\ \"https://LOCATION-aiplatform.googleapis.com/v1/projects/PROJECT_ID/locations/LOCATION/publishers/google/models/text-bison:countTokens\"\n``` **Note:** The following command assumes that you have logged in to  the`gcloud`CLI with your user account by running [gcloud init](/sdk/gcloud/reference/init) or [gcloud auth login](/sdk/gcloud/reference/auth/login) ,  or by using [Cloud Shell](/shell/docs) ,  which automatically logs you into the`gcloud`CLI.  You can check the currently active account by running [gcloud auth list](/sdk/gcloud/reference/auth/list) .\nSave the request body in a file named `request.json` .  Run the following command in the terminal to create or overwrite  this file in the current directory:\n```\n@'\n{\n \"instances\": [ { \"prompt\": \"PROMPT\" }\n ]\n}\n'@ | Out-File -FilePath request.json -Encoding utf8\n```\nThen execute the following command to send your REST request:\n```\n$cred = gcloud auth print-access-token$headers = @{ \"Authorization\" = \"Bearer $cred\" }Invoke-WebRequest ` -Method POST ` -Headers $headers ` -ContentType: \"application/json; charset=utf-8\" ` -InFile request.json ` -Uri \"https://LOCATION-aiplatform.googleapis.com/v1/projects/PROJECT_ID/locations/LOCATION/publishers/google/models/text-bison:countTokens\" | Select-Object -Expand Content\n```\nYou should receive a JSON response similar to the following.\n```\n{\n \"totalTokens\": 12,\n \"totalBillableCharacters\": 54\n}\n```\n```\nPROJECT_ID=\"PROJECT_ID\"curl \\-X POST \\-H \"Authorization: Bearer $(gcloud auth print-access-token)\" \\-H \"Content-Type: application/json\" \\https://us-central1-aiplatform.googleapis.com/v1/projects/${PROJECT_ID}/locations/us-central1/publishers/google/models/text-bison:countTokens -d \\$'{\u00a0 \"instances\": [\u00a0 \u00a0 { \"prompt\": \"Give me ten interview questions for the role of program manager.\" },\u00a0 \u00a0 { \"prompt\": \"List some good qualities for a program manager.\" }\u00a0 ]}'\n```\nTo get the token count and the number of billable characters for a prompt by using the Vertex AI API, send a POST request to the publisher model endpoint.\nBefore using any of the request data, make the following replacements:- : Enter a supported region. For a list of supported regions, see [Available locations](/vertex-ai/generative-ai/docs/learn/locations-genai#available-regions) .\n- : Your [project ID](/resource-manager/docs/creating-managing-projects#identifiers) .\n- : Optional. Context can be instructions that you give to the model on how it should respond or information that it uses or references to generate a response. Add contextual information in your prompt when you need to give information to the model, or restrict the boundaries of the responses to only what's within the context.\n- : The author of`EXAMPLE_INPUT`(the user).\n- : Example of a message.\n- : The author of`EXAMPLE_OUTPUT`(the bot).\n- : Example of the ideal response.\n- : The author of the message (the user).\n- : The content of the message.\nHTTP method and URL:\n```\nPOST https://LOCATION-aiplatform.googleapis.com/v1/projects/PROJECT_ID/locations/LOCATION/publishers/google/models/chat-bison:countTokens\n```\nRequest JSON body:\n```\n{\n \"instances\": [ {\n  \"context\": \"CONTEXT\",\n  \"examples\": [  {\n   \"input\": {\n   \"author\": \"EXAMPLE_AUTHOR_1\",\n   \"content\": \"EXAMPLE_INPUT\"\n   },\n   \"output\": {\n   \"author\": \"EXAMPLE_AUTHOR_2\",\n   \"content\": \"EXAMPLE_OUTPUT\"\n   }\n  }\n  ],\n  \"messages\": [  {\n   \"author\": \"AUTHOR_1\",\n   \"content\": \"CONTENT\"\n  }\n  ]\n }\n ]\n}\n```\nTo send your request, choose one of these options:\n **Note:** The following command assumes that you have logged in to  the`gcloud`CLI with your user account by running [gcloud init](/sdk/gcloud/reference/init) or [gcloud auth login](/sdk/gcloud/reference/auth/login) ,  or by using [Cloud Shell](/shell/docs) ,  which automatically logs you into the`gcloud`CLI.  You can check the currently active account by running [gcloud auth list](/sdk/gcloud/reference/auth/list) .\nSave the request body in a file named `request.json` .  Run the following command in the terminal to create or overwrite  this file in the current directory:\n```\ncat > request.json << 'EOF'\n{\n \"instances\": [ {\n  \"context\": \"CONTEXT\",\n  \"examples\": [  {\n   \"input\": {\n   \"author\": \"EXAMPLE_AUTHOR_1\",\n   \"content\": \"EXAMPLE_INPUT\"\n   },\n   \"output\": {\n   \"author\": \"EXAMPLE_AUTHOR_2\",\n   \"content\": \"EXAMPLE_OUTPUT\"\n   }\n  }\n  ],\n  \"messages\": [  {\n   \"author\": \"AUTHOR_1\",\n   \"content\": \"CONTENT\"\n  }\n  ]\n }\n ]\n}\nEOF\n```\nThen execute the following command to send your REST request:\n```\ncurl -X POST \\ -H \"Authorization: Bearer $(gcloud auth print-access-token)\" \\ -H \"Content-Type: application/json; charset=utf-8\" \\ -d @request.json \\ \"https://LOCATION-aiplatform.googleapis.com/v1/projects/PROJECT_ID/locations/LOCATION/publishers/google/models/chat-bison:countTokens\"\n``` **Note:** The following command assumes that you have logged in to  the`gcloud`CLI with your user account by running [gcloud init](/sdk/gcloud/reference/init) or [gcloud auth login](/sdk/gcloud/reference/auth/login) ,  or by using [Cloud Shell](/shell/docs) ,  which automatically logs you into the`gcloud`CLI.  You can check the currently active account by running [gcloud auth list](/sdk/gcloud/reference/auth/list) .\nSave the request body in a file named `request.json` .  Run the following command in the terminal to create or overwrite  this file in the current directory:\n```\n@'\n{\n \"instances\": [ {\n  \"context\": \"CONTEXT\",\n  \"examples\": [  {\n   \"input\": {\n   \"author\": \"EXAMPLE_AUTHOR_1\",\n   \"content\": \"EXAMPLE_INPUT\"\n   },\n   \"output\": {\n   \"author\": \"EXAMPLE_AUTHOR_2\",\n   \"content\": \"EXAMPLE_OUTPUT\"\n   }\n  }\n  ],\n  \"messages\": [  {\n   \"author\": \"AUTHOR_1\",\n   \"content\": \"CONTENT\"\n  }\n  ]\n }\n ]\n}\n'@ | Out-File -FilePath request.json -Encoding utf8\n```\nThen execute the following command to send your REST request:\n```\n$cred = gcloud auth print-access-token$headers = @{ \"Authorization\" = \"Bearer $cred\" }Invoke-WebRequest ` -Method POST ` -Headers $headers ` -ContentType: \"application/json; charset=utf-8\" ` -InFile request.json ` -Uri \"https://LOCATION-aiplatform.googleapis.com/v1/projects/PROJECT_ID/locations/LOCATION/publishers/google/models/chat-bison:countTokens\" | Select-Object -Expand Content\n```\nYou should receive a JSON response similar to the following.\n```\n{\n \"totalTokens\": 43,\n \"totalBillableCharacters\": 182\n}\n```\n```\nPROJECT_ID=\"PROJECT_ID\"curl \\-X POST \\-H \"Authorization: Bearer $(gcloud auth print-access-token)\" \\-H \"Content-Type: application/json\" \\https://us-central1-aiplatform.googleapis.com/v1/projects/${PROJECT_ID}/locations/us-central1/publishers/google/models/chat-bison:countTokens -d \\$'{\u00a0 \"instances\": [\u00a0 \u00a0 {\u00a0 \u00a0 \u00a0 \"context\": \"You are Captain Bartholomew, the most feared pirate dog of the seven seas.\",\u00a0 \u00a0 \u00a0 \"examples\": [\u00a0 \u00a0 \u00a0 \u00a0 {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"input\": {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"author\": \"User\",\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"content\": \"Hello!\"\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 },\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"output\": {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"author\": \"Captain Barktholomew\",\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"content\": \"Argh! What brings ye to my ship?\"\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 }\u00a0 \u00a0 \u00a0 \u00a0 },\u00a0 \u00a0 \u00a0 \u00a0 {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"input\": {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"author\": \"User\",\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"content\": \"Who are you?\"\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 },\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"output\": {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"author\": \"Captain Barktholomew\",\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"content\": \"I be Captain Barktholomew, the most feared pirate dog of the seven seas.\"\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 }\u00a0 \u00a0 \u00a0 \u00a0 }\u00a0 \u00a0 \u00a0 ],\u00a0 \u00a0 \u00a0 \"messages\": [\u00a0 \u00a0 \u00a0 \u00a0 {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"author\": \"User\",\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"content\": \"Hello!\"\u00a0 \u00a0 \u00a0 \u00a0 },\u00a0 \u00a0 \u00a0 \u00a0 {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"author\": \"Captain Barktholomew\",\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"content\": \"Ahoy there, landlubber! What brings ye to me ship?\"\u00a0 \u00a0 \u00a0 \u00a0 },\u00a0 \u00a0 \u00a0 \u00a0 {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"author\": \"User\",\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"content\": \"Can you tell me a tale of your most recent adventure?\"\u00a0 \u00a0 \u00a0 \u00a0 },\u00a0 \u00a0 \u00a0 \u00a0 {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"author\": \"Captain Barktholomew\",\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"content\": \"Aye, I\\'ll spin ye a tale of me latest adventure....\",\u00a0 \u00a0 \u00a0 \u00a0 },\u00a0 \u00a0 \u00a0 \u00a0 {\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"author\": \"User\",\u00a0 \u00a0 \u00a0 \u00a0 \u00a0 \"content\": \"I\\'m listening.\"\u00a0 \u00a0 \u00a0 \u00a0 }\u00a0 \u00a0 \u00a0 ]\u00a0 \u00a0 }\u00a0 ]}'\n```\nTo get the token count and the number of billable characters for a prompt by using the Vertex AI API, send a POST request to the publisher model endpoint.\nBefore using any of the request data, make the following replacements:- : Enter a supported region. For a list of supported regions, see [Available locations](/vertex-ai/generative-ai/docs/learn/locations-genai#available-regions) .\n- : Your [project ID](/resource-manager/docs/creating-managing-projects#identifiers) .\n- : For code models,`prefix`represents the beginning of a piece of meaningful programming code or a natural language prompt that describes code to be generated.\nHTTP method and URL:\n```\nPOST https://LOCATION-aiplatform.googleapis.com/v1/projects/PROJECT_ID/locations/LOCATION/publishers/google/models/code-bison:countTokens\n```\nRequest JSON body:\n```\n{\n \"instances\": [ {\n  \"prefix\": \"PREFIX\"\n }\n ]\n}\n```\nTo send your request, choose one of these options:\n **Note:** The following command assumes that you have logged in to  the`gcloud`CLI with your user account by running [gcloud init](/sdk/gcloud/reference/init) or [gcloud auth login](/sdk/gcloud/reference/auth/login) ,  or by using [Cloud Shell](/shell/docs) ,  which automatically logs you into the`gcloud`CLI.  You can check the currently active account by running [gcloud auth list](/sdk/gcloud/reference/auth/list) .\nSave the request body in a file named `request.json` .  Run the following command in the terminal to create or overwrite  this file in the current directory:\n```\ncat > request.json << 'EOF'\n{\n \"instances\": [ {\n  \"prefix\": \"PREFIX\"\n }\n ]\n}\nEOF\n```\nThen execute the following command to send your REST request:\n```\ncurl -X POST \\ -H \"Authorization: Bearer $(gcloud auth print-access-token)\" \\ -H \"Content-Type: application/json; charset=utf-8\" \\ -d @request.json \\ \"https://LOCATION-aiplatform.googleapis.com/v1/projects/PROJECT_ID/locations/LOCATION/publishers/google/models/code-bison:countTokens\"\n``` **Note:** The following command assumes that you have logged in to  the`gcloud`CLI with your user account by running [gcloud init](/sdk/gcloud/reference/init) or [gcloud auth login](/sdk/gcloud/reference/auth/login) ,  or by using [Cloud Shell](/shell/docs) ,  which automatically logs you into the`gcloud`CLI.  You can check the currently active account by running [gcloud auth list](/sdk/gcloud/reference/auth/list) .\nSave the request body in a file named `request.json` .  Run the following command in the terminal to create or overwrite  this file in the current directory:\n```\n@'\n{\n \"instances\": [ {\n  \"prefix\": \"PREFIX\"\n }\n ]\n}\n'@ | Out-File -FilePath request.json -Encoding utf8\n```\nThen execute the following command to send your REST request:\n```\n$cred = gcloud auth print-access-token$headers = @{ \"Authorization\" = \"Bearer $cred\" }Invoke-WebRequest ` -Method POST ` -Headers $headers ` -ContentType: \"application/json; charset=utf-8\" ` -InFile request.json ` -Uri \"https://LOCATION-aiplatform.googleapis.com/v1/projects/PROJECT_ID/locations/LOCATION/publishers/google/models/code-bison:countTokens\" | Select-Object -Expand Content\n```\nYou should receive a JSON response similar to the following.\n```\n{\n \"totalTokens\": 43,\n \"totalBillableCharacters\": 182\n}\n```\n```\nPROJECT_ID=PROJECT_IDcurl \\-X POST \\-H \"Authorization: Bearer $(gcloud auth print-access-token)\" \\-H \"Content-Type: application/json\" \\https://us-central1-aiplatform.googleapis.com/v1/projects/${PROJECT_ID}/locations/us-central1/publishers/google/models/code-bison:countTokens -d \\$'{\u00a0 \"instances\": [\u00a0 \u00a0 {\u00a0 \u00a0 \u00a0 \"prefix\": \"Write a function that checks if a year is a leap year.\"\u00a0 \u00a0 }\u00a0 ]}'\n```\nTo get the token count and the number of billable characters for a prompt by using the Vertex AI API, send a POST request to the publisher model endpoint.\nBefore using any of the request data, make the following replacements:- : Enter a supported region. For a list of supported regions, see [Available locations](/vertex-ai/generative-ai/docs/learn/locations-genai#available-regions) .\n- : Your [project ID](/resource-manager/docs/creating-managing-projects#identifiers) .\n- : The author of the message.\n- : The content of the message.\nHTTP method and URL:\n```\nPOST https://LOCATION-aiplatform.googleapis.com/v1/projects/PROJECT_ID/locations/LOCATION/publishers/google/models/codechat-bison:countTokens\n```\nRequest JSON body:\n```\n{\n \"instances\": {\n \"messages\": [  {\n   \"author\": \"AUTHOR\",\n   \"content\": \"CONTENT\"\n  }\n ]\n }\n}\n```\nTo send your request, choose one of these options:\n **Note:** The following command assumes that you have logged in to  the`gcloud`CLI with your user account by running [gcloud init](/sdk/gcloud/reference/init) or [gcloud auth login](/sdk/gcloud/reference/auth/login) ,  or by using [Cloud Shell](/shell/docs) ,  which automatically logs you into the`gcloud`CLI.  You can check the currently active account by running [gcloud auth list](/sdk/gcloud/reference/auth/list) .\nSave the request body in a file named `request.json` .  Run the following command in the terminal to create or overwrite  this file in the current directory:\n```\ncat > request.json << 'EOF'\n{\n \"instances\": {\n \"messages\": [  {\n   \"author\": \"AUTHOR\",\n   \"content\": \"CONTENT\"\n  }\n ]\n }\n}\nEOF\n```\nThen execute the following command to send your REST request:\n```\ncurl -X POST \\ -H \"Authorization: Bearer $(gcloud auth print-access-token)\" \\ -H \"Content-Type: application/json; charset=utf-8\" \\ -d @request.json \\ \"https://LOCATION-aiplatform.googleapis.com/v1/projects/PROJECT_ID/locations/LOCATION/publishers/google/models/codechat-bison:countTokens\"\n``` **Note:** The following command assumes that you have logged in to  the`gcloud`CLI with your user account by running [gcloud init](/sdk/gcloud/reference/init) or [gcloud auth login](/sdk/gcloud/reference/auth/login) ,  or by using [Cloud Shell](/shell/docs) ,  which automatically logs you into the`gcloud`CLI.  You can check the currently active account by running [gcloud auth list](/sdk/gcloud/reference/auth/list) .\nSave the request body in a file named `request.json` .  Run the following command in the terminal to create or overwrite  this file in the current directory:\n```\n@'\n{\n \"instances\": {\n \"messages\": [  {\n   \"author\": \"AUTHOR\",\n   \"content\": \"CONTENT\"\n  }\n ]\n }\n}\n'@ | Out-File -FilePath request.json -Encoding utf8\n```\nThen execute the following command to send your REST request:\n```\n$cred = gcloud auth print-access-token$headers = @{ \"Authorization\" = \"Bearer $cred\" }Invoke-WebRequest ` -Method POST ` -Headers $headers ` -ContentType: \"application/json; charset=utf-8\" ` -InFile request.json ` -Uri \"https://LOCATION-aiplatform.googleapis.com/v1/projects/PROJECT_ID/locations/LOCATION/publishers/google/models/codechat-bison:countTokens\" | Select-Object -Expand Content\n```\nYou should receive a JSON response similar to the following.\n```\n{\n \"totalTokens\": 43,\n \"totalBillableCharacters\": 182\n}\n```\n```\nPROJECT_ID=PROJECT_IDcurl \\-X POST \\-H \"Authorization: Bearer $(gcloud auth print-access-token)\" \\-H \"Content-Type: application/json\" \\https://us-central1-aiplatform.googleapis.com/v1/projects/${PROJECT_ID}/locations/us-central1/publishers/google/models/codechat-bison:countTokens -d \\$'{\u00a0 \"instances\": {\u00a0 \u00a0 \"messages\": [\u00a0 \u00a0 \u00a0 {\u00a0 \u00a0 \u00a0 \u00a0 \"author\": \"user\",\u00a0 \u00a0 \u00a0 \u00a0 \"content\": \"Hi, how are you?\"\u00a0 \u00a0 \u00a0 },\u00a0 \u00a0 \u00a0 {\u00a0 \u00a0 \u00a0 \u00a0 \"author\": \"system\",\u00a0 \u00a0 \u00a0 \u00a0 \"content\": \"I am doing good. What Can I help you with in the coding world?\"\u00a0 \u00a0 \u00a0 },\u00a0 \u00a0 \u00a0 {\u00a0 \u00a0 \u00a0 \u00a0 \"author\": \"user\",\u00a0 \u00a0 \u00a0 \u00a0 \"content\": \"Please help write a function to calculate the min of two numbers\"\u00a0 \u00a0 \u00a0 }\u00a0 \u00a0 ]\u00a0 }}'\n```\nTo get the token count and the number of billable characters for a prompt by using the Vertex AI API, send a POST request to the publisher model endpoint.\nBefore using any of the request data, make the following replacements:- : Enter a supported region. For a list of supported regions, see [Available locations](/vertex-ai/generative-ai/docs/learn/locations-genai#available-regions) .\n- : Your [project ID](/resource-manager/docs/creating-managing-projects#identifiers) .\n- : For code models,`prefix`represents the beginning of a piece of meaningful programming code or a natural language prompt that describes code to be generated. The model attempts to fill in the code in between the`prefix`and`suffix`.\n- : For code completion,`suffix`represents the end of a piece of meaningful programming code. The model attempts to fill in the code in between the`prefix`and`suffix`.\nHTTP method and URL:\n```\nPOST https://LOCATION-aiplatform.googleapis.com/v1/projects/PROJECT_ID/locations/LOCATION/publishers/google/models/code-gecko:countTokens\n```\nRequest JSON body:\n```\n{\n \"instances\": [ {\n  \"prefix\": \"PREFIX\",\n  \"suffix\": \"SUFFIX\"\n }\n ]\n}\n```\nTo send your request, choose one of these options:\n **Note:** The following command assumes that you have logged in to  the`gcloud`CLI with your user account by running [gcloud init](/sdk/gcloud/reference/init) or [gcloud auth login](/sdk/gcloud/reference/auth/login) ,  or by using [Cloud Shell](/shell/docs) ,  which automatically logs you into the`gcloud`CLI.  You can check the currently active account by running [gcloud auth list](/sdk/gcloud/reference/auth/list) .\nSave the request body in a file named `request.json` .  Run the following command in the terminal to create or overwrite  this file in the current directory:\n```\ncat > request.json << 'EOF'\n{\n \"instances\": [ {\n  \"prefix\": \"PREFIX\",\n  \"suffix\": \"SUFFIX\"\n }\n ]\n}\nEOF\n```\nThen execute the following command to send your REST request:\n```\ncurl -X POST \\ -H \"Authorization: Bearer $(gcloud auth print-access-token)\" \\ -H \"Content-Type: application/json; charset=utf-8\" \\ -d @request.json \\ \"https://LOCATION-aiplatform.googleapis.com/v1/projects/PROJECT_ID/locations/LOCATION/publishers/google/models/code-gecko:countTokens\"\n``` **Note:** The following command assumes that you have logged in to  the`gcloud`CLI with your user account by running [gcloud init](/sdk/gcloud/reference/init) or [gcloud auth login](/sdk/gcloud/reference/auth/login) ,  or by using [Cloud Shell](/shell/docs) ,  which automatically logs you into the`gcloud`CLI.  You can check the currently active account by running [gcloud auth list](/sdk/gcloud/reference/auth/list) .\nSave the request body in a file named `request.json` .  Run the following command in the terminal to create or overwrite  this file in the current directory:\n```\n@'\n{\n \"instances\": [ {\n  \"prefix\": \"PREFIX\",\n  \"suffix\": \"SUFFIX\"\n }\n ]\n}\n'@ | Out-File -FilePath request.json -Encoding utf8\n```\nThen execute the following command to send your REST request:\n```\n$cred = gcloud auth print-access-token$headers = @{ \"Authorization\" = \"Bearer $cred\" }Invoke-WebRequest ` -Method POST ` -Headers $headers ` -ContentType: \"application/json; charset=utf-8\" ` -InFile request.json ` -Uri \"https://LOCATION-aiplatform.googleapis.com/v1/projects/PROJECT_ID/locations/LOCATION/publishers/google/models/code-gecko:countTokens\" | Select-Object -Expand Content\n```\nYou should receive a JSON response similar to the following.\n```\n{\n \"totalTokens\": 43,\n \"totalBillableCharacters\": 182\n}\n```\n```\nPROJECT_ID=PROJECT_IDcurl \\-X POST \\-H \"Authorization: Bearer $(gcloud auth print-access-token)\" \\-H \"Content-Type: application/json\" \\https://us-central1-aiplatform.googleapis.com/v1/projects/${PROJECT_ID}/locations/us-central1/publishers/google/models/code-gecko:countTokens -d \\$'{\u00a0 \"instances\": [\u00a0 \u00a0 {\u00a0 \u00a0 \u00a0 \"prefix\": \"def reverse_string(s):\",\u00a0 \u00a0 \u00a0 \"suffix\": \"\"\u00a0 \u00a0 }\u00a0 ]}'\n```\nTo get the token count and the number of billable characters for a prompt by using the Vertex AI API, send a POST request to the publisher model endpoint.\nBefore using any of the request data, make the following replacements:- : Enter a supported region. For a list of supported regions, see [Available locations](/vertex-ai/generative-ai/docs/learn/locations-genai#available-regions) .\n- : Your [project ID](/resource-manager/docs/creating-managing-projects#identifiers) .\n- : The text that you want to generate embeddings  for.\nHTTP method and URL:\n```\nPOST https://LOCATION-aiplatform.googleapis.com/v1/projects/PROJECT_ID/locations/LOCATION/publishers/google/models/textembedding-gecko:countTokens\n```\nRequest JSON body:\n```\n{\n \"instances\": [ {\n  \"content\": \"TEXT\"\n }\n ]\n}\n```\nTo send your request, choose one of these options:\n **Note:** The following command assumes that you have logged in to  the`gcloud`CLI with your user account by running [gcloud init](/sdk/gcloud/reference/init) or [gcloud auth login](/sdk/gcloud/reference/auth/login) ,  or by using [Cloud Shell](/shell/docs) ,  which automatically logs you into the`gcloud`CLI.  You can check the currently active account by running [gcloud auth list](/sdk/gcloud/reference/auth/list) .\nSave the request body in a file named `request.json` .  Run the following command in the terminal to create or overwrite  this file in the current directory:\n```\ncat > request.json << 'EOF'\n{\n \"instances\": [ {\n  \"content\": \"TEXT\"\n }\n ]\n}\nEOF\n```\nThen execute the following command to send your REST request:\n```\ncurl -X POST \\ -H \"Authorization: Bearer $(gcloud auth print-access-token)\" \\ -H \"Content-Type: application/json; charset=utf-8\" \\ -d @request.json \\ \"https://LOCATION-aiplatform.googleapis.com/v1/projects/PROJECT_ID/locations/LOCATION/publishers/google/models/textembedding-gecko:countTokens\"\n``` **Note:** The following command assumes that you have logged in to  the`gcloud`CLI with your user account by running [gcloud init](/sdk/gcloud/reference/init) or [gcloud auth login](/sdk/gcloud/reference/auth/login) ,  or by using [Cloud Shell](/shell/docs) ,  which automatically logs you into the`gcloud`CLI.  You can check the currently active account by running [gcloud auth list](/sdk/gcloud/reference/auth/list) .\nSave the request body in a file named `request.json` .  Run the following command in the terminal to create or overwrite  this file in the current directory:\n```\n@'\n{\n \"instances\": [ {\n  \"content\": \"TEXT\"\n }\n ]\n}\n'@ | Out-File -FilePath request.json -Encoding utf8\n```\nThen execute the following command to send your REST request:\n```\n$cred = gcloud auth print-access-token$headers = @{ \"Authorization\" = \"Bearer $cred\" }Invoke-WebRequest ` -Method POST ` -Headers $headers ` -ContentType: \"application/json; charset=utf-8\" ` -InFile request.json ` -Uri \"https://LOCATION-aiplatform.googleapis.com/v1/projects/PROJECT_ID/locations/LOCATION/publishers/google/models/textembedding-gecko:countTokens\" | Select-Object -Expand Content\n```\nYou should receive a JSON response similar to the following.\n```\n{\n \"totalTokens\": 43,\n \"totalBillableCharacters\": 182\n}\n```\n```\nPROJECT_ID=PROJECT_IDcurl \\-X POST \\-H \"Authorization: Bearer $(gcloud auth print-access-token)\" \\-H \"Content-Type: application/json\" \\https://us-central1-aiplatform.googleapis.com/v1/projects/${PROJECT_ID}/locations/us-central1/publishers/google/models/textembedding-gecko:countTokens -d \\$'{\u00a0 \"instances\": [\u00a0 \u00a0 {\u00a0 \u00a0 \u00a0 \"content\": \"What is life?\"\u00a0 \u00a0 }\u00a0 ]}'\n```\n## Pricing and quota\nThere is no charge for using the `CountTokens` API. The maximum quota for the `CountTokens` API and the `ComputeTokens` API is 3000 requests per minute.\n## What's next\n- Learn how to [compute tokens](/vertex-ai/generative-ai/docs/compute-token) .\n- Learn how to [test chat prompts](/vertex-ai/generative-ai/docs/chat/test-chat-prompts) .\n- Learn how to [test text prompts](/vertex-ai/generative-ai/docs/text/test-text-prompts) .\n- Learn how to [get text embeddings](/vertex-ai/generative-ai/docs/embeddings/get-text-embeddings) .", "guide": "Generative AI on Vertex AI"}